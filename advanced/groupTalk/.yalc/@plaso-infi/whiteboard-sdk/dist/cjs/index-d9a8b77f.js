"use strict";var e=require("react"),t=require("react-dom"),n=require("agora-rtc-sdk-ng"),i="undefined"!=typeof document?document.currentScript:null,r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function l(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function u(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}"function"==typeof SuppressedError&&SuppressedError;var d,p,h,f,m,v,g="0.4.3";exports.GridType=void 0,(d=exports.GridType||(exports.GridType={}))[d.NONE=0]="NONE",d[d.LINE=1]="LINE",d[d.DOT=2]="DOT",function(e){e[e.PENDING=0]="PENDING",e[e.ON_GOING=1]="ON_GOING",e[e.ENDED=2]="ENDED",e[e.CANCELED=3]="CANCELED"}(p||(p={})),function(e){e[e.No=0]="No",e[e.Yes=1]="Yes"}(h||(h={})),exports.DefaultPerm=void 0,(f=exports.DefaultPerm||(exports.DefaultPerm={}))[f.SameWithSdk=0]="SameWithSdk",f[f.Edit=1]="Edit",f[f.Comment=2]="Comment",f[f.View=3]="View",function(e){e[e.TRTC=1]="TRTC",e[e.AGORA=2]="AGORA"}(m||(m={})),function(e){e[e.EXCEEDS_STORAGE_LIMIT=1]="EXCEEDS_STORAGE_LIMIT"}(v||(v={}));var y=function(){function e(){var e=this;this._promise=new Promise((function(t,n){e._res=t,e._rej=n}))}return Object.defineProperty(e.prototype,"result",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.done=function(e){this._res&&(this._res(e),this._res=this._rej=void 0)},e.prototype.fail=function(e){this._rej&&(this._rej(e),this._res=this._rej=void 0)},e}(),b=function(){function e(){this._t={}}return e.prototype.addListener=function(e,t,n){void 0===n&&(n=!1);var i=this._t,r=i[e];r||(i[e]=r=[]);var o={cb:t,once:n};return r.push(o),function(){var t=i[e];t&&(i[e]=t.filter((function(e){return e!==o})))}},e.prototype.subscribe=function(e,t){return this.addListener(e,t)},e.prototype.unsubscribe=function(e,t){var n=this._t[e];this._t[e]=null==n?void 0:n.filter((function(e){return e.cb===t}))},e.prototype.once=function(e,t){return this.addListener(e,t,!0)},e.prototype.publish=function(e,t){var n=this._t,i=n[e];i&&(n[e]=i.filter((function(e){return!e.once})),i.forEach((function(e){return e.cb(t)})))},e}(),E=["#eea5a5","#f5cd83","#9abaee","#74c5e6","#54d1c0"];var x,w,C={w:128,h:128};function S(e){var t=e.userId,n=void 0===t?"":t,i=e.text,r=void 0===i?"":i,o=e.imgUrl,a=void 0===o?"":o,s=e.bgColor,l=void 0===s?"":s;return new Promise((function(e){var t=function(){var t=l||function(e){var t,n;return(n="string"==typeof e?(null===(t=e.match(/(\d|[a-f]|[A-F])/g))||void 0===t?void 0:t.join(""))||"0":e)?E[parseInt(n,16)%E.length]:"#ccc"}(n);e(function(e,t){var n=document.createElement("canvas");n.width=C.w,n.height=C.h;var i=n.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,C.w,C.h),i.font="64px Arial",i.textAlign="center",i.fillStyle="#fff",i.fillText(e[0],64,88),n.toDataURL()}(r,t))};if(a){var i=document.createElement("img");i.onload=function(){e(a)},i.onerror=function(){t()},i.src=a}else t()}))}!function(e){e[e.PDF=1]="PDF",e[e.PPT=2]="PPT",e[e.EXCEL=3]="EXCEL",e[e.WORD=4]="WORD",e[e.ISPRINGPPT=5]="ISPRINGPPT"}(w||(w={}));var k={ppt:w.PPT,pdf:w.PDF,excel:w.EXCEL,word:w.WORD},_=((x={})[w.PPT]="ppt",x[w.PDF]="pdf",x[w.EXCEL]="excel",x[w.WORD]="word",x[w.ISPRINGPPT]="ppt",x),T={image:"image",document:"document",mp3:"audio",mp4:"video"},I=function(e,t){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},I(e,t)};function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function N(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function M(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function A(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function D(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function R(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}exports.E=function(){return exports.E=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},exports.E.apply(this,arguments)};var B=exports.E(exports.E({},{"audio.element.label":"音频","all.group.members":"所有成员","bigDoc.align.left":"左对齐","bigDoc.align.center":"居中对齐","bigDoc.align.right":"右对齐","bigDoc.indent.increase":"增加缩进","bigDoc.indent.reduce":"减少缩进","bigDoc.indentAndAlign":"缩进和对齐","bigDoc.default.name":"文档标题","bigDoc.placeholder":"请输入正文","bigDoc.nodeType.rawText":"正文","bigDoc.nodeType.h1":"一级标题","bigDoc.nodeType.h2":"二级标题","bigDoc.nodeType.h3":"三级标题","bigDoc.nodeType.orderedList":"有序列表","bigDoc.nodeType.list":"无序列表","bigDoc.selectAll.toast":"再次按 {0} 以选中全文","color.remove.default.hint":"不能移除默认颜色","comment.add":"添加批注","comment.draft.placeholder":"添加批注, 可@其他成员","comment.draft.placeholder.no.at":"添加批注","comment.resolved.label":"已解决","comment.unresolved.label":"未解决","comment.add.reply":"添加回复, 可@其他成员","comment.add.reply.no.at":"添加回复","comment.submenu.pin":"固定显示","comment.submenu.copyLink":"复制元素链接","comment.submenu.delete":"删除","comment.message.edit.save":"保存","comment.message.edit.cancel":"取消","comment.message.edit.delete":"删除","comment.message.updated":"已修改","comment.listMenu.icon.hint":"批注列表","comment.listMenu.hideResolve":"隐藏已解决","comment.listMenu.showResolve":"显示已解决","comment.listMenu.readAll":"全部已读","comment.listMenu.unfoldMessages":"展开 {0} 条回复","comment.listMenu.unfoldUnreadMessages":"展开 {0} 条新回复","comment.listMenu.foldMessages":"收起回复","comment.listMenu.noComment":"暂无批注","comment.listMenu.showAllBoardComments":"显示画布上的批注","comment.listMenu.hideAllBoardComments":"隐藏画布上的批注","comment.upload.file.number.limit":"一次最多发送前9个文件","comment.upload.file.size.limit":"暂不支持大于2G的文件","comment.upload.file.invalid.type":"暂不支持该格式的文件","comment.upload.file.empty.hint":"不支持上传空文件","comment.message.delete.confirm":"确定要删除该内容吗?","comment.file.deleted.hint":"文件已删除","comment.pending.deleted.hint":"该条内容已经被删除，上传文件终止","comment.file.upload.failed":"上传失败，点击重新上传","comment.filter.placeholder":"请输入名称搜索","comment.export.all":"导出所有人批注","common.basics":"基础","common.cancel":"取消","common.common":"常规","common.cut":"剪切","common.confirm":"确认","common.queding":"确定","common.wu":"无","common.delete":"删除","common.delete.success":"删除成功","common.delete.failed":"删除失败","common.send":"发送","common.download":"下载","common.phone.download.toast":"手机暂不支持图片下载，如需下载请使用电脑或Pad","common.edit":"编辑","common.edit.success":"编辑成功","common.edit.fail":"编辑失败","common.finish":"完成","common.fold":"收起","common.unfold":"展开","common.moretool":"更多工具","common.insert":"插入","common.check.detail":"查看详情","common.me":"我","common.people":"人","common.modify":"修改","common.new":"增加","common.paste":"粘贴","common.save":"保存","common.selectAll":"全选","common.noclipboard.tip":"无权限访问剪贴板，请使用Ctrl+V或去浏览器设置中打开权限","common.ruhecaozuo":"如何操作","common.preview":"预览","common.reply":"回复","common.transcoding":"正在转码中，预计等待时间","common.minutes":"分钟","common.transcoding.fail":"转码失败，请重新上传","common.upload.progress":"已上传 {0}","common.upload.auvi":"音视频","common.suoyouren":"所有人","common.more":"更多","common.you":"你","common.continue":"继续","common.agree":"同意","common.refuse":"拒绝","common.chakan":"查看","common.faqiren":"发起人","common.rename":"重命名","common.iknow":"我知道了","common.advance.setting":"高级设置","common.backtocvs":"返回画布","common.nomoreToast":"不再提醒","connectLine.endPoint":"结束端点","connectLine.lineType":"线条类型","connectLine.startPoint":"开始端点","datetime.today":"今天","datetime.tomorrow":"明天","datetime.yesterday":"昨天","datetime.Monday":"周一","datetime.Tuesday":"周二","datetime.Wednesday":"周三","datetime.Thursday":"周四","datetime.Friday":"周五","datetime.Saturday":"周六","datetime.Sunday":"周日","datetime.Monday.short":"一","datetime.Tuesday.short":"二","datetime.Wednesday.short":"三","datetime.Thursday.short":"四","datetime.Friday.short":"五","datetime.Saturday.short":"六","datetime.Sunday.short":"日","datetime.January":"1月","datetime.February":"2月","datetime.March":"3月","datetime.April":"4月","datetime.May":"5月","datetime.June":"6月","datetime.July":"7月","datetime.August":"8月","datetime.September":"9月","datetime.October":"10月","datetime.November":"11月","datetime.December":"12月","datetime.day":"{0}日","datetime.year":"{0}年","datetime.month.day":"{0}月{1}日","document.setStartPage":"设置起始页","document.startPageIs":"文档预览起始页","document.goToStartPage":"跳转","document.setAsStartPage":"设置当前页为起始页","document.extract":"文档平铺","document.extractBtnLabel":"平铺","document.extractPanelTitle":"选择页面:","document.extractAllOption":"全部","document.extractPanelInputHint":"例: 1-6, 9, 12-14","document.parsingPrompt":"正在解析中，预计等待时间 {0} 分钟","document.parsingFailedPrompt":"解析失败，请重新上传","element.align":"对齐元素","element.bg":"填充色","element.bg&opacity":"设置颜色和不透明度","element.borderStyle":"边框样式","element.bringToFront":"置顶","element.opacity":"不透明度","element.borderWidth":"粗细","element.color":"颜色","element.copy":"复制","element.clone":"克隆","element.delete":"删除","element.delete.already":"元素已被删除","element.info":"信息","element.lock":"锁定","element.rename":"重命名","element.lock.condition.by.owner":"仅画布拥有者和画布管理员可解锁","element.lock.condition.by.everyone":"所有人可解锁","element.longPressUnLock":"长按解锁","element.makeGroup":"组合","element.more":"更多","element.sendToBack":"置底","element.splitGroup":"解组","element.unlock":"解锁","element.filter":"筛选","element.count":"{0}个元素","element.frame.delete":"仅删除此帧框","element.saveCustomTemplate":"保存为自定义模板","exportImage.title":"导出为图片","exportImage.description":"公测期间可免费下载中图和大图","export.board.confirm":"导出","exportImage.l":"大图","exportImage.m":"中图","exportImage.s":"小图","exportPdf.title":"下载为 PDF","exportPdf.common":"普通清晰度","exportPdf.best":"最佳清晰度","exportPdf.tip":"公测期间可免费下载最佳清晰度 PDF","exportPdf.noFrameWarning":"画布中暂没有创建帧框，不支持下载为PDF","exportPdf.description":"1. 下载为PDF以帧框为基础\n2. 画布中一个帧框对应PDF中的一页\n3. 帧框列表中的顺序为PDF的页码顺序","exportPdf.mustCreateFrame":"所以你需要先在画布中至少创建一个帧框","exportPdf.createFrame":"创建帧框","export.frame":"导出帧框","export.as":"导出为","export.frame.count.overlimit.tip":"一次最多导出{0}个帧框","export.frame.as.ppt":"演示文稿","export.frame.as.image":"图片","export.frame.tip.1":"1、以帧框为基础，导出为PDF/PPT/图片","export.frame.tip.2":"2、画布中一个帧框对应文件中的一页","export.frame.tip.3":"3、帧框列表的顺序为导出文件的顺序，如需调整文件顺序，请调整帧框列表中帧框的顺序","export.image.zip.tip":"图片数量超过5张，将以压缩包的形式导出","export.frame.select.all":"全选","export.progress.tip":"文件准备中...","export.frame.empty.tip":"需要在画布中至少创建一个帧框才能导出","contextmenu.exportFrameBtn":"导出帧框为","export.frame.dialog.confirm":"导出","export.frame.as.pdf.clarity":"清晰度","export.frame.as.image.dimensions":"图片尺寸","export.frame.as.image.dimensions.little":"小（原图尺寸）","export.frame.as.image.dimensions.medium":"中","export.frame.as.image.dimensions.large":"大","export.frame.file.name":"文件命名","follow.nAreFollowing":"{0}人正在跟随","follow.oneIsFollowing":"{0}正在跟随","follow.call.for.follow":"正在召集你跟随他的视角","follow.call.for.follow.confirm":"跟随","follow.call.for.follow.reject":"不跟随","follow.force":"强制跟随","follow.label":"跟随","follow.cancel.force":"解除强制跟随","follow.resume":"返回跟随","frame.title":"帧框","follow.called":"已发送召集","follow.click.follow":"点击头像跟随","follow.click.unfollow":"点击头像取消跟随","frame.ratio":"比例切换","frame.ratio.custom":"自定义","frame.hide":"隐藏帧框","frame.hided":"帧框已被隐藏","frame.unhide":"显示帧框","frame.createFrame":"新建帧框","frame.unhide.condition.by.owner":"仅画布拥有者和画布管理员可解除隐藏","frame.partial.unhidable.hint":"部分帧框仅画布拥有者和画布管理员可以显示","frame.unhide.condition.by.everyone":"所有人可解除隐藏","frameList.addNewFrameBelow":"在下方新建帧框","frameList.close":"关闭","frameList.createFrame":"创建帧框","frameList.newFrame":"新建帧框","frameList.empty":"暂无帧框","frameList.noFrameTip":"暂时没有帧框，先去创建吧","frameList.rename":"重命名","frameList.title":"帧框","frameList.playPresentation":"播放","frameList.stopPresentation":"停止","frame.hide.copy.hint":"框选元素中包含隐藏帧框，无法复制粘贴","fullscreen.enter":"进入全屏","fullscreen.exit":"退出全屏","fullscreen.showOrHideToolbar":"显示/隐藏工具栏","grouptalk.createTalk":"创建分组讨论","grouptalk.create.fail":"该画布已创建分组讨论，不可重复创建，请稍后重试","grouptalk.name":"分组讨论","grouptalk.group.count":"讨论组个数","grouptalk.content":"讨论内容","grouptalk.desc":"当前只支持以帧框为对象进行内容选择","grouptalk.choose.content":"请选择讨论内容","grouptalk.choose.content.benzu":"请选择本组讨论内容","grouptalk.zuyuan":"讨论组员","grouptalk.automode":"自动分配","grouptalk.manuelmode":"手动分配","grouptalk.freemode":"成员自由选择讨论组","grouptalk.freemode.desc":"创建后，画布成员将收到分组讨论的邀请，在开始讨论前可自行选择讨论组加入","grouptalk.automode.desc":"自动将画布在线成员平均分配到讨论组中","grouptalk.manualmode.desc":"需手动将当前画布成员分配到每个讨论组中","grouptalk.create":"创建","grouptalk.pingjunmeizu":"平均每组{0}~{1}人","grouptalk.jijiangkaishi":"{0} 发起的分组讨论即将开始","grouptalk.lijichakan":"立即查看","grouptalk.bukelikai":"请选择以下讨论组加入，当分组讨论开始后不可自行离开","grouptalk.leave":"离开","grouptalk.join":"加入","grouptalk.kaishitaolun":"开始讨论","grouptalk.dismiss":"解散分组","grouptalk.stop":"结束讨论","grouptalk.sure.stop":"确定结束本次讨论？","grouptalk.jieshu":"结束","grouptalk.quxiao":"取消","grouptalk.zijineirong":"分组讨论中只能看到自己分组的内容","grouptalk.zijineirong.zuyuan":"分组讨论中只能看到自己分组的内容；如需换组或离开，请联系发起人","grouptalk.zijineirong.pangguan":"你未被分配到讨论组，如需参与请联系发起人","grouptalk.sure.delete.zu":"确定删除该讨论组吗？","grouptalk.suozaifenzu":"所在分组","grouptalk.benzuchengyuan":"本组成员","grouptalk.qita":"其他成员","grouptalk.weijiaruzu":"未加入组","grouptalk.yijiaruzu":"已加入其他组","grouptalk.zanwuchengyuan":"暂无成员","grouptalk.pick.tip":"请选择包含“讨论内容”的帧框","grouptalk.pick.exit":"退出","grouptalk.join.zu":"加入了讨论组","grouptalk.leave.zu":"离开了讨论组","grouptalk.yijinru":"你已进入","grouptalk.kaishi.tip":"开始前每组需选择讨论内容","grouptalk.nopermision.tip":"暂无权限，具有编辑权限的团队成员才能够创建分组讨论","grouptalk.daikaishi.tip":"未开始","grouptalk.sure.dismiss.talk":"确定解散分组吗？","grouptalk.dismiss.btn":"解散","grouptalk.taolunzu":"讨论组","grouptalk.dezhenkuang":"的帧框","grouptalk.going":"分组讨论中","grouptalk.lianmai":"连麦","grouptalk.backtoframe":"返回讨论区域","grouptalk.present":"连麦中","grouptalk.absent":"未进入","grouptalk.preventMeetingToast":"讨论组中，不支持会议功能，可以通过讨论组连麦","grouptalk.call.modal.title":"你已进入分组讨论，是否开启组内连麦？","grouptalk.call.modal.subtitle":"开启连麦后，可以和其他组内连麦成员进行音视频互动","grouptalk.call.modal.action.later":"暂不连麦","grouptalk.call.modal.action.enable":"开启连麦","grouptalk.rechoose.btn":"重新设置讨论内容","grouptalk.user.search.placeholder":"搜索成员","grouptalk.group.members":"讨论组成员","grouptalk.end":"本场讨论已结束","grouptalk.enter.modal.title":"分组讨论已开始","grouptalk.enter.modal.subtitle":"你已进入讨论组中，进入讨论组后不可自行离开。如需离开或者调整所在分组，可联系发起人。","helpCenter.title":"帮助&互动","history.activity.empty.list":"当前版本无内容，操作记录为空","history.op.record":"操作记录","history.title":"画布历史","history.version":"历史版本","history.activity.restore.forbidden":"该记录暂不支持恢复","hyperlink.discard":"取消超链接","image.customSize":"定制尺寸","image.cut":"裁剪","image.halfSize":"原始大小的一半","image.originSize":"原始尺寸","init.viewbox.pick.title":"设置进入画布时的视野","init.viewbox.pick.desc":"(对新邀请的成员生效)","license.error.code.prefix":"画布初始化失败，原因：","license.error.code.unknown":"未知错误，请联系英飞技术人员以寻求支持","license.error.code.103":"画布 License 已过期","license.error.code.104":"画布 License 未到启用时间","license.error.code.105":"无效画布 License","license.error.code.106":"服务器时间戳异常","license.error.code.107":"画布链接超过最大并发数限制","license.error.code.109":"服务器版本号错误","link.linkTarget":"链接到","link.description":"选择画布元素，或在下方粘贴网页链接，即可跳转","line.width":"粗细","link.add":"链接到","link.edit":"编辑链接","link.paste":"粘贴链接","link.copy":"复制链接","link.delete":"删除链接","link.copy.success.toast":"元素链接已复制","mindmap.alignNode":"对齐节点","mindmap.changeTheme":"改变主题","mindmap.nodeColor":"节点颜色","mindmap.nodeColorRandom":"随机颜色","mindmap.connection.line":"思维导图连接线","meeting.autojoin.confirm.title":"邀请您参加英飞会议","meeting.autojoin.title":"加入会议","meeting.autojoin.content":"会议主题: {0}","meeting.iconBtn.tooltip":"会议","meeting.reserve.success":"会议预定成功","meeting.reserve.failed":"预订会议失败，请检查网络或者刷新网页后再试","meeting.update.success":"会议修改成功","meeting.quick.label":"快速会议","meeting.reserve.label":"预定会议","meeting.title.history":"历史会议","meeting.title.detail":"会议详情","meeting.record.gening":"录制文件生成中...","meeting.record.none":"无录制文件","meeting.record.gening.failed":"生成失败","meeting.audio.to.text":"将录音转文字","meeting.textRecord.gening":"文字记录生成中，请稍后再来查看","meeting.textRecord":"文字记录","meeting.history.delete.confirm":"确定删除当前会议记录？","meeting.list.history.empty":"暂无历史会议","meeting.text.history.empty":"暂无文字记录","meeting.list.empty":"暂无会议","meeting.creator":"发起人","meeting.status.pending":"待开始","meeting.status.onGoing":"进行中","meeting.join":"进入会议","meeting.ignore":"暂不进入","meeting.aboutToStart":"会议即将开始","meeting.alreadyStart":"会议已经开始","meeting.copyLink":"复制邀请","meeting.link":"会议链接","meeting.copyLink.link":"复制邀请链接","meeting.gen.qrcode":"生成会议二维码","meeting.link.copied":"会议邀请已复制","meeting.edit":"修改会议","meeting.cancel":"取消会议","meeting.invite":"邀请","meeting.member.management":"管理成员({0})","meeting.member.management.label":"管理成员","meeting.member.management.label.popup":"管理会议成员","meeting.member":"成员({0})","meeting.member.label":"成员","meeting.member.label.popup":"会议成员","meeting.search.member":"搜索成员","meeting.laser":"激光笔","meeting.pre.page":"上一页","meeting.next.page":"下一页","meeting.end":"结束会议","meeting.leave":"离开会议","meeting.cancel.dialog.content":"你是会议的创建者，取消后其他成员将无法入会。","meeting.cancel.dialog.reject":"再想想","meeting.already.ended":"会议已结束","meeting.absent":"未进入","meeting.present":"会议中","meeting.host":"主持人","meeting.set.cohost":"设为联席主持人","meeting.cancel.cohost":"解除联席主持人","meeting.cohost":"联席主持人","meeting.cohost.upgrade":"请使用电脑升级套餐","meeting.visitor":"游客","meeting.endBy.host":"主持人已结束会议","meeting.end.confirm":"我知道了","meeting.host.enter":"你已进入会议中，所有参会人都会与你保持同屏","meeting.reach.rtcHost.limit":"暂不支持开启，最多支持同时开启{0}人的音频/视频","meeting.audio.disabledByHost":"主持人将你静音","meeting.video.disabledByHost":"主持人将你视频关闭","meeting.add.joiners":"选择团队成员","meeting.all.following":"所有人都跟随 {0}","meeting.list":"会议列表","meeting.preserve.failed.toast":"目前暂不支持预定，请在PC或Pad端操作","meeting.video.mirror":"画面镜像","meeting.list.forbidden":"暂无权限，不支持查看会议列表详情","meeting.conflict.dialog":"你已在其他设备加入会议，当前设备被移出会议","meeting.cur.channel":"当前进入的会议","meeting.not.exist":"会议不存在","meeting.cancel.failed":"会议取消失败","meeting.already.canceled":"会议已取消","meeting.edit.failed":"会议修改失败","meeting.edit.success":"会议修改成功","meeting.frame.deleted":"帧框已被删除","meeting.discard.edit.title":"退出编辑","meeting.discard.edit.content":"退出此次编辑，会议信息将不会保存","meeting.discard.edit.cancel":"继续编辑","meeting.discard.edit.confirm":"退出","meeting.follow.it":"跟随TA","meeting.following.it":"正在跟随TA","meeting.click.to.follow.user":"点击以跟随 {0} 的视角","meeting.following.user.view":"正在跟随 {0} 的视角","meeting.addJoiners.success":"添加参会人成功","meeting.addJoiners.failed":"添加参会人失败","meeting.enable.laser.failed":"启用激光笔失败","meeting.user.absent":"{0} 不在会议中","meeting.user.joined.postfix":"进入了会议","meeting.user.left.postfix":"离开了会议","meeting.get.meeting.link.failed":"生成会议链接失败","meeting.view.locked.view.hint":"主持人已设置强制跟随，不可以移动视角","meeting.view.locked.view.hint.host":"您已将自己设置为强制跟随，不可以移动视角","meeting.view.locked.presentation.hint":"强制跟随中，无法进行演示","meeting.force.follow.hint":"开启后，参会人不能脱离跟随","meeting.move.avatar.top":"头像置顶","meeting.cancel.avatar.top":"取消置顶","meeting.user.avatar.top.hint":"{0} 视频头像已被置顶","meeting.user.avatar.untop.hint":"主持人已取消视频头像置顶","meeting.open.independent.view":"开启独立画面","meeting.independent.view.opened":"已开启独立画面","meeting.close.independent.view":"关闭独立画面","meeting.enter.nickname.hint":"请输入参会昵称","meeting.daoruhuabu":"导入画布","meeting.fuzhijilu":"复制记录","meeting.fuzhijiyao":"复制纪要","meeting.canhuiren":"参会人","meeting.huiyijiyao":"会议纪要","meeting.ai.gen.jiyao":"AI生成会议纪要","meeting.gening.jiyao":"AI生成会议纪要中，请稍后再来查看","meeting.jiyao.emtpy":"暂无文字记录，无法生成会议纪要","meeting.history.audio.download":"下载录音","meeting.history.audio.download.tip":"仅主持人才能下载","meeting.yichuhuiyi":"移出会议","meeting.yichuhuiyi.tip":"你已被主持人移出会议","meeting.queding.yichu":"确定将{0}移出当前会议？","meeting.forbid.join":"禁止再次进入会议","meeting.yichu.success":"移出成功","meeting.nopermission.join":"无权限进入会议，如需进入请联系主持人","meeting.request.send":"请求已发送","meeting.host.requet.mic":"主持人请求打开你的麦克风","meeting.host.requet.cam":"主持人请求打开你的摄像头","meeting.zanbudakai.mic":"暂不打开","meeting.zanbudakai.cam":"暂不打开","meeting.open.mic":"打开麦克风","meeting.open.cam":"打开摄像头","meeting.refuse.mic.req":"拒绝了你的打开麦克风请求","meeting.refuse.cam.req":"拒绝了你的打开摄像头请求","meeting.request.mic.tip":"请求打开麦克风","meeting.request.cam.tip":"请求打开摄像头","meeting.record.icon":"开启录制","meeting.record.modal.header":"是否开启云录制？","meeting.record.modal.body":"开启后，将录制会议中的音视频画面、共享屏幕内容到云端，并告知所有参会成员。","meeting.record.modal.confirm":"开启","meeting.open.audio.modal.header":"您已静音","meeting.open.audio.modal.body":"无法录制你的语音","meeting.open.audio.modal.cancel":"解除静音并录制","meeting.open.audio.modal.confirm":"继续录制","meeting.record.starting":"录制启动中...","meeting.record.qidongzhong":"启动中","meeting.record.luzhizhong":"录制中","meeting.record.end":"结束录制","meeting.recording.dialog.header":"会议录制中","meeting.recording.dialog.body.member":"会议结束后可通过“历史会议”-“会议详情”查看录制文件","meeting.recording.dialog.body.member.phone":"会议结束后可通过电脑端“历史会议”-“会议详情”查看录制文件","meeting.recording.dialog.body.guest":"会议结束后可联系主持人获取录制文件","meeting.recording.modal.header":"会议正在录制中","meeting.recording.modal.body.member":"你可以在会议结束后通过“历史会议”-“会议详情”查看录制文件","meeting.recording.modal.body.guest":"你可以在会议结束后联系主持人获取录制文件","meeting.recording.modal.body.reminder":"如果留在会议中，表示你同意录制。","meeting.record.end.modal.header":"结束云录制","meeting.record.end.modal.body":"会议结束后可通过“历史会议”-“会议详情”查看录制文件","meeting.record.end.modal.confirm":"结束录制","meeting.record.end.dialog.header":"云录制已结束","meeting.record.end.dialog.body.member":"会议结束后可通过“历史会议”-“会议详情”查看录制文件","meeting.record.end.dialog.body.member.phone":"会议结束后可通过电脑端“历史会议”-“会议详情”查看录制文件","meeting.record.end.dialog.body.guest":"会议结束后请联系主持人获取录制文件","meeting.record.end.dialog.body.network":"网络不佳，录制中断，若需要，请重新开启录制","meeting.history.video.record":"录制{0}","common.gong.n.ge":"共{0}个","meeting.record.download.all":"全部录制","meeting.record.start.fail":"录制启动失败，请稍后再试","meeting.history.record.download.tip":"有正在生成的录制文件，请稍后重试","meeting.screen.share.icon":"共享屏幕","meeting.screen.share.icon.stop":"停止共享","meeting.screen.share.going":"正在共享屏幕","meeting.screen.share.stop":"已停止共享屏幕","meeting.screen.share.start":"已开启共享屏幕，共享屏幕将占用本人头像区域","meeting.screen.share.warning":"为了保护个人隐私和财产安全，在共享过程中，请勿输入密码、进行个人信息验证或使用支付类、银行类产品","meeting.screen.share.cover.title":"你正在共享屏幕","meeting.screen.share.cover.subtitle":"为了避免出现无限循环画面，请勿共享你的当前屏幕或浏览器窗口","meeting.screen.share.change.subtitle":"继续共享将会中断正在进行中的共享，成为新的共享者，是否继续共享？","meeting.screen.share.change.continue":"继续共享","meeting.screen.share.perm.deny.title":"无法共享你的屏幕","meeting.screen.share.perm.deny.subtitle":"请前往系统偏好设置为该浏览器启用 屏幕录制 权限设置好后重启浏览器","meeting.screen.share.perm.deny.action":"前往系统偏好设置","meeting.screen.share.maximize":"最大化","meeting.screen.share.jinzhujiangshare":"仅主讲可以发起共享屏幕","meeting.not.start.yet":"会议暂未开始","meeting.forbid.join.tip":"最多提前15分钟进入会议，你可以提前进入画布访问内容","meeting.list.forbid.join.tip":"会议暂未开始，最多提前15分钟进入会议","meeting.starttime":"会议时间","meeting.perm.editable":"可编辑","meeting.perm.commentable":"可批注","meeting.perm.view":"仅查看","meeting.advance.setting.btn":"会议高级设置","meeting.apply.edit.perm":"申请编辑权限","meeting.apply.edit.perm.sent":"申请已发送","meeting.apply.edit.perm.refused":"主持人拒绝了你的编辑权限申请","meeting.apply.edit.perm.going":"{0} 正在申请编辑权限","meeting.apply.edit.perm.goings":"{0}名成员正在申请编辑权限","meeting.member.perm.apply":"成员权限申请","meeting.perm.apply.none":"暂无申请","meeting.invite.hovertip":"邀请参会成员","meeting.copy.link":"复制会议链接","meeting.edit.perm.tip":"编辑权限:","meeting.set.force.follow":"设置为强制跟随","meeting.unset.force.follow":"取消强制跟随","meeting.identity.presenter":"主讲","meeting.identity.host":"主持","upload.excel.modal.title":"导入Excel为","upload.excel.modal.table":"画布表格","upload.excel.modal.attachment":"表格附件","upload.excel.shuoming.title":"导入“画布表格”说明:","upload.excel.shuoming.item1":"1、最多支持导入5000个单元格的内容","upload.excel.shuoming.item2":"2、若Excel文件存在多个Sheet，将导入多个表格","upload.excel.overlimit.toast":"最多支持导入5000个单元格的内容","export.table.excel":"导出为Excel","media.audio.access.denied.tip":"设置完成后，请手动刷新页面","media.audio.access.denied.label":"麦克风未授权","media.audio.access.denied.content":"请在浏览器的【设置】里授权使用你的麦克风","media.audio.recorder.finish":"完成","media.audio.recorder.restart":"重录","media.audio.recorder.startLabel":"点击开始录音","media.audio.recorder.timeLeft":"剩余","menuBtn.presentation":"演讲模式","menuBtn.rtcMeeting":"视频聊天","more.apps":"更多应用","network.reconnect.start":"网络连接失败，网络恢复后将自动同步画布内容（请在2个小时内重新连网）","network.reconnect.connected":"网络连接成功，正在同步......","network.reconnect.syncFinished":"已与云端保持同步","network.reconnect.failed":"连接失败，请检查网络或刷新页面","shadow.network.reconnect.failed":"额外的画布链接建立失败","operation.redo":"恢复","operation.undo":"撤销","presentation.settings":"设置","presentation.settings.focusMode":"沉浸演示","presentation.close":"关闭","presentation.fullscreen":"全屏","presentation.noFrame":"无帧框","presentation.noFrameWarning":"演讲模式与播放PPT相似，需基于帧框，请先在画布中创建帧框后再来使用演讲模式","presentation.backToCurrentPlaying":"回到当前播放内容","rtc.camera":"摄像头","rtc.closeCamera":"关闭摄像头","rtc.closeMic":"关闭麦克风","rtc.getCameraListfailed":"获取摄像头信息失败，请确保设备可用且已授予麦克风权限","rtc.getMicListFailed":"获取麦克风信息失败，请确保设备可用且已授予麦克风权限","rtc.invite":"发来视频聊天邀请","rtc.join":"加入","rtc.leave":"离开","rtc.membersCount":"参与通话人数：{0}","rtc.memberList":"成员列表","rtc.mic":"麦克风","rtc.openCamera":"打开摄像头","rtc.openMic":"打开麦克风","rtc.setting":"设置","rtc.start":"开始","rtc.enable.audio":"解除静音","rtc.disable.audio":"静音","rtc.enable.video":"开启视频","rtc.disable.video":"关闭视频","rtc.audio.enabled":"已解除静音","rtc.audio.disabled":"已静音","rtc.video.enabled":"已开启视频","rtc.video.disabled":"已关闭视频","rtc.device.tempAudio":"暂时打开麦克风","rtc.device.tempAudio.tip":"长按F2可暂时打开麦克风","rtc.device.denied.title":"麦克风或摄像头没有授权","rtc.device.denied.content":"请在浏览器的【设置】里授权使用你的麦克风或摄像头","rtc.device.denied.link":"查看授权方式","rtc.select.cam":"选择摄像头","rtc.select.mic":"选择麦克风","rtc.member.management":"连麦成员","rtc.speaking":"正在讲话：","rtc.yincangshipinsuoluetu":"隐藏视频缩略图","rtc.zhixianshitakingperson":"只显示正在讲话的人","rtc.xianshichenyuanliebiao":"显示成员列表","rtc.shouqiliebiao":"收起","scaleBar.help":"帮助&互动","scaleBar.hideMap":"关闭导航地图","scaleBar.scaleDown":"缩小","scaleBar.scaleToOrigin":"缩放至100%","scaleBar.scaleUp":"放大","scaleBar.showMap":"打开导航地图","search.icon.hint":"搜索","search.noRes.text":"没有结果","search.noSearchRes":"没有搜索结果","search.username.placeholder":"请输入名称搜索","save.board.hint":"已实时保存至云端","show.all.content":"显示全部内容","sticker.author.hide":"隐藏作者","sticker.author.show":"显示作者","sticker.add":"添加便签","sticker.forbid.input":"可输入字符已达上限","sticker.private.hovertip":"私有便签：该便签在画布上只有自己能够看到","sticker.private.tag":"私有便签","sticker.size":"便签尺寸","sticker.size.l":"大","sticker.size.m":"中","sticker.size.s":"小","sticker.size.valueText":"尺寸","sticker.open":"公开便签","table.title":"新表格","table.cell.op.forbid":"无法进行此操作，因为涉及的单元格或者单元格内的元素正在被其他用户编辑","table.cell.unsupported.eleType":"操作元素中有表格不支持的元素类型","table.delete.row":"删除行","table.delete.col":"删除列","table.insert.row":"插入行","table.insert.col":"插入列","table.label":"表格","table.merge.cell":"合并单元格","table.paste.limit.hint":"复制的行/列超过50条，只粘贴前50条内容","table.paste.dialog.title":"选择粘贴类型","table.paste.dialog.desc":"行*列最大限制：50*50，超过此限制，只粘贴前50行/列的内容","table.paste.dialog.text":"将本地表格里复制的内容粘贴到画布","table.paste.dialog.toTable":"粘贴为表格","table.paste.dialog.toSticker":"粘贴为便签","table.reorder.forbid":"进行此操作需要拆分单元格","table.unmerge.cell":"拆分单元格","text.add":"添加文字","text.align":"文字排列","text.anchor":"插入链接","text.anchor.edit.placeholder":"粘贴链接","text.anchor.edit.content":"文本：","text.anchor.edit.link":"链接：","text.anchor.switchToWebpage.error":"网址不正确","text.color":"文字颜色","text.fontSize":"字号","text.fontSize.auto":"自动","text.highLight":"文字高亮","text.placeholder":"输入文字","text.style":"文字样式","title.download":"导出","title.exportAsImageBtnTip":"导出为图片","title.exportFrameBtnTip":"导出帧框为","mobile.pic.download":"长按图片下载","toolbar.connectLine":"连接线","toolbar.frame":"帧框","toolbar.lineWidth":"粗细","toolbar.mindmap":"思维导图","toolbar.pen":"画笔","toolbar.markPen":"马克笔","toolbar.smartDraw":"智能绘图","toolbar.laser":"激光笔","toolbar.selectMode":"选择","toolbar.selectAndViewMode":"选择/查看","toolbar.shape":"图形","toolbar.sticker":"便签","toolbar.customizedSticker":"贴纸","toolbar.customizedSticker.recent":"最近使用","toolbar.comment":"批注","toolbar.template":"模板中心","toolbar.text":"文本","toolbar.upload":"上传","toolbar.upload.dongtaippt":"动态PPT（需提前上传解析）","toolbar.upload.dongtaippt.desc":"动画和触发器效果","toolbar.upload.dongtaippt.fail":"解析失败","toolbar.upload.file":"文件","toolbar.upload.image":"图片","toolbar.upload.video":"视频","toolbar.upload.audio":"音频","toolbar.upload.supportType":"支持：","toolbar.upload.transcodingFailed":"转码失败","toolbar.xiangpica":"橡皮","toolbar.timer":"计时器","toolbar.bigDoc":"文档","toolbar.upload.explain":"选择内容上传，也可直接拖动内容到画布中","toolbar.download.filecount.overlimit.tip":"最多支持选择20个文件下载","toolbar.download.filesize.overlimit.tip":"批量下载的文件大小已超出{0}，请单个下载","toolbar.download.button.busy.tip":"已有正在下载的文件","ui.openFrameList":"打开帧框列表","ui.closeFrameList":"关闭帧框列表","uploadWidget.upload":"上传","upload.notSupportFiles":"暂不支持该格式的文件","upload.exceedLimitSize":"文件大小限制 {0}","user.boardOwner":"画布拥有者","user.call.all.follow":"召集所有人","user.call.picked.follow":"召集TA","user.following.hint.prefix":"正在跟随","usersCursors.show":"显示当前在画布中成员的光标","usersCursors.hide":"隐藏当前在画布中成员的光标","userCursor.subscribe.failed":"订阅光标用户数量过多，请稍后重试","version.auto.save":"自动保存","version.create.success":"版本创建成功","version.update.success":"版本修改成功","version.delete.success":"版本已删除","version.list.empty":"暂无系统自动生成的版本，如有需要可以点击按钮创建新版本","version.label":"版本","version.new":"新建版本","version.new.throttle":"新建版本过于频繁，请稍后重试","version.update":"编辑版本","version.name":"版本名称","version.delete":"删除版本","version.delete.text.prefix":"确定要删除","version.delete.text.suffix":"吗？删除后将不可恢复","version.duration.hint":"历史版本保存时间为 {0} 天","version.restore.to.new":"恢复到一个新的画布","video.addMarkPoint":"打点","video.editMarkPoint":"编辑打点","video.markingMode":"打点模式","video.markingModeToast":"请使用左侧工具进行编辑","video.comfirmDelete":"确定要删除该打点吗？","video.transcodingPrompt":"正在转码中，预计等待时间 {0} 分钟","video.transcodingFailedPrompt":"转码失败，请重新上传","videoplay.speed":"倍速","videoplay.more.loop":"循环播放","videoplay.more.skipMarkPoint":"跳过打点","ui.userHelper.move.title":"请按照以下提示移动画布","ui.userHelper.move.huadongshuangzhi":"滑动双指移动画布","ui.userHelper.move.changanyoujian":"长按右键移动画布","ui.userHelper.move.changangunlun":"长按滚轮移动画布","ui.userHelper.scale.title":"请按照以下提示缩放画布","ui.userHelper.scale.nieheshuangzhi":"捏合双指缩放画布","ui.userHepler.scale.huadonggunlun":"滑动滚轮缩放画布","guide.welcome.title":"欢迎使用 Infi","guide.welcome.desc":"欢迎使用 Infi，跟随演示快速学会使用左侧工具栏！","guide.stickyNote.title":"写下你的想法","guide.stickyNode.desc":"在工具栏中选择便签，并在便签上记录您的想法...","guide.shape.title":"拟定你的目标","guide.shape.desc":"创建图形，将想法转化为您想要达到的目标...","guide.connectionLine.title":"连接想法和目标","guide.connectionLine.desc":"在想法和目标之间绘制箭头，显示它们之间的关系...","guide.text.title":"制定计划","guide.text.desc":"添加文本，描述你在将想法转化为目标过程中需要制定的计划与策略...","guide.comment.title":"发表评论","guide.comment.desc":"使用批注功能以发表评论，您可以在评论中@团队成员，共同讨论观点...","guide.helperCenter.title":"帮助中心","guide.helperCenter.desc":"入门指南到此结束，想要查看更多请进入帮助中心...","guide.btn.nextStep":"下一步","guide.btn.prevStep":"上一步","guide.btn.try":"我知道了","guide.btn.start":"现在开始","webpage.header.info":" 仅在会议中同步","webpage.header.preview.tip":"仅主讲能够预览网页","webpage.header.preview":"网页预览","webpage.header.cancelPreview":"取消预览","template.insert.hint":"请轻点画布以插入选择的模板","template.edit.hint":"编辑模板信息","template.save.success":"保存成功，可在模板中心查看","template.save.fail":"保存失败","template.save.empty":"暂不支持保存为空模板","template.save.exit":"保存并退出","webpage.insert.error":"网址不正确，请检查修改","webpage.insert.placeholder":"输入网址或嵌入第三方链接","webpage.insert.title":"嵌入网页","webpage.label":"网页","webpage.nodesc":"未找到该网站的描述信息","webpage.notitle":"无标题","webpage.openLink":"打开链接","webpage.toolbar.textMode":"文本链接","webpage.toolbar.webpageMode":"网页窗口","info.createTime":"创建时间：","info.creator":"创建人：","info.updateTime":"修改时间：","info.updatePerson":"最后修改人：","timer.label":"定时器","timer.start":"开始","timer.pause":"暂停","timer.stop":"结束","timer.5m":"5分钟","timer.15m":"15分钟","timer.30m":"30分钟","timer.custom":"自定义","timer.add1":"增加1分钟","timer.add5":"增加5分钟","timer.check":"去查看","timer.check.short":"查看","timer.overtime":"已超时","timer.overtime.text":"倒计时结束，将继续为您监控时间","timer.overtime.text.short":"倒计时结束","timer.zanbujieshu":"暂不结束","timer.jieshudingshi":"结束定时","timer.dingshijieshu":"定时结束！","timer.start.timer":"开始了定时器","timer.pause.timer":"暂停了定时器","timer.stop.timer":"结束了定时器","timer.add1.timer":"增加1分钟","timer.add5.timer":"增加5分钟","shape.switch":"图形切换","ai.icon":"Infi AI","ai.options.generate.mindmap":"生成思维导图","ai.options.generate.mindmap.disabled":"删除所有子节点后才可生成","ai.options.expand.questions":"以问题形式展开","ai.options.expand.ideas":"以想法形式展开","ai.options.expand.topics":"以话题形式展开","ai.using.tip":"正在生成内容...","ai.using.stop":"停止","ai.using.done":"生成内容结束","ai.common.addsticker":"添加类似的便签","ai.common.addtodo":"生成待办","ai.common.addsummary":"生成概要","ai.common.translate":"翻译","ai.common.translate.target":"目标语言","ai.common.translate.chinese":"中文","ai.common.translate.english":"英文","ai.common.translate.japanese":"日语","ai.common.translate.korean":"韩语","ai.common.translate.france":"法语","ai.common.translate.german":"德语","ai.common.translate.russian":"俄语","ai.error":"生成内容失败","ai.center.title.dashboard":"AI助手","ai.center.restcount":"团队剩余会话","ai.center.restcount.unit":"次","ai.center.restcount.tip":"本月赠送剩余 {0} 次 + 团队购买剩余 {1} 次，优先消耗赠送次数","ai.center.placeholder.chat":"请输入问题，让AI帮你找到答案","ai.center.placeholder.mindmap":"请输入主题，让AI帮你梳理思路","ai.center.placeholder.todo":"请输入待办主题，让AI帮你高效规划","ai.center.placeholder.translate":"请输入原文，让AI帮你精准翻译","ai.center.placeholder.sticker":"请输入话题，让AI帮你无限联想","ai.center.placeholder.aippt":"请输入主题，让AI帮你生成演示文稿","ai.center.placeholder.doc":"请输入主题，让AI帮你生成文档","ai.center.generate.chat":"互动问答","ai.center.generate.mindmap":"生成思维导图","ai.center.generate.todo":"生成待办","ai.center.generate.translate":"翻译助手","ai.center.generate.sticker":"创意联想","ai.center.generate.aippt":"生成演示文稿","ai.center.generate.doc":"生成文档","ai.center.generate.polish":"文案润色","ai.center.polish.business":"商务正式","ai.center.polish.concise":"精炼简短","ai.center.polish.poems":"诗词歌赋","ai.center.polish.academic":"学术风","ai.center.polish.colloquial":"口语化","ai.center.toast.notAllow":"你没有编辑权限，内容无法在画布中生成","ai.center.toast.notAllow.export":"你没有编辑权限，内容无法导入画布","ai.center.count.remain":"剩余AI会话次数为","ai.center.chat.stop":"停止生成","ai.center.chat.clear.tip":"清空会话内容","ai.center.chat.clear.confirmation":"确定清空当前所有会话吗？","ai.center.chat.clearone.confirmation":"确定删除当前会话吗？","ai.center.export.to.board":"导入画布","ai.center.export.to.board.success":"导入成功","ai.center.chat.clear.bt":"清空","ai.center.chat.clearone.bt":"删除","ai.center.chat.nohistory":"暂无会话","ai.center.copy.success":"复制成功","ai.center.copy.fail":"复制失败","ai.center.noremain.phone":"AI会话次数为0，请使用电脑购买","modal.cancel":"取消","modal.ok":"确定","common.tap.insert":"轻点画布插入批注","mindmap.expand.all":"展开所有子节点","mindmap.collapse.all":"收起所有子节点","upload.image.video":"图片和视频","upload.takePhoto":"拍照","upload.file":"选择文件","xmode.enter.view":"已进入查看模式","xmode.exit.view":"已退出查看模式","kanban.no.group":"未分组","kanban.no.name.placeholder":"请输入卡片标题","kanban.label":"看板","kanban.default.name":"看板标题","kanban.create.card":"新建卡片","card.label":"卡片","card.attr.none":"无","card.attr.priority":"优先级","card.attr.priority.high":"高优先级","card.attr.priority.middle":"中优先级","card.attr.priority.low":"低优先级","card.attr.status":"状态","card.attr.status.todo":"待开始","card.attr.status.doing":"进行中","card.attr.status.done":"已完成","card.attr.description":"描述","card.attr.color":"卡片颜色","card.title.placeholder":"请输入卡片标题","card.radio.placeholder":"请添加","card.file.upload.placeholder":"请上传","card.desc.placeholder":"请输入描述","card.edit.tooltip":"编辑","card.edit.none":"无","card.attr.participant":"参与人","card.attr.startendtime":"开始/截止日期","card.attr.startendtime.start":"开始日期","card.attr.startendtime.start.short":"开始","card.attr.startendtime.end":"截止日期","card.attr.startendtime.end.short":"截止","card.attr.startendtime.placeholder":"年 / 月 / 日","card.attr.startendtime.errortext":"截止日期不能早于开始日期","card.attr.attachment":"附件","card.attr.attachment.upload":"上传附件","card.attr.filelist.uploading":"附件上传中","kanban.group":"分组","kanban.group.tip":"设置分组条件","common.placeholder.enter":"请输入","common.search.none":"暂无搜索结果","common.year":"年","card.total.user":"共{0}人","kanban.config.label.short":"看板配置","kanban.config.label":"看板配置","kanban.config.basic.option":"通用属性","kanban.config.custom.option":"自定义属性","kanban.config.custom.option.add":"添加自定义属性","kanban.config.attr.name":"属性名称","kanban.config.attr.type":"属性类型","kanban.config.attr.option":"选项内容","kanban.config.attr.option.create":"添加选项","kanban.config.attr.delete":"删除此属性","kanban.config.attr.save":"保存","kanban.config.attr.save.ok":"保存成功","kanban.config.attr.delete.confirm":"确定要删除【{0}】属性吗？","kanban.config.attr.delete.tip":"删除属性后，设置过此属性的卡片将清除此属性","kanban.config.attr.duplicate.name":"名称重复，请重试","kanban.config.attr.radio":"单选","kanban.config.attr.checkbox":"多选","kanban.config.attr.timeRange":"日期","kanban.config.attr.userList":"人员","kanban.config.attr.fileList":"附件","kanban.config.attr.richText":"多行文本","kanban.config.attr.empty":"暂无内容","kanban.attr.create":"新建分组","kanban.attr.create.action":"新建","kanban.attr.select.color":"选择颜色","kanban.attr.create.error":"分组名称重复，请重试","kanban.attr.create.group.left":"向左添加分组","kanban.attr.create.group.right":"向右添加分组","kanban.attr.delete.group":"删除分组","kanban.config.group.delete.confirm":"确定要删除【{0}】分组吗？","kanban.config.group.delete.tip":"删除分组后，分组中的卡片将移到未分组中","common.please.select":"请选择","kanban.attr.group.duplicate.tip":"已存在{0}的分组，请重新选择","kanban.usepc.attr":"请到电脑/Pad端登录后使用","kanban.enter.gourp.name":"请输入分组名称","kanban.empty.group":"选项不可为空，请添加选项","kanban.title.tip":"仅在本看板内生效","kanban.upload.tip":"或拖拽/粘贴文件到此处上传","tool.box.title":"工具箱","tool.box.title.tip":"按住图标拖动，可调整顺序或移到左侧工具栏","tool.box.title.tip.tiny":"按住图标可拖动调整顺序","tool.box.app.center":"应用中心","tool.box.app.tocome":"敬请期待","tool.box.pin.tool":"固定到工具栏","tool.box.unpin.tool":"取消固定","tool.box.empty.tip":"拖动到此处取消固定","line.text.add":"添加文字","line.text.place":"文字位置","shape.panel.addmore":"更多图形","shape.panel.addmore.tip":"基础图形、流程图等","graphic.sidebar.title":"图形库","graphic.sidebar.title.open":"展开全部图形列表","graphic.sidebar.title.close":"收起全部图形列表","graphic.sidebar.search.placeholder":"搜索图形名称","graphic.sidebar.colorpalettes.default":"默认主题","graphic.swinLane.hor.name":"水平泳道","graphic.swinLane.ver.name":"垂直泳道","graphic.swinLane.default.title":"标题","ai.gen.ppt":"生成演示文稿","ai.gen.ppt.error":"暂不支持所选内容超出{0}字的AI生成，本次点数未扣除","voting.name":"投票","voting.create":"新建投票","voting.history":"历史投票","voting.history.empty.tip":"暂无投票","voting.title.others":"{0}发起了【{1}】投票","voting.title.self":"我发起了【{0}】投票","voting.ongoing":"进行中","voting.realname":"实名","voting.anonymous":"匿名","voting.voted.users":"{0}人已投","voting.joinnow":"立即参与","voting.invitation.copy":"复制链接邀请","voting.invitation.copy.success":"复制成功","voting.qrcode.generate":"生成投票二维码","voting.qrcode.join.tip":"扫码参与投票","voting.votes.total":"可投票数","voting.votes.voted":"已投票数","voting.duration.left":"剩余时间","voting.end":"结束投票","voting.end.confirm.title":"确定要结束本次投票吗","voting.end.confirm.content":"当前已有 {0} 人完成投票，结束后，所有人都将退出投票","voting.end.cancel":"暂不结束","voting.end.confirm":"结束投票","voting.create.area.tip.1":"1、拖动或缩放区域选择框来设置投票参与人的可见区域","voting.create.area.tip.2":"2、进入投票的参与人仅能看到该可见区域的内容","voting.create.name":"投票主题","voting.create.tickets":"每人可投票数","voting.create.duration":"投票时长","voting.create.duration.option.minutes":"{0}分钟","voting.create.duration.option.hours":"{0}小时","voting.create.duration.option.unlimited":"不限时","voting.create.anonymous":"匿名投票","voting.create.objects":"投票对象","voting.create.select.all":"全选","voting.create.select.none":"取消全选","voting.create.confirm":"开始投票","voting.create.confirm.object.empty.tip":"请先选择投票对象","voting.create.select.object.tip":"请调整左侧投票可见区域，并选择该区域内的“便签、文本、图形、帧框、图片、卡片”作为投票对象","voting.create.object.empty.tip":"当前区域无可投票对象，请移动或缩放区域选择框，确保投票对象完全位于区域选择框内","voting.create.failed.only.one":"创建失败，一个画布只能同时发起一场投票","voting.create.failed.common":"创建失败","voting.back.to.area":"返回投票区","voting.more":"更多","voting.leave":"离开","voting.done":"提交投票","voting.tickets.noleft":"可投票数不足，最多为{0}票","voting.submit.confirm.title":"确定要提交投票吗","voting.submit.confirm.body.tickets.left":"当前你还有 {0} 票未投出，提交后不能再修改","voting.submit.confirm.body.tickets.empty":"提交后不能修改","voting.submit.cancel":"继续投票","voting.submit.confirm":"确认提交","voting.results":"投票结果详情","voting.tickets.users.voted":"{0}票","voting.tickets.self.voted":"我投{0}票","voting.preview":"预览","voting.result.view":"查看结果","voting.notification.ended":"投票已结束，可查看投票结果","voting.delete.confirm.title":"确定要删除当前投票记录吗","voting.delete.confirm.cancel":"取消","voting.delete.confirm.confirm":"删除","voting.export.to.excel":"导出为Excel","voting.export.to.board":"导入画布","voting.export.notAllow.toast":"你没有编辑权限，内容无法导入画布","voting.mobile.create.tip":"暂不支持发起投票，请在PC或Pad端操作","voting.voted.tip":"你已投票","voting.invite.ended.tip":"投票已结束，你未参与投票","voting.element.sticker":"便签","voting.element.text":"文本","voting.element.shape":"图形","voting.element.frame":"帧框","voting.element.image":"图片","voting.element.card":"卡片","voting.tip.no.left.tickets":"你已投完所有的票","voting.instructions.title":"投票说明:","voting.instructions.hovertip.1":"1、一个画布只能同时发起一场投票;","voting.instructions.hovertip.2":"2、支持对画布中的“便签、文本、图形、帧框、图片、卡片”进行投票，例如：一个文本框即为一个投票对象","voting.instructions.content.1":"一个画布只能同时发起一场投票;","voting.instructions.content.2.1":"支持对画布中的“","voting.instructions.content.2.2":"便签、文本、图形、帧框、图片、卡片","voting.instructions.content.2.3":"”进行投票，例如：一个文本框即为一个投票对象","voting.voting.area.tip":"投票参与人可见区域（选择区域内元素作为投票对象）","voting.toolbar.leave":"退出","voting.toolbar.submit":"提交","voting.export.table.name":"【{0}】的投票结果","voting.export.title.ranking":"排名","voting.export.title.content":"投票内容","voting.export.title.tickets":"获得票数","voting.export.title.percent":"占总投票数比例","voting.export.title.voters":"投票人","kanban.setting.filter.tip":"当前看板正在筛选中，如需查看所有内容请清空条件","kanban.setting.filter.noauth":"当前看板正在筛选中，部分内容未显示","kanban.filter.title":"设置筛选条件","kanban.filter.title.tip":"多个筛选条件时取交集","kanban.filter.title.clear":"清空","kanban.filter.add":"添加条件","kanban.filter.title.content":"卡片标题内容","kanban.filter.type.include":"包含","kanban.filter.type.equal":"等于","kanban.filter.label":"筛选","kanban.filter.label.multi":"筛选","kanban.order.label":"排序","kanban.order.label.multi":"排序","kanban.order.edit.title":"设置排序条件","kanban.order.radio.asc":"选项顺序","kanban.order.radio.desc":"选项倒序","kanban.order.text.asc":"A ➞ Z","kanban.order.text.desc":"Z ➞ A","kanban.order.common.asc":"升序","kanban.order.common.desc":"降序","kaban.userlist.send":"同时发送通知","kanban.hide.tip":"操作成功，当前看板正在筛选中，部分内容未显示"}),{"toolbar.customizedSticker.empty":"没有搜索结果","toolbar.customizedSticker.license":"版权信息","toolbar.customizedSticker.placeholder":"搜索贴纸","toolbar.customizedSticker.source":"来源 {0}","uploadModule.btn.upload":"上传","uploadModule.btn.uploading":"上传中","uploadModule.btn.uploaded":"上传完成","uploadModule.status.success":"上传成功","uploadModule.status.fail":"上传失败"}),L=B;var O=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return F.apply(void 0,R([L,e],t,!1))};function F(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=e[t];if(!r)return"";if(n.length>0){var o=function(e){for(var t=[],n=new RegExp(/\{(\d+)\}/,"gm"),i=0,r=n.exec(e);r;){var o=r.index;if(o>i){var a=e.substring(i,o);t.push(a)}var s=parseInt(r[1]);t.push(s),i=o+r[0].length,r=n.exec(e)}return e.length>i&&(a=e.substring(i,e.length),t.push(a)),t}(r);return o.map((function(e){return"string"==typeof e?e:n[e]})).join("")}return r}var z=exports.E(exports.E(exports.E({},B),{"audio.element.label":"Audio","all.group.members":"All members","bigDoc.align.left":"Align left","bigDoc.align.center":"Align center","bigDoc.align.right":"Align right","bigDoc.indent.increase":"Increase indent","bigDoc.indent.reduce":"Reduce indent","bigDoc.indentAndAlign":"Indent and align","bigDoc.default.name":"文档标题","bigDoc.placeholder":"Please enter","bigDoc.nodeType.rawText":"Body text","bigDoc.nodeType.h1":"Heading 1","bigDoc.nodeType.h2":"Heading 2","bigDoc.nodeType.h3":"Heading 3","bigDoc.nodeType.orderedList":"Numbered list","bigDoc.nodeType.list":"Bulleted list","bigDoc.selectAll.toast":"Press {0} again to select all","color.remove.default.hint":"Cannot remove default color","comment.add":"Add comment","comment.draft.placeholder":"Add comment, @ others","comment.draft.placeholder.no.at":"Add comment","comment.resolved.label":"Resolved","comment.unresolved.label":"Unresolved","comment.add.reply":"Add reply, @ others","comment.add.reply.no.at":"Add reply","comment.submenu.pin":"Pin","comment.submenu.copyLink":"Copy object link","comment.submenu.delete":"Delete","comment.message.edit.save":"Save","comment.message.edit.cancel":"Cancel","comment.message.edit.delete":"Delete","comment.message.updated":"Updated","comment.listMenu.icon.hint":"Comments","comment.listMenu.hideResolve":"Hide resolved","comment.listMenu.showResolve":"Show resolved","comment.listMenu.readAll":"Read all","comment.listMenu.unfoldMessages":"Show {0} replies","comment.listMenu.unfoldUnreadMessages":"Show {0} new replies","comment.listMenu.foldMessages":"Hide replies","comment.listMenu.noComment":"No comment yet","comment.listMenu.showAllBoardComments":"Show comments","comment.listMenu.hideAllBoardComments":"Hide comments","comment.upload.file.number.limit":"Up to 9 files at once","comment.upload.file.size.limit":"Limited to 2G","comment.upload.file.invalid.type":"This format not supported yet","comment.upload.file.empty.hint":"Need a file","comment.message.delete.confirm":"Sure to delete this content?","comment.file.deleted.hint":"The file has been deleted","comment.pending.deleted.hint":"This content has been deleted and the file upload has been terminated","comment.file.upload.failed":"Upload failed, click to retry","comment.filter.placeholder":"Search","comment.export.all":"Export all annotations","common.basics":"Basics","common.cancel":"Cancel","common.common":"Common","common.cut":"Cut","common.confirm":"Confirm","common.queding":"OK","common.wu":"None","common.delete":"Delete","common.delete.success":"Delete successful","common.delete.failed":"Deletion failed","common.send":"Send","common.download":"Download","common.phone.download.toast":"Image download is not supported on mobile, please use PC or Pad to download","common.edit":"Edit","common.edit.success":"Edit successful","common.edit.fail":"Edit failed","common.finish":"Finish","common.fold":"Fold","common.unfold":"Show","common.moretool":"More","common.insert":"Insert","common.check.detail":"Details","common.me":"Me","common.people":"people","common.modify":"Modify","common.new":"New","common.paste":"Paste","common.save":"Save","common.selectAll":"All","common.noclipboard.tip":"No access to the clipboard, please use Ctrl+V or enable it in brower settings","common.ruhecaozuo":"Help","common.preview":"Preview","common.reply":"Reply","common.transcoding":"Transcoding in progress. Estimated wait time: ","common.minutes":"minutes","common.transcoding.fail":"Transcoding failed. Please upload again","common.upload.progress":"Uploaded {0}","common.upload.auvi":"Audiovisual","common.suoyouren":"All","common.more":"More","common.you":"You","common.continue":"Continue","common.agree":"Agree","common.refuse":"Refuse","common.chakan":"View","common.faqiren":"Creator","common.rename":"Rename","common.iknow":"Ok","common.advance.setting":"Advanced Settings","common.backtocvs":"Back canvas","common.nomoreToast":"No more reminders","connectLine.endPoint":"Line end","connectLine.lineType":"Line Type","connectLine.startPoint":"Line start","datetime.today":"Today","datetime.tomorrow":"Tomorrow","datetime.yesterday":"Yesterday","datetime.Monday":"Monday","datetime.Tuesday":"Tuesday","datetime.Wednesday":"Wednesday","datetime.Thursday":"Thursday","datetime.Friday":"Friday","datetime.Saturday":"Saturday","datetime.Sunday":"Sunday","datetime.Monday.short":"Mo","datetime.Tuesday.short":"Tu","datetime.Wednesday.short":"We","datetime.Thursday.short":"Th","datetime.Friday.short":"Fr","datetime.Saturday.short":"Sa","datetime.Sunday.short":"Su","datetime.January":"January","datetime.February":"February","datetime.March":"March","datetime.April":"April","datetime.May":"May","datetime.June":"June","datetime.July":"July","datetime.August":"August","datetime.September":"September","datetime.October":"October","datetime.November":"November","datetime.December":"December","datetime.day":" {0}","datetime.year":"{0} ","datetime.month.day":"{0} {1}","document.setStartPage":"Start page","document.startPageIs":"Start page is","document.goToStartPage":"Go to","document.setAsStartPage":"Set current page as start","document.extract":"Extract pages","document.extractBtnLabel":"Extract","document.extractPanelTitle":"Extract pages:","document.extractAllOption":"All","document.extractPanelInputHint":"Example: 1-6, 9, 12-14","document.parsingPrompt":"Parsing is in progress. Estimated wait time : {0} minutes.","document.parsingFailedPrompt":"Parsing failed. Please upload again.","element.align":"Align","element.bg":"Fill color","element.bg&opacity":"Set color and opacity","element.borderStyle":"Border style","element.bringToFront":"Bring to front","element.opacity":"Opacity","element.borderWidth":"Line width","element.color":"Color","element.copy":"Copy","element.clone":"Clone","element.delete":"Delete","element.delete.already":"Object has been deleted","element.info":"Info","element.lock":"Lock","element.lock.condition.by.owner":"Unlocked by owner and admin","element.lock.condition.by.everyone":"Unlocked by everyone","element.longPressUnLock":"Unlock","element.makeGroup":"Group objects","element.more":"More...","element.sendToBack":"Send to back","element.splitGroup":"Ungroup objects","element.unlock":"Long press to unlock","element.filter":"Filter","element.count":"{0} objects","element.rename":"Rename","element.frame.delete":"Delete the frame only","element.saveCustomTemplate":"Save as custom template","exportImage.title":"Export as image","exportImage.description":"Free to download large image during Beta","export.board.confirm":"Export","exportImage.l":"Large","exportImage.m":"Medium ","exportImage.s":"Small","exportPdf.title":"Download as PDF","exportPdf.common":"Standard","exportPdf.best":"High Quality","exportPdf.tip":"Free to download high quality during Beta.","exportPdf.noFrameWarning":"Need to create frames first.","exportPdf.description":"1. PDF is based on frames\n2. Each frame in the canvas corresponds to one page in the PDF\n3. The page order in the PDF is the same as that of the frames on the frame list","exportPdf.mustCreateFrame":"Thus, at least one frame is necessary to create PDF","exportPdf.createFrame":"Create Frame","export.frame":"Export","export.as":"Export as","export.frame.count.overlimit.tip":"Export up to {0} frames at once","export.frame.as.ppt":"PowerPoint","export.frame.as.image":"Image","export.frame.tip.1":"1. PDF/PowerPoint/image are exported based on frames","export.frame.tip.2":"2. Each frame in the canvas corresponds to one page in the files","export.frame.tip.3":"3. The page order in the files is the same as that of the frames on the frame list, please adjust the order of the frames on the frame list if you need to adjust order","export.image.zip.tip":"If the quantity exceeds 5, they will be exported as a compressed file","export.frame.select.all":"Select all","export.progress.tip":"File in progress...","export.frame.empty.tip":"At least one frame needs to be created in the canvas in order to export","contextmenu.exportFrameBtn":"Export frame as","export.frame.dialog.confirm":"Export","export.frame.as.pdf.clarity":"Clarity","export.frame.as.image.dimensions":"Image dimensions","export.frame.as.image.dimensions.little":"Small (original size)","export.frame.as.image.dimensions.medium":"Medium","export.frame.as.image.dimensions.large":"Large","export.frame.file.name":"File name","follow.nAreFollowing":"{0} are following","follow.oneIsFollowing":"{0} is following","follow.call.for.follow":"Invite to follow","follow.call.for.follow.confirm":"Follow","follow.call.for.follow.reject":"Cancel","follow.force":"Force follow","follow.label":"Follow","follow.cancel.force":"Unforce follow","follow.resume":"Back to follow","frame.title":"frame","follow.called":"Invitation to my perspective has been sent.","follow.click.follow":"Click to follow","follow.click.unfollow":"Click to cancel following","grouptalk.createTalk":"Breakout Rooms","grouptalk.create.fail":"The canvas has already created breakout rooms，please try again later","grouptalk.name":"Breakout Rooms","grouptalk.group.count":"Rooms","grouptalk.content":"Contents","grouptalk.desc":"Use same frame for each breakout room","grouptalk.choose.content":"Pick a frame","grouptalk.choose.content.benzu":"Pick a frame","grouptalk.zuyuan":"Attendees","grouptalk.automode":"Assign automatically","grouptalk.manuelmode":"Assign manually","grouptalk.freemode":"Let attendees choose room","grouptalk.freemode.desc":"After creation,  members will receive an invitation to breakout room and can choose to join any room before starting","grouptalk.automode.desc":"Automatically distribute into rooms","grouptalk.manualmode.desc":"Manually distribute members into rooms","grouptalk.create":"Create","grouptalk.pingjunmeizu":"{0}~{1} per room","grouptalk.jijiangkaishi":"Breakout rooms created by {0} will start soon","grouptalk.lijichakan":"Check","grouptalk.bukelikai":"Cannot leave after starting","grouptalk.leave":"Leave","grouptalk.join":"Join","grouptalk.kaishitaolun":"Start","grouptalk.dismiss":"Dissolve","grouptalk.stop":"Stop","grouptalk.sure.stop":"Sure to stop the breakout rooms?","grouptalk.jieshu":"Stop","grouptalk.quxiao":"Cancel","grouptalk.zijineirong":"Can only see the contents of your own room","grouptalk.zijineirong.zuyuan":"You can only see the content of your breakout room while in discussion；If adjust your group or leave, please contact the creator","grouptalk.zijineirong.pangguan":"You have not been assigned to a breakout room. If you wish to participate, please contact the creator","grouptalk.sure.delete.zu":"Sure to delete?","grouptalk.suozaifenzu":"Joined","grouptalk.benzuchengyuan":"Joined","grouptalk.qita":"Others","grouptalk.weijiaruzu":"Unassigned","grouptalk.yijiaruzu":"Other rooms","grouptalk.zanwuchengyuan":"No result","grouptalk.pick.tip":"Pick the frame that contains the discussion content","grouptalk.pick.exit":"Exit","grouptalk.join.zu":"has joined the room","grouptalk.leave.zu":"has left the room","grouptalk.yijinru":"You just joined ","grouptalk.kaishi.tip":"Pick frames before starting","grouptalk.nopermision.tip":"Only team members with editing permissions can create breakout rooms","grouptalk.daikaishi.tip":"Not started","grouptalk.sure.dismiss.talk":"Sure to dissolve breakout rooms?","grouptalk.dismiss.btn":"Dissolve","grouptalk.taolunzu":"Room ","grouptalk.dezhenkuang":"'s frame","grouptalk.going":"Breakout Rooms","grouptalk.lianmai":"Call","grouptalk.backtoframe":"Back","grouptalk.present":"Calling","grouptalk.absent":"Not Joined","grouptalk.preventMeetingToast":"Can not join meeting in  breakout rooms,  please use break room's  voice call.","grouptalk.call.modal.title":"Already joined the breakout room, would you like to enable voice chat within the group？","grouptalk.call.modal.subtitle":" ","grouptalk.call.modal.action.later":"Later","grouptalk.call.modal.action.enable":"Enable","grouptalk.rechoose.btn":"Repick the frame","grouptalk.user.search.placeholder":"Search by name","grouptalk.group.members":"Members","grouptalk.end":"Breakout Rooms stoped","grouptalk.enter.modal.title":"Breakout rooms is beginning","grouptalk.enter.modal.subtitle":"You have entered breakout room, and you cannot leave. If you need to leave or adjust your group, please contact the initiator.","frame.ratio":"Ratio","frame.ratio.custom":"Custom","frame.hide":"Hide frame","frame.hided":"Frame is hidden","frame.unhide":"Show frame","frame.createFrame":"Create frame","frame.unhide.condition.by.owner":"Shown by owner and admin","frame.partial.unhidable.hint":"Shown by owner and admin","frame.unhide.condition.by.everyone":"Shown by everyone","frameList.addNewFrameBelow":"Add a frame below","frameList.close":"Close","frameList.createFrame":"Create","frameList.newFrame":"Create frame","frameList.empty":"No frames","frameList.noFrameTip":"No frames yet","frameList.rename":"Rename","frameList.title":"Frames","frameList.playPresentation":"Play","frameList.stopPresentation":"Stop","frame.hide.copy.hint":"Includes hidden frames and cannot be pasted","fullscreen.enter":"Fullscreen","fullscreen.exit":"Exit","fullscreen.showOrHideToolbar":"Show/Hide toolbar","helpCenter.title":"Help & Feedback","history.activity.empty.list":"No activity yet","history.op.record":"History","history.title":"History","history.version":"Versions","history.activity.restore.forbidden":"The record cannot be recovered yet.","hyperlink.discard":"Remove","image.customSize":"Custom Size","image.cut":"Cut","image.halfSize":"Half size","image.originSize":"Original size","init.viewbox.pick.title":"Set the initial view","init.viewbox.pick.desc":"(applies to new members)","license.error.code.prefix":"Infi canvas initialization failed due to: ","license.error.code.unknown":"Unknown error, please contact Infi team for support","license.error.code.103":"Infi License expired","license.error.code.104":"Infi License not yet enabled","license.error.code.105":"Invalid Infi License","license.error.code.106":"Server timestamp abnormal","license.error.code.107":"Exceeds the maximum concurrent number of links","license.error.code.109":"Server version abnormal","link.linkTarget":"Link to","link.description":"Pick an object on the canvas or paste a URL link","line.width":"Line width","link.add":"Link to","link.edit":"Edit link","link.paste":"Paste link","link.copy":"Copy link","link.delete":"Delete link","link.copy.success.toast":"Object link copied","mindmap.alignNode":"Align","mindmap.changeTheme":"Themes","mindmap.nodeColor":"Color","mindmap.nodeColorRandom":"Random colors","mindmap.connection.line":"Connection line","meeting.autojoin.confirm.title":"Invitation to join meeting","meeting.autojoin.title":"Join meeting","meeting.autojoin.content":"Meeting topic: {0}","meeting.iconBtn.tooltip":"Meeting","meeting.reserve.success":"Meeting reserved successfully","meeting.reserve.failed":"Meeting reservation failed. Please check your network and try again later or refresh the page.","meeting.update.success":"Meeting updated successfully","meeting.quick.label":"Start","meeting.reserve.label":"Schedule","meeting.title.history":"Past Meetings","meeting.title.detail":"Meeting Details","meeting.record.none":"No recorded file","meeting.record.gening":"Generating the recording file...","meeting.audio.to.text":"Convert the recording to text","meeting.textRecord.gening":"Transcript is being generated，please check back later","meeting.record.gening.failed":"Generation failed","meeting.history.delete.confirm":"Sure to delete the past meetings?","meeting.textRecord":"Text recording","meeting.list.history.empty":"No past meetings","meeting.text.history.empty":"No written record","meeting.creator":"Creator","meeting.list.empty":"No meetings available","meeting.status.pending":"Upcoming","meeting.status.onGoing":"In progress","meeting.join":"Join","meeting.ignore":"Ignore","meeting.aboutToStart":"Meeting will start soon","meeting.alreadyStart":"Meeting is ongoing","meeting.copyLink":"Invite","meeting.link":"Invite","meeting.copyLink.link":"Copy invitation","meeting.gen.qrcode":"Generate meeting QR code","meeting.link.copied":"Meeting invitation copied","meeting.edit":"Edit","meeting.cancel":"Delete","meeting.invite":"Invite","meeting.member.management":"Members ({0})","meeting.member.management.label":"Members","meeting.member.management.label.popup":"Meeting members","meeting.member":"Members ({0})","meeting.member.label":"Members","meeting.member.label.popup":"Meeting members","meeting.search.member":"Search","meeting.laser":"Laser","meeting.pre.page":"Previous","meeting.next.page":"Next","meeting.end":"End","meeting.leave":"Leave","meeting.cancel.dialog.content":"Members will not be able to enter the meeting after cancellation","meeting.cancel.dialog.reject":"Cancel","meeting.already.ended":"Meeting already ended.","meeting.absent":"Not Joined","meeting.present":"Ongoing","meeting.host":"Host","meeting.cohost":"Co-host","meeting.cohost.upgrade":"Please use PC to upgrade","meeting.visitor":"Visitor","meeting.set.cohost":"Set as co-host","meeting.cancel.cohost":"Remove co-host","meeting.endBy.host":"Meeting already ended.","meeting.end.confirm":"Got it","meeting.host.enter":"You have entered the meeting, all participants will remain in sync with you","meeting.reach.rtcHost.limit":"Unable to enable, only supports up to {0} audio/video participants","meeting.audio.disabledByHost":"The host has muted your audio","meeting.video.disabledByHost":"The host has turned off your video","meeting.add.joiners":"Add members","meeting.all.following":"Everyone is following {0}","meeting.list":"Meeting List","meeting.preserve.failed.toast":"Currently not supported, please operate on PC or Pad","meeting.video.mirror":"Mirror Mode","meeting.list.forbidden":"No permission to view meeting details","meeting.conflict.dialog":"You have joined the meeting on another device. Current device has been removed from the meeting","meeting.cur.channel":"Ongoing","meeting.not.exist":"The meeting does not exist","meeting.cancel.failed":"Unable to cancel the meeting","meeting.already.canceled":"The meeting has been cancelled","meeting.edit.failed":"Failed to modify the meeting","meeting.edit.success":"The meeting has been modified successfully","meeting.frame.deleted":"The frame has been deleted","meeting.discard.edit.title":"Exit editing","meeting.discard.edit.content":"The meeting information will not be saved","meeting.discard.edit.cancel":"Continue","meeting.discard.edit.confirm":"Exit","meeting.follow.it":"Follow","meeting.following.it":"Following","meeting.click.to.follow.user":"Click to follow {0}'s perspective","meeting.following.user.view":"Following {0}'s perspective","meeting.addJoiners.success":"Participants added successfully","meeting.addJoiners.failed":"Failed to add participants","meeting.enable.laser.failed":"Failed to enable laser pointer","meeting.user.absent":"{0} is not in the meeting","meeting.user.joined.postfix":"has joined the meeting","meeting.user.left.postfix":"has left the meeting","meeting.get.meeting.link.failed":"Failed to generate meeting link","meeting.view.locked.view.hint":"The host has set enforced following, you cannot move the view. You can apply for permission from the host","meeting.view.locked.view.hint.host":"You have set yourself as enforced following, you cannot move the view","meeting.view.locked.presentation.hint":"Force follow, unable to demonstrate","meeting.force.follow.hint":"When enabled, participants cannot leave following","meeting.move.avatar.top":"Top","meeting.cancel.avatar.top":"Un-top","meeting.user.avatar.top.hint":"{0} on top","meeting.user.avatar.untop.hint":"Un-top","meeting.open.independent.view":"Pop out","meeting.independent.view.opened":"Pop out","meeting.close.independent.view":"Close","meeting.enter.nickname.hint":"nickname","meeting.daoruhuabu":"Import to canvas","meeting.fuzhijilu":"Copy record","meeting.fuzhijiyao":"Copy summary","meeting.canhuiren":"Attendees","meeting.huiyijiyao":"Meeting minutes","meeting.ai.gen.jiyao":"AI generated meeting minutes","meeting.gening.jiyao":"AI is generating meeting minutes, please check back later","meeting.jiyao.emtpy":"There is no text record , unable to generate meeting minutes","meeting.history.audio.download":"Download recording","meeting.history.audio.download.tip":"Only the host can download","meeting.yichuhuiyi":"Remove","meeting.yichuhuiyi.tip":"You've been removed by the host","meeting.queding.yichu":"Do you want to remove {0} from the meeting?","meeting.forbid.join":"Not allowed to re-enter the meeting","meeting.yichu.success":"Removed successfully","meeting.nopermission.join":"No access to join the meeting, please contact the host if you need to join the meeting","meeting.request.send":"The request has been sent","meeting.host.requet.mic":"The host asks you to unmute","meeting.host.requet.cam":"The host is requesting you to start video","meeting.zanbudakai.mic":"Stay muted","meeting.zanbudakai.cam":"Keep off","meeting.open.mic":"Unmute","meeting.open.cam":"Start video","meeting.refuse.mic.req":" has rejected to unmute","meeting.refuse.cam.req":" has rejected to start video","meeting.request.mic.tip":"Unmute","meeting.request.cam.tip":"Request to start video","meeting.record.icon":"Record","meeting.record.modal.header":"Are you sure you want to start a cloud recording?","meeting.record.modal.body":"After the recording starts, all attendees will be informed andthe meeting audio, video and shared screen view will berecorded to the cloud","meeting.record.modal.confirm":"Enable","meeting.open.audio.modal.header":"You are muted","meeting.open.audio.modal.body":"Unable to record your voice","meeting.open.audio.modal.cancel":"Unmute","meeting.open.audio.modal.confirm":"Continue","meeting.record.starting":"Starting recording...","meeting.record.qidongzhong":"Starting","meeting.record.luzhizhong":"Recording","meeting.record.end":"End","meeting.recording.dialog.header":"Recording in progress","meeting.recording.dialog.body.member":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.recording.dialog.body.member.phone":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.recording.dialog.body.guest":"You can contact the host after the meeting to check recorded files","meeting.recording.modal.header":"Recording in progress","meeting.recording.modal.body.member":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.recording.modal.body.guest":"You can contact the host after the meeting to check recorded files","meeting.recording.modal.body.reminder":"By staying in the meeting, you agree to the meeting begin","meeting.record.end.modal.header":"End cloud recording","meeting.record.end.modal.body":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.record.end.modal.confirm":"End","meeting.record.end.dialog.header":"Cloud recording ended","meeting.record.end.dialog.body.member":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.record.end.dialog.body.member.phone":"Go to “Past Meetings” - “Meeting Details” to check records after meeting","meeting.record.end.dialog.body.guest":"You can contact the host after the meeting to check recorded files","meeting.record.end.dialog.body.network":"The network is poor and the recording is interrupted. If necessary, please restart the recording","meeting.history.video.record":"Record{0}","common.gong.n.ge":"{0}","meeting.record.download.all":"all","meeting.record.start.fail":"Recording startup failed, please try again later","meeting.history.record.download.tip":"Some recording files are being generated, please try again later","meeting.screen.share.icon":"Screen sharing","meeting.screen.share.icon.stop":"Stop","meeting.screen.share.going":"are sharing","meeting.screen.share.stop":"have stopped screen sharing","meeting.screen.share.start":"You have started screen sharing，and the shared screen will occupy  your video avatar area","meeting.screen.share.warning":"To protect personal privacy and property security, please do not enter passwords, verify personal information, or use payment or banking products during the sharing process.","meeting.screen.share.cover.title":"You are sharing","meeting.screen.share.cover.subtitle":"To avoid an infinity mirror,   don't share your entire screen or browser window.","meeting.screen.share.change.subtitle":"Continuing to share will interrupt the ongoing sharing. Do you want to continue sharing as the new sharer?","meeting.screen.share.change.continue":"Continue","meeting.screen.share.perm.deny.title":"Your screen is not allowed to share","meeting.screen.share.perm.deny.subtitle":"Please go to the system preferences to allow screen recording for this browser Restart the browser after the settings are done.","meeting.screen.share.perm.deny.action":"Open System Preferences","meeting.screen.share.maximize":"Maximization","meeting.screen.share.jinzhujiangshare":"Only the presenter can enable screen sharing","meeting.not.start.yet":"The meeting has not started yet","meeting.forbid.join.tip":"You can only enter the meeting 15 mins earlier, and you can access the content on the canvas in advance","meeting.starttime":"Meeting time","meeting.list.forbid.join.tip":"The meeting has not started yet，you can only enter the meeting 15 mins earlier","meeting.perm.editable":"Edit","meeting.perm.commentable":"Comment","meeting.perm.view":"View","meeting.advance.setting.btn":"Advanced Settings","meeting.apply.edit.perm":"Edit permission","meeting.apply.edit.perm.sent":"Application has been sent","meeting.apply.edit.perm.refused":"The host has denied your request for edit permission","meeting.apply.edit.perm.going":"{0} is applying for edit permission","meeting.apply.edit.perm.goings":"{0} members are applying for edit permissions","meeting.member.perm.apply":"Member permission application","meeting.perm.apply.none":"None","meeting.invite.hovertip":"Invite","meeting.copy.link":"Copy link","meeting.edit.perm.tip":"Edit permission:","meeting.set.force.follow":"Force follow","meeting.unset.force.follow":"Unforce follow","meeting.identity.presenter":"Presenter","meeting.identity.host":"Host","upload.excel.modal.title":"Import Excel as","upload.excel.modal.table":"Canvas table","upload.excel.modal.attachment":"File","upload.excel.shuoming.title":'Import "Canvas Table" Instructions:',"upload.excel.shuoming.item1":"1、Supports importing up to 5000 cells of content","upload.excel.shuoming.item2":"2、If there are multiple sheets in the Excel file, multiple tables will be imported","upload.excel.overlimit.toast":"Supports importing up to 5000 cells of content","export.table.excel":"Export to Excel","media.audio.access.denied.tip":"Please refresh the page after the settings are completed.","media.audio.access.denied.label":"Microphone unauthorized","media.audio.access.denied.content":"Please authorize the use of your microphone in the browser's settings","media.audio.recorder.finish":"Finish","media.audio.recorder.restart":"Record again","media.audio.recorder.startLabel":"Click to start recording","media.audio.recorder.timeLeft":"Remaining","menuBtn.presentation":"Presentation Mode","menuBtn.rtcMeeting":"Video Chat","more.apps":"More Apps","network.reconnect.start":"Network connection failed,  after the network is restored,  canvas content will automatically synchronize (please restore  connection within 2 hours)","network.reconnect.connected":"Synchronizing...","network.reconnect.syncFinished":"Synchronized with the cloud","network.reconnect.failed":"Failed to connect. Please check your network or refresh the page.","shadow.network.reconnect.failed":"Failed to connect to the extra board server.","operation.redo":"Redo","operation.undo":"Undo","presentation.close":"Close","presentation.settings":"Settings","presentation.settings.focusMode":"Focus mode","presentation.fullscreen":"Fullscreen","presentation.noFrame":"No Frame","presentation.noFrameWarning":"Presentation mode is similar to playing PPT and requires frames. Please create frames in the canvas before using presentation mode.","presentation.backToCurrentPlaying":"Back to currently playing","rtc.camera":"Camera","rtc.closeCamera":"Turn off camera","rtc.closeMic":"Turn off microphone","rtc.getCameraListfailed":"Failed to get camera information. Please make sure your device is available and microphone permission has been granted.","rtc.getMicListFailed":"Failed to get microphone information. Please make sure your device is available and microphone permission has been granted.","rtc.invite":"Video chat invitation received","rtc.join":"Join","rtc.leave":"Leave","rtc.membersCount":"Number of participants: {0}","rtc.memberList":"Member list","rtc.mic":"Microphone","rtc.openCamera":"Turn on camera","rtc.openMic":"Turn on microphone","rtc.setting":"Setting","rtc.start":"Start","rtc.enable.audio":"Unmute","rtc.disable.audio":"Mute","rtc.enable.video":"Start","rtc.disable.video":"Close","rtc.audio.enabled":"Unmuted","rtc.audio.disabled":"Muted","rtc.video.enabled":"Video started","rtc.video.disabled":"Video closed","rtc.device.tempAudio":"Unmuted","rtc.device.tempAudio.tip":"Hold F2 bar to temporarily unmute","rtc.device.denied.title":"Microphone or camera not authorized","rtc.device.denied.content":"Please authorize the use of your microphone or camera in the browser's 【Settings】.","rtc.device.denied.link":"View authorization method","rtc.select.cam":"Select camera","rtc.select.mic":"Select microphone","rtc.member.management":"Members","rtc.speaking":"Speaking: ","rtc.yincangshipinsuoluetu":"Hide video thumbnails","rtc.zhixianshitakingperson":"Show the speaker only","rtc.xianshichenyuanliebiao":"Show attendee list","rtc.shouqiliebiao":"Hide","scaleBar.help":"Help Center","scaleBar.hideMap":"Close navigation map","scaleBar.scaleDown":"Zoom out","scaleBar.scaleToOrigin":"Zoom to 100%","scaleBar.scaleUp":"Zoom in","scaleBar.showMap":"Open Navigation Map","search.icon.hint":"Search","search.noRes.text":"No results","search.noSearchRes":"No search results","search.username.placeholder":"Search","save.board.hint":"Saved to the cloud in real time.","show.all.content":"Show All Content","sticker.author.hide":"Hide Author","sticker.author.show":"Show Author","sticker.add":"Add Sticky Note","sticker.forbid.input":"Maximum number of characters reached","sticker.private.hovertip":"Private: This note can only be viewed by you","sticker.private.tag":"private","sticker.size":"Sticky note size","sticker.size.l":"Large","sticker.size.m":"Medium","sticker.size.s":"Small","sticker.size.valueText":"Size","sticker.open":"Sticky Note","table.title":"table","table.cell.op.forbid":"This operation is not available because the cells or objects within the cells are being edited by other users","table.cell.unsupported.eleType":"This object is not supported in the table","table.delete.row":"Delete row","table.delete.col":"Delete column","table.insert.row":"Insert row","table.insert.col":"Insert column","table.label":"Table","table.merge.cell":"Merge cells","table.paste.limit.hint":"The number of rows/columns copied exceeds 50. Only the first 50 rows/columns will be pasted.","table.paste.dialog.title":"Select the pasting type","table.paste.dialog.desc":"Maximum limit of rows*columns: 50*50. If you exceed this limit, only the first 50 rows/columns will be pasted.","table.paste.dialog.text":"Paste content copied from a local table into the canvas","table.paste.dialog.toTable":"Paste as a table","table.paste.dialog.toSticker":"Paste as sticky notes","table.reorder.forbid":"You need to split cells to perform this operation","table.unmerge.cell":"Unmerge Cells","text.add":"Add Text","text.align":"Text Alignment","text.anchor":"Insert link","text.anchor.edit.placeholder":"paste link","text.anchor.edit.content":"text: ","text.anchor.edit.link":"link: ","text.anchor.switchToWebpage.error":"url is invalid","text.color":"Text Color","text.fontSize":"Font Size","text.fontSize.auto":"Auto","text.highLight":"Text Highlight","text.placeholder":"Enter Text","text.style":"Text Style","title.download":"Export","title.exportAsImageBtnTip":"Export as image","title.exportFrameBtnTip":"Export frame as","mobile.pic.download":"Long press to download","toolbar.connectLine":"Connect line","toolbar.frame":"Frame","toolbar.lineWidth":"Line width","toolbar.mindmap":"Mind map","toolbar.pen":"Pen","toolbar.markPen":"Marker","toolbar.smartDraw":"Smart drawing","toolbar.laser":"Laser","toolbar.selectMode":"Select","toolbar.selectAndViewMode":"Select / View mode","toolbar.shape":"Shape","toolbar.sticker":"Sticky Note","toolbar.customizedSticker":"Sticker","toolbar.customizedSticker.recent":"Recently Used","toolbar.comment":"Comment","toolbar.template":"Template Center","toolbar.text":"Text","toolbar.upload":"Upload","toolbar.upload.dongtaippt":"Dynamic PPT (require preuploaded parsing)","toolbar.upload.dongtaippt.desc":"Animation and trigger effects","toolbar.upload.dongtaippt.fail":"Parsing failed","toolbar.upload.file":"File","toolbar.upload.image":"Image","toolbar.upload.video":"Video","toolbar.upload.audio":"Audio","toolbar.upload.supportType":"","toolbar.upload.explain":"Choose or drag file to canvas","toolbar.xiangpica":"Eraser","toolbar.timer":"Timer","toolbar.bigDoc":"Document","toolbar.download.filecount.overlimit.tip":"Support for downloading up to 20 files","toolbar.download.filesize.overlimit.tip":"The size of the batch download files has exceeded {0}, please download individually","toolbar.download.button.busy.tip":"Existing downloaded files","ui.openFrameList":"Open frames","ui.closeFrameList":"Close frames","uploadWidget.upload":"Upload","upload.notSupportFiles":"This file format is not yet supported","upload.exceedLimitSize":"File size limit {0}","user.boardOwner":"owner","user.call.all.follow":"Bring everyone to me","user.call.picked.follow":"Bring to me ...","user.following.hint.prefix":"Following","usersCursors.show":"Show collaborators' cursors","usersCursors.hide":"Hide collaborators' cursors","userCursor.subscribe.failed":"Too many cursors. Please try again later","version.auto.save":"auto-save","version.create.success":"Version created successfully","version.update.success":"Version updated successfully","version.delete.success":"Version has been deleted","version.list.empty":"No versions","version.label":"Version","version.new":"New Version","version.new.throttle":"Version creation is too frequent. Please try again later","version.update":"Edit version","version.name":"Name","version.delete":"Delete version","version.delete.text.prefix":"Sure to delete","version.delete.text.suffix":"? This operation is irreversible","version.duration.hint":"versions are stored for {0} day(s)","version.restore.to.new":"Restore as a new canvas","video.addMarkPoint":"Marker","video.editMarkPoint":"Edit marker","video.markingMode":"Marking mode","video.markingModeToast":"Please use the tools on the left to mark","video.comfirmDelete":"Sure to delete?","video.transcodingPrompt":"Transcoding is in progress. Estimated wait time : {0} minutes.","video.transcodingFailedPrompt":"Transcoding failed. Please upload again.","videoplay.speed":"Speed","videoplay.more.loop":"Loop","videoplay.more.skipMarkPoint":"Skip marker","ui.userHelper.move.title":"Please follow the prompts to move canvas","ui.userHelper.move.huadongshuangzhi":"Swipe two fingers to move the canvas","ui.userHelper.move.changanyoujian":"Long press the right mouse button to move the canvas","ui.userHelper.move.changangunlun":"Long press the scroll wheel to move the canvas","ui.userHelper.scale.title":"Please follow the prompts to scale canvas","ui.userHelper.scale.nieheshuangzhi":"Pinch two fingers to scale the canvas","ui.userHepler.scale.huadonggunlun":"Swipe the scroll wheel to scale the canvas","guide.welcome.title":"Welcome to Infi","guide.welcome.desc":"Welcome to Infi, learn how to pick the toobar on your left with a quick tutorial!","guide.stickyNote.title":"Time to hatch your ideas","guide.stickyNode.desc":"Pick stickies on the toobar and try to add ideas to fill it...","guide.shape.title":"Visualize your goals","guide.shape.desc":"Pick shapes and turn your ideas into goals...","guide.connectionLine.title":"Connect ideas and results","guide.connectionLine.desc":"Draw an arrow to connect ideas and goals, and show how they relate to each other...","guide.text.title":"Draw up a plan","guide.text.desc":"Write it by adding text and describing your strategy for plan's implementation...","guide.comment.title":"Share your comment","guide.comment.desc":"Add your opinion or feedback in comments, and share with your teammates...","guide.helperCenter.title":"Help Center","guide.helperCenter.desc":"That's all about the beginning guide. Try to open the Help Center to learn more about us...","guide.btn.nextStep":"Next","guide.btn.prevStep":"Back","guide.btn.try":"Ok","guide.btn.start":"Let's start","webpage.header.info":"Synced in meeting only","webpage.header.preview.tip":"Only presenter can preview","webpage.header.preview":"Preview","webpage.header.cancelPreview":"Cancel","template.insert.hint":"Tap to insert selected template","template.edit.hint":"Edit template details","template.save.success":"Saved successfully","template.save.fail":"Saved unsuccessfully","template.save.empty":"Empty template is not supported yet","template.save.exit":"Save and exit","webpage.insert.error":"URL is incorrect. Please check and modify.","webpage.insert.placeholder":"Please enter the URL","webpage.insert.title":"Embed Webpage","webpage.label":"Webpage","webpage.nodesc":"No description available for this site.","webpage.notitle":"No Title","webpage.openLink":"Open Link","webpage.toolbar.textMode":"text","webpage.toolbar.webpageMode":"window","info.createTime":"Created: ","info.creator":"Creator: ","info.updateTime":"Updated: ","info.updatePerson":"Modified: ","timer.label":"Timer","timer.start":"Start","timer.pause":"Pause","timer.stop":"Stop","timer.5m":"5 mins","timer.15m":"15 mins","timer.30m":"30 mins","timer.custom":"Custom","timer.add1":"Add 1 minute","timer.add5":"Add 5 minutes","timer.check":"View","timer.check.short":"View","timer.overtime":"Expired","timer.overtime.text":"The countdown is over and will continue to monitor time","timer.overtime.text.short":"The countdown is over","timer.zanbujieshu":"Cancel","timer.jieshudingshi":"Stop timer","timer.dingshijieshu":"Time's up!","timer.start.timer":"started the timer","timer.pause.timer":"paused the timer","timer.stop.timer":"ended the timer","timer.add1.timer":"adds 1 minute","timer.add5.timer":"adds 5 minutes","shape.switch":"Switch type","ai.icon":"Infi AI","ai.options.generate.mindmap":"Generate mind map","ai.options.generate.mindmap.disabled":"Remove all child nodes to do this","ai.options.expand.questions":"Expand with questions","ai.options.expand.ideas":"Expand with ideas","ai.options.expand.topics":"Expand with topics","ai.using.tip":"Generating...","ai.using.stop":"Stop","ai.using.done":"Done","ai.common.addsticker":"Add similar sticky notes","ai.common.addtodo":"Generate a to-do list","ai.common.addsummary":"Generate a summary","ai.common.translate":"Translate","ai.common.translate.target":"Target Language","ai.common.translate.chinese":"Chinese","ai.common.translate.english":"English","ai.common.translate.japanese":"Japanese","ai.common.translate.korean":"Korean","ai.common.translate.france":"French","ai.common.translate.german":"German","ai.common.translate.russian":"Russian","ai.error":"Failed","ai.center.title.dashboard":"AI Assistant","ai.center.restcount":"Team remaining sessions","ai.center.restcount.unit":"times","ai.center.restcount.tip":"The remaining {0} gifted sessions this month + the remaining {1} purchased sessions.Gifted sessions will be consumed first.","ai.center.placeholder.chat":"Enter question, AI will give you answer","ai.center.placeholder.mindmap":"Enter topic, AI will give you ideas","ai.center.placeholder.todo":"Enter todo topic, AI will list for you","ai.center.placeholder.translate":"Type to translate","ai.center.placeholder.sticker":"Enter topic, AI will broaden your ideas","ai.center.placeholder.aippt":"Enter topic, AI will give you a presentation","ai.center.placeholder.doc":"Enter topic，AI will give you a document","ai.center.generate.chat":"Q&A","ai.center.generate.mindmap":"Generate mind map","ai.center.generate.todo":"Generate todo","ai.center.generate.translate":"Translation assistant","ai.center.generate.sticker":"Generate association","ai.center.generate.aippt":"Generate Presentation","ai.center.generate.doc":"Generate Document","ai.center.generate.polish":"Improve writing","ai.center.polish.business":"Business format","ai.center.polish.concise":"Concise","ai.center.polish.poems":"Poems","ai.center.polish.academic":"Academic","ai.center.polish.colloquial":"Colloquial","ai.center.toast.notAllow":"No edit permission. Content cannot be generated in canvas","ai.center.toast.notAllow.export":"No edit permission. Content cannot be inserted into canvas","ai.center.count.remain":"The remaining AI conversation count is","ai.center.chat.stop":"Stop Responding","ai.center.chat.clear.tip":"Clear chat records","ai.center.chat.clear.confirmation":"Please Confirm to clear chat records","ai.center.chat.clearone.confirmation":"Are you sure you want to delete the current conversation?","ai.center.export.to.board":"Import to canvas","ai.center.export.to.board.success":"Success","ai.center.chat.clear.bt":"Yes","ai.center.chat.clearone.bt":"Yes","ai.center.chat.nohistory":"Aha~","ai.center.copy.success":"Copy Success","ai.center.copy.fail":"Copy Failed","ai.center.noremain.phone":"No AI session left. Please use PC to upgrade","modal.cancel":"No","modal.ok":"Ok","common.tap.insert":"Tap the canvas to insert","mindmap.expand.all":"Expand all child nodes","mindmap.collapse.all":"Collapse all child nodes","upload.image.video":"Pictrue and Video","upload.takePhoto":"TakePhoto","upload.file":"Select File","xmode.enter.view":"Enter view mode","xmode.exit.view":"Exit view mode","kanban.no.group":"Ungrouped","kanban.no.name.placeholder":"Please enter the title","kanban.label":"Kanban","kanban.default.name":"Kanban","card.label":"Card","card.attr.none":"None","card.attr.priority":"Priority","card.attr.priority.high":"High","card.attr.priority.middle":"Middle","card.attr.priority.low":"Low","card.attr.status":"Status","card.attr.status.todo":"To do","card.attr.status.doing":"In progress","card.attr.status.done":"Done","card.attr.description":"Description","card.attr.color":"Fill color","card.title.placeholder":"Please enter the title","card.radio.placeholder":"Please add","card.file.upload.placeholder":"Please upload","card.desc.placeholder":"Enter description","card.edit.tooltip":"Edit","card.edit.none":"None","card.attr.participant":"Assignee","kanban.create.card":"Create Card","card.attr.startendtime":"Set date","card.attr.startendtime.start":"Start date","card.attr.startendtime.start.short":"Start","card.attr.startendtime.end":"Due date","card.attr.startendtime.end.short":"Due","card.attr.startendtime.placeholder":"yyyy / mm / dd","card.attr.startendtime.errortext":"The due date cannot be earlier than the start date","card.attr.attachment":"Attachment","card.attr.attachment.upload":"Upload","card.attr.filelist.uploading":"Uploading...","kanban.group":"Group by","kanban.group.tip":"Group by","common.placeholder.enter":"Enter","common.search.none":"None","common.year":"","card.total.user":"{0}","kanban.config.label.short":"Settings","kanban.config.label":"Kanban settings","kanban.config.basic.option":"Basic attribute","kanban.config.custom.option":"Custom attribute","kanban.config.custom.option.add":"New custom attribute","kanban.config.attr.name":"Attribute name","kanban.config.attr.type":"Attribute type","kanban.config.attr.option":"Option content","kanban.config.attr.option.create":"New option","kanban.config.attr.delete":"Delete attribute","kanban.config.attr.save":"Save","kanban.config.attr.save.ok":"Saved successfully","kanban.config.attr.delete.confirm":"Sure to delete【{0}】attribute?","kanban.config.attr.delete.tip":"After deleting, cards that have set this attribute will clear it","kanban.config.attr.duplicate.name":"Duplicate name","kanban.config.attr.radio":"Single choice","kanban.config.attr.checkbox":"Multiple choice","kanban.config.attr.timeRange":"Date","kanban.config.attr.userList":"Assignee","kanban.config.attr.fileList":"Attachment","kanban.config.attr.richText":"Description","kanban.config.attr.empty":"None","kanban.attr.create":"Add group","kanban.attr.create.action":"Add","kanban.attr.select.color":"Select color","kanban.attr.create.error":"Duplicate group name","kanban.attr.create.group.left":"Add left group","kanban.attr.create.group.right":"Add right group","kanban.attr.delete.group":"Delete group","kanban.config.group.delete.confirm":"Sure to delete [{0}] group?","kanban.config.group.delete.tip":"After deleting the group, all cards in it will be moved to Ungrouped.","common.please.select":"Select","kanban.attr.group.duplicate.tip":"Duplicate group name {0}","kanban.usepc.attr":"Please use PC or Pad","kanban.enter.gourp.name":"Please enter the group name","kanban.empty.group":"The option cannot be empty. Please add an option","kanban.title.tip":"Only effective within this board","kanban.upload.tip":"or paste/drag files here","tool.box.title":"Apps","tool.box.title.tip":"Press icon to adjust order or pin to toolbar","tool.box.title.tip.tiny":"Press icon to adjust order","tool.box.app.center":"Application Center","tool.box.app.tocome":"Coming soon","tool.box.pin.tool":"Pin to toolbar","tool.box.unpin.tool":"Unpin","tool.box.empty.tip":"You have pinned all apps","line.text.add":"Add text","line.text.place":"Text position","shape.panel.addmore":"All shapes","shape.panel.addmore.tip":"Basic, Flowchart","graphic.sidebar.title":"Shapes Library","graphic.sidebar.title.open":"Expand all","graphic.sidebar.title.close":"Collapse all","graphic.sidebar.search.placeholder":"Search shapes","graphic.sidebar.colorpalettes.default":"Default","graphic.swinLane.hor.name":"horizontal swimlane","graphic.swinLane.ver.name":"vertical swimlane","graphic.swinLane.default.title":"title","ai.gen.ppt":"Generate presentation","ai.gen.ppt.error":"Selected content exceeding {0} words is not supported","voting.name":"Voting","voting.create":"New voting","voting.history":"Past votings","voting.history.empty.tip":"None","voting.title.others":"{0} initiated a vote [{1}]","voting.title.self":"I initiated a vote [{0}]","voting.ongoing":"Ongoing","voting.realname":"Real-name","voting.anonymous":"Anonymous","voting.voted.users":"{0} voted","voting.joinnow":"Join now","voting.invitation.copy":"Copy invitation","voting.invitation.copy.success":"Copied successfully","voting.qrcode.generate":"Generate voting codes","voting.qrcode.join.tip":"Scan QR code to join voting","voting.votes.total":"Total votes","voting.votes.voted":"Already cast","voting.duration.left":"Time","voting.end":"End voting","voting.end.confirm.title":"Sure to end the current voting?","voting.end.confirm.content":"There are currently {0} users who have completed the voting. After ending, everyone will be exited from the voting","voting.end.cancel":"Not now","voting.end.confirm":"End voting","voting.create.area.tip.1":"1. Drag or zoom the area selection box to set the visible area for the participants in voting. ","voting.create.area.tip.2":"2. Participants can only see the content within the visible area.","voting.create.name":"Voting topic","voting.create.tickets":"Votes per person","voting.create.duration":"Voting time","voting.create.duration.option.minutes":"{0} minutes","voting.create.duration.option.hours":"{0} hours","voting.create.duration.option.unlimited":"Unlimited","voting.create.anonymous":"Anonymous vote","voting.create.objects":"Voting objects","voting.create.select.all":"Select all","voting.create.select.none":"Deselect all","voting.create.confirm":"Start voting","voting.create.confirm.object.empty.tip":"Please select the voting objects first","voting.create.select.object.tip":"There are no eligible voting objects in the current area. Please move or zoom the area selection box to ensure that the voting objects are completely within the area selection box","voting.create.object.empty.tip":'Please adjust the visible area on the left and select "Sticky Note, Text, Shapes, Frames, Images, Cards" within the visible area as the voting objects',"voting.create.failed.only.one":"Creation failed,Only one vote can be initiated for a canvas at a time","voting.create.failed.common":"Creation failed","voting.back.to.area":"Back","voting.more":"More","voting.leave":"Leave","voting.done":"I'm done","voting.tickets.noleft":"Insufficient votes, maximum of {0} votes","voting.submit.confirm.title":"Sure to submit the vote?","voting.submit.confirm.body.tickets.left":"You still have {0} votes remaining. Once submitted, you cannot modify them","voting.submit.confirm.body.tickets.empty":"Once submitted, you cannot modify them","voting.submit.cancel":"Not now","voting.submit.confirm":"Confirm","voting.results":"Voting results","voting.tickets.users.voted":"{0} vote(s)","voting.tickets.self.voted":"I vote {0}","voting.preview":"Preview","voting.result.view":"Voting results","voting.notification.ended":"The voting has ended, and the results can be viewed","voting.delete.confirm.title":"Sure to delete the voting record?","voting.delete.confirm.cancel":"Cancel","voting.delete.confirm.confirm":"Delete","voting.export.to.excel":"Export to Excel","voting.export.to.board":"Export to canvas","voting.export.notAllow.toast":"No edit permission. Content cannot be inserted into canvas","voting.mobile.create.tip":"Currently not supporting initiating a vote, please operate on a PC or Pad","voting.voted.tip":"You have voted","voting.invite.ended.tip":"The voting has ended, and you did not participate in the voting","voting.element.sticker":"Sticky Note","voting.element.text":"Text","voting.element.shape":"Shape","voting.element.frame":"Frame","voting.element.image":"Image","voting.element.card":"Card","voting.tip.no.left.tickets":"You have cast all of your votes","voting.instructions.title":"Voting instructions:","voting.instructions.hovertip.1":"1. Only one vote can be initiated for a canvas at a time;","voting.instructions.hovertip.2":'2. Support voting for "Sticky Note, Text, Shapes, Frames, Cards" in the canvas, for example: a text box is considered as one voting object',"voting.instructions.content.1":"Only one vote can be initiated for a canvas at a time;","voting.instructions.content.2.1":'Support voting for "',"voting.instructions.content.2.2":"Sticky Note, Text, Shapes, Frames, Images, Cards","voting.instructions.content.2.3":'" in the canvas, for example: a text box is considered as one voting object',"voting.voting.area.tip":"Visible area for voting participants (select elements within the area as voting objects)","voting.toolbar.leave":"Leave","voting.toolbar.submit":"Done","voting.export.table.name":"The voting results of 【{0}】","voting.export.title.ranking":"Ranking","voting.export.title.content":"Voting content","voting.export.title.tickets":"Number of votes received","voting.export.title.percent":"Percentage of total votes","voting.export.title.voters":"Voters","kanban.setting.filter.tip":"The current kanban is being filtered. Please clear the conditions to view all content","kanban.setting.filter.noauth":"The current board is being filtered, and some content is not displayed","kanban.filter.title":"Add filter","kanban.filter.title.tip":"When there are multiple filter conditions, the intersection will be taken","kanban.filter.title.clear":"Clear all","kanban.filter.add":"Add","kanban.filter.title.content":"Card title","kanban.filter.type.include":"Contains","kanban.filter.type.equal":"Is","kanban.filter.label":"Filter","kanban.filter.label.multi":"filters","kanban.order.label":"Sort","kanban.order.label.multi":"sorts","kanban.order.edit.title":"Add sort","kanban.order.radio.asc":"Order","kanban.order.radio.desc":"Reverse order","kanban.order.text.asc":"A ➞ Z","kanban.order.text.desc":"Z ➞ A","kanban.order.common.asc":"Ascending","kanban.order.common.desc":"Descending","kaban.userlist.send":"Send notifications","kanban.hide.tip":"Operate successfully，The current board is being filtered. Please clear the conditions to view all content"}),{"toolbar.customizedSticker.empty":"No results","toolbar.customizedSticker.license":"Copyright Info","toolbar.customizedSticker.placeholder":"Search sticker","toolbar.customizedSticker.source":"From {0}","uploadModule.btn.upload":"Upload","uploadModule.btn.uploading":"Uploading...","uploadModule.btn.uploaded":"Upload complete","uploadModule.status.success":"Successfully","uploadModule.status.fail":"Unsuccessfully"}),H=e.createContext({}),U=function(t){var n=t.locale,i=t.children,r=n||L,o=e.useCallback(F.bind(null,r),[r]);return e.useEffect((function(){!function(e){L=e}(r)}),[r]),e.createElement(H.Provider,{value:{getUpimeTrans:o}},i)};function W(){return e.useContext(H)}function V(e,t){for(;t!=e;){if(!t.parentNode)return!1;t=t.parentNode}return!0}function j(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return e})).join(" ")}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return!!e}))}function q(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}}function K(e){for(var t=e.replace(/^data:image\/\w*;base64,/,""),n=window.atob(t),i=new Array(n.length),r=n.length,o=0;o<r;o++)i[o]=n.charCodeAt(o);var a=new Uint8Array(i);return new Blob([a],{type:"image/jpg"})}function Y(e){var t=e.outerHTML;return new Blob([t],{type:"image/svg+xml"})}function X(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,Q(e,"blob")]}))}))}function Q(e,t,n,i,r){return A(this,void 0,void 0,(function(){return D(this,(function(o){return[2,new Promise((function(o,a){var s=new XMLHttpRequest;s.responseType=t,s.open(i||"GET",e),n&&s.setRequestHeader("Content-Type",n),s.onload=function(){o(s.response)},s.onerror=a,r?s.send(r):s.send()}))]}))}))}function Z(e){return new Promise((function(t){var n=new FileReader;n.onloadend=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsArrayBuffer(e)}))}function J(){return!!document.fullscreenElement||!!document.webkitFullscreenElement}function $(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()}function ee(e,t){if(void 0===e&&(e=!0),null==t||t(e),e)$(document.documentElement);else{if(!J())return;document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}}function te(e,t){var n=null;return function(){for(var i,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n&&clearTimeout(n),n=setTimeout((function(){i=e.apply(void 0,r)}),t),i}}function ne(e,t){var n=0;return function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o;return Date.now()-n>=t&&(o=e.apply(void 0,i),n=Date.now()),o}}function ie(e){e.preventDefault()}function re(e,t){if(void 0===e||void 0===t)return!(e===t);if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var n in t){var i=e[n],r=t[n];if("object"==typeof i&&"object"==typeof r?re(i,r):i!==r)return!0}return!1}function oe(e){return e.match("^http[s]{0,1}")||(e="https://".concat(e)),e}function ae(e){return!!e.match("^http[s]{0,1}")}var se=function(e,t){if(e===t)return!0;if(Array.isArray(e)!==Array.isArray(t))return!1;if(le(e)&&le(t))return e===t;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e){if(!(n in t))return!1;if(!se(e[n],t[n]))return!1}return!0},le=function(e){return e!==Object(e)};function ce(){}var ue,de,pe=function(e,t){return t.some((function(t){return e.hasOwnProperty(t)}))},he=function(e,t){return t.reduce((function(t,n){var i;return void 0!==e[n]?exports.E(exports.E({},t),((i={})[n]=e[n],i)):t}),{})},fe=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){var n=Array.isArray(e)?[]:{};if(t.get(e))return t.get(e);for(var i in t.set(e,n),e)n[i]=fe(e[i],t);return n}return e};function me(e){return!!/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=\+_;,]*)?/.test(e)}function ve(e){return!!/^<iframe[^>]*src=['"]((http:|https:)?(\/\/)?([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=\+_;,]*)?)['"][^>]*>.*<\/iframe>/i.test(e)}function ge(e){return 0!==e.indexOf("http")&&(e=0==e.indexOf("//")?"https:"+e:"https://"+e),e}function ye(){return 0===window.orientation||180===window.orientation}function be(){return window.screen.orientation?window.screen.orientation.type.startsWith("landscape"):90===window.orientation||-90===window.orientation}function Ee(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("micromessenger")&&-1!==e.indexOf("wxwork")}!function(e){e.WWW="www",e.ITEST="itest",e.TEST="test",e.DEV="dev",e.LOCAL="local",e.PRIVATE="private"}(de||(de={}));var xe="",we="https://wwwr.plaso.cn/infi_board/",Ce="www";function Se(){return"www"==Ce?"https://api.infi.cn":"test"===Ce?"https://testc2c.plaso.cn":"private"===Ce?xe:"https://".concat(Ce,".plaso.cn")}function ke(e){for(var t in de)if(de[t]==e)return void(Ce="local"===e?"dev":e)}var _e={mobile:!1,isIOS:!1,isPad:!1,isPhone:!1,firefox:!1,safari:!1,browserVersion:"",isMac:!1,isWindows:!1,tablet:!1,desktop:!1,isTouchSupported:!1,isEdge:!1,isChrome:!1,chromeVersion:100,isHoverSupported:!0,isAndroid:!1,isWeixin:!1,isPwa:!1,isIphoneLike:!1,isQuark:!1},Te="undefined"!=typeof navigator&&navigator.userAgent||"";Te.indexOf("Mobile")>=0&&(_e.mobile=!0,_e.isIOS=!!Te.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),_e.isPad=!!Te.match(/Pad\b/i)),Te.indexOf("Android")>=0&&(_e.mobile=!0),_e.safari=/Apple/i.test(navigator.vendor)&&/Safari/i.test(navigator.userAgent);var Ie=/windows phone/i.test(Te);if(_e.isWindows=!_e.mobile&&!Ie&&/windows/i.test(Te),_e.isMac=!_e.mobile&&/macintosh/i.test(Te),_e.tablet=/tablet/i.test(Te)&&!/tablet pc/i.test(Te),_e.isEdge=/Edg\//.test(Te),_e.isChrome=/Chrome/.test(Te)&&!/HarmonyOS/.test(Te),_e.isChrome){var Pe=parseInt((null===(ue=Te.match(/Chrome\/(\d+)/))||void 0===ue?void 0:ue[1])||"");isNaN(Pe)||(_e.chromeVersion=Pe)}_e.isQuark=/Quark/.test(Te),_e.isPwa=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),_e.isAndroid=/(android)/i.test(Te);var Ne,Me,Ae,De="undefined"!=typeof navigator&&navigator.maxTouchPoints>0;_e.isMac&&De&&(_e.isMac=!1,_e.mobile=!0,_e.tablet=!0,_e.isIOS=!0,_e.isPad=!0),_e.isPhone=_e.mobile&&!1===_e.isPad,_e.desktop=!_e.mobile&&!_e.tablet,_e.isHoverSupported=_e.desktop&&!_e.isTouchSupported,_e.isWeixin=Te.indexOf("MicroMessenger")>-1,Ne=window.innerHeight,_e.isIphoneLike=_e.isPhone&&(_e.isIOS||_e.isEdge||_e.isChrome&&_e.chromeVersion>=80&&!_e.isQuark),_e.isIphoneLike&&_e.isAndroid&&window.addEventListener("resize",(function e(){var t=window.innerHeight;t<.75*window.innerWidth||t<(Ne=Math.max(Ne,t))-155&&(_e.isIphoneLike=!1,window.removeEventListener("resize",e))})),function(e){e.OPEN_SANS="OpenSans",e.SYSTEM_UI="system-ui",e.SOURCE_HAN_SANS_CN="SourceHanSansCN",e.SOURCE_HAN_SANS_CN_300="SourceHanSansCN_300"}(Ae||(Ae={}));var Re=((Me={})[Ae.OPEN_SANS]={family:Ae.OPEN_SANS,name:"OpenSans",url:"",lineHeight:1.5},Me[Ae.SYSTEM_UI]={family:Ae.SYSTEM_UI,name:"system-ui",url:"",lineHeight:1.5},Me),Be=new Map([[Ae.SOURCE_HAN_SANS_CN,{family:Ae.SOURCE_HAN_SANS_CN,name:"思源黑体",url:"SourceHanSansCN.woff2",lineHeight:1.5}],[Ae.SOURCE_HAN_SANS_CN_300,{family:Ae.SOURCE_HAN_SANS_CN_300,name:"思源黑体",url:"SourceHanSansCN_300.woff2",lineHeight:1.5}]]);function Le(e){var t=Be.get(e);return(null==t?void 0:t.lineHeight)||1.5}var Oe={placeholder:""},Fe={left:0,top:0,right:0,bottom:0,rotate:0},ze=Be.get(Ae.SOURCE_HAN_SANS_CN),He=ze.family,Ue=Math.round(14*ze.lineHeight),We=ze.lineHeight,Ve=[10,12,14,18,24,36,48,64,80,144,288],je=[16777215,16708677,16434960,15877926,15132390,13559617,9425231,14286947,8421504,1232340,829321,9769132,1710618,2989040,4279218,6630579],Ge=[16119544,16775601,14022290,16109864,13229910,16751944,9687669,15821951,6801088,15373499,7133434,16764639,10931445,12486855,8098559,8234733],qe=Ge[5],Ke={width:200,height:200},Ye={width:280,height:90},Xe={width:480,height:296},Qe={width:1280,height:720},Ze={width:156,height:156},Je={width:100,height:100},$e=[4,8,10,12,14,18,24,32,48,64],et=_e.desktop?15:20,tt=_e.desktop?3:5,nt=_e.desktop?5:8,it=[1,2,3,4,5,8,12,16,20,24],rt=["#FFD02E","#77CC66","#4CD1CF","#E15454","#2E73E5","#000000"],ot={width:350,height:252},at=document.createElement("canvas"),st=at.getContext("2d",{willReadFrequently:!0}),lt={};function ct(e,t){var n=t||"unkonwn",i=lt[n];if(!i){i={};var r=ut({fontFamily:t,fontSize:14}),o=at,a=st;a.font=r;var s=Math.ceil(a.measureText("|MÉq").width),l=Math.ceil(a.measureText("M").width),c=2*l;l=1.4*l|0,o.width=s,o.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=r,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText("|MÉq",0,l);var u=a.getImageData(0,0,s,c).data,d=u.length,p=4*s,h=void 0,f=void 0,m=0,v=!1;for(h=0;h<l;h++){for(f=0;f<p;f+=4)if(255!==u[m+f]){v=!0;break}if(v)break;m+=p}for(i.ascent=l-h,m=d-p,v=!1,h=c;h>l;h--){for(f=0;f<p;f+=4)if(255!==u[m+f]){v=!0;break}if(v)break;m-=p}i.descent=h-l,i.height=i.ascent+i.descent,lt[n]=i}return function(e,t){return{ascent:e.ascent*t,descent:e.descent*t,height:e.height*t}}(i,e/14)}function ut(e){var t=e.fontSize,n=void 0===t?14:t,i=e.fontFamily,r=void 0===i?"Arial":i,o=e.fontStyle,a=void 0===o?"normal":o,s=e.fontWeight,l=void 0===s?"normal":s;e.fontVariant;var c="".concat(n,"px ").concat(r);return"normal"!==l&&(c=l+" "+c),"normal"!==a&&(c="italic "+c),c}function dt(e,t){function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.call.apply(e,R([this],t,!1))}for(var i in n.prototype=Object.create(e.prototype),t)n.prototype[i]=t[i];return n}function pt(e,t,n){function i(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.call.apply(e,R([this],t,!1))}i.prototype=Object.create(e.prototype);var r=function(e){var r="_"+e;i.prototype[r]=t[e],Object.defineProperty(i.prototype,e,{set:function(t){t!==this[r]&&(this[r]=t,null==n||n.call(this,e))},get:function(){return this[r]}})};for(var o in t)r(o);return i}var ht=function(){function e(){}return e.prototype.paint=function(e){},e.prototype.paintSvg=function(e){},e.prototype.destroy=function(){},e}(),ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=[],t}return P(t,e),t.prototype.appendChild=function(e){this.addChildAt(e,this.children.length)},t.prototype.removeChild=function(e){this.children=this.children.filter((function(t){return t!==e})),e.parent===this&&(e.parent=void 0)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw new Error("The supplied index is out of bounds");var n=this.getChildIndex(e);n!==t&&(n<t&&(t-=1),this.children.splice(n,1),this.children.splice(t,0,e))},t.prototype.addChildAt=function(e,t){if(e!==this){if(!(t>=0&&t<=this.children.length))throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(t,0,e)}},t}(ht);ft.prototype.appendChild,ft.prototype.removeChild,ft.prototype.getChildIndex,ft.prototype.setChildIndex,ft.prototype.addChildAt;var mt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var vt,gt,yt={exports:{}};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */vt=yt,gt=yt.exports,function(){var e,t="Expected a function",n="__lodash_hash_undefined__",i="__lodash_placeholder__",r=32,o=128,a=1/0,s=9007199254740991,l=NaN,c=4294967295,u=[["ary",o],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",r],["partialRight",64],["rearg",256]],d="[object Arguments]",p="[object Array]",h="[object Boolean]",f="[object Date]",m="[object Error]",v="[object Function]",g="[object GeneratorFunction]",y="[object Map]",b="[object Number]",E="[object Object]",x="[object Promise]",w="[object RegExp]",C="[object Set]",S="[object String]",k="[object Symbol]",_="[object WeakMap]",T="[object ArrayBuffer]",I="[object DataView]",P="[object Float32Array]",N="[object Float64Array]",M="[object Int8Array]",A="[object Int16Array]",D="[object Int32Array]",R="[object Uint8Array]",B="[object Uint8ClampedArray]",L="[object Uint16Array]",O="[object Uint32Array]",F=/\b__p \+= '';/g,z=/\b(__p \+=) '' \+/g,H=/(__e\(.*?\)|\b__t\)) \+\n'';/g,U=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,V=RegExp(U.source),j=RegExp(W.source),G=/<%-([\s\S]+?)%>/g,q=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,Q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Z=/[\\^$.*+?()[\]{}|]/g,J=RegExp(Z.source),$=/^\s+/,ee=/\s/,te=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ne=/\{\n\/\* \[wrapped with (.+)\] \*/,ie=/,? & /,re=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oe=/[()=,{}\[\]\/\s]/,ae=/\\(\\)?/g,se=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,le=/\w*$/,ce=/^[-+]0x[0-9a-f]+$/i,ue=/^0b[01]+$/i,de=/^\[object .+?Constructor\]$/,pe=/^0o[0-7]+$/i,he=/^(?:0|[1-9]\d*)$/,fe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,me=/($^)/,ve=/['\n\r\u2028\u2029\\]/g,ge="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ye="a-z\\xdf-\\xf6\\xf8-\\xff",be="A-Z\\xc0-\\xd6\\xd8-\\xde",Ee="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",xe="["+Ee+"]",we="["+ge+"]",Ce="\\d+",Se="["+ye+"]",ke="[^\\ud800-\\udfff"+Ee+Ce+"\\u2700-\\u27bf"+ye+be+"]",_e="\\ud83c[\\udffb-\\udfff]",Te="[^\\ud800-\\udfff]",Ie="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Ne="["+be+"]",Me="(?:"+Se+"|"+ke+")",Ae="(?:"+Ne+"|"+ke+")",De="(?:['’](?:d|ll|m|re|s|t|ve))?",Re="(?:['’](?:D|LL|M|RE|S|T|VE))?",Be="(?:"+we+"|"+_e+")?",Le="[\\ufe0e\\ufe0f]?",Oe=Le+Be+"(?:\\u200d(?:"+[Te,Ie,Pe].join("|")+")"+Le+Be+")*",Fe="(?:"+["[\\u2700-\\u27bf]",Ie,Pe].join("|")+")"+Oe,ze="(?:"+[Te+we+"?",we,Ie,Pe,"[\\ud800-\\udfff]"].join("|")+")",He=RegExp("['’]","g"),Ue=RegExp(we,"g"),We=RegExp(_e+"(?="+_e+")|"+ze+Oe,"g"),Ve=RegExp([Ne+"?"+Se+"+"+De+"(?="+[xe,Ne,"$"].join("|")+")",Ae+"+"+Re+"(?="+[xe,Ne+Me,"$"].join("|")+")",Ne+"?"+Me+"+"+De,Ne+"+"+Re,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ce,Fe].join("|"),"g"),je=RegExp("[\\u200d\\ud800-\\udfff"+ge+"\\ufe0e\\ufe0f]"),Ge=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ke=-1,Ye={};Ye[P]=Ye[N]=Ye[M]=Ye[A]=Ye[D]=Ye[R]=Ye[B]=Ye[L]=Ye[O]=!0,Ye[d]=Ye[p]=Ye[T]=Ye[h]=Ye[I]=Ye[f]=Ye[m]=Ye[v]=Ye[y]=Ye[b]=Ye[E]=Ye[w]=Ye[C]=Ye[S]=Ye[_]=!1;var Xe={};Xe[d]=Xe[p]=Xe[T]=Xe[I]=Xe[h]=Xe[f]=Xe[P]=Xe[N]=Xe[M]=Xe[A]=Xe[D]=Xe[y]=Xe[b]=Xe[E]=Xe[w]=Xe[C]=Xe[S]=Xe[k]=Xe[R]=Xe[B]=Xe[L]=Xe[O]=!0,Xe[m]=Xe[v]=Xe[_]=!1;var Qe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ze=parseFloat,Je=parseInt,$e="object"==typeof mt&&mt&&mt.Object===Object&&mt,et="object"==typeof self&&self&&self.Object===Object&&self,tt=$e||et||Function("return this")(),nt=gt&&!gt.nodeType&&gt,it=nt&&vt&&!vt.nodeType&&vt,rt=it&&it.exports===nt,ot=rt&&$e.process,at=function(){try{return it&&it.require&&it.require("util").types||ot&&ot.binding&&ot.binding("util")}catch(e){}}(),st=at&&at.isArrayBuffer,lt=at&&at.isDate,ct=at&&at.isMap,ut=at&&at.isRegExp,dt=at&&at.isSet,pt=at&&at.isTypedArray;function ht(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function ft(e,t,n,i){for(var r=-1,o=null==e?0:e.length;++r<o;){var a=e[r];t(i,a,n(a),e)}return i}function yt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function bt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Et(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function xt(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}function wt(e,t){return!(null==e||!e.length)&&At(e,t,0)>-1}function Ct(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function St(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function kt(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function _t(e,t,n,i){var r=-1,o=null==e?0:e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function Tt(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function It(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Pt=Lt("length");function Nt(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}function Mt(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function At(e,t,n){return t==t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):Mt(e,Rt,n)}function Dt(e,t,n,i){for(var r=n-1,o=e.length;++r<o;)if(i(e[r],t))return r;return-1}function Rt(e){return e!=e}function Bt(e,t){var n=null==e?0:e.length;return n?zt(e,t)/n:l}function Lt(t){return function(n){return null==n?e:n[t]}}function Ot(t){return function(n){return null==t?e:t[n]}}function Ft(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}function zt(t,n){for(var i,r=-1,o=t.length;++r<o;){var a=n(t[r]);a!==e&&(i=i===e?a:i+a)}return i}function Ht(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Ut(e){return e?e.slice(0,rn(e)+1).replace($,""):e}function Wt(e){return function(t){return e(t)}}function Vt(e,t){return St(t,(function(t){return e[t]}))}function jt(e,t){return e.has(t)}function Gt(e,t){for(var n=-1,i=e.length;++n<i&&At(t,e[n],0)>-1;);return n}function qt(e,t){for(var n=e.length;n--&&At(t,e[n],0)>-1;);return n}var Kt=Ot({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Yt=Ot({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xt(e){return"\\"+Qe[e]}function Qt(e){return je.test(e)}function Zt(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function Jt(e,t){return function(n){return e(t(n))}}function $t(e,t){for(var n=-1,r=e.length,o=0,a=[];++n<r;){var s=e[n];s!==t&&s!==i||(e[n]=i,a[o++]=n)}return a}function en(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function tn(e){return Qt(e)?function(e){for(var t=We.lastIndex=0;We.test(e);)++t;return t}(e):Pt(e)}function nn(e){return Qt(e)?function(e){return e.match(We)||[]}(e):function(e){return e.split("")}(e)}function rn(e){for(var t=e.length;t--&&ee.test(e.charAt(t)););return t}var on=Ot({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),an=function ee(ge){var ye,be=(ge=null==ge?tt:an.defaults(tt.Object(),ge,an.pick(tt,qe))).Array,Ee=ge.Date,xe=ge.Error,we=ge.Function,Ce=ge.Math,Se=ge.Object,ke=ge.RegExp,_e=ge.String,Te=ge.TypeError,Ie=be.prototype,Pe=we.prototype,Ne=Se.prototype,Me=ge["__core-js_shared__"],Ae=Pe.toString,De=Ne.hasOwnProperty,Re=0,Be=(ye=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||""))?"Symbol(src)_1."+ye:"",Le=Ne.toString,Oe=Ae.call(Se),Fe=tt._,ze=ke("^"+Ae.call(De).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),We=rt?ge.Buffer:e,je=ge.Symbol,Qe=ge.Uint8Array,$e=We?We.allocUnsafe:e,et=Jt(Se.getPrototypeOf,Se),nt=Se.create,it=Ne.propertyIsEnumerable,ot=Ie.splice,at=je?je.isConcatSpreadable:e,mt=je?je.iterator:e,vt=je?je.toStringTag:e,gt=function(){try{var e=so(Se,"defineProperty");return e({},"",{}),e}catch(e){}}(),Pt=ge.clearTimeout!==tt.clearTimeout&&ge.clearTimeout,Ot=Ee&&Ee.now!==tt.Date.now&&Ee.now,sn=ge.setTimeout!==tt.setTimeout&&ge.setTimeout,ln=Ce.ceil,cn=Ce.floor,un=Se.getOwnPropertySymbols,dn=We?We.isBuffer:e,pn=ge.isFinite,hn=Ie.join,fn=Jt(Se.keys,Se),mn=Ce.max,vn=Ce.min,gn=Ee.now,yn=ge.parseInt,bn=Ce.random,En=Ie.reverse,xn=so(ge,"DataView"),wn=so(ge,"Map"),Cn=so(ge,"Promise"),Sn=so(ge,"Set"),kn=so(ge,"WeakMap"),_n=so(Se,"create"),Tn=kn&&new kn,In={},Pn=Bo(xn),Nn=Bo(wn),Mn=Bo(Cn),An=Bo(Sn),Dn=Bo(kn),Rn=je?je.prototype:e,Bn=Rn?Rn.valueOf:e,Ln=Rn?Rn.toString:e;function On(e){if(Ja(e)&&!Ua(e)&&!(e instanceof Un)){if(e instanceof Hn)return e;if(De.call(e,"__wrapped__"))return Lo(e)}return new Hn(e)}var Fn=function(){function t(){}return function(n){if(!Za(n))return{};if(nt)return nt(n);t.prototype=n;var i=new t;return t.prototype=e,i}}();function zn(){}function Hn(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=e}function Un(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=c,this.__views__=[]}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function jn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new jn;++t<n;)this.add(e[t])}function qn(e){var t=this.__data__=new Vn(e);this.size=t.size}function Kn(e,t){var n=Ua(e),i=!n&&Ha(e),r=!n&&!i&&Ga(e),o=!n&&!i&&!r&&as(e),a=n||i||r||o,s=a?Ht(e.length,_e):[],l=s.length;for(var c in e)!t&&!De.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||mo(c,l))||s.push(c);return s}function Yn(t){var n=t.length;return n?t[ji(0,n-1)]:e}function Xn(e,t){return Ao(kr(e),ri(t,0,e.length))}function Qn(e){return Ao(kr(e))}function Zn(t,n,i){(i!==e&&!Oa(t[n],i)||i===e&&!(n in t))&&ni(t,n,i)}function Jn(t,n,i){var r=t[n];De.call(t,n)&&Oa(r,i)&&(i!==e||n in t)||ni(t,n,i)}function $n(e,t){for(var n=e.length;n--;)if(Oa(e[n][0],t))return n;return-1}function ei(e,t,n,i){return ci(e,(function(e,r,o){t(i,e,n(e),o)})),i}function ti(e,t){return e&&_r(t,Is(t),e)}function ni(e,t,n){"__proto__"==t&&gt?gt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ii(t,n){for(var i=-1,r=n.length,o=be(r),a=null==t;++i<r;)o[i]=a?e:Cs(t,n[i]);return o}function ri(t,n,i){return t==t&&(i!==e&&(t=t<=i?t:i),n!==e&&(t=t>=n?t:n)),t}function oi(t,n,i,r,o,a){var s,l=1&n,c=2&n,u=4&n;if(i&&(s=o?i(t,r,o,a):i(t)),s!==e)return s;if(!Za(t))return t;var p=Ua(t);if(p){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&De.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(t),!l)return kr(t,s)}else{var m=uo(t),x=m==v||m==g;if(Ga(t))return br(t,l);if(m==E||m==d||x&&!o){if(s=c||x?{}:ho(t),!l)return c?function(e,t){return _r(e,co(e),t)}(t,function(e,t){return e&&_r(t,Ps(t),e)}(s,t)):function(e,t){return _r(e,lo(e),t)}(t,ti(s,t))}else{if(!Xe[m])return o?t:{};s=function(e,t,n){var i,r=e.constructor;switch(t){case T:return Er(e);case h:case f:return new r(+e);case I:return function(e,t){var n=t?Er(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case N:case M:case A:case D:case R:case B:case L:case O:return xr(e,n);case y:return new r;case b:case S:return new r(e);case w:return function(e){var t=new e.constructor(e.source,le.exec(e));return t.lastIndex=e.lastIndex,t}(e);case C:return new r;case k:return i=e,Bn?Se(Bn.call(i)):{}}}(t,m,l)}}a||(a=new qn);var _=a.get(t);if(_)return _;a.set(t,s),is(t)?t.forEach((function(e){s.add(oi(e,n,i,e,t,a))})):$a(t)&&t.forEach((function(e,r){s.set(r,oi(e,n,i,r,t,a))}));var F=p?e:(u?c?eo:$r:c?Ps:Is)(t);return yt(F||t,(function(e,r){F&&(e=t[r=e]),Jn(s,r,oi(e,n,i,r,t,a))})),s}function ai(t,n,i){var r=i.length;if(null==t)return!r;for(t=Se(t);r--;){var o=i[r],a=n[o],s=t[o];if(s===e&&!(o in t)||!a(s))return!1}return!0}function si(n,i,r){if("function"!=typeof n)throw new Te(t);return Io((function(){n.apply(e,r)}),i)}function li(e,t,n,i){var r=-1,o=wt,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=St(t,Wt(n))),i?(o=Ct,a=!1):t.length>=200&&(o=jt,a=!1,t=new Gn(t));e:for(;++r<s;){var u=e[r],d=null==n?u:n(u);if(u=i||0!==u?u:0,a&&d==d){for(var p=c;p--;)if(t[p]===d)continue e;l.push(u)}else o(t,d,i)||l.push(u)}return l}On.templateSettings={escape:G,evaluate:q,interpolate:K,variable:"",imports:{_:On}},On.prototype=zn.prototype,On.prototype.constructor=On,Hn.prototype=Fn(zn.prototype),Hn.prototype.constructor=Hn,Un.prototype=Fn(zn.prototype),Un.prototype.constructor=Un,Wn.prototype.clear=function(){this.__data__=_n?_n(null):{},this.size=0},Wn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Wn.prototype.get=function(t){var i=this.__data__;if(_n){var r=i[t];return r===n?e:r}return De.call(i,t)?i[t]:e},Wn.prototype.has=function(t){var n=this.__data__;return _n?n[t]!==e:De.call(n,t)},Wn.prototype.set=function(t,i){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=_n&&i===e?n:i,this},Vn.prototype.clear=function(){this.__data__=[],this.size=0},Vn.prototype.delete=function(e){var t=this.__data__,n=$n(t,e);return!(n<0||(n==t.length-1?t.pop():ot.call(t,n,1),--this.size,0))},Vn.prototype.get=function(t){var n=this.__data__,i=$n(n,t);return i<0?e:n[i][1]},Vn.prototype.has=function(e){return $n(this.__data__,e)>-1},Vn.prototype.set=function(e,t){var n=this.__data__,i=$n(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},jn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(wn||Vn),string:new Wn}},jn.prototype.delete=function(e){var t=oo(this,e).delete(e);return this.size-=t?1:0,t},jn.prototype.get=function(e){return oo(this,e).get(e)},jn.prototype.has=function(e){return oo(this,e).has(e)},jn.prototype.set=function(e,t){var n=oo(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Gn.prototype.add=Gn.prototype.push=function(e){return this.__data__.set(e,n),this},Gn.prototype.has=function(e){return this.__data__.has(e)},qn.prototype.clear=function(){this.__data__=new Vn,this.size=0},qn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},qn.prototype.get=function(e){return this.__data__.get(e)},qn.prototype.has=function(e){return this.__data__.has(e)},qn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Vn){var i=n.__data__;if(!wn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new jn(i)}return n.set(e,t),this.size=n.size,this};var ci=Pr(gi),ui=Pr(yi,!0);function di(e,t){var n=!0;return ci(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function pi(t,n,i){for(var r=-1,o=t.length;++r<o;){var a=t[r],s=n(a);if(null!=s&&(l===e?s==s&&!os(s):i(s,l)))var l=s,c=a}return c}function hi(e,t){var n=[];return ci(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function fi(e,t,n,i,r){var o=-1,a=e.length;for(n||(n=fo),r||(r=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?fi(s,t-1,n,i,r):kt(r,s):i||(r[r.length]=s)}return r}var mi=Nr(),vi=Nr(!0);function gi(e,t){return e&&mi(e,t,Is)}function yi(e,t){return e&&vi(e,t,Is)}function bi(e,t){return xt(t,(function(t){return Ya(e[t])}))}function Ei(t,n){for(var i=0,r=(n=mr(n,t)).length;null!=t&&i<r;)t=t[Ro(n[i++])];return i&&i==r?t:e}function xi(e,t,n){var i=t(e);return Ua(e)?i:kt(i,n(e))}function wi(t){return null==t?t===e?"[object Undefined]":"[object Null]":vt&&vt in Se(t)?function(t){var n=De.call(t,vt),i=t[vt];try{t[vt]=e;var r=!0}catch(e){}var o=Le.call(t);return r&&(n?t[vt]=i:delete t[vt]),o}(t):function(e){return Le.call(e)}(t)}function Ci(e,t){return e>t}function Si(e,t){return null!=e&&De.call(e,t)}function ki(e,t){return null!=e&&t in Se(e)}function _i(t,n,i){for(var r=i?Ct:wt,o=t[0].length,a=t.length,s=a,l=be(a),c=1/0,u=[];s--;){var d=t[s];s&&n&&(d=St(d,Wt(n))),c=vn(d.length,c),l[s]=!i&&(n||o>=120&&d.length>=120)?new Gn(s&&d):e}d=t[0];var p=-1,h=l[0];e:for(;++p<o&&u.length<c;){var f=d[p],m=n?n(f):f;if(f=i||0!==f?f:0,!(h?jt(h,m):r(u,m,i))){for(s=a;--s;){var v=l[s];if(!(v?jt(v,m):r(t[s],m,i)))continue e}h&&h.push(m),u.push(f)}}return u}function Ti(t,n,i){var r=null==(t=So(t,n=mr(n,t)))?t:t[Ro(Ko(n))];return null==r?e:ht(r,t,i)}function Ii(e){return Ja(e)&&wi(e)==d}function Pi(t,n,i,r,o){return t===n||(null==t||null==n||!Ja(t)&&!Ja(n)?t!=t&&n!=n:function(t,n,i,r,o,a){var s=Ua(t),l=Ua(n),c=s?p:uo(t),u=l?p:uo(n),v=(c=c==d?E:c)==E,g=(u=u==d?E:u)==E,x=c==u;if(x&&Ga(t)){if(!Ga(n))return!1;s=!0,v=!1}if(x&&!v)return a||(a=new qn),s||as(t)?Zr(t,n,i,r,o,a):function(e,t,n,i,r,o,a){switch(n){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!o(new Qe(e),new Qe(t)));case h:case f:case b:return Oa(+e,+t);case m:return e.name==t.name&&e.message==t.message;case w:case S:return e==t+"";case y:var s=Zt;case C:var l=1&i;if(s||(s=en),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=2,a.set(e,t);var u=Zr(s(e),s(t),i,r,o,a);return a.delete(e),u;case k:if(Bn)return Bn.call(e)==Bn.call(t)}return!1}(t,n,c,i,r,o,a);if(!(1&i)){var _=v&&De.call(t,"__wrapped__"),P=g&&De.call(n,"__wrapped__");if(_||P){var N=_?t.value():t,M=P?n.value():n;return a||(a=new qn),o(N,M,i,r,a)}}return!!x&&(a||(a=new qn),function(t,n,i,r,o,a){var s=1&i,l=$r(t),c=l.length;if(c!=$r(n).length&&!s)return!1;for(var u=c;u--;){var d=l[u];if(!(s?d in n:De.call(n,d)))return!1}var p=a.get(t),h=a.get(n);if(p&&h)return p==n&&h==t;var f=!0;a.set(t,n),a.set(n,t);for(var m=s;++u<c;){var v=t[d=l[u]],g=n[d];if(r)var y=s?r(g,v,d,n,t,a):r(v,g,d,t,n,a);if(!(y===e?v===g||o(v,g,i,r,a):y)){f=!1;break}m||(m="constructor"==d)}if(f&&!m){var b=t.constructor,E=n.constructor;b==E||!("constructor"in t)||!("constructor"in n)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(f=!1)}return a.delete(t),a.delete(n),f}(t,n,i,r,o,a))}(t,n,i,r,Pi,o))}function Ni(t,n,i,r){var o=i.length,a=o,s=!r;if(null==t)return!a;for(t=Se(t);o--;){var l=i[o];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++o<a;){var c=(l=i[o])[0],u=t[c],d=l[1];if(s&&l[2]){if(u===e&&!(c in t))return!1}else{var p=new qn;if(r)var h=r(u,d,c,t,n,p);if(!(h===e?Pi(d,u,3,r,p):h))return!1}}return!0}function Mi(e){return!(!Za(e)||(t=e,Be&&Be in t))&&(Ya(e)?ze:de).test(Bo(e));var t}function Ai(e){return"function"==typeof e?e:null==e?el:"object"==typeof e?Ua(e)?Oi(e[0],e[1]):Li(e):cl(e)}function Di(e){if(!Eo(e))return fn(e);var t=[];for(var n in Se(e))De.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ri(e,t){return e<t}function Bi(e,t){var n=-1,i=Va(e)?be(e.length):[];return ci(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Li(e){var t=ao(e);return 1==t.length&&t[0][2]?wo(t[0][0],t[0][1]):function(n){return n===e||Ni(n,e,t)}}function Oi(t,n){return go(t)&&xo(n)?wo(Ro(t),n):function(i){var r=Cs(i,t);return r===e&&r===n?Ss(i,t):Pi(n,r,3)}}function Fi(t,n,i,r,o){t!==n&&mi(n,(function(a,s){if(o||(o=new qn),Za(a))!function(t,n,i,r,o,a,s){var l=_o(t,i),c=_o(n,i),u=s.get(c);if(u)Zn(t,i,u);else{var d=a?a(l,c,i+"",t,n,s):e,p=d===e;if(p){var h=Ua(c),f=!h&&Ga(c),m=!h&&!f&&as(c);d=c,h||f||m?Ua(l)?d=l:ja(l)?d=kr(l):f?(p=!1,d=br(c,!0)):m?(p=!1,d=xr(c,!0)):d=[]:ts(c)||Ha(c)?(d=l,Ha(l)?d=fs(l):Za(l)&&!Ya(l)||(d=ho(c))):p=!1}p&&(s.set(c,d),o(d,c,r,a,s),s.delete(c)),Zn(t,i,d)}}(t,n,s,i,Fi,r,o);else{var l=r?r(_o(t,s),a,s+"",t,n,o):e;l===e&&(l=a),Zn(t,s,l)}}),Ps)}function zi(t,n){var i=t.length;if(i)return mo(n+=n<0?i:0,i)?t[n]:e}function Hi(e,t,n){t=t.length?St(t,(function(e){return Ua(e)?function(t){return Ei(t,1===e.length?e[0]:e)}:e})):[el];var i=-1;t=St(t,Wt(ro()));var r=Bi(e,(function(e,n,r){var o=St(t,(function(t){return t(e)}));return{criteria:o,index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(r,(function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var l=wr(r[i],o[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function Ui(e,t,n){for(var i=-1,r=t.length,o={};++i<r;){var a=t[i],s=Ei(e,a);n(s,a)&&Xi(o,mr(a,e),s)}return o}function Wi(e,t,n,i){var r=i?Dt:At,o=-1,a=t.length,s=e;for(e===t&&(t=kr(t)),n&&(s=St(e,Wt(n)));++o<a;)for(var l=0,c=t[o],u=n?n(c):c;(l=r(s,u,l,i))>-1;)s!==e&&ot.call(s,l,1),ot.call(e,l,1);return e}function Vi(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==o){var o=r;mo(r)?ot.call(e,r,1):sr(e,r)}}return e}function ji(e,t){return e+cn(bn()*(t-e+1))}function Gi(e,t){var n="";if(!e||t<1||t>s)return n;do{t%2&&(n+=e),(t=cn(t/2))&&(e+=e)}while(t);return n}function qi(e,t){return Po(Co(e,t,el),e+"")}function Ki(e){return Yn(Os(e))}function Yi(e,t){var n=Os(e);return Ao(n,ri(t,0,n.length))}function Xi(t,n,i,r){if(!Za(t))return t;for(var o=-1,a=(n=mr(n,t)).length,s=a-1,l=t;null!=l&&++o<a;){var c=Ro(n[o]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=s){var d=l[c];(u=r?r(d,c,l):e)===e&&(u=Za(d)?d:mo(n[o+1])?[]:{})}Jn(l,c,u),l=l[c]}return t}var Qi=Tn?function(e,t){return Tn.set(e,t),e}:el,Zi=gt?function(e,t){return gt(e,"toString",{configurable:!0,enumerable:!1,value:Zs(t),writable:!0})}:el;function Ji(e){return Ao(Os(e))}function $i(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=be(r);++i<r;)o[i]=e[i+t];return o}function er(e,t){var n;return ci(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}function tr(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t==t&&r<=2147483647){for(;i<r;){var o=i+r>>>1,a=e[o];null!==a&&!os(a)&&(n?a<=t:a<t)?i=o+1:r=o}return r}return nr(e,t,el,n)}function nr(t,n,i,r){var o=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(n=i(n))!=n,l=null===n,c=os(n),u=n===e;o<a;){var d=cn((o+a)/2),p=i(t[d]),h=p!==e,f=null===p,m=p==p,v=os(p);if(s)var g=r||m;else g=u?m&&(r||h):l?m&&h&&(r||!f):c?m&&h&&!f&&(r||!v):!f&&!v&&(r?p<=n:p<n);g?o=d+1:a=d}return vn(a,4294967294)}function ir(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n],s=t?t(a):a;if(!n||!Oa(s,l)){var l=s;o[r++]=0===a?0:a}}return o}function rr(e){return"number"==typeof e?e:os(e)?l:+e}function or(e){if("string"==typeof e)return e;if(Ua(e))return St(e,or)+"";if(os(e))return Ln?Ln.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ar(e,t,n){var i=-1,r=wt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,r=Ct;else if(o>=200){var c=t?null:Gr(e);if(c)return en(c);a=!1,r=jt,l=new Gn}else l=t?[]:s;e:for(;++i<o;){var u=e[i],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else r(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function sr(e,t){return null==(e=So(e,t=mr(t,e)))||delete e[Ro(Ko(t))]}function lr(e,t,n,i){return Xi(e,t,n(Ei(e,t)),i)}function cr(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?$i(e,i?0:o,i?o+1:r):$i(e,i?o+1:0,i?r:o)}function ur(e,t){var n=e;return n instanceof Un&&(n=n.value()),_t(t,(function(e,t){return t.func.apply(t.thisArg,kt([e],t.args))}),n)}function dr(e,t,n){var i=e.length;if(i<2)return i?ar(e[0]):[];for(var r=-1,o=be(i);++r<i;)for(var a=e[r],s=-1;++s<i;)s!=r&&(o[r]=li(o[r]||a,e[s],t,n));return ar(fi(o,1),t,n)}function pr(t,n,i){for(var r=-1,o=t.length,a=n.length,s={};++r<o;){var l=r<a?n[r]:e;i(s,t[r],l)}return s}function hr(e){return ja(e)?e:[]}function fr(e){return"function"==typeof e?e:el}function mr(e,t){return Ua(e)?e:go(e,t)?[e]:Do(ms(e))}var vr=qi;function gr(t,n,i){var r=t.length;return i=i===e?r:i,!n&&i>=r?t:$i(t,n,i)}var yr=Pt||function(e){return tt.clearTimeout(e)};function br(e,t){if(t)return e.slice();var n=e.length,i=$e?$e(n):new e.constructor(n);return e.copy(i),i}function Er(e){var t=new e.constructor(e.byteLength);return new Qe(t).set(new Qe(e)),t}function xr(e,t){var n=t?Er(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function wr(t,n){if(t!==n){var i=t!==e,r=null===t,o=t==t,a=os(t),s=n!==e,l=null===n,c=n==n,u=os(n);if(!l&&!u&&!a&&t>n||a&&s&&c&&!l&&!u||r&&s&&c||!i&&c||!o)return 1;if(!r&&!a&&!u&&t<n||u&&i&&o&&!r&&!a||l&&i&&o||!s&&o||!c)return-1}return 0}function Cr(e,t,n,i){for(var r=-1,o=e.length,a=n.length,s=-1,l=t.length,c=mn(o-a,0),u=be(l+c),d=!i;++s<l;)u[s]=t[s];for(;++r<a;)(d||r<o)&&(u[n[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}function Sr(e,t,n,i){for(var r=-1,o=e.length,a=-1,s=n.length,l=-1,c=t.length,u=mn(o-s,0),d=be(u+c),p=!i;++r<u;)d[r]=e[r];for(var h=r;++l<c;)d[h+l]=t[l];for(;++a<s;)(p||r<o)&&(d[h+n[a]]=e[r++]);return d}function kr(e,t){var n=-1,i=e.length;for(t||(t=be(i));++n<i;)t[n]=e[n];return t}function _r(t,n,i,r){var o=!i;i||(i={});for(var a=-1,s=n.length;++a<s;){var l=n[a],c=r?r(i[l],t[l],l,i,t):e;c===e&&(c=t[l]),o?ni(i,l,c):Jn(i,l,c)}return i}function Tr(e,t){return function(n,i){var r=Ua(n)?ft:ei,o=t?t():{};return r(n,e,ro(i,2),o)}}function Ir(t){return qi((function(n,i){var r=-1,o=i.length,a=o>1?i[o-1]:e,s=o>2?i[2]:e;for(a=t.length>3&&"function"==typeof a?(o--,a):e,s&&vo(i[0],i[1],s)&&(a=o<3?e:a,o=1),n=Se(n);++r<o;){var l=i[r];l&&t(n,l,r,a)}return n}))}function Pr(e,t){return function(n,i){if(null==n)return n;if(!Va(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Se(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function Nr(e){return function(t,n,i){for(var r=-1,o=Se(t),a=i(t),s=a.length;s--;){var l=a[e?s:++r];if(!1===n(o[l],l,o))break}return t}}function Mr(t){return function(n){var i=Qt(n=ms(n))?nn(n):e,r=i?i[0]:n.charAt(0),o=i?gr(i,1).join(""):n.slice(1);return r[t]()+o}}function Ar(e){return function(t){return _t(Ys(Hs(t).replace(He,"")),e,"")}}function Dr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Fn(e.prototype),i=e.apply(n,t);return Za(i)?i:n}}function Rr(t){return function(n,i,r){var o=Se(n);if(!Va(n)){var a=ro(i,3);n=Is(n),i=function(e){return a(o[e],e,o)}}var s=t(n,i,r);return s>-1?o[a?n[s]:s]:e}}function Br(n){return Jr((function(i){var r=i.length,o=r,a=Hn.prototype.thru;for(n&&i.reverse();o--;){var s=i[o];if("function"!=typeof s)throw new Te(t);if(a&&!l&&"wrapper"==no(s))var l=new Hn([],!0)}for(o=l?o:r;++o<r;){var c=no(s=i[o]),u="wrapper"==c?to(s):e;l=u&&yo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[no(u[0])].apply(l,u[3]):1==s.length&&yo(s)?l[c]():l.thru(s)}return function(){var e=arguments,t=e[0];if(l&&1==e.length&&Ua(t))return l.plant(t).value();for(var n=0,o=r?i[n].apply(this,e):t;++n<r;)o=i[n].call(this,o);return o}}))}function Lr(t,n,i,r,a,s,l,c,u,d){var p=n&o,h=1&n,f=2&n,m=24&n,v=512&n,g=f?e:Dr(t);return function e(){for(var o=arguments.length,y=be(o),b=o;b--;)y[b]=arguments[b];if(m)var E=io(e),x=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(y,E);if(r&&(y=Cr(y,r,a,m)),s&&(y=Sr(y,s,l,m)),o-=x,m&&o<d){var w=$t(y,E);return Vr(t,n,Lr,e.placeholder,i,y,w,c,u,d-o)}var C=h?i:this,S=f?C[t]:t;return o=y.length,c?y=ko(y,c):v&&o>1&&y.reverse(),p&&u<o&&(y.length=u),this&&this!==tt&&this instanceof e&&(S=g||Dr(S)),S.apply(C,y)}}function Or(e,t){return function(n,i){return function(e,t,n,i){return gi(e,(function(e,r,o){t(i,n(e),r,o)})),i}(n,e,t(i),{})}}function Fr(t,n){return function(i,r){var o;if(i===e&&r===e)return n;if(i!==e&&(o=i),r!==e){if(o===e)return r;"string"==typeof i||"string"==typeof r?(i=or(i),r=or(r)):(i=rr(i),r=rr(r)),o=t(i,r)}return o}}function zr(e){return Jr((function(t){return t=St(t,Wt(ro())),qi((function(n){var i=this;return e(t,(function(e){return ht(e,i,n)}))}))}))}function Hr(t,n){var i=(n=n===e?" ":or(n)).length;if(i<2)return i?Gi(n,t):n;var r=Gi(n,ln(t/tn(n)));return Qt(n)?gr(nn(r),0,t).join(""):r.slice(0,t)}function Ur(t){return function(n,i,r){return r&&"number"!=typeof r&&vo(n,i,r)&&(i=r=e),n=us(n),i===e?(i=n,n=0):i=us(i),function(e,t,n,i){for(var r=-1,o=mn(ln((t-e)/(n||1)),0),a=be(o);o--;)a[i?o:++r]=e,e+=n;return a}(n,i,r=r===e?n<i?1:-1:us(r),t)}}function Wr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=hs(t),n=hs(n)),e(t,n)}}function Vr(t,n,i,o,a,s,l,c,u,d){var p=8&n;n|=p?r:64,4&(n&=~(p?64:r))||(n&=-4);var h=[t,n,a,p?s:e,p?l:e,p?e:s,p?e:l,c,u,d],f=i.apply(e,h);return yo(t)&&To(f,h),f.placeholder=o,No(f,t,n)}function jr(e){var t=Ce[e];return function(e,n){if(e=hs(e),(n=null==n?0:vn(ds(n),292))&&pn(e)){var i=(ms(e)+"e").split("e");return+((i=(ms(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var Gr=Sn&&1/en(new Sn([,-0]))[1]==a?function(e){return new Sn(e)}:ol;function qr(e){return function(t){var n=uo(t);return n==y?Zt(t):n==C?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return St(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Kr(n,a,s,l,c,u,d,p){var h=2&a;if(!h&&"function"!=typeof n)throw new Te(t);var f=l?l.length:0;if(f||(a&=-97,l=c=e),d=d===e?d:mn(ds(d),0),p=p===e?p:ds(p),f-=c?c.length:0,64&a){var m=l,v=c;l=c=e}var g=h?e:to(n),y=[n,a,s,l,c,m,v,u,d,p];if(g&&function(e,t){var n=e[1],r=t[1],a=n|r,s=a<131,l=r==o&&8==n||r==o&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!l)return e;1&r&&(e[2]=t[2],a|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?Cr(u,c,t[4]):c,e[4]=u?$t(e[3],i):t[4]}(c=t[5])&&(u=e[5],e[5]=u?Sr(u,c,t[6]):c,e[6]=u?$t(e[5],i):t[6]),(c=t[7])&&(e[7]=c),r&o&&(e[8]=null==e[8]?t[8]:vn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=a}(y,g),n=y[0],a=y[1],s=y[2],l=y[3],c=y[4],!(p=y[9]=y[9]===e?h?0:n.length:mn(y[9]-f,0))&&24&a&&(a&=-25),a&&1!=a)b=8==a||16==a?function(t,n,i){var r=Dr(t);return function o(){for(var a=arguments.length,s=be(a),l=a,c=io(o);l--;)s[l]=arguments[l];var u=a<3&&s[0]!==c&&s[a-1]!==c?[]:$t(s,c);return(a-=u.length)<i?Vr(t,n,Lr,o.placeholder,e,s,u,e,e,i-a):ht(this&&this!==tt&&this instanceof o?r:t,this,s)}}(n,a,p):a!=r&&33!=a||c.length?Lr.apply(e,y):function(e,t,n,i){var r=1&t,o=Dr(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=i.length,u=be(c+s),d=this&&this!==tt&&this instanceof t?o:e;++l<c;)u[l]=i[l];for(;s--;)u[l++]=arguments[++a];return ht(d,r?n:this,u)}}(n,a,s,l);else var b=function(e,t,n){var i=1&t,r=Dr(e);return function t(){return(this&&this!==tt&&this instanceof t?r:e).apply(i?n:this,arguments)}}(n,a,s);return No((g?Qi:To)(b,y),n,a)}function Yr(t,n,i,r){return t===e||Oa(t,Ne[i])&&!De.call(r,i)?n:t}function Xr(t,n,i,r,o,a){return Za(t)&&Za(n)&&(a.set(n,t),Fi(t,n,e,Xr,a),a.delete(n)),t}function Qr(t){return ts(t)?e:t}function Zr(t,n,i,r,o,a){var s=1&i,l=t.length,c=n.length;if(l!=c&&!(s&&c>l))return!1;var u=a.get(t),d=a.get(n);if(u&&d)return u==n&&d==t;var p=-1,h=!0,f=2&i?new Gn:e;for(a.set(t,n),a.set(n,t);++p<l;){var m=t[p],v=n[p];if(r)var g=s?r(v,m,p,n,t,a):r(m,v,p,t,n,a);if(g!==e){if(g)continue;h=!1;break}if(f){if(!It(n,(function(e,t){if(!jt(f,t)&&(m===e||o(m,e,i,r,a)))return f.push(t)}))){h=!1;break}}else if(m!==v&&!o(m,v,i,r,a)){h=!1;break}}return a.delete(t),a.delete(n),h}function Jr(t){return Po(Co(t,e,Wo),t+"")}function $r(e){return xi(e,Is,lo)}function eo(e){return xi(e,Ps,co)}var to=Tn?function(e){return Tn.get(e)}:ol;function no(e){for(var t=e.name+"",n=In[t],i=De.call(In,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function io(e){return(De.call(On,"placeholder")?On:e).placeholder}function ro(){var e=On.iteratee||tl;return e=e===tl?Ai:e,arguments.length?e(arguments[0],arguments[1]):e}function oo(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function ao(e){for(var t=Is(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,xo(r)]}return t}function so(t,n){var i=function(t,n){return null==t?e:t[n]}(t,n);return Mi(i)?i:e}var lo=un?function(e){return null==e?[]:(e=Se(e),xt(un(e),(function(t){return it.call(e,t)})))}:pl,co=un?function(e){for(var t=[];e;)kt(t,lo(e)),e=et(e);return t}:pl,uo=wi;function po(e,t,n){for(var i=-1,r=(t=mr(t,e)).length,o=!1;++i<r;){var a=Ro(t[i]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++i!=r?o:!!(r=null==e?0:e.length)&&Qa(r)&&mo(a,r)&&(Ua(e)||Ha(e))}function ho(e){return"function"!=typeof e.constructor||Eo(e)?{}:Fn(et(e))}function fo(e){return Ua(e)||Ha(e)||!!(at&&e&&e[at])}function mo(e,t){var n=typeof e;return!!(t=null==t?s:t)&&("number"==n||"symbol"!=n&&he.test(e))&&e>-1&&e%1==0&&e<t}function vo(e,t,n){if(!Za(n))return!1;var i=typeof t;return!!("number"==i?Va(n)&&mo(t,n.length):"string"==i&&t in n)&&Oa(n[t],e)}function go(e,t){if(Ua(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!os(e))||X.test(e)||!Y.test(e)||null!=t&&e in Se(t)}function yo(e){var t=no(e),n=On[t];if("function"!=typeof n||!(t in Un.prototype))return!1;if(e===n)return!0;var i=to(n);return!!i&&e===i[0]}(xn&&uo(new xn(new ArrayBuffer(1)))!=I||wn&&uo(new wn)!=y||Cn&&uo(Cn.resolve())!=x||Sn&&uo(new Sn)!=C||kn&&uo(new kn)!=_)&&(uo=function(t){var n=wi(t),i=n==E?t.constructor:e,r=i?Bo(i):"";if(r)switch(r){case Pn:return I;case Nn:return y;case Mn:return x;case An:return C;case Dn:return _}return n});var bo=Me?Ya:hl;function Eo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ne)}function xo(e){return e==e&&!Za(e)}function wo(t,n){return function(i){return null!=i&&i[t]===n&&(n!==e||t in Se(i))}}function Co(t,n,i){return n=mn(n===e?t.length-1:n,0),function(){for(var e=arguments,r=-1,o=mn(e.length-n,0),a=be(o);++r<o;)a[r]=e[n+r];r=-1;for(var s=be(n+1);++r<n;)s[r]=e[r];return s[n]=i(a),ht(t,this,s)}}function So(e,t){return t.length<2?e:Ei(e,$i(t,0,-1))}function ko(t,n){for(var i=t.length,r=vn(n.length,i),o=kr(t);r--;){var a=n[r];t[r]=mo(a,i)?o[a]:e}return t}function _o(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var To=Mo(Qi),Io=sn||function(e,t){return tt.setTimeout(e,t)},Po=Mo(Zi);function No(e,t,n){var i=t+"";return Po(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(te,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return yt(u,(function(n){var i="_."+n[0];t&n[1]&&!wt(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(ne);return t?t[1].split(ie):[]}(i),n)))}function Mo(t){var n=0,i=0;return function(){var r=gn(),o=16-(r-i);if(i=r,o>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(e,arguments)}}function Ao(t,n){var i=-1,r=t.length,o=r-1;for(n=n===e?r:n;++i<n;){var a=ji(i,o),s=t[a];t[a]=t[i],t[i]=s}return t.length=n,t}var Do=function(e){var t=Ma((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Q,(function(e,n,i,r){t.push(i?r.replace(ae,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();function Ro(e){if("string"==typeof e||os(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Bo(e){if(null!=e){try{return Ae.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Lo(e){if(e instanceof Un)return e.clone();var t=new Hn(e.__wrapped__,e.__chain__);return t.__actions__=kr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Oo=qi((function(e,t){return ja(e)?li(e,fi(t,1,ja,!0)):[]})),Fo=qi((function(t,n){var i=Ko(n);return ja(i)&&(i=e),ja(t)?li(t,fi(n,1,ja,!0),ro(i,2)):[]})),zo=qi((function(t,n){var i=Ko(n);return ja(i)&&(i=e),ja(t)?li(t,fi(n,1,ja,!0),e,i):[]}));function Ho(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:ds(n);return r<0&&(r=mn(i+r,0)),Mt(e,ro(t,3),r)}function Uo(t,n,i){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return i!==e&&(o=ds(i),o=i<0?mn(r+o,0):vn(o,r-1)),Mt(t,ro(n,3),o,!0)}function Wo(e){return null!=e&&e.length?fi(e,1):[]}function Vo(t){return t&&t.length?t[0]:e}var jo=qi((function(e){var t=St(e,hr);return t.length&&t[0]===e[0]?_i(t):[]})),Go=qi((function(t){var n=Ko(t),i=St(t,hr);return n===Ko(i)?n=e:i.pop(),i.length&&i[0]===t[0]?_i(i,ro(n,2)):[]})),qo=qi((function(t){var n=Ko(t),i=St(t,hr);return(n="function"==typeof n?n:e)&&i.pop(),i.length&&i[0]===t[0]?_i(i,e,n):[]}));function Ko(t){var n=null==t?0:t.length;return n?t[n-1]:e}var Yo=qi(Xo);function Xo(e,t){return e&&e.length&&t&&t.length?Wi(e,t):e}var Qo=Jr((function(e,t){var n=null==e?0:e.length,i=ii(e,t);return Vi(e,St(t,(function(e){return mo(e,n)?+e:e})).sort(wr)),i}));function Zo(e){return null==e?e:En.call(e)}var Jo=qi((function(e){return ar(fi(e,1,ja,!0))})),$o=qi((function(t){var n=Ko(t);return ja(n)&&(n=e),ar(fi(t,1,ja,!0),ro(n,2))})),ea=qi((function(t){var n=Ko(t);return n="function"==typeof n?n:e,ar(fi(t,1,ja,!0),e,n)}));function ta(e){if(!e||!e.length)return[];var t=0;return e=xt(e,(function(e){if(ja(e))return t=mn(e.length,t),!0})),Ht(t,(function(t){return St(e,Lt(t))}))}function na(t,n){if(!t||!t.length)return[];var i=ta(t);return null==n?i:St(i,(function(t){return ht(n,e,t)}))}var ia=qi((function(e,t){return ja(e)?li(e,t):[]})),ra=qi((function(e){return dr(xt(e,ja))})),oa=qi((function(t){var n=Ko(t);return ja(n)&&(n=e),dr(xt(t,ja),ro(n,2))})),aa=qi((function(t){var n=Ko(t);return n="function"==typeof n?n:e,dr(xt(t,ja),e,n)})),sa=qi(ta),la=qi((function(t){var n=t.length,i=n>1?t[n-1]:e;return i="function"==typeof i?(t.pop(),i):e,na(t,i)}));function ca(e){var t=On(e);return t.__chain__=!0,t}function ua(e,t){return t(e)}var da=Jr((function(t){var n=t.length,i=n?t[0]:0,r=this.__wrapped__,o=function(e){return ii(e,t)};return!(n>1||this.__actions__.length)&&r instanceof Un&&mo(i)?((r=r.slice(i,+i+(n?1:0))).__actions__.push({func:ua,args:[o],thisArg:e}),new Hn(r,this.__chain__).thru((function(t){return n&&!t.length&&t.push(e),t}))):this.thru(o)})),pa=Tr((function(e,t,n){De.call(e,n)?++e[n]:ni(e,n,1)})),ha=Rr(Ho),fa=Rr(Uo);function ma(e,t){return(Ua(e)?yt:ci)(e,ro(t,3))}function va(e,t){return(Ua(e)?bt:ui)(e,ro(t,3))}var ga=Tr((function(e,t,n){De.call(e,n)?e[n].push(t):ni(e,n,[t])})),ya=qi((function(e,t,n){var i=-1,r="function"==typeof t,o=Va(e)?be(e.length):[];return ci(e,(function(e){o[++i]=r?ht(t,e,n):Ti(e,t,n)})),o})),ba=Tr((function(e,t,n){ni(e,n,t)}));function Ea(e,t){return(Ua(e)?St:Bi)(e,ro(t,3))}var xa=Tr((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),wa=qi((function(e,t){if(null==e)return[];var n=t.length;return n>1&&vo(e,t[0],t[1])?t=[]:n>2&&vo(t[0],t[1],t[2])&&(t=[t[0]]),Hi(e,fi(t,1),[])})),Ca=Ot||function(){return tt.Date.now()};function Sa(t,n,i){return n=i?e:n,n=t&&null==n?t.length:n,Kr(t,o,e,e,e,e,n)}function ka(n,i){var r;if("function"!=typeof i)throw new Te(t);return n=ds(n),function(){return--n>0&&(r=i.apply(this,arguments)),n<=1&&(i=e),r}}var _a=qi((function(e,t,n){var i=1;if(n.length){var o=$t(n,io(_a));i|=r}return Kr(e,i,t,n,o)})),Ta=qi((function(e,t,n){var i=3;if(n.length){var o=$t(n,io(Ta));i|=r}return Kr(t,i,e,n,o)}));function Ia(n,i,r){var o,a,s,l,c,u,d=0,p=!1,h=!1,f=!0;if("function"!=typeof n)throw new Te(t);function m(t){var i=o,r=a;return o=a=e,d=t,l=n.apply(r,i)}function v(t){var n=t-u;return u===e||n>=i||n<0||h&&t-d>=s}function g(){var e=Ca();if(v(e))return y(e);c=Io(g,function(e){var t=i-(e-u);return h?vn(t,s-(e-d)):t}(e))}function y(t){return c=e,f&&o?m(t):(o=a=e,l)}function b(){var t=Ca(),n=v(t);if(o=arguments,a=this,u=t,n){if(c===e)return function(e){return d=e,c=Io(g,i),p?m(e):l}(u);if(h)return yr(c),c=Io(g,i),m(u)}return c===e&&(c=Io(g,i)),l}return i=hs(i)||0,Za(r)&&(p=!!r.leading,s=(h="maxWait"in r)?mn(hs(r.maxWait)||0,i):s,f="trailing"in r?!!r.trailing:f),b.cancel=function(){c!==e&&yr(c),d=0,o=u=a=c=e},b.flush=function(){return c===e?l:y(Ca())},b}var Pa=qi((function(e,t){return si(e,1,t)})),Na=qi((function(e,t,n){return si(e,hs(t)||0,n)}));function Ma(e,n){if("function"!=typeof e||null!=n&&"function"!=typeof n)throw new Te(t);var i=function(){var t=arguments,r=n?n.apply(this,t):t[0],o=i.cache;if(o.has(r))return o.get(r);var a=e.apply(this,t);return i.cache=o.set(r,a)||o,a};return i.cache=new(Ma.Cache||jn),i}function Aa(e){if("function"!=typeof e)throw new Te(t);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ma.Cache=jn;var Da=vr((function(e,t){var n=(t=1==t.length&&Ua(t[0])?St(t[0],Wt(ro())):St(fi(t,1),Wt(ro()))).length;return qi((function(i){for(var r=-1,o=vn(i.length,n);++r<o;)i[r]=t[r].call(this,i[r]);return ht(e,this,i)}))})),Ra=qi((function(t,n){var i=$t(n,io(Ra));return Kr(t,r,e,n,i)})),Ba=qi((function(t,n){var i=$t(n,io(Ba));return Kr(t,64,e,n,i)})),La=Jr((function(t,n){return Kr(t,256,e,e,e,n)}));function Oa(e,t){return e===t||e!=e&&t!=t}var Fa=Wr(Ci),za=Wr((function(e,t){return e>=t})),Ha=Ii(function(){return arguments}())?Ii:function(e){return Ja(e)&&De.call(e,"callee")&&!it.call(e,"callee")},Ua=be.isArray,Wa=st?Wt(st):function(e){return Ja(e)&&wi(e)==T};function Va(e){return null!=e&&Qa(e.length)&&!Ya(e)}function ja(e){return Ja(e)&&Va(e)}var Ga=dn||hl,qa=lt?Wt(lt):function(e){return Ja(e)&&wi(e)==f};function Ka(e){if(!Ja(e))return!1;var t=wi(e);return t==m||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ts(e)}function Ya(e){if(!Za(e))return!1;var t=wi(e);return t==v||t==g||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Xa(e){return"number"==typeof e&&e==ds(e)}function Qa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function Za(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ja(e){return null!=e&&"object"==typeof e}var $a=ct?Wt(ct):function(e){return Ja(e)&&uo(e)==y};function es(e){return"number"==typeof e||Ja(e)&&wi(e)==b}function ts(e){if(!Ja(e)||wi(e)!=E)return!1;var t=et(e);if(null===t)return!0;var n=De.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ae.call(n)==Oe}var ns=ut?Wt(ut):function(e){return Ja(e)&&wi(e)==w},is=dt?Wt(dt):function(e){return Ja(e)&&uo(e)==C};function rs(e){return"string"==typeof e||!Ua(e)&&Ja(e)&&wi(e)==S}function os(e){return"symbol"==typeof e||Ja(e)&&wi(e)==k}var as=pt?Wt(pt):function(e){return Ja(e)&&Qa(e.length)&&!!Ye[wi(e)]},ss=Wr(Ri),ls=Wr((function(e,t){return e<=t}));function cs(e){if(!e)return[];if(Va(e))return rs(e)?nn(e):kr(e);if(mt&&e[mt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[mt]());var t=uo(e);return(t==y?Zt:t==C?en:Os)(e)}function us(e){return e?(e=hs(e))===a||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ds(e){var t=us(e),n=t%1;return t==t?n?t-n:t:0}function ps(e){return e?ri(ds(e),0,c):0}function hs(e){if("number"==typeof e)return e;if(os(e))return l;if(Za(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Za(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ut(e);var n=ue.test(e);return n||pe.test(e)?Je(e.slice(2),n?2:8):ce.test(e)?l:+e}function fs(e){return _r(e,Ps(e))}function ms(e){return null==e?"":or(e)}var vs=Ir((function(e,t){if(Eo(t)||Va(t))_r(t,Is(t),e);else for(var n in t)De.call(t,n)&&Jn(e,n,t[n])})),gs=Ir((function(e,t){_r(t,Ps(t),e)})),ys=Ir((function(e,t,n,i){_r(t,Ps(t),e,i)})),bs=Ir((function(e,t,n,i){_r(t,Is(t),e,i)})),Es=Jr(ii),xs=qi((function(t,n){t=Se(t);var i=-1,r=n.length,o=r>2?n[2]:e;for(o&&vo(n[0],n[1],o)&&(r=1);++i<r;)for(var a=n[i],s=Ps(a),l=-1,c=s.length;++l<c;){var u=s[l],d=t[u];(d===e||Oa(d,Ne[u])&&!De.call(t,u))&&(t[u]=a[u])}return t})),ws=qi((function(t){return t.push(e,Xr),ht(Ms,e,t)}));function Cs(t,n,i){var r=null==t?e:Ei(t,n);return r===e?i:r}function Ss(e,t){return null!=e&&po(e,t,ki)}var ks=Or((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Le.call(t)),e[t]=n}),Zs(el)),_s=Or((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Le.call(t)),De.call(e,t)?e[t].push(n):e[t]=[n]}),ro),Ts=qi(Ti);function Is(e){return Va(e)?Kn(e):Di(e)}function Ps(e){return Va(e)?Kn(e,!0):function(e){if(!Za(e))return function(e){var t=[];if(null!=e)for(var n in Se(e))t.push(n);return t}(e);var t=Eo(e),n=[];for(var i in e)("constructor"!=i||!t&&De.call(e,i))&&n.push(i);return n}(e)}var Ns=Ir((function(e,t,n){Fi(e,t,n)})),Ms=Ir((function(e,t,n,i){Fi(e,t,n,i)})),As=Jr((function(e,t){var n={};if(null==e)return n;var i=!1;t=St(t,(function(t){return t=mr(t,e),i||(i=t.length>1),t})),_r(e,eo(e),n),i&&(n=oi(n,7,Qr));for(var r=t.length;r--;)sr(n,t[r]);return n})),Ds=Jr((function(e,t){return null==e?{}:function(e,t){return Ui(e,t,(function(t,n){return Ss(e,n)}))}(e,t)}));function Rs(e,t){if(null==e)return{};var n=St(eo(e),(function(e){return[e]}));return t=ro(t),Ui(e,n,(function(e,n){return t(e,n[0])}))}var Bs=qr(Is),Ls=qr(Ps);function Os(e){return null==e?[]:Vt(e,Is(e))}var Fs=Ar((function(e,t,n){return t=t.toLowerCase(),e+(n?zs(t):t)}));function zs(e){return Ks(ms(e).toLowerCase())}function Hs(e){return(e=ms(e))&&e.replace(fe,Kt).replace(Ue,"")}var Us=Ar((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Ws=Ar((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Vs=Mr("toLowerCase"),js=Ar((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Gs=Ar((function(e,t,n){return e+(n?" ":"")+Ks(t)})),qs=Ar((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ks=Mr("toUpperCase");function Ys(t,n,i){return t=ms(t),(n=i?e:n)===e?function(e){return Ge.test(e)}(t)?function(e){return e.match(Ve)||[]}(t):function(e){return e.match(re)||[]}(t):t.match(n)||[]}var Xs=qi((function(t,n){try{return ht(t,e,n)}catch(e){return Ka(e)?e:new xe(e)}})),Qs=Jr((function(e,t){return yt(t,(function(t){t=Ro(t),ni(e,t,_a(e[t],e))})),e}));function Zs(e){return function(){return e}}var Js=Br(),$s=Br(!0);function el(e){return e}function tl(e){return Ai("function"==typeof e?e:oi(e,1))}var nl=qi((function(e,t){return function(n){return Ti(n,e,t)}})),il=qi((function(e,t){return function(n){return Ti(e,n,t)}}));function rl(e,t,n){var i=Is(t),r=bi(t,i);null!=n||Za(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=bi(t,Is(t)));var o=!(Za(n)&&"chain"in n&&!n.chain),a=Ya(e);return yt(r,(function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=kr(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,kt([this.value()],arguments))})})),e}function ol(){}var al=zr(St),sl=zr(Et),ll=zr(It);function cl(e){return go(e)?Lt(Ro(e)):function(e){return function(t){return Ei(t,e)}}(e)}var ul=Ur(),dl=Ur(!0);function pl(){return[]}function hl(){return!1}var fl,ml=Fr((function(e,t){return e+t}),0),vl=jr("ceil"),gl=Fr((function(e,t){return e/t}),1),yl=jr("floor"),bl=Fr((function(e,t){return e*t}),1),El=jr("round"),xl=Fr((function(e,t){return e-t}),0);return On.after=function(e,n){if("function"!=typeof n)throw new Te(t);return e=ds(e),function(){if(--e<1)return n.apply(this,arguments)}},On.ary=Sa,On.assign=vs,On.assignIn=gs,On.assignInWith=ys,On.assignWith=bs,On.at=Es,On.before=ka,On.bind=_a,On.bindAll=Qs,On.bindKey=Ta,On.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ua(e)?e:[e]},On.chain=ca,On.chunk=function(t,n,i){n=(i?vo(t,n,i):n===e)?1:mn(ds(n),0);var r=null==t?0:t.length;if(!r||n<1)return[];for(var o=0,a=0,s=be(ln(r/n));o<r;)s[a++]=$i(t,o,o+=n);return s},On.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var o=e[t];o&&(r[i++]=o)}return r},On.concat=function(){var e=arguments.length;if(!e)return[];for(var t=be(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return kt(Ua(n)?kr(n):[n],fi(t,1))},On.cond=function(e){var n=null==e?0:e.length,i=ro();return e=n?St(e,(function(e){if("function"!=typeof e[1])throw new Te(t);return[i(e[0]),e[1]]})):[],qi((function(t){for(var i=-1;++i<n;){var r=e[i];if(ht(r[0],this,t))return ht(r[1],this,t)}}))},On.conforms=function(e){return function(e){var t=Is(e);return function(n){return ai(n,e,t)}}(oi(e,1))},On.constant=Zs,On.countBy=pa,On.create=function(e,t){var n=Fn(e);return null==t?n:ti(n,t)},On.curry=function t(n,i,r){var o=Kr(n,8,e,e,e,e,e,i=r?e:i);return o.placeholder=t.placeholder,o},On.curryRight=function t(n,i,r){var o=Kr(n,16,e,e,e,e,e,i=r?e:i);return o.placeholder=t.placeholder,o},On.debounce=Ia,On.defaults=xs,On.defaultsDeep=ws,On.defer=Pa,On.delay=Na,On.difference=Oo,On.differenceBy=Fo,On.differenceWith=zo,On.drop=function(t,n,i){var r=null==t?0:t.length;return r?$i(t,(n=i||n===e?1:ds(n))<0?0:n,r):[]},On.dropRight=function(t,n,i){var r=null==t?0:t.length;return r?$i(t,0,(n=r-(n=i||n===e?1:ds(n)))<0?0:n):[]},On.dropRightWhile=function(e,t){return e&&e.length?cr(e,ro(t,3),!0,!0):[]},On.dropWhile=function(e,t){return e&&e.length?cr(e,ro(t,3),!0):[]},On.fill=function(t,n,i,r){var o=null==t?0:t.length;return o?(i&&"number"!=typeof i&&vo(t,n,i)&&(i=0,r=o),function(t,n,i,r){var o=t.length;for((i=ds(i))<0&&(i=-i>o?0:o+i),(r=r===e||r>o?o:ds(r))<0&&(r+=o),r=i>r?0:ps(r);i<r;)t[i++]=n;return t}(t,n,i,r)):[]},On.filter=function(e,t){return(Ua(e)?xt:hi)(e,ro(t,3))},On.flatMap=function(e,t){return fi(Ea(e,t),1)},On.flatMapDeep=function(e,t){return fi(Ea(e,t),a)},On.flatMapDepth=function(t,n,i){return i=i===e?1:ds(i),fi(Ea(t,n),i)},On.flatten=Wo,On.flattenDeep=function(e){return null!=e&&e.length?fi(e,a):[]},On.flattenDepth=function(t,n){return null!=t&&t.length?fi(t,n=n===e?1:ds(n)):[]},On.flip=function(e){return Kr(e,512)},On.flow=Js,On.flowRight=$s,On.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i},On.functions=function(e){return null==e?[]:bi(e,Is(e))},On.functionsIn=function(e){return null==e?[]:bi(e,Ps(e))},On.groupBy=ga,On.initial=function(e){return null!=e&&e.length?$i(e,0,-1):[]},On.intersection=jo,On.intersectionBy=Go,On.intersectionWith=qo,On.invert=ks,On.invertBy=_s,On.invokeMap=ya,On.iteratee=tl,On.keyBy=ba,On.keys=Is,On.keysIn=Ps,On.map=Ea,On.mapKeys=function(e,t){var n={};return t=ro(t,3),gi(e,(function(e,i,r){ni(n,t(e,i,r),e)})),n},On.mapValues=function(e,t){var n={};return t=ro(t,3),gi(e,(function(e,i,r){ni(n,i,t(e,i,r))})),n},On.matches=function(e){return Li(oi(e,1))},On.matchesProperty=function(e,t){return Oi(e,oi(t,1))},On.memoize=Ma,On.merge=Ns,On.mergeWith=Ms,On.method=nl,On.methodOf=il,On.mixin=rl,On.negate=Aa,On.nthArg=function(e){return e=ds(e),qi((function(t){return zi(t,e)}))},On.omit=As,On.omitBy=function(e,t){return Rs(e,Aa(ro(t)))},On.once=function(e){return ka(2,e)},On.orderBy=function(t,n,i,r){return null==t?[]:(Ua(n)||(n=null==n?[]:[n]),Ua(i=r?e:i)||(i=null==i?[]:[i]),Hi(t,n,i))},On.over=al,On.overArgs=Da,On.overEvery=sl,On.overSome=ll,On.partial=Ra,On.partialRight=Ba,On.partition=xa,On.pick=Ds,On.pickBy=Rs,On.property=cl,On.propertyOf=function(t){return function(n){return null==t?e:Ei(t,n)}},On.pull=Yo,On.pullAll=Xo,On.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Wi(e,t,ro(n,2)):e},On.pullAllWith=function(t,n,i){return t&&t.length&&n&&n.length?Wi(t,n,e,i):t},On.pullAt=Qo,On.range=ul,On.rangeRight=dl,On.rearg=La,On.reject=function(e,t){return(Ua(e)?xt:hi)(e,Aa(ro(t,3)))},On.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=ro(t,3);++i<o;){var a=e[i];t(a,i,e)&&(n.push(a),r.push(i))}return Vi(e,r),n},On.rest=function(n,i){if("function"!=typeof n)throw new Te(t);return qi(n,i=i===e?i:ds(i))},On.reverse=Zo,On.sampleSize=function(t,n,i){return n=(i?vo(t,n,i):n===e)?1:ds(n),(Ua(t)?Xn:Yi)(t,n)},On.set=function(e,t,n){return null==e?e:Xi(e,t,n)},On.setWith=function(t,n,i,r){return r="function"==typeof r?r:e,null==t?t:Xi(t,n,i,r)},On.shuffle=function(e){return(Ua(e)?Qn:Ji)(e)},On.slice=function(t,n,i){var r=null==t?0:t.length;return r?(i&&"number"!=typeof i&&vo(t,n,i)?(n=0,i=r):(n=null==n?0:ds(n),i=i===e?r:ds(i)),$i(t,n,i)):[]},On.sortBy=wa,On.sortedUniq=function(e){return e&&e.length?ir(e):[]},On.sortedUniqBy=function(e,t){return e&&e.length?ir(e,ro(t,2)):[]},On.split=function(t,n,i){return i&&"number"!=typeof i&&vo(t,n,i)&&(n=i=e),(i=i===e?c:i>>>0)?(t=ms(t))&&("string"==typeof n||null!=n&&!ns(n))&&!(n=or(n))&&Qt(t)?gr(nn(t),0,i):t.split(n,i):[]},On.spread=function(e,n){if("function"!=typeof e)throw new Te(t);return n=null==n?0:mn(ds(n),0),qi((function(t){var i=t[n],r=gr(t,0,n);return i&&kt(r,i),ht(e,this,r)}))},On.tail=function(e){var t=null==e?0:e.length;return t?$i(e,1,t):[]},On.take=function(t,n,i){return t&&t.length?$i(t,0,(n=i||n===e?1:ds(n))<0?0:n):[]},On.takeRight=function(t,n,i){var r=null==t?0:t.length;return r?$i(t,(n=r-(n=i||n===e?1:ds(n)))<0?0:n,r):[]},On.takeRightWhile=function(e,t){return e&&e.length?cr(e,ro(t,3),!1,!0):[]},On.takeWhile=function(e,t){return e&&e.length?cr(e,ro(t,3)):[]},On.tap=function(e,t){return t(e),e},On.throttle=function(e,n,i){var r=!0,o=!0;if("function"!=typeof e)throw new Te(t);return Za(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Ia(e,n,{leading:r,maxWait:n,trailing:o})},On.thru=ua,On.toArray=cs,On.toPairs=Bs,On.toPairsIn=Ls,On.toPath=function(e){return Ua(e)?St(e,Ro):os(e)?[e]:kr(Do(ms(e)))},On.toPlainObject=fs,On.transform=function(e,t,n){var i=Ua(e),r=i||Ga(e)||as(e);if(t=ro(t,4),null==n){var o=e&&e.constructor;n=r?i?new o:[]:Za(e)&&Ya(o)?Fn(et(e)):{}}return(r?yt:gi)(e,(function(e,i,r){return t(n,e,i,r)})),n},On.unary=function(e){return Sa(e,1)},On.union=Jo,On.unionBy=$o,On.unionWith=ea,On.uniq=function(e){return e&&e.length?ar(e):[]},On.uniqBy=function(e,t){return e&&e.length?ar(e,ro(t,2)):[]},On.uniqWith=function(t,n){return n="function"==typeof n?n:e,t&&t.length?ar(t,e,n):[]},On.unset=function(e,t){return null==e||sr(e,t)},On.unzip=ta,On.unzipWith=na,On.update=function(e,t,n){return null==e?e:lr(e,t,fr(n))},On.updateWith=function(t,n,i,r){return r="function"==typeof r?r:e,null==t?t:lr(t,n,fr(i),r)},On.values=Os,On.valuesIn=function(e){return null==e?[]:Vt(e,Ps(e))},On.without=ia,On.words=Ys,On.wrap=function(e,t){return Ra(fr(t),e)},On.xor=ra,On.xorBy=oa,On.xorWith=aa,On.zip=sa,On.zipObject=function(e,t){return pr(e||[],t||[],Jn)},On.zipObjectDeep=function(e,t){return pr(e||[],t||[],Xi)},On.zipWith=la,On.entries=Bs,On.entriesIn=Ls,On.extend=gs,On.extendWith=ys,rl(On,On),On.add=ml,On.attempt=Xs,On.camelCase=Fs,On.capitalize=zs,On.ceil=vl,On.clamp=function(t,n,i){return i===e&&(i=n,n=e),i!==e&&(i=(i=hs(i))==i?i:0),n!==e&&(n=(n=hs(n))==n?n:0),ri(hs(t),n,i)},On.clone=function(e){return oi(e,4)},On.cloneDeep=function(e){return oi(e,5)},On.cloneDeepWith=function(t,n){return oi(t,5,n="function"==typeof n?n:e)},On.cloneWith=function(t,n){return oi(t,4,n="function"==typeof n?n:e)},On.conformsTo=function(e,t){return null==t||ai(e,t,Is(t))},On.deburr=Hs,On.defaultTo=function(e,t){return null==e||e!=e?t:e},On.divide=gl,On.endsWith=function(t,n,i){t=ms(t),n=or(n);var r=t.length,o=i=i===e?r:ri(ds(i),0,r);return(i-=n.length)>=0&&t.slice(i,o)==n},On.eq=Oa,On.escape=function(e){return(e=ms(e))&&j.test(e)?e.replace(W,Yt):e},On.escapeRegExp=function(e){return(e=ms(e))&&J.test(e)?e.replace(Z,"\\$&"):e},On.every=function(t,n,i){var r=Ua(t)?Et:di;return i&&vo(t,n,i)&&(n=e),r(t,ro(n,3))},On.find=ha,On.findIndex=Ho,On.findKey=function(e,t){return Nt(e,ro(t,3),gi)},On.findLast=fa,On.findLastIndex=Uo,On.findLastKey=function(e,t){return Nt(e,ro(t,3),yi)},On.floor=yl,On.forEach=ma,On.forEachRight=va,On.forIn=function(e,t){return null==e?e:mi(e,ro(t,3),Ps)},On.forInRight=function(e,t){return null==e?e:vi(e,ro(t,3),Ps)},On.forOwn=function(e,t){return e&&gi(e,ro(t,3))},On.forOwnRight=function(e,t){return e&&yi(e,ro(t,3))},On.get=Cs,On.gt=Fa,On.gte=za,On.has=function(e,t){return null!=e&&po(e,t,Si)},On.hasIn=Ss,On.head=Vo,On.identity=el,On.includes=function(e,t,n,i){e=Va(e)?e:Os(e),n=n&&!i?ds(n):0;var r=e.length;return n<0&&(n=mn(r+n,0)),rs(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&At(e,t,n)>-1},On.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:ds(n);return r<0&&(r=mn(i+r,0)),At(e,t,r)},On.inRange=function(t,n,i){return n=us(n),i===e?(i=n,n=0):i=us(i),function(e,t,n){return e>=vn(t,n)&&e<mn(t,n)}(t=hs(t),n,i)},On.invoke=Ts,On.isArguments=Ha,On.isArray=Ua,On.isArrayBuffer=Wa,On.isArrayLike=Va,On.isArrayLikeObject=ja,On.isBoolean=function(e){return!0===e||!1===e||Ja(e)&&wi(e)==h},On.isBuffer=Ga,On.isDate=qa,On.isElement=function(e){return Ja(e)&&1===e.nodeType&&!ts(e)},On.isEmpty=function(e){if(null==e)return!0;if(Va(e)&&(Ua(e)||"string"==typeof e||"function"==typeof e.splice||Ga(e)||as(e)||Ha(e)))return!e.length;var t=uo(e);if(t==y||t==C)return!e.size;if(Eo(e))return!Di(e).length;for(var n in e)if(De.call(e,n))return!1;return!0},On.isEqual=function(e,t){return Pi(e,t)},On.isEqualWith=function(t,n,i){var r=(i="function"==typeof i?i:e)?i(t,n):e;return r===e?Pi(t,n,e,i):!!r},On.isError=Ka,On.isFinite=function(e){return"number"==typeof e&&pn(e)},On.isFunction=Ya,On.isInteger=Xa,On.isLength=Qa,On.isMap=$a,On.isMatch=function(e,t){return e===t||Ni(e,t,ao(t))},On.isMatchWith=function(t,n,i){return i="function"==typeof i?i:e,Ni(t,n,ao(n),i)},On.isNaN=function(e){return es(e)&&e!=+e},On.isNative=function(e){if(bo(e))throw new xe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Mi(e)},On.isNil=function(e){return null==e},On.isNull=function(e){return null===e},On.isNumber=es,On.isObject=Za,On.isObjectLike=Ja,On.isPlainObject=ts,On.isRegExp=ns,On.isSafeInteger=function(e){return Xa(e)&&e>=-9007199254740991&&e<=s},On.isSet=is,On.isString=rs,On.isSymbol=os,On.isTypedArray=as,On.isUndefined=function(t){return t===e},On.isWeakMap=function(e){return Ja(e)&&uo(e)==_},On.isWeakSet=function(e){return Ja(e)&&"[object WeakSet]"==wi(e)},On.join=function(e,t){return null==e?"":hn.call(e,t)},On.kebabCase=Us,On.last=Ko,On.lastIndexOf=function(t,n,i){var r=null==t?0:t.length;if(!r)return-1;var o=r;return i!==e&&(o=(o=ds(i))<0?mn(r+o,0):vn(o,r-1)),n==n?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(t,n,o):Mt(t,Rt,o,!0)},On.lowerCase=Ws,On.lowerFirst=Vs,On.lt=ss,On.lte=ls,On.max=function(t){return t&&t.length?pi(t,el,Ci):e},On.maxBy=function(t,n){return t&&t.length?pi(t,ro(n,2),Ci):e},On.mean=function(e){return Bt(e,el)},On.meanBy=function(e,t){return Bt(e,ro(t,2))},On.min=function(t){return t&&t.length?pi(t,el,Ri):e},On.minBy=function(t,n){return t&&t.length?pi(t,ro(n,2),Ri):e},On.stubArray=pl,On.stubFalse=hl,On.stubObject=function(){return{}},On.stubString=function(){return""},On.stubTrue=function(){return!0},On.multiply=bl,On.nth=function(t,n){return t&&t.length?zi(t,ds(n)):e},On.noConflict=function(){return tt._===this&&(tt._=Fe),this},On.noop=ol,On.now=Ca,On.pad=function(e,t,n){e=ms(e);var i=(t=ds(t))?tn(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Hr(cn(r),n)+e+Hr(ln(r),n)},On.padEnd=function(e,t,n){e=ms(e);var i=(t=ds(t))?tn(e):0;return t&&i<t?e+Hr(t-i,n):e},On.padStart=function(e,t,n){e=ms(e);var i=(t=ds(t))?tn(e):0;return t&&i<t?Hr(t-i,n)+e:e},On.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(ms(e).replace($,""),t||0)},On.random=function(t,n,i){if(i&&"boolean"!=typeof i&&vo(t,n,i)&&(n=i=e),i===e&&("boolean"==typeof n?(i=n,n=e):"boolean"==typeof t&&(i=t,t=e)),t===e&&n===e?(t=0,n=1):(t=us(t),n===e?(n=t,t=0):n=us(n)),t>n){var r=t;t=n,n=r}if(i||t%1||n%1){var o=bn();return vn(t+o*(n-t+Ze("1e-"+((o+"").length-1))),n)}return ji(t,n)},On.reduce=function(e,t,n){var i=Ua(e)?_t:Ft,r=arguments.length<3;return i(e,ro(t,4),n,r,ci)},On.reduceRight=function(e,t,n){var i=Ua(e)?Tt:Ft,r=arguments.length<3;return i(e,ro(t,4),n,r,ui)},On.repeat=function(t,n,i){return n=(i?vo(t,n,i):n===e)?1:ds(n),Gi(ms(t),n)},On.replace=function(){var e=arguments,t=ms(e[0]);return e.length<3?t:t.replace(e[1],e[2])},On.result=function(t,n,i){var r=-1,o=(n=mr(n,t)).length;for(o||(o=1,t=e);++r<o;){var a=null==t?e:t[Ro(n[r])];a===e&&(r=o,a=i),t=Ya(a)?a.call(t):a}return t},On.round=El,On.runInContext=ee,On.sample=function(e){return(Ua(e)?Yn:Ki)(e)},On.size=function(e){if(null==e)return 0;if(Va(e))return rs(e)?tn(e):e.length;var t=uo(e);return t==y||t==C?e.size:Di(e).length},On.snakeCase=js,On.some=function(t,n,i){var r=Ua(t)?It:er;return i&&vo(t,n,i)&&(n=e),r(t,ro(n,3))},On.sortedIndex=function(e,t){return tr(e,t)},On.sortedIndexBy=function(e,t,n){return nr(e,t,ro(n,2))},On.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=tr(e,t);if(i<n&&Oa(e[i],t))return i}return-1},On.sortedLastIndex=function(e,t){return tr(e,t,!0)},On.sortedLastIndexBy=function(e,t,n){return nr(e,t,ro(n,2),!0)},On.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=tr(e,t,!0)-1;if(Oa(e[n],t))return n}return-1},On.startCase=Gs,On.startsWith=function(e,t,n){return e=ms(e),n=null==n?0:ri(ds(n),0,e.length),t=or(t),e.slice(n,n+t.length)==t},On.subtract=xl,On.sum=function(e){return e&&e.length?zt(e,el):0},On.sumBy=function(e,t){return e&&e.length?zt(e,ro(t,2)):0},On.template=function(t,n,i){var r=On.templateSettings;i&&vo(t,n,i)&&(n=e),t=ms(t),n=ys({},n,r,Yr);var o,a,s=ys({},n.imports,r.imports,Yr),l=Is(s),c=Vt(s,l),u=0,d=n.interpolate||me,p="__p += '",h=ke((n.escape||me).source+"|"+d.source+"|"+(d===K?se:me).source+"|"+(n.evaluate||me).source+"|$","g"),f="//# sourceURL="+(De.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ke+"]")+"\n";t.replace(h,(function(e,n,i,r,s,l){return i||(i=r),p+=t.slice(u,l).replace(ve,Xt),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),i&&(p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),p+="';\n";var m=De.call(n,"variable")&&n.variable;if(m){if(oe.test(m))throw new xe("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(a?p.replace(F,""):p).replace(z,"$1").replace(H,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=Xs((function(){return we(l,f+"return "+p).apply(e,c)}));if(v.source=p,Ka(v))throw v;return v},On.times=function(e,t){if((e=ds(e))<1||e>s)return[];var n=c,i=vn(e,c);t=ro(t),e-=c;for(var r=Ht(i,t);++n<e;)t(n);return r},On.toFinite=us,On.toInteger=ds,On.toLength=ps,On.toLower=function(e){return ms(e).toLowerCase()},On.toNumber=hs,On.toSafeInteger=function(e){return e?ri(ds(e),-9007199254740991,s):0===e?e:0},On.toString=ms,On.toUpper=function(e){return ms(e).toUpperCase()},On.trim=function(t,n,i){if((t=ms(t))&&(i||n===e))return Ut(t);if(!t||!(n=or(n)))return t;var r=nn(t),o=nn(n);return gr(r,Gt(r,o),qt(r,o)+1).join("")},On.trimEnd=function(t,n,i){if((t=ms(t))&&(i||n===e))return t.slice(0,rn(t)+1);if(!t||!(n=or(n)))return t;var r=nn(t);return gr(r,0,qt(r,nn(n))+1).join("")},On.trimStart=function(t,n,i){if((t=ms(t))&&(i||n===e))return t.replace($,"");if(!t||!(n=or(n)))return t;var r=nn(t);return gr(r,Gt(r,nn(n))).join("")},On.truncate=function(t,n){var i=30,r="...";if(Za(n)){var o="separator"in n?n.separator:o;i="length"in n?ds(n.length):i,r="omission"in n?or(n.omission):r}var a=(t=ms(t)).length;if(Qt(t)){var s=nn(t);a=s.length}if(i>=a)return t;var l=i-tn(r);if(l<1)return r;var c=s?gr(s,0,l).join(""):t.slice(0,l);if(o===e)return c+r;if(s&&(l+=c.length-l),ns(o)){if(t.slice(l).search(o)){var u,d=c;for(o.global||(o=ke(o.source,ms(le.exec(o))+"g")),o.lastIndex=0;u=o.exec(d);)var p=u.index;c=c.slice(0,p===e?l:p)}}else if(t.indexOf(or(o),l)!=l){var h=c.lastIndexOf(o);h>-1&&(c=c.slice(0,h))}return c+r},On.unescape=function(e){return(e=ms(e))&&V.test(e)?e.replace(U,on):e},On.uniqueId=function(e){var t=++Re;return ms(e)+t},On.upperCase=qs,On.upperFirst=Ks,On.each=ma,On.eachRight=va,On.first=Vo,rl(On,(fl={},gi(On,(function(e,t){De.call(On.prototype,t)||(fl[t]=e)})),fl),{chain:!1}),On.VERSION="4.17.21",yt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){On[e].placeholder=On})),yt(["drop","take"],(function(t,n){Un.prototype[t]=function(i){i=i===e?1:mn(ds(i),0);var r=this.__filtered__&&!n?new Un(this):this.clone();return r.__filtered__?r.__takeCount__=vn(i,r.__takeCount__):r.__views__.push({size:vn(i,c),type:t+(r.__dir__<0?"Right":"")}),r},Un.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),yt(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;Un.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ro(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),yt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Un.prototype[e]=function(){return this[n](1).value()[0]}})),yt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Un.prototype[e]=function(){return this.__filtered__?new Un(this):this[n](1)}})),Un.prototype.compact=function(){return this.filter(el)},Un.prototype.find=function(e){return this.filter(e).head()},Un.prototype.findLast=function(e){return this.reverse().find(e)},Un.prototype.invokeMap=qi((function(e,t){return"function"==typeof e?new Un(this):this.map((function(n){return Ti(n,e,t)}))})),Un.prototype.reject=function(e){return this.filter(Aa(ro(e)))},Un.prototype.slice=function(t,n){t=ds(t);var i=this;return i.__filtered__&&(t>0||n<0)?new Un(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),n!==e&&(i=(n=ds(n))<0?i.dropRight(-n):i.take(n-t)),i)},Un.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Un.prototype.toArray=function(){return this.take(c)},gi(Un.prototype,(function(t,n){var i=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),o=On[r?"take"+("last"==n?"Right":""):n],a=r||/^find/.test(n);o&&(On.prototype[n]=function(){var n=this.__wrapped__,s=r?[1]:arguments,l=n instanceof Un,c=s[0],u=l||Ua(n),d=function(e){var t=o.apply(On,kt([e],s));return r&&p?t[0]:t};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var p=this.__chain__,h=!!this.__actions__.length,f=a&&!p,m=l&&!h;if(!a&&u){n=m?n:new Un(this);var v=t.apply(n,s);return v.__actions__.push({func:ua,args:[d],thisArg:e}),new Hn(v,p)}return f&&m?t.apply(this,s):(v=this.thru(d),f?r?v.value()[0]:v.value():v)})})),yt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ie[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);On.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Ua(r)?r:[],e)}return this[n]((function(n){return t.apply(Ua(n)?n:[],e)}))}})),gi(Un.prototype,(function(e,t){var n=On[t];if(n){var i=n.name+"";De.call(In,i)||(In[i]=[]),In[i].push({name:t,func:n})}})),In[Lr(e,2).name]=[{name:"wrapper",func:e}],Un.prototype.clone=function(){var e=new Un(this.__wrapped__);return e.__actions__=kr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=kr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=kr(this.__views__),e},Un.prototype.reverse=function(){if(this.__filtered__){var e=new Un(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Un.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ua(e),i=t<0,r=n?e.length:0,o=function(e,t,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=vn(t,e+a);break;case"takeRight":e=mn(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,c=i?s:a-1,u=this.__iteratees__,d=u.length,p=0,h=vn(l,this.__takeCount__);if(!n||!i&&r==l&&h==l)return ur(e,this.__actions__);var f=[];e:for(;l--&&p<h;){for(var m=-1,v=e[c+=t];++m<d;){var g=u[m],y=g.iteratee,b=g.type,E=y(v);if(2==b)v=E;else if(!E){if(1==b)continue e;break e}}f[p++]=v}return f},On.prototype.at=da,On.prototype.chain=function(){return ca(this)},On.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},On.prototype.next=function(){this.__values__===e&&(this.__values__=cs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?e:this.__values__[this.__index__++]}},On.prototype.plant=function(t){for(var n,i=this;i instanceof zn;){var r=Lo(i);r.__index__=0,r.__values__=e,n?o.__wrapped__=r:n=r;var o=r;i=i.__wrapped__}return o.__wrapped__=t,n},On.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Un){var n=t;return this.__actions__.length&&(n=new Un(this)),(n=n.reverse()).__actions__.push({func:ua,args:[Zo],thisArg:e}),new Hn(n,this.__chain__)}return this.thru(Zo)},On.prototype.toJSON=On.prototype.valueOf=On.prototype.value=function(){return ur(this.__wrapped__,this.__actions__)},On.prototype.first=On.prototype.head,mt&&(On.prototype[mt]=function(){return this}),On}();it?((it.exports=an)._=an,nt._=an):tt._=an}.call(mt);var bt,Et,xt,wt,Ct,St,kt,_t=yt.exports;!function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.VERTICAL=4]="VERTICAL",e[e.BOTTOM=5]="BOTTOM",e[e.HORI_DISTRIBUTE=6]="HORI_DISTRIBUTE",e[e.VERT_DISTRIBUTE=7]="VERT_DISTRIBUTE"}(bt||(bt={})),function(e){e[e.FrameList=1]="FrameList",e[e.History=2]="History",e[e.Graphic=3]="Graphic"}(Et||(Et={})),function(e){e[e.PERSONAL=1]="PERSONAL",e[e.TEAM=2]="TEAM",e[e.ENTERPRISE=3]="ENTERPRISE"}(xt||(xt={})),function(e){e[e.InMeeting=0]="InMeeting",e[e.Uploading=1]="Uploading"}(wt||(wt={})),function(e){e[e.Summary=1]="Summary",e[e.Sticker=2]="Sticker",e[e.Translate=3]="Translate",e[e.Todo=4]="Todo",e[e.Polishing=5]="Polishing"}(Ct||(Ct={})),function(e){e.PPT="PPT",e.DOCUMENT="DOCUMENT"}(St||(St={})),function(e){e.QUESTION="questions",e.IDEAS="ideas",e.TOPICS="topics",e.MINDMAP="mindmap"}(kt||(kt={}));var Tt=[kt.QUESTION,kt.IDEAS,kt.TOPICS,kt.MINDMAP];function It(e){return Tt.includes(e)}var Pt,Nt,Mt,At,Dt=[Ct.Summary,Ct.Sticker,Ct.Translate,Ct.Todo,Ct.Polishing];function Rt(e){var t=e.left,n=e.top;return{x:t,y:n,width:e.right-t,height:e.bottom-n}}function Bt(e){var t=e.x,n=e.y;return{left:t,top:n,right:t+e.width,bottom:n+e.height}}function Lt(e){return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function Ot(e,t,n){void 0===n&&(n=0);var i=t.left,r=t.top,o=t.right,a=t.bottom,s=e.x,l=e.y;return s>=i-n&&s<=o+n&&l>=r-n&&l<=a+n}function Ft(e,t,n,i,r){void 0===n&&(n=0),void 0===i&&(i=[]),void 0===r&&(r=!1);var o=t.left,a=t.top,s=t.right,l=t.bottom,c=e.x,u=e.y;return c<o+n?i.indexOf("w")>=0?u<(a+l)/2?"nw":"sw":u<a+n?"nw":u>l-n?"sw":r?u>=(a+l)/2-n&&u<=(a+l)/2+n?"w":"":"w":c>s-n?i.indexOf("e")>=0?u<(a+l)/2?"ne":"se":u<a+n?"ne":u>l-n?"se":r?u>=(a+l)/2-n&&u<=(a+l)/2+n?"e":"":"e":u<a+n?i.indexOf("n")>=0?c<(o+s)/2?"nw":"ne":r?c>=(o+s)/2-n&&c<=(o+s)/2+n?"n":"":"n":u>l-n?i.indexOf("s")>=0?c<(o+s)/2?"sw":"se":r?c>=(o+s)/2-n&&c<=(o+s)/2+n?"s":"":"s":""}function zt(e,t,n){return void 0===n&&(n=0),Ft(e,t,n)}function Ht(e,t,n){return void 0===n&&(n=0),Ft(e,t,n,["n","s","w","e"])}function Ut(e,t,n){return void 0===n&&(n=0),Ft(e,t,n,["n","s"])}function Wt(e,t,n){void 0===n&&(n=0);var i=Ft(e,t,n,[],!0);return["n","s","e","w"].includes(i)?"":i}function Vt(e,t){var n=t.width,i=t.height,r=t.x,o=t.y,a=e.left,s=e.top,l=e.right,c=e.bottom,u=r+n/2,d=o+i/2,p=(a+l)/2,h=(s+c)/2,f=l-a,m=c-s;if(yn(s,c))return s>o&&s<o+i&&(l>r+n?r+n-a>f/2:l-r>f/2);if(yn(a,l))return a>r&&a<r+n&&(c>o+i?o+i-s>m/2:c-o>m/2);var v=Math.min(n,f,n/2+f/2-Math.abs(p-u));if(v>0){var g=Math.min(i,m,i/2+m/2-Math.abs(h-d));if(g>0)return v*g>f*m*.5}return!1}function jt(e,t){return e>t?[t,e]:[e,t]}function Gt(e,t,n,i,r){var o,a,s;void 0===r&&(r={});var l=r.keepRatio,c=void 0!==l&&l,u=r.minSize,d=void 0===u?0:u,p=r.noExtend,h=void 0!==p&&p,f=r.barrier,m=r.extraHeight,v=void 0===m?0:m,g=r.extraWidth,y=void 0===g?0:g,b=e.right-e.left,E=e.bottom-e.top,x=e.left,w=e.top,C=e.right,S=e.bottom;function k(e,t,n,i){if(h)return n?e>t+i?e:t+i:e<t-i?e:t-i;if(0!==i){var r=e-t;Math.abs(r)<i&&(e=t+(r>0?1:-1)*i)}return e}var _={x:n.x-t.x,y:n.y-t.y};e.rotate&&(_=an(_,-e.rotate));var T=_.x,I=_.y,P=Array.isArray(d)?d[0]:d,N=Array.isArray(d)?null!==(s=d[1])&&void 0!==s?s:d[0]:d;if(i.length>0&&(i.indexOf("w")>=0?x=k(x+T,C,!1,P):i.indexOf("e")>=0&&(C=k(C+T,x,!0,P)),i.indexOf("n")>=0?w=k(w+I,S,!1,N):i.indexOf("s")>=0&&(S=k(S+I,w,!0,N))),c&&2==i.length){var M=b-y,A=E-v,D=Math.max(P,M/A*(N-v)+y);i.indexOf("w")>=0?x=k(x,C,!1,D):i.indexOf("e")>=0&&(C=k(C,x,!0,D)),i.indexOf("n")>=0?w=S-A*(C-x-y)/M-v:i.indexOf("s")>=0&&(S=w+A*(C-x-y)/M+v)}if(x=(o=jt(x,C))[0],C=o[1],w=(a=jt(w,S))[0],S=a[1],f&&(x<f.left&&(x=f.left),C>f.right&&(C=f.right),w<f.top&&(w=f.top),S>f.bottom&&(S=f.bottom)),e.rotate){var R={x:(e.right+e.left)/2,y:(e.bottom+e.top)/2},B=an({x:(x+C)/2,y:(w+S)/2},e.rotate,R),L=C-x,O=S-w;x=B.x-L/2,C=B.x+L/2,w=B.y-O/2,S=B.y+O/2}return{left:x,top:w,right:C,bottom:S}}function qt(e,t){return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom}function Kt(e,t){var n=e.left,i=e.top,r=e.right,o=e.bottom,a=t.left,s=t.top,l=t.right,c=t.bottom;return Math.abs(n+r-a-l)<=r-n+l-a&&Math.abs(i+o-s-c)<=o-i+c-s}function Yt(e){for(var t=e[0],n=t.left,i=t.top,r=t.right,o=t.bottom,a=1;a<e.length;a++){var s=e[a],l=s.left,c=s.top,u=s.right,d=s.bottom;n=Math.min(n,l),i=Math.min(i,c),r=Math.max(r,u),o=Math.max(o,d)}return{left:n,top:i,right:r,bottom:o}}function Xt(e,t){var n=e.left,i=e.top,r=e.right,o=e.bottom,a=r-n,s=o-i;return n<t.left&&(n=t.left),i<t.top&&(i=t.top),r>t.right&&(n=(r=t.right)-a),o>t.bottom&&(i=(o=t.bottom)-s),{left:n,top:i,right:r,bottom:o}}function Qt(e,t,n,i){var r=[t.x-e.x,t.y-e.y],o=[n.x-e.x,n.y-e.y],a=[i.x-e.x,i.y-e.y],s=r[0]*o[1]-r[1]*o[0];return s*(o[0]*a[1]-o[1]*a[0])>=0&&s*(a[0]*r[1]-a[1]*r[0])>=0}function Zt(e,t){return fn(e,t.center)<=t.r}function Jt(e,t,n){return void 0===n&&(n=0),!(n<0)&&(0===n?yn(e.x,t.x)&&yn(e.y,t.y):Ot(e,{left:t.x-n,top:t.y-n,right:t.x+n,bottom:t.y+n}))}function $t(e){return Math.atan2(e.y,e.x)}function en(e,t){var n=(e+t)/2;return Math.abs(e-t)>Math.PI&&(n=n>0?n-Math.PI:n+Math.PI),n}function tn(e,t){var n=e.x,i=e.y,r=Math.sqrt(n*n+i*i);return{x:n=r*Math.cos(t),y:i=r*Math.sin(t)}}function nn(e,t){var n=e,i=t.x-n.x,r=t.y-n.y,o=0;return o=0!==i?Math.atan(Math.abs(r/i)):r>0?1.5*Math.PI:.5*Math.PI,i<0&&r<=0?o=Math.PI-o:i<0&&r>=0?o+=Math.PI:i>0&&r>=0&&(o=2*Math.PI-o),rn(o)}function rn(e){return e>=2*Math.PI?e-2*Math.PI:e}function on(e){for(;e<0||e>=2*Math.PI;)e<0?e+=2*Math.PI:e-=2*Math.PI;return e}function an(e,t,n){void 0===n&&(n={x:0,y:0});var i=e.x-n.x,r=e.y-n.y,o=Math.sqrt(i*i+r*r);if(0==o)return{x:n.x,y:n.y};var a=Math.asin(r/o),s=(i>0?a:Math.PI-a)+t*Math.PI/180;return{x:n.x+o*Math.cos(s),y:n.y+o*Math.sin(s)}}function sn(e,t,n,i){var r=void 0,o=void 0,a=void 0;if(0===e)if(0===t)0!==n&&(r=-i/n);else{var s=n*n-4*t*i;s>0?o=-n/t-(r=(-n+Math.sqrt(s))/(2*t)):0===s&&(r=o=-n/(2*t))}else{var l=t*t-3*e*n,c=t*n-9*e*i,u=c*c-4*l*(n*n-3*t*i);if(0==l&&0==c)o=r=-n/t,a=r;else if(u>0){var d=l*t+3*e*(-c+Math.sqrt(u))/2,p=l*t+3*e*(-c-Math.sqrt(u))/2;o=r=(-t-((d=d<0?-Math.pow(Math.abs(d),1/3):Math.pow(Math.abs(d),1/3))+(p=p<0?-Math.pow(Math.abs(p),1/3):Math.pow(Math.abs(p),1/3))))/(3*e),a=r}else if(0==u){var h=c/l;r=-t/e+h,a=o=-h/2}else{var f=(2*l*t-3*e*c)/(2*Math.sqrt(l*l*l)),m=Math.acos(f)/3;r=(-t-2*Math.sqrt(l)*Math.cos(m))/(3*e),o=(-t+Math.sqrt(l)*Math.cos(m)-Math.sqrt(l)*Math.sqrt(3)*Math.sin(m))/(3*e),a=(-t+Math.sqrt(l)*Math.cos(m)+Math.sqrt(l)*Math.sqrt(3)*Math.sin(m))/(3*e)}}return{t1:r,t2:o,t3:a}}function ln(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=n.x-t.x-r,s=n.y-t.y-o,l=e.x-i.x,c=e.y-i.y,u=sn(a*a+s*s,3*(r*a+o*s),2*(r*r+o*o)+(l*a+c*s),l*r+c*o),d=u.t1,p=u.t2,h=u.t3,f=-1,m=-1,v=-1;void 0!==d&&(d>=0&&d<=1&&(f=fn(i,cn(e,t,n,d))),void 0!==p&&p!==d&&p>=0&&p<=1&&(m=fn(i,cn(e,t,n,p))),void 0!==h&&h!==p&&h!==d&&h>=0&&h<=1&&(v=fn(i,cn(e,t,n,h))));var g=[f,m,v,fn(i,e),fn(i,n)].filter((function(e){return e>=0}));return g.sort((function(e,t){return e-t})),g[0]}function cn(e,t,n,i){return{x:(1-i)*(1-i)*e.x+2*(1-i)*i*t.x+i*i*n.x,y:(1-i)*(1-i)*e.y+2*(1-i)*i*t.y+i*i*n.y}}function un(e,t,n,i,r){return{x:e.x*Math.pow(1-r,3)+3*t.x*r*Math.pow(1-r,2)+3*n.x*Math.pow(r,2)*(1-r)+i.x*Math.pow(r,3),y:e.y*Math.pow(1-r,3)+3*t.y*r*Math.pow(1-r,2)+3*n.y*Math.pow(r,2)*(1-r)+i.y*Math.pow(r,3)}}function dn(e,t,n,i,r,o){if(fn(e,r)<=o||fn(i,r)<=o)return!0;function a(r){var a=e,s=t,l=n,c=i;function u(e){return un(a,s,l,c,e)}r&&(a=an(e,r),s=an(t,r),l=an(n,r),c=an(i,r));var d=a.x,p=s.x,h=l.x,f=sn(3*p-d-3*h+c.x,3*d-6*p+3*h,-3*d+3*p,d),m=f.t1,v=f.t2,g=f.t3;if(void 0!==m){if(m>=0&&m<=1){var y=u(m);if(Math.abs(y.y)<=o)return!0}if(void 0!==v&&v!==m&&v>=0&&v<=1&&(y=u(v),Math.abs(y.y)<=o))return!0;if(void 0!==g&&g!==v&&g!==m&&g>=0&&g<=1&&(y=u(g),Math.abs(y.y)<=o))return!0}return!1}return e=xn(e,r),t=xn(t,r),n=xn(n,r),i=xn(i,r),a()||a(90)}!function(e){e[e.TEAMMEMBER=1]="TEAMMEMBER",e[e.GUEST=2]="GUEST",e[e.VISITOR=3]="VISITOR",e[e.RECORD_ASSISTANT=100]="RECORD_ASSISTANT"}(Pt||(Pt={})),function(e){e[e.HOST=1]="HOST",e[e.AUDIENCE=2]="AUDIENCE"}(Nt||(Nt={})),function(e){e[e.TRTC=1]="TRTC",e[e.AGORA=2]="AGORA"}(Mt||(Mt={})),function(e){e[e.TABLE=0]="TABLE",e[e.STICKERS=1]="STICKERS"}(At||(At={}));var pn=function(e,t,n,i,r,o,a,s){void 0===r&&(r=0),void 0===o&&(o=1),void 0===a&&(a=20);for(var l=(o-r)/a,c=-1,u=Number.MAX_SAFE_INTEGER,d=null,p=r;p<=o;p+=l){var h=s?un(t,n,i,s,p):cn(t,n,i,p),f=fn(e,h);f<u&&(d=h,c=p,u=f)}return{point:d,minT:c,distance:u}};function hn(e,t,n,i,r){var o=sn(_t.round(-e.x+3*t.x-3*n.x+i.x,2),_t.round(3*e.x-6*t.x+3*n.x,2),_t.round(-3*e.x+3*t.x,2),_t.round(e.x-r,2)),a=o.t1,s=o.t2,l=o.t3,c=[];return[a,s,l].forEach((function(r){if(void 0!==r&&r>=0&&r<=1){var o=un(e,t,n,i,r).y;c.push(o)}})),c}function fn(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}function mn(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function vn(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function gn(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function yn(e,t,n){void 0===n&&(n=6);var i=Math.pow(10,n);return Math.floor(e*i)/i==Math.floor(t*i)/i}function bn(e,t,n){return void 0===n&&(n=6),yn(e.x,t.x,n)&&yn(e.y,t.y,n)}function En(e,t){return{x:e.x+t.x,y:e.y+t.y}}function xn(e,t){return{x:e.x-t.x,y:e.y-t.y}}function wn(e,t){return{x:e.x*t,y:e.y*t}}function Cn(e){var t=R([],e,!0).sort((function(e,t){return e.x-t.x})),n=R([],e,!0).sort((function(e,t){return e.y-t.y}));return{left:t[0].x,top:n[0].y,right:t[t.length-1].x,bottom:n[n.length-1].y}}function Sn(e,t){if(void 0===t&&(t=0),t%360==0)return e;var n=e.left,i=e.top,r=e.right,o=e.bottom,a=(n+r)/2,s=(i+o)/2,l=an({x:r,y:i},t,{x:a,y:s}),c=an({x:r,y:o},t,{x:a,y:s}),u=Math.max(Math.abs(l.x-a),Math.abs(c.x-a)),d=Math.max(Math.abs(l.y-s),Math.abs(c.y-s));return{left:a-u,right:a+u,top:s-d,bottom:s+d}}function kn(e,t,n){var i=e.left,r=e.top,o=e.right,a=e.bottom,s=[{x:i,y:r},{x:i,y:a},{x:o,y:r},{x:o,y:a}].map((function(e){return an(e,t,n)})),l=s[0],c=l.x,u=l.y;i=c,o=c,r=u,a=u;for(var d=1;d<s.length;d++){var p=s[d],h=p.x,f=p.y;h<i?i=h:h>o&&(o=h),f<r?r=f:f>a&&(a=f)}return{left:i,top:r,right:o,bottom:a}}function _n(e,t,n){var i=nn(n,e),r=nn(n,t),o=Math.round(i/(Math.PI/4)),a=an(t,(2*Math.PI-(o*(Math.PI/4)-r))*(180/Math.PI),n),s=o*Math.PI/4,l=an(e,180*s/Math.PI,a);return{finalRotatePosition:an({x:l.x,y:a.y},-180*s/Math.PI,a),rotateAngle:s}}var Tn,In=function(e,t){var n=0|Math.sqrt(t/e);return{height:n,width:n*e|0}};function Pn(e,t,n,i,r){var o=n.x,a=n.y,s=i.x,l=i.y,c=r.x,u=r.y,d=e.x,p=e.y,h=t.x,f=t.y,m=f-p,v=h-d,g=(o-2*s+c)*m-(a-2*l+u)*v,y=2*(s-o)*m-2*(l-a)*v,b=(o-d)*m-(a-p)*v;function E(e){if(e<0||e>1)return Tn.noCross;function t(e,t,n){return Math.abs(2*n-e-t)<=Math.abs(e-t)}var o=cn(n,i,r,e),a=o.x,s=o.y;return d===h&&t(p,f,s)||d!==h&&t(d,h,a)?Tn.cross:Tn.crossAtExtended}if(0==g){if(0==y){if(0!==b)return Tn.noCross;var x=function(e,t,n,i){return Math.abs(e+t-n-i)<=Math.abs(e-t)+Math.abs(i-n)};return d===h&&x(p,f,a,u)||d!==h&&x(d,h,o,c)?Tn.cross:Tn.crossAtExtended}return E(-b/y)}var w=y*y-4*g*b;if(w<0)return Tn.noCross;for(var C=(-y+(w=Math.sqrt(w)))/(2*g),S=(-y-w)/(2*g),k=Tn.noCross,_=0,T=[C,S];_<T.length;_++){var I=E(T[_]);switch(I){case Tn.cross:return I;case Tn.crossAtExtended:k=I}}return k}!function(e){e[e.cross=0]="cross",e[e.crossAtExtended=1]="crossAtExtended",e[e.noCross=2]="noCross"}(Tn||(Tn={}));var Nn=function(e,t,n){var i=0,r=0,o=t.left,a=t.right,s=t.top,l=t.bottom;switch(e){case bt.LEFT:i=o-n.left;break;case bt.TOP:r=s-n.top;break;case bt.RIGHT:i=a-n.right;break;case bt.BOTTOM:r=l-n.bottom;break;case bt.HORIZONTAL:r=(l+s-n.bottom-n.top)/2;break;case bt.VERTICAL:i=(a+o-n.right-n.left)/2}return{deltaX:i,deltaY:r}},Mn=function(e,t,n){return Math.min(Math.max(t,e),n)},An=function(e,t,n,i,r){void 0===r&&(r=20);for(var o=1/r,a=Math.min(e.x,i.x),s=Math.max(e.x,i.x),l=Math.min(e.y,i.y),c=Math.max(e.y,i.y),u=i.x-3*n.x+3*t.x-e.x,d=3*n.x-6*t.x+3*e.x,p=3*t.x-3*e.x,h=i.y-3*n.y+3*t.y-e.y,f=3*n.y-6*t.y+3*e.y,m=3*t.y-3*e.y,v=1;v<r;v++){var g=v*o,y=u*g*g*g+d*g*g+p*g+e.x,b=h*g*g*g+f*g*g+m*g+e.y;a=Math.min(a,y),l=Math.min(l,b),s=Math.max(s,y),c=Math.max(c,b)}return{left:a,right:s,top:l,bottom:c}},Dn=function(e,t,n){return e(t*Math.pow(10,n))/Math.pow(10,n)};function Rn(e,t,n){return e+(t-e)*n}function Bn(e,t,n){if(yn(e.x,t.x)){var i=e.y<=t.y?e:t,r=e.y<=t.y?t:e;return n.y>i.y==n.y>r.y?{x:e.x,y:n.y>r.y?r.y:i.y}:{x:e.x,y:n.y}}if(yn(e.y,t.y)){var o=e.x<=t.x?e:t,a=e.x<=t.x?t:e;return n.x>o.x==n.x>a.x?{x:n.x>a.x?a.x:o.x,y:e.y}:{x:n.x,y:e.y}}var s=e.x<=t.x?e:t,l=e.x<=t.x?t:e,c=(l.y-s.y)/(l.x-s.x),u=s.y-c*s.x,d=(n.x+c*(n.y-u))/(1+c*c),p=c*d+u;return d>s.x==d>l.x?d>s.x?exports.E({},l):exports.E({},s):{x:d,y:p}}function Ln(e,t){return Kt(e,t)?{left:Math.max(e.left,t.left),top:Math.max(e.top,t.top),right:Math.min(e.right,t.right),bottom:Math.min(e.bottom,t.bottom)}:null}function On(e,t,n,i,r){void 0===r&&(r=20);for(var o=function(r){var o=un(e,t,n,i,r),a=o.x,s=o.y,l=un(e,t,n,i,r+.01);return fn({x:a,y:s},{x:l.x,y:l.y})},a=0,s=0;s<r;s++)a+=o(s/r);return a}function Fn(e,t){var n=e.p1,i=e.p2,r=t.p1,o=t.p2,a=n.x,s=n.y,l=i.x,c=i.y,u=r.x,d=r.y,p=o.x,h=o.y,f=c-s,m=a-l,v=l*s-a*c,g=h-d,y=u-p,b=p*d-u*h,E=f*y-g*m;return 0===E?null:{x:(m*b-y*v)/E,y:(g*v-f*b)/E}}function zn(e,t,n){var i=t.x,r=t.y,o=n.x,a=n.y;return(a-r)*e.x+(i-o)*e.y+(o*r-i*a)>0?"left":"right"}function Hn(e,t,n,i,r){if(Xn(t,i,r,e)){var o=Yn(t,e);return{x:t.x+n*Math.cos(o),y:t.y+n*Math.sin(o)}}return fn(e,i)<fn(e,r)?i:r}function Un(e,t,n){return void 0===n&&(n=2),Math.abs(e-t)<=Math.pow(10,-n)}function Wn(e,t,n,i,r){var o=Vn(e,t,n,i);if(!o)return[];var a=Bn(e,t,o),s=Bn(n,t,o),l=[],c=e.x<a.x?e:a,u=e.x<a.x?a:e;r>=c.x&&r<=u.x&&l.push(Rn(c.y,u.y,(r-c.x)/(u.x-c.x)));var d=function(e,t,n){if(n<e.x-t||n>e.x+t)return[];var i=e.x,r=e.y,o=Math.sqrt(Math.pow(t,2)-Math.pow(n-i,2));return[r+o,r-o]}(o,i,r);return d.forEach((function(e){!l.includes(e)&&Xn(o,a,s,{x:r,y:e})&&l.push(e)})),l}function Vn(e,t,n,i){var r=jn(e,t,i),o=r[0],a=r[1],s=Gn(n,o)<Gn(n,a)?o:a,l=jn(n,t,i),c=l[0],u=l[1];return qn(s,Gn(e,c)<Gn(e,u)?c:u)}function jn(e,t,n){var i=function(e,t){var n=t.x-e.x,i=t.y-e.y;return{a:i,b:-n,c:n*e.y-i*e.x}}(e,t),r=i.a,o=i.b,a=i.c,s=Math.abs(n*Math.sqrt(r*r+o*o));return[{a:r,b:o,c:a+s},{a:r,b:o,c:a-s}]}function Gn(e,t){var n=t.a,i=t.b,r=t.c;return Math.abs(n*e.x+i*e.y+r)/Math.sqrt(n*n+i*i)}function qn(e,t){var n=e.a,i=e.b,r=e.c,o=t.a,a=t.b,s=t.c,l=n*a-o*i;return 0===l?null:{x:(i*s-a*r)/l,y:(o*r-n*s)/l}}function Kn(e,t,n,i){var r=jn(e,t,i),o=r[0],a=r[1],s=Gn(n,o)<Gn(n,a)?o:a,l=jn(n,t,i),c=l[0],u=l[1],d=qn(s,Gn(e,c)<Gn(e,u)?c:u);return d?Bn(n,t,d):null}function Yn(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.atan2(i,n)}function Xn(e,t,n,i){var r=Yn(e,i),o=Yn(e,t),a=Yn(e,n);return o<-Math.PI&&(o+=2*Math.PI),a<-Math.PI&&(a+=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI),o<=a?r>=o&&r<=a:r>=o||r<=a}function Qn(e,t,n){var i=t.x,r=t.y,o=t.width,a=t.height;return!(!Ot(e,{left:i,top:r+n,right:i+o,bottom:r+a-n})&&!Ot(e,{left:i+n,top:r,right:i+o-n,bottom:r+a}))||(e.x<=i+n&&e.y<=r+n?fn(e,{x:i+n,y:r+n})<=n:e.x>=i+o-n&&e.y<=r+n?fn(e,{x:i+o-n,y:r+n})<=n:e.x>=i+o-n&&e.y>=r+a-n?fn(e,{x:i+o-n,y:r+a-n})<=n:e.x<=i+n&&e.y>=r+a-n&&fn(e,{x:i+n,y:r+a-n})<=n)}function Zn(e,t){var n=t.x,i=t.y,r=t.width/2,o=t.height/2,a=n+r,s=i+o;return Math.pow(e.x-a,2)/Math.pow(r,2)+Math.pow(e.y-s,2)/Math.pow(o,2)<=1}function Jn(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function $n(e){var t=e.a,n=e.b,i=e.c,r=e.d,o=e.tx,a=e.ty;return"matrix(".concat(t," ").concat(n," ").concat(i," ").concat(r," ").concat(o," ").concat(a,")")}function ei(e){void 0===e&&(e=[]);for(var t=Jn("style"),n="\n    * {\n        text-rendering: geometricprecision !important;\n    }",i=0,r=e;i<r.length;i++){var o=r[i];n+='\n        @font-face {\n            font-family: "'.concat(o.name,'";\n            src: url(').concat(o.url,");\n        }")}return t.innerHTML=n,t}var ti=0;function ni(){return"clipPath_"+ti++}function ii(){return"image_"+ti++}function ri(e,t,n){"string"!=typeof n&&(n=""+n),e.setAttribute(t,n)}function oi(e,t){for(var n in t)ri(e,n,t[n])}function ai(e,t){e.setAttribute("clip-path","url(#".concat(t.id,")"))}function si(e,t,n,i){var r=$t(xn(e,t)),o=$t(xn(n,t)),a=function(e,t){var n=Math.abs(e-t);return n>Math.PI&&(n=2*Math.PI-n),n}(r,o),s=i/Math.sin(a/2)*Math.cos(a/2),l={x:t.x+Math.cos(r)*s,y:t.y+Math.sin(r)*s},c={x:t.x+Math.cos(o)*s,y:t.y+Math.sin(o)*s},u=o-r;return u<0&&(u+=2*Math.PI),{start:l,end:c,antiClock:u<Math.PI}}var li=function(){function e(){this.pathDatas=[],this.startPos={x:0,y:0}}return e.prototype.reset=function(){this.strokeStyle=void 0,this.fillStyle=void 0,this.currentCmdData=void 0},e.prototype.addPathData=function(e,t){void 0===t&&(t=!0);var n={path:e,closed:t};this.strokeStyle&&(n.stroke=exports.E({},this.strokeStyle)),t&&this.fillStyle&&(n.fill=this.fillStyle),this.pathDatas.push(n)},e.prototype.createCmdData=function(){var e={pathCmd:["M ".concat(this.startPos.x,",").concat(this.startPos.y)],closed:!1};return this.strokeStyle&&(e.stroke=exports.E({},this.strokeStyle)),e},e.prototype.getCurrentCmdData=function(){return this.currentCmdData||(this.currentCmdData=this.createCmdData(),this.pathDatas.push(this.currentCmdData)),this.currentCmdData},e.prototype.moveTo=function(e,t){this.currentCmdData?this.currentCmdData.pathCmd.push("M ".concat(e,",").concat(t)):this.startPos={x:e,y:t}},e.prototype.lineStyle=function(e,t,n){if("number"==typeof e){var i={width:e};void 0!==t&&(i.color=t),void 0!==n&&(i.alpha=n),this.strokeStyle=exports.E(exports.E({},this.strokeStyle),i)}else this.strokeStyle=e||void 0},e.prototype.drawCircle=function(e,t,n){this.currentCmdData=void 0;var i=Jn("circle");oi(i,{cx:e,cy:t,r:n}),this.addPathData(i)},e.prototype.arc=function(e,t,n,i,r,o){this.currentCmdData=void 0;var a,s={x:e+Math.cos(i)*n,y:t+Math.sin(i)*n},l={x:e+Math.cos(r)*n,y:t+Math.sin(r)*n};if(o){for(;i<r;)i+=2*Math.PI;a=i-r>Math.PI}else{for(;r<i;)r+=2*Math.PI;a=r-i>Math.PI}this.startPos=s,this.getCurrentCmdData().pathCmd.push("A ".concat(n," ").concat(n," 0 ").concat(a?1:0," ").concat(o?0:1," ").concat(l.x,",").concat(l.y)),this.startPos=l},e.prototype.arcTo=function(e,t,n,i,r){var o=this.getCurrentCmdData(),a=si(this.startPos,{x:e,y:t},{x:n,y:i},r),s=a.start,l=a.end,c=a.antiClock;o.pathCmd.push("L ".concat(s.x,",").concat(s.y),"A ".concat(r," ").concat(r," 0 0 ").concat(c?0:1," ").concat(l.x,",").concat(l.y),"L ".concat(l.x,",").concat(l.y)),this.startPos=l},e.prototype.drawPolygon=function(e){this.currentCmdData=void 0},e.prototype.drawRoundedRect=function(e,t,n,i,r){var o=Jn("rect"),a=Math.min(n,i)/2|0;oi(o,{x:e,y:t,width:n,height:i,rx:r=r>a&&a||r,ry:r}),this.addPathData(o)},e.prototype.drawEllipse=function(e,t,n,i){this.currentCmdData=void 0;var r=Jn("ellipse");oi(r,{cx:e+n/2,cy:t+i/2,rx:n/2,ry:i/2}),this.addPathData(r)},e.prototype.quadraticCurveTo=function(e,t,n,i){this.getCurrentCmdData().pathCmd.push("Q ".concat(e,",").concat(t," ").concat(n,",").concat(i)),this.startPos={x:n,y:i}},e.prototype.bezierCurveTo=function(e,t,n,i,r,o){this.getCurrentCmdData().pathCmd.push("C ".concat(e,",").concat(t," ").concat(n,",").concat(i," ").concat(r,",").concat(o)),this.startPos={x:r,y:o}},e.prototype.closePath=function(){var e=this.currentCmdData;e&&(e.pathCmd.push("Z"),e.closed=!0,this.fillStyle&&(e.fill=this.fillStyle))},e.prototype.lineTo=function(e,t){this.getCurrentCmdData().pathCmd.push("L ".concat(e,",").concat(t)),this.startPos={x:e,y:t}},e.prototype.beginFill=function(e,t){void 0===t&&(t=1),this.fillStyle={color:e,alpha:t}},e.prototype.drawRect=function(e,t,n,i){this.currentCmdData=void 0;var r=Jn("rect");oi(r,{x:e,y:t,width:n,height:i}),this.addPathData(r)},e.prototype.clear=function(){this.pathDatas=[],this.currentCmdData=void 0},e.prototype.endFill=function(){this.fillStyle=void 0},e}(),ci=[776,2359,2359,2367,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520];function ui(e,t){var n=t[e];if(!function(e){return e&&gi(e[0].charCodeAt(0),55296,56319)||!1}(n)||e===t.length-1)return 1;var i=n+t[e+1],r=t.substring(e+2,e+5);return di(i)&&di(r)||function(e){return gi(vi(e),127995,127999)}(r)?4:2}function di(e){return gi(vi(e),127462,127487)}function pi(e){return"string"==typeof e&&gi(e.charCodeAt(0),65024,65039)}function hi(e){return"string"==typeof e&&gi(e.charCodeAt(0),8400,8447)}function fi(e){return"string"==typeof e&&-1!==ci.indexOf(e.charCodeAt(0))}function mi(e){return"string"==typeof e&&8205===e.charCodeAt(0)}function vi(e){return(e.charCodeAt(0)-55296<<10)+(e.charCodeAt(1)-56320)+65536}function gi(e,t,n){return e>=t&&e<=n}var yi=function(e){for(var t=[],n=0,i=0;n<e.length;)fi(e[n+(i+=ui(n+i,e))])&&i++,pi(e[n+i])?hi(e[n+ ++i])&&i++:hi(e[n+i])&&pi(e[n+ ++i])&&i++,mi(e[n+i])?i++:(t.push(e.slice(n,n+i)),n+=i,i=0);return t};function bi(e){return e.join("")}function Ei(e,t,n){return e.slice(t,n).join("")}var xi=new RegExp("".concat(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source,"|").concat(/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source,"|").concat(/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source,"|").concat(/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source)),wi=new RegExp("".concat(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source,"|").concat(/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source,"|").concat(/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source,"|").concat(/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source)),Ci=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];function Si(e){return Ci.indexOf(e.charCodeAt(0))>=0}var ki=[10,13];function _i(e){return ki.indexOf(e.charCodeAt(0))>=0}var Ti=function(e,t){return!Si(t)&&!(!e||!wi.exec(t)&&!xi.exec(e))};function Ii(e,t){var n=R([],e,!0),i=n[n.length-1];if(!i)return e;var r=i[i.length-1];return n[n.length-1]=i.slice(0,-1),t.unshift(r),n}var Pi=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,Ni=function(e){return!e||!Pi.test(e)};function Mi(e,t){var n=R([],e,!0),i=n[n.length-1],r=Ai(i);if(-1===r||!i)return n;var o=r+1;n[n.length-1]=i.slice(0,o);for(var a=i.length-1;a>=o;a--)t.unshift(i[a]);return n}var Ai=function(e){for(var t=e.length-1;t>=0;t--)if(!Pi.test(e[t]))return t;return-1};function Di(e,t){return Math.abs(e-t)<=.1}function Ri(e,t){return e-t>.1}function Bi(e,t){return Ri(t,e)}var Li=new Map,Oi=/[a-zA-Z0-9,.:;  ]/;function Fi(e,t,n){var i=ut({fontSize:t,fontFamily:n}),r="".concat(e,"-").concat(i);if(!Li.has(r)){st.save(),st.font=i;var o=st.measureText(e).width;st.restore(),Li.set(r,o)}return Li.get(r)}function zi(e,t,n,i){for(var r=0,o=0,a=0;a<e.length;a++)if(r++,(o+=Oi.test(e[a])&&Fi(e[a],n,i)||n)>t)return r-1;return e.length}function Hi(e,t,n,i,r){function o(e,t,n){return Array.isArray(e)?e.slice(t,n).join(""):e.substring(t,n)}var a=zi(e,n,t,r);if(0===a&&(a+=1),-1===a)return-1;a>e.length&&(a=e.length);for(var s=t/14,l=o(e,0,a),c=i.measureText(l).width*s,u=void 0;void 0===u;)Di(c,n)?u=a<e.length?a:-1:c>n?a<=1?u=1:(l=o(e,0,--a),Bi(c=i.measureText(l).width*s,n)&&(u=a)):c<n&&(a<e.length?(l=o(e,0,++a),Ri(c=i.measureText(l).width*s,n)&&(u=a-1)):u=-1);return u}function Ui(e){var t=[[]],n=0;return e.forEach((function(e){if(_i(e))return n++,void(t[n]=[]);t[n].push(e)})),t}function Wi(e,t,n){"number"==typeof n&&(n={wordWrapWidth:n});var i=n||{},r=i.wordWrapWidth,o=i.lineClamp,a=i.textOverflow,s=i.simple,l=at,c=ut(t),u=ut(exports.E(exports.E({},t),{fontSize:14})),d=ct(t.fontSize,t.fontFamily);0===d.height&&(d.height=t.fontSize,d.ascent=d.height);var p=l.getContext("2d");p.font=u;var h=r?function(e,t,n,i){var r=n.wordWrapWidth,o=n.lineClamp,a=n.textOverflow,s=n.simple,l=t.fontSize;function c(e){return Hi(e,l,r,i,t.fontFamily)}for(var u=[],d=0,p=0,h=Ui(e);p<h.length;p++){var f=h[p];if(f.length<=1){if(u[d]=R([],f,!0),++d===o)break}else{for(var m=!1,v=c(f);v>=1&&v<f.length;){var g=f[v],y=f[v+1],b=f.slice(0,v);if(f=f.slice(v),u[d]=R([],b,!0),d++,s||Si(g)||(Ni(g)?1!==v&&void 0!==y&&Ti(g,y)&&(u=Ii(u,f)):u=Mi(u,f)),d===o){m=!0;var E=u.length>o;if(E&&(u.length=o),"ellipse"===a){var x=u[o-1];E?x.push(".",".","."):x.splice(x.length-1,1,".",".",".")}break}v=c(f)}if(m)break;if(u[d]=R([],f,!0),++d===o)break}}return u}(e,t,{wordWrapWidth:r,lineClamp:o,textOverflow:a,simple:s},p):Ui(e);p.font=c;for(var f=new Array(h.length),m=0,v=t.strokeThickness,g=void 0===v?0:v,y=t.letterSpacing,b=void 0===y?0:y,E=0;E<h.length;E++){var x=bi(h[E]),w=p.measureText(x).width+(h[E].length-1)*b;f[E]=w,m=Math.max(m,w)}var C=m+g;t.dropShadow&&(C+=t.dropShadowDistance||5);var S=t.lineHeight||d.height+g,k=S*h.length;return t.dropShadow&&(k+=t.dropShadowDistance||5),{style:t,width:Dn(Math.ceil,C,2),height:k,lines:h,lineWidths:f,lineHeight:S,maxLineWidth:m,fontProperties:d}}function Vi(e){return st.measureText(e).width}function ji(e,t){var n=ut(t);return st.font=n,st.measureText(e).width}var Gi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dirty=!0,t.fill="black",t.x=0,t.y=0,t.lineHeight=20,t}return P(t,e),t.prototype.paint=function(e){if(!this.hide){var t=e.context,n=e.alpha;e.currentPainter.setTransform(e),t.globalAlpha=n;var i=this._metrics;if(this._dirty||!i){var r=yi(this.text),o=this.textWidth,a=this.lineClamp,s=this.textOverflow;i=Wi(r,this,o?{wordWrapWidth:o,lineClamp:a,textOverflow:s}:void 0),this._metrics=i,this._dirty=!1}var l=ut(this);t.font=l;var c=this,u=c.x,d=c.y,p=c.fill,h=c.underLine,f=c.deleteLine,m=c.fontSize,v=i.lines,g=i.fontProperties,y=i.lineWidths,b=this,E=b.textWidth,x=void 0===E?0:E,w=b.textHeight,C=void 0===w?0:w,S=b.lineHeight,k=b.va,_=void 0===k?"top":k,T=b.ha,I=void 0===T?"left":T,P=(S-g.height)/2+g.ascent,N=v.length*S,M=0;"top"!==_&&(0===C||C>N)&&(M=C-N,"middle"===_&&(M/=2)),t.fillStyle=p;for(var A=0;A<v.length;A++){var D=0;"left"!==I&&(D=x-y[A],"center"===I&&(D/=2));var R=bi(v[A]),B=u+D,L=A*S+d+M;if(t.fillText(R,B,L+P),h||f){var O=m/15;t.strokeStyle=p,t.lineWidth=O,h&&(t.beginPath(),t.moveTo(B,L+P+1.5*O),t.lineTo(B+y[A],L+P+1.5*O),t.stroke()),f&&(t.beginPath(),t.moveTo(B,L+.5*S+1.5*O),t.lineTo(B+y[A],L+.5*S+1.5*O),t.stroke())}}}},t.prototype.paintSvg=function(e){if(!this.hide){var t=e.currentRoot;e.alpha,e.currentPainter;var n=this._metrics;!this._dirty&&n||(n=Wi(yi(this.text),this,this.textWidth),this._metrics=n,this._dirty=!1);var i=this,r=i.fontFamily,o=void 0===r?"Arial":r,a=i.fontStyle,s=i.fontWeight,l=this,c=l.x,u=l.y,d=l.fill,p=l.underLine,h=l.deleteLine,f=l.fontSize,m=n.lines,v=n.fontProperties,g=n.lineWidths,y=this,b=y.textWidth,E=void 0===b?0:b,x=y.textHeight,w=void 0===x?0:x,C=y.lineHeight,S=y.va,k=void 0===S?"top":S,_=y.ha,T=void 0===_?"left":_,I=(C-v.height)/2+v.ascent,P=m.length*C,N=0;"top"!==k&&(0===w||w>P)&&(N=w-P,"middle"===k&&(N/=2));for(var M=0;M<m.length;M++){var A=0;"left"!==T&&(A=E-g[M],"center"===T&&(A/=2));var D=bi(m[M]),R=c+A,B=M*C+u+N,L=Jn("text");L.appendChild(document.createTextNode(D)),oi(L,{x:R,y:B+I,"font-family":o,"font-size":f,fill:d}),a&&ri(L,"font-style",a),s&&ri(L,"font-weight",s);var O="";p&&(O+="underline"),h&&(O&&(O+=" "),O+="line-through"),O&&ri(L,"text-decoration",O),t.appendChild(L)}}},t}(pt(ht,{fontFamily:void 0,fontSize:14,textWidth:void 0,text:"",lineClamp:void 0,textOverflow:void 0},(function(){this._dirty=!0}))),qi=document.createElement("img"),Ki=[],Yi=function(){function e(e,t){void 0===t&&(t={}),this.loaded=!1,this.loading=!1,this.errorCount=0,this.originWidth=0,this.originHeight=0,this.refs=[],this.imgSrc="","string"==typeof e?(this.imgSrc=e,this.content=qi,this.loaded=!1,t.saveInCanvas&&(this.saveInCanvas=!0)):(this.content=e,e instanceof HTMLImageElement?(this.originWidth=e.naturalWidth,this.originHeight=e.naturalHeight):e instanceof HTMLCanvasElement?(this.originWidth=e.width,this.originHeight=e.height):e instanceof HTMLVideoElement?(this.originWidth=e.videoWidth,this.originHeight=e.videoHeight):e instanceof ImageBitmap&&(this.originWidth=e.width,this.originHeight=e.height),this.loaded=!0)}return e.prototype.ref=function(e){this.refs.indexOf(e)<0&&this.refs.push(e),this.releaseTime=void 0},e.prototype.unref=function(e){this.refs=this.refs.filter((function(t){return t!==e})),0===this.refs.length&&this.cacheId&&(Xi[this.cacheId]?this.releaseTime=Date.now():this.release())},e.prototype.release=function(){var e;this.content instanceof HTMLImageElement&&""!==this.content.src&&(e=this.content,Ki.length<1e4&&(e.src="",Ki.push(e)))},e.prototype.load=function(e){var t,n=this;if(this.loaded||this.loading)setTimeout((function(){return null==e||e(),n.onLoaded()}));else{var i=((t=Ki.pop())||(t=document.createElement("img")),t);this.content=i,this.loading=!0;var r=function(){i.removeEventListener("load",o),i.removeEventListener("error",a)},o=function(){if(r(),n.originWidth=i.naturalWidth,n.originHeight=i.naturalHeight,n.saveInCanvas){var t=document.createElement("canvas");t.style.display="none",n.originWidth>4096&&(n.originHeight*=4096/n.originWidth,n.originWidth=4096),n.originHeight>4096&&(n.originWidth*=4096/n.originHeight,n.originHeight=4096),t.width=n.originWidth,t.height=n.originHeight,t.getContext("2d").drawImage(i,0,0,n.originWidth,n.originHeight),n.content=t}n.onLoaded(),null==e||e()},a=function(t){r(),n.onError(t.error),null==e||e()};i.addEventListener("load",o),i.addEventListener("error",a),i.crossOrigin="",i.src=this.imgSrc}},e.prototype.onLoaded=function(){var e=this;this.loading=!1,this.loaded=!0,this.refs.forEach((function(t){var n;return null===(n=t.onSourceLoaded)||void 0===n?void 0:n.call(t,e)}))},e.prototype.onError=function(e){var t=this;this.loading=!1,this.loaded=!1,this.errorCount++,this.refs.forEach((function(n){var i;return null===(i=n.onSourceError)||void 0===i?void 0:i.call(n,t,e)}))},e.prototype.copyImgSource=function(e){e.loaded&&(this.imgSrc=e.imgSrc,this.content=e.content,this.originWidth=e.originWidth,this.originHeight=e.originHeight,this.onLoaded())},e}(),Xi={},Qi=[],Zi=[],Ji=100;function $i(e){if(Qi=Qi.filter((function(t){return t!==e})),Qi.length<Ji&&Zi.length){var t=Zi.shift();Qi.push(t),t.load((function(){return $i(t)}))}}function er(e,t){var n=e;if(t){if(n.loaded)return void t();var i={onSourceLoaded:function(){n.unref(i),t()}};n.ref(i)}n.loaded||n.loading||!n.imgSrc||Zi.includes(n)||Qi.includes(n)||(Qi.length>=Ji?Zi.push(n):(Qi.push(n),n.load((function(){return $i(n)}))))}function tr(e,t){void 0===t&&(t="");var n=void 0;return t&&(n=Xi[t]),n||(n=new Yi(e),t&&(Xi[t]=n,n.cacheId=t)),n}function nr(e,t){var n={onSourceLoaded:function(){e.unref(n),t()}};e.ref(n)}function ir(e){return e.loaded?Promise.resolve():(er(e),new Promise((function(t){nr(e,t)})))}var rr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.x=0,t.y=0,t.width=1,t.height=1,t._src="",t}return P(t,e),Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){var t,n=this;e!==this._src&&(this._src=e,""!==e?(this.source&&(this.source.loaded?this.preSource=this.source:this.source.unref(this)),t="string"==typeof e?tr(e,this.cache?e:void 0):e,this.source=t,t.ref(this),t.loaded?setTimeout((function(){return n.source===t&&n.onSourceLoaded(t)}),0):er(this.source)):(this.source&&(this.source.unref(this),this.source=void 0),this.preSource&&(this.preSource.unref(this),this.preSource=void 0)))},enumerable:!1,configurable:!0}),t.prototype.paint=function(e){var t;if(!this.hide){var n=(null===(t=this.source)||void 0===t?void 0:t.loaded)?this.source:this.preSource,i=e.context,r=e.alpha,o=e.currentPainter,a=this,s=a.x,l=a.y,c=a.width,u=a.height,d=a.clipRect;if(!n)return this.backgroundColor?(i.globalAlpha=r,i.fillStyle=this.backgroundColor,i.fillRect(s,l,c,u),void(e.drawImageCount=0)):void 0;o.setTransform(e),i.globalAlpha=r;var p=n.originWidth,h=n.originHeight,f=n.content;if(++e.drawImageCount>20&&(i.fillRect(s,l,.01,.01),e.drawImageCount=1),d){var m=d.x*p,v=d.y*h,g=d.width*p,y=d.height*h;i.drawImage(f,m,v,g,y,s,l,c,u)}else i.drawImage(f,s,l,c,u)}},t.prototype.paintSvg=function(e){var t;if(!this.hide){var n=(null===(t=this.source)||void 0===t?void 0:t.imgSrc)?this.source:this.preSource;if(n&&n.imgSrc){var i=n.imgSrc,r=e.imageCache,o=e.currentRoot,a=e.def,s=this,l=s.x,c=s.y,u=s.width,d=s.height,p=this.clipRect,h=r[i];if(!h){h=ii();var f=Jn("image");f.setAttribute("crossorigin",""),f.setAttribute("href",i),f.setAttribute("preserveAspectRatio","none"),oi(f,{width:1,height:1}),f.id=h,r[i]=h,a.appendChild(f)}var m=Jn("use");m.setAttribute("href","#"+h);var v=o;if(this.link){var g=Jn("a");oi(g,{href:this.link,target:"_blank"}),v.appendChild(g),v=g}if(p){var y=Jn("g"),b=Jn("rect");oi(b,{x:l,y:c,width:u,height:d});var E=Jn("clipPath");E.id=ni(),E.appendChild(b),v.appendChild(E),ai(y,E),u/=p.width,d/=p.height,l-=u*p.x,c-=d*p.y,v.appendChild(y),y.appendChild(m)}else v.appendChild(m);oi(m,{x:l/u,y:c/d,transform:"scale(".concat(u,", ").concat(d,")")})}}},t.prototype.onSourceLoaded=function(e){var t;this.preSource&&(this.preSource.unref(this),this.preSource=void 0),null===(t=this.onLoad)||void 0===t||t.call(this,e)},t.prototype.onSourceError=function(e,t){var n;null===(n=this.onError)||void 0===n||n.call(this,e,t)},t.prototype.destroy=function(){this.src=""},t}(ht),or=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftWidth=0,t.rightWidth=0,t.topHeight=0,t.bottomHeight=0,t.borderClip={left:0,top:0,right:0,bottom:0},t}return P(t,e),t.prototype.paint=function(e){var t=this.source;if(null==t?void 0:t.loaded){var n=e.context,i=e.alpha;e.currentPainter.setTransform(e),n.globalAlpha=i;var r=t.originHeight,o=t.originWidth,a=this,s=a.x,l=a.y,c=a.width,u=a.height,d=a.borderClip,p=d.left,h=d.top,f=d.right,m=d.bottom,v=a.leftWidth,g=a.rightWidth,y=a.topHeight,b=a.bottomHeight,E=[p,o-f-p,f],x=[h,r-m-h,m],w=[v,c-v-g,g],C=[y,u-y-b,b],S=0,k=s,_=t.content;e.drawImageCount+8>20&&(n.fillRect(s,l,.01,.01),e.drawImageCount=8);for(var T=0;T<3;T++){for(var I=0,P=l,N=0;N<3;N++)1===T&&1===N||n.drawImage(_,S,I,E[T],x[N],k,P,w[T],C[N]),I+=x[N],P+=C[N];S+=E[T],k+=w[T]}}},t.prototype.paintSvg=function(){},t}(rr),ar=function(){function e(e){this._a=1,this._b=0,this._c=0,this._d=1,this._tx=0,this._ty=0,this.scale=1,this.rotateRadius=0,e&&this.update(e.x||0,e.y||0,e.scaleX||1,e.scaleY||1,e.pivotX||0,e.pivotY||0,(e.rotation||0)*Math.PI/180)}return Object.defineProperty(e.prototype,"a",{get:function(){return this._a},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._b},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c",{get:function(){return this._c},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"d",{get:function(){return this._d},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tx",{get:function(){return this._tx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ty",{get:function(){return this._ty},enumerable:!1,configurable:!0}),e.prototype.updateScaleRotate=function(){if(0===this.a&&0===this.b)return this.scale=0,void(this.rotateRadius=0);if(this.rotateRadius=Math.atan2(this.b,this.a),0===this.rotateRadius)this.scale=this.a;else{var e=Math.sin(this.rotateRadius);if(0!==e)this.scale=this.b/e;else{var t=Math.cos(this.rotateRadius);this.scale=this.a/t}}},e.prototype.setValue=function(e,t,n,i,r,o){this._a=e,this._b=t,this._c=n,this._d=i,this._tx=r,this._ty=o,this.updateScaleRotate()},e.prototype.update=function(e,t,n,i,r,o,a){var s=Math.cos(a),l=Math.sin(a);1===s?(this._a=n,this._b=0,this._c=0,this._d=i,this._tx=e-r*n,this._ty=t-o*i):(this._a=s*n,this._b=l*n,this._c=-l*i,this._d=s*i,this._tx=e-this.a*r-this.c*o,this._ty=t-this.b*r-this.d*o),this.scale=n,this.rotateRadius=a},Object.defineProperty(e.prototype,"currentScale",{get:function(){return this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotateDeg",{get:function(){var e=this.rotateRadius/Math.PI*180;return e<0&&(e+=360),e},enumerable:!1,configurable:!0}),e.prototype.apply=function(e){var t=e.x,n=e.y;return{x:this.a*t+this.c*n+this.tx,y:this.b*t+this.d*n+this.ty}},e.prototype.applyInverse=function(e){var t=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return{x:this.d*t*n+-this.c*t*i+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*i+-this.b*t*n+(-this.ty*this.a+this.tx*this.b)*t}},e.prototype.applyVector=function(e){var t=e.x,n=e.y;return{x:this.a*t+this.c*n,y:this.b*t+this.d*n}},e.prototype.applyVectorInverse=function(e){var t=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return{x:this.d*t*n+-this.c*t*i,y:this.a*t*i+-this.b*t*n}},e.prototype.applyBorderBox=function(e){var t=e.left,n=e.top,i=e.right,r=e.bottom,o=e.rotate,a=void 0===o?0:o,s=i-t,l=r-n,c=t+s/2,u=n+l/2,d=this.apply({x:c,y:u}),p=d.x,h=d.y;return t=p-(s*=this.scale)/2,i=p+s/2,n=h-(l*=this.scale)/2,r=h+l/2,(a+=this.rotateDeg)<0?a+=360:a%=360,{left:t,top:n,right:i,bottom:r,rotate:a}},e.prototype.applyBorderBoxInverse=function(e){var t=e.left,n=e.top,i=e.right,r=e.bottom,o=e.rotate,a=void 0===o?0:o,s=i-t,l=r-n,c=t+s/2,u=n+l/2,d=this.applyInverse({x:c,y:u}),p=d.x,h=d.y;return t=p-(s/=this.scale)/2,i=p+s/2,n=h-(l/=this.scale)/2,r=h+l/2,(a-=this.rotateDeg)<0?a+=360:a%=360,{left:t,top:n,right:i,bottom:r,rotate:a}},e.prototype.append=function(t){var n=this.a,i=this.b,r=this.c,o=this.d,a=new e,s=t.a*n+t.b*r,l=t.a*i+t.b*o,c=t.c*n+t.d*r,u=t.c*i+t.d*o,d=t.tx*n+t.ty*r+this.tx,p=t.tx*i+t.ty*o+this.ty;return a.setValue(s,l,c,u,d,p),a},e.prototype.prepend=function(t){var n=this.tx,i=1,r=0,o=0,a=1;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var s=this.a,l=this.c;i=s*t.a+this.b*t.c,r=s*t.b+this.b*t.d,o=l*t.a+this.d*t.c,a=l*t.b+this.d*t.d}var c=n*t.a+this.ty*t.c+t.tx,u=n*t.b+this.ty*t.d+t.ty,d=new e;return d.setValue(i,r,o,a,c,u),d},e.prototype.invert=function(){var t=this.a,n=this.b,i=this.c,r=this.d,o=this.tx,a=t*r-n*i,s=r/a,l=-n/a,c=-i/a,u=t/a,d=(i*this.ty-r*o)/a,p=-(t*this.ty-n*o)/a,h=new e;return h.setValue(s,l,c,u,d,p),h},e.prototype.clone=function(){var t=new e;return t.setValue(this.a,this.b,this.c,this.d,this.tx,this.ty),t},e.prototype.getDOMMatrix=function(){return new DOMMatrix([this.a,this.b,this.c,this.d,this.tx,this.ty])},e}(),sr=new ar,lr={x:0,y:0,scaleX:1,scaleY:1,pivotX:0,pivotY:0,rotation:0};function cr(e){var t=dt(e,lr);return Object.defineProperty(t.prototype,"transform",{get:function(){var e=new ar;return e.update(this.x,this.y,this.scaleX,this.scaleY,this.pivotX,this.pivotY,this.rotation*Math.PI/180),e}}),t}var ur=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=[],t}return P(t,e),t.prototype.paint=function(e){var t=e.context,n=this.children;n.length&&(e.currentPainter.beforeClip(e,this),n.forEach((function(e){t.clip(e.path,e.clipRule)})))},t.prototype.paintSvg=function(e){var t=e.currentRoot,n=this.children;if(n.length){var i=Jn("g"),r=Jn("clipPath");r.id=ni(),n.forEach((function(e){var t=e.genSvgPath();e.clipRule&&t.setAttribute("clip-rule",e.clipRule),r.appendChild(t)})),t.appendChild(r),t.appendChild(i),ai(i,r),e.currentRoot=i}},t}(cr(ft)),dr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.x=0,t.y=0,t.width=10,t.height=10,t}return P(t,e),t.prototype.paint=function(e){var t=e.context;e.currentPainter.setTransform(e);var n=this,i=n.x,r=n.y,o=n.width,a=n.height;t.clearRect(i,r,o,a)},t.prototype.paintSvg=function(e){},t}(ht);function pr(e){return"#"+(e+16777216).toString(16).substring(1)}function hr(e,t){return void 0===t&&(t=1),"rgba(".concat(e>>16&255,", ").concat(e>>8&255,", ").concat(255&e,", ").concat(t,")")}var fr,mr,vr=function(e,t,n){var i=0,r=0,o=0;e=(e*=360)%360/60;var a=n*t,s=a*(1-Math.abs(e%2-1));return i=r=o=n-a,i+=[a,s,0,0,s,a][e=~~e],r+=[s,a,a,s,0,0][e],o+=[0,0,s,a,a,s][e],{r:Math.round(255*i),g:Math.round(255*r),b:Math.round(255*o)}},gr=function(e,t,n){var i=vr(e,t,n);return"#"+(1<<24|i.r<<16|i.g<<8|i.b).toString(16).substring(1)},yr=function(e){var t=(e>>16&255)/255,n=(e>>8&255)/255,i=(255&e)/255,r=Math.max(t,n,i),o=r-Math.min(t,n,i),a=0===o?0:r===t?(n-i)/o:r===n?(i-t)/o+2:(t-n)/o+4;return{h:(a=(a+360)%6*60/360)||1,s:0===o?0:o/r,b:r}},br=function(e){var t=e.match(/[0-9]+/g);return t?t.reduce((function(e,t,n){return n>=3?e:e+(256|+t).toString(16).slice(1)}),"#"):"#ffffff"},Er=function(e){try{return parseInt("0x".concat(br(e).substring(1)))}catch(e){return parseInt("0xffffff")}},xr=function(e){return e.startsWith("#")&&(e=e.substring(1)),3===e.length&&(e+=e),parseInt(e,16)},wr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pathDatas=[],t.startPos={x:0,y:0},t}return P(t,e),t.prototype.reset=function(){this.strokeStyle=void 0,this.fillStyle=void 0,this.currentPath=void 0},Object.defineProperty(t.prototype,"draw",{get:function(){return this._draw},set:function(e){e!==this._draw&&(this._draw=e,void 0!==e&&(this.reset(),e.call(this,this)))},enumerable:!1,configurable:!0}),t.prototype.createData=function(e,t){var n={path:e};return this.strokeStyle&&(n.stroke=exports.E({},this.strokeStyle)),t&&(n.closed=!0,this.fillStyle&&(n.fill=this.fillStyle)),n},t.prototype.addData=function(e,t){var n=this.createData(e,t);t||(this.currentPath=n),this.pathDatas.push(n)},t.prototype.createEmptyData=function(){var e=new Path2D;return e.moveTo(this.startPos.x,this.startPos.y),this.createData(e)},t.prototype.getCurrentPath=function(){return this.currentPath||(this.currentPath=this.createEmptyData(),this.pathDatas.push(this.currentPath)),this.currentPath},t.prototype.moveTo=function(e,t){this.currentPath?this.currentPath.path.moveTo(e,t):this.startPos={x:e,y:t}},t.prototype.lineStyle=function(e,t,n){if("number"==typeof e){var i={width:e};void 0!==t&&(i.color=t),void 0!==n&&(i.alpha=n),this.strokeStyle=exports.E(exports.E({},this.strokeStyle),i)}else this.strokeStyle=e||void 0},t.prototype.drawCircle=function(e,t,n){this.currentPath=void 0;var i=new Path2D;i.arc(e,t,n,0,2*Math.PI),this.addData(i,!0)},t.prototype.arc=function(e,t,n,i,r,o){this.currentPath=void 0;var a=new Path2D;a.arc(e,t,n,i,r,o),this.addData(a)},t.prototype.arcTo=function(e,t,n,i,r){this.getCurrentPath().path.arcTo(e,t,n,i,r)},t.prototype.drawPolygon=function(e){this.currentPath=void 0;for(var t=new Path2D,n=0;n<e.length;n+=2)0==n?t.moveTo(e[n],e[n+1]):t.lineTo(e[n],e[n+1]);t.closePath(),this.addData(t,!0)},t.prototype.drawRoundedRect=function(e,t,n,i,r){var o=new Path2D,a=r,s=r,l=r,c=r,u=Math.min(n,i)/2|0;a=a>u&&u||a,s=s>u&&u||s,l=l>u&&u||l,c=c>u&&u||c,o.moveTo(e+n-s,t),o.arcTo(e+n,t,e+n,t+s,s),o.lineTo(e+n,t+i-l),o.arcTo(e+n,t+i,e+n-l,t+i,l),o.lineTo(e+c,t+i),o.arcTo(e,t+i,e,t+i-c,c),o.lineTo(e,t+a),o.arcTo(e,t,e+a,t,a),o.closePath(),this.addData(o,!0)},t.prototype.drawEllipse=function(e,t,n,i){this.currentPath=void 0;var r=new Path2D;r.ellipse(e,t,n,i,0,0,2*Math.PI),this.addData(r,!0)},t.prototype.quadraticCurveTo=function(e,t,n,i){this.getCurrentPath().path.quadraticCurveTo(e,t,n,i)},t.prototype.bezierCurveTo=function(e,t,n,i,r,o){this.getCurrentPath().path.bezierCurveTo(e,t,n,i,r,o)},t.prototype.closePath=function(){var e=this.currentPath;e&&(e.path.closePath(),e.closed=!0,this.fillStyle&&(e.fill=this.fillStyle))},t.prototype.lineTo=function(e,t){this.getCurrentPath().path.lineTo(e,t)},t.prototype.beginFill=function(e,t){void 0===t&&(t=1),this.fillStyle={color:e,alpha:t}},t.prototype.drawRect=function(e,t,n,i){this.currentPath=void 0;var r=new Path2D;r.rect(e,t,n,i),this.addData(r,!0)},t.prototype.clear=function(){this.pathDatas=[],this.currentPath=void 0},t.prototype.endFill=function(){this.fillStyle=void 0},t.prototype.paint=function(e){if(!this.hide){var t=this.drawAny,n=this.pathDatas;if(t||n.length){var i=e.transform,r=e.context,o=e.alpha,a=e.currentPainter,s=i.append(this.transform);if(r.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),a.transformAimed=!1,t)r.globalAlpha=o,t.call(null,e),e.drawImageCount=0,r.setLineDash([]),r.lineDashOffset=0;else if(n.length){for(var l=function(e){var t=e.path,n=e.closed,i=e.stroke,l=e.fill;if(l&&n){var c=l.color,u=void 0===c?0:c,d=l.alpha,p=void 0===d?1:d;p>0&&(r.globalAlpha=o*p,r.fillStyle=pr(u),r.fill(t))}if(!i||0===i.width||0===i.alpha)return"continue";var h=i.width,f=void 0===h?1:h,m=i.alpha,v=void 0===m?1:m,g=i.lineDash,y=void 0===g?[]:g,b=i.cap,E=void 0===b?"butt":b,x=s.currentScale,w=1,C=f*x,S=0;if(a.preserveLineWidth&&C<1&&(w=.3+.7*C,f=1/x),y.length)if(C<.3)w/=2,y=[];else if(C<=1&&"butt"!=E){var k=f;S=k/2,E="butt",y=y.map((function(e){return e-(k=-k)}))}v*=w,r.lineDashOffset=S,r.setLineDash(y),r.lineCap=E,r.lineJoin=i.join||"miter",r.lineWidth=f,r.globalAlpha=o*v,r.strokeStyle=pr(i.color||0),r.stroke(t)},c=0,u=n;c<u.length;c++)l(u[c]);e.drawImageCount=0,r.setLineDash([]),r.lineDashOffset=0}}}},t.prototype.paintSvg=function(e){if(!this.hide&&this.draw){var t=new li;this.draw.call(t,t);var n=t.pathDatas,i=e.currentRoot,r=Jn("g");r.setAttribute("transform",$n(this.transform)),i.appendChild(r);for(var o=0,a=n;o<a.length;o++){var s=a[o],l=s.closed,c=s.stroke,u=s.fill,d=s.path;if(!d){var p=s.pathCmd;ri(d=Jn("path"),"d",p.join(" "))}if(r.appendChild(d),u&&0!==u.alpha&&l){var h=u.color,f=void 0===h?0:h,m=u.alpha,v=void 0===m?1:m;oi(d,{fill:pr(f),"fill-opacity":v})}else ri(d,"fill-opacity",0);if(c&&0!==c.width&&0!==c.alpha){var g=c.width,y=void 0===g?1:g,b=c.alpha,E=void 0===b?1:b,x=c.lineDash,w=void 0===x?[]:x,C=c.cap,S=void 0===C?"butt":C,k=c.join,_=void 0===k?"miter":k;oi(d,{stroke:pr(c.color||0),"stroke-opacity":E,"stroke-width":y,"stroke-linecap":S,"stroke-linejoin":_}),w.length&&ri(d,"stroke-dasharray",w.join(","))}}}},t}(cr(ht)),Cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alpha=1,t.children=[],t.contextCliped=!1,t}return P(t,e),t.prototype.setTransform=function(e,t){if(!this.transformAimed||t){var n=e.transform;e.context.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),this.transformAimed=!0}},t.prototype.paint=function(e){if(!this.hide){var t=e.transform,n=e.alpha,i=e.currentPainter,r=e.context,o=t.clone().append(this.transform);e.transform=o,1!==this.alpha&&(e.alpha=n*this.alpha),e.currentPainter=this,this.setTransform(e,!0),this.children.forEach((function(t){return t.paint(e)})),this.contextCliped&&(this.contextCliped=!1,r.restore()),e.transform=t,e.alpha=n,e.currentPainter=i,i.transformAimed=!1}},t.prototype.beforeClip=function(e,t){var n=e.context;this.contextCliped||(n.save(),this.contextCliped=!0)},t.prototype.beforePathDrawn=function(e,t){},t.prototype.afterPathDrawn=function(e,t){},t.prototype.beforeSvgPathDrawn=function(e,t){},t.prototype.afterSvgPathDrawn=function(e,t){},t.prototype.paintSvg=function(e){if(!this.hide){var t=Jn("g");t.setAttribute("transform",$n(this.transform)),t.setAttribute("opacity",this.alpha+"");var n=e.currentRoot,i=e.alpha,r=e.currentPainter;if(this.link){var o=Jn("a");oi(o,{href:this.link,target:"_blank"}),n.appendChild(o),o.appendChild(t)}else n.appendChild(t);e.currentPainter=this,e.currentRoot=t,e.alpha=i*this.alpha,this.children.forEach((function(t){return t.paintSvg(e)})),e.currentPainter=r,e.currentRoot=n,e.alpha=i}},t}(cr(ft)),Sr=function(){function e(e,t,n,i){this.canvas=e,this.width=t,this.height=n,this.children=[],this.resolution=1,this.rootPaint=new Cr,(i=i||{}).resolution&&(this.resolution=i.resolution),this.context=e.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.resize()}return e.prototype.paint=function(e){this.rootPaint.paint(e)},e.prototype.appendChild=function(e){return this.rootPaint.appendChild(e)},e.prototype.removeChild=function(e){return this.rootPaint.removeChild(e)},e.prototype.getChildIndex=function(e){return this.rootPaint.getChildIndex(e)},e.prototype.setChildIndex=function(e,t){return this.rootPaint.setChildIndex(e,t)},e.prototype.addChildAt=function(e,t){return this.rootPaint.addChildAt(e,t)},Object.defineProperty(e.prototype,"canvasWidth",{get:function(){return this.width*this.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasHeight",{get:function(){return this.height*this.resolution},enumerable:!1,configurable:!0}),e.prototype.render=function(){var e=this,t=e.context,n=e.canvasWidth,i=e.canvasHeight;if(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.fillStyle="black",t.clearRect(0,0,n,i);var r={currentPainter:this.rootPaint,alpha:1,transform:sr,viewWidth:n,viewHeight:i,drawImageCount:0,context:t};this.rootPaint.scaleX=this.resolution,this.rootPaint.scaleY=this.resolution,this.rootPaint.paint(r)}},e.prototype.resize=function(){var e=this,t=e.width,n=e.height,i=e.canvasHeight,r=e.canvasWidth;this.canvas.style.width=t+"px",this.canvas.style.height=n+"px",this.canvas.width=r,this.canvas.height=i},e.prototype.base64=function(e){return this.canvas.toDataURL(e)},e.prototype.paintSvg=function(e){this.rootPaint.scaleX=this.resolution,this.rootPaint.scaleY=this.resolution,this.rootPaint.paintSvg(e)},e.prototype.exportSvg=function(e){void 0===e&&(e={});var t=e.fonts,n=void 0===t?[]:t,i=this.canvasWidth,r=this.canvasHeight,o=Jn("svg");oi(o,{viewBox:"0 0 ".concat(i," ").concat(r),width:i,height:r,xmlns:"http://www.w3.org/2000/svg"});var a=Jn("defs");o.appendChild(a);var s=ei(n);a.appendChild(s);var l={currentRoot:o,def:a,imageCache:{},currentPainter:this.rootPaint,alpha:1,transform:sr,viewWidth:i,viewHeight:r};return this.paintSvg(l),o},e.prototype.destroy=function(){this.canvas=void 0,this.context=void 0},e}(),kr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dirty=!0,t}return P(t,e),Object.defineProperty(t.prototype,"path",{get:function(){return this._path&&!this._dirty||(this._path=this.genPath(),this._dirty=!1),this._path},enumerable:!1,configurable:!0}),t.prototype.genPath=function(){return new Path2D},t.prototype.genSvgPath=function(){return Jn("path")},t.prototype.paint=function(e){if(!this.hide){var t=e.context,n=e.transform,i=e.currentPainter,r=e.alpha;i.setTransform(e),i.beforePathDrawn(e,this);var o=1,a=i.lineWidth;if(a){var s=n.currentScale,l=a*s,c=i.lineDash,u=void 0===c?[]:c,d=i.lineCap,p=0;if(i.preserveLineWidth&&l<1&&(o=.3+.7*l,a=1/s),u.length)if(l<.3)o/=2,u=[];else if(l<=1&&"butt"!=d){var h=a;p=h/2,d="butt",u=u.map((function(e){return e-(h=-h)}))}t.lineDashOffset=p,t.setLineDash(u),t.lineCap=d||"butt",t.lineJoin=i.lineJoin||"miter"}var f=(i.fillAlpha||1)*r;i.fill&&f>0&&(t.globalAlpha=f,t.fillStyle=i.fill,t.fill(this.path));var m=(i.strokeAlpha||1)*r*o;i.stroke&&a&&m>0&&(t.lineWidth=a,t.globalAlpha=m,t.strokeStyle=i.stroke,t.stroke(this.path)),e.drawImageCount=0,t.setLineDash([]),t.lineDashOffset=0,i.afterPathDrawn(e)}},t.prototype.paintSvg=function(e){if(!this.hide){e.currentPainter.beforeSvgPathDrawn(e,this);var t=e.currentPainter,n=e.currentRoot,i=t.fill,r=t.fillAlpha,o=void 0===r?1:r,a=t.stroke,s=t.strokeAlpha,l=void 0===s?1:s,c=t.lineWidth,u=t.lineCap,d=void 0===u?"butt":u,p=t.lineJoin,h=void 0===p?"miter":p,f=t.lineDash,m=void 0===f?[]:f,v=this.genSvgPath();i&&o>0?oi(v,{fill:i,"fill-opacity":o}):ri(v,"fill-opacity",0),a&&c&&l>0&&(oi(v,{stroke:a,"stroke-opacity":l,"stroke-width":c,"stroke-linecap":d,"stroke-linejoin":h}),m.length&&ri(v,"stroke-dasharray",m.join(","))),n.appendChild(v),e.currentPainter.afterSvgPathDrawn(e,this)}},t}(ht),_r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.genPath=function(){var t=e.prototype.genPath.call(this);return t.rect(this.x,this.y,this.width,this.height),t},t.prototype.genSvgPath=function(){var e=Jn("rect"),t=this;return oi(e,{x:t.x,y:t.y,width:t.width,height:t.height}),e},t}(pt(kr,{x:0,y:0,width:0,height:0},(function(){this._dirty=!0}))),Tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.genPath=function(){var t=e.prototype.genPath.call(this);return t.ellipse(this.cx,this.cy,this.rx,this.ry,0,0,2*Math.PI),t},t.prototype.genSvgPath=function(){var e=Jn("ellipse"),t=this;return oi(e,{cx:t.cx,cy:t.cy,rx:t.rx,ry:t.ry}),e},t}(pt(kr,{cx:0,cy:0,rx:10,ry:10},(function(){this._dirty=!0}))),Ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),Object.defineProperty(t.prototype,"dataArray",{get:function(){return this._dataArray},set:function(e){if(e!==this._dataArray){if(void 0!==this._dataArray&&void 0!==e&&function(e,t){function n(e,t,n){var i=n||function(e,t){return e===t};if(e.length===t.length){for(var r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}return!1}return n(e,t,n)}(this._dataArray,e))return;this._dataArray=e,this._dirty=!0}},enumerable:!1,configurable:!0}),t.prototype.genPath=function(){var e=new Path2D,t=this.dataArray;if(null==t?void 0:t.length)for(var n=0;n<t.length;n++){var i=t[n];switch(0===n&&"M"!==i[0]&&e.moveTo(0,0),i[0]){case"M":e.moveTo(i[1],i[2]);break;case"L":e.lineTo(i[1],i[2]);break;case"Q":e.quadraticCurveTo(i[1],i[2],i[3],i[4]);break;case"C":e.bezierCurveTo(i[1],i[2],i[3],i[4],i[5],i[6]);break;case"R":e.arcTo(i[1],i[2],i[3],i[4],i[5]);break;case"Z":e.closePath()}}return e},t.prototype.genSvgPath=function(){var t=e.prototype.genSvgPath.call(this),n=this.dataArray;if(null==n?void 0:n.length){for(var i=[],r={x:0,y:0},o=0;o<n.length;o++){var a=n[o];switch(0===o&&"M"!==a[0]&&i.push("M 0,0"),a[0]){case"M":case"L":case"Q":case"C":case"Z":for(var s=a[0],l=1;l<a.length;l+=2)s+=" "+a[l]+","+a[l+1],r={x:a[l],y:a[l+1]};i.push(s);break;case"R":var c=r,u={x:a[1],y:a[2]},d={x:a[3],y:a[4]},p=a[5],h=si(c,u,d,p),f=h.start,m=h.end,v=h.antiClock;i.push("L ".concat(f.x,",").concat(f.y),"A ".concat(p," ").concat(p," 0 0 ").concat(v?0:1," ").concat(m.x,",").concat(m.y),"L ".concat(d.x,",").concat(d.y)),r=d}}ri(t,"d",i.join(" "))}return t},t}(kr),Pr=function(e){var t=e.childNodes,n=[];return t.forEach((function(e){e.nodeType===Node.TEXT_NODE?n.push(e):e.childNodes.length&&n.push.apply(n,Pr(e))})),n},Nr=function(e){var t=document.createElement("iframe");try{var n=new DOMParser,i=function(e){return e.replace(/\n/g,"").replace(/<o:p><\/o:p>/g,"")}(e),r=n.parseFromString(i,"text/html");t.style.opacity="0",document.body.append(t),t.contentDocument.documentElement.innerHTML=r.children[0].outerHTML;var o=t.contentWindow,a=t.contentDocument.body;Array.from(a.getElementsByTagName("p")).forEach((function(e){""===e.innerHTML&&e.remove()})),Array.from(a.getElementsByTagName("span")).forEach((function(e){if(!e.innerHTML){var t=e.parentElement;t&&"P"===t.tagName&&1===t.children.length&&(e.innerHTML=" ")}}));for(var s=Pr(a);/^\n*$/.test(s[0].data);)s.shift();for(;;){var l=s[s.length-1];if(!l||!/^\n*$/.test(l.data))break;s.pop()}if(!s.length)return null;var c=[];s.forEach((function(e){var t,n;if("\n\n"!==e.data&&(e.data.trim()||e.parentElement!==a)&&(!/(<!--.*?-->)|(<!--[\S\s]+?-->)|(<!--[\S\s]*?$)/.test(e.data)||"STYLE"!==(null===(t=e.parentElement)||void 0===t?void 0:t.tagName))){"\n"===e.data&&e.previousSibling&&e.nextElementSibling&&(e.data=" ");var i="",r=e.parentElement;if(r){for(;"FONT"===(null==r?void 0:r.tagName);)r=r.parentElement;if(r){for(var s,l=r,u=!1,d=!1,p=void 0;l&&l!==a;){if("A"===l.tagName){var h=l.href;h&&(i=h)}var f=o.getComputedStyle(l);!p&&(p=f),("S"===l.tagName||f.textDecoration.includes("line-through"))&&(u=!0),f.textDecoration.includes("underline")&&(d=!0),"block"!==f.display||s||(s=l),l=l.parentElement}s||"BR"!==(null===(n=e.nextElementSibling)||void 0===n?void 0:n.tagName)||(e.data+="\n"),p||(p=o.getComputedStyle(r));var m=p.textDecoration;c.push({text:e.data,blockEle:s,styles:exports.E(exports.E(exports.E(exports.E(exports.E({color:Er(p.color),highLight:r.style.backgroundColor?Er(r.style.backgroundColor):null},+p.fontWeight>=500&&{bolder:!0}),"italic"===p.fontStyle&&{italic:!0}),(m.includes("underline")||d)&&{underLine:!0}),(m.includes("line-through")||u)&&{deleteLine:!0}),i&&{link:i})})}}}})),c.forEach((function(e,t){var n;e.blockEle&&t!==c.length-1&&((null===(n=c[t+1])||void 0===n?void 0:n.blockEle)===e.blockEle||/^\n*$/.test(e.text)||("&nbsp;"===e.text?e.text="\n":e.text+="\n")),e.text=e.text.replace(/\u00a0/g," ")}));var u=c.reduce((function(e,t){return R(R([],e,!0),[[yi(t.text),t.styles]],!1)}),[]);if(t.remove(),u.length)return u}catch(e){return t.remove(),null}return null},Mr="selected_color_box_1hs9S",Ar="color_editor_1EsR8",Dr="tick_slider_container_hxlBb",Rr="tick_slider_XgIcV",Br="tick_slider_wrapper__yite",Lr="label_1VFgw",Or="phoneLayout_3mLaR",Fr="label_value_2REBO",zr="tickSliderContainer_3WjAq",Hr="sliderValue_2XlTD",Ur="tickSliderContainer_phoneLayout_20DPd",Wr="element_name_3XNlf",Vr="temp_input_2zTwd",jr="editorBtn_3X2ha",Gr="option_list_RHtlS",qr="rich_text_textarea_2N1Aq",Kr="iphone_8cDs7",Yr="phoneLinePropsColorFcContainer_Qka04",Xr="tick2_1H0Wr",Qr="tick1_2HVrc",Zr=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,Jr=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.msCancelAnimationFrame;if(_e.safari||window._no_requestAnimationFrame_||"function"!=typeof Zr){var $r=[],eo=0,to=0,no=function(){var e=$r;$r=[],e.forEach((function(e){var t=e.cb;return Promise.resolve().then(t)}))};fr=function(e){(++eo<=0||eo>9999999)&&(eo=1);var t=eo;return $r.length||(to=window.setTimeout(no,16)),$r.push({reqId:t,cb:e}),t},mr=function(e){var t=$r.length;$r=$r.filter((function(t){return t.reqId!==e})),t>0&&0===($r=$r.filter((function(t){return t.reqId!==e}))).length&&clearTimeout(to)}}else fr=function(e){return Zr(e)},mr=function(e){return Jr(e)};var io,ro=function(){function e(){this._t={}}return e.prototype.addListener=function(e,t,n){void 0===n&&(n=!1);var i=this._t,r=i[e];r||(i[e]=r=[]);var o={cb:t,once:n};return r.push(o),function(){var t=i[e];t&&(i[e]=t.filter((function(e){return e!==o})))}},e.prototype.subscribe=function(e,t){return this.addListener(e,t)},e.prototype.once=function(e,t){return this.addListener(e,t,!0)},e.prototype.publish=function(e,t){var n=this._t,i=n[e];i&&(n[e]=i.filter((function(e){return!e.once})),i.forEach((function(e){return e.cb(t)})))},e}();function oo(e,t){if("production"!==process.env.NODE_ENV||t)throw new Error(e)}var ao,so=((io={}).children=!0,io.parent=!0,io),lo={alpha:1,pivotX:0,visible:!0,x:0,y:0,pivotY:0,scaleX:1,scaleY:1,rotation:0,scrollTop:0,src:""},co=(ao=Object.keys(so),function(e){return!ao.includes(e)});function uo(e,t){for(var n=!1,i=Object.keys(exports.E(exports.E({},e),t)).filter(co),r=0;r<i.length;r++){var o=i[r],a=t[o];t[o]!==e[o]&&(n=!0),void 0!==a?this[o]=a:o in lo?(n=!0,this[o]=lo[o]):this[o]=void 0}return n}var po={};function ho(e,t){return po[e]&&oo("override element_factories."+e,!0),po[e]=t,e}var fo={applyProps:uo,config:{}},mo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(Cr,fo));ho("paint",(function(){return new mo}));var vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(_r,fo));ho("rectPath",(function(){return new vo}));var go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(Tr,fo));ho("EllipsePath",(function(){return new go}));var yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(Ir,fo));ho("awesomePath",(function(){return new yo}));var bo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(ur,fo));ho("clipPath",(function(){return new bo}));var Eo=exports.E(exports.E({},fo),{applyProps:function(e,t){var n=e.cache,i=N(e,["cache"]),r=t.cache,o=N(t,["cache"]),a=!1;return r!==n&&(a=!0,this.cache=r),uo.call(this,i,o)||a}}),xo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(rr,Eo));ho("image",(function(){return new xo}));var wo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(or,Eo));ho("borderImage",(function(){return new wo}));var Co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(Gi,fo));ho("text",(function(){return new Co}));var So=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(wr,fo)),ko=ho("drawAny",(function(){return new So})),_o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(dt(dr,fo));ho("clearRect",(function(){return new _o}));var To={exports:{}},Io={exports:{}},Po=Object.getOwnPropertySymbols,No=Object.prototype.hasOwnProperty,Mo=Object.prototype.propertyIsEnumerable;var Ao=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var i=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==i.join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,i,r=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),o=1;o<arguments.length;o++){for(var a in n=Object(arguments[o]))No.call(n,a)&&(r[a]=n[a]);if(Po){i=Po(n);for(var s=0;s<i.length;s++)Mo.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},Do={exports:{}},Ro={};
/** @license React v0.20.2
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */!function(e){var t,n,i,r;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,u=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(e){throw setTimeout(u,0),e}};t=function(e){null!==l?setTimeout(t,0,e):(l=e,setTimeout(u,0))},n=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},e.unstable_shouldYield=function(){return!1},r=e.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,p=window.clearTimeout,h=!1,f=null,m=-1,v=5,g=0;e.unstable_shouldYield=function(){return e.unstable_now()>=g},r=function(){},e.unstable_forceFrameRate=function(e){0>e||125<e||(v=0<e?Math.floor(1e3/e):5)};var y=new MessageChannel,b=y.port2;y.port1.onmessage=function(){if(null!==f){var t=e.unstable_now();g=t+v;try{f(!0,t)?b.postMessage(null):(h=!1,f=null)}catch(e){throw b.postMessage(null),e}}else h=!1},t=function(e){f=e,h||(h=!0,b.postMessage(null))},n=function(t,n){m=d((function(){t(e.unstable_now())}),n)},i=function(){p(m),m=-1}}function E(e,t){var n=e.length;e.push(t);e:for(;;){var i=n-1>>>1,r=e[i];if(!(void 0!==r&&0<C(r,t)))break e;e[i]=t,e[n]=r,n=i}}function x(e){return void 0===(e=e[0])?null:e}function w(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length;i<r;){var o=2*(i+1)-1,a=e[o],s=o+1,l=e[s];if(void 0!==a&&0>C(a,n))void 0!==l&&0>C(l,a)?(e[i]=l,e[s]=n,i=s):(e[i]=a,e[o]=n,i=o);else{if(!(void 0!==l&&0>C(l,n)))break e;e[i]=l,e[s]=n,i=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],k=[],_=1,T=null,I=3,P=!1,N=!1,M=!1;function A(e){for(var t=x(k);null!==t;){if(null===t.callback)w(k);else{if(!(t.startTime<=e))break;w(k),t.sortIndex=t.expirationTime,E(S,t)}t=x(k)}}function D(e){if(M=!1,A(e),!N)if(null!==x(S))N=!0,t(R);else{var i=x(k);null!==i&&n(D,i.startTime-e)}}function R(t,r){N=!1,M&&(M=!1,i()),P=!0;var o=I;try{for(A(r),T=x(S);null!==T&&(!(T.expirationTime>r)||t&&!e.unstable_shouldYield());){var a=T.callback;if("function"==typeof a){T.callback=null,I=T.priorityLevel;var s=a(T.expirationTime<=r);r=e.unstable_now(),"function"==typeof s?T.callback=s:T===x(S)&&w(S),A(r)}else w(S);T=x(S)}if(null!==T)var l=!0;else{var c=x(k);null!==c&&n(D,c.startTime-r),l=!1}return l}finally{T=null,I=o,P=!1}}var B=r;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){N||P||(N=!0,t(R))},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return x(S)},e.unstable_next=function(e){switch(I){case 1:case 2:case 3:var t=3;break;default:t=I}var n=I;I=t;try{return e()}finally{I=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=B,e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=I;I=e;try{return t()}finally{I=n}},e.unstable_scheduleCallback=function(r,o,a){var s=e.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,r){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return r={id:_++,callback:o,priorityLevel:r,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(r.sortIndex=a,E(k,r),null===x(S)&&r===x(k)&&(M?i():M=!0,n(D,a-s))):(r.sortIndex=l,E(S,r),N||P||(N=!0,t(R))),r},e.unstable_wrapCallback=function(e){var t=I;return function(){var n=I;I=t;try{return e.apply(this,arguments)}finally{I=n}}}}(Ro);var Bo,Lo={};
/** @license React v0.20.2
 * scheduler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */!function(e){"production"!==process.env.NODE_ENV&&function(){var t,n,i,r;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,c=null,u=function(){if(null!==l)try{var t=e.unstable_now();l(!0,t),l=null}catch(e){throw setTimeout(u,0),e}};t=function(e){null!==l?setTimeout(t,0,e):(l=e,setTimeout(u,0))},n=function(e,t){c=setTimeout(e,t)},i=function(){clearTimeout(c)},e.unstable_shouldYield=function(){return!1},r=e.unstable_forceFrameRate=function(){}}else{var d=window.setTimeout,p=window.clearTimeout,h=!1,f=null,m=-1,v=5,g=0;e.unstable_shouldYield=function(){return e.unstable_now()>=g},r=function(){},e.unstable_forceFrameRate=function(e){e<0||e>125||(v=e>0?Math.floor(1e3/e):5)};var y=new MessageChannel,b=y.port2;y.port1.onmessage=function(){if(null!==f){var t=e.unstable_now();g=t+v;try{f(!0,t)?b.postMessage(null):(h=!1,f=null)}catch(e){throw b.postMessage(null),e}}else h=!1},t=function(e){f=e,h||(h=!0,b.postMessage(null))},n=function(t,n){m=d((function(){t(e.unstable_now())}),n)},i=function(){p(m),m=-1}}function E(e,t){var n=e.length;e.push(t),function(e,t,n){for(var i=n;;){var r=i-1>>>1,o=e[r];if(!(void 0!==o&&C(o,t)>0))return;e[r]=t,e[i]=o,i=r}}(e,t,n)}function x(e){var t=e[0];return void 0===t?null:t}function w(e){var t=e[0];if(void 0!==t){var n=e.pop();return n!==t&&(e[0]=n,function(e,t,n){for(var i=0,r=e.length;i<r;){var o=2*(i+1)-1,a=e[o],s=o+1,l=e[s];if(void 0!==a&&C(a,t)<0)void 0!==l&&C(l,a)<0?(e[i]=l,e[s]=t,i=s):(e[i]=a,e[o]=t,i=o);else{if(!(void 0!==l&&C(l,t)<0))return;e[i]=l,e[s]=t,i=s}}}(e,n)),t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],k=[],_=1,T=null,I=3,P=!1,N=!1,M=!1;function A(e){for(var t=x(k);null!==t;){if(null===t.callback)w(k);else{if(!(t.startTime<=e))return;w(k),t.sortIndex=t.expirationTime,E(S,t)}t=x(k)}}function D(e){if(M=!1,A(e),!N)if(null!==x(S))N=!0,t(R);else{var i=x(k);null!==i&&n(D,i.startTime-e)}}function R(t,r){N=!1,M&&(M=!1,i()),P=!0;var o=I;try{return function(t,i){var r=i;for(A(r),T=x(S);null!==T&&(!(T.expirationTime>r)||t&&!e.unstable_shouldYield());){var o=T.callback;if("function"==typeof o){T.callback=null,I=T.priorityLevel;var a=o(T.expirationTime<=r);r=e.unstable_now(),"function"==typeof a?T.callback=a:T===x(S)&&w(S),A(r)}else w(S);T=x(S)}if(null!==T)return!0;var s=x(k);return null!==s&&n(D,s.startTime-r),!1}(t,r)}finally{T=null,I=o,P=!1}}var B=r;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){N||P||(N=!0,t(R))},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return x(S)},e.unstable_next=function(e){var t;switch(I){case 1:case 2:case 3:t=3;break;default:t=I}var n=I;I=t;try{return e()}finally{I=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=B,e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=I;I=e;try{return t()}finally{I=n}},e.unstable_scheduleCallback=function(r,o,a){var s,l,c=e.unstable_now();if("object"==typeof a&&null!==a){var u=a.delay;s="number"==typeof u&&u>0?c+u:c}else s=c;switch(r){case 1:l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}var d=s+l,p={id:_++,callback:o,priorityLevel:r,startTime:s,expirationTime:d,sortIndex:-1};return s>c?(p.sortIndex=s,E(k,p),null===x(S)&&p===x(k)&&(M?i():M=!0,n(D,s-c))):(p.sortIndex=d,E(S,p),N||P||(N=!0,t(R))),p},e.unstable_wrapCallback=function(e){var t=I;return function(){var n=I;I=t;try{return e.apply(this,arguments)}finally{I=n}}}}()}(Lo),"production"===process.env.NODE_ENV?Do.exports=Ro:Do.exports=Lo
/** @license React v0.26.2
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */,(Bo=Io).exports=function(t){var n={},i=Ao,r=e,o=Do.exports;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=60103,c=60106,u=60107,d=60108,p=60114,h=60109,f=60110,m=60112,v=60113,g=60120,y=60115,b=60116,E=60121,x=60129,w=60130,C=60131;if("function"==typeof Symbol&&Symbol.for){var S=Symbol.for;l=S("react.element"),c=S("react.portal"),u=S("react.fragment"),d=S("react.strict_mode"),p=S("react.profiler"),h=S("react.provider"),f=S("react.context"),m=S("react.forward_ref"),v=S("react.suspense"),g=S("react.suspense_list"),y=S("react.memo"),b=S("react.lazy"),E=S("react.block"),S("react.scope"),x=S("react.debug_trace_mode"),w=S("react.offscreen"),C=S("react.legacy_hidden")}var k="function"==typeof Symbol&&Symbol.iterator;function _(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=k&&e[k]||e["@@iterator"])?e:null}function T(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case u:return"Fragment";case c:return"Portal";case p:return"Profiler";case d:return"StrictMode";case v:return"Suspense";case g:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case f:return(e.displayName||"Context")+".Consumer";case h:return(e._context.displayName||"Context")+".Provider";case m:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case y:return T(e.type);case E:return T(e._render);case b:t=e._payload,e=e._init;try{return T(e(t))}catch(e){}}return null}function I(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function P(e){if(I(e)!==e)throw Error(a(188))}function N(e){var t=e.alternate;if(!t){if(null===(t=I(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return P(r),e;if(o===i)return P(r),t;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}function M(e){if(!(e=N(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function A(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var D,R=t.getPublicInstance,B=t.getRootHostContext,L=t.getChildHostContext,O=t.prepareForCommit,F=t.resetAfterCommit,z=t.createInstance,H=t.appendInitialChild,U=t.finalizeInitialChildren,W=t.prepareUpdate,V=t.shouldSetTextContent,j=t.createTextInstance,G=t.scheduleTimeout,q=t.cancelTimeout,K=t.noTimeout,Y=t.isPrimaryRenderer,X=t.supportsMutation,Q=t.supportsPersistence,Z=t.supportsHydration,J=t.getInstanceFromNode,$=t.makeOpaqueHydratingObject,ee=t.makeClientId,te=t.beforeActiveInstanceBlur,ne=t.afterActiveInstanceBlur,ie=t.preparePortalMount,re=t.supportsTestSelectors,oe=t.findFiberRoot,ae=t.getBoundingRect,se=t.getTextContent,le=t.isHiddenSubtree,ce=t.matchAccessibilityRole,ue=t.setFocusIfFocusable,de=t.setupIntersectionObserver,pe=t.appendChild,he=t.appendChildToContainer,fe=t.commitTextUpdate,me=t.commitMount,ve=t.commitUpdate,ge=t.insertBefore,ye=t.insertInContainerBefore,be=t.removeChild,Ee=t.removeChildFromContainer,xe=t.resetTextContent,we=t.hideInstance,Ce=t.hideTextInstance,Se=t.unhideInstance,ke=t.unhideTextInstance,_e=t.clearContainer,Te=t.cloneInstance,Ie=t.createContainerChildSet,Pe=t.appendChildToContainerChildSet,Ne=t.finalizeContainerChildren,Me=t.replaceContainerChildren,Ae=t.cloneHiddenInstance,De=t.cloneHiddenTextInstance,Re=t.canHydrateInstance,Be=t.canHydrateTextInstance,Le=t.isSuspenseInstancePending,Oe=t.isSuspenseInstanceFallback,Fe=t.getNextHydratableSibling,ze=t.getFirstHydratableChild,He=t.hydrateInstance,Ue=t.hydrateTextInstance,We=t.getNextHydratableInstanceAfterSuspenseInstance,Ve=t.commitHydratedContainer,je=t.commitHydratedSuspenseInstance;function Ge(e){if(void 0===D)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var qe=!1;function Ke(e,t){if(!e||qe)return"";qe=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var i=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){i=e}e.call(t.prototype)}else{try{throw Error()}catch(e){i=e}e()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var r=e.stack.split("\n"),o=i.stack.split("\n"),a=r.length-1,s=o.length-1;1<=a&&0<=s&&r[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(r[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||r[a]!==o[s])return"\n"+r[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{qe=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ge(e):""}var Ye=[],Xe=-1;function Qe(e){return{current:e}}function Ze(e){0>Xe||(e.current=Ye[Xe],Ye[Xe]=null,Xe--)}function Je(e,t){Xe++,Ye[Xe]=e.current,e.current=t}var $e={},et=Qe($e),tt=Qe(!1),nt=$e;function it(e,t){var n=e.type.contextTypes;if(!n)return $e;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function rt(e){return null!=e.childContextTypes}function ot(){Ze(tt),Ze(et)}function at(e,t,n){if(et.current!==$e)throw Error(a(168));Je(et,t),Je(tt,n)}function st(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,T(t)||"Unknown",o));return i({},n,r)}function lt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$e,nt=et.current,Je(et,e),Je(tt,tt.current),!0}function ct(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=st(e,t,nt),i.__reactInternalMemoizedMergedChildContext=e,Ze(tt),Ze(et),Je(et,e)):Ze(tt),Je(tt,n)}var ut=null,dt=null;(0,o.unstable_now)();var pt=0,ht=8;function ft(e){if(1&e)return ht=15,1;if(2&e)return ht=14,2;if(4&e)return ht=13,4;var t=24&e;return 0!==t?(ht=12,t):32&e?(ht=11,32):0!=(t=192&e)?(ht=10,t):256&e?(ht=9,256):0!=(t=3584&e)?(ht=8,t):4096&e?(ht=7,4096):0!=(t=4186112&e)?(ht=6,t):0!=(t=62914560&e)?(ht=5,t):67108864&e?(ht=4,67108864):134217728&e?(ht=3,134217728):0!=(t=805306368&e)?(ht=2,t):1073741824&e?(ht=1,1073741824):(ht=8,e)}function mt(e,t){var n=e.pendingLanes;if(0===n)return ht=0;var i=0,r=0,o=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==o)i=o,r=ht=15;else if(0!=(o=134217727&n)){var l=o&~a;0!==l?(i=ft(l),r=ht):0!=(s&=o)&&(i=ft(s),r=ht)}else 0!=(o=n&~a)?(i=ft(o),r=ht):0!==s&&(i=ft(s),r=ht);if(0===i)return 0;if(i=n&((0>(i=31-xt(i))?0:1<<i)<<1)-1,0!==t&&t!==i&&!(t&a)){if(ft(t),r<=ht)return t;ht=r}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-xt(t)),i|=e[n],t&=~r;return i}function vt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=yt(24&~t))?gt(10,t):e;case 10:return 0===(e=yt(192&~t))?gt(8,t):e;case 8:return 0===(e=yt(3584&~t))&&0===(e=yt(4186112&~t))&&(e=512),e;case 2:return 0===(t=yt(805306368&~t))&&(t=268435456),t}throw Error(a(358,e))}function yt(e){return e&-e}function bt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Et(e,t,n){e.pendingLanes|=t;var i=t-1;e.suspendedLanes&=i,e.pingedLanes&=i,(e=e.eventTimes)[t=31-xt(t)]=n}var xt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(wt(e)/Ct|0)|0},wt=Math.log,Ct=Math.LN2,St=o.unstable_runWithPriority,kt=o.unstable_scheduleCallback,_t=o.unstable_cancelCallback,Tt=o.unstable_shouldYield,It=o.unstable_requestPaint,Pt=o.unstable_now,Nt=o.unstable_getCurrentPriorityLevel,Mt=o.unstable_ImmediatePriority,At=o.unstable_UserBlockingPriority,Dt=o.unstable_NormalPriority,Rt=o.unstable_LowPriority,Bt=o.unstable_IdlePriority,Lt={},Ot=void 0!==It?It:function(){},Ft=null,zt=null,Ht=!1,Ut=Pt(),Wt=1e4>Ut?Pt:function(){return Pt()-Ut};function Vt(){switch(Nt()){case Mt:return 99;case At:return 98;case Dt:return 97;case Rt:return 96;case Bt:return 95;default:throw Error(a(332))}}function jt(e){switch(e){case 99:return Mt;case 98:return At;case 97:return Dt;case 96:return Rt;case 95:return Bt;default:throw Error(a(332))}}function Gt(e,t){return e=jt(e),St(e,t)}function qt(e,t,n){return e=jt(e),kt(e,t,n)}function Kt(){if(null!==zt){var e=zt;zt=null,_t(e)}Yt()}function Yt(){if(!Ht&&null!==Ft){Ht=!0;var e=0;try{var t=Ft;Gt(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Ft=null}catch(t){throw null!==Ft&&(Ft=Ft.slice(e+1)),kt(Mt,Kt),t}finally{Ht=!1}}}var Xt=s.ReactCurrentBatchConfig,Qt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Zt=Object.prototype.hasOwnProperty;function Jt(e,t){if(Qt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++)if(!Zt.call(t,n[i])||!Qt(e[n[i]],t[n[i]]))return!1;return!0}function $t(e){switch(e.tag){case 5:return Ge(e.type);case 16:return Ge("Lazy");case 13:return Ge("Suspense");case 19:return Ge("SuspenseList");case 0:case 2:case 15:return Ke(e.type,!1);case 11:return Ke(e.type.render,!1);case 22:return Ke(e.type._render,!1);case 1:return Ke(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=Qe(null),nn=null,rn=null,on=null;function an(){on=rn=nn=null}function sn(e,t){e=e.type._context,Y?(Je(tn,e._currentValue),e._currentValue=t):(Je(tn,e._currentValue2),e._currentValue2=t)}function ln(e){var t=tn.current;Ze(tn),e=e.type._context,Y?e._currentValue=t:e._currentValue2=t}function cn(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function un(e,t){nn=e,on=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(Ui=!0),e.firstContext=null)}function dn(e,t){if(on!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(on=e,t=1073741823),t={context:e,observedBits:t,next:null},null===rn){if(null===nn)throw Error(a(308));rn=t,nn.dependencies={lanes:0,firstContext:t,responders:null}}else rn=rn.next=t;return Y?e._currentValue:e._currentValue2}var pn=!1;function hn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function fn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function gn(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yn(e,t,n,r){var o=e.updateQueue;pn=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var c=l,u=c.next;c.next=null,null===s?a=u:s.next=u,s=c;var d=e.alternate;if(null!==d){var p=(d=d.updateQueue).lastBaseUpdate;p!==s&&(null===p?d.firstBaseUpdate=u:p.next=u,d.lastBaseUpdate=c)}}if(null!==a){for(p=o.baseState,s=0,d=u=c=null;;){l=a.lane;var h=a.eventTime;if((r&l)===l){null!==d&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(l=t,h=n,m.tag){case 1:if("function"==typeof(f=m.payload)){p=f.call(h,p,l);break e}p=f;break e;case 3:f.flags=-4097&f.flags|64;case 0:if(null==(l="function"==typeof(f=m.payload)?f.call(h,p,l):f))break e;p=i({},p,l);break e;case 2:pn=!0}}null!==a.callback&&(e.flags|=32,null===(l=o.effects)?o.effects=[a]:l.push(a))}else h={eventTime:h,lane:l,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(u=d=h,c=p):d=d.next=h,s|=l;if(null===(a=a.next)){if(null===(l=o.shared.pending))break;a=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===d&&(c=p),o.baseState=c,o.firstBaseUpdate=u,o.lastBaseUpdate=d,so|=s,e.lanes=s,e.memoizedState=p}}function bn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(a(191,r));r.call(i)}}}var En=(new r.Component).refs;function xn(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&I(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Lo(),r=Oo(e),o=mn(i,r);o.payload=t,null!=n&&(o.callback=n),vn(e,o),Fo(e,r,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Lo(),r=Oo(e),o=mn(i,r);o.tag=1,o.payload=t,null!=n&&(o.callback=n),vn(e,o),Fo(e,r,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lo(),i=Oo(e),r=mn(n,i);r.tag=2,null!=t&&(r.callback=t),vn(e,r),Fo(e,i,n)}};function Cn(e,t,n,i,r,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,a):!(t.prototype&&t.prototype.isPureReactComponent&&Jt(n,i)&&Jt(r,o))}function Sn(e,t,n){var i=!1,r=$e,o=t.contextType;return"object"==typeof o&&null!==o?o=dn(o):(r=rt(t)?nt:et.current,o=(i=null!=(i=t.contextTypes))?it(e,r):$e),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function kn(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function _n(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=En,hn(e);var o=t.contextType;"object"==typeof o&&null!==o?r.context=dn(o):(o=rt(t)?nt:et.current,r.context=it(e,o)),yn(e,n,r,i),r.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(xn(e,t,o,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&wn.enqueueReplaceState(r,r.state,null),yn(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4)}var Tn=Array.isArray;function In(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var r=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=i.refs;t===En&&(t=i.refs={}),null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Pn(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Nn(e){function t(t,n){if(e){var i=t.lastEffect;null!==i?(i.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=wa(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags=2,n):i:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function d(e,t,n,i){return null===t||6!==t.tag?((t=_a(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function p(e,t,n,i){return null!==t&&t.elementType===n.type?((i=r(t,n.props)).ref=In(e,t,n),i.return=e,i):((i=Ca(n.type,n.key,n.props,null,e.mode,i)).ref=In(e,t,n),i.return=e,i)}function h(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ta(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function f(e,t,n,i,o){return null===t||7!==t.tag?((t=Sa(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=_a(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case l:return(n=Ca(t.type,t.key,t.props,null,e.mode,n)).ref=In(e,null,t),n.return=e,n;case c:return(t=Ta(t,e.mode,n)).return=e,t}if(Tn(t)||_(t))return(t=Sa(t,e.mode,n,null)).return=e,t;Pn(e,t)}return null}function v(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:d(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===r?n.type===u?f(e,t,n.props.children,i,r):p(e,t,n,i):null;case c:return n.key===r?h(e,t,n,i):null}if(Tn(n)||_(n))return null!==r?null:f(e,t,n,i,null);Pn(e,n)}return null}function g(e,t,n,i,r){if("string"==typeof i||"number"==typeof i)return d(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case l:return e=e.get(null===i.key?n:i.key)||null,i.type===u?f(t,e,i.props.children,r,i.key):p(t,e,i,r);case c:return h(t,e=e.get(null===i.key?n:i.key)||null,i,r)}if(Tn(i)||_(i))return f(t,e=e.get(n)||null,i,r,null);Pn(t,i)}return null}function y(r,a,s,l){for(var c=null,u=null,d=a,p=a=0,h=null;null!==d&&p<s.length;p++){d.index>p?(h=d,d=null):h=d.sibling;var f=v(r,d,s[p],l);if(null===f){null===d&&(d=h);break}e&&d&&null===f.alternate&&t(r,d),a=o(f,a,p),null===u?c=f:u.sibling=f,u=f,d=h}if(p===s.length)return n(r,d),c;if(null===d){for(;p<s.length;p++)null!==(d=m(r,s[p],l))&&(a=o(d,a,p),null===u?c=d:u.sibling=d,u=d);return c}for(d=i(r,d);p<s.length;p++)null!==(h=g(d,r,p,s[p],l))&&(e&&null!==h.alternate&&d.delete(null===h.key?p:h.key),a=o(h,a,p),null===u?c=h:u.sibling=h,u=h);return e&&d.forEach((function(e){return t(r,e)})),c}function b(r,s,l,c){var u=_(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,p=s,h=s=0,f=null,y=l.next();null!==p&&!y.done;h++,y=l.next()){p.index>h?(f=p,p=null):f=p.sibling;var b=v(r,p,y.value,c);if(null===b){null===p&&(p=f);break}e&&p&&null===b.alternate&&t(r,p),s=o(b,s,h),null===d?u=b:d.sibling=b,d=b,p=f}if(y.done)return n(r,p),u;if(null===p){for(;!y.done;h++,y=l.next())null!==(y=m(r,y.value,c))&&(s=o(y,s,h),null===d?u=y:d.sibling=y,d=y);return u}for(p=i(r,p);!y.done;h++,y=l.next())null!==(y=g(p,r,h,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?h:y.key),s=o(y,s,h),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach((function(e){return t(r,e)})),u}return function(e,i,o,d){var p="object"==typeof o&&null!==o&&o.type===u&&null===o.key;p&&(o=o.props.children);var h="object"==typeof o&&null!==o;if(h)switch(o.$$typeof){case l:e:{for(h=o.key,p=i;null!==p;){if(p.key===h){if(7===p.tag){if(o.type===u){n(e,p.sibling),(i=r(p,o.props.children)).return=e,e=i;break e}}else if(p.elementType===o.type){n(e,p.sibling),(i=r(p,o.props)).ref=In(e,p,o),i.return=e,e=i;break e}n(e,p);break}t(e,p),p=p.sibling}o.type===u?((i=Sa(o.props.children,e.mode,d,o.key)).return=e,e=i):((d=Ca(o.type,o.key,o.props,null,e.mode,d)).ref=In(e,i,o),d.return=e,e=d)}return s(e);case c:e:{for(p=o.key;null!==i;){if(i.key===p){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(e,i.sibling),(i=r(i,o.children||[])).return=e,e=i;break e}n(e,i);break}t(e,i),i=i.sibling}(i=Ta(o,e.mode,d)).return=e,e=i}return s(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==i&&6===i.tag?(n(e,i.sibling),(i=r(i,o)).return=e,e=i):(n(e,i),(i=_a(o,e.mode,d)).return=e,e=i),s(e);if(Tn(o))return y(e,i,o,d);if(_(o))return b(e,i,o,d);if(h&&Pn(e,o),void 0===o&&!p)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,T(e.type)||"Component"))}return n(e,i)}}var Mn=Nn(!0),An=Nn(!1),Dn={},Rn=Qe(Dn),Bn=Qe(Dn),Ln=Qe(Dn);function On(e){if(e===Dn)throw Error(a(174));return e}function Fn(e,t){Je(Ln,t),Je(Bn,e),Je(Rn,Dn),e=B(t),Ze(Rn),Je(Rn,e)}function zn(){Ze(Rn),Ze(Bn),Ze(Ln)}function Hn(e){var t=On(Ln.current),n=On(Rn.current);n!==(t=L(n,e.type,t))&&(Je(Bn,e),Je(Rn,t))}function Un(e){Bn.current===e&&(Ze(Rn),Ze(Bn))}var Wn=Qe(0);function Vn(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Le(n)||Oe(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jn=null,Gn=null,qn=!1;function Kn(e,t){var n=Ea(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Yn(e,t){switch(e.tag){case 5:return null!==(t=Re(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 6:return null!==(t=Be(t,e.pendingProps))&&(e.stateNode=t,!0);default:return!1}}function Xn(e){if(qn){var t=Gn;if(t){var n=t;if(!Yn(e,t)){if(!(t=Fe(n))||!Yn(e,t))return e.flags=-1025&e.flags|2,qn=!1,void(jn=e);Kn(jn,n)}jn=e,Gn=ze(t)}else e.flags=-1025&e.flags|2,qn=!1,jn=e}}function Qn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;jn=e}function Zn(e){if(!Z||e!==jn)return!1;if(!qn)return Qn(e),qn=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!V(t,e.memoizedProps))for(t=Gn;t;)Kn(e,t),t=Fe(t);if(Qn(e),13===e.tag){if(!Z)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));Gn=We(e)}else Gn=jn?Fe(e.stateNode):null;return!0}function Jn(){Z&&(Gn=jn=null,qn=!1)}var $n=[];function ei(){for(var e=0;e<$n.length;e++){var t=$n[e];Y?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}$n.length=0}var ti=s.ReactCurrentDispatcher,ni=s.ReactCurrentBatchConfig,ii=0,ri=null,oi=null,ai=null,si=!1,li=!1;function ci(){throw Error(a(321))}function ui(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qt(e[n],t[n]))return!1;return!0}function di(e,t,n,i,r,o){if(ii=o,ri=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ti.current=null===e||null===e.memoizedState?Oi:Fi,e=n(i,r),li){o=0;do{if(li=!1,!(25>o))throw Error(a(301));o+=1,ai=oi=null,t.updateQueue=null,ti.current=zi,e=n(i,r)}while(li)}if(ti.current=Li,t=null!==oi&&null!==oi.next,ii=0,ai=oi=ri=null,si=!1,t)throw Error(a(300));return e}function pi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ai?ri.memoizedState=ai=e:ai=ai.next=e,ai}function hi(){if(null===oi){var e=ri.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===ai?ri.memoizedState:ai.next;if(null!==t)ai=t,oi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===ai?ri.memoizedState=ai=e:ai=ai.next=e}return ai}function fi(e,t){return"function"==typeof t?t(e):t}function mi(e){var t=hi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=oi,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}i.baseQueue=r=o,n.pending=null}if(null!==r){r=r.next,i=i.baseState;var l=s=o=null,c=r;do{var u=c.lane;if((ii&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),i=c.eagerReducer===e?c.eagerState:e(i,c.action);else{var d={lane:u,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(s=l=d,o=i):l=l.next=d,ri.lanes|=u,so|=u}c=c.next}while(null!==c&&c!==r);null===l?o=i:l.next=s,Qt(i,t.memoizedState)||(Ui=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=l,n.lastRenderedState=i}return[t.memoizedState,n.dispatch]}function vi(e){var t=hi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);Qt(o,t.memoizedState)||(Ui=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function gi(e,t,n){var i=t._getVersion;i=i(t._source);var r=Y?t._workInProgressVersionPrimary:t._workInProgressVersionSecondary;if(null!==r?e=r===i:(e=e.mutableReadLanes,(e=(ii&e)===e)&&(Y?t._workInProgressVersionPrimary=i:t._workInProgressVersionSecondary=i,$n.push(t))),e)return n(t._source);throw $n.push(t),Error(a(350))}function yi(e,t,n,i){var r=$r;if(null===r)throw Error(a(349));var o=t._getVersion,s=o(t._source),l=ti.current,c=l.useState((function(){return gi(r,t,n)})),u=c[1],d=c[0];c=ai;var p=e.memoizedState,h=p.refs,f=h.getSnapshot,m=p.source;p=p.subscribe;var v=ri;return e.memoizedState={refs:h,source:t,subscribe:i},l.useEffect((function(){h.getSnapshot=n,h.setSnapshot=u;var e=o(t._source);if(!Qt(s,e)){e=n(t._source),Qt(d,e)||(u(e),e=Oo(v),r.mutableReadLanes|=e&r.pendingLanes),e=r.mutableReadLanes,r.entangledLanes|=e;for(var i=r.entanglements,a=e;0<a;){var l=31-xt(a),c=1<<l;i[l]|=e,a&=~c}}}),[n,t,i]),l.useEffect((function(){return i(t._source,(function(){var e=h.getSnapshot,n=h.setSnapshot;try{n(e(t._source));var i=Oo(v);r.mutableReadLanes|=i&r.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,i]),Qt(f,n)&&Qt(m,t)&&Qt(p,i)||((e={pending:null,dispatch:null,lastRenderedReducer:fi,lastRenderedState:d}).dispatch=u=Bi.bind(null,ri,e),c.queue=e,c.baseQueue=null,d=gi(r,t,n),c.memoizedState=c.baseState=d),d}function bi(e,t,n){return yi(hi(),e,t,n)}function Ei(e){var t=pi();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:fi,lastRenderedState:e}).dispatch=Bi.bind(null,ri,e),[t.memoizedState,e]}function xi(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=ri.updateQueue)?(t={lastEffect:null},ri.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function wi(e){return e={current:e},pi().memoizedState=e}function Ci(){return hi().memoizedState}function Si(e,t,n,i){var r=pi();ri.flags|=e,r.memoizedState=xi(1|t,n,void 0,void 0===i?null:i)}function ki(e,t,n,i){var r=hi();i=void 0===i?null:i;var o=void 0;if(null!==oi){var a=oi.memoizedState;if(o=a.destroy,null!==i&&ui(i,a.deps))return void xi(t,n,o,i)}ri.flags|=e,r.memoizedState=xi(1|t,n,o,i)}function _i(e,t){return Si(516,4,e,t)}function Ti(e,t){return ki(516,4,e,t)}function Ii(e,t){return ki(4,2,e,t)}function Pi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ni(e,t,n){return n=null!=n?n.concat([e]):null,ki(4,2,Pi.bind(null,t,e),n)}function Mi(){}function Ai(e,t){var n=hi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ui(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Di(e,t){var n=hi();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&ui(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ri(e,t){var n=Vt();Gt(98>n?98:n,(function(){e(!0)})),Gt(97<n?97:n,(function(){var n=ni.transition;ni.transition=1;try{e(!1),t()}finally{ni.transition=n}}))}function Bi(e,t,n){var i=Lo(),r=Oo(e),o={lane:r,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),t.pending=o,a=e.alternate,e===ri||null!==a&&a===ri)li=si=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=a(s,n);if(o.eagerReducer=a,o.eagerState=l,Qt(l,s))return}catch(e){}Fo(e,r,i)}}var Li={readContext:dn,useCallback:ci,useContext:ci,useEffect:ci,useImperativeHandle:ci,useLayoutEffect:ci,useMemo:ci,useReducer:ci,useRef:ci,useState:ci,useDebugValue:ci,useDeferredValue:ci,useTransition:ci,useMutableSource:ci,useOpaqueIdentifier:ci,unstable_isNewReconciler:!1},Oi={readContext:dn,useCallback:function(e,t){return pi().memoizedState=[e,void 0===t?null:t],e},useContext:dn,useEffect:_i,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Si(4,2,Pi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Si(4,2,e,t)},useMemo:function(e,t){var n=pi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=pi();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e=(e=i.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Bi.bind(null,ri,e),[i.memoizedState,e]},useRef:wi,useState:Ei,useDebugValue:Mi,useDeferredValue:function(e){var t=Ei(e),n=t[0],i=t[1];return _i((function(){var t=ni.transition;ni.transition=1;try{i(e)}finally{ni.transition=t}}),[e]),n},useTransition:function(){var e=Ei(!1),t=e[0];return wi(e=Ri.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var i=pi();return i.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},yi(i,e,t,n)},useOpaqueIdentifier:function(){if(qn){var e=!1,t=$((function(){throw e||(e=!0,n(ee())),Error(a(355))})),n=Ei(t)[1];return!(2&ri.mode)&&(ri.flags|=516,xi(5,(function(){n(ee())}),void 0,null)),t}return Ei(t=ee()),t},unstable_isNewReconciler:!1},Fi={readContext:dn,useCallback:Ai,useContext:dn,useEffect:Ti,useImperativeHandle:Ni,useLayoutEffect:Ii,useMemo:Di,useReducer:mi,useRef:Ci,useState:function(){return mi(fi)},useDebugValue:Mi,useDeferredValue:function(e){var t=mi(fi),n=t[0],i=t[1];return Ti((function(){var t=ni.transition;ni.transition=1;try{i(e)}finally{ni.transition=t}}),[e]),n},useTransition:function(){var e=mi(fi)[0];return[Ci().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return mi(fi)[0]},unstable_isNewReconciler:!1},zi={readContext:dn,useCallback:Ai,useContext:dn,useEffect:Ti,useImperativeHandle:Ni,useLayoutEffect:Ii,useMemo:Di,useReducer:vi,useRef:Ci,useState:function(){return vi(fi)},useDebugValue:Mi,useDeferredValue:function(e){var t=vi(fi),n=t[0],i=t[1];return Ti((function(){var t=ni.transition;ni.transition=1;try{i(e)}finally{ni.transition=t}}),[e]),n},useTransition:function(){var e=vi(fi)[0];return[Ci().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return vi(fi)[0]},unstable_isNewReconciler:!1},Hi=s.ReactCurrentOwner,Ui=!1;function Wi(e,t,n,i){t.child=null===e?An(t,null,n,i):Mn(t,e.child,n,i)}function Vi(e,t,n,i,r){n=n.render;var o=t.ref;return un(t,r),i=di(e,t,n,i,o,r),null===e||Ui?(t.flags|=1,Wi(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~r,lr(e,t,r))}function ji(e,t,n,i,r,o){if(null===e){var a=n.type;return"function"!=typeof a||xa(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ca(n.type,null,i,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Gi(e,t,a,i,r,o))}return a=e.child,r&o||(r=a.memoizedProps,!(n=null!==(n=n.compare)?n:Jt)(r,i)||e.ref!==t.ref)?(t.flags|=1,(e=wa(a,i)).ref=t.ref,e.return=t,t.child=e):lr(e,t,o)}function Gi(e,t,n,i,r,o){if(null!==e&&Jt(e.memoizedProps,i)&&e.ref===t.ref){if(Ui=!1,!(o&r))return t.lanes=e.lanes,lr(e,t,o);16384&e.flags&&(Ui=!0)}return Yi(e,t,n,i,o)}function qi(e,t,n){var i=t.pendingProps,r=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode||"unstable-defer-without-hiding"===i.mode)if(4&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},qo(0,e),null;t.memoizedState={baseLanes:0},qo(0,null!==o?o.baseLanes:n)}else t.memoizedState={baseLanes:0},qo(0,n);else null!==o?(i=o.baseLanes|n,t.memoizedState=null):i=n,qo(0,i);return Wi(e,t,r,n),t.child}function Ki(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Yi(e,t,n,i,r){var o=rt(n)?nt:et.current;return o=it(t,o),un(t,r),n=di(e,t,n,i,o,r),null===e||Ui?(t.flags|=1,Wi(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~r,lr(e,t,r))}function Xi(e,t,n,i,r){if(rt(n)){var o=!0;lt(t)}else o=!1;if(un(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Sn(t,n,i),_n(t,n,i,r),i=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;c="object"==typeof c&&null!==c?dn(c):it(t,c=rt(n)?nt:et.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==i||l!==c)&&kn(t,a,i,c),pn=!1;var p=t.memoizedState;a.state=p,yn(t,i,a,r),l=t.memoizedState,s!==i||p!==l||tt.current||pn?("function"==typeof u&&(xn(t,n,u,i),l=t.memoizedState),(s=pn||Cn(t,n,s,i,p,l,c))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=s):("function"==typeof a.componentDidMount&&(t.flags|=4),i=!1)}else{a=t.stateNode,fn(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:en(t.type,s),a.props=c,d=t.pendingProps,p=a.context,l="object"==typeof(l=n.contextType)&&null!==l?dn(l):it(t,l=rt(n)?nt:et.current);var h=n.getDerivedStateFromProps;(u="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||p!==l)&&kn(t,a,i,l),pn=!1,p=t.memoizedState,a.state=p,yn(t,i,a,r);var f=t.memoizedState;s!==d||p!==f||tt.current||pn?("function"==typeof h&&(xn(t,n,h,i),f=t.memoizedState),(c=pn||Cn(t,n,c,i,p,f,l))?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),i=!1)}return Qi(e,t,n,i,o,r)}function Qi(e,t,n,i,r,o){Ki(e,t);var a=!!(64&t.flags);if(!i&&!a)return r&&ct(t,n,!1),lr(e,t,o);i=t.stateNode,Hi.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=Mn(t,e.child,null,o),t.child=Mn(t,null,s,o)):Wi(e,t,s,o),t.memoizedState=i.state,r&&ct(t,n,!0),t.child}function Zi(e){var t=e.stateNode;t.pendingContext?at(0,t.pendingContext,t.pendingContext!==t.context):t.context&&at(0,t.context,!1),Fn(e,t.containerInfo)}var Ji,$i,er,tr,nr={dehydrated:null,retryLane:0};function ir(e,t,n){var i,r=t.pendingProps,o=Wn.current,a=!1;return(i=!!(64&t.flags))||(i=(null===e||null!==e.memoizedState)&&!!(2&o)),i?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(o|=1),Je(Wn,1&o),null===e?(void 0!==r.fallback&&Xn(t),e=r.children,o=r.fallback,a?(e=rr(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=nr,e):"number"==typeof r.unstable_expectedLoadTime?(e=rr(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=nr,t.lanes=33554432,e):((n=ka({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(r=function(e,t,n,i,r){var o=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 2&o||t.child===a?n=wa(a,s):((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?i=wa(e,i):(i=Sa(i,o,r,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}(e,t,r.children,r.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=nr,r):(n=function(e,t,n,i){var r=e.child;return e=r.sibling,n=wa(r,{mode:"visible",children:n}),!(2&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}(e,t,r.children,n),t.memoizedState=null,n))}function rr(e,t,n,i){var r=e.mode,o=e.child;return t={mode:"hidden",children:t},2&r||null===o?o=ka(t,r,0,null):(o.childLanes=0,o.pendingProps=t),n=Sa(n,r,i,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function or(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),cn(e.return,t)}function ar(e,t,n,i,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.lastEffect=o)}function sr(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(Wi(e,t,i.children,n),2&(i=Wn.current))i=1&i|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&or(e,n);else if(19===e.tag)or(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Je(Wn,i),2&t.mode)switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Vn(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ar(t,!1,r,n,o,t.lastEffect);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Vn(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ar(t,!0,n,null,o,t.lastEffect);break;case"together":ar(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function lr(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),so|=t.lanes,n&t.childLanes){if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=wa(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=wa(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function cr(e){e.flags|=4}if(X)Ji=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)H(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},$i=function(){},er=function(e,t,n,i,r){if((e=e.memoizedProps)!==i){var o=t.stateNode,a=On(Rn.current);n=W(o,n,e,i,r,a),(t.updateQueue=n)&&cr(t)}},tr=function(e,t,n,i){n!==i&&cr(t)};else if(Q){Ji=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var o=r.stateNode;n&&i&&(o=Ae(o,r.type,r.memoizedProps,r)),H(e,o)}else if(6===r.tag)o=r.stateNode,n&&i&&(o=De(o,r.memoizedProps,r)),H(e,o);else if(4!==r.tag){if(13===r.tag&&4&r.flags&&(o=null!==r.memoizedState)){var a=r.child;if(null!==a&&(null!==a.child&&(a.child.return=a,Ji(e,a,!0,o)),null!==(o=a.sibling))){o.return=r,r=o;continue}}if(null!==r.child){r.child.return=r,r=r.child;continue}}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var ur=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var o=r.stateNode;n&&i&&(o=Ae(o,r.type,r.memoizedProps,r)),Pe(e,o)}else if(6===r.tag)o=r.stateNode,n&&i&&(o=De(o,r.memoizedProps,r)),Pe(e,o);else if(4!==r.tag){if(13===r.tag&&4&r.flags&&(o=null!==r.memoizedState)){var a=r.child;if(null!==a&&(null!==a.child&&(a.child.return=a,ur(e,a,!0,o)),null!==(o=a.sibling))){o.return=r,r=o;continue}}if(null!==r.child){r.child.return=r,r=r.child;continue}}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$i=function(e){var t=e.stateNode;if(null!==e.firstEffect){var n=t.containerInfo,i=Ie(n);ur(i,e,!1,!1),t.pendingChildren=i,cr(e),Ne(n,i)}},er=function(e,t,n,i,r){var o=e.stateNode,a=e.memoizedProps;if((e=null===t.firstEffect)&&a===i)t.stateNode=o;else{var s=t.stateNode,l=On(Rn.current),c=null;a!==i&&(c=W(s,n,a,i,r,l)),e&&null===c?t.stateNode=o:(o=Te(o,c,n,a,i,t,e,s),U(o,n,i,r,l)&&cr(t),t.stateNode=o,e?cr(t):Ji(o,t,!1,!1))}},tr=function(e,t,n,i){n!==i?(e=On(Ln.current),n=On(Rn.current),t.stateNode=j(i,e,n,t),cr(t)):t.stateNode=e.stateNode}}else $i=function(){},er=function(){},tr=function(){};function dr(e,t){if(!qn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function pr(e,t,n){var i=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return rt(t.type)&&ot(),null;case 3:return zn(),Ze(tt),Ze(et),ei(),(i=t.stateNode).pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Zn(t)?cr(t):i.hydrate||(t.flags|=256)),$i(t),null;case 5:Un(t);var r=On(Ln.current);if(n=t.type,null!==e&&null!=t.stateNode)er(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=128);else{if(!i){if(null===t.stateNode)throw Error(a(166));return null}if(e=On(Rn.current),Zn(t)){if(!Z)throw Error(a(175));e=He(t.stateNode,t.type,t.memoizedProps,r,e,t),t.updateQueue=e,null!==e&&cr(t)}else{var o=z(n,i,r,e,t);Ji(o,t,!1,!1),t.stateNode=o,U(o,n,i,r,e)&&cr(t)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)tr(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(a(166));if(e=On(Ln.current),r=On(Rn.current),Zn(t)){if(!Z)throw Error(a(176));Ue(t.stateNode,t.memoizedProps,t)&&cr(t)}else t.stateNode=j(i,e,r,t)}return null;case 13:return Ze(Wn),i=t.memoizedState,64&t.flags?(t.lanes=n,t):(i=null!==i,r=!1,null===e?void 0!==t.memoizedProps.fallback&&Zn(t):r=null!==e.memoizedState,i&&!r&&!!(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&Wn.current?0===ro&&(ro=3):(0!==ro&&3!==ro||(ro=4),null===$r||!(134217727&so)&&!(134217727&lo)||Wo($r,to))),Q&&i&&(t.flags|=4),X&&(i||r)&&(t.flags|=4),null);case 4:return zn(),$i(t),null===e&&ie(t.stateNode.containerInfo),null;case 10:return ln(t),null;case 19:if(Ze(Wn),null===(i=t.memoizedState))return null;if(r=!!(64&t.flags),null===(o=i.rendering))if(r)dr(i,!1);else{if(0!==ro||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(o=Vn(e))){for(t.flags|=64,dr(i,!1),null!==(e=o.updateQueue)&&(t.updateQueue=e,t.flags|=4),null===i.lastEffect&&(t.firstEffect=null),t.lastEffect=i.lastEffect,e=n,i=t.child;null!==i;)n=e,(r=i).flags&=2,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null,null===(o=r.alternate)?(r.childLanes=0,r.lanes=n,r.child=null,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),i=i.sibling;return Je(Wn,1&Wn.current|2),t.child}e=e.sibling}null!==i.tail&&Wt()>ho&&(t.flags|=64,r=!0,dr(i,!1),t.lanes=33554432)}else{if(!r)if(null!==(e=Vn(o))){if(t.flags|=64,r=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),dr(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!qn)return null!==(t=t.lastEffect=i.lastEffect)&&(t.nextEffect=null),null}else 2*Wt()-i.renderingStartTime>ho&&1073741824!==n&&(t.flags|=64,r=!0,dr(i,!1),t.lanes=33554432);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.lastEffect=t.lastEffect,i.renderingStartTime=Wt(),e.sibling=null,t=Wn.current,Je(Wn,r?1&t|2:1&t),e):null;case 23:case 24:return Ko(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==i.mode&&(t.flags|=4),null}throw Error(a(156,t.tag))}function hr(e){switch(e.tag){case 1:rt(e.type)&&ot();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(zn(),Ze(tt),Ze(et),ei(),64&(t=e.flags))throw Error(a(285));return e.flags=-4097&t|64,e;case 5:return Un(e),null;case 13:return Ze(Wn),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return Ze(Wn),null;case 4:return zn(),null;case 10:return ln(e),null;case 23:case 24:return Ko(),null;default:return null}}function fr(e,t){try{var n="",i=t;do{n+=$t(i),i=i.return}while(i);var r=n}catch(e){r="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:r}}var mr="function"==typeof WeakMap?WeakMap:Map;function vr(e,t,n){(n=mn(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){go||(go=!0,yo=i)},n}function gr(e,t,n){(n=mn(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof i&&(null===bo?bo=new Set([this]):bo.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var yr="function"==typeof WeakSet?WeakSet:Set;function br(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){ua(e,t)}else t.current=null}function Er(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,i=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:en(t.type,n),i),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(X&&256&t.flags&&_e(t.stateNode.containerInfo))}throw Error(a(163))}function xr(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.destroy;n.destroy=void 0,void 0!==i&&i()}n=n.next}while(n!==t)}}function wr(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var i=e.create;e.destroy=i()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var r=e;i=r.next,!!(4&(r=r.tag))&&!!(1&r)&&(sa(n,e),aa(n,e)),e=i}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(i=n.elementType===n.type?t.memoizedProps:en(n.type,t.memoizedProps),e.componentDidUpdate(i,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&bn(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=R(n.child.stateNode);break;case 1:e=n.child.stateNode}bn(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&me(e,n.type,n.memoizedProps,n));case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(Z&&null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&je(n)))))}throw Error(a(163))}function Cr(e,t){if(X)for(var n=e;;){if(5===n.tag){var i=n.stateNode;t?we(i):Se(n.stateNode,n.memoizedProps)}else if(6===n.tag)i=n.stateNode,t?Ce(i):ke(i,n.memoizedProps);else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Sr(e,t){if(dt&&"function"==typeof dt.onCommitFiberUnmount)try{dt.onCommitFiberUnmount(ut,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var i=n,r=i.destroy;if(i=i.tag,void 0!==r)if(4&i)sa(t,n);else{i=t;try{r()}catch(e){ua(i,e)}}n=n.next}while(n!==e)}break;case 1:if(br(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){ua(t,e)}break;case 5:br(t);break;case 4:X?Mr(e,t):Q&&Q&&(t=t.stateNode.containerInfo,e=Ie(t),Me(t,e))}}function kr(e,t){for(var n=t;;)if(Sr(e,n),null===n.child||X&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function _r(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Tr(e){return 5===e.tag||3===e.tag||4===e.tag}function Ir(e){if(X){e:{for(var t=e.return;null!==t;){if(Tr(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var i=!1;break;case 3:case 4:t=t.containerInfo,i=!0;break;default:throw Error(a(161))}16&n.flags&&(xe(t),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Tr(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}i?Pr(e,n,t):Nr(e,n,t)}}function Pr(e,t,n){var i=e.tag,r=5===i||6===i;if(r)e=r?e.stateNode:e.stateNode.instance,t?ye(n,e,t):he(n,e);else if(4!==i&&null!==(e=e.child))for(Pr(e,t,n),e=e.sibling;null!==e;)Pr(e,t,n),e=e.sibling}function Nr(e,t,n){var i=e.tag,r=5===i||6===i;if(r)e=r?e.stateNode:e.stateNode.instance,t?ge(n,e,t):pe(n,e);else if(4!==i&&null!==(e=e.child))for(Nr(e,t,n),e=e.sibling;null!==e;)Nr(e,t,n),e=e.sibling}function Mr(e,t){for(var n,i,r=t,o=!1;;){if(!o){o=r.return;e:for(;;){if(null===o)throw Error(a(160));switch(n=o.stateNode,o.tag){case 5:i=!1;break e;case 3:case 4:n=n.containerInfo,i=!0;break e}o=o.return}o=!0}if(5===r.tag||6===r.tag)kr(e,r),i?Ee(n,r.stateNode):be(n,r.stateNode);else if(4===r.tag){if(null!==r.child){n=r.stateNode.containerInfo,i=!0,r.child.return=r,r=r.child;continue}}else if(Sr(e,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;4===(r=r.return).tag&&(o=!1)}r.sibling.return=r.return,r=r.sibling}}function Ar(e,t){if(X){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void xr(3,t);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var r=t.type,o=t.updateQueue;t.updateQueue=null,null!==o&&ve(n,o,r,e,i,t)}return;case 6:if(null===t.stateNode)throw Error(a(162));return n=t.memoizedProps,void fe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(Z&&(t=t.stateNode,t.hydrate&&(t.hydrate=!1,Ve(t.containerInfo))));case 13:return Dr(t),void Rr(t);case 19:return void Rr(t);case 23:case 24:return void Cr(t,null!==t.memoizedState)}throw Error(a(163))}switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void xr(3,t);case 12:case 23:case 24:return;case 13:return Dr(t),void Rr(t);case 19:return void Rr(t);case 3:Z&&(n=t.stateNode).hydrate&&(n.hydrate=!1,Ve(n.containerInfo))}e:if(Q){switch(t.tag){case 1:case 5:case 6:case 20:break e;case 3:case 4:t=t.stateNode,Me(t.containerInfo,t.pendingChildren);break e}throw Error(a(163))}}function Dr(e){null!==e.memoizedState&&(po=Wt(),X&&Cr(e.child,!0))}function Rr(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new yr),t.forEach((function(t){var i=pa.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function Br(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&null!==(t=t.memoizedState)&&null===t.dehydrated}var Lr=0,Or=1,Fr=2,zr=3,Hr=4;if("function"==typeof Symbol&&Symbol.for){var Ur=Symbol.for;Lr=Ur("selector.component"),Or=Ur("selector.has_pseudo_class"),Fr=Ur("selector.role"),zr=Ur("selector.test_id"),Hr=Ur("selector.text")}function Wr(e){var t=J(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=oe(e)))throw Error(a(362));return e.stateNode.current}function Vr(e,t){switch(t.$$typeof){case Lr:if(e.type===t.value)return!0;break;case Or:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var i=e[n++],r=e[n++],o=t[r];if(5!==i.tag||!le(i)){for(;null!=o&&Vr(i,o);)o=t[++r];if(r===t.length){t=!0;break e}for(i=i.child;null!==i;)e.push(i,r),i=i.sibling}}t=!1}return t;case Fr:if(5===e.tag&&ce(e.stateNode,t.value))return!0;break;case Hr:if((5===e.tag||6===e.tag)&&null!==(e=se(e))&&0<=e.indexOf(t.value))return!0;break;case zr:if(5===e.tag&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(a(365,t))}return!1}function jr(e){switch(e.$$typeof){case Lr:return"<"+(T(e.value)||"Unknown")+">";case Or:return":has("+(jr(e)||"")+")";case Fr:return'[role="'+e.value+'"]';case Hr:return'"'+e.value+'"';case zr:return'[data-testname="'+e.value+'"]';default:throw Error(a(365,e))}}function Gr(e,t){var n=[];e=[e,0];for(var i=0;i<e.length;){var r=e[i++],o=e[i++],a=t[o];if(5!==r.tag||!le(r)){for(;null!=a&&Vr(r,a);)a=t[++o];if(o===t.length)n.push(r);else for(r=r.child;null!==r;)e.push(r,o),r=r.sibling}}return n}function qr(e,t){if(!re)throw Error(a(363));e=Gr(e=Wr(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var i=e[n++];if(5===i.tag)le(i)||t.push(i.stateNode);else for(i=i.child;null!==i;)e.push(i),i=i.sibling}return t}var Kr=null,Yr=Math.ceil,Xr=s.ReactCurrentDispatcher,Qr=s.ReactCurrentOwner,Zr=s.IsSomeRendererActing,Jr=0,$r=null,eo=null,to=0,no=0,io=Qe(0),ro=0,oo=null,ao=0,so=0,lo=0,co=0,uo=null,po=0,ho=1/0;function fo(){ho=Wt()+500}var mo,vo=null,go=!1,yo=null,bo=null,Eo=!1,xo=null,wo=90,Co=[],So=[],ko=null,_o=0,To=null,Io=-1,Po=0,No=0,Mo=null,Ro=!1;function Lo(){return 48&Jr?Wt():-1!==Io?Io:Io=Wt()}function Oo(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===Vt()?1:2;if(0===Po&&(Po=ao),0!==Xt.transition){0!==No&&(No=null!==uo?uo.pendingLanes:0),e=Po;var t=4186112&~No;return 0==(t&=-t)&&0==(t=(e=4186112&~e)&-e)&&(t=8192),t}return e=Vt(),e=gt(4&Jr&&98===e?12:e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Po)}function Fo(e,t,n){if(50<_o)throw _o=0,To=null,Error(a(185));if(null===(e=zo(e,t)))return null;Et(e,t,n),e===$r&&(lo|=t,4===ro&&Wo(e,to));var i=Vt();1===t?8&Jr&&!(48&Jr)?Vo(e):(Ho(e,n),0===Jr&&(fo(),Kt())):(!(4&Jr)||98!==i&&99!==i||(null===ko?ko=new Set([e]):ko.add(e)),Ho(e,n)),uo=e}function zo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Ho(e,t){for(var n=e.callbackNode,i=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-xt(s),c=1<<l,u=o[l];if(-1===u){if(!(c&i)||c&r){u=t,ft(c);var d=ht;o[l]=10<=d?u+250:6<=d?u+5e3:-1}}else u<=t&&(e.expiredLanes|=c);s&=~c}if(i=mt(e,e===$r?to:0),t=ht,0===i)null!==n&&(n!==Lt&&_t(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Lt&&_t(n)}15===t?(n=Vo.bind(null,e),null===Ft?(Ft=[n],zt=kt(Mt,Yt)):Ft.push(n),n=Lt):14===t?n=qt(99,Vo.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,e))}}(t),n=qt(n,Uo.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function Uo(e){if(Io=-1,No=Po=0,48&Jr)throw Error(a(327));var t=e.callbackNode;if(oa()&&e.callbackNode!==t)return null;var n=mt(e,e===$r?to:0);if(0===n)return null;var i=n,r=Jr;Jr|=16;var o=Qo();for($r===e&&to===i||(fo(),Yo(e,i));;)try{$o();break}catch(t){Xo(e,t)}if(an(),Xr.current=o,Jr=r,null!==eo?i=0:($r=null,to=0,i=ro),ao&lo)Yo(e,0);else if(0!==i){if(2===i&&(Jr|=64,e.hydrate&&(e.hydrate=!1,_e(e.containerInfo)),0!==(n=vt(e))&&(i=Zo(e,n))),1===i)throw t=oo,Yo(e,0),Wo(e,n),Ho(e,Wt()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,i){case 0:case 1:throw Error(a(345));case 2:case 5:na(e);break;case 3:if(Wo(e,n),(62914560&n)===n&&10<(i=po+500-Wt())){if(0!==mt(e,0))break;if(((r=e.suspendedLanes)&n)!==n){Lo(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=G(na.bind(null,e),i);break}na(e);break;case 4:if(Wo(e,n),(4186112&n)===n)break;for(i=e.eventTimes,r=-1;0<n;){var s=31-xt(n);o=1<<s,(s=i[s])>r&&(r=s),n&=~o}if(n=r,10<(n=(120>(n=Wt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Yr(n/1960))-n)){e.timeoutHandle=G(na.bind(null,e),n);break}na(e);break;default:throw Error(a(329))}}return Ho(e,Wt()),e.callbackNode===t?Uo.bind(null,e):null}function Wo(e,t){for(t&=~co,t&=~lo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-xt(t),i=1<<n;e[n]=-1,t&=~i}}function Vo(e){if(48&Jr)throw Error(a(327));if(oa(),e===$r&&e.expiredLanes&to){var t=to,n=Zo(e,t);ao&lo&&(n=Zo(e,t=mt(e,t)))}else n=Zo(e,t=mt(e,0));if(0!==e.tag&&2===n&&(Jr|=64,e.hydrate&&(e.hydrate=!1,_e(e.containerInfo)),0!==(t=vt(e))&&(n=Zo(e,t))),1===n)throw n=oo,Yo(e,0),Wo(e,t),Ho(e,Wt()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,na(e),Ho(e,Wt()),null}function jo(e,t){var n=Jr;Jr|=1;try{return e(t)}finally{0===(Jr=n)&&(fo(),Kt())}}function Go(e,t){var n=Jr;if(48&n)return e(t);Jr|=1;try{if(e)return Gt(99,e.bind(null,t))}finally{Jr=n,Kt()}}function qo(e,t){Je(io,no),no|=t,ao|=t}function Ko(){no=io.current,Ze(io)}function Yo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==K&&(e.timeoutHandle=K,q(n)),null!==eo)for(n=eo.return;null!==n;){var i=n;switch(i.tag){case 1:null!=(i=i.type.childContextTypes)&&ot();break;case 3:zn(),Ze(tt),Ze(et),ei();break;case 5:Un(i);break;case 4:zn();break;case 13:case 19:Ze(Wn);break;case 10:ln(i);break;case 23:case 24:Ko()}n=n.return}$r=e,eo=wa(e.current,null),to=no=ao=t,ro=0,oo=null,co=lo=so=0}function Xo(e,t){for(;;){var n=eo;try{if(an(),ti.current=Li,si){for(var i=ri.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}si=!1}if(ii=0,ai=oi=ri=null,li=!1,Qr.current=null,null===n||null===n.return){ro=1,oo=t,eo=null;break}e:{var o=e,a=n.return,s=n,l=t;if(t=to,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l;if(!(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.lanes=u.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=!!(1&Wn.current),p=a;do{var h;if(h=13===p.tag){var f=p.memoizedState;if(null!==f)h=null!==f.dehydrated;else{var m=p.memoizedProps;h=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!d)}}if(h){var v=p.updateQueue;if(null===v){var g=new Set;g.add(c),p.updateQueue=g}else v.add(c);if(!(2&p.mode)){if(p.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=mn(-1,1);y.tag=2,vn(s,y)}s.lanes|=1;break e}l=void 0,s=t;var b=o.pingCache;if(null===b?(b=o.pingCache=new mr,l=new Set,b.set(c,l)):void 0===(l=b.get(c))&&(l=new Set,b.set(c,l)),!l.has(s)){l.add(s);var E=da.bind(null,o,c,s);c.then(E,E)}p.flags|=4096,p.lanes=t;break e}p=p.return}while(null!==p);l=Error((T(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==ro&&(ro=2),l=fr(l,s),p=a;do{switch(p.tag){case 3:o=l,p.flags|=4096,t&=-t,p.lanes|=t,gn(p,vr(0,o,t));break e;case 1:o=l;var x=p.type,w=p.stateNode;if(!(64&p.flags||"function"!=typeof x.getDerivedStateFromError&&(null===w||"function"!=typeof w.componentDidCatch||null!==bo&&bo.has(w)))){p.flags|=4096,t&=-t,p.lanes|=t,gn(p,gr(p,o,t));break e}}p=p.return}while(null!==p)}ta(n)}catch(e){t=e,eo===n&&null!==n&&(eo=n=n.return);continue}break}}function Qo(){var e=Xr.current;return Xr.current=Li,null===e?Li:e}function Zo(e,t){var n=Jr;Jr|=16;var i=Qo();for($r===e&&to===t||Yo(e,t);;)try{Jo();break}catch(t){Xo(e,t)}if(an(),Jr=n,Xr.current=i,null!==eo)throw Error(a(261));return $r=null,to=0,ro}function Jo(){for(;null!==eo;)ea(eo)}function $o(){for(;null!==eo&&!Tt();)ea(eo)}function ea(e){var t=mo(e.alternate,e,no);e.memoizedProps=e.pendingProps,null===t?ta(e):eo=t,Qr.current=null}function ta(e){var t=e;do{var n=t.alternate;if(e=t.return,2048&t.flags){if(null!==(n=hr(t)))return n.flags&=2047,void(eo=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(n=pr(n,t,no)))return void(eo=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||1073741824&no||!(4&n.mode)){for(var i=0,r=n.child;null!==r;)i|=r.lanes|r.childLanes,r=r.sibling;n.childLanes=i}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(eo=t);eo=t=e}while(null!==t);0===ro&&(ro=5)}function na(e){var t=Vt();return Gt(99,ia.bind(null,e,t)),null}function ia(e,t){do{oa()}while(null!==xo);if(48&Jr)throw Error(a(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null;var i=n.lanes|n.childLanes,r=i,o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;for(var s=e.eventTimes,l=e.expirationTimes;0<o;){var c=31-xt(o),u=1<<c;r[c]=0,s[c]=-1,l[c]=-1,o&=~u}if(null!==ko&&!(24&i)&&ko.has(e)&&ko.delete(e),e===$r&&(eo=$r=null,to=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){r=Jr,Jr|=32,Qr.current=null,Mo=O(e.containerInfo),Ro=!1,vo=i;do{try{ra()}catch(e){if(null===vo)throw Error(a(330));ua(vo,e),vo=vo.nextEffect}}while(null!==vo);Mo=null,vo=i;do{try{for(s=e;null!==vo;){var d=vo.flags;if(16&d&&X&&xe(vo.stateNode),128&d){var p=vo.alternate;if(null!==p){var h=p.ref;null!==h&&("function"==typeof h?h(null):h.current=null)}}switch(1038&d){case 2:Ir(vo),vo.flags&=-3;break;case 6:Ir(vo),vo.flags&=-3,Ar(vo.alternate,vo);break;case 1024:vo.flags&=-1025;break;case 1028:vo.flags&=-1025,Ar(vo.alternate,vo);break;case 4:Ar(vo.alternate,vo);break;case 8:l=s,o=vo,X?Mr(l,o):kr(l,o);var f=o.alternate;_r(o),null!==f&&_r(f)}vo=vo.nextEffect}}catch(e){if(null===vo)throw Error(a(330));ua(vo,e),vo=vo.nextEffect}}while(null!==vo);Ro&&ne(),F(e.containerInfo),e.current=n,vo=i;do{try{for(d=e;null!==vo;){var m=vo.flags;if(36&m&&wr(d,vo.alternate,vo),128&m){p=void 0;var v=vo.ref;if(null!==v){var g=vo.stateNode;p=5===vo.tag?R(g):g,"function"==typeof v?v(p):v.current=p}}vo=vo.nextEffect}}catch(e){if(null===vo)throw Error(a(330));ua(vo,e),vo=vo.nextEffect}}while(null!==vo);vo=null,Ot(),Jr=r}else e.current=n;if(Eo)Eo=!1,xo=e,wo=t;else for(vo=i;null!==vo;)t=vo.nextEffect,vo.nextEffect=null,8&vo.flags&&((m=vo).sibling=null,m.stateNode=null),vo=t;if(0===(i=e.pendingLanes)&&(bo=null),1===i?e===To?_o++:(_o=0,To=e):_o=0,n=n.stateNode,dt&&"function"==typeof dt.onCommitFiberRoot)try{dt.onCommitFiberRoot(ut,n,void 0,!(64&~n.current.flags))}catch(e){}if(Ho(e,Wt()),go)throw go=!1,e=yo,yo=null,e;return!!(8&Jr)||Kt(),null}function ra(){for(;null!==vo;){var e=vo.alternate;Ro||null===Mo||(8&vo.flags?A(vo,Mo)&&(Ro=!0,te()):13===vo.tag&&Br(e,vo)&&A(vo,Mo)&&(Ro=!0,te()));var t=vo.flags;!!(256&t)&&Er(e,vo),!(512&t)||Eo||(Eo=!0,qt(97,(function(){return oa(),null}))),vo=vo.nextEffect}}function oa(){if(90!==wo){var e=97<wo?97:wo;return wo=90,Gt(e,la)}return!1}function aa(e,t){Co.push(t,e),Eo||(Eo=!0,qt(97,(function(){return oa(),null})))}function sa(e,t){So.push(t,e),Eo||(Eo=!0,qt(97,(function(){return oa(),null})))}function la(){if(null===xo)return!1;var e=xo;if(xo=null,48&Jr)throw Error(a(331));var t=Jr;Jr|=32;var n=So;So=[];for(var i=0;i<n.length;i+=2){var r=n[i],o=n[i+1],s=r.destroy;if(r.destroy=void 0,"function"==typeof s)try{s()}catch(e){if(null===o)throw Error(a(330));ua(o,e)}}for(n=Co,Co=[],i=0;i<n.length;i+=2){r=n[i],o=n[i+1];try{var l=r.create;r.destroy=l()}catch(e){if(null===o)throw Error(a(330));ua(o,e)}}for(l=e.current.firstEffect;null!==l;)e=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=e;return Jr=t,Kt(),!0}function ca(e,t,n){vn(e,t=vr(0,t=fr(n,t),1)),t=Lo(),null!==(e=zo(e,1))&&(Et(e,1,t),Ho(e,t))}function ua(e,t){if(3===e.tag)ca(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){ca(n,e,t);break}if(1===n.tag){var i=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===bo||!bo.has(i))){var r=gr(n,e=fr(t,e),1);if(vn(n,r),r=Lo(),null!==(n=zo(n,1)))Et(n,1,r),Ho(n,r);else if("function"==typeof i.componentDidCatch&&(null===bo||!bo.has(i)))try{i.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function da(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=Lo(),e.pingedLanes|=e.suspendedLanes&n,$r===e&&(to&n)===n&&(4===ro||3===ro&&(62914560&to)===to&&500>Wt()-po?Yo(e,0):co|=n),Ho(e,t)}function pa(e,t){var n=e.stateNode;null!==n&&n.delete(t),0==(t=0)&&(2&(t=e.mode)?4&t?(0===Po&&(Po=ao),0===(t=yt(62914560&~Po))&&(t=4194304)):t=99===Vt()?1:2:t=1),n=Lo(),null!==(e=zo(e,t))&&(Et(e,t,n),Ho(e,n))}mo=function(e,t,n){var i=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||tt.current)Ui=!0;else{if(!(n&i)){switch(Ui=!1,t.tag){case 3:Zi(t),Jn();break;case 5:Hn(t);break;case 1:rt(t.type)&&lt(t);break;case 4:Fn(t,t.stateNode.containerInfo);break;case 10:sn(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return n&t.child.childLanes?ir(e,t,n):(Je(Wn,1&Wn.current),null!==(t=lr(e,t,n))?t.sibling:null);Je(Wn,1&Wn.current);break;case 19:if(i=!!(n&t.childLanes),64&e.flags){if(i)return sr(e,t,n);t.flags|=64}var r=t.memoizedState;if(null!==r&&(r.rendering=null,r.tail=null,r.lastEffect=null),Je(Wn,Wn.current),i)break;return null;case 23:case 24:return t.lanes=0,qi(e,t,n)}return lr(e,t,n)}Ui=!!(16384&e.flags)}else Ui=!1;switch(t.lanes=0,t.tag){case 2:if(i=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=it(t,et.current),un(t,n),r=di(null,t,i,e,r,n),t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,rt(i)){var o=!0;lt(t)}else o=!1;t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,hn(t);var s=i.getDerivedStateFromProps;"function"==typeof s&&xn(t,i,s,e),r.updater=wn,t.stateNode=r,r._reactInternals=t,_n(t,i,e,n),t=Qi(null,t,i,!0,o,n)}else t.tag=0,Wi(null,t,r,n),t=t.child;return t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return xa(e)?1:0;if(null!=e){if((e=e.$$typeof)===m)return 11;if(e===y)return 14}return 2}(r),e=en(r,e),o){case 0:t=Yi(null,t,r,e,n);break e;case 1:t=Xi(null,t,r,e,n);break e;case 11:t=Vi(null,t,r,e,n);break e;case 14:t=ji(null,t,r,en(r.type,e),i,n);break e}throw Error(a(306,r,""))}return t;case 0:return i=t.type,r=t.pendingProps,Yi(e,t,i,r=t.elementType===i?r:en(i,r),n);case 1:return i=t.type,r=t.pendingProps,Xi(e,t,i,r=t.elementType===i?r:en(i,r),n);case 3:if(Zi(t),i=t.updateQueue,null===e||null===i)throw Error(a(282));if(i=t.pendingProps,r=null!==(r=t.memoizedState)?r.element:null,fn(e,t),yn(t,i,null,n),(i=t.memoizedState.element)===r)Jn(),t=lr(e,t,n);else{if((o=(r=t.stateNode).hydrate)&&(Z?(Gn=ze(t.stateNode.containerInfo),jn=t,o=qn=!0):o=!1),o){if(Z&&null!=(e=r.mutableSourceEagerHydrationData))for(r=0;r<e.length;r+=2)o=e[r],s=e[r+1],Y?o._workInProgressVersionPrimary=s:o._workInProgressVersionSecondary=s,$n.push(o);for(n=An(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Wi(e,t,i,n),Jn();t=t.child}return t;case 5:return Hn(t),null===e&&Xn(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,s=r.children,V(i,r)?s=null:null!==o&&V(i,o)&&(t.flags|=16),Ki(e,t),Wi(e,t,s,n),t.child;case 6:return null===e&&Xn(t),null;case 13:return ir(e,t,n);case 4:return Fn(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Mn(t,null,i,n):Wi(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Vi(e,t,i,r=t.elementType===i?r:en(i,r),n);case 7:return Wi(e,t,t.pendingProps,n),t.child;case 8:case 12:return Wi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,sn(t,o=r.value),null!==s){var l=s.value;if(0==(o=Qt(l,o)?0:0|("function"==typeof i._calculateChangedBits?i._calculateChangedBits(l,o):1073741823))){if(s.children===r.children&&!tt.current){t=lr(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){s=l.child;for(var u=c.firstContext;null!==u;){if(u.context===i&&u.observedBits&o){1===l.tag&&((u=mn(-1,n&-n)).tag=2,vn(l,u)),l.lanes|=n,null!==(u=l.alternate)&&(u.lanes|=n),cn(l.return,n),c.lanes|=n;break}u=u.next}}else s=10===l.tag&&l.type===t.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===t){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}}Wi(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=(o=t.pendingProps).children,un(t,n),i=i(r=dn(r,o.unstable_observedBits)),t.flags|=1,Wi(e,t,i,n),t.child;case 14:return o=en(r=t.type,t.pendingProps),ji(e,t,r,o=en(r.type,o),i,n);case 15:return Gi(e,t,t.type,t.pendingProps,i,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:en(i,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,rt(i)?(e=!0,lt(t)):e=!1,un(t,n),Sn(t,i,r),_n(t,i,r,n),Qi(null,t,i,!0,e,n);case 19:return sr(e,t,n);case 23:case 24:return qi(e,t,n)}throw Error(a(156,t.tag))};var ha={current:!1},fa=o.unstable_flushAllWithoutAsserting,ma="function"==typeof fa;function va(){if(void 0!==fa)return fa();for(var e=!1;oa();)e=!0;return e}function ga(e){try{va(),function(e){if(null===Kr)try{var t=("require"+Math.random()).slice(0,7);Kr=(Bo&&Bo[t]).call(Bo,"timers").setImmediate}catch(e){Kr=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}Kr(e)}((function(){va()?ga(e):e()}))}catch(t){e(t)}}var ya=0;function ba(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(e,t,n,i){return new ba(e,t,n,i)}function xa(e){return!(!(e=e.prototype)||!e.isReactComponent)}function wa(e,t){var n=e.alternate;return null===n?((n=Ea(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ca(e,t,n,i,r,o){var s=2;if(i=e,"function"==typeof e)xa(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case u:return Sa(n.children,r,o,t);case x:s=8,r|=16;break;case d:s=8,r|=1;break;case p:return(e=Ea(12,n,t,8|r)).elementType=p,e.type=p,e.lanes=o,e;case v:return(e=Ea(13,n,t,r)).type=v,e.elementType=v,e.lanes=o,e;case g:return(e=Ea(19,n,t,r)).elementType=g,e.lanes=o,e;case w:return ka(n,r,o,t);case C:return(e=Ea(24,n,t,r)).elementType=C,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case h:s=10;break e;case f:s=9;break e;case m:s=11;break e;case y:s=14;break e;case b:s=16,i=null;break e;case E:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ea(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Sa(e,t,n,i){return(e=Ea(7,e,i,t)).lanes=n,e}function ka(e,t,n,i){return(e=Ea(23,e,i,t)).elementType=w,e.lanes=n,e}function _a(e,t,n){return(e=Ea(6,e,null,t)).lanes=n,e}function Ta(e,t,n){return(t=Ea(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ia(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=K,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=bt(0),this.expirationTimes=bt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bt(0),Z&&(this.mutableSourceEagerHydrationData=null)}function Pa(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return null===(e=M(t))?null:e.stateNode}function Na(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Ma(e,t){Na(e,t),(e=e.alternate)&&Na(e,t)}function Aa(e){return null===(e=M(e))?null:e.stateNode}function Da(){return null}return n.IsThisRendererActing=ha,n.act=function(e){function t(){ya--,Zr.current=n,ha.current=i}ya++;var n=Zr.current,i=ha.current;Zr.current=!0,ha.current=!0;try{var r=jo(e)}catch(e){throw t(),e}if(null!==r&&"object"==typeof r&&"function"==typeof r.then)return{then:function(e,i){r.then((function(){1<ya||!0===ma&&!0===n?(t(),e()):ga((function(n){t(),n?i(n):e()}))}),(function(e){t(),i(e)}))}};try{1!==ya||!1!==ma&&!1!==n||va(),t()}catch(e){throw t(),e}return{then:function(e){e()}}},n.attemptContinuousHydration=function(e){13===e.tag&&(Fo(e,67108864,Lo()),Ma(e,67108864))},n.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Lo(),n=Oo(e);Fo(e,n,t),Ma(e,n)}},n.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.hydrate){var n=ft(t.pendingLanes);t.expiredLanes|=n&t.pendingLanes,Ho(t,Wt()),!(48&Jr)&&(fo(),Kt())}break;case 13:var i=Lo();Go((function(){return Fo(e,1,i)})),Ma(e,4)}},n.attemptUserBlockingHydration=function(e){13===e.tag&&(Fo(e,4,Lo()),Ma(e,4))},n.batchedEventUpdates=function(e,t){var n=Jr;Jr|=2;try{return e(t)}finally{0===(Jr=n)&&(fo(),Kt())}},n.batchedUpdates=jo,n.createComponentSelector=function(e){return{$$typeof:Lr,value:e}},n.createContainer=function(e,t,n){return e=new Ia(e,t,n),t=Ea(3,null,null,2===t?7:1===t?3:0),e.current=t,t.stateNode=e,hn(t),e},n.createHasPsuedoClassSelector=function(e){return{$$typeof:Or,value:e}},n.createPortal=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},n.createRoleSelector=function(e){return{$$typeof:Fr,value:e}},n.createTestNameSelector=function(e){return{$$typeof:zr,value:e}},n.createTextSelector=function(e){return{$$typeof:Hr,value:e}},n.deferredUpdates=function(e){return Gt(97,e)},n.discreteUpdates=function(e,t,n,i,r){var o=Jr;Jr|=4;try{return Gt(98,e.bind(null,t,n,i,r))}finally{0===(Jr=o)&&(fo(),Kt())}},n.findAllNodes=qr,n.findBoundingRects=function(e,t){if(!re)throw Error(a(363));t=qr(e,t),e=[];for(var n=0;n<t.length;n++)e.push(ae(t[n]));for(t=e.length-1;0<t;t--)for(var i=(n=e[t]).x,r=i+n.width,o=n.y,s=o+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,d=u+c.width,p=c.y,h=p+c.height;if(i>=u&&o>=p&&r<=d&&s<=h){e.splice(t,1);break}if(!(i!==u||n.width!==c.width||h<o||p>s)){p>o&&(c.height+=p-o,c.y=o),h<s&&(c.height=s-p),e.splice(t,1);break}if(!(o!==p||n.height!==c.height||d<i||u>r)){u>i&&(c.width+=u-i,c.x=i),d<r&&(c.width=r-u),e.splice(t,1);break}}return e},n.findHostInstance=Pa,n.findHostInstanceWithNoPortals=function(e){return e=function(e){if(!(e=N(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child&&4!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e),null===e?null:20===e.tag?e.stateNode.instance:e.stateNode},n.findHostInstanceWithWarning=function(e){return Pa(e)},n.flushControlled=function(e){var t=Jr;Jr|=1;try{Gt(99,e)}finally{0===(Jr=t)&&(fo(),Kt())}},n.flushDiscreteUpdates=function(){!(49&Jr)&&(function(){if(null!==ko){var e=ko;ko=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Ho(e,Wt())}))}Kt()}(),oa())},n.flushPassiveEffects=oa,n.flushSync=Go,n.focusWithin=function(e,t){if(!re)throw Error(a(363));for(t=Gr(e=Wr(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!le(n)){if(5===n.tag&&ue(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},n.getCurrentUpdateLanePriority=function(){return pt},n.getFindAllNodesFailureDescription=function(e,t){if(!re)throw Error(a(363));var n=0,i=[];e=[Wr(e),0];for(var r=0;r<e.length;){var o=e[r++],s=e[r++],l=t[s];if((5!==o.tag||!le(o))&&(Vr(o,l)&&(i.push(jr(l)),++s>n&&(n=s)),s<t.length))for(o=o.child;null!==o;)e.push(o,s),o=o.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(jr(t[n]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},n.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?R(e.child.stateNode):e.child.stateNode:null},n.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s.ReactCurrentDispatcher,findHostInstanceByFiber:Aa,findFiberByHostInstance:e.findFiberByHostInstance||Da,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null},"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t.isDisabled&&t.supportsFiber)try{ut=t.inject(e),dt=t}catch(e){}e=!0}return e},n.observeVisibleRects=function(e,t,n,i){if(!re)throw Error(a(363));e=qr(e,t);var r=de(e,n,i).disconnect;return{disconnect:function(){r()}}},n.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},n.runWithPriority=function(e,t){var n=pt;try{return pt=e,t()}finally{pt=n}},n.shouldSuspend=function(){return!1},n.unbatchedUpdates=function(e,t){var n=Jr;Jr&=-2,Jr|=8;try{return e(t)}finally{0===(Jr=n)&&(fo(),Kt())}},n.updateContainer=function(e,t,n,i){var r=t.current,o=Lo(),s=Oo(r);e:if(n){t:{if(I(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(rt(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(a(171))}if(1===n.tag){var c=n.type;if(rt(c)){n=st(n,c,l);break e}}n=l}else n=$e;return null===t.context?t.context=n:t.pendingContext=n,(t=mn(o,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),vn(r,t),Fo(r,s,o),s},n};var Oo={exports:{}},Fo={exports:{}},zo={},Ho=0;zo.__interactionsRef=null,zo.__subscriberRef=null,zo.unstable_clear=function(e){return e()},zo.unstable_getCurrent=function(){return null},zo.unstable_getThreadID=function(){return++Ho},zo.unstable_subscribe=function(){},zo.unstable_trace=function(e,t,n){return n()},zo.unstable_unsubscribe=function(){},zo.unstable_wrap=function(e){return e};var Uo={};
/** @license React v0.20.2
 * scheduler-tracing.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */!function(e){"production"!==process.env.NODE_ENV&&function(){var t=0,n=0;e.__interactionsRef=null,e.__subscriberRef=null,e.__interactionsRef={current:new Set},e.__subscriberRef={current:null};var i=null;function r(e){var t=!1,n=null;if(i.forEach((function(i){try{i.onInteractionTraced(e)}catch(e){t||(t=!0,n=e)}})),t)throw n}function o(e){var t=!1,n=null;if(i.forEach((function(i){try{i.onInteractionScheduledWorkCompleted(e)}catch(e){t||(t=!0,n=e)}})),t)throw n}function a(e,t){var n=!1,r=null;if(i.forEach((function(i){try{i.onWorkScheduled(e,t)}catch(e){n||(n=!0,r=e)}})),n)throw r}function s(e,t){var n=!1,r=null;if(i.forEach((function(i){try{i.onWorkStarted(e,t)}catch(e){n||(n=!0,r=e)}})),n)throw r}function l(e,t){var n=!1,r=null;if(i.forEach((function(i){try{i.onWorkStopped(e,t)}catch(e){n||(n=!0,r=e)}})),n)throw r}function c(e,t){var n=!1,r=null;if(i.forEach((function(i){try{i.onWorkCanceled(e,t)}catch(e){n||(n=!0,r=e)}})),n)throw r}i=new Set,e.unstable_clear=function(t){var n=e.__interactionsRef.current;e.__interactionsRef.current=new Set;try{return t()}finally{e.__interactionsRef.current=n}},e.unstable_getCurrent=function(){return e.__interactionsRef.current},e.unstable_getThreadID=function(){return++n},e.unstable_subscribe=function(t){i.add(t),1===i.size&&(e.__subscriberRef.current={onInteractionScheduledWorkCompleted:o,onInteractionTraced:r,onWorkCanceled:c,onWorkScheduled:a,onWorkStarted:s,onWorkStopped:l})},e.unstable_trace=function(n,i,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a={__count:1,id:t++,name:n,timestamp:i},s=e.__interactionsRef.current,l=new Set(s);l.add(a),e.__interactionsRef.current=l;var c,u=e.__subscriberRef.current;try{null!==u&&u.onInteractionTraced(a)}finally{try{null!==u&&u.onWorkStarted(l,o)}finally{try{c=r()}finally{e.__interactionsRef.current=s;try{null!==u&&u.onWorkStopped(l,o)}finally{a.__count--,null!==u&&0===a.__count&&u.onInteractionScheduledWorkCompleted(a)}}}}return c},e.unstable_unsubscribe=function(t){i.delete(t),0===i.size&&(e.__subscriberRef.current=null)},e.unstable_wrap=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.__interactionsRef.current,r=e.__subscriberRef.current;null!==r&&r.onWorkScheduled(i,n),i.forEach((function(e){e.__count++}));var o=!1;function a(){var a=e.__interactionsRef.current;e.__interactionsRef.current=i,r=e.__subscriberRef.current;try{var s;try{null!==r&&r.onWorkStarted(i,n)}finally{try{s=t.apply(void 0,arguments)}finally{e.__interactionsRef.current=a,null!==r&&r.onWorkStopped(i,n)}}return s}finally{o||(o=!0,i.forEach((function(e){e.__count--,null!==r&&0===e.__count&&r.onInteractionScheduledWorkCompleted(e)})))}}return a.cancel=function(){r=e.__subscriberRef.current;try{null!==r&&r.onWorkCanceled(i,n)}finally{i.forEach((function(e){e.__count--,r&&0===e.__count&&r.onInteractionScheduledWorkCompleted(e)}))}},a}}()}(Uo),"production"===process.env.NODE_ENV?Fo.exports=zo:Fo.exports=Uo
/** @license React v0.26.2
 * react-reconciler.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */,function(t){"production"!==process.env.NODE_ENV&&(t.exports=function(n){var i={},r=e,o=Ao,a=Do.exports,s=Fo.exports,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];d("warn",e,n)}function u(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];d("error",e,n)}function d(e,t,n){var i=l.ReactDebugCurrentFrame.getStackAddendum();""!==i&&(t+="%s",n=n.concat([i]));var r=n.map((function(e){return""+e}));r.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,r)}var p=10,h=11,f=12,m=13,v=14,g=15,y=17,b=19,E=20,x=22,w=23,C=24;function S(e){return e._reactInternals}var k=60103,_=60106,T=60107,I=60108,P=60114,N=60109,M=60110,A=60112,D=60113,R=60120,B=60115,L=60116,O=60121,F=60129,z=60130,H=60131;if("function"==typeof Symbol&&Symbol.for){var U=Symbol.for;k=U("react.element"),_=U("react.portal"),T=U("react.fragment"),I=U("react.strict_mode"),P=U("react.profiler"),N=U("react.provider"),M=U("react.context"),A=U("react.forward_ref"),D=U("react.suspense"),R=U("react.suspense_list"),B=U("react.memo"),L=U("react.lazy"),O=U("react.block"),U("react.server.block"),U("react.fundamental"),U("react.scope"),U("react.opaque.id"),F=U("react.debug_trace_mode"),z=U("react.offscreen"),H=U("react.legacy_hidden")}var W="function"==typeof Symbol&&Symbol.iterator;function V(e){if(null===e||"object"!=typeof e)return null;var t=W&&e[W]||e["@@iterator"];return"function"==typeof t?t:null}function j(e){return e.displayName||"Context"}function G(e){if(null==e)return null;if("number"==typeof e.tag&&u("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case _:return"Portal";case P:return"Profiler";case I:return"StrictMode";case D:return"Suspense";case R:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case M:return j(e)+".Consumer";case N:return j(e._context)+".Provider";case A:return r=e,a="ForwardRef",s=(o=e.render).displayName||o.name||"",r.displayName||(""!==s?a+"("+s+")":a);case B:return G(e.type);case O:return G(e._render);case L:var t=e,n=t._payload,i=t._init;try{return G(i(n))}catch(e){return null}}var r,o,a,s;return null}var q=64,K=128,Y=256,X=512,Q=8192,Z=1024,J=2048,$=4096,ee=16384,te=!1,ne=l.ReactCurrentOwner;function ie(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{var i=t;do{!!(1026&(t=i).flags)&&(n=t.return),i=t.return}while(i)}return 3===t.tag?n:null}function re(e){if(ie(e)!==e)throw Error("Unable to find node on an unmounted component.")}function oe(e){var t=e.alternate;if(!t){var n=ie(e);if(null===n)throw Error("Unable to find node on an unmounted component.");return n!==e?null:e}for(var i=e,r=t;;){var o=i.return;if(null===o)break;var a=o.alternate;if(null===a){var s=o.return;if(null!==s){i=r=s;continue}break}if(o.child===a.child){for(var l=o.child;l;){if(l===i)return re(o),e;if(l===r)return re(o),t;l=l.sibling}throw Error("Unable to find node on an unmounted component.")}if(i.return!==r.return)i=o,r=a;else{for(var c=!1,u=o.child;u;){if(u===i){c=!0,i=o,r=a;break}if(u===r){c=!0,r=o,i=a;break}u=u.sibling}if(!c){for(u=a.child;u;){if(u===i){c=!0,i=a,r=o;break}if(u===r){c=!0,r=a,i=o;break}u=u.sibling}if(!c)throw Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(i.alternate!==r)throw Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(3!==i.tag)throw Error("Unable to find node on an unmounted component.");return i.stateNode.current===i?e:t}function ae(e){var t=oe(e);if(!t)return null;for(var n=t;;){if(5===n.tag||6===n.tag)return n;if(n.child)n.child.return=n,n=n.child;else{if(n===t)return null;for(;!n.sibling;){if(!n.return||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}}return null}function se(e,t){for(var n=t,i=e.alternate;null!==n;){if(n===e||n===i)return!0;n=n.return}return!1}var le=n.getPublicInstance,ce=n.getRootHostContext,ue=n.getChildHostContext,de=n.prepareForCommit,pe=n.resetAfterCommit,he=n.createInstance,fe=n.appendInitialChild,me=n.finalizeInitialChildren,ve=n.prepareUpdate,ge=n.shouldSetTextContent,ye=n.createTextInstance,be=n.scheduleTimeout,Ee=n.cancelTimeout,xe=n.noTimeout;n.now;var we=n.isPrimaryRenderer,Ce=n.warnsIfNotActing,Se=n.supportsMutation,ke=n.supportsPersistence,_e=n.supportsHydration;n.getFundamentalComponentInstance,n.mountFundamentalComponent,n.shouldUpdateFundamentalComponent;var Te=n.getInstanceFromNode;n.isOpaqueHydratingObject;var Ie=n.makeOpaqueHydratingObject;n.makeClientId;var Pe=n.makeClientIdInDEV,Ne=n.beforeActiveInstanceBlur,Me=n.afterActiveInstanceBlur,Ae=n.preparePortalMount;n.preparePortalMount,n.getInstanceFromScope;var De=n.supportsTestSelectors,Re=n.findFiberRoot,Be=n.getBoundingRect,Le=n.getTextContent,Oe=n.isHiddenSubtree,Fe=n.matchAccessibilityRole,ze=n.setFocusIfFocusable,He=n.setupIntersectionObserver,Ue=n.appendChild,We=n.appendChildToContainer,Ve=n.commitTextUpdate,je=n.commitMount,Ge=n.commitUpdate,qe=n.insertBefore,Ke=n.insertInContainerBefore,Ye=n.removeChild,Xe=n.removeChildFromContainer,Qe=n.resetTextContent,Ze=n.hideInstance,Je=n.hideTextInstance,$e=n.unhideInstance,et=n.unhideTextInstance;n.updateFundamentalComponent,n.unmountFundamentalComponent;var tt=n.clearContainer,nt=n.cloneInstance,it=n.createContainerChildSet,rt=n.appendChildToContainerChildSet,ot=n.finalizeContainerChildren,at=n.replaceContainerChildren,st=n.cloneHiddenInstance,lt=n.cloneHiddenTextInstance;n.cloneInstance;var ct=n.canHydrateInstance,ut=n.canHydrateTextInstance;n.canHydrateSuspenseInstance;var dt=n.isSuspenseInstancePending,pt=n.isSuspenseInstanceFallback;n.registerSuspenseInstanceRetry;var ht=n.getNextHydratableSibling,ft=n.getFirstHydratableChild,mt=n.hydrateInstance,vt=n.hydrateTextInstance;n.hydrateSuspenseInstance;var gt=n.getNextHydratableInstanceAfterSuspenseInstance,yt=n.commitHydratedContainer,bt=n.commitHydratedSuspenseInstance;n.clearSuspenseBoundary,n.clearSuspenseBoundaryFromContainer;var Et,xt,wt,Ct,St,kt,_t,Tt=n.didNotMatchHydratedContainerTextInstance,It=n.didNotMatchHydratedTextInstance,Pt=n.didNotHydrateContainerInstance,Nt=n.didNotHydrateInstance,Mt=n.didNotFindHydratableContainerInstance,At=n.didNotFindHydratableContainerTextInstance,Dt=n.didNotFindHydratableContainerSuspenseInstance,Rt=n.didNotFindHydratableInstance,Bt=n.didNotFindHydratableTextInstance,Lt=n.didNotFindHydratableSuspenseInstance,Ot=0;function Ft(){}function zt(){if(0===Ot){Et=console.log,xt=console.info,wt=console.warn,Ct=console.error,St=console.group,kt=console.groupCollapsed,_t=console.groupEnd;var e={configurable:!0,enumerable:!0,value:Ft,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}Ot++}function Ht(){if(0==--Ot){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:o({},e,{value:Et}),info:o({},e,{value:xt}),warn:o({},e,{value:wt}),error:o({},e,{value:Ct}),group:o({},e,{value:St}),groupCollapsed:o({},e,{value:kt}),groupEnd:o({},e,{value:_t})})}Ot<0&&u("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}Ft.__reactDisabledLog=!0;var Ut,Wt=l.ReactCurrentDispatcher;function Vt(e,t,n){if(void 0===Ut)try{throw Error()}catch(e){var i=e.stack.trim().match(/\n( *(at )?)/);Ut=i&&i[1]||""}return"\n"+Ut+e}var jt,Gt=!1,qt="function"==typeof WeakMap?WeakMap:Map;function Kt(e,t){if(!e||Gt)return"";var n,i=jt.get(e);if(void 0!==i)return i;Gt=!0;var r,o=Error.prepareStackTrace;Error.prepareStackTrace=void 0,r=Wt.current,Wt.current=null,zt();try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(e){n=e}Reflect.construct(e,[],a)}else{try{a.call()}catch(e){n=e}e.call(a.prototype)}}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var s=t.stack.split("\n"),l=n.stack.split("\n"),c=s.length-1,u=l.length-1;c>=1&&u>=0&&s[c]!==l[u];)u--;for(;c>=1&&u>=0;c--,u--)if(s[c]!==l[u]){if(1!==c||1!==u)do{if(c--,--u<0||s[c]!==l[u]){var d="\n"+s[c].replace(" at new "," at ");return"function"==typeof e&&jt.set(e,d),d}}while(c>=1&&u>=0);break}}}finally{Gt=!1,Wt.current=r,Ht(),Error.prepareStackTrace=o}var p=e?e.displayName||e.name:"",h=p?Vt(p):"";return"function"==typeof e&&jt.set(e,h),h}function Yt(e,t,n){return Kt(e,!1)}function Xt(e,t,n){if(null==e)return"";if("function"==typeof e)return Kt(e,function(e){var t=e.prototype;return!(!t||!t.isReactComponent)}(e));if("string"==typeof e)return Vt(e);switch(e){case D:return Vt("Suspense");case R:return Vt("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case A:return Yt(e.render);case B:return Xt(e.type,t,n);case O:return Yt(e._render);case L:var i=e,r=i._payload,o=i._init;try{return Xt(o(r),t,n)}catch(e){}}return""}jt=new qt;var Qt={},Zt=l.ReactDebugCurrentFrame;function Jt(e){if(e){var t=e._owner,n=Xt(e.type,e._source,t?t.type:null);Zt.setExtraStackFrame(n)}else Zt.setExtraStackFrame(null)}function $t(e,t,n,i,r){var o=Function.call.bind(Object.prototype.hasOwnProperty);for(var a in e)if(o(e,a)){var s=void 0;try{if("function"!=typeof e[a]){var l=Error((i||"React class")+": "+n+" type `"+a+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[a]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw l.name="Invariant Violation",l}s=e[a](t,a,i,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){s=e}!s||s instanceof Error||(Jt(r),u("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",i||"React class",n,a,typeof s),Jt(null)),s instanceof Error&&!(s.message in Qt)&&(Qt[s.message]=!0,Jt(r),u("Failed %s type: %s",n,s.message),Jt(null))}}var en,tn=[];en=[];var nn,rn=-1;function on(e){return{current:e}}function an(e,t){rn<0?u("Unexpected pop."):(t!==en[rn]&&u("Unexpected Fiber popped."),e.current=tn[rn],tn[rn]=null,en[rn]=null,rn--)}function sn(e,t,n){rn++,tn[rn]=e.current,en[rn]=n,e.current=t}nn={};var ln={};Object.freeze(ln);var cn=on(ln),un=on(!1),dn=ln;function pn(e,t,n){return n&&vn(t)?dn:cn.current}function hn(e,t,n){var i=e.stateNode;i.__reactInternalMemoizedUnmaskedChildContext=t,i.__reactInternalMemoizedMaskedChildContext=n}function fn(e,t){var n=e.type,i=n.contextTypes;if(!i)return ln;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={};for(var a in i)o[a]=t[a];return $t(i,o,"context",G(n)||"Unknown"),r&&hn(e,t,o),o}function mn(){return un.current}function vn(e){return null!=e.childContextTypes}function gn(e){an(un,e),an(cn,e)}function yn(e){an(un,e),an(cn,e)}function bn(e,t,n){if(cn.current!==ln)throw Error("Unexpected context found on stack. This error is likely caused by a bug in React. Please file an issue.");sn(cn,t,e),sn(un,n,e)}function En(e,t,n){var i=e.stateNode,r=t.childContextTypes;if("function"!=typeof i.getChildContext){var a=G(t)||"Unknown";return nn[a]||(nn[a]=!0,u("%s.childContextTypes is specified but there is no getChildContext() method on the instance. You can either define getChildContext() on %s or remove childContextTypes from it.",a,a)),n}var s=i.getChildContext();for(var l in s)if(!(l in r))throw Error((G(t)||"Unknown")+'.getChildContext(): key "'+l+'" is not defined in childContextTypes.');return $t(r,s,"child context",G(t)||"Unknown"),o({},n,s)}function xn(e){var t=e.stateNode,n=t&&t.__reactInternalMemoizedMergedChildContext||ln;return dn=cn.current,sn(cn,n,e),sn(un,un.current,e),!0}function wn(e,t,n){var i=e.stateNode;if(!i)throw Error("Expected to have an instance by this point. This error is likely caused by a bug in React. Please file an issue.");if(n){var r=En(e,t,dn);i.__reactInternalMemoizedMergedChildContext=r,an(un,e),an(cn,e),sn(cn,r,e),sn(un,n,e)}else an(un,e),sn(un,n,e)}var Cn=null,Sn=null,kn=!1,_n="undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__;function Tn(e,t){if(Sn&&"function"==typeof Sn.onCommitFiberRoot)try{var n=(e.current.flags&q)===q;Sn.onCommitFiberRoot(Cn,e,t,n)}catch(e){kn||(kn=!0,u("React instrumentation encountered an error: %s",e))}}var In=a.unstable_now;if(null==s.__interactionsRef||null==s.__interactionsRef.current)throw Error("It is not supported to run the profiling version of a renderer (for example, `react-dom/profiling`) without also replacing the `scheduler/tracing` module with `scheduler/tracing-profiling`. Your bundler might have a setting for aliasing both modules. Learn more at https://reactjs.org/link/profiling");In();var Pn=15,Nn=10,Mn=3584,An=4186112,Dn=62914560,Rn=33554432,Bn=67108864,Ln=134217727,On=134217728,Fn=805306368,zn=1073741824,Hn=-1,Un=0;function Wn(){return Un}function Vn(e){Un=e}var jn=8;function Gn(e){if(1&e)return jn=Pn,1;if(2&e)return jn=14,2;if(4&e)return jn=13,4;var t=24&e;if(0!==t)return jn=12,t;if(32&e)return jn=11,32;var n=192&e;if(0!==n)return jn=Nn,n;if(256&e)return jn=9,256;var i=Mn&e;if(0!==i)return jn=8,i;if(4096&e)return jn=7,4096;var r=An&e;if(0!==r)return jn=6,r;var o=Dn&e;if(0!==o)return jn=5,o;if(e&Bn)return jn=4,Bn;if(e&On)return jn=3,On;var a=Fn&e;return 0!==a?(jn=2,a):zn&e?(jn=1,zn):(u("Should have found matching lanes. This is a bug in React."),jn=8,e)}function qn(e,t){var n=e.pendingLanes;if(0===n)return jn=0,0;var i=0,r=0,o=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==o)i=o,r=jn=Pn;else{var l=n&Ln;if(0!==l){var c=l&~a;if(0!==c)i=Gn(c),r=jn;else{var u=l&s;0!==u&&(i=Gn(u),r=jn)}}else{var d=n&~a;0!==d?(i=Gn(d),r=jn):0!==s&&(i=Gn(s),r=jn)}}if(0===i)return 0;if(i=n&function(e){return(function(e){var t=31-li(e);return t<0?0:1<<t}(e)<<1)-1}(i),0!==t&&t!==i&&!(t&a)){if(Gn(t),r<=jn)return t;jn=r}var p=e.entangledLanes;if(0!==p)for(var h=e.entanglements,f=i&p;f>0;){var m=$n(f),v=1<<m;i|=h[m],f&=~v}return i}function Kn(e,t){return Gn(e),jn>=Nn?t+250:jn>=6?t+5e3:Hn}function Yn(e){var t=-1073741825&e.pendingLanes;return 0!==t?t:t&zn?zn:0}function Xn(e){return!!(e&Ln)}function Qn(e){return(e&Dn)===e}function Zn(e,t){switch(e){case 0:break;case Pn:return 1;case 14:return 2;case 12:var n=Jn(24&~t);return 0===n?Zn(Nn,t):n;case Nn:var i=Jn(192&~t);return 0===i?Zn(8,t):i;case 8:var r=Jn(Mn&~t);return 0===r&&0===(r=Jn(An&~t))&&(r=Jn(Mn)),r;case 6:case 5:break;case 2:var o=Jn(Fn&~t);return 0===o&&(o=Jn(Fn)),o}throw Error("Invalid update priority: "+e+". This is a bug in React.")}function Jn(e){return function(e){return e&-e}(e)}function $n(e){return 31-li(e)}function ei(e,t){return!!(e&t)}function ti(e,t){return(e&t)===t}function ni(e,t){return e|t}function ii(e,t){return e&~t}function ri(e){for(var t=[],n=0;n<31;n++)t.push(e);return t}function oi(e,t,n){e.pendingLanes|=t;var i=t-1;e.suspendedLanes&=i,e.pingedLanes&=i,e.eventTimes[$n(t)]=n}function ai(e,t,n){e.pingedLanes|=e.suspendedLanes&t}function si(e,t){e.mutableReadLanes|=t&e.pendingLanes}var li=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(ci(e)/ui|0)|0},ci=Math.log,ui=Math.LN2,di=a.unstable_runWithPriority,pi=a.unstable_scheduleCallback,hi=a.unstable_cancelCallback,fi=a.unstable_shouldYield,mi=a.unstable_requestPaint,vi=a.unstable_now,gi=a.unstable_getCurrentPriorityLevel,yi=a.unstable_ImmediatePriority,bi=a.unstable_UserBlockingPriority,Ei=a.unstable_NormalPriority,xi=a.unstable_LowPriority,wi=a.unstable_IdlePriority;if(null==s.__interactionsRef||null==s.__interactionsRef.current)throw Error("It is not supported to run the profiling version of a renderer (for example, `react-dom/profiling`) without also replacing the `scheduler/tracing` module with `scheduler/tracing-profiling`. Your bundler might have a setting for aliasing both modules. Learn more at https://reactjs.org/link/profiling");var Ci={},Si=99,ki=98,_i=97,Ti=fi,Ii=void 0!==mi?mi:function(){},Pi=null,Ni=null,Mi=!1,Ai=vi(),Di=Ai<1e4?vi:function(){return vi()-Ai};function Ri(){switch(gi()){case yi:return Si;case bi:return ki;case Ei:return _i;case xi:return 96;case wi:return 95;default:throw Error("Unknown priority level.")}}function Bi(e){switch(e){case Si:return yi;case ki:return bi;case _i:return Ei;case 96:return xi;case 95:return wi;default:throw Error("Unknown priority level.")}}function Li(e,t){var n=Bi(e);return di(n,t)}function Oi(e,t,n){var i=Bi(e);return pi(i,t,n)}function Fi(e){e!==Ci&&hi(e)}function zi(){if(null!==Ni){var e=Ni;Ni=null,hi(e)}Hi()}function Hi(){if(!Mi&&null!==Pi){Mi=!0;var e=0;try{var t=Pi;Li(Si,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Pi=null}catch(t){throw null!==Pi&&(Pi=Pi.slice(e+1)),pi(yi,zi),t}finally{Mi=!1}}}var Ui=l.ReactCurrentBatchConfig,Wi="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Vi=Object.prototype.hasOwnProperty;function ji(e,t){if(Wi(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var r=0;r<n.length;r++)if(!Vi.call(t,n[r])||!Wi(e[n[r]],t[n[r]]))return!1;return!0}function Gi(e){switch(e._debugOwner&&e._debugOwner.type,e._debugSource,e.tag){case 5:return Vt(e.type);case 16:return Vt("Lazy");case m:return Vt("Suspense");case b:return Vt("SuspenseList");case 0:case 2:case g:return Yt(e.type);case h:return Yt(e.type.render);case x:return Yt(e.type._render);case 1:return Kt(e.type,!0);default:return""}}function qi(e){try{var t="",n=e;do{t+=Gi(n),n=n.return}while(n);return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}var Ki=l.ReactDebugCurrentFrame,Yi=null,Xi=!1;function Qi(){return null===Yi?"":qi(Yi)}function Zi(){Ki.getCurrentStack=null,Yi=null,Xi=!1}function Ji(e){Ki.getCurrentStack=Qi,Yi=e,Xi=!1}function $i(e){Xi=e}var er={recordUnsafeLifecycleWarnings:function(e,t){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(e,t){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}},tr=function(e){var t=[];return e.forEach((function(e){t.push(e)})),t.sort().join(", ")},nr=[],ir=[],rr=[],or=[],ar=[],sr=[],lr=new Set;er.recordUnsafeLifecycleWarnings=function(e,t){lr.has(e.type)||("function"==typeof t.componentWillMount&&!0!==t.componentWillMount.__suppressDeprecationWarning&&nr.push(e),1&e.mode&&"function"==typeof t.UNSAFE_componentWillMount&&ir.push(e),"function"==typeof t.componentWillReceiveProps&&!0!==t.componentWillReceiveProps.__suppressDeprecationWarning&&rr.push(e),1&e.mode&&"function"==typeof t.UNSAFE_componentWillReceiveProps&&or.push(e),"function"==typeof t.componentWillUpdate&&!0!==t.componentWillUpdate.__suppressDeprecationWarning&&ar.push(e),1&e.mode&&"function"==typeof t.UNSAFE_componentWillUpdate&&sr.push(e))},er.flushPendingUnsafeLifecycleWarnings=function(){var e=new Set;nr.length>0&&(nr.forEach((function(t){e.add(G(t.type)||"Component"),lr.add(t.type)})),nr=[]);var t=new Set;ir.length>0&&(ir.forEach((function(e){t.add(G(e.type)||"Component"),lr.add(e.type)})),ir=[]);var n=new Set;rr.length>0&&(rr.forEach((function(e){n.add(G(e.type)||"Component"),lr.add(e.type)})),rr=[]);var i=new Set;or.length>0&&(or.forEach((function(e){i.add(G(e.type)||"Component"),lr.add(e.type)})),or=[]);var r=new Set;ar.length>0&&(ar.forEach((function(e){r.add(G(e.type)||"Component"),lr.add(e.type)})),ar=[]);var o=new Set;sr.length>0&&(sr.forEach((function(e){o.add(G(e.type)||"Component"),lr.add(e.type)})),sr=[]),t.size>0&&u("Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move code with side effects to componentDidMount, and set initial state in the constructor.\n\nPlease update the following components: %s",tr(t)),i.size>0&&u("Using UNSAFE_componentWillReceiveProps in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state\n\nPlease update the following components: %s",tr(i)),o.size>0&&u("Using UNSAFE_componentWillUpdate in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n\nPlease update the following components: %s",tr(o)),e.size>0&&c("componentWillMount has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move code with side effects to componentDidMount, and set initial state in the constructor.\n* Rename componentWillMount to UNSAFE_componentWillMount to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",tr(e)),n.size>0&&c("componentWillReceiveProps has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state\n* Rename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",tr(n)),r.size>0&&c("componentWillUpdate has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",tr(r))};var cr=new Map,ur=new Set;function dr(e,t){if(e&&e.defaultProps){var n=o({},t),i=e.defaultProps;for(var r in i)void 0===n[r]&&(n[r]=i[r]);return n}return t}er.recordLegacyContextWarning=function(e,t){var n=function(e){for(var t=null,n=e;null!==n;)1&n.mode&&(t=n),n=n.return;return t}(e);if(null!==n){if(!ur.has(e.type)){var i=cr.get(n);(null!=e.type.contextTypes||null!=e.type.childContextTypes||null!==t&&"function"==typeof t.getChildContext)&&(void 0===i&&(i=[],cr.set(n,i)),i.push(e))}}else u("Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue.")},er.flushLegacyContextWarning=function(){cr.forEach((function(e,t){if(0!==e.length){var n=e[0],i=new Set;e.forEach((function(e){i.add(G(e.type)||"Component"),ur.add(e.type)}));var r=tr(i);try{Ji(n),u("Legacy context API has been detected within a strict-mode tree.\n\nThe old API will be supported in all 16.x releases, but applications using it should migrate to the new version.\n\nPlease update the following components: %s\n\nLearn more about this warning here: https://reactjs.org/link/legacy-context",r)}finally{Zi()}}}))},er.discardPendingWarnings=function(){nr=[],ir=[],rr=[],or=[],ar=[],sr=[],cr=new Map};var pr,hr=1073741823,fr=on(null);pr={};var mr=null,vr=null,gr=null,yr=!1;function br(){mr=null,vr=null,gr=null,yr=!1}function Er(){yr=!0}function xr(){yr=!1}function wr(e,t){var n=e.type._context;we?(sn(fr,n._currentValue,e),n._currentValue=t,void 0!==n._currentRenderer&&null!==n._currentRenderer&&n._currentRenderer!==pr&&u("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),n._currentRenderer=pr):(sn(fr,n._currentValue2,e),n._currentValue2=t,void 0!==n._currentRenderer2&&null!==n._currentRenderer2&&n._currentRenderer2!==pr&&u("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),n._currentRenderer2=pr)}function Cr(e){var t=fr.current;an(fr,e);var n=e.type._context;we?n._currentValue=t:n._currentValue2=t}function Sr(e,t){for(var n=e;null!==n;){var i=n.alternate;if(ti(n.childLanes,t)){if(null===i||ti(i.childLanes,t))break;i.childLanes=ni(i.childLanes,t)}else n.childLanes=ni(n.childLanes,t),null!==i&&(i.childLanes=ni(i.childLanes,t));n=n.return}}function kr(e,t){mr=e,vr=null,gr=null;var n=e.dependencies;null!==n&&null!==n.firstContext&&(ei(n.lanes,t)&&Sl(),n.firstContext=null)}function _r(e,t){if(yr&&u("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo()."),gr===e);else if(!1===t||0===t);else{var n;"number"!=typeof t||t===hr?(gr=e,n=hr):n=t;var i={context:e,observedBits:n,next:null};if(null===vr){if(null===mr)throw Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");vr=i,mr.dependencies={lanes:0,firstContext:i,responders:null}}else vr=vr.next=i}return we?e._currentValue:e._currentValue2}var Tr,Ir,Pr=2,Nr=!1;function Mr(e){var t={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null};e.updateQueue=t}function Ar(e,t){var n=t.updateQueue,i=e.updateQueue;if(n===i){var r={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects};t.updateQueue=r}}function Dr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rr(e,t){var n=e.updateQueue;if(null!==n){var i=n.shared,r=i.pending;null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ir!==i||Tr||(u("An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback."),Tr=!0)}}function Br(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i){var r=i.updateQueue;if(n===r){var o=null,a=null,s=n.firstBaseUpdate;if(null!==s){var l=s;do{var c={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};null===a?o=a=c:(a.next=c,a=c),l=l.next}while(null!==l);null===a?o=a=t:(a.next=t,a=t)}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}}var u=n.lastBaseUpdate;null===u?n.firstBaseUpdate=t:u.next=t,n.lastBaseUpdate=t}function Lr(e,t,n,i,r,a){switch(n.tag){case 1:var s=n.payload;if("function"==typeof s){Er();var l=s.call(a,i,r);if(1&e.mode){zt();try{s.call(a,i,r)}finally{Ht()}}return xr(),l}return s;case 3:e.flags=-4097&e.flags|q;case 0:var c,u=n.payload;if("function"==typeof u){if(Er(),c=u.call(a,i,r),1&e.mode){zt();try{u.call(a,i,r)}finally{Ht()}}xr()}else c=u;return null==c?i:o({},i,c);case Pr:return Nr=!0,i}return i}function Or(e,t,n,i){var r=e.updateQueue;Nr=!1,Ir=r.shared;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;if(null!==u){var d=u.updateQueue,p=d.lastBaseUpdate;p!==a&&(null===p?d.firstBaseUpdate=c:p.next=c,d.lastBaseUpdate=l)}}if(null!==o){for(var h=r.baseState,f=0,m=null,v=null,g=null,y=o;;){var b=y.lane,E=y.eventTime;if(ti(i,b)){if(null!==g){var x={eventTime:E,lane:0,tag:y.tag,payload:y.payload,callback:y.callback,next:null};g=g.next=x}if(h=Lr(e,0,y,h,t,n),null!==y.callback){e.flags|=32;var w=r.effects;null===w?r.effects=[y]:w.push(y)}}else{var C={eventTime:E,lane:b,tag:y.tag,payload:y.payload,callback:y.callback,next:null};null===g?(v=g=C,m=h):g=g.next=C,f=ni(f,b)}if(null===(y=y.next)){if(null===(s=r.shared.pending))break;var S=s,k=S.next;S.next=null,y=k,r.lastBaseUpdate=S,r.shared.pending=null}}null===g&&(m=h),r.baseState=m,r.firstBaseUpdate=v,r.lastBaseUpdate=g,ju(f),e.lanes=f,e.memoizedState=h}Ir=null}function Fr(e,t){if("function"!=typeof e)throw Error("Invalid argument passed as callback. Expected a function. Instead received: "+e);e.call(t)}function zr(){Nr=!1}function Hr(){return Nr}function Ur(e,t,n){var i=t.effects;if(t.effects=null,null!==i)for(var r=0;r<i.length;r++){var o=i[r],a=o.callback;null!==a&&(o.callback=null,Fr(a,n))}}Tr=!1,Ir=null;var Wr,Vr,jr,Gr,qr,Kr,Yr,Xr,Qr,Zr,Jr={},$r=Array.isArray,eo=(new r.Component).refs;Wr=new Set,Vr=new Set,jr=new Set,Gr=new Set,Xr=new Set,qr=new Set,Qr=new Set,Zr=new Set;var to=new Set;function no(e,t,n,i){var r=e.memoizedState;if(1&e.mode){zt();try{n(i,r)}finally{Ht()}}var a=n(i,r);Kr(t,a);var s=null==a?r:o({},r,a);e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}Yr=function(e,t){if(null!==e&&"function"!=typeof e){var n=t+"_"+e;to.has(n)||(to.add(n),u("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",t,e))}},Kr=function(e,t){if(void 0===t){var n=G(e)||"Component";qr.has(n)||(qr.add(n),u("%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",n))}},Object.defineProperty(Jr,"_processChildContext",{enumerable:!1,value:function(){throw Error("_processChildContext is not available in React 16+. This likely means you have multiple copies of React and are attempting to nest a React 15 tree inside a React 16 tree using unstable_renderSubtreeIntoContainer, which isn't supported. Try to make sure you have only one copy of React (and ideally, switch to ReactDOM.createPortal).")}}),Object.freeze(Jr);var io,ro,oo,ao,so,lo,co={isMounted:function(e){var t=ne.current;if(null!==t&&1===t.tag){var n=t,i=n.stateNode;i._warnedAboutRefsInRender||u("%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",G(n.type)||"A component"),i._warnedAboutRefsInRender=!0}var r=S(e);return!!r&&ie(r)===r},enqueueSetState:function(e,t,n){var i=S(e),r=_u(),o=Tu(i),a=Dr(r,o);a.payload=t,null!=n&&(Yr(n,"setState"),a.callback=n),Rr(i,a),Iu(i,o,r)},enqueueReplaceState:function(e,t,n){var i=S(e),r=_u(),o=Tu(i),a=Dr(r,o);a.tag=1,a.payload=t,null!=n&&(Yr(n,"replaceState"),a.callback=n),Rr(i,a),Iu(i,o,r)},enqueueForceUpdate:function(e,t){var n=S(e),i=_u(),r=Tu(n),o=Dr(i,r);o.tag=Pr,null!=t&&(Yr(t,"forceUpdate"),o.callback=t),Rr(n,o),Iu(n,r,i)}};function uo(e,t,n,i,r,o,a){var s=e.stateNode;if("function"==typeof s.shouldComponentUpdate){if(1&e.mode){zt();try{s.shouldComponentUpdate(i,o,a)}finally{Ht()}}var l=s.shouldComponentUpdate(i,o,a);return void 0===l&&u("%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",G(t)||"Component"),l}return!(t.prototype&&t.prototype.isPureReactComponent&&ji(n,i)&&ji(r,o))}function po(e,t){var n;t.updater=co,e.stateNode=t,n=e,t._reactInternals=n,t._reactInternalInstance=Jr}function ho(e,t,n){var i=!1,r=ln,o=ln,a=t.contextType;if("contextType"in t&&null!==a&&(void 0===a||a.$$typeof!==M||void 0!==a._context)&&!Zr.has(t)){Zr.add(t);var s;s=void 0===a?" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":"object"!=typeof a?" However, it is set to a "+typeof a+".":a.$$typeof===N?" Did you accidentally pass the Context.Provider instead?":void 0!==a._context?" Did you accidentally pass the Context.Consumer instead?":" However, it is set to an object with keys {"+Object.keys(a).join(", ")+"}.",u("%s defines an invalid contextType. contextType should point to the Context object returned by React.createContext().%s",G(t)||"Component",s)}"object"==typeof a&&null!==a?o=_r(a):(r=pn(0,t,!0),o=(i=null!=t.contextTypes)?fn(e,r):ln);if(1&e.mode){zt();try{new t(n,o)}finally{Ht()}}var l=new t(n,o),c=e.memoizedState=null!==l.state&&void 0!==l.state?l.state:null;if(po(e,l),"function"==typeof t.getDerivedStateFromProps&&null===c){var d=G(t)||"Component";Vr.has(d)||(Vr.add(d),u("`%s` uses `getDerivedStateFromProps` but its initial state is %s. This is not recommended. Instead, define the initial state by assigning an object to `this.state` in the constructor of `%s`. This ensures that `getDerivedStateFromProps` arguments have a consistent shape.",d,null===l.state?"null":"undefined",d))}if("function"==typeof t.getDerivedStateFromProps||"function"==typeof l.getSnapshotBeforeUpdate){var p=null,h=null,f=null;if("function"==typeof l.componentWillMount&&!0!==l.componentWillMount.__suppressDeprecationWarning?p="componentWillMount":"function"==typeof l.UNSAFE_componentWillMount&&(p="UNSAFE_componentWillMount"),"function"==typeof l.componentWillReceiveProps&&!0!==l.componentWillReceiveProps.__suppressDeprecationWarning?h="componentWillReceiveProps":"function"==typeof l.UNSAFE_componentWillReceiveProps&&(h="UNSAFE_componentWillReceiveProps"),"function"==typeof l.componentWillUpdate&&!0!==l.componentWillUpdate.__suppressDeprecationWarning?f="componentWillUpdate":"function"==typeof l.UNSAFE_componentWillUpdate&&(f="UNSAFE_componentWillUpdate"),null!==p||null!==h||null!==f){var m=G(t)||"Component",v="function"==typeof t.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";Gr.has(m)||(Gr.add(m),u("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n%s uses %s but also contains the following legacy lifecycles:%s%s%s\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://reactjs.org/link/unsafe-component-lifecycles",m,v,null!==p?"\n  "+p:"",null!==h?"\n  "+h:"",null!==f?"\n  "+f:""))}}return i&&hn(e,r,o),l}function fo(e,t,n,i){var r=t.state;if("function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==r){var o=G(e.type)||"Component";Wr.has(o)||(Wr.add(o),u("%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",o)),co.enqueueReplaceState(t,t.state,null)}}function mo(e,t,n,i){!function(e,t,n){var i=e.stateNode,r=G(t)||"Component";i.render||(t.prototype&&"function"==typeof t.prototype.render?u("%s(...): No `render` method found on the returned component instance: did you accidentally return an object from the constructor?",r):u("%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",r)),!i.getInitialState||i.getInitialState.isReactClassApproved||i.state||u("getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",r),i.getDefaultProps&&!i.getDefaultProps.isReactClassApproved&&u("getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",r),i.propTypes&&u("propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",r),i.contextType&&u("contextType was defined as an instance property on %s. Use a static property to define contextType instead.",r),i.contextTypes&&u("contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",r),t.contextType&&t.contextTypes&&!Qr.has(t)&&(Qr.add(t),u("%s declares both contextTypes and contextType static properties. The legacy contextTypes property will be ignored.",r)),"function"==typeof i.componentShouldUpdate&&u("%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",r),t.prototype&&t.prototype.isPureReactComponent&&void 0!==i.shouldComponentUpdate&&u("%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",G(t)||"A pure component"),"function"==typeof i.componentDidUnmount&&u("%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",r),"function"==typeof i.componentDidReceiveProps&&u("%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",r),"function"==typeof i.componentWillRecieveProps&&u("%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",r),"function"==typeof i.UNSAFE_componentWillRecieveProps&&u("%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",r);var o=i.props!==n;void 0!==i.props&&o&&u("%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",r,r),i.defaultProps&&u("Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",r,r),"function"!=typeof i.getSnapshotBeforeUpdate||"function"==typeof i.componentDidUpdate||jr.has(t)||(jr.add(t),u("%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",G(t))),"function"==typeof i.getDerivedStateFromProps&&u("%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",r),"function"==typeof i.getDerivedStateFromError&&u("%s: getDerivedStateFromError() is defined as an instance method and will be ignored. Instead, declare it as a static method.",r),"function"==typeof t.getSnapshotBeforeUpdate&&u("%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",r);var a=i.state;a&&("object"!=typeof a||$r(a))&&u("%s.state: must be set to an object or null",r),"function"==typeof i.getChildContext&&"object"!=typeof t.childContextTypes&&u("%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",r)}(e,t,n);var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=eo,Mr(e);var o=t.contextType;if("object"==typeof o&&null!==o)r.context=_r(o);else{var a=pn(0,t,!0);r.context=fn(e,a)}if(r.state===n){var s=G(t)||"Component";Xr.has(s)||(Xr.add(s),u("%s: It is not recommended to assign props directly to state because updates to props won't be reflected in state. In most cases, it is better to use props directly.",s))}1&e.mode&&er.recordLegacyContextWarning(e,r),er.recordUnsafeLifecycleWarnings(e,r),Or(e,n,r,i),r.state=e.memoizedState;var l=t.getDerivedStateFromProps;"function"==typeof l&&(no(e,t,l,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(function(e,t){var n=t.state;"function"==typeof t.componentWillMount&&t.componentWillMount(),"function"==typeof t.UNSAFE_componentWillMount&&t.UNSAFE_componentWillMount(),n!==t.state&&(u("%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",G(e.type)||"Component"),co.enqueueReplaceState(t,t.state,null))}(e,r),Or(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4)}io=!1,ro=!1,oo={},ao={},so={},lo=function(e,t){if(null!==e&&"object"==typeof e&&e._store&&!e._store.validated&&null==e.key){if("object"!=typeof e._store)throw Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");e._store.validated=!0;var n=G(t.type)||"Component";ao[n]||(ao[n]=!0,u('Each child in a list should have a unique "key" prop. See https://reactjs.org/link/warning-keys for more information.'))}};var vo=Array.isArray;function go(e,t,n){var i=n.ref;if(null!==i&&"function"!=typeof i&&"object"!=typeof i){if(1&e.mode&&(!n._owner||!n._self||n._owner.stateNode===n._self)){var r=G(e.type)||"Component";oo[r]||(u('A string ref, "%s", has been found within a strict mode tree. String refs are a source of potential bugs and should be avoided. We recommend using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',i),oo[r]=!0)}if(n._owner){var o,a=n._owner;if(a){var s=a;if(1!==s.tag)throw Error("Function components cannot have string refs. We recommend using useRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref");o=s.stateNode}if(!o)throw Error("Missing owner for string ref "+i+". This error is likely caused by a bug in React. Please file an issue.");var l=""+i;if(null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===l)return t.ref;var c=function(e){var t=o.refs;t===eo&&(t=o.refs={}),null===e?delete t[l]:t[l]=e};return c._stringRef=l,c}if("string"!=typeof i)throw Error("Expected ref to be a function, a string, an object returned by React.createRef(), or null.");if(!n._owner)throw Error("Element ref was specified as a string ("+i+") but no owner was set. This could happen for one of the following reasons:\n1. You may be adding a ref to a function component\n2. You may be adding a ref to a component that was not created inside a component's render method\n3. You have multiple copies of React loaded\nSee https://reactjs.org/link/refs-must-have-owner for more information.")}return i}function yo(e,t){if("textarea"!==e.type)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}function bo(e){var t=G(e.type)||"Component";so[t]||(so[t]=!0,u("Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it."))}function Eo(e){function t(t,n){if(e){var i=t.lastEffect;null!==i?(i.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,i){if(!e)return null;for(var r=i;null!==r;)t(n,r),r=r.sibling;return null}function i(e,t){for(var n=new Map,i=t;null!==i;)null!==i.key?n.set(i.key,i):n.set(i.index,i),i=i.sibling;return n}function r(e,t){var n=rp(e,t);return n.index=0,n.sibling=null,n}function o(t,n,i){if(t.index=i,!e)return n;var r=t.alternate;if(null!==r){var o=r.index;return o<n?(t.flags=2,n):o}return t.flags=2,n}function a(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,i){if(null===t||6!==t.tag){var o=up(n,e.mode,i);return o.return=e,o}var a=r(t,n);return a.return=e,a}function l(e,t,n,i){if(null!==t&&(t.elementType===n.type||Vd(t,n))){var o=r(t,n.props);return o.ref=go(e,t,n),o.return=e,o._debugSource=n._source,o._debugOwner=n._owner,o}var a=sp(n,e.mode,i);return a.ref=go(e,t,n),a.return=e,a}function c(e,t,n,i){if(null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation){var o=dp(n,e.mode,i);return o.return=e,o}var a=r(t,n.children||[]);return a.return=e,a}function d(e,t,n,i,o){if(null===t||7!==t.tag){var a=lp(n,e.mode,i,o);return a.return=e,a}var s=r(t,n);return s.return=e,s}function p(e,t,n){if("string"==typeof t||"number"==typeof t){var i=up(""+t,e.mode,n);return i.return=e,i}if("object"==typeof t&&null!==t){switch(t.$$typeof){case k:var r=sp(t,e.mode,n);return r.ref=go(e,null,t),r.return=e,r;case _:var o=dp(t,e.mode,n);return o.return=e,o}if(vo(t)||V(t)){var a=lp(t,e.mode,n,null);return a.return=e,a}yo(e,t)}return"function"==typeof t&&bo(e),null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:s(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===r?n.type===T?d(e,t,n.props.children,i,r):l(e,t,n,i):null;case _:return n.key===r?c(e,t,n,i):null}if(vo(n)||V(n))return null!==r?null:d(e,t,n,i,null);yo(e,n)}return"function"==typeof n&&bo(e),null}function m(e,t,n,i,r){if("string"==typeof i||"number"==typeof i)return s(t,e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case k:var o=e.get(null===i.key?n:i.key)||null;return i.type===T?d(t,o,i.props.children,r,i.key):l(t,o,i,r);case _:return c(t,e.get(null===i.key?n:i.key)||null,i,r)}if(vo(i)||V(i))return d(t,e.get(n)||null,i,r,null);yo(t,i)}return"function"==typeof i&&bo(t),null}function v(e,t,n){if("object"!=typeof e||null===e)return t;switch(e.$$typeof){case k:case _:lo(e,n);var i=e.key;if("string"!=typeof i)break;if(null===t){(t=new Set).add(i);break}if(!t.has(i)){t.add(i);break}u("Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted — the behavior is unsupported and could change in a future version.",i)}return t}return function(s,l,c,d){var y="object"==typeof c&&null!==c&&c.type===T&&null===c.key;y&&(c=c.props.children);var b="object"==typeof c&&null!==c;if(b)switch(c.$$typeof){case k:return a(function(e,i,o,a){for(var s=o.key,l=i;null!==l;){if(l.key===s){if(7===l.tag){if(o.type===T){n(e,l.sibling);var c=r(l,o.props.children);return c.return=e,c._debugSource=o._source,c._debugOwner=o._owner,c}}else if(l.elementType===o.type||Vd(l,o)){n(e,l.sibling);var u=r(l,o.props);return u.ref=go(e,l,o),u.return=e,u._debugSource=o._source,u._debugOwner=o._owner,u}n(e,l);break}t(e,l),l=l.sibling}if(o.type===T){var d=lp(o.props.children,e.mode,a,o.key);return d.return=e,d}var p=sp(o,e.mode,a);return p.ref=go(e,i,o),p.return=e,p}(s,l,c,d));case _:return a(function(e,i,o,a){for(var s=o.key,l=i;null!==l;){if(l.key===s){if(4===l.tag&&l.stateNode.containerInfo===o.containerInfo&&l.stateNode.implementation===o.implementation){n(e,l.sibling);var c=r(l,o.children||[]);return c.return=e,c}n(e,l);break}t(e,l),l=l.sibling}var u=dp(o,e.mode,a);return u.return=e,u}(s,l,c,d))}if("string"==typeof c||"number"==typeof c)return a(function(e,t,i,o){if(null!==t&&6===t.tag){n(e,t.sibling);var a=r(t,i);return a.return=e,a}n(e,t);var s=up(i,e.mode,o);return s.return=e,s}(s,l,""+c,d));if(vo(c))return function(r,a,s,l){for(var c=null,u=0;u<s.length;u++)c=v(s[u],c,r);for(var d=null,h=null,g=a,y=0,b=0,E=null;null!==g&&b<s.length;b++){g.index>b?(E=g,g=null):E=g.sibling;var x=f(r,g,s[b],l);if(null===x){null===g&&(g=E);break}e&&g&&null===x.alternate&&t(r,g),y=o(x,y,b),null===h?d=x:h.sibling=x,h=x,g=E}if(b===s.length)return n(r,g),d;if(null===g){for(;b<s.length;b++){var w=p(r,s[b],l);null!==w&&(y=o(w,y,b),null===h?d=w:h.sibling=w,h=w)}return d}for(var C=i(0,g);b<s.length;b++){var S=m(C,r,b,s[b],l);null!==S&&(e&&null!==S.alternate&&C.delete(null===S.key?b:S.key),y=o(S,y,b),null===h?d=S:h.sibling=S,h=S)}return e&&C.forEach((function(e){return t(r,e)})),d}(s,l,c,d);if(V(c))return function(r,a,s,l){var c=V(s);if("function"!=typeof c)throw Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");"function"==typeof Symbol&&"Generator"===s[Symbol.toStringTag]&&(ro||u("Using Generators as children is unsupported and will likely yield unexpected results because enumerating a generator mutates it. You may convert it to an array with `Array.from()` or the `[...spread]` operator before rendering. Keep in mind you might need to polyfill these features for older browsers."),ro=!0),s.entries===c&&(io||u("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),io=!0);var d=c.call(s);if(d)for(var h=null,g=d.next();!g.done;g=d.next())h=v(g.value,h,r);var y=c.call(s);if(null==y)throw Error("An iterable object provided no iterator.");for(var b=null,E=null,x=a,w=0,C=0,S=null,k=y.next();null!==x&&!k.done;C++,k=y.next()){x.index>C?(S=x,x=null):S=x.sibling;var _=f(r,x,k.value,l);if(null===_){null===x&&(x=S);break}e&&x&&null===_.alternate&&t(r,x),w=o(_,w,C),null===E?b=_:E.sibling=_,E=_,x=S}if(k.done)return n(r,x),b;if(null===x){for(;!k.done;C++,k=y.next()){var T=p(r,k.value,l);null!==T&&(w=o(T,w,C),null===E?b=T:E.sibling=T,E=T)}return b}for(var I=i(0,x);!k.done;C++,k=y.next()){var P=m(I,r,C,k.value,l);null!==P&&(e&&null!==P.alternate&&I.delete(null===P.key?C:P.key),w=o(P,w,C),null===E?b=P:E.sibling=P,E=P)}return e&&I.forEach((function(e){return t(r,e)})),b}(s,l,c,d);if(b&&yo(s,c),"function"==typeof c&&bo(s),void 0===c&&!y)switch(s.tag){case 1:if(s.stateNode.render._isMockFunction)break;case x:case 0:case h:case g:throw Error((G(s.type)||"Component")+"(...): Nothing was returned from render. This usually means a return statement is missing. Or, to render nothing, return null.")}return n(s,l)}}var xo=Eo(!0),wo=Eo(!1);function Co(e,t){for(var n=e.child;null!==n;)op(n,t),n=n.sibling}var So={},ko=on(So),_o=on(So),To=on(So);function Io(e){if(e===So)throw Error("Expected host context to exist. This error is likely caused by a bug in React. Please file an issue.");return e}function Po(){return Io(To.current)}function No(e,t){sn(To,t,e),sn(_o,e,e),sn(ko,So,e);var n=ce(t);an(ko,e),sn(ko,n,e)}function Mo(e){an(ko,e),an(_o,e),an(To,e)}function Ro(){return Io(ko.current)}function Bo(e){var t=Io(To.current),n=Io(ko.current),i=ue(n,e.type,t);n!==i&&(sn(_o,e,e),sn(ko,i,e))}function Lo(e){_o.current===e&&(an(ko,e),an(_o,e))}var Oo=on(0);function zo(e,t){return!!(e&t)}function Ho(e){return 1&e}function Uo(e,t){return 1&e|t}function Wo(e,t){sn(Oo,t,e)}function Vo(e){an(Oo,e)}function jo(e,t){var n=e.memoizedState;if(null!==n)return null!==n.dehydrated;var i=e.memoizedProps;return void 0!==i.fallback&&(!0!==i.unstable_avoidThisFallback||!t)}function Go(e){for(var t=e;null!==t;){if(t.tag===m){var n=t.memoizedState;if(null!==n){var i=n.dehydrated;if(null===i||dt(i)||pt(i))return t}}else if(t.tag===b&&void 0!==t.memoizedProps.revealOrder){if(t.flags&q)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)return null;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qo=null,Ko=null,Yo=!1;function Xo(e,t){switch(e.tag){case 3:Pt(e.stateNode.containerInfo,t);break;case 5:Nt(e.type,e.memoizedProps,e.stateNode,t)}var n,i=((n=np(5,null,null,0)).elementType="DELETED",n.type="DELETED",n);i.stateNode=t,i.return=e,i.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function Qo(e,t){switch(t.flags=-1025&t.flags|2,e.tag){case 3:var n=e.stateNode.containerInfo;switch(t.tag){case 5:var i=t.type,r=t.pendingProps;Mt(n,i,r);break;case 6:var o=t.pendingProps;At(n,o);break;case m:Dt(n)}break;case 5:var a=e.type,s=e.memoizedProps,l=e.stateNode;switch(t.tag){case 5:var c=t.type,u=t.pendingProps;Rt(a,s,l,c,u);break;case 6:var d=t.pendingProps;Bt(a,s,l,d);break;case m:Lt(a,s,l)}break;default:return}}function Zo(e,t){switch(e.tag){case 5:var n=e.type,i=e.pendingProps,r=ct(t,n,i);return null!==r&&(e.stateNode=r,!0);case 6:var o=e.pendingProps,a=ut(t,o);return null!==a&&(e.stateNode=a,!0);default:return!1}}function Jo(e){if(Yo){var t=Ko;if(!t)return Qo(qo,e),Yo=!1,void(qo=e);var n=t;if(!Zo(e,t)){if(!(t=ht(n))||!Zo(e,t))return Qo(qo,e),Yo=!1,void(qo=e);Xo(qo,n)}qo=e,Ko=ft(t)}}function $o(e){for(var t=e.return;null!==t&&5!==t.tag&&3!==t.tag&&t.tag!==m;)t=t.return;qo=t}function ea(e){if(!_e)return!1;if(e!==qo)return!1;if(!Yo)return $o(e),Yo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!ge(t,e.memoizedProps))for(var n=Ko;n;)Xo(e,n),n=ht(n);return $o(e),Ko=e.tag===m?function(e){if(!_e)throw Error("Expected skipPastDehydratedSuspenseInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");var t=e.memoizedState,n=null!==t?t.dehydrated:null;if(!n)throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");return gt(n)}(e):qo?ht(e.stateNode):null,!0}function ta(){_e&&(qo=null,Ko=null,Yo=!1)}function na(){return Yo}var ia,ra=[];function oa(){for(var e=0;e<ra.length;e++){var t=ra[e];we?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}ra.length=0}function aa(e,t){we?e._workInProgressVersionPrimary=t:e._workInProgressVersionSecondary=t,ra.push(e)}ia={};var sa,la,ca=l.ReactCurrentDispatcher,ua=l.ReactCurrentBatchConfig;la={},sa=new Set;var da=0,pa=null,ha=null,fa=null,ma=!1,va=!1,ga=null,ya=null,ba=-1,Ea=!1;function xa(){var e=ga;null===ya?ya=[e]:ya.push(e)}function wa(){var e=ga;null!==ya&&(ba++,ya[ba]!==e&&function(e){var t=G(pa.type);if(!sa.has(t)&&(sa.add(t),null!==ya)){for(var n="",i=0;i<=ba;i++){for(var r=ya[i],o=i===ba?e:r,a=i+1+". "+r;a.length<30;)a+=" ";n+=a+=o+"\n"}u("React has detected a change in the order of Hooks called by %s. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks\n\n   Previous render            Next render\n   ------------------------------------------------------\n%s   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",t,n)}}(e))}function Ca(e){null==e||Array.isArray(e)||u("%s received a final argument that is not an array (instead, received `%s`). When specified, the final argument must be an array.",ga,typeof e)}function Sa(){throw Error("Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:\n1. You might have mismatching versions of React and the renderer (such as React DOM)\n2. You might be breaking the Rules of Hooks\n3. You might have more than one copy of React in the same app\nSee https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.")}function ka(e,t){if(Ea)return!1;if(null===t)return u("%s received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.",ga),!1;e.length!==t.length&&u("The final argument passed to %s changed size between renders. The order and size of this array must remain constant.\n\nPrevious: %s\nIncoming: %s",ga,"["+t.join(", ")+"]","["+e.join(", ")+"]");for(var n=0;n<t.length&&n<e.length;n++)if(!Wi(e[n],t[n]))return!1;return!0}function _a(e,t,n,i,r,o){da=o,pa=t,ya=null!==e?e._debugHookTypes:null,ba=-1,Ea=null!==e&&e.type!==t.type,t.memoizedState=null,t.updateQueue=null,t.lanes=0,null!==e&&null!==e.memoizedState?ca.current=xs:ca.current=null!==ya?Es:bs;var a=n(i,r);if(va){var s=0;do{if(va=!1,!(s<25))throw Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");s+=1,Ea=!1,ha=null,fa=null,t.updateQueue=null,ba=-1,ca.current=ws,a=n(i,r)}while(va)}ca.current=ys,t._debugHookTypes=ya;var l=null!==ha&&null!==ha.next;if(da=0,pa=null,ha=null,fa=null,ga=null,ya=null,ba=-1,ma=!1,l)throw Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");return a}function Ta(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes=ii(e.lanes,n)}function Ia(){if(ca.current=ys,ma){for(var e=pa.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ma=!1}da=0,pa=null,ha=null,fa=null,ya=null,ba=-1,ga=null,ps=!1,va=!1}function Pa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fa?pa.memoizedState=fa=e:fa=fa.next=e,fa}function Na(){var e,t;if(null===ha){var n=pa.alternate;e=null!==n?n.memoizedState:null}else e=ha.next;if(null!==(t=null===fa?pa.memoizedState:fa.next))t=(fa=t).next,ha=e;else{if(null===e)throw Error("Rendered more hooks than during the previous render.");var i={memoizedState:(ha=e).memoizedState,baseState:ha.baseState,baseQueue:ha.baseQueue,queue:ha.queue,next:null};null===fa?pa.memoizedState=fa=i:fa=fa.next=i}return fa}function Ma(e,t){return"function"==typeof t?t(e):t}function Aa(e,t,n){var i,r=Pa();i=void 0!==n?n(t):t,r.memoizedState=r.baseState=i;var o=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},a=o.dispatch=gs.bind(null,pa,o);return[r.memoizedState,a]}function Da(e,t,n){var i=Na(),r=i.queue;if(null===r)throw Error("Should have a queue. This is likely a bug in React. Please file an issue.");r.lastRenderedReducer=e;var o=ha,a=o.baseQueue,s=r.pending;if(null!==s){if(null!==a){var l=a.next,c=s.next;a.next=c,s.next=l}o.baseQueue!==a&&u("Internal error: Expected work-in-progress queue to be a clone. This is a bug in React."),o.baseQueue=a=s,r.pending=null}if(null!==a){var d=a.next,p=o.baseState,h=null,f=null,m=null,v=d;do{var g=v.lane;if(ti(da,g)){if(null!==m){var y={lane:0,action:v.action,eagerReducer:v.eagerReducer,eagerState:v.eagerState,next:null};m=m.next=y}p=v.eagerReducer===e?v.eagerState:e(p,v.action)}else{var b={lane:g,action:v.action,eagerReducer:v.eagerReducer,eagerState:v.eagerState,next:null};null===m?(f=m=b,h=p):m=m.next=b,pa.lanes=ni(pa.lanes,g),ju(g)}v=v.next}while(null!==v&&v!==d);null===m?h=p:m.next=f,Wi(p,i.memoizedState)||Sl(),i.memoizedState=p,i.baseState=h,i.baseQueue=m,r.lastRenderedState=p}var E=r.dispatch;return[i.memoizedState,E]}function Ra(e,t,n){var i=Na(),r=i.queue;if(null===r)throw Error("Should have a queue. This is likely a bug in React. Please file an issue.");r.lastRenderedReducer=e;var o=r.dispatch,a=r.pending,s=i.memoizedState;if(null!==a){r.pending=null;var l=a.next,c=l;do{s=e(s,c.action),c=c.next}while(c!==l);Wi(s,i.memoizedState)||Sl(),i.memoizedState=s,null===i.baseQueue&&(i.baseState=s),r.lastRenderedState=s}return[s,o]}function Ba(e,t,n){var i;i=t,we?null==i._currentPrimaryRenderer?i._currentPrimaryRenderer=ia:i._currentPrimaryRenderer!==ia&&u("Detected multiple renderers concurrently rendering the same mutable source. This is currently unsupported."):null==i._currentSecondaryRenderer?i._currentSecondaryRenderer=ia:i._currentSecondaryRenderer!==ia&&u("Detected multiple renderers concurrently rendering the same mutable source. This is currently unsupported.");var r=(0,t._getVersion)(t._source),o=!1,a=function(e){return we?e._workInProgressVersionPrimary:e._workInProgressVersionSecondary}(t);if(null!==a?o=a===r:(o=ti(da,e.mutableReadLanes))&&aa(t,r),o){var s=n(t._source);return"function"==typeof s&&u("Mutable source should not return a function as the snapshot value. Functions may close over mutable values and cause tearing."),s}throw function(e){ra.push(e)}(t),Error("Cannot read from mutable source during the current render without tearing. This is a bug in React. Please file an issue.")}function La(e,t,n,i){var r=Vc;if(null===r)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");var o=t._getVersion,a=o(t._source),s=ca.current,l=s.useState((function(){return Ba(r,t,n)})),c=l[0],d=l[1],p=c,h=fa,f=e.memoizedState,m=f.refs,v=m.getSnapshot,g=f.source,y=f.subscribe,b=pa;if(e.memoizedState={refs:m,source:t,subscribe:i},s.useEffect((function(){m.getSnapshot=n,m.setSnapshot=d;var e=o(t._source);if(!Wi(a,e)){var i=n(t._source);if("function"==typeof i&&u("Mutable source should not return a function as the snapshot value. Functions may close over mutable values and cause tearing."),!Wi(p,i)){d(i);var s=Tu(b);si(r,s)}!function(e,t){e.entangledLanes|=t;for(var n=e.entanglements,i=t;i>0;){var r=$n(i),o=1<<r;n[r]|=t,i&=~o}}(r,r.mutableReadLanes)}}),[n,t,i]),s.useEffect((function(){var e=i(t._source,(function(){var e=m.getSnapshot,n=m.setSnapshot;try{n(e(t._source));var i=Tu(b);si(r,i)}catch(e){n((function(){throw e}))}}));return"function"!=typeof e&&u("Mutable source subscribe function must return an unsubscribe function."),e}),[t,i]),!Wi(v,n)||!Wi(g,t)||!Wi(y,i)){var E={pending:null,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:p};E.dispatch=d=gs.bind(null,pa,E),h.queue=E,h.baseQueue=null,p=Ba(r,t,n),h.memoizedState=h.baseState=p}return p}function Oa(e,t,n){var i=Pa();return i.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},La(i,e,t,n)}function Fa(e,t,n){return La(Na(),e,t,n)}function za(e){var t=Pa();"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e;var n=t.queue={pending:null,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:e},i=n.dispatch=gs.bind(null,pa,n);return[t.memoizedState,i]}function Ha(e){return Da(Ma)}function Ua(e){return Ra(Ma)}function Wa(e,t,n,i){var r={tag:e,create:t,destroy:n,deps:i,next:null},o=pa.updateQueue;if(null===o)o={lastEffect:null},pa.updateQueue=o,o.lastEffect=r.next=r;else{var a=o.lastEffect;if(null===a)o.lastEffect=r.next=r;else{var s=a.next;a.next=r,r.next=s,o.lastEffect=r}}return r}function Va(e){var t=Pa(),n={current:e};return Object.seal(n),t.memoizedState=n,n}function ja(e){return Na().memoizedState}function Ga(e,t,n,i){var r=Pa(),o=void 0===i?null:i;pa.flags|=e,r.memoizedState=Wa(1|t,n,void 0,o)}function qa(e,t,n,i){var r=Na(),o=void 0===i?null:i,a=void 0;if(null!==ha){var s=ha.memoizedState;if(a=s.destroy,null!==o&&ka(o,s.deps))return void Wa(t,n,a,o)}pa.flags|=e,r.memoizedState=Wa(1|t,n,a,o)}function Ka(e,t){return"undefined"!=typeof jest&&xd(pa),Ga(516,4,e,t)}function Ya(e,t){return"undefined"!=typeof jest&&xd(pa),qa(516,4,e,t)}function Xa(e,t){return Ga(4,2,e,t)}function Qa(e,t){return qa(4,2,e,t)}function Za(e,t){if("function"==typeof t){var n=t,i=e();return n(i),function(){n(null)}}if(null!=t){var r=t;r.hasOwnProperty("current")||u("Expected useImperativeHandle() first argument to either be a ref callback or React.createRef() object. Instead received: %s.","an object with keys {"+Object.keys(r).join(", ")+"}");var o=e();return r.current=o,function(){r.current=null}}}function Ja(e,t,n){"function"!=typeof t&&u("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",null!==t?typeof t:"null");var i=null!=n?n.concat([e]):null;return Ga(4,2,Za.bind(null,t,e),i)}function $a(e,t,n){"function"!=typeof t&&u("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",null!==t?typeof t:"null");var i=null!=n?n.concat([e]):null;return qa(4,2,Za.bind(null,t,e),i)}var es=function(e,t){};function ts(e,t){var n=void 0===t?null:t;return Pa().memoizedState=[e,n],e}function ns(e,t){var n=Na(),i=void 0===t?null:t,r=n.memoizedState;return null!==r&&null!==i&&ka(i,r[1])?r[0]:(n.memoizedState=[e,i],e)}function is(e,t){var n=Pa(),i=void 0===t?null:t,r=e();return n.memoizedState=[r,i],r}function rs(e,t){var n=Na(),i=void 0===t?null:t,r=n.memoizedState;if(null!==r&&null!==i&&ka(i,r[1]))return r[0];var o=e();return n.memoizedState=[o,i],o}function os(e){var t=za(e),n=t[0],i=t[1];return Ka((function(){var t=ua.transition;ua.transition=1;try{i(e)}finally{ua.transition=t}}),[e]),n}function as(e){var t=Ha(),n=t[0],i=t[1];return Ya((function(){var t=ua.transition;ua.transition=1;try{i(e)}finally{ua.transition=t}}),[e]),n}function ss(e){var t=Ua(),n=t[0],i=t[1];return Ya((function(){var t=ua.transition;ua.transition=1;try{i(e)}finally{ua.transition=t}}),[e]),n}function ls(e,t){var n=Ri();Li(n<ki?ki:n,(function(){e(!0)})),Li(n>_i?_i:n,(function(){var n=ua.transition;ua.transition=1;try{e(!1),t()}finally{ua.transition=n}}))}function cs(){var e=za(!1),t=e[0],n=e[1],i=ls.bind(null,n);return Va(i),[i,t]}function us(){var e=Ha()[0];return[ja().current,e]}function ds(){var e=Ua()[0];return[ja().current,e]}var ps=!1;function hs(e){var t=G(e.type)||"Unknown";Xi&&!la[t]&&(u("The object passed back from useOpaqueIdentifier is meant to be passed through to attributes only. Do not read the value directly."),la[t]=!0)}function fs(){var e=Pe.bind(null,hs.bind(null,pa));if(na()){var t=!1,n=pa,i=Ie((function(){throw t||(t=!0,ps=!0,r(e()),ps=!1,hs(n)),Error("The object passed back from useOpaqueIdentifier is meant to be passed through to attributes only. Do not read the value directly.")})),r=za(i)[1];return!(2&pa.mode)&&(pa.flags|=516,Wa(5,(function(){r(e())}),void 0,null)),i}var o=e();return za(o),o}function ms(){return Ha()[0]}function vs(){return Ua()[0]}function gs(e,t,n){"function"==typeof arguments[3]&&u("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var i=_u(),r=Tu(e),o={lane:r,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;null===a?o.next=o:(o.next=a.next,a.next=o),t.pending=o;var s=e.alternate;if(e===pa||null!==s&&s===pa)va=ma=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)){var l=t.lastRenderedReducer;if(null!==l){var c;c=ca.current,ca.current=Ss;try{var d=t.lastRenderedState,p=l(d,n);if(o.eagerReducer=l,o.eagerState=p,Wi(p,d))return}catch(e){}finally{ca.current=c}}}"undefined"!=typeof jest&&(Ed(e),wd(e)),Iu(e,r,i)}}var ys={readContext:_r,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useLayoutEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useMutableSource:Sa,useOpaqueIdentifier:Sa,unstable_isNewReconciler:te},bs=null,Es=null,xs=null,ws=null,Cs=null,Ss=null,ks=null,_s=function(){u("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().")},Ts=function(){u("Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. You can only call Hooks at the top level of your React function. For more information, see https://reactjs.org/link/rules-of-hooks")};bs={readContext:function(e,t){return _r(e,t)},useCallback:function(e,t){return ga="useCallback",xa(),Ca(t),ts(e,t)},useContext:function(e,t){return ga="useContext",xa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",xa(),Ca(t),Ka(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",xa(),Ca(n),Ja(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",xa(),Ca(t),Xa(e,t)},useMemo:function(e,t){ga="useMemo",xa(),Ca(t);var n=ca.current;ca.current=Cs;try{return is(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",xa();var i=ca.current;ca.current=Cs;try{return Aa(e,t,n)}finally{ca.current=i}},useRef:function(e){return ga="useRef",xa(),Va(e)},useState:function(e){ga="useState",xa();var t=ca.current;ca.current=Cs;try{return za(e)}finally{ca.current=t}},useDebugValue:function(e,t){ga="useDebugValue",xa()},useDeferredValue:function(e){return ga="useDeferredValue",xa(),os(e)},useTransition:function(){return ga="useTransition",xa(),cs()},useMutableSource:function(e,t,n){return ga="useMutableSource",xa(),Oa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",xa(),fs()},unstable_isNewReconciler:te},Es={readContext:function(e,t){return _r(e,t)},useCallback:function(e,t){return ga="useCallback",wa(),ts(e,t)},useContext:function(e,t){return ga="useContext",wa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",wa(),Ka(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",wa(),Ja(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",wa(),Xa(e,t)},useMemo:function(e,t){ga="useMemo",wa();var n=ca.current;ca.current=Cs;try{return is(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",wa();var i=ca.current;ca.current=Cs;try{return Aa(e,t,n)}finally{ca.current=i}},useRef:function(e){return ga="useRef",wa(),Va(e)},useState:function(e){ga="useState",wa();var t=ca.current;ca.current=Cs;try{return za(e)}finally{ca.current=t}},useDebugValue:function(e,t){ga="useDebugValue",wa()},useDeferredValue:function(e){return ga="useDeferredValue",wa(),os(e)},useTransition:function(){return ga="useTransition",wa(),cs()},useMutableSource:function(e,t,n){return ga="useMutableSource",wa(),Oa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",wa(),fs()},unstable_isNewReconciler:te},xs={readContext:function(e,t){return _r(e,t)},useCallback:function(e,t){return ga="useCallback",wa(),ns(e,t)},useContext:function(e,t){return ga="useContext",wa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",wa(),Ya(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",wa(),$a(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",wa(),Qa(e,t)},useMemo:function(e,t){ga="useMemo",wa();var n=ca.current;ca.current=Ss;try{return rs(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",wa();var i=ca.current;ca.current=Ss;try{return Da(e)}finally{ca.current=i}},useRef:function(e){return ga="useRef",wa(),ja()},useState:function(e){ga="useState",wa();var t=ca.current;ca.current=Ss;try{return Ha()}finally{ca.current=t}},useDebugValue:function(e,t){return ga="useDebugValue",wa(),es()},useDeferredValue:function(e){return ga="useDeferredValue",wa(),as(e)},useTransition:function(){return ga="useTransition",wa(),us()},useMutableSource:function(e,t,n){return ga="useMutableSource",wa(),Fa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",wa(),ms()},unstable_isNewReconciler:te},ws={readContext:function(e,t){return _r(e,t)},useCallback:function(e,t){return ga="useCallback",wa(),ns(e,t)},useContext:function(e,t){return ga="useContext",wa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",wa(),Ya(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",wa(),$a(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",wa(),Qa(e,t)},useMemo:function(e,t){ga="useMemo",wa();var n=ca.current;ca.current=ks;try{return rs(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",wa();var i=ca.current;ca.current=ks;try{return Ra(e)}finally{ca.current=i}},useRef:function(e){return ga="useRef",wa(),ja()},useState:function(e){ga="useState",wa();var t=ca.current;ca.current=ks;try{return Ua()}finally{ca.current=t}},useDebugValue:function(e,t){return ga="useDebugValue",wa(),es()},useDeferredValue:function(e){return ga="useDeferredValue",wa(),ss(e)},useTransition:function(){return ga="useTransition",wa(),ds()},useMutableSource:function(e,t,n){return ga="useMutableSource",wa(),Fa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",wa(),vs()},unstable_isNewReconciler:te},Cs={readContext:function(e,t){return _s(),_r(e,t)},useCallback:function(e,t){return ga="useCallback",Ts(),xa(),ts(e,t)},useContext:function(e,t){return ga="useContext",Ts(),xa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",Ts(),xa(),Ka(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",Ts(),xa(),Ja(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",Ts(),xa(),Xa(e,t)},useMemo:function(e,t){ga="useMemo",Ts(),xa();var n=ca.current;ca.current=Cs;try{return is(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",Ts(),xa();var i=ca.current;ca.current=Cs;try{return Aa(e,t,n)}finally{ca.current=i}},useRef:function(e){return ga="useRef",Ts(),xa(),Va(e)},useState:function(e){ga="useState",Ts(),xa();var t=ca.current;ca.current=Cs;try{return za(e)}finally{ca.current=t}},useDebugValue:function(e,t){ga="useDebugValue",Ts(),xa()},useDeferredValue:function(e){return ga="useDeferredValue",Ts(),xa(),os(e)},useTransition:function(){return ga="useTransition",Ts(),xa(),cs()},useMutableSource:function(e,t,n){return ga="useMutableSource",Ts(),xa(),Oa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",Ts(),xa(),fs()},unstable_isNewReconciler:te},Ss={readContext:function(e,t){return _s(),_r(e,t)},useCallback:function(e,t){return ga="useCallback",Ts(),wa(),ns(e,t)},useContext:function(e,t){return ga="useContext",Ts(),wa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",Ts(),wa(),Ya(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",Ts(),wa(),$a(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",Ts(),wa(),Qa(e,t)},useMemo:function(e,t){ga="useMemo",Ts(),wa();var n=ca.current;ca.current=Ss;try{return rs(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",Ts(),wa();var i=ca.current;ca.current=Ss;try{return Da(e)}finally{ca.current=i}},useRef:function(e){return ga="useRef",Ts(),wa(),ja()},useState:function(e){ga="useState",Ts(),wa();var t=ca.current;ca.current=Ss;try{return Ha()}finally{ca.current=t}},useDebugValue:function(e,t){return ga="useDebugValue",Ts(),wa(),es()},useDeferredValue:function(e){return ga="useDeferredValue",Ts(),wa(),as(e)},useTransition:function(){return ga="useTransition",Ts(),wa(),us()},useMutableSource:function(e,t,n){return ga="useMutableSource",Ts(),wa(),Fa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",Ts(),wa(),ms()},unstable_isNewReconciler:te},ks={readContext:function(e,t){return _s(),_r(e,t)},useCallback:function(e,t){return ga="useCallback",Ts(),wa(),ns(e,t)},useContext:function(e,t){return ga="useContext",Ts(),wa(),_r(e,t)},useEffect:function(e,t){return ga="useEffect",Ts(),wa(),Ya(e,t)},useImperativeHandle:function(e,t,n){return ga="useImperativeHandle",Ts(),wa(),$a(e,t,n)},useLayoutEffect:function(e,t){return ga="useLayoutEffect",Ts(),wa(),Qa(e,t)},useMemo:function(e,t){ga="useMemo",Ts(),wa();var n=ca.current;ca.current=Ss;try{return rs(e,t)}finally{ca.current=n}},useReducer:function(e,t,n){ga="useReducer",Ts(),wa();var i=ca.current;ca.current=Ss;try{return Ra(e)}finally{ca.current=i}},useRef:function(e){return ga="useRef",Ts(),wa(),ja()},useState:function(e){ga="useState",Ts(),wa();var t=ca.current;ca.current=Ss;try{return Ua()}finally{ca.current=t}},useDebugValue:function(e,t){return ga="useDebugValue",Ts(),wa(),es()},useDeferredValue:function(e){return ga="useDeferredValue",Ts(),wa(),ss(e)},useTransition:function(){return ga="useTransition",Ts(),wa(),ds()},useMutableSource:function(e,t,n){return ga="useMutableSource",Ts(),wa(),Fa(e,t,n)},useOpaqueIdentifier:function(){return ga="useOpaqueIdentifier",Ts(),wa(),vs()},unstable_isNewReconciler:te};var Is=a.unstable_now,Ps=0,Ns=-1;function Ms(){Ps=Is()}function As(e){Ns=Is(),e.actualStartTime<0&&(e.actualStartTime=Is())}function Ds(e){Ns=-1}function Rs(e,t){if(Ns>=0){var n=Is()-Ns;e.actualDuration+=n,t&&(e.selfBaseDuration=n),Ns=-1}}function Bs(e){for(var t=e.child;t;)e.actualDuration+=t.actualDuration,t=t.sibling}var Ls,Os,Fs,zs,Hs,Us,Ws,Vs,js=l.ReactCurrentOwner,Gs=!1;function qs(e,t,n,i){t.child=null===e?wo(t,null,n,i):xo(t,e.child,n,i)}function Ks(e,t,n,i,r){if(t.type!==t.elementType){var o=n.propTypes;o&&$t(o,i,"prop",G(n))}var a,s=n.render,l=t.ref;if(kr(t,r),js.current=t,$i(!0),a=_a(e,t,s,i,l,r),1&t.mode){zt();try{a=_a(e,t,s,i,l,r)}finally{Ht()}}return $i(!1),null===e||Gs?(t.flags|=1,qs(e,t,a,r),t.child):(Ta(e,t,r),kl(e,t,r))}function Ys(e,t,n,i,r,o){if(null===e){var a,s=n.type;if(function(e){return"function"==typeof e&&!ip(e)&&void 0===e.defaultProps}(s)&&null===n.compare&&void 0===n.defaultProps)return a=Hd(s),t.tag=g,t.type=a,rl(t,s),Xs(e,t,a,i,r,o);var l=s.propTypes;l&&$t(l,i,"prop",G(s));var c=ap(n.type,null,i,t,t.mode,o);return c.ref=t.ref,c.return=t,t.child=c,c}var u=n.type,d=u.propTypes;d&&$t(d,i,"prop",G(u));var p=e.child;if(!ei(r,o)){var h=p.memoizedProps,f=n.compare;if((f=null!==f?f:ji)(h,i)&&e.ref===t.ref)return kl(e,t,o)}t.flags|=1;var m=rp(p,i);return m.ref=t.ref,m.return=t,t.child=m,m}function Xs(e,t,n,i,r,o){if(t.type!==t.elementType){var a=t.elementType;if(a.$$typeof===L){var s=a,l=s._payload,c=s._init;try{a=c(l)}catch(e){a=null}var u=a&&a.propTypes;u&&$t(u,i,"prop",G(a))}}if(null!==e&&ji(e.memoizedProps,i)&&e.ref===t.ref&&t.type===e.type){if(Gs=!1,!ei(o,r))return t.lanes=e.lanes,kl(e,t,o);e.flags&ee&&(Gs=!0)}return $s(e,t,n,i,o)}function Qs(e,t,n){var i,r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(4&t.mode){if(!ei(n,zn)){var s;s=null!==a?ni(a.baseLanes,n):n,kd(zn),t.lanes=t.childLanes=zn;var l={baseLanes:s};return t.memoizedState=l,Lu(t,s),null}t.memoizedState={baseLanes:0},Lu(t,null!==a?a.baseLanes:n)}else{t.memoizedState={baseLanes:0},Lu(t,n)}else null!==a?(i=ni(a.baseLanes,n),t.memoizedState=null):i=n,Lu(t,i);return qs(e,t,o,n),t.child}Ls={},Os={},Fs={},zs={},Hs={},Us=!1,Ws={},Vs={};var Zs=Qs;function Js(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=K)}function $s(e,t,n,i,r){if(t.type!==t.elementType){var o=n.propTypes;o&&$t(o,i,"prop",G(n))}var a,s;if(a=fn(t,pn(0,n,!0)),kr(t,r),js.current=t,$i(!0),s=_a(e,t,n,i,a,r),1&t.mode){zt();try{s=_a(e,t,n,i,a,r)}finally{Ht()}}return $i(!1),null===e||Gs?(t.flags|=1,qs(e,t,s,r),t.child):(Ta(e,t,r),kl(e,t,r))}function el(e,t,n,i,r){if(t.type!==t.elementType){var o=n.propTypes;o&&$t(o,i,"prop",G(n))}var a,s;vn(n)?(a=!0,xn(t)):a=!1,kr(t,r),null===t.stateNode?(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ho(t,n,i),mo(t,n,i,r),s=!0):s=null===e?function(e,t,n,i){var r=e.stateNode,o=e.memoizedProps;r.props=o;var a,s=r.context,l=t.contextType;a="object"==typeof l&&null!==l?_r(l):fn(e,pn(0,t,!0));var c=t.getDerivedStateFromProps,u="function"==typeof c||"function"==typeof r.getSnapshotBeforeUpdate;u||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||o===n&&s===a||fo(e,r,n,a),zr();var d=e.memoizedState,p=r.state=d;if(Or(e,n,r,i),p=e.memoizedState,o===n&&d===p&&!mn()&&!Hr())return"function"==typeof r.componentDidMount&&(e.flags|=4),!1;"function"==typeof c&&(no(e,t,c,n),p=e.memoizedState);var h=Hr()||uo(e,t,o,n,d,p,a);return h?(u||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(e.flags|=4)):("function"==typeof r.componentDidMount&&(e.flags|=4),e.memoizedProps=n,e.memoizedState=p),r.props=n,r.state=p,r.context=a,h}(t,n,i,r):function(e,t,n,i,r){var o=t.stateNode;Ar(e,t);var a=t.memoizedProps,s=t.type===t.elementType?a:dr(t.type,a);o.props=s;var l,c=t.pendingProps,u=o.context,d=n.contextType;l="object"==typeof d&&null!==d?_r(d):fn(t,pn(0,n,!0));var p=n.getDerivedStateFromProps,h="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate;h||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||a===c&&u===l||fo(t,o,i,l),zr();var f=t.memoizedState,m=o.state=f;if(Or(t,i,o,r),m=t.memoizedState,a===c&&f===m&&!mn()&&!Hr())return"function"==typeof o.componentDidUpdate&&(a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4)),"function"==typeof o.getSnapshotBeforeUpdate&&(a===e.memoizedProps&&f===e.memoizedState||(t.flags|=Y)),!1;"function"==typeof p&&(no(t,n,p,i),m=t.memoizedState);var v=Hr()||uo(t,n,s,i,f,m,l);return v?(h||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,m,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,m,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=Y)):("function"==typeof o.componentDidUpdate&&(a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4)),"function"==typeof o.getSnapshotBeforeUpdate&&(a===e.memoizedProps&&f===e.memoizedState||(t.flags|=Y)),t.memoizedProps=i,t.memoizedState=m),o.props=i,o.state=m,o.context=l,v}(e,t,n,i,r);var l=tl(e,t,n,s,a,r),c=t.stateNode;return s&&c.props!==i&&(Us||u("It looks like %s is reassigning its own `this.props` while rendering. This is not supported and can lead to confusing bugs.",G(t.type)||"a component"),Us=!0),l}function tl(e,t,n,i,r,o){Js(e,t);var a=!!(t.flags&q);if(!i&&!a)return r&&wn(t,n,!1),kl(e,t,o);var s,l=t.stateNode;if(js.current=t,a&&"function"!=typeof n.getDerivedStateFromError)s=null,Ds();else{if($i(!0),s=l.render(),1&t.mode){zt();try{l.render()}finally{Ht()}}$i(!1)}return t.flags|=1,null!==e&&a?function(e,t,n,i){t.child=xo(t,e.child,null,i),t.child=xo(t,null,n,i)}(e,t,s,o):qs(e,t,s,o),t.memoizedState=l.state,r&&wn(t,n,!0),t.child}function nl(e){var t=e.stateNode;t.pendingContext?bn(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bn(e,t.context,!1),No(e,t.containerInfo)}function il(e,t,n,i,r){null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2);var o=t.pendingProps,a=n,s=a._payload,l=(0,a._init)(s);t.type=l;var c=t.tag=function(e){if("function"==typeof e)return ip(e)?1:0;if(null!=e){var t=e.$$typeof;if(t===A)return h;if(t===B)return v}return 2}(l),u=dr(l,o);switch(c){case 0:return rl(t,l),t.type=l=Hd(l),$s(null,t,l,u,r);case 1:return t.type=l=Ud(l),el(null,t,l,u,r);case h:return t.type=l=Wd(l),Ks(null,t,l,u,r);case v:if(t.type!==t.elementType){var d=l.propTypes;d&&$t(d,u,"prop",G(l))}return Ys(null,t,l,dr(l.type,u),i,r)}var p="";throw null!==l&&"object"==typeof l&&l.$$typeof===L&&(p=" Did you wrap a component in React.lazy() more than once?"),Error("Element type is invalid. Received a promise that resolves to: "+l+". Lazy element type must resolve to a class or function."+p)}function rl(e,t){if(t&&t.childContextTypes&&u("%s(...): childContextTypes cannot be defined on a function component.",t.displayName||t.name||"Component"),null!==e.ref){var n="",i=function(){if(null===Yi)return null;var e=Yi._debugOwner;return null!=e?G(e.type):null}();i&&(n+="\n\nCheck the render method of `"+i+"`.");var r=i||e._debugID||"",o=e._debugSource;o&&(r=o.fileName+":"+o.lineNumber),Hs[r]||(Hs[r]=!0,u("Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?%s",n))}if("function"==typeof t.getDerivedStateFromProps){var a=G(t)||"Unknown";zs[a]||(u("%s: Function components do not support getDerivedStateFromProps.",a),zs[a]=!0)}if("object"==typeof t.contextType&&null!==t.contextType){var s=G(t)||"Unknown";Fs[s]||(u("%s: Function components do not support contextType.",s),Fs[s]=!0)}}var ol={dehydrated:null,retryLane:0};function al(e){return{baseLanes:e}}function sl(e,t){return{baseLanes:ni(e.baseLanes,t)}}function ll(e,t){return ii(e.childLanes,t)}function cl(e,t,n){var i=t.pendingProps;yp(t)&&(t.flags|=q);var r=Oo.current,o=!1;if(t.flags&q||function(e,t,n,i){return(null===t||null!==t.memoizedState)&&zo(e,2)}(r,e)?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0!==i.fallback&&!0!==i.unstable_avoidThisFallback&&(r|=1),Wo(t,r=Ho(r)),null===e){void 0!==i.fallback&&Jo(t);var a=i.children,s=i.fallback;if(o){var l=ul(t,a,s,n);return t.child.memoizedState=al(n),t.memoizedState=ol,l}if("number"==typeof i.unstable_expectedLoadTime){var c=ul(t,a,s,n);return t.child.memoizedState=al(n),t.memoizedState=ol,t.lanes=Rn,kd(Rn),c}return function(e,t,n){var i=cp({mode:"visible",children:t},e.mode,n,null);return i.return=e,e.child=i,i}(t,a,n)}if(null!==e.memoizedState){if(o){var u=i.fallback,d=hl(e,t,i.children,u,n),p=t.child,h=e.child.memoizedState;return p.memoizedState=null===h?al(n):sl(h,n),p.childLanes=ll(e,n),t.memoizedState=ol,d}var f=pl(e,t,i.children,n);return t.memoizedState=null,f}if(o){var m=i.fallback,v=hl(e,t,i.children,m,n),g=t.child,y=e.child.memoizedState;return g.memoizedState=null===y?al(n):sl(y,n),g.childLanes=ll(e,n),t.memoizedState=ol,v}var b=pl(e,t,i.children,n);return t.memoizedState=null,b}function ul(e,t,n,i){var r,o,a=e.mode,s=e.child,l={mode:"hidden",children:t};return 2&a||null===s?(r=cp(l,a,0,null),o=lp(n,a,i,null)):((r=s).childLanes=0,r.pendingProps=l,8&e.mode&&(r.actualDuration=0,r.actualStartTime=-1,r.selfBaseDuration=0,r.treeBaseDuration=0),o=lp(n,a,i,null)),r.return=e,o.return=e,r.sibling=o,e.child=r,o}function dl(e,t){return rp(e,t)}function pl(e,t,n,i){var r=e.child,o=r.sibling,a=dl(r,{mode:"visible",children:n});return!(2&t.mode)&&(a.lanes=i),a.return=t,a.sibling=null,null!==o&&(o.nextEffect=null,o.flags=8,t.firstEffect=t.lastEffect=o),t.child=a,a}function hl(e,t,n,i,r){var o,a,s=t.mode,l=e.child,c=l.sibling,u={mode:"hidden",children:n};if(2&s||t.child===l)o=dl(l,u);else{(o=t.child).childLanes=0,o.pendingProps=u,8&t.mode&&(o.actualDuration=0,o.actualStartTime=-1,o.selfBaseDuration=l.selfBaseDuration,o.treeBaseDuration=l.treeBaseDuration);var d=o.lastEffect;null!==d?(t.firstEffect=o.firstEffect,t.lastEffect=d,d.nextEffect=null):t.firstEffect=t.lastEffect=null}return null!==c?a=rp(c,i):(a=lp(i,s,r,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,a}function fl(e,t){e.lanes=ni(e.lanes,t);var n=e.alternate;null!==n&&(n.lanes=ni(n.lanes,t)),Sr(e.return,t)}function ml(e,t){var n=Array.isArray(e),i=!n&&"function"==typeof V(e);if(n||i){var r=n?"array":"iterable";return u("A nested %s was passed to row #%s in <SuspenseList />. Wrap it in an additional SuspenseList to configure its revealOrder: <SuspenseList revealOrder=...> ... <SuspenseList revealOrder=...>{%s}</SuspenseList> ... </SuspenseList>",r,t,r),!1}return!0}function vl(e,t,n,i,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.lastEffect=o)}function gl(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail,a=i.children;!function(e){if(void 0!==e&&"forwards"!==e&&"backwards"!==e&&"together"!==e&&!Ws[e])if(Ws[e]=!0,"string"==typeof e)switch(e.toLowerCase()){case"together":case"forwards":case"backwards":u('"%s" is not a valid value for revealOrder on <SuspenseList />. Use lowercase "%s" instead.',e,e.toLowerCase());break;case"forward":case"backward":u('"%s" is not a valid value for revealOrder on <SuspenseList />. React uses the -s suffix in the spelling. Use "%ss" instead.',e,e.toLowerCase());break;default:u('"%s" is not a supported revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',e)}else u('%s is not a supported value for revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',e)}(r),function(e,t){void 0===e||Vs[e]||("collapsed"!==e&&"hidden"!==e?(Vs[e]=!0,u('"%s" is not a supported value for tail on <SuspenseList />. Did you mean "collapsed" or "hidden"?',e)):"forwards"!==t&&"backwards"!==t&&(Vs[e]=!0,u('<SuspenseList tail="%s" /> is only valid if revealOrder is "forwards" or "backwards". Did you mean to specify revealOrder="forwards"?',e)))}(o,r),function(e,t){if(("forwards"===t||"backwards"===t)&&null!=e&&!1!==e)if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(!ml(e[n],n))return}else{var i=V(e);if("function"==typeof i){var r=i.call(e);if(r)for(var o=r.next(),a=0;!o.done;o=r.next()){if(!ml(o.value,a))return;a++}}else u('A single row was passed to a <SuspenseList revealOrder="%s" />. This is not useful since it needs multiple rows. Did you mean to pass multiple children or an array?',t)}}(a,r),qs(e,t,a,n);var s=Oo.current;if(zo(s,2)?(s=Uo(s,2),t.flags|=q):(null!==e&&!!(e.flags&q)&&function(e,t,n){for(var i=t;null!==i;){if(i.tag===m)null!==i.memoizedState&&fl(i,n);else if(i.tag===b)fl(i,n);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)return;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}(t,t.child,n),s=Ho(s)),Wo(t,s),2&t.mode)switch(r){case"forwards":var l,c=function(e){for(var t=e,n=null;null!==t;){var i=t.alternate;null!==i&&null===Go(i)&&(n=t),t=t.sibling}return n}(t.child);null===c?(l=t.child,t.child=null):(l=c.sibling,c.sibling=null),vl(t,!1,l,c,o,t.lastEffect);break;case"backwards":var d=null,p=t.child;for(t.child=null;null!==p;){var h=p.alternate;if(null!==h&&null===Go(h)){t.child=p;break}var f=p.sibling;p.sibling=d,d=p,p=f}vl(t,!0,d,null,o,t.lastEffect);break;case"together":vl(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}var yl=!1;var bl,El,xl,wl,Cl=!1;function Sl(){Gs=!0}function kl(e,t,n){return null!==e&&(t.dependencies=e.dependencies),Ds(),ju(t.lanes),ei(n,t.childLanes)?(function(e,t){if(null!==e&&t.child!==e.child)throw Error("Resuming work not yet implemented.");if(null!==t.child){var n=t.child,i=rp(n,n.pendingProps);for(t.child=i,i.return=t;null!==n.sibling;)n=n.sibling,(i=i.sibling=rp(n,n.pendingProps)).return=t;i.sibling=null}}(e,t),t.child):null}function _l(e,t,n){var i=t.lanes;if(t._debugNeedsRemount&&null!==e)return function(e,t,n){var i=t.return;if(null===i)throw new Error("Cannot swap the root fiber.");if(e.alternate=null,t.alternate=null,n.index=t.index,n.sibling=t.sibling,n.return=t.return,n.ref=t.ref,t===i.child)i.child=n;else{var r=i.child;if(null===r)throw new Error("Expected parent to have a child.");for(;r.sibling!==t;)if(null===(r=r.sibling))throw new Error("Expected to find the previous sibling.");r.sibling=n}var o=i.lastEffect;return null!==o?(o.nextEffect=e,i.lastEffect=e):i.firstEffect=i.lastEffect=e,e.nextEffect=null,e.flags=8,n.flags|=2,n}(e,t,ap(t.type,t.key,t.pendingProps,t._debugOwner||null,t.mode,t.lanes));if(null!==e)if(e.memoizedProps!==t.pendingProps||mn()||t.type!==e.type)Gs=!0;else{if(!ei(n,i)){switch(Gs=!1,t.tag){case 3:nl(t),ta();break;case 5:Bo(t);break;case 1:vn(t.type)&&xn(t);break;case 4:No(t,t.stateNode.containerInfo);break;case p:wr(t,t.memoizedProps.value);break;case f:ei(n,t.childLanes)&&(t.flags|=4);var r=t.stateNode;r.effectDuration=0,r.passiveEffectDuration=0;break;case m:if(null!==t.memoizedState){if(ei(n,t.child.childLanes))return cl(e,t,n);Wo(t,Ho(Oo.current));var o=kl(e,t,n);return null!==o?o.sibling:null}Wo(t,Ho(Oo.current));break;case b:var a=!!(e.flags&q),s=ei(n,t.childLanes);if(a){if(s)return gl(e,t,n);t.flags|=q}var l=t.memoizedState;if(null!==l&&(l.rendering=null,l.tail=null,l.lastEffect=null),Wo(t,Oo.current),s)break;return null;case w:case C:return t.lanes=0,Qs(e,t,n)}return kl(e,t,n)}Gs=!!(e.flags&ee)}else Gs=!1;switch(t.lanes=0,t.tag){case 2:return function(e,t,n,i){null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2);var r,o,a=t.pendingProps;if(r=fn(t,pn(0,n,!1)),kr(t,i),n.prototype&&"function"==typeof n.prototype.render){var s=G(n)||"Unknown";Ls[s]||(u("The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",s,s),Ls[s]=!0)}if(1&t.mode&&er.recordLegacyContextWarning(t,null),$i(!0),js.current=t,o=_a(null,t,n,a,r,i),$i(!1),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){var l=G(n)||"Unknown";Os[l]||(u("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",l,l,l),Os[l]=!0)}if("object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){var c=G(n)||"Unknown";Os[c]||(u("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",c,c,c),Os[c]=!0),t.tag=1,t.memoizedState=null,t.updateQueue=null;var d=!1;vn(n)?(d=!0,xn(t)):d=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Mr(t);var p=n.getDerivedStateFromProps;return"function"==typeof p&&no(t,n,p,a),po(t,o),mo(t,n,a,i),tl(null,t,n,!0,d,i)}if(t.tag=0,1&t.mode){zt();try{o=_a(null,t,n,a,r,i)}finally{Ht()}}return qs(null,t,o,i),rl(t,n),t.child}(e,t,t.type,n);case 16:return il(e,t,t.elementType,i,n);case 0:var c=t.type,d=t.pendingProps;return $s(e,t,c,t.elementType===c?d:dr(c,d),n);case 1:var S=t.type,k=t.pendingProps;return el(e,t,S,t.elementType===S?k:dr(S,k),n);case 3:return function(e,t,n){nl(t);var i=t.updateQueue;if(null===e||null===i)throw Error("If the root does not have an updateQueue, we should have already bailed out. This error is likely caused by a bug in React. Please file an issue.");var r=t.pendingProps,o=t.memoizedState,a=null!==o?o.element:null;Ar(e,t),Or(t,r,null,n);var s=t.memoizedState.element;if(s===a)return ta(),kl(e,t,n);var l=t.stateNode;if(l.hydrate&&function(e){if(!_e)return!1;var t=e.stateNode.containerInfo;return Ko=ft(t),qo=e,Yo=!0,!0}(t)){if(_e){var c=l.mutableSourceEagerHydrationData;if(null!=c)for(var u=0;u<c.length;u+=2)aa(c[u],c[u+1])}var d=wo(t,null,s,n);t.child=d;for(var p=d;p;)p.flags=-3&p.flags|Z,p=p.sibling}else qs(e,t,s,n),ta();return t.child}(e,t,n);case 5:return function(e,t,n){Bo(t),null===e&&Jo(t);var i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children;return ge(i,r)?a=null:null!==o&&ge(i,o)&&(t.flags|=16),Js(e,t),qs(e,t,a,n),t.child}(e,t,n);case 6:return function(e,t){return null===e&&Jo(t),null}(e,t);case m:return cl(e,t,n);case 4:return function(e,t,n){No(t,t.stateNode.containerInfo);var i=t.pendingProps;return null===e?t.child=xo(t,null,i,n):qs(e,t,i,n),t.child}(e,t,n);case h:var _=t.type,T=t.pendingProps;return Ks(e,t,_,t.elementType===_?T:dr(_,T),n);case 7:return function(e,t,n){return qs(e,t,t.pendingProps,n),t.child}(e,t,n);case 8:return function(e,t,n){return qs(e,t,t.pendingProps.children,n),t.child}(e,t,n);case f:return function(e,t,n){t.flags|=4;var i=t.stateNode;return i.effectDuration=0,i.passiveEffectDuration=0,qs(e,t,t.pendingProps.children,n),t.child}(e,t,n);case p:return function(e,t,n){var i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value;"value"in r||yl||(yl=!0,u("The `value` prop is required for the `<Context.Provider>`. Did you misspell it or forget to pass it?"));var s=t.type.propTypes;if(s&&$t(s,r,"prop","Context.Provider"),wr(t,a),null!==o){var l=function(e,t,n){if(Wi(n,t))return 0;var i="function"==typeof e._calculateChangedBits?e._calculateChangedBits(n,t):hr;return(i&hr)!==i&&u("calculateChangedBits: Expected the return value to be a 31-bit integer. Instead received: %s",i),0|i}(i,a,o.value);if(0===l){if(o.children===r.children&&!mn())return kl(e,t,n)}else!function(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var o=void 0,a=r.dependencies;if(null!==a){o=r.child;for(var s=a.firstContext;null!==s;){if(s.context===t&&s.observedBits&n){if(1===r.tag){var l=Dr(Hn,Jn(i));l.tag=Pr,Rr(r,l)}r.lanes=ni(r.lanes,i);var c=r.alternate;null!==c&&(c.lanes=ni(c.lanes,i)),Sr(r.return,i),a.lanes=ni(a.lanes,i);break}s=s.next}}else o=r.tag===p&&r.type===e.type?null:r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}var u=o.sibling;if(null!==u){u.return=o.return,o=u;break}o=o.return}r=o}}(t,i,l,n)}return qs(e,t,r.children,n),t.child}(e,t,n);case 9:return function(e,t,n){var i=t.type;void 0===i._context?i!==i.Consumer&&(Cl||(Cl=!0,u("Rendering <Context> directly is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?"))):i=i._context;var r=t.pendingProps,o=r.children;"function"!=typeof o&&u("A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it."),kr(t,n);var a,s=_r(i,r.unstable_observedBits);return js.current=t,$i(!0),a=o(s),$i(!1),t.flags|=1,qs(e,t,a,n),t.child}(e,t,n);case v:var I=t.type,P=dr(I,t.pendingProps);if(t.type!==t.elementType){var N=I.propTypes;N&&$t(N,P,"prop",G(I))}return Ys(e,t,I,P=dr(I.type,P),i,n);case g:return Xs(e,t,t.type,t.pendingProps,i,n);case y:var M=t.type,A=t.pendingProps;return function(e,t,n,i,r){var o;return null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,vn(n)?(o=!0,xn(t)):o=!1,kr(t,r),ho(t,n,i),mo(t,n,i,r),tl(null,t,n,!0,o,r)}(e,t,M,t.elementType===M?A:dr(M,A),n);case b:return gl(e,t,n);case E:case 21:case x:break;case w:return Qs(e,t,n);case C:return Zs(e,t,n)}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function Tl(e){e.flags|=4}function Il(e){e.flags|=K}if(Se)bl=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)fe(e,r.stateNode);else if(4===r.tag);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)return;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},El=function(e){},xl=function(e,t,n,i,r){var o=e.memoizedProps;if(o!==i){var a=t.stateNode,s=Ro(),l=ve(a,n,o,i,r,s);t.updateQueue=l,l&&Tl(t)}},wl=function(e,t,n,i){n!==i&&Tl(t)};else if(ke){bl=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var o=r.stateNode;if(n&&i){var a=r.memoizedProps,s=r.type;o=st(o,s,a,r)}fe(e,o)}else if(6===r.tag){var l=r.stateNode;if(n&&i){var c=r.memoizedProps;l=lt(l,c,r)}fe(e,l)}else if(4===r.tag);else if(r.tag===m){if(4&r.flags){var u=null!==r.memoizedState;if(u){var d=r.child;if(null!==d){null!==d.child&&(d.child.return=d,bl(e,d,!0,u));var p=d.sibling;if(null!==p){p.return=r,r=p;continue}}}}if(null!==r.child){r.child.return=r,r=r.child;continue}}else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)return;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var Pl=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var o=r.stateNode;if(n&&i){var a=r.memoizedProps,s=r.type;o=st(o,s,a,r)}rt(e,o)}else if(6===r.tag){var l=r.stateNode;if(n&&i){var c=r.memoizedProps;l=lt(l,c,r)}rt(e,l)}else if(4===r.tag);else if(r.tag===m){if(4&r.flags){var u=null!==r.memoizedState;if(u){var d=r.child;if(null!==d){null!==d.child&&(d.child.return=d,Pl(e,d,!0,u));var p=d.sibling;if(null!==p){p.return=r,r=p;continue}}}}if(null!==r.child){r.child.return=r,r=r.child;continue}}else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)return;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};El=function(e){var t=e.stateNode;if(null===e.firstEffect);else{var n=t.containerInfo,i=it(n);Pl(i,e,!1,!1),t.pendingChildren=i,Tl(e),ot(n,i)}},xl=function(e,t,n,i,r){var o=e.stateNode,a=e.memoizedProps,s=null===t.firstEffect;if(s&&a===i)t.stateNode=o;else{var l=t.stateNode,c=Ro(),u=null;if(a!==i&&(u=ve(l,n,a,i,r,c)),s&&null===u)t.stateNode=o;else{var d=nt(o,u,n,a,i,t,s,l);me(d,n,i,r,c)&&Tl(t),t.stateNode=d,s?Tl(t):bl(d,t,!1,!1)}}},wl=function(e,t,n,i){if(n!==i){var r=Po(),o=Ro();t.stateNode=ye(i,r,o,t),Tl(t)}else t.stateNode=e.stateNode}}else El=function(e){},xl=function(e,t,n,i,r){},wl=function(e,t,n,i){};function Nl(e,t){if(!na())switch(e.tailMode){case"hidden":for(var n=e.tail,i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":for(var r=e.tail,o=null;null!==r;)null!==r.alternate&&(o=r),r=r.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Ml(e,t,n){var i=t.pendingProps;switch(t.tag){case 2:case 16:case g:case 0:case h:case 7:case 8:case f:case 9:case v:return null;case 1:return vn(t.type)&&gn(t),null;case 3:Mo(t),yn(t),oa();var r=t.stateNode;return r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(null===e||null===e.child)&&(ea(t)?Tl(t):r.hydrate||(t.flags|=Y)),El(t),null;case 5:Lo(t);var o=Po(),a=t.type;if(null!==e&&null!=t.stateNode)xl(e,t,a,i,o),e.ref!==t.ref&&Il(t);else{if(!i){if(null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return null}var s=Ro();if(ea(t))(function(e,t,n){if(!_e)throw Error("Expected prepareToHydrateHostInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");var i=e.stateNode,r=mt(i,e.type,e.memoizedProps,t,n,e);return e.updateQueue=r,null!==r})(t,o,s)&&Tl(t);else{var l=he(a,i,o,s,t);bl(l,t,!1,!1),t.stateNode=l,me(l,a,i,o,s)&&Tl(t)}null!==t.ref&&Il(t)}return null;case 6:var c=i;if(e&&null!=t.stateNode){var u=e.memoizedProps;wl(e,t,u,c)}else{if("string"!=typeof c&&null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");var d=Po(),S=Ro();ea(t)?function(e){if(!_e)throw Error("Expected prepareToHydrateHostTextInstance() to never be called. This error is likely caused by a bug in React. Please file an issue.");var t=e.stateNode,n=e.memoizedProps,i=vt(t,n,e);if(i){var r=qo;if(null!==r)switch(r.tag){case 3:var o=r.stateNode.containerInfo;Tt(o,t,n);break;case 5:var a=r.type,s=r.memoizedProps,l=r.stateNode;It(a,s,l,t,n)}}return i}(t)&&Tl(t):t.stateNode=ye(c,d,S,t)}return null;case m:Vo(t);var k=t.memoizedState;if(t.flags&q)return t.lanes=n,!!(8&t.mode)&&Bs(t),t;var _=null!==k,T=!1;return null===e?void 0!==t.memoizedProps.fallback&&ea(t):T=null!==e.memoizedState,_&&!T&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||zo(Oo.current,1)?0===Yc&&(Yc=3):(0!==Yc&&3!==Yc||(Yc=4),null!==Vc&&(Xn(Zc)||Xn(Jc))&&Au(Vc,Gc))),ke&&_&&(t.flags|=4),Se&&(_||T)&&(t.flags|=4),null;case 4:return Mo(t),El(t),null===e&&Ae(t.stateNode.containerInfo),null;case p:return Cr(t),null;case y:return vn(t.type)&&gn(t),null;case b:Vo(t);var I=t.memoizedState;if(null===I)return null;var P=!!(t.flags&q),N=I.rendering;if(null===N)if(P)Nl(I,!1);else{if(0!==Yc||null!==e&&e.flags&q)for(var M=t.child;null!==M;){var A=Go(M);if(null!==A){P=!0,t.flags|=q,Nl(I,!1);var D=A.updateQueue;return null!==D&&(t.updateQueue=D,t.flags|=4),null===I.lastEffect&&(t.firstEffect=null),t.lastEffect=I.lastEffect,Co(t,n),Wo(t,Uo(Oo.current,2)),t.child}M=M.sibling}null!==I.tail&&Di()>ru()&&(t.flags|=q,P=!0,Nl(I,!1),t.lanes=Rn,kd(Rn))}else{if(!P){var R=Go(N);if(null!==R){t.flags|=q,P=!0;var B=R.updateQueue;if(null!==B&&(t.updateQueue=B,t.flags|=4),Nl(I,!0),null===I.tail&&"hidden"===I.tailMode&&!N.alternate&&!na()){var L=t.lastEffect=I.lastEffect;return null!==L&&(L.nextEffect=null),null}}else 2*Di()-I.renderingStartTime>ru()&&n!==zn&&(t.flags|=q,P=!0,Nl(I,!1),t.lanes=Rn,kd(Rn))}if(I.isBackwards)N.sibling=t.child,t.child=N;else{var O=I.last;null!==O?O.sibling=N:t.child=N,I.last=N}}if(null!==I.tail){var F=I.tail;I.rendering=F,I.tail=F.sibling,I.lastEffect=t.lastEffect,I.renderingStartTime=Di(),F.sibling=null;var z=Oo.current;return Wo(t,z=P?Uo(z,2):Ho(z)),F}return null;case E:case 21:case x:break;case w:case C:if(Ou(t),null!==e){var H=t.memoizedState;null!==e.memoizedState!=(null!==H)&&"unstable-defer-without-hiding"!==i.mode&&(t.flags|=4)}return null}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function Al(e,t){switch(e.tag){case 1:vn(e.type)&&gn(e);var n=e.flags;return n&$?(e.flags=-4097&n|q,!!(8&e.mode)&&Bs(e),e):null;case 3:Mo(e),yn(e),oa();var i=e.flags;if(i&q)throw Error("The root failed to unmount after an error. This is likely a bug in React. Please file an issue.");return e.flags=-4097&i|q,e;case 5:return Lo(e),null;case m:Vo(e);var r=e.flags;return r&$?(e.flags=-4097&r|q,!!(8&e.mode)&&Bs(e),e):null;case b:return Vo(e),null;case 4:return Mo(e),null;case p:return Cr(e),null;case w:case C:return Ou(e),null;default:return null}}function Dl(e){switch(e.tag){case 1:null!=e.type.childContextTypes&&gn(e);break;case 3:Mo(e),yn(e),oa();break;case 5:Lo(e);break;case 4:Mo(e);break;case m:case b:Vo(e);break;case p:Cr(e);break;case w:case C:Ou(e)}}function Rl(e,t){return{value:e,source:t,stack:qi(t)}}function Bl(e,t){try{var n=t.value,i=t.source;t.stack;if(null!=n&&n._suppressLogging&&1===e.tag)return;i&&G(i.type),G(e.type)}catch(e){setTimeout((function(){throw e}))}}var Ll="function"==typeof WeakMap?WeakMap:Map;function Ol(e,t,n){var i=Dr(Hn,n);i.tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){ld(r),Bl(e,t)},i}function Fl(e,t,n){var i=Dr(Hn,n);i.tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;i.payload=function(){return Bl(e,t),r(o)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch?i.callback=function(){jd(e),"function"!=typeof r&&(this,null===lu?lu=new Set([this]):lu.add(this),Bl(e,t));var n=t.value,i=t.stack;this.componentDidCatch(n,{componentStack:null!==i?i:""}),"function"!=typeof r&&(ei(e.lanes,1)||u("%s: Error boundaries should implement getDerivedStateFromError(). In that method, return a state update to display an error message or fallback UI.",G(e.type)||"Unknown"))}:i.callback=function(){jd(e)},i}function zl(e,t,n){var i,r=e.pingCache;if(null===r?(r=e.pingCache=new Ll,i=new Set,r.set(t,i)):void 0===(i=r.get(t))&&(i=new Set,r.set(t,i)),!i.has(n)){i.add(n);var o=dd.bind(null,e,t,n);t.then(o,o)}}function Hl(e,t,n,i,r){if(n.flags|=J,n.firstEffect=n.lastEffect=null,null!==i&&"object"==typeof i&&"function"==typeof i.then){var o=i;if(!(2&n.mode)){var a=n.alternate;a?(n.updateQueue=a.updateQueue,n.memoizedState=a.memoizedState,n.lanes=a.lanes):(n.updateQueue=null,n.memoizedState=null)}var s=zo(Oo.current,1),l=t;do{if(l.tag===m&&jo(l,s)){var c=l.updateQueue;if(null===c){var u=new Set;u.add(o),l.updateQueue=u}else c.add(o);if(!(2&l.mode)){if(l.flags|=q,n.flags|=ee,n.flags&=-2981,1===n.tag)if(null===n.alternate)n.tag=y;else{var d=Dr(Hn,1);d.tag=Pr,Rr(n,d)}return void(n.lanes=ni(n.lanes,1))}return zl(e,o,r),l.flags|=$,void(l.lanes=r)}l=l.return}while(null!==l);i=new Error((G(n.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Yc&&(Yc=2),i=Rl(i,n);var p=t;do{switch(p.tag){case 3:var h=i;p.flags|=$;var f=Jn(r);return p.lanes=ni(p.lanes,f),void Br(p,Ol(p,h,f));case 1:var v=i,g=p.type,b=p.stateNode;if(!(p.flags&q||"function"!=typeof g.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||sd(b)))){p.flags|=$;var E=Jn(r);return p.lanes=ni(p.lanes,E),void Br(p,Fl(p,v,E))}}p=p.return}while(null!==p)}function Ul(e,t,n,i,r,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Wl=Ul;if("undefined"!=typeof window&&"function"==typeof window.dispatchEvent&&"undefined"!=typeof document&&"function"==typeof document.createEvent){var Vl=document.createElement("react");Wl=function(e,t,n,i,r,o,a,s,l){if("undefined"==typeof document)throw Error("The `document` global was defined when React was initialized, but is not defined anymore. This can happen in a test environment if a component schedules an update from an asynchronous callback, but the test has already finished running. To solve this, you can either unmount the component at the end of your test (and ensure that any asynchronous operations get canceled in `componentWillUnmount`), or you can change the test itself to be asynchronous.");var c=document.createEvent("Event"),u=!1,d=!0,p=window.event,h=Object.getOwnPropertyDescriptor(window,"event");function f(){Vl.removeEventListener(x,g,!1),void 0!==window.event&&window.hasOwnProperty("event")&&(window.event=p)}var m,v=Array.prototype.slice.call(arguments,3);function g(){u=!0,f(),t.apply(n,v),d=!1}var y=!1,b=!1;function E(e){if(m=e.error,y=!0,null===m&&0===e.colno&&0===e.lineno&&(b=!0),e.defaultPrevented&&null!=m&&"object"==typeof m)try{m._suppressLogging=!0}catch(e){}}var x="react-"+(e||"invokeguardedcallback");if(window.addEventListener("error",E),Vl.addEventListener(x,g,!1),c.initEvent(x,!1,!1),Vl.dispatchEvent(c),h&&Object.defineProperty(window,"event",h),u&&d&&(y?b&&(m=new Error("A cross-origin error was thrown. React doesn't have access to the actual error object in development. See https://reactjs.org/link/crossorigin-error for more information.")):m=new Error("An error was thrown inside one of your components, but React doesn't know what it was. This is likely due to browser flakiness. React does its best to preserve the \"Pause on exceptions\" behavior of the DevTools, which requires some DEV-mode only tricks. It's possible that these don't work in your browser. Try triggering the error in production mode, or switching to a modern browser. If you suspect that this is actually an issue with React, please file an issue."),this.onError(m)),window.removeEventListener("error",E),!u)return f(),Ul.apply(this,arguments)}}var jl,Gl=Wl,ql=!1,Kl=null,Yl={onError:function(e){ql=!0,Kl=e}};function Xl(e,t,n,i,r,o,a,s,l){ql=!1,Kl=null,Gl.apply(Yl,arguments)}function Ql(){return ql}function Zl(){if(ql){var e=Kl;return ql=!1,Kl=null,e}throw Error("clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.")}jl=new Set;var Jl="function"==typeof WeakSet?WeakSet:Set,$l=function(e,t){t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()};function ec(e){var t=e.ref;null!==t&&("function"==typeof t?(Xl(null,t,null,null),Ql()&&ud(e,Zl())):t.current=null)}function tc(e,t){Xl(null,t,null),Ql()&&ud(e,Zl())}function nc(e,t){switch(t.tag){case 0:case h:case g:case x:return;case 1:if(t.flags&Y&&null!==e){var n=e.memoizedProps,i=e.memoizedState,r=t.stateNode;t.type!==t.elementType||Us||(r.props!==t.memoizedProps&&u("Expected %s props to match memoized props before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",G(t.type)||"instance"),r.state!==t.memoizedState&&u("Expected %s state to match memoized state before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",G(t.type)||"instance"));var o=r.getSnapshotBeforeUpdate(t.elementType===t.type?n:dr(t.type,n),i),a=jl;void 0!==o||a.has(t.type)||(a.add(t.type),u("%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",G(t.type))),r.__reactInternalSnapshotBeforeUpdate=o}return;case 3:if(Se&&t.flags&Y){var s=t.stateNode;tt(s.containerInfo)}return;case 5:case 6:case 4:case y:return}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}function ic(e,t){var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next,o=r;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&a()}o=o.next}while(o!==r)}}function rc(e,t,n,i){switch(n.tag){case 0:case h:case g:case x:return function(e,t){var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next,o=r;do{if(!(3&~o.tag)){var a=o.create;o.destroy=a();var s=o.destroy;void 0!==s&&"function"!=typeof s&&u("An effect function must not return anything besides a function, which is used for clean-up.%s",null===s?" You returned null. If your effect does not require clean up, return undefined (or nothing).":"function"==typeof s.then?"\n\nIt looks like you wrote useEffect(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:\n\nuseEffect(() => {\n  async function fetchData() {\n    // You can await here\n    const response = await MyAPI.getData(someId);\n    // ...\n  }\n  fetchData();\n}, [someId]); // Or [] if effect doesn't need props or state\n\nLearn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching":" You returned: "+s)}o=o.next}while(o!==r)}}(0,n),void function(e){var t=e.updateQueue,n=null!==t?t.lastEffect:null;if(null!==n){var i=n.next,r=i;do{var o=r,a=o.next,s=o.tag;!!(4&s)&&!!(1&s)&&(rd(e,r),id(e,r)),r=a}while(r!==i)}}(n);case 1:var r=n.stateNode;if(4&n.flags)if(null===t)n.type!==n.elementType||Us||(r.props!==n.memoizedProps&&u("Expected %s props to match memoized props before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",G(n.type)||"instance"),r.state!==n.memoizedState&&u("Expected %s state to match memoized state before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",G(n.type)||"instance")),r.componentDidMount();else{var o=n.elementType===n.type?t.memoizedProps:dr(n.type,t.memoizedProps),a=t.memoizedState;n.type!==n.elementType||Us||(r.props!==n.memoizedProps&&u("Expected %s props to match memoized props before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",G(n.type)||"instance"),r.state!==n.memoizedState&&u("Expected %s state to match memoized state before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",G(n.type)||"instance")),r.componentDidUpdate(o,a,r.__reactInternalSnapshotBeforeUpdate)}var s=n.updateQueue;return void(null!==s&&(n.type!==n.elementType||Us||(r.props!==n.memoizedProps&&u("Expected %s props to match memoized props before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",G(n.type)||"instance"),r.state!==n.memoizedState&&u("Expected %s state to match memoized state before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",G(n.type)||"instance")),Ur(0,s,r)));case 3:var l=n.updateQueue;if(null!==l){var c=null;if(null!==n.child)switch(n.child.tag){case 5:c=le(n.child.stateNode);break;case 1:c=n.child.stateNode}Ur(0,l,c)}return;case 5:var d=n.stateNode;if(null===t&&4&n.flags){var p=n.type,v=n.memoizedProps;je(d,p,v,n)}return;case 6:case 4:return;case f:var S=n.memoizedProps;S.onCommit;var k=S.onRender;n.stateNode.effectDuration;var _=Ps;return void("function"==typeof k&&k(n.memoizedProps.id,null===t?"mount":"update",n.actualDuration,n.treeBaseDuration,n.actualStartTime,_,e.memoizedInteractions));case m:return void function(e,t){if(_e&&null===t.memoizedState){var n=t.alternate;if(null!==n){var i=n.memoizedState;if(null!==i){var r=i.dehydrated;null!==r&&bt(r)}}}}(0,n);case b:case y:case E:case 21:case w:case C:return}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}function oc(e,t){if(Se)for(var n=e;;){if(5===n.tag){var i=n.stateNode;t?Ze(i):$e(n.stateNode,n.memoizedProps)}else if(6===n.tag){var r=n.stateNode;t?Je(r):et(r,n.memoizedProps)}else if((n.tag!==w&&n.tag!==C||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)return;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ac(e){var t=e.ref;if(null!==t){var n,i=e.stateNode;n=5===e.tag?le(i):i,"function"==typeof t?t(n):(t.hasOwnProperty("current")||u("Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().",G(e.type)),t.current=n)}}function sc(e){var t=e.ref;null!==t&&("function"==typeof t?t(null):t.current=null)}function lc(e,t,n){switch(function(e){if(Sn&&"function"==typeof Sn.onCommitFiberUnmount)try{Sn.onCommitFiberUnmount(Cn,e)}catch(e){kn||(kn=!0,u("React instrumentation encountered an error: %s",e))}}(t),t.tag){case 0:case h:case v:case g:case x:var i=t.updateQueue;if(null!==i){var r=i.lastEffect;if(null!==r){var o=r.next,a=o;do{var s=a,l=s.destroy,c=s.tag;void 0!==l&&(4&c?rd(t,a):tc(t,l)),a=a.next}while(a!==o)}}return;case 1:ec(t);var d=t.stateNode;return void("function"==typeof d.componentWillUnmount&&function(e,t){Xl(null,$l,null,e,t),Ql()&&ud(e,Zl())}(t,d));case 5:return void ec(t);case 4:return void(Se?mc(e,t):ke&&function(e){if(ke){var t=e.stateNode.containerInfo,n=it(t);at(t,n)}}(t));case E:case 18:case 21:return}}function cc(e,t,n){for(var i=t;;)if(lc(e,i),null===i.child||Se&&4===i.tag){if(i===t)return;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else i.child.return=i,i=i.child}function uc(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null,e._debugOwner=null}function dc(e){return 5===e.tag||3===e.tag||4===e.tag}function pc(e){if(Se){var t,n,i=function(e){for(var t=e.return;null!==t;){if(dc(t))return t;t=t.return}throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")}(e),r=i.stateNode;switch(i.tag){case 5:t=r,n=!1;break;case 3:case 4:t=r.containerInfo,n=!0;break;default:throw Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}16&i.flags&&(Qe(t),i.flags&=-17);var o=function(e){var t=e;e:for(;;){for(;null===t.sibling;){if(null===t.return||dc(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue e;if(null===t.child||4===t.tag)continue e;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}(e);n?hc(e,o,t):fc(e,o,t)}}function hc(e,t,n){var i=e.tag,r=5===i||6===i;if(r){var o=r?e.stateNode:e.stateNode.instance;t?Ke(n,o,t):We(n,o)}else if(4===i);else{var a=e.child;if(null!==a){hc(a,t,n);for(var s=a.sibling;null!==s;)hc(s,t,n),s=s.sibling}}}function fc(e,t,n){var i=e.tag,r=5===i||6===i;if(r){var o=r?e.stateNode:e.stateNode.instance;t?qe(n,o,t):Ue(n,o)}else if(4===i);else{var a=e.child;if(null!==a){fc(a,t,n);for(var s=a.sibling;null!==s;)fc(s,t,n),s=s.sibling}}}function mc(e,t,n){for(var i,r,o=t,a=!1;;){if(!a){var s=o.return;e:for(;;){if(null===s)throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");var l=s.stateNode;switch(s.tag){case 5:i=l,r=!1;break e;case 3:case 4:i=l.containerInfo,r=!0;break e}s=s.return}a=!0}if(5===o.tag||6===o.tag)cc(e,o),r?Xe(i,o.stateNode):Ye(i,o.stateNode);else if(4===o.tag){if(null!==o.child){i=o.stateNode.containerInfo,r=!0,o.child.return=o,o=o.child;continue}}else if(lc(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)return;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function vc(e,t,n){Se?mc(e,t):cc(e,t);var i=t.alternate;uc(t),null!==i&&uc(i)}function gc(e,t){if(Se){switch(t.tag){case 0:case h:case v:case g:case x:return void ic(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps,r=null!==e?e.memoizedProps:i,o=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&Ge(n,a,o,r,i,t)}return;case 6:if(null===t.stateNode)throw Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");var s=t.stateNode,l=t.memoizedProps,c=null!==e?e.memoizedProps:l;return void Ve(s,c,l);case 3:if(_e){var u=t.stateNode;u.hydrate&&(u.hydrate=!1,yt(u.containerInfo))}return;case f:return;case m:return yc(t),void bc(t);case b:return void bc(t);case y:return;case E:case 21:break;case w:case C:return void oc(t,null!==t.memoizedState)}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}switch(t.tag){case 0:case h:case v:case g:case x:return void ic(3,t);case f:return;case m:return yc(t),void bc(t);case b:return void bc(t);case 3:if(_e){var d=t.stateNode;d.hydrate&&(d.hydrate=!1,yt(d.containerInfo))}break;case w:case C:return}!function(e){if(ke){switch(e.tag){case 1:case 5:case 6:case E:return;case 3:case 4:var t=e.stateNode,n=t.containerInfo,i=t.pendingChildren;return void at(n,i)}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}}(t)}function yc(e){null!==e.memoizedState&&(tu=Di(),Se&&oc(e.child,!0))}function bc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jl),t.forEach((function(t){var i=pd.bind(null,e,t);n.has(t)||(!0!==t.__reactDoNotTraceInteractions&&(i=s.unstable_wrap(i)),n.add(t),t.then(i,i))}))}}function Ec(e,t){if(null!==e){var n=e.memoizedState;if(null===n||null!==n.dehydrated){var i=t.memoizedState;return null!==i&&null===i.dehydrated}}return!1}function xc(e){Se&&Qe(e.stateNode)}var wc=0,Cc=1,Sc=2,kc=3,_c=4;if("function"==typeof Symbol&&Symbol.for){var Tc=Symbol.for;wc=Tc("selector.component"),Cc=Tc("selector.has_pseudo_class"),Sc=Tc("selector.role"),kc=Tc("selector.test_id"),_c=Tc("selector.text")}function Ic(e){var t=Te(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error("Invalid host root specified. Should be either a React container or a node with a testname attribute.");return t}var n=Re(e);if(null===n)throw Error("Could not find React container within specified host subtree.");return n.stateNode.current}function Pc(e,t){switch(t.$$typeof){case wc:if(e.type===t.value)return!0;break;case Cc:return function(e,t){for(var n=[e,0],i=0;i<n.length;){var r=n[i++],o=n[i++],a=t[o];if(5!==r.tag||!Oe(r)){for(;null!=a&&Pc(r,a);)a=t[++o];if(o===t.length)return!0;for(var s=r.child;null!==s;)n.push(s,o),s=s.sibling}}return!1}(e,t.value);case Sc:if(5===e.tag){var n=e.stateNode;if(Fe(n,t.value))return!0}break;case _c:if(5===e.tag||6===e.tag){var i=Le(e);if(null!==i&&i.indexOf(t.value)>=0)return!0}break;case kc:if(5===e.tag){var r=e.memoizedProps["data-testname"];if("string"==typeof r&&r.toLowerCase()===t.value.toLowerCase())return!0}break;default:throw Error("Invalid selector type "+t+" specified.")}return!1}function Nc(e){switch(e.$$typeof){case wc:return"<"+(G(e.value)||"Unknown")+">";case Cc:return":has("+(Nc(e)||"")+")";case Sc:return'[role="'+e.value+'"]';case _c:return'"'+e.value+'"';case kc:return'[data-testname="'+e.value+'"]';default:throw Error("Invalid selector type "+e+" specified.")}}function Mc(e,t){for(var n=[],i=[e,0],r=0;r<i.length;){var o=i[r++],a=i[r++],s=t[a];if(5!==o.tag||!Oe(o)){for(;null!=s&&Pc(o,s);)s=t[++a];if(a===t.length)n.push(o);else for(var l=o.child;null!==l;)i.push(l,a),l=l.sibling}}return n}function Ac(e,t){if(!De)throw Error("Test selector API is not supported by this renderer.");for(var n=Mc(Ic(e),t),i=[],r=Array.from(n),o=0;o<r.length;){var a=r[o++];if(5===a.tag){if(Oe(a))continue;i.push(a.stateNode)}else for(var s=a.child;null!==s;)r.push(s),s=s.sibling}return i}var Dc=[],Rc=!1,Bc=null,Lc=Math.ceil,Oc=l.ReactCurrentDispatcher,Fc=l.ReactCurrentOwner,zc=l.IsSomeRendererActing,Hc=16,Uc=32,Wc=0,Vc=null,jc=null,Gc=0,qc=0,Kc=on(0),Yc=0,Xc=null,Qc=0,Zc=0,Jc=0,$c=0,eu=null,tu=0,nu=1/0;function iu(){nu=Di()+500}function ru(){return nu}var ou=null,au=!1,su=null,lu=null,cu=!1,uu=null,du=90,pu=0,hu=[],fu=[],mu=null,vu=0,gu=null,yu=0,bu=null,Eu=Hn,xu=0,wu=0,Cu=!1,Su=null,ku=!1;function _u(){return 48&Wc?Di():Eu!==Hn?Eu:Eu=Di()}function Tu(e){var t=e.mode;if(!(2&t))return 1;if(!(4&t))return Ri()===Si?1:2;if(0===xu&&(xu=Qc),0!==Ui.transition)return 0!==wu&&(wu=null!==eu?eu.pendingLanes:0),function(e,t){var n=Jn(An&~t);return 0===n&&0===(n=Jn(An&~e))&&(n=Jn(An)),n}(xu,wu);var n,i=Ri();return n=Zn(4&Wc&&i===ki?12:function(e){switch(e){case 99:return Pn;case 98:return Nn;case 97:case 96:return 8;case 95:return 2;default:return 0}}(i),xu),n}function Iu(e,t,n){!function(){if(vu>50)throw vu=0,gu=null,Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");yu>50&&(yu=0,u("Maximum update depth exceeded. This can happen when a component calls setState inside useEffect, but useEffect either doesn't have a dependency array, or one of the dependencies changes on every render."))}(),function(e){if(Xi&&Wc&Hc&&!ps)switch(e.tag){case 0:case h:case g:var t=jc&&G(jc.type)||"Unknown",n=t;gd.has(n)||(gd.add(n),u("Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render",G(e.type)||"Unknown",t,t));break;case 1:yd||(u("Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state."),yd=!0)}}(e);var i=Pu(e,t);if(null===i)return function(e){var t=e.tag;if(!(3!==t&&1!==t&&0!==t&&t!==h&&t!==v&&t!==g&&t!==x||e.flags&Q)){var n=G(e.type)||"ReactComponent";if(null!==vd){if(vd.has(n))return;vd.add(n)}else vd=new Set([n]);if(Cu);else{var i=Yi;try{Ji(e),u("Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in %s.",1===t?"the componentWillUnmount method":"a useEffect cleanup function")}finally{i?Ji(e):Zi()}}}}(e),null;oi(i,t,n),i===Vc&&(Jc=ni(Jc,t),4===Yc&&Au(i,Gc));var r=Ri();1===t?8&Wc&&!(48&Wc)?(Td(i,t),Du(i)):(Nu(i,n),Td(i,t),0===Wc&&(iu(),zi())):(!(4&Wc)||r!==ki&&r!==Si||(null===mu?mu=new Set([i]):mu.add(i)),Nu(i,n),Td(i,t)),eu=i}function Pu(e,t){e.lanes=ni(e.lanes,t);var n=e.alternate;null!==n&&(n.lanes=ni(n.lanes,t)),null===n&&1026&e.flags&&fd(e);for(var i=e,r=e.return;null!==r;)r.childLanes=ni(r.childLanes,t),null!==(n=r.alternate)?n.childLanes=ni(n.childLanes,t):!!(1026&r.flags)&&fd(e),i=r,r=r.return;return 3===i.tag?i.stateNode:null}function Nu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.pendingLanes,i=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=n;a>0;){var s=$n(a),l=1<<s,c=o[s];c===Hn?!!(l&i)&&!(l&r)||(o[s]=Kn(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}(e,t);var i=qn(e,e===Vc?Gc:0),r=jn;if(0!==i){if(null!==n){if(e.callbackPriority===r)return;Fi(n)}var o,a;r===Pn?(a=Du.bind(null,e),null===Pi?(Pi=[a],Ni=pi(yi,Hi)):Pi.push(a),o=Ci):o=14===r?Oi(Si,Du.bind(null,e)):Oi(function(e){switch(e){case Pn:case 14:return 99;case 13:case 12:case 11:case Nn:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error("Invalid update priority: "+e+". This is a bug in React.")}}(r),Mu.bind(null,e)),e.callbackPriority=r,e.callbackNode=o}else null!==n&&(Fi(n),e.callbackNode=null,e.callbackPriority=0)}function Mu(e){if(Eu=Hn,xu=0,wu=0,48&Wc)throw Error("Should not already be working.");var t=e.callbackNode;if(nd()&&e.callbackNode!==t)return null;var n=qn(e,e===Vc?Gc:0);if(0===n)return null;var i=function(e,t){var n=Wc;Wc|=Hc;var i=Hu();Vc===e&&Gc===t||(iu(),Fu(e,t),Id(e,t));for(var r=Wu(e);;)try{Ku();break}catch(t){zu(e,t)}return br(),Vu(r),Uu(i),Wc=n,null!==jc?0:(Vc=null,Gc=0,Yc)}(e,n);if(ei(Qc,Jc))Fu(e,0);else if(0!==i){if(2===i&&(Wc|=64,e.hydrate&&(e.hydrate=!1,tt(e.containerInfo)),0!==(n=Yn(e))&&(i=Gu(e,n))),1===i){var r=Xc;throw Fu(e,0),Au(e,n),Nu(e,Di()),r}var o=e.current.alternate;e.finishedWork=o,e.finishedLanes=n,function(e,t,n){switch(t){case 0:case 1:throw Error("Root did not complete. This is a bug in React.");case 2:case 5:Zu(e);break;case 3:if(Au(e,n),Qn(n)&&!Nd()){var i=tu+500-Di();if(i>10){if(0!==qn(e,0))break;var r=e.suspendedLanes;if(!ti(r,n)){_u(),ai(e,r);break}e.timeoutHandle=be(Zu.bind(null,e),i);break}}Zu(e);break;case 4:if(Au(e,n),function(e){return(e&An)===e}(n))break;if(!Nd()){var o=function(e,t){for(var n=e.eventTimes,i=Hn;t>0;){var r=$n(t),o=1<<r,a=n[r];a>i&&(i=a),t&=~o}return i}(e,n),a=o,s=Di()-a,l=((c=s)<120?120:c<480?480:c<1080?1080:c<1920?1920:c<3e3?3e3:c<4320?4320:1960*Lc(c/1960))-s;if(l>10){e.timeoutHandle=be(Zu.bind(null,e),l);break}}Zu(e);break;default:throw Error("Unknown root exit status.")}var c}(e,i,n)}return Nu(e,Di()),e.callbackNode===t?Mu.bind(null,e):null}function Au(e,t){t=ii(t,$c),function(e,t){e.suspendedLanes|=t,e.pingedLanes&=~t;for(var n=e.expirationTimes,i=t;i>0;){var r=$n(i),o=1<<r;n[r]=Hn,i&=~o}}(e,t=ii(t,Jc))}function Du(e){if(48&Wc)throw Error("Should not already be working.");var t,n;if(nd(),e===Vc&&ei(e.expiredLanes,Gc)?(n=Gu(e,t=Gc),ei(Qc,Jc)&&(n=Gu(e,t=qn(e,t)))):n=Gu(e,t=qn(e,0)),0!==e.tag&&2===n&&(Wc|=64,e.hydrate&&(e.hydrate=!1,tt(e.containerInfo)),0!==(t=Yn(e))&&(n=Gu(e,t))),1===n){var i=Xc;throw Fu(e,0),Au(e,t),Nu(e,Di()),i}var r=e.current.alternate;return e.finishedWork=r,e.finishedLanes=t,Zu(e),Nu(e,Di()),null}function Ru(e,t){var n=Wc;Wc|=1;try{return e(t)}finally{0===(Wc=n)&&(iu(),zi())}}function Bu(e,t){var n=Wc;if(48&n)return u("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task."),e(t);Wc|=1;try{return e?Li(Si,e.bind(null,t)):void 0}finally{Wc=n,zi()}}function Lu(e,t){sn(Kc,qc,e),qc=ni(qc,t),Qc=ni(Qc,t)}function Ou(e){qc=Kc.current,an(Kc,e)}function Fu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==xe&&(e.timeoutHandle=xe,Ee(n)),null!==jc)for(var i=jc.return;null!==i;)Dl(i),i=i.return;Vc=e,jc=rp(e.current,null),Gc=qc=Qc=t,Yc=0,Xc=null,Zc=0,Jc=0,$c=0,bu=null,er.discardPendingWarnings()}function zu(e,t){for(;;){var n=jc;try{if(br(),Ia(),Zi(),Fc.current=null,null===n||null===n.return)return Yc=1,Xc=t,void(jc=null);8&n.mode&&Rs(n,!0),Hl(e,n.return,n,t,Gc),Xu(n)}catch(e){t=e,jc===n&&null!==n?(n=n.return,jc=n):n=jc;continue}return}}function Hu(){var e=Oc.current;return Oc.current=ys,null===e?ys:e}function Uu(e){Oc.current=e}function Wu(e){var t=s.__interactionsRef.current;return s.__interactionsRef.current=e.memoizedInteractions,t}function Vu(e){s.__interactionsRef.current=e}function ju(e){Zc=ni(e,Zc)}function Gu(e,t){var n=Wc;Wc|=Hc;var i=Hu();Vc===e&&Gc===t||(Fu(e,t),Id(e,t));for(var r=Wu(e);;)try{qu();break}catch(t){zu(e,t)}if(br(),Vu(r),Wc=n,Uu(i),null!==jc)throw Error("Cannot commit an incomplete root. This error is likely caused by a bug in React. Please file an issue.");return Vc=null,Gc=0,Yc}function qu(){for(;null!==jc;)Yu(jc)}function Ku(){for(;null!==jc&&!Ti();)Yu(jc)}function Yu(e){var t,n=e.alternate;Ji(e),8&e.mode?(As(e),t=md(n,e,qc),Rs(e,!0)):t=md(n,e,qc),Zi(),e.memoizedProps=e.pendingProps,null===t?Xu(e):jc=t,Fc.current=null}function Xu(e){var t=e;do{var n=t.alternate,i=t.return;if(t.flags&J){var r=Al(t);if(null!==r)return r.flags&=2047,void(jc=r);if(8&t.mode){Rs(t,!1);for(var o=t.actualDuration,a=t.child;null!==a;)o+=a.actualDuration,a=a.sibling;t.actualDuration=o}null!==i&&(i.firstEffect=i.lastEffect=null,i.flags|=J)}else{Ji(t);var s=void 0;if(8&t.mode?(As(t),s=Ml(n,t,qc),Rs(t,!1)):s=Ml(n,t,qc),Zi(),null!==s)return void(jc=s);Qu(t),null===i||i.flags&J||(null===i.firstEffect&&(i.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==i.lastEffect&&(i.lastEffect.nextEffect=t.firstEffect),i.lastEffect=t.lastEffect),t.flags>1&&(null!==i.lastEffect?i.lastEffect.nextEffect=t:i.firstEffect=t,i.lastEffect=t))}var l=t.sibling;if(null!==l)return void(jc=l);jc=t=i}while(null!==t);0===Yc&&(Yc=5)}function Qu(e){if(e.tag!==C&&e.tag!==w||null===e.memoizedState||ei(qc,zn)||!(4&e.mode)){var t=0;if(8&e.mode){for(var n=e.actualDuration,i=e.selfBaseDuration,r=null===e.alternate||e.child!==e.alternate.child,o=e.child;null!==o;)t=ni(t,ni(o.lanes,o.childLanes)),r&&(n+=o.actualDuration),i+=o.treeBaseDuration,o=o.sibling;if(e.tag===m&&null!==e.memoizedState){var a=e.child;null!==a&&(i-=a.treeBaseDuration)}e.actualDuration=n,e.treeBaseDuration=i}else for(var s=e.child;null!==s;)t=ni(t,ni(s.lanes,s.childLanes)),s=s.sibling;e.childLanes=t}}function Zu(e){var t=Ri();return Li(Si,Ju.bind(null,e,t)),null}function Ju(e,t){do{nd()}while(null!==uu);if(er.flushLegacyContextWarning(),er.flushPendingUnsafeLifecycleWarnings(),48&Wc)throw Error("Should not already be working.");var n=e.finishedWork,i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");e.callbackNode=null;var r,o=ni(n.lanes,n.childLanes);if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t;for(var i=e.entanglements,r=e.eventTimes,o=e.expirationTimes,a=n;a>0;){var s=$n(a),l=1<<s;i[s]=0,r[s]=Hn,o[s]=Hn,a&=~l}}(e,o),null!==mu&&!function(e){return!!(24&e)}(o)&&mu.has(e)&&mu.delete(e),e===Vc&&(Vc=null,jc=null,Gc=0),n.flags>1?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){var a=Wc;Wc|=Uc;var s=Wu(e);Fc.current=null,Su=de(e.containerInfo),ku=!1,ou=r;do{if(Xl(null,$u,null),Ql()){if(null===ou)throw Error("Should be working on an effect.");var l=Zl();ud(ou,l),ou=ou.nextEffect}}while(null!==ou);Su=null,Ms(),ou=r;do{if(Xl(null,ed,null,e,t),Ql()){if(null===ou)throw Error("Should be working on an effect.");var c=Zl();ud(ou,c),ou=ou.nextEffect}}while(null!==ou);ku&&Me(),pe(e.containerInfo),e.current=n,ou=r;do{if(Xl(null,td,null,e,i),Ql()){if(null===ou)throw Error("Should be working on an effect.");var u=Zl();ud(ou,u),ou=ou.nextEffect}}while(null!==ou);ou=null,Ii(),Vu(s),Wc=a}else e.current=n,Ms();var d=cu;if(cu)cu=!1,uu=e,pu=i,du=t;else for(ou=r;null!==ou;){var p=ou.nextEffect;ou.nextEffect=null,8&ou.flags&&Ld(ou),ou=p}if(0!==(o=e.pendingLanes)){if(null!==bu){var h=bu;bu=null;for(var f=0;f<h.length;f++)_d(e,h[f],e.memoizedInteractions)}Td(e,o)}else lu=null;if(d||Pd(e,i),1===o?e===gu?vu++:(vu=0,gu=e):vu=0,Tn(n.stateNode,t),De&&Dc.forEach((function(e){return e()})),Nu(e,Di()),au){au=!1;var m=su;throw su=null,m}return!!(8&Wc)||zi(),null}function $u(){for(;null!==ou;){var e=ou.alternate;ku||null===Su||(8&ou.flags?se(ou,Su)&&(ku=!0,Ne()):ou.tag===m&&Ec(e,ou)&&se(ou,Su)&&(ku=!0,Ne()));var t=ou.flags;!!(t&Y)&&(Ji(ou),nc(e,ou),Zi()),!!(t&X)&&(cu||(cu=!0,Oi(_i,(function(){return nd(),null})))),ou=ou.nextEffect}}function ed(e,t){for(;null!==ou;){Ji(ou);var n=ou.flags;if(16&n&&xc(ou),n&K){var i=ou.alternate;null!==i&&sc(i)}switch(1038&n){case 2:pc(ou),ou.flags&=-3;break;case 6:pc(ou),ou.flags&=-3,gc(ou.alternate,ou);break;case Z:ou.flags&=-1025;break;case 1028:ou.flags&=-1025,gc(ou.alternate,ou);break;case 4:gc(ou.alternate,ou);break;case 8:vc(e,ou)}Zi(),ou=ou.nextEffect}}function td(e,t){for(;null!==ou;){Ji(ou);var n=ou.flags;36&n&&rc(e,ou.alternate,ou),n&K&&ac(ou),Zi(),ou=ou.nextEffect}}function nd(){if(90!==du){var e=du>_i?_i:du;return du=90,Li(e,ad)}return!1}function id(e,t){hu.push(t,e),cu||(cu=!0,Oi(_i,(function(){return nd(),null})))}function rd(e,t){fu.push(t,e),e.flags|=Q;var n=e.alternate;null!==n&&(n.flags|=Q),cu||(cu=!0,Oi(_i,(function(){return nd(),null})))}function od(e){var t=e.create;e.destroy=t()}function ad(){if(null===uu)return!1;var e=uu,t=pu;if(uu=null,pu=0,48&Wc)throw Error("Cannot flush passive effects while already rendering.");Cu=!0;var n=Wc;Wc|=Uc;var i=Wu(e),r=fu;fu=[];for(var o=0;o<r.length;o+=2){var a=r[o],s=r[o+1],l=a.destroy;a.destroy=void 0,s.flags&=-8193;var c=s.alternate;if(null!==c&&(c.flags&=-8193),"function"==typeof l){if(Ji(s),Xl(null,l,null),Ql()){if(null===s)throw Error("Should be working on an effect.");ud(s,Zl())}Zi()}}var u=hu;hu=[];for(var d=0;d<u.length;d+=2){var p=u[d],h=u[d+1];if(Ji(h),Xl(null,od,null,p),Ql()){if(null===h)throw Error("Should be working on an effect.");ud(h,Zl())}Zi()}for(var f=e.current.firstEffect;null!==f;){var m=f.nextEffect;f.nextEffect=null,8&f.flags&&Ld(f),f=m}return Vu(i),Pd(e,t),Cu=!1,Wc=n,zi(),yu=null===uu?0:yu+1,!0}function sd(e){return null!==lu&&lu.has(e)}var ld=function(e){au||(au=!0,su=e)};function cd(e,t,n){Rr(e,Ol(e,Rl(n,t),1));var i=_u(),r=Pu(e,1);null!==r&&(oi(r,1,i),Nu(r,i),Td(r,1))}function ud(e,t){if(3!==e.tag)for(var n=e.return;null!==n;){if(3===n.tag)return void cd(n,e,t);if(1===n.tag){var i=n.type,r=n.stateNode;if("function"==typeof i.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&!sd(r)){var o=Rl(t,e);Rr(n,Fl(n,o,1));var a=_u(),s=Pu(n,1);if(null!==s)oi(s,1,a),Nu(s,a),Td(s,1);else if("function"==typeof r.componentDidCatch&&!sd(r))try{r.componentDidCatch(t,o)}catch(e){}return}}n=n.return}else cd(e,e,t)}function dd(e,t,n){var i=e.pingCache;null!==i&&i.delete(t);var r=_u();ai(e,n),Vc===e&&ti(Gc,n)&&(4===Yc||3===Yc&&Qn(Gc)&&Di()-tu<500?Fu(e,0):$c=ni($c,n)),Nu(e,r),Td(e,n)}function pd(e,t){var n;null!==(n=e.stateNode)&&n.delete(t),function(e,t){0===t&&(t=function(e){var t,n=e.mode;return 2&n?4&n?(0===xu&&(xu=Qc),0===(t=Jn(Dn&~xu))&&(t=Jn(Dn)),t):Ri()===Si?1:2:1}(e));var n=_u(),i=Pu(e,t);null!==i&&(oi(i,t,n),Nu(i,n),Td(i,t))}(e,0)}var hd=null;function fd(e){if(!(Wc&Hc)&&6&e.mode){var t=e.tag;if(2===t||3===t||1===t||0===t||t===h||t===v||t===g||t===x){var n=G(e.type)||"ReactComponent";if(null!==hd){if(hd.has(n))return;hd.add(n)}else hd=new Set([n]);var i=Yi;try{Ji(e),u("Can't perform a React state update on a component that hasn't mounted yet. This indicates that you have a side-effect in your render function that asynchronously later calls tries to update the component. Move this work to useEffect instead.")}finally{i?Ji(e):Zi()}}}}var md,vd=null;md=function(e,t,n){var i=pp(null,t);try{return _l(e,t,n)}catch(r){if(null!==r&&"object"==typeof r&&"function"==typeof r.then)throw r;if(br(),Ia(),Dl(t),pp(t,i),8&t.mode&&As(t),Xl(null,_l,null,e,t,n),Ql())throw Zl();throw r}};var gd,yd=!1;gd=new Set;var bd={current:!1};function Ed(e){if(!0===Ce&&!0===zc.current&&!0!==bd.current){var t=Yi;try{Ji(e),u("It looks like you're using the wrong act() around your test interactions.\nBe sure to use the matching version of act() corresponding to your renderer:\n\n// for react-dom:\nimport {act} from 'react-dom/test-utils';\n// ...\nact(() => ...);\n\n// for react-test-renderer:\nimport TestRenderer from react-test-renderer';\nconst {act} = TestRenderer;\n// ...\nact(() => ...);")}finally{t?Ji(e):Zi()}}}function xd(e){!0===Ce&&1&e.mode&&!1===zc.current&&!1===bd.current&&u("An update to %s ran an effect, but was not wrapped in act(...).\n\nWhen testing, code that causes React state updates should be wrapped into act(...):\n\nact(() => {\n  /* fire events that update state */\n});\n/* assert on the output */\n\nThis ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act",G(e.type))}var wd=function(e){if(!0===Ce&&0===Wc&&!1===zc.current&&!1===bd.current){var t=Yi;try{Ji(e),u("An update to %s inside a test was not wrapped in act(...).\n\nWhen testing, code that causes React state updates should be wrapped into act(...):\n\nact(() => {\n  /* fire events that update state */\n});\n/* assert on the output */\n\nThis ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act",G(e.type))}finally{t?Ji(e):Zi()}}},Cd=!1;function Sd(e,t){return 1e3*t+e.interactionThreadID}function kd(e){null===bu?bu=[e]:bu.push(e)}function _d(e,t,n){if(n.size>0){var i=e.pendingInteractionMap,r=i.get(t);null!=r?n.forEach((function(e){r.has(e)||e.__count++,r.add(e)})):(i.set(t,new Set(n)),n.forEach((function(e){e.__count++})));var o=s.__subscriberRef.current;if(null!==o){var a=Sd(e,t);o.onWorkScheduled(n,a)}}}function Td(e,t){_d(e,t,s.__interactionsRef.current)}function Id(e,t){var n=new Set;if(e.pendingInteractionMap.forEach((function(e,i){ei(t,i)&&e.forEach((function(e){return n.add(e)}))})),e.memoizedInteractions=n,n.size>0){var i=s.__subscriberRef.current;if(null!==i){var r=Sd(e,t);try{i.onWorkStarted(n,r)}catch(e){Oi(Si,(function(){throw e}))}}}}function Pd(e,t){var n,i=e.pendingLanes;try{if(null!==(n=s.__subscriberRef.current)&&e.memoizedInteractions.size>0){var r=Sd(e,t);n.onWorkStopped(e.memoizedInteractions,r)}}catch(e){Oi(Si,(function(){throw e}))}finally{var o=e.pendingInteractionMap;o.forEach((function(e,t){ei(i,t)||(o.delete(t),e.forEach((function(e){if(e.__count--,null!==n&&0===e.__count)try{n.onInteractionScheduledWorkCompleted(e)}catch(e){Oi(Si,(function(){throw e}))}})))}))}}function Nd(){return Bd>0}var Md=a.unstable_flushAllWithoutAsserting,Ad="function"==typeof Md;function Dd(){if(void 0!==Md)try{return Md()}finally{}else try{for(var e=!1;nd();)e=!0;return e}finally{}}function Rd(e){try{Dd(),function(e){if(null===Bc)try{var n=("require"+Math.random()).slice(0,7),i=t&&t[n];Bc=i.call(t,"timers").setImmediate}catch(e){Bc=function(e){!1===Rc&&(Rc=!0,"undefined"==typeof MessageChannel&&u("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}Bc(e)}((function(){Dd()?Rd(e):e()}))}catch(t){e(t)}}var Bd=0;function Ld(e){e.sibling=null,e.stateNode=null}var Od=null,Fd=null,zd=function(e){Od=e};function Hd(e){if(null===Od)return e;var t=Od(e);return void 0===t?e:t.current}function Ud(e){return Hd(e)}function Wd(e){if(null===Od)return e;var t=Od(e);if(void 0===t){if(null!=e&&"function"==typeof e.render){var n=Hd(e.render);if(e.render!==n){var i={$$typeof:A,render:n};return void 0!==e.displayName&&(i.displayName=e.displayName),i}}return e}return t.current}function Vd(e,t){if(null===Od)return!1;var n=e.elementType,i=t.type,r=!1,o="object"==typeof i&&null!==i?i.$$typeof:null;switch(e.tag){case 1:"function"==typeof i&&(r=!0);break;case 0:("function"==typeof i||o===L)&&(r=!0);break;case h:(o===A||o===L)&&(r=!0);break;case v:case g:(o===B||o===L)&&(r=!0);break;default:return!1}if(r){var a=Od(n);if(void 0!==a&&a===Od(i))return!0}return!1}function jd(e){null!==Od&&"function"==typeof WeakSet&&(null===Fd&&(Fd=new WeakSet),Fd.add(e))}var Gd=function(e,t){if(null!==Od){var n=t.staleFamilies,i=t.updatedFamilies;nd(),Bu((function(){Kd(e.current,i,n)}))}},qd=function(e,t){e.context===ln&&(nd(),Bu((function(){fp(t,e,null,null)})))};function Kd(e,t,n){var i=e.alternate,r=e.child,o=e.sibling,a=e.tag,s=e.type,l=null;switch(a){case 0:case g:case 1:l=s;break;case h:l=s.render}if(null===Od)throw new Error("Expected resolveFamily to be set during hot reload.");var c=!1,u=!1;if(null!==l){var d=Od(l);void 0!==d&&(n.has(d)?u=!0:t.has(d)&&(1===a?u=!0:c=!0))}null!==Fd&&(Fd.has(e)||null!==i&&Fd.has(i))&&(u=!0),u&&(e._debugNeedsRemount=!0),(u||c)&&Iu(e,1,Hn),null===r||u||Kd(r,t,n),null!==o&&Kd(o,t,n)}var Yd,Xd=function(e,t){var n=new Set,i=new Set(t.map((function(e){return e.current})));return Qd(e.current,i,n),n};function Qd(e,t,n){var i=e.child,r=e.sibling,o=e.tag,a=e.type,s=null;switch(o){case 0:case g:case 1:s=a;break;case h:s=a.render}var l=!1;null!==s&&t.has(s)&&(l=!0),l?function(e,t){if(!function(e,t){for(var n=e,i=!1;;){if(5===n.tag)i=!0,t.add(n.stateNode);else if(null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)return i;for(;null===n.sibling;){if(null===n.return||n.return===e)return i;n=n.return}n.sibling.return=n.return,n=n.sibling}return!1}(e,t))for(var n=e;;){switch(n.tag){case 5:return void t.add(n.stateNode);case 4:case 3:return void t.add(n.stateNode.containerInfo)}if(null===n.return)throw new Error("Expected to reach root first.");n=n.return}}(e,n):null!==i&&Qd(i,t,n),null!==r&&Qd(r,t,n)}Yd=!1;try{var Zd=Object.preventExtensions({});new Map([[Zd,null]]),new Set([Zd])}catch(e){Yd=!0}var Jd=1;function $d(e,t,n,i){this.tag=e,this.key=n,this.elementType=null,this.type=null,this.stateNode=null,this.return=null,this.child=null,this.sibling=null,this.index=0,this.ref=null,this.pendingProps=t,this.memoizedProps=null,this.updateQueue=null,this.memoizedState=null,this.dependencies=null,this.mode=i,this.flags=0,this.nextEffect=null,this.firstEffect=null,this.lastEffect=null,this.lanes=0,this.childLanes=0,this.alternate=null,this.actualDuration=Number.NaN,this.actualStartTime=Number.NaN,this.selfBaseDuration=Number.NaN,this.treeBaseDuration=Number.NaN,this.actualDuration=0,this.actualStartTime=-1,this.selfBaseDuration=0,this.treeBaseDuration=0,this._debugID=Jd++,this._debugSource=null,this._debugOwner=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,Yd||"function"!=typeof Object.preventExtensions||Object.preventExtensions(this)}var ep,tp,np=function(e,t,n,i){return new $d(e,t,n,i)};function ip(e){var t=e.prototype;return!(!t||!t.isReactComponent)}function rp(e,t){var n=e.alternate;null===n?((n=np(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n._debugID=e._debugID,n._debugSource=e._debugSource,n._debugOwner=e._debugOwner,n._debugHookTypes=e._debugHookTypes,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null,n.actualDuration=0,n.actualStartTime=-1),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue;var i=e.dependencies;switch(n.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.selfBaseDuration=e.selfBaseDuration,n.treeBaseDuration=e.treeBaseDuration,n._debugNeedsRemount=e._debugNeedsRemount,n.tag){case 2:case 0:case g:n.type=Hd(e.type);break;case 1:n.type=Ud(e.type);break;case h:n.type=Wd(e.type)}return n}function op(e,t){e.flags&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null;var n=e.alternate;if(null===n)e.childLanes=0,e.lanes=t,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null,e.selfBaseDuration=0,e.treeBaseDuration=0;else{e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type;var i=n.dependencies;e.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext},e.selfBaseDuration=n.selfBaseDuration,e.treeBaseDuration=n.treeBaseDuration}return e}function ap(e,t,n,i,r,o){var a=2,s=e;if("function"==typeof e)ip(e)?(a=1,s=Ud(s)):s=Hd(s);else if("string"==typeof e)a=5;else e:switch(e){case T:return lp(n.children,r,o,t);case F:a=8,r|=16;break;case I:a=8,r|=1;break;case P:return function(e,t,n,i){"string"!=typeof e.id&&u('Profiler must specify an "id" as a prop');var r=np(f,e,i,8|t);return r.elementType=P,r.type=P,r.lanes=n,r.stateNode={effectDuration:0,passiveEffectDuration:0},r}(n,r,o,t);case D:return function(e,t,n,i){var r=np(m,e,i,t);return r.type=D,r.elementType=D,r.lanes=n,r}(n,r,o,t);case R:return function(e,t,n,i){var r=np(b,e,i,t);return r.type=R,r.elementType=R,r.lanes=n,r}(n,r,o,t);case z:return cp(n,r,o,t);case H:return function(e,t,n,i){var r=np(C,e,i,t);return r.type=H,r.elementType=H,r.lanes=n,r}(n,r,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case N:a=p;break e;case M:a=9;break e;case A:a=h,s=Wd(s);break e;case B:a=v;break e;case L:a=16,s=null;break e;case O:a=x;break e}var l="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(l+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var c=i?G(i.type):null;throw c&&(l+="\n\nCheck the render method of `"+c+"`."),Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: "+(null==e?e:typeof e)+"."+l)}var d=np(a,n,t,r);return d.elementType=e,d.type=s,d.lanes=o,d._debugOwner=i,d}function sp(e,t,n){var i;i=e._owner;var r=ap(e.type,e.key,e.props,i,t,n);return r._debugSource=e._source,r._debugOwner=e._owner,r}function lp(e,t,n,i){var r=np(7,e,i,t);return r.lanes=n,r}function cp(e,t,n,i){var r=np(w,e,i,t);return r.type=z,r.elementType=z,r.lanes=n,r}function up(e,t,n){var i=np(6,e,null,t);return i.lanes=n,i}function dp(e,t,n){var i=null!==e.children?e.children:[],r=np(4,i,e.key,t);return r.lanes=n,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function pp(e,t){return null===e&&(e=np(2,null,null,0)),e.tag=t.tag,e.key=t.key,e.elementType=t.elementType,e.type=t.type,e.stateNode=t.stateNode,e.return=t.return,e.child=t.child,e.sibling=t.sibling,e.index=t.index,e.ref=t.ref,e.pendingProps=t.pendingProps,e.memoizedProps=t.memoizedProps,e.updateQueue=t.updateQueue,e.memoizedState=t.memoizedState,e.dependencies=t.dependencies,e.mode=t.mode,e.flags=t.flags,e.nextEffect=t.nextEffect,e.firstEffect=t.firstEffect,e.lastEffect=t.lastEffect,e.lanes=t.lanes,e.childLanes=t.childLanes,e.alternate=t.alternate,e.actualDuration=t.actualDuration,e.actualStartTime=t.actualStartTime,e.selfBaseDuration=t.selfBaseDuration,e.treeBaseDuration=t.treeBaseDuration,e._debugID=t._debugID,e._debugSource=t._debugSource,e._debugOwner=t._debugOwner,e._debugNeedsRemount=t._debugNeedsRemount,e._debugHookTypes=t._debugHookTypes,e}function hp(e,t,n){switch(this.tag=t,this.containerInfo=e,this.pendingChildren=null,this.current=null,this.pingCache=null,this.finishedWork=null,this.timeoutHandle=xe,this.context=null,this.pendingContext=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=ri(0),this.expirationTimes=ri(Hn),this.pendingLanes=0,this.suspendedLanes=0,this.pingedLanes=0,this.expiredLanes=0,this.mutableReadLanes=0,this.finishedLanes=0,this.entangledLanes=0,this.entanglements=ri(0),_e&&(this.mutableSourceEagerHydrationData=null),this.interactionThreadID=s.unstable_getThreadID(),this.memoizedInteractions=new Set,this.pendingInteractionMap=new Map,t){case 1:this._debugRootType="createBlockingRoot()";break;case 2:this._debugRootType="createRoot()";break;case 0:this._debugRootType="createLegacyRoot()"}}function fp(e,t,n,i){!function(e,t){if(Sn&&"function"==typeof Sn.onScheduleFiberRoot)try{Sn.onScheduleFiberRoot(Cn,e,t)}catch(e){kn||(kn=!0,u("React instrumentation encountered an error: %s",e))}}(t,e);var r,o=t.current,s=_u();"undefined"!=typeof jest&&(r=o,!1===Cd&&void 0===a.unstable_flushAllWithoutAsserting&&(2&r.mode||4&r.mode)&&(Cd=!0,u("In Concurrent or Sync modes, the \"scheduler\" module needs to be mocked to guarantee consistent behaviour across tests and browsers. For example, with jest: \njest.mock('scheduler', () => require('scheduler/unstable_mock'));\n\nFor more info, visit https://reactjs.org/link/mock-scheduler")),Ed(o));var l=Tu(o),c=function(e){if(!e)return ln;var t=S(e),n=function(e){if(!function(e){return ie(e)===e}(e)||1!==e.tag)throw Error("Expected subtree parent to be a mounted class component. This error is likely caused by a bug in React. Please file an issue.");var t=e;do{switch(t.tag){case 3:return t.stateNode.context;case 1:if(vn(t.type))return t.stateNode.__reactInternalMemoizedMergedChildContext}t=t.return}while(null!==t);throw Error("Found unexpected detached subtree parent. This error is likely caused by a bug in React. Please file an issue.")}(t);if(1===t.tag){var i=t.type;if(vn(i))return En(t,i,n)}return n}(n);null===t.context?t.context=c:t.pendingContext=c,Xi&&null!==Yi&&!ep&&(ep=!0,u("Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.\n\nCheck the render method of %s.",G(Yi.type)||"Unknown"));var d=Dr(s,l);return d.payload={element:e},null!==(i=void 0===i?null:i)&&("function"!=typeof i&&u("render(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",i),d.callback=i),Rr(o,d),Iu(o,l,s),l}function mp(e,t){var n=e.memoizedState;null!==n&&null!==n.dehydrated&&(n.retryLane=function(e,t){return 0!==e&&e<t?e:t}(n.retryLane,t))}function vp(e,t){mp(e,t);var n=e.alternate;n&&mp(n,t)}ep=!1,tp={};var gp=function(e){return!1};function yp(e){return gp(e)}var bp,Ep,xp,wp,Cp,Sp,kp,_p,Tp=function(e,t,n){var i=t[n],r=Array.isArray(e)?e.slice():o({},e);return n+1===t.length?(Array.isArray(r)?r.splice(i,1):delete r[i],r):(r[i]=Tp(e[i],t,n+1),r)},Ip=function(e,t){return Tp(e,t,0)},Pp=function(e,t,n,i){var r=t[i],a=Array.isArray(e)?e.slice():o({},e);return i+1===t.length?(a[n[i]]=a[r],Array.isArray(a)?a.splice(r,1):delete a[r]):a[r]=Pp(e[r],t,n,i+1),a},Np=function(e,t,n){if(t.length===n.length){for(var i=0;i<n.length-1;i++)if(t[i]!==n[i])return void c("copyWithRename() expects paths to be the same except for the deepest key");return Pp(e,t,n,0)}c("copyWithRename() expects paths of the same length")},Mp=function(e,t,n,i){if(n>=t.length)return i;var r=t[n],a=Array.isArray(e)?e.slice():o({},e);return a[r]=Mp(e[r],t,n+1,i),a},Ap=function(e,t,n){return Mp(e,t,0,n)},Dp=function(e,t){for(var n=e.memoizedState;null!==n&&t>0;)n=n.next,t--;return n};function Rp(e){var t=ae(e);return null===t?null:t.stateNode}function Bp(e){return null}function Lp(){return Yi}return bp=function(e,t,n,i){var r=Dp(e,t);if(null!==r){var a=Ap(r.memoizedState,n,i);r.memoizedState=a,r.baseState=a,e.memoizedProps=o({},e.memoizedProps),Iu(e,1,Hn)}},Ep=function(e,t,n){var i=Dp(e,t);if(null!==i){var r=Ip(i.memoizedState,n);i.memoizedState=r,i.baseState=r,e.memoizedProps=o({},e.memoizedProps),Iu(e,1,Hn)}},xp=function(e,t,n,i){var r=Dp(e,t);if(null!==r){var a=Np(r.memoizedState,n,i);r.memoizedState=a,r.baseState=a,e.memoizedProps=o({},e.memoizedProps),Iu(e,1,Hn)}},wp=function(e,t,n){e.pendingProps=Ap(e.memoizedProps,t,n),e.alternate&&(e.alternate.pendingProps=e.pendingProps),Iu(e,1,Hn)},Cp=function(e,t){e.pendingProps=Ip(e.memoizedProps,t),e.alternate&&(e.alternate.pendingProps=e.pendingProps),Iu(e,1,Hn)},Sp=function(e,t,n){e.pendingProps=Np(e.memoizedProps,t,n),e.alternate&&(e.alternate.pendingProps=e.pendingProps),Iu(e,1,Hn)},kp=function(e){Iu(e,1,Hn)},_p=function(e){gp=e},i.IsThisRendererActing=bd,i.act=function(e){var t=Bd;Bd++;var n,i=zc.current,r=bd.current;function o(){Bd--,zc.current=i,bd.current=r,Bd>t&&u("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. ")}zc.current=!0,bd.current=!0;try{n=Ru(e)}catch(e){throw o(),e}if(null!==n&&"object"==typeof n&&"function"==typeof n.then){var a=!1;return"undefined"!=typeof Promise&&Promise.resolve().then((function(){})).then((function(){!1===a&&u("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);")})),{then:function(e,t){a=!0,n.then((function(){if(Bd>1||!0===Ad&&!0===i)return o(),void e();Rd((function(n){o(),n?t(n):e()}))}),(function(e){o(),t(e)}))}}}void 0!==n&&u("The callback passed to act(...) function must return undefined, or a Promise. You returned %s",n);try{1!==Bd||!1!==Ad&&!1!==i||Dd(),o()}catch(e){throw o(),e}return{then:function(e){u("Do not await the result of calling act(...) with sync logic, it is not a Promise."),e()}}},i.attemptContinuousHydration=function(e){if(e.tag===m){var t=_u(),n=Bn;Iu(e,n,t),vp(e,n)}},i.attemptHydrationAtCurrentPriority=function(e){if(e.tag===m){var t=_u(),n=Tu(e);Iu(e,n,t),vp(e,n)}},i.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.hydrate){var n=function(e){return Gn(e.pendingLanes)}(t);!function(e,t){!function(e,t){e.expiredLanes|=t&e.pendingLanes}(e,t),Nu(e,Di()),!(48&Wc)&&(iu(),zi())}(t,n)}break;case m:var i=_u();Bu((function(){return Iu(e,1,i)})),vp(e,4)}},i.attemptUserBlockingHydration=function(e){e.tag===m&&(Iu(e,4,_u()),vp(e,4))},i.batchedEventUpdates=function(e,t){var n=Wc;Wc|=2;try{return e(t)}finally{0===(Wc=n)&&(iu(),zi())}},i.batchedUpdates=Ru,i.createComponentSelector=function(e){return{$$typeof:wc,value:e}},i.createContainer=function(e,t,n,i){return function(e,t,n,i){var r=new hp(e,t,n),o=function(e){var t;return t=2===e?7:1===e?3:0,_n&&(t|=8),np(3,null,null,t)}(t);return r.current=o,o.stateNode=r,Mr(o),r}(e,t,n)},i.createHasPsuedoClassSelector=function(e){return{$$typeof:Cc,value:e}},i.createPortal=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},i.createRoleSelector=function(e){return{$$typeof:Sc,value:e}},i.createTestNameSelector=function(e){return{$$typeof:kc,value:e}},i.createTextSelector=function(e){return{$$typeof:_c,value:e}},i.deferredUpdates=function(e){return Li(_i,e)},i.discreteUpdates=function(e,t,n,i,r){var o=Wc;Wc|=4;try{return Li(ki,e.bind(null,t,n,i,r))}finally{0===(Wc=o)&&(iu(),zi())}},i.findAllNodes=Ac,i.findBoundingRects=function(e,t){if(!De)throw Error("Test selector API is not supported by this renderer.");for(var n=Ac(e,t),i=[],r=0;r<n.length;r++)i.push(Be(n[r]));for(var o=i.length-1;o>0;o--)for(var a=i[o],s=a.x,l=s+a.width,c=a.y,u=c+a.height,d=o-1;d>=0;d--)if(o!==d){var p=i[d],h=p.x,f=h+p.width,m=p.y,v=m+p.height;if(s>=h&&c>=m&&l<=f&&u<=v){i.splice(o,1);break}if(!(s!==h||a.width!==p.width||v<c||m>u)){m>c&&(p.height+=m-c,p.y=c),v<u&&(p.height=u-m),i.splice(o,1);break}if(!(c!==m||a.height!==p.height||f<s||h>l)){h>s&&(p.width+=h-s,p.x=s),f<l&&(p.width=l-h),i.splice(o,1);break}}return i},i.findHostInstance=function(e){var t=S(e);if(void 0===t)throw"function"==typeof e.render?Error("Unable to find node on an unmounted component."):Error("Argument appears to not be a ReactComponent. Keys: "+Object.keys(e));var n=ae(t);return null===n?null:n.stateNode},i.findHostInstanceWithNoPortals=function(e){var t=function(e){var t=oe(e);if(!t)return null;for(var n=t;;){if(5===n.tag||6===n.tag)return n;if(n.child&&4!==n.tag)n.child.return=n,n=n.child;else{if(n===t)return null;for(;!n.sibling;){if(!n.return||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}}return null}(e);return null===t?null:t.tag===E?t.stateNode.instance:t.stateNode},i.findHostInstanceWithWarning=function(e,t){var n=S(e);if(void 0===n)throw"function"==typeof e.render?Error("Unable to find node on an unmounted component."):Error("Argument appears to not be a ReactComponent. Keys: "+Object.keys(e));var i=ae(n);if(null===i)return null;if(1&i.mode){var r=G(n.type)||"Component";if(!tp[r]){tp[r]=!0;var o=Yi;try{Ji(i),1&n.mode?u("%s is deprecated in StrictMode. %s was passed an instance of %s which is inside StrictMode. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",t,t,r):u("%s is deprecated in StrictMode. %s was passed an instance of %s which renders StrictMode children. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",t,t,r)}finally{o?Ji(o):Zi()}}}return i.stateNode},i.flushControlled=function(e){var t=Wc;Wc|=1;try{Li(Si,e)}finally{0===(Wc=t)&&(iu(),zi())}},i.flushDiscreteUpdates=function(){49&Wc?Wc&Hc&&u("unstable_flushDiscreteUpdates: Cannot flush updates when React is already rendering."):(function(){if(null!==mu){var e=mu;mu=null,e.forEach((function(e){!function(e){e.expiredLanes|=24&e.pendingLanes}(e),Nu(e,Di())}))}zi()}(),nd())},i.flushPassiveEffects=nd,i.flushSync=Bu,i.focusWithin=function(e,t){if(!De)throw Error("Test selector API is not supported by this renderer.");for(var n=Mc(Ic(e),t),i=Array.from(n),r=0;r<i.length;){var o=i[r++];if(!Oe(o)){if(5===o.tag){var a=o.stateNode;if(ze(a))return!0}for(var s=o.child;null!==s;)i.push(s),s=s.sibling}}return!1},i.getCurrentUpdateLanePriority=Wn,i.getFindAllNodesFailureDescription=function(e,t){if(!De)throw Error("Test selector API is not supported by this renderer.");for(var n=0,i=[],r=[Ic(e),0],o=0;o<r.length;){var a=r[o++],s=r[o++],l=t[s];if((5!==a.tag||!Oe(a))&&(Pc(a,l)&&(i.push(Nc(l)),++s>n&&(n=s)),s<t.length))for(var c=a.child;null!==c;)r.push(c,s),c=c.sibling}if(n<t.length){for(var u=[],d=n;d<t.length;d++)u.push(Nc(t[d]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+u.join(" > ")}return null},i.getPublicRootInstance=function(e){var t=e.current;return t.child?5===t.child.tag?le(t.child.stateNode):t.child.stateNode:null},i.injectIntoDevTools=function(e){var t=e.findFiberByHostInstance,n=l.ReactCurrentDispatcher;return function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled)return!0;if(!t.supportsFiber)return u("The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://reactjs.org/link/react-devtools"),!0;try{Cn=t.inject(e),Sn=t}catch(e){u("React instrumentation encountered an error: %s.",e)}return!0}({bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:bp,overrideHookStateDeletePath:Ep,overrideHookStateRenamePath:xp,overrideProps:wp,overridePropsDeletePath:Cp,overridePropsRenamePath:Sp,setSuspenseHandler:_p,scheduleUpdate:kp,currentDispatcherRef:n,findHostInstanceByFiber:Rp,findFiberByHostInstance:t||Bp,findHostInstancesForRefresh:Xd,scheduleRefresh:Gd,scheduleRoot:qd,setRefreshHandler:zd,getCurrentFiber:Lp})},i.observeVisibleRects=function(e,t,n,i){if(!De)throw Error("Test selector API is not supported by this renderer.");var r=Ac(e,t),o=He(r,n,i),a=o.disconnect,s=o.observe,l=o.unobserve,c=function(){var n=Ac(e,t);r.forEach((function(e){n.indexOf(e)<0&&l(e)})),n.forEach((function(e){r.indexOf(e)<0&&s(e)}))};return Dc.push(c),{disconnect:function(){var e=Dc.indexOf(c);e>=0&&Dc.splice(e,1),a()}}},i.registerMutableSourceForHydration=function(e,t){var n=(0,t._getVersion)(t._source);null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},i.runWithPriority=function(e,t){var n=Wn();try{return Vn(e),t()}finally{Vn(n)}},i.shouldSuspend=yp,i.unbatchedUpdates=function(e,t){var n=Wc;Wc&=-2,Wc|=8;try{return e(t)}finally{0===(Wc=n)&&(iu(),zi())}},i.updateContainer=fp,i})}(Oo),"production"===process.env.NODE_ENV?To.exports=Io.exports:To.exports=Oo.exports;var Wo=To.exports,Vo={};function jo(e,t){var n;e.appendChild&&(e.appendChild(t),null===(n=t.didMount)||void 0===n||n.call(t,t,e))}function Go(e,t){var n,i,r,o,a;null===(n=t.willUnmount)||void 0===n||n.call(t,t,e),!1!==(null===(i=null==t?void 0:t.config)||void 0===i?void 0:i.destroyChildren)&&(null===(r=t.children)||void 0===r?void 0:r.length)&&R([],t.children,!0).forEach((function(e){Go(t,e)})),null===(o=e.removeChild)||void 0===o||o.call(e,t),!1!==(null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.destroy)&&t.destroy()}function qo(e,t,n){if(t===n)oo("react-paint: PaintFiber cannot insert node before itself");else if(e.children){var i=e,r=-1!==i.children.indexOf(t),o=i.getChildIndex(n);r?i.setChildIndex(t,o):i.addChildAt(t,o)}else oo("parent error")}var Ko={getRootHostContext:function(){return Vo},getChildHostContext:function(){return Vo},getPublicInstance:function(e){return e},prepareForCommit:function(){return null},resetAfterCommit:function(){},createInstance:function(e,t){var n;void 0===t&&(t={});var i=po[e];i||oo("unsupport type "+e);var r=i(t);return null===(n=r.applyProps)||void 0===n||n.call(r,{},t),r},hideInstance:function(e){e.hide=!0},unhideInstance:function(e,t){var n=!(null==t||!t.hasOwnProperty("hide"))&&t.hide;e.hide=n},finalizeInitialChildren:function(e,t,n){return!1},prepareUpdate:function(e,t,n,i,r,o){return function(e,t,n,i,r){var o=null;for(var a in n)!i.hasOwnProperty(a)&&n.hasOwnProperty(a)&&null!=n[a]&&("children"===a||(o||(o=[]),o.push(a,null)));for(var a in i){var s=i[a],l=null!=n?n[a]:void 0;!i.hasOwnProperty(a)||s===l||null==s&&null==l||"children"===a||(o||(o=[]),o.push(a,s))}return o}(0,0,n,i)},shouldSetTextContent:function(e,t){return!1},createTextInstance:function(e,t,n){oo('react-paint: Error trying to add text node "'+e+'"PaintFiber does not support text nodes as children of a Paint.js component. To pass a string value to your component, use a property other than children. If you wish to display some text, you can use &lt;Text text={string} /&gt; instead.')},unhideTextInstance:function(e,t){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,noTimeout:-1,warnsIfNotActing:!1,isPrimaryRenderer:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,appendInitialChild:function(e,t){jo(e,t)},appendChild:function(e,t){jo(e,t)},appendChildToContainer:function(e,t){jo(e,t)},removeChild:function(e,t){Go(e,t)},removeChildFromContainer:function(e,t){Go(e,t)},insertBefore:qo,insertInContainerBefore:function(e,t,n){qo(e,t,n)},commitUpdate:function(e,t,n,i,r){var o;null===(o=e.applyProps)||void 0===o||o.call(e,i,r)},commitTextUpdate:function(e,t,n){},resetTextContent:function(e){},clearContainer:function(e){},getInstanceFromNode:function(e){throw new Error("Not yet implemented.")},beforeActiveInstanceBlur:function(){},afterActiveInstanceBlur:function(){},preparePortalMount:function(e){},getCurrentEventPriority:function(){return 0},prepareScopeUpdate:function(e,t){},getInstanceFromScope:function(e){return null},detachDeletedInstance:function(e){}},Yo=Wo(Ko),Xo=function(t){function n(e){var n=t.call(this,e)||this;return n.canvas=null,n}return P(n,t),n.prototype.componentDidMount=function(){var e=this.props,t=e.width,n=e.height,i=e.resolution,r=void 0===i?1:i,o=e.onMount,a=e.children,s=e.noPaint,l=this.canvas;this.frame=new Sr(l,t,n,{resolution:r}),this.container=Yo.createContainer(this.frame.rootPaint,0,null,!1,null,"",ce,null),Yo.updateContainer(a,this.container,this),!s&&this.frame.render(),null==o||o(this.frame)},n.prototype.componentWillUnmount=function(){var e,t;Yo.updateContainer(null,this.container,this);var n=this.frame;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e,n),n.destroy(),this.frame=void 0},n.prototype.componentDidUpdate=function(e,t,n){var i=this.props,r=i.width,o=i.height,a=i.resolution,s=void 0===a?1:a,l=i.children,c=this.frame;e.height===o&&e.width===r&&e.resolution===this.props.resolution||(c.width=r,c.height=o,c.resolution=s,c.resize()),Yo.updateContainer(l,this.container,this)},n.prototype.componentDidCatch=function(e,t){t.componentStack},n.prototype.render=function(){var t=this;return e.createElement("canvas",{ref:function(e){return t.canvas=e}})},n}(e.Component),Qo=/^(https?:\/\/|www\.)[\w-]+\.[\w]{2,}(?::\d*)?(?:\/[\w-.]*)*(?:\?[\w%&=.]*)?(?:#[\w]*)?$/,Zo=/(https?:\/\/|www\.)[\w-]+\.[\w]{2,}(?::\d*)?(?:\/[\w-.]*)*(?:\?[\w%&=.]*)?(?:#[\w]*)?/gi;function Jo(e){var t="",n=e&&e.match(/.*\.([^\.]*)$/);return n&&(t=n[1]),t.toLowerCase()}function $o(e){return"".concat(we).concat(e)}var ea=new Map,ta=function(e,t){if(!e)return 0;var n=ea.get(e);if(n)return(r=n.get(t))||(r=ji(e,{fontSize:t,fontFamily:He}),n.set(t,r)),r;var i=new Map,r=ji(e,{fontSize:t,fontFamily:He});return i.set(t,r),ea.set(e,i),r},na=function(e){return e<1024?"".concat(0|e," B"):e<1048576?"".concat(e/1024|0," KB"):e<1073741824?"".concat(e/1048576|0," MB"):"".concat(e/1073741824|0," GB")},ia=function(){var e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var i=16*Math.random();return e>0?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"===n?i:3&i|8).toString(16)}))},ra=function(e,t){return A(void 0,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return n=e.userManager.uploadSizeLimit,e.beforeUpload?[4,e.beforeUpload()]:[3,2];case 1:if(!i.sent())return[2,!1];i.label=2;case 2:return t&&t.size>n?(e.addToast(O("upload.exceedLimitSize",na(n))),[2,!1]):[2,!0]}}))}))};function oa(e,t){void 0===t&&(t="");try{return JSON.parse(e)}catch(e){return t}}function aa(e){return e.replace(/\u00A0/g," ")}var sa=null;function la(e){sa=e}var ca=new Set,ua=function(){function e(){this.valueStack=[{}],this.value=this.valueStack[0],ca.add(this)}return e.prototype.setContext=function(e){this.valueStack.unshift(e),this.value=e},e.prototype.popContext=function(){this.valueStack.shift(),this.value=this.valueStack[0]},e}(),da=function(){function e(e){this.option=e,this.transformAimed=!1,this.transform=e.transform||new ar(e)}return e.prototype.setTransform=function(e,t){if(!this.transformAimed||t){var n=e.transform;e.context.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),this.transformAimed=!0}},e.prototype.paint=function(t){e.paintCanvas(this,t)},e.prototype.paintSvg=function(t){e.paintSvg(this,t)},e.prototype.beforeClip=function(e){var t=e.context;this.contextCliped||(t.save(),this.contextCliped=!0)},e.prototype.beforePathDrawn=function(e,t){},e.prototype.afterPathDrawn=function(e){},e.prototype.beforeSvgPathDrawn=function(e,t){},e.prototype.afterSvgPathDrawn=function(e){},e.paintCanvas=ha((function(e,t){var n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return n=e.option,i=t.transform,r=t.alpha,o=t.currentPainter,a=t.context,s=i.clone().append(e.transform),t.transform=s,void 0!==n.alpha&&1!==n.alpha&&(t.alpha=r*n.alpha),void 0!==n.globalAlpha&&n.globalAlpha!==t.alpha&&(t.alpha=n.globalAlpha),t.currentPainter=e,e.setTransform(t,!0),[4];case 1:return l.sent(),e.contextCliped&&(e.contextCliped=!1,a.restore()),t.transform=i,t.alpha=r,t.currentPainter=o,o.transformAimed=!1,[2]}}))})),e.paintSvg=ha((function(e,t){var n,i,r,o,a,s,l;return D(this,(function(c){switch(c.label){case 0:return n=Jn("g"),i=e.option,n.setAttribute("transform",$n(e.transform)),r=i.alpha||1,n.setAttribute("opacity",r+""),o=t.currentRoot,a=t.alpha,s=t.currentPainter,i.link?(oi(l=Jn("a"),{href:i.link,target:"_blank"}),o.appendChild(l),l.appendChild(n)):o.appendChild(n),t.currentPainter=e,t.currentRoot=n,t.alpha=a*r,[4];case 1:return c.sent(),t.currentPainter=s,t.currentRoot=o,t.alpha=a,[2]}}))})),e}(),pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.beforePathDrawn=function(e,t){var n=e.context,i=this.option;void 0!==i.lineWidth&&(i.lineWidth*=2,n.save(),n.clip(t))},t.prototype.afterPathDrawn=function(e){var t=this.option;if(void 0!==t.lineWidth){var n=e.context;t.lineWidth/=2,n.restore()}},t.prototype.beforeSvgPathDrawn=function(e,t){var n=e.currentRoot,i=this.option;if(void 0!==i.lineWidth){i.lineWidth*=2,this.svgCurrentRoot=n;var r=Jn("g"),o=Jn("clipPath");o.id=ni();var a=t;o.appendChild(a),n.appendChild(o),n.appendChild(r),ai(r,o),e.currentRoot=r}},t.prototype.afterSvgPathDrawn=function(e){var t=this.option;void 0!==t.lineWidth&&(e.currentRoot=this.svgCurrentRoot,t.lineWidth/=2)},t}(da);function ha(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(void 0,t);i.next(),sa.addPaintTask(i)}}function fa(e){var t=new da(e);sa.processElement(t)}function ma(){sa.finishPaint()}function va(e){var t=new pa(e);sa.processElement(t)}var ga=0,ya=function(){function e(){this.paintTasks=[],this.resolution=1,this.id="".concat(ga++)}return e.prototype.render=function(){la(this),fa({scaleX:this.resolution,scaleY:this.resolution}),this.paint(),this.finishPaint(),la(null),this.paintTasks.length=0},e.prototype.addPaintTask=function(e){this.paintTasks.push(e)},e.prototype.finishPaint=function(){var e=this.paintTasks.pop();null==e||e.next()},e.prototype.destroy=function(){},e}(),ba=function(e){function t(t,n,i,r){void 0===r&&(r={});var o=e.call(this)||this;return o.canvas=t,o.width=n,o.height=i,o.resolution=1,o.clearBeforeRender=!0,r.resolution&&(o.resolution=r.resolution),!1===r.clearBeforeRender&&(o.clearBeforeRender=!1),o.context=t.getContext("2d"),o.context.imageSmoothingEnabled=!1,o.context.textBaseline="alphabetic",o.resize(),o}return P(t,e),Object.defineProperty(t.prototype,"canvasWidth",{get:function(){return this.width*this.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasHeight",{get:function(){return this.height*this.resolution},enumerable:!1,configurable:!0}),t.prototype.setBgRenderer=function(e){this.bgRenderer=e,e&&this.resizeBgRenderer(e)},t.prototype.resizeBgRenderer=function(e){e.width=this.width,e.height=this.height,e.resolution=this.resolution,e.resize()},t.prototype.setRenderClip=function(e){this.renderClip=e},t.prototype.render=function(){var t=this,n=t.context,i=t.canvasWidth,r=t.canvasHeight;if(n){n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,n.fillStyle="black";var o=this.renderClip,a=null;if(o){n.save();var s=this.resolution;a=new Path2D;for(var l=0,c=o;l<c.length;l++){var u=c[l],d=u.x,p=u.y,h=u.width,f=u.height;d=Math.floor(d*s),p=Math.floor(p*s),h=Math.floor(h*s),f=Math.floor(f*s),a.rect(d,p,h,f)}n.clip(a)}this.clearBeforeRender&&n.clearRect(0,0,i,r),"production"!==process.env.NODE_ENV&&window._draw_clip_path_&&a&&(n.fillStyle="red",n.fillRect(0,0,i,r)),la(this),this.currentContext={currentPainter:{},alpha:1,transform:sr,viewWidth:i,viewHeight:r,drawImageCount:0,context:n},e.prototype.render.call(this),this.currentContext=void 0,o&&(n.restore(),this.renderClip=void 0)}},t.prototype.paint=function(){},t.prototype.processElement=function(e){e.paint(this.currentContext)},t.prototype.resize=function(){var e=this,t=e.width,n=e.height,i=e.canvasHeight,r=e.canvasWidth;this.canvas.style.width=t+"px",this.canvas.style.height=n+"px",this.canvas.width=r,this.canvas.height=i,this.bgRenderer&&this.resizeBgRenderer(this.bgRenderer)},t.prototype.base64=function(e){return this.canvas.toDataURL(e)},t.prototype.blob=function(e){var t=this;return new Promise((function(n){t.canvas.toBlob((function(e){n(e)}),e)}))},t}(ya),Ea=function(e){function t(t,n){var i=e.call(this)||this;return i.width=t,i.height=n,i}return P(t,e),t.prototype.exportSvg=function(e){void 0===e&&(e={});var t=e.fonts,n=void 0===t?[]:t,i=this.width,r=this.height,o=Jn("svg");oi(o,{viewBox:"0 0 ".concat(i," ").concat(r),width:i,height:r,xmlns:"http://www.w3.org/2000/svg"});var a=Jn("defs");o.appendChild(a);var s=ei(n);return a.appendChild(s),this.currentContext={currentRoot:o,def:a,imageCache:{},currentPainter:{},alpha:1,transform:sr,viewWidth:i,viewHeight:r},this.render(),this.currentContext=void 0,o},t.prototype.paint=function(){},t.prototype.processElement=function(e){e.paintSvg(this.currentContext)},t}(ya),xa=function(){function e(){}return e.prototype.genPath=function(){return new Path2D},e.prototype.genSvgPath=function(){return Jn("path")},e.prototype.paint=function(e){var t=e.context,n=e.transform,i=e.currentPainter,r=e.alpha;i.setTransform(e);var o=this.genPath();i.beforePathDrawn(e,o);var a=i.option,s=1,l=a.lineWidth;if(l){var c=n.currentScale,u=l*c,d=a.lineDash,p=void 0===d?[]:d,h=a.lineCap,f=0;if(a.preserveLineWidth&&u<1&&(s=.3+.7*u,l=1/c),p.length)if(u<.3)s/=2,p=[];else if(u<=1&&"butt"!=h){var m=l;f=m/2,h="butt",p=p.map((function(e){return e-(m=-m)}))}t.lineDashOffset=f,t.setLineDash(p),t.lineCap=h||"butt",t.lineJoin=a.lineJoin||"miter"}var v=(a.fillAlpha||1)*r;a.fill&&v>0&&(t.globalAlpha=v,t.fillStyle=a.fill,t.fill(o));var g=(a.strokeAlpha||1)*r*s;a.stroke&&l&&g>0&&(t.lineWidth=l,t.globalAlpha=g,t.strokeStyle=a.stroke,t.stroke(o)),e.drawImageCount=0,t.setLineDash([]),t.lineDashOffset=0,i.afterPathDrawn(e)},e.prototype.paintSvg=function(e){e.currentPainter.beforeSvgPathDrawn(e,this.genSvgPath());var t=e.currentPainter,n=e.currentRoot,i=t.option,r=i.fill,o=i.fillAlpha,a=void 0===o?1:o,s=i.stroke,l=i.strokeAlpha,c=void 0===l?1:l,u=i.lineWidth,d=i.lineCap,p=void 0===d?"butt":d,h=i.lineJoin,f=void 0===h?"miter":h,m=i.lineDash,v=void 0===m?[]:m,g=this.genSvgPath();r&&a>0?oi(g,{fill:r,"fill-opacity":a}):ri(g,"fill-opacity",0),s&&u&&c>0&&(oi(g,{stroke:s,"stroke-opacity":c,"stroke-width":u,"stroke-linecap":p,"stroke-linejoin":f}),v.length&&ri(g,"stroke-dasharray",v.join(","))),n.appendChild(g),e.currentPainter.afterSvgPathDrawn(e)},e}(),wa=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n}return P(t,e),t.prototype.genPath=function(){var t=e.prototype.genPath.call(this),n=this.data;return t.rect(n.x,n.y,n.width,n.height),t},t.prototype.genSvgPath=function(){var e=Jn("rect"),t=this.data;return oi(e,{x:t.x,y:t.y,width:t.width,height:t.height}),e},t}(xa),Ca=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n}return P(t,e),t.prototype.genPath=function(){var t=e.prototype.genPath.call(this),n=this.data;return t.ellipse(n.cx,n.cy,n.rx,n.ry,0,0,2*Math.PI),t},t.prototype.genSvgPath=function(){var e=Jn("ellipse"),t=this.data;return oi(e,{cx:t.cx,cy:t.cy,rx:t.rx,ry:t.ry}),e},t}(xa),Sa=function(e){function t(t,n){var i=e.call(this)||this;return i.data=t,n&&(i.clipRule=n),i}return P(t,e),t.prototype.genPath=function(){var e=this.data,t=this.data.path2D;if(t)return t;var n=new Path2D;if(null==e?void 0:e.length)for(var i=0;i<e.length;i++){var r=e[i];switch(0===i&&"M"!==r[0]&&n.moveTo(0,0),r[0]){case"M":n.moveTo(r[1],r[2]);break;case"L":n.lineTo(r[1],r[2]);break;case"Q":n.quadraticCurveTo(r[1],r[2],r[3],r[4]);break;case"C":n.bezierCurveTo(r[1],r[2],r[3],r[4],r[5],r[6]);break;case"R":n.arcTo(r[1],r[2],r[3],r[4],r[5]);break;case"Z":n.closePath()}}return this.data.path2D=n,n},t.prototype.genSvgPath=function(){var t=e.prototype.genSvgPath.call(this),n=this.data;if(null==n?void 0:n.length){for(var i=[],r={x:0,y:0},o=0;o<n.length;o++){var a=n[o];switch(0===o&&"M"!==a[0]&&i.push("M 0,0"),a[0]){case"M":case"L":case"Q":case"C":case"Z":for(var s=a[0],l=1;l<a.length;l+=2)s+=" "+a[l]+","+a[l+1],r={x:a[l],y:a[l+1]};i.push(s);break;case"R":var c=r,u={x:a[1],y:a[2]},d={x:a[3],y:a[4]},p=a[5],h=si(c,u,d,p),f=h.start,m=h.end,v=h.antiClock;i.push("L ".concat(f.x,",").concat(f.y),"A ".concat(p," ").concat(p," 0 0 ").concat(v?0:1," ").concat(m.x,",").concat(m.y),"L ".concat(d.x,",").concat(d.y)),r=d}}ri(t,"d",i.join(" "))}return t},t}(xa);function ka(e){var t=new wa(e);sa.processElement(t)}function _a(e){var t=new Ca(e);sa.processElement(t)}function Ta(e){var t=new Sa(e);sa.processElement(t)}var Ia=function(){function e(e,t){this.draw=e,this.option=t,this.pathDatas=[],this.startPos={x:0,y:0}}return e.prototype.reset=function(){this.strokeStyle=void 0,this.fillStyle=void 0,this.currentPath=void 0},e.prototype.createData=function(e,t){var n={path:e};return this.strokeStyle&&(n.stroke=exports.E({},this.strokeStyle)),t&&(n.closed=!0,this.fillStyle&&(n.fill=this.fillStyle)),n},e.prototype.addData=function(e,t){var n=this.createData(e,t);t||(this.currentPath=n),this.pathDatas.push(n)},e.prototype.createEmptyData=function(){var e=new Path2D;return e.moveTo(this.startPos.x,this.startPos.y),this.createData(e)},e.prototype.getCurrentPath=function(){return this.currentPath||(this.currentPath=this.createEmptyData(),this.pathDatas.push(this.currentPath)),this.currentPath},e.prototype.moveTo=function(e,t){this.currentPath?this.currentPath.path.moveTo(e,t):this.startPos={x:e,y:t}},e.prototype.lineStyle=function(e,t,n){if("number"==typeof e){var i={width:e};void 0!==t&&(i.color=t),void 0!==n&&(i.alpha=n),this.strokeStyle=exports.E(exports.E({},this.strokeStyle),i)}else this.strokeStyle=e||void 0},e.prototype.drawCircle=function(e,t,n){this.currentPath=void 0;var i=new Path2D;i.arc(e,t,n,0,2*Math.PI),this.addData(i,!0)},e.prototype.arc=function(e,t,n,i,r,o){this.currentPath=void 0;var a=new Path2D;a.arc(e,t,n,i,r,o),this.addData(a)},e.prototype.arcTo=function(e,t,n,i,r){this.getCurrentPath().path.arcTo(e,t,n,i,r)},e.prototype.drawPolygon=function(e){this.currentPath=void 0;for(var t=new Path2D,n=0;n<e.length;n+=2)0==n?t.moveTo(e[n],e[n+1]):t.lineTo(e[n],e[n+1]);t.closePath(),this.addData(t,!0)},e.prototype.drawRoundedRect=function(e,t,n,i,r,o,a,s){var l=new Path2D,c=r,u=void 0===o?r:o,d=void 0===a?r:a,p=void 0===s?r:s,h=Math.min(n,i)/2|0;c=c>h&&h||c,u=u>h&&h||u,d=d>h&&h||d,p=p>h&&h||p,l.moveTo(e+n-u,t),l.arcTo(e+n,t,e+n,t+u,u),l.lineTo(e+n,t+i-d),l.arcTo(e+n,t+i,e+n-d,t+i,d),l.lineTo(e+p,t+i),l.arcTo(e,t+i,e,t+i-p,p),l.lineTo(e,t+c),l.arcTo(e,t,e+c,t,c),l.closePath(),this.addData(l,!0)},e.prototype.drawEllipse=function(e,t,n,i){this.currentPath=void 0;var r=new Path2D;r.ellipse(e,t,n,i,0,0,2*Math.PI),this.addData(r,!0)},e.prototype.quadraticCurveTo=function(e,t,n,i){this.getCurrentPath().path.quadraticCurveTo(e,t,n,i)},e.prototype.bezierCurveTo=function(e,t,n,i,r,o){this.getCurrentPath().path.bezierCurveTo(e,t,n,i,r,o)},e.prototype.closePath=function(){var e=this.currentPath;e&&(e.path.closePath(),e.closed=!0,this.fillStyle&&(e.fill=this.fillStyle))},e.prototype.lineTo=function(e,t){this.getCurrentPath().path.lineTo(e,t)},e.prototype.beginFill=function(e,t){void 0===t&&(t=1),this.fillStyle={color:e,alpha:t}},e.prototype.drawRect=function(e,t,n,i){this.currentPath=void 0;var r=new Path2D;r.rect(e,t,n,i),this.addData(r,!0)},e.prototype.clear=function(){this.pathDatas=[],this.currentPath=void 0},e.prototype.endFill=function(){this.fillStyle=void 0},e.prototype.paint=function(e){var t=this.draw,n=this.option,i=e.transform,r=e.context,o=e.alpha,a=e.currentPainter,s=i;n?(s=i.append(new ar(n)),r.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),a.transformAimed=!1):a.setTransform(e);var l=t.pathDatas;l||(t.call(this,this),l=this.pathDatas,t.pathDatas=l);for(var c=function(e){var t=e.path,n=e.closed,i=e.stroke,l=e.fill;if(l&&n){var c=l.color,u=void 0===c?0:c,d=l.alpha,p=void 0===d?1:d;p>0&&(r.globalAlpha=o*p,r.fillStyle=pr(u),r.fill(t))}if(!i||0===i.width||0===i.alpha)return"continue";var h=i.width,f=void 0===h?1:h,m=i.alpha,v=void 0===m?1:m,g=i.lineDash,y=void 0===g?[]:g,b=i.cap,E=void 0===b?"butt":b,x=s.currentScale,w=1,C=f*x,S=0;if(a.option.preserveLineWidth&&C<1&&(w=.3+.7*C,f=1/x),y.length)if(C<.3)w/=2,y=[];else if(C<=1&&"butt"!=E){var k=f;S=k/2,E="butt",y=y.map((function(e){return e-(k=-k)}))}v*=w,r.lineDashOffset=S,r.setLineDash(y),r.lineCap=E,r.lineJoin=i.join||"miter",r.lineWidth=f,r.globalAlpha=o*v,r.strokeStyle=pr(i.color||0),r.stroke(t)},u=0,d=l;u<d.length;u++)c(d[u]);e.drawImageCount=0,r.setLineDash([]),r.lineDashOffset=0},e.prototype.paintSvg=function(e){var t=this.draw,n=this.option,i=new li;t.call(i,i);var r=i.pathDatas,o=e.currentRoot,a=Jn("g");a.setAttribute("transform",$n(new ar(n))),o.appendChild(a);for(var s=0,l=r;s<l.length;s++){var c=l[s],u=c.closed,d=c.stroke,p=c.fill,h=c.path;if(!h){var f=c.pathCmd;ri(h=Jn("path"),"d",f.join(" "))}if(a.appendChild(h),p&&0!==p.alpha&&u){var m=p.color,v=void 0===m?0:m,g=p.alpha,y=void 0===g?1:g;oi(h,{fill:pr(v),"fill-opacity":y})}else ri(h,"fill-opacity",0);if(d&&0!==d.width&&0!==d.alpha){var b=d.width,E=void 0===b?1:b,x=d.alpha,w=void 0===x?1:x,C=d.lineDash,S=void 0===C?[]:C,k=d.cap,_=void 0===k?"butt":k,T=d.join,I=void 0===T?"miter":T;oi(h,{stroke:pr(d.color||0),"stroke-opacity":w,"stroke-width":E,"stroke-linecap":_,"stroke-linejoin":I}),S.length&&ri(h,"stroke-dasharray",S.join(","))}}},e}(),Pa=function(){function e(e,t){this.draw=e,this.option=t}return e.prototype.paint=function(e){var t=this.draw,n=this.option,i=e.transform,r=e.context,o=e.alpha,a=e.currentPainter;if(n){var s=i.append(new ar(n));r.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),a.transformAimed=!1}else a.setTransform(e);r.globalAlpha=o,t.call(this,e),e.drawImageCount=0,r.setLineDash([]),r.lineDashOffset=0},e.prototype.paintSvg=function(){},e}();function Na(e,t){var n=new Ia(e,t);sa.processElement(n)}function Ma(e,t){var n=new Pa(e,t);sa.processElement(n)}var Aa=function(){function e(e,t){this.textData=e,this.option=t}return e.prototype.paint=function(e){var t=e.context,n=e.alpha;e.currentPainter.setTransform(e),t.globalAlpha=n;var i=this.textData,r=this.option,o=void 0===r?{}:r,a=o.x,s=void 0===a?0:a,l=o.y,c=void 0===l?0:l,u=o.fill,d=void 0===u?"black":u,p=o.underLine,h=o.deleteLine,f=o.fontStyle,m=o.fontWeight,v=o.va,g=void 0===v?"top":v,y=o.ha,b=void 0===y?"left":y,E=i.fontFamily,x=void 0===E?"Arial":E,w=i.fontSize,C=void 0===w?14:w,S=i.lineHeight,k=void 0===S?20:S,_=i.textWidth,T=void 0===_?0:_,I=i.textHeight,P=void 0===I?0:I,N=i.metrics;N||(N=Da(i),i.metrics=N);var M=N.lines,A=N.fontProperties,D=N.lineWidths,R=ut({fontSize:14,fontFamily:x,fontStyle:f,fontWeight:m}),B=C/14;t.font=R;var L=((k-A.height)/2+A.ascent)/B,O=M.length*k,F=0;"top"!==g&&(0===P||P>O)&&(F=P-O,"middle"===g&&(F/=2)),t.fillStyle=d,t.save(),t.transform(B,0,0,B,0,0);for(var z=0;z<M.length;z++){var H=0;"left"!==b&&(H=T-D[z],"center"===b&&(H/=2));var U=bi(M[z]),W=(s+H)/B,V=(z*k+c+F)/B;t.fillText(U,W,V+L),(p||h)&&(t.strokeStyle=d,t.lineWidth=1,p&&(t.beginPath(),t.moveTo(W,V+L+1.5),t.lineTo(W+D[z]/B,V+L+1.5),t.stroke()),h&&(t.beginPath(),t.moveTo(W,V+.5*k/B+1.5),t.lineTo(W+D[z]/B,V+.5*k/B+1.5),t.stroke()))}t.restore()},e.prototype.paintSvg=function(e){var t=e.currentRoot,n=this.textData,i=this.option,r=void 0===i?{}:i,o=r.x,a=void 0===o?0:o,s=r.y,l=void 0===s?0:s,c=r.fill,u=void 0===c?"black":c,d=r.underLine,p=r.deleteLine,h=r.fontStyle,f=r.fontWeight,m=r.va,v=void 0===m?"top":m,g=r.ha,y=void 0===g?"left":g,b=n.fontFamily,E=void 0===b?"Arial":b,x=n.fontSize,w=void 0===x?14:x,C=n.lineHeight,S=void 0===C?20:C,k=n.textWidth,_=void 0===k?0:k,T=n.textHeight,I=void 0===T?0:T,P=n.metrics;P||(P=Da(n),n.metrics=P);var N=P.lines,M=P.fontProperties,A=P.lineWidths,D=(S-M.height)/2+M.ascent,R=N.length*S,B=0;"top"!==v&&(0===I||I>R)&&(B=I-R,"middle"===v&&(B/=2));for(var L=0;L<N.length;L++){var O=0;"left"!==y&&(O=_-A[L],"center"===y&&(O/=2));var F=bi(N[L]),z=a+O,H=L*S+l+B,U=Jn("text");U.appendChild(document.createTextNode(F)),oi(U,{x:z,y:H+D,"font-family":E,"font-size":w,fill:u}),h&&ri(U,"font-style",h),f&&ri(U,"font-weight",f);var W="";d&&(W+="underline"),p&&(W&&(W+=" "),W+="line-through"),W&&ri(U,"text-decoration",W),t.appendChild(U)}},e}();function Da(e){var t=e.textWidth,n=e.fontFamily,i=void 0===n?"Arial":n,r=e.fontSize,o=void 0===r?14:r,a=e.lineHeight,s=void 0===a?20:a,l=e.lineClamp,c=e.textOverflow;return Wi(yi(e.text),{fontFamily:i,wordWrapWidth:t,lineHeight:s,fontSize:o},t?{wordWrapWidth:t,lineClamp:l,textOverflow:c}:void 0)}function Ra(e,t){var n=new Aa(e,t);sa.processElement(n)}var Ba=function(){function e(e){this.option=e}return e.prototype.paint=function(e){var t=e.context,n=e.alpha,i=e.currentPainter,r=this.option,o=r.x,a=void 0===o?0:o,s=r.y,l=void 0===s?0:s,c=r.width,u=void 0===c?1:c,d=r.height,p=void 0===d?1:d,h=r.clipRect,f=r.src,m=r.backgroundColor;if(!f||!f.loaded)return m?(t.globalAlpha=n,t.fillStyle=m,t.fillRect(a,l,u,p),void(e.drawImageCount=0)):void 0;i.setTransform(e),t.globalAlpha=n;var v=f.originWidth,g=f.originHeight,y=f.content;if(++e.drawImageCount>20&&(t.fillRect(a,l,.01,.01),e.drawImageCount=1),h){var b=h.x*v,E=h.y*g,x=h.width*v,w=h.height*g;t.drawImage(y,b,E,x,w,a,l,u,p)}else t.drawImage(y,a,l,u,p)},e.prototype.paintSvg=function(e){var t=this.option.src;if(t&&t.imgSrc){var n=t.imgSrc,i=e.imageCache,r=e.currentRoot,o=e.def,a=this.option,s=a.x,l=void 0===s?0:s,c=a.y,u=void 0===c?0:c,d=a.width,p=void 0===d?1:d,h=a.height,f=void 0===h?1:h,m=this.option,v=m.clipRect,g=m.link,y=i[n];if(!y){y=ii();var b=Jn("image");b.setAttribute("crossOrigin","Anonymous"),b.setAttribute("href",n),b.setAttribute("preserveAspectRatio","none"),oi(b,{width:1,height:1}),b.id=y,i[n]=y,o.appendChild(b)}var E=Jn("use");E.setAttribute("href","#"+y);var x=r;if(g){var w=Jn("a");oi(w,{href:g,target:"_blank"}),x.appendChild(w),x=w}if(v){var C=Jn("g"),S=Jn("rect");oi(S,{x:l,y:u,width:p,height:f});var k=Jn("clipPath");k.id=ni(),k.appendChild(S),x.appendChild(k),ai(C,k),p/=v.width,f/=v.height,l-=p*v.x,u-=f*v.y,x.appendChild(C),C.appendChild(E)}else x.appendChild(E);oi(E,{x:l/p,y:u/f,transform:"scale(".concat(p,", ").concat(f,")")})}},e}(),La=function(){function e(e){this.option=e}return e.prototype.paint=function(e){var t=this.option.src;if(null==t?void 0:t.loaded){var n=e.context,i=e.alpha;e.currentPainter.setTransform(e),n.globalAlpha=i;var r=t.originHeight,o=t.originWidth,a=this.option,s=a.x,l=void 0===s?0:s,c=a.y,u=void 0===c?0:c,d=a.width,p=void 0===d?1:d,h=a.height,f=void 0===h?1:h,m=a.borderClip,v=m.left,g=m.top,y=m.right,b=m.bottom,E=a.leftWidth,x=a.rightWidth,w=a.topHeight,C=a.bottomHeight,S=[v,o-y-v,y],k=[g,r-b-g,b],_=[E,p-E-x,x],T=[w,f-w-C,C],I=0,P=l,N=t.content;e.drawImageCount+8>20&&(n.fillRect(l,u,.01,.01),e.drawImageCount=8);for(var M=0;M<3;M++){for(var A=0,D=u,R=0;R<3;R++)1===M&&1===R||n.drawImage(N,I,A,S[M],k[R],P,D,_[M],T[R]),A+=k[R],D+=T[R];I+=S[M],P+=_[M]}}},e.prototype.paintSvg=function(){},e}();function Oa(e){var t=new Ba(e);sa.processElement(t)}var Fa=function(){function e(e){this.paths=e}return e.prototype.paint=function(e){var t=e.context,n=this.paths;n.length&&(e.currentPainter.beforeClip(e,this),n.forEach((function(e){t.clip(e.genPath(),e.clipRule)})))},e.prototype.paintSvg=function(e){var t=e.currentRoot,n=this.paths;if(n.length){var i=R([],n,!0).reverse().reduce((function(e,n){var i=Jn("clipPath");i.id=ni();var r=n.genSvgPath();n.clipRule&&r.setAttribute("clip-rule",n.clipRule),i.appendChild(r);var o=Jn("g");return t.appendChild(i),ai(o,i),e&&o.appendChild(e),o}),void 0);i&&(t.appendChild(i),e.currentRoot=i)}},e}();function za(e){var t=new Fa(e);sa.processElement(t)}var Ha=function(){function e(e){this.rect=e}return e.prototype.paint=function(e){var t=e.context;e.currentPainter.setTransform(e);var n=this.rect,i=n.x,r=n.y,o=n.width,a=n.height;t.clearRect(i,r,o,a)},e.prototype.paintSvg=function(){},e}();function Ua(e){var t=new Ha(e);sa.processElement(t)}var Wa=function(e){var t=e.borderRect,n=e.viewbox,i=e.option,r=void 0===i?{}:i,o=r.frozed,a=void 0!==o&&o,s=r.lineWidth,l=void 0===s?1:s,c=r.withResizePoint,u=void 0===c||c,d=r.color,p=void 0===d?6134012:d;p=a?8421504:p,u&&(u=!a);var h=n.left,f=n.top,m=n.scale;Na((function(e){var n=t.left,i=t.top,r=t.right,o=t.bottom;n=(n-h)*m,r=(r-h)*m,i=(i-f)*m,o=(o-f)*m,e.clear(),e.lineStyle({width:l,color:p}),e.drawRect(n-l/2,i-l/2,r-n+l,o-i+l),u&&(e.lineStyle({width:2,color:11119017}),e.beginFill(16316666,1),e.drawCircle(n-l/2,i-l/2,5),e.drawCircle(r+l/2,i-l/2,5),e.drawCircle(n-l/2,o+l/2,5),e.drawCircle(r+l/2,o+l/2,5))}))},Va=tr($o("rotate.png"));er(Va);var ja=function(e){var t=e.border,n=e.viewbox,i=t.left,r=t.bottom,o=n.left,a=n.top,s=n.scale;Oa({src:Va,width:20,height:22,x:(i-o)*s-30-10,y:(r-a)*s+30-10})};function Ga(e,t){var n=e.left,i=e.top,r=e.right,o=e.bottom,a=t.left,s=t.top,l=t.scale;return{x:((n+r)/2-a)*l,y:((i+o)/2-s)*l}}var qa,Ka,Ya,Xa,Qa,Za,Ja,$a,es,ts,ns,is,rs,os,as,ss,ls,cs,us,ds,ps,hs,fs,ms=function(e){var t=e.element,n=e.viewbox,i=t.borderRect,r=t.visiable,o=t.resizable,a=t.frozed,s=t.supportRotate,l=Ga(i,n);r&&(fa({x:l.x,y:l.y,rotation:i.rotate||0,pivotX:l.x,pivotY:l.y}),Wa({borderRect:i,viewbox:n,option:{withResizePoint:o&&!t.isHandMode&&t.editable,frozed:a}}),t.group||!s||t.isHandMode||!t.editable||a||ja({border:i,viewbox:n}),ma(),t.group&&vs({group:t.group,viewbox:n}))},vs=function(e){var t=e.group,n=e.viewbox,i=Yt(t.members.map((function(e){return Sn(e.getBorderBox(),e.rotate)}))),r=i.left,o=i.top,a=i.right,s=i.bottom,l=7/n.scale;Wa({borderRect:{left:r-l,top:o-l,right:a+l,bottom:s+l},viewbox:n,option:{withResizePoint:!1}})},gs=e.createContext({}),ys={EDITABLE:1,COMMENT_ONLY:2,HIDE_FRAME:4,BOARD_VERSION:8,BOARD_HISTORY:16,MEETING_MODULE:32,CALL_FOR_FOLLOW:64,FILE_DOWNLOAD:128,EXPORT_IMAGE:256,EXPORT_IMAGE_HIGH_QUALITY:512,EXPORT_SVG:1024,EXPORT_PDF:2048,EXPORT_PDF_HIGH_QUALITY:4096,UPLOAD_TEMPLATE:8192,EDIT_UNLOCK_CONDITION:16384,EDIT_UNHIDE_FRAME_CONDITION:32768},bs=Object.values(ys).reduce((function(e,t){return e+t}))-ys.COMMENT_ONLY;function Es(e){return"number"==typeof e?e>=0?"keep":"delete":"number"==typeof e[0]?"edit":"add"}function xs(e,t){var n=t,i=e[0]-t;return[[n,exports.E({},e[1])],[i,exports.E({},e[1])]]}function ws(e,t){var n=e[0],i=e[1],r=n.slice(0,t),o=n.slice(t);return[[r,exports.E({},i)],[o,exports.E({},i)]]}function Cs(e,t){var n=e[0],i=e[1];return[n,exports.E(exports.E({},i),t)]}function Ss(e,t){var n=exports.E({},e);for(var i in t)null===t[i]||!1===t[i]?delete n[i]:n[i]=t[i];return n}function ks(e,t){return[e[0],Ss(e[1],t)]}function _s(e,t){if(e.mention||t.mention)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}function Ts(e){for(var t=[],n=void 0,i="",r=0,o=e;r<o.length;r++){var a=o[r],s=Es(a);if(("keep"!==s||0!==a)&&!("add"===s&&0===a[0].length||"edit"===s&&0===a[0]))if(n){if(s!==i)t.push(n),n=a,i=s;else if("keep"===s||"delete"===s)n+=a;else if("add"===s||"edit"===s){var l=n[1];_s(l,a[1])?n="add"===s?[R(R([],n[0],!0),a[0],!0),l]:[n[0]+a[0],l]:(t.push(n),n=a)}}else n=a,i=s}return n&&t.push(n),t}function Is(e,t){var n=void 0,i=void 0,r=0,o=0;e=Ts(e),t=Ts(t);for(var a=[];n||r<e.length||i||o<t.length;)if(!n&&r<e.length&&(n=e[r],r++),!i&&o<t.length&&(i=t[o],o++),void 0!==n&&void 0!==i){var s=Es(n),l=Es(i);if("delete"===s)a.push(n),n=void 0;else if("keep"===s&&0===n)n=void 0;else if("add"===l)a.push(i),i=void 0;else if("edit"===l){var c=i,u=c[0],d=c[1];if("keep"===s)if((w=n)>=u)a.push(i),i=void 0,n=w===u?void 0:w-u;else{var p=xs(i,w),h=p[0],f=p[1];n=void 0,a.push(h),i=f}else if("add"===s)if((S=n[0].length)>u){var m=ws(n,u),v=m[0],g=m[1];a.push(ks(v,d)),n=g,i=void 0}else a.push(ks(n,d)),n=void 0,i=S===u?void 0:xs(i,S)[1];else if((S=n[0])>u){var y=xs(n,u);v=y[0],g=y[1],a.push(Cs(v,d)),n=g,i=void 0}else a.push(Cs(n,d)),n=void 0,i=S===u?void 0:xs(i,S)[1]}else if("keep"===l){var b=i;if(0===i)i=void 0;else if("keep"===s)(w=n)>=b?(a.push(i),i=void 0,n=w===b?void 0:w-b):(a.push(n),n=void 0,i=b-w);else if("add"===s)if((S=n[0].length)>b){var E=ws(n,b);v=E[0],g=E[1],a.push(v),n=g,i=void 0}else a.push(n),n=void 0,i=S===b?void 0:b-S;else if((S=n[0])>b){var x=xs(n,b);v=x[0],g=x[1],a.push(v),n=g,i=void 0}else a.push(n),n=void 0,i=S===b?void 0:b-S}else if("delete"===l){var w,C=-i;if("keep"===s)(w=n)>=C?(a.push(i),i=void 0,n=w===C?void 0:w-C):(a.push(-w),n=void 0,i=-(C-w));else if("add"===s)(S=n[0].length)>C?(i=void 0,n=ws(n,C)[1]):(n=void 0,i=S===C?void 0:-(C-S));else{var S;(S=n[0])>C?(a.push(i),i=void 0,n=xs(n,C)[1]):(n=void 0,a.push(-S),i=S===C?void 0:-(C-S))}}}else void 0!==n?(a.push(n),n=void 0):void 0!==i&&(a.push(i),i=void 0);return Ts(a)}function Ps(e,t){var n=0,i=0;e=Ts(e),t=Ts(t);for(var r=void 0,o=void 0,a=[],s=[],l=function(){if(!r&&n<e.length&&(r=e[n],n++),!o&&i<t.length&&(o=t[i],i++),void 0===r&&void 0===o)return"break";void 0===r&&(r=0),void 0===o&&(o=0);var l=Es(r),c=Es(o);if("add"===l)return a.push(r),s.push(r[0].length),r=void 0,"continue";if("add"===c)return a.push(o[0].length),s.push(o),o=void 0,"continue";if("delete"===l&&"delete"===c)return(u=-r)==(d=-o)?(r=void 0,o=void 0):u>d?(r=d-u,o=void 0):(r=void 0,o=u-d),"continue";if("delete"===l){var u=-r;return"edit"===c?u>(S=o[0])?(a.push(-S),r=S-u,o=void 0):(a.push(-u),r=void 0,o=u===S?void 0:xs(o,u)[1]):"keep"===c&&(u>(P=o)?(a.push(P),r=P-u,o=void 0):(a.push(-u),r=void 0,o=u===P?void 0:P-u)),"continue"}if("delete"===c){var d=-o;if("edit"===l)d>(S=r[0])?(s.push(-S),o=S-d,r=void 0):(s.push(-d),o=void 0,r=d===S?void 0:xs(r,d)[1]);else if("keep"===l){var p=r;d>p?(s.push(-p),o=p-d,r=void 0):(s.push(-d),o=void 0,r=d===p?void 0:p-d)}return"continue"}if("edit"===l&&"edit"===c){var h=r,f=h[0],m=h[1],v=o,g=v[0],y=v[1],b=exports.E({},m);Object.keys(b).forEach((function(e){void 0!==y[e]&&delete b[e]}));var E=Math.min(f,g);return a.push([E,b]),s.push([E,y]),f===g?(r=void 0,o=void 0):f>g?(r=xs(r,g)[1],o=void 0):(r=void 0,o=xs(o,f)[1]),"continue"}if("edit"===l&&"keep"===c){if((S=r[0])>(P=o)){var x=xs(r,P),w=x[0],C=x[1];a.push(w),s.push(P),r=C,o=void 0}else a.push(r),s.push(S),r=void 0,o=S===P?void 0:P-S;return"continue"}if("keep"===l&&"edit"===c){var S;if((S=o[0])>(I=r)){var k=xs(o,I),_=k[0],T=k[1];s.push(_),a.push(I),o=T,r=void 0}else s.push(o),a.push(S),o=void 0,r=S===I?void 0:I-S;return"continue"}if("keep"==l&&"keep"===c){var I=r,P=o,N=Math.min(I,P);return a.push(N),s.push(N),r=(I-=N)>0?I:void 0,o=(P-=N)>0?P:void 0,"continue"}};(r||n<e.length||o||i<t.length)&&"break"!==l(););return[a,s]}function Ns(e){var t=exports.E({},e);e.cps&&(t.cps=e.cps.map((function(e){if("weakOt"===e[1]){var t=(e[0],e[1],exports.E({},e[2]));t.content=t.content.map((function(e){return Array.isArray(e)&&"number"!=typeof e[0]&&(e=[bi(e[0]),e[1]]),e}))}return e})));var n=e.weakOt;if(n){var i=exports.E({},n);i.content=n.content.map((function(e){return Array.isArray(e)&&"number"!=typeof e[0]&&(e=[bi(e[0]),e[1]]),e})),t.weakOt=i}return t}function Ms(e){var t=e[1],n=e[2],i=e[3],r=e[4],o=e[5];return function(e){var t=e.cps;null==t||t.forEach((function(e){if("weakOt"===e[1]){var t=e[2];t.content=t.content.map((function(e){return e[0]=yi(e[0]),e}))}}));var n=e.richContent;n&&(n.content=n.content.map((function(e){return e[0]=yi(e[0]),e})));var i=e.nodeTree;i&&i.nodes.forEach((function(e){e.content&&(e.content=e.content.map((function(e){return e[0]=yi(e[0]),e})))}))}(r),{info:t,elementType:n,id:i,data:r,type:"created",serverVersion:o}}function As(e){var t=e[1],n=e[2],i=e[3],r=n.map((function(e){var t=e[0],n=e[1],i=e[2];return function(e){var t=e.cps;null==t||t.forEach((function(e){if("weakOt"===e[1]){var t=e[2];t.content=t.content.map((function(e){return Array.isArray(e)&&"string"==typeof e[0]&&(e[0]=yi(e[0])),e}))}}));var n=e.weakOt;n&&(n.content=n.content.map((function(e){return Array.isArray(e)&&"string"==typeof e[0]&&(e[0]=yi(e[0])),e})))}(n),{id:t,update:n,elementType:i}}));return{info:t,updates:r,type:"updated",serverVersion:i}}function Ds(e){var t=e[1],n=e[2];return e[3],{type:"background",info:t,resType:n,data:e[4],serverVersion:e[5]}}function Rs(e){switch(e[0]){case 0:return function(e){var t=e[1],n=e[2],i=t.map((function(e){return Ms(e)}));return{type:"keyFrame",actions:i,ended:1!==n}}(e);case 1:return function(e){return{seq:e[1],type:"ack",serverVersion:e[2]}}(e);case 3:return Ms(e);case 5:return As(e);case 7:return function(e){var t=e[1],n=e[2];return{type:"locked",ids:e[3],info:t,lockId:n}}(e);case 9:return function(e){return{type:"unlocked",info:e[1],lockId:e[2]}}(e);case 10:return function(e){return{type:"frameIdList",ids:e[1]}}(e);case 11:return function(e){return{type:"backgrounds",data:e[1].map((function(e){var t=e[1],n=e[2];return e[3],{info:t,resType:n,data:e[4]}}))}}(e);case 13:return Ds(e);case 14:return function(e){var t=e[1],n=e[2],i=t.map((function(e){return 3===e[0]?Ms(e):5===e[0]?As(e):13===e[0]?Ds(e):{type:"unknown"}}));return{type:"incrementalUpdate",data:i,ended:1!==n}}(e);default:return{type:"unknown"}}}function Bs(e){switch(e.type){case"create":return function(e){var t=e.seq,n=e.elementType,i=e.id,r=e.data,o=e.isRevert,a=function(e){var t=exports.E({},e);e.cps&&(t.cps=e.cps.map((function(e){if("weakOt"===e[1]){var t=[e[0],e[1],exports.E({},e[2])],n=t[2];return n.content=n.content.map((function(e){return[bi(e[0]),e[1]]})),t}return e})));var n=t.richContent;if(n){var i=exports.E({},n);i.content=n.content.map((function(e){return[bi(e[0]),e[1]]})),t.richContent=i}var r=e.nodeTree;if(r){var o=exports.E({},r);o.nodes=r.nodes.map((function(e){if(e.content){var t=exports.E({},e);return t.content=e.content.map((function(e){return[bi(e[0]),e[1]]})),t}return e})),t.nodeTree=o}return t}(r);return[2,t,n,i,a,!!o]}(e);case"update":return function(e){return[4,e.seq,e.updates.map((function(e){var t=e.id,n=e.update,i=e.elementType;return[t,Ns(n),i]}))]}(e);case"lock":return function(e){var t=e.seq,n=e.ids;return[6,t,e.lockId,n]}(e);case"unlock":return function(e){return[8,e.seq,e.lockId]}(e)}}function Ls(e,t){var n=exports.E({},e),i=t,r=i.cps,o=i.drawPoints,a=i.weakOt,s=N(i,["cps","drawPoints","weakOt"]);if(o){var l=n.drawPoints;n.drawPoints=l?R(R([],l,!0),o,!0):o}if(a){var c=n,u=c.richContent,d=c.weakOt;u?(u.content=Is(u.content,a.content),u.version=a.version):d?(d.version=a.version,d.content=Is(d.content,a.content)):n.weakOt=a}if(r){var p=n.cps;if(p){var h=R([],p,!0);r.forEach((function(e){var t=p.findIndex((function(t){return t[0]===e[0]})),n=p[t];if(n){var i=n[1];if("value"===i)h[t]=e;else if("weakOt"===i){var r=e[2],o=n[2],a=o.baseVersion,s=o.content,l={baseVersion:a,version:r.version,content:Is(s,r.content)};h[t]=[e[0],"weakOt",l]}else if("array"===i){var c=e[2],u=n[2];h[t]=[e[0],"array",R(R([],u,!0),c,!0)]}}else h.push(e)}))}else n.cps=r}return Object.assign(n,s),n}function Os(e){return{hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity}}function Fs(e){var t=e.ha,n=e.va,i=e.fontSize,r=e.fontFamily,o=e.lineHeight,a=e.lineHeightRate,s=e.richTextClient;return{ha:t,va:n,fontSize:i,fontFamily:r,lineHeight:o,lineHeightRate:a,richContent:{version:s.version,content:s.content}}}function zs(e,t){var n,i=function(e){var t=e.position,n=e.frameId,i=e.size,r=e.zIndex,o=e.rotate,a=e.scale,s=e.groupId,l=e.frozedGroupId,c=e.link;return{position:fe(t),frameId:n,size:i,zIndex:r,rotate:o,scale:a,groupId:s,frozedGroupId:l,link:c}}(e);switch((null===(n=e.customProperties)||void 0===n?void 0:n.length)&&(i.cps=e.customProperties.map((function(e){return[e.name,e.type,e.getInitData()]}))),t){case Za.LINE:var r=e,o=r.lineWidth,a=r.lineColor,s=r.ended,l=r.drawPoints,c=r.penType,u=void 0===c?Ya.NORMAL:c,d=r.lineOpacity;return exports.E({lineWidth:o,lineColor:a,ended:s,drawPoints:l,penType:u,lineOpacity:d},i);case Za.FRAME:var p=e,h=p.type,f=p.name,m=p.showDB,v=p.hide;return exports.E(exports.E(exports.E({},i),Os(p)),{type:h,name:f,showDB:m,hide:v});case Za.TEXT:var g=e;return exports.E(exports.E(exports.E(exports.E({},i),Os(g)),Fs(g)),{autoWidth:g.autoWidth});case Za.SHAPE:var y=e;return exports.E(exports.E(exports.E(exports.E(exports.E({},i),function(e){return{hasBorder:e.hasBorder,borderStyle:e.borderStyle,borderColor:e.borderColor,borderThickness:e.borderThickness,borderOpacity:e.borderOpacity}}(y)),Os(y)),Fs(y)),{shape:y.shape});case Za.MINDMAP_LINE:case Za.CONNECTIONLINE:var b=e,E=b.startElementId,x=b.startPosition,w=b.startType,C=b.startArrow,S=b.endElementId,k=b.endPosition,_=b.endType,T=b.endArrow,I=b.breakPointData,P=(o=b.lineWidth,b.lineStyle),N=b.lineType,M=b.lineColor,A=b.textDirection,D=b.texts;return exports.E(exports.E({},i),{startElementId:E,startPosition:x,startType:w,startArrow:C,endElementId:S,endPosition:k,endType:_,endArrow:T,breakPointData:I,lineWidth:o,lineStyle:P,lineType:N,lineColor:M,textDirection:A,texts:D});case Za.IMAGE:var B=e,L=B.scaleMode,O=B.name,F=B.clipRect,z=B.imgType,H=B.fileId;return exports.E(exports.E({},i),{scaleMode:L,name:O,clipRect:F,imgType:z,fileId:H});case Za.STICKER:var U=(y=e).textSize,W=y.autoFontSize,V=y.bgColor,j=y.shape,G=y.isPrivate;return exports.E(exports.E(exports.E({},i),Fs(y)),{textSize:U,autoFontSize:W,bgColor:V,showAuthor:!1,shape:j,isPrivate:G});case Za.DOCUMENT:var q=e,K=q.mode,Y=q.fileType,X=q.name,Q=q.totalPage,Z=q.startPage,J=(H=q.fileId,q.titleHeight),$=q.parseStatus,ee=q.estimateCompleteTime;return exports.E(exports.E({},i),{mode:K,fileType:Y,name:X,totalPage:Q,startPage:Z,fileId:H,titleHeight:J,parseStatus:$,estimateCompleteTime:ee});case Za.MINDMAP_NODE:var te=e,ne=te.autoWidth,ie=te.layout,re=te.theme,oe=te.isRootNode,ae=te.nodeColor,se=te.leftCollapsed,le=te.rightCollapsed;return exports.E(exports.E(exports.E(exports.E({},i),Fs(te)),Os(te)),{autoWidth:ne,layout:ie,theme:re,isRootNode:oe,nodeColor:ae,leftCollapsed:se,rightCollapsed:le});case Za.COMMENT:var ce=e,ue=ce.attached,de=ce.relativePos,pe=ce.resolved;return a=ce.color,exports.E(exports.E({},i),{attached:ue,resolved:pe,color:a,relativePos:de});case Za.VIDEO:var he=e,me=(H=he.fileId,he.coverFileId),ve=he.name,ge=he.duration,ye=(J=he.titleHeight,he.extraUrl),be=he.transStatus,Ee=(ee=he.estimateCompleteTime,he.markPoints);return exports.E(exports.E({},i),{fileId:H,coverFileId:me,name:ve,duration:ge,titleHeight:J,extraUrl:ye,markPoints:Ee,transStatus:be,estimateCompleteTime:ee});case Za.AUDIO:var xe=e,we=(H=xe.fileId,xe.name);return ge=xe.duration,J=xe.titleHeight,be=xe.transStatus,ee=xe.estimateCompleteTime,Ee=xe.markPoints,exports.E(exports.E({},i),{fileId:H,name:we,duration:ge,titleHeight:J,markPoints:Ee,transStatus:be,estimateCompleteTime:ee});case Za.TABLE:var Ce=(g=e).position,Se=g.size,ke=g.rowWidths,_e=g.rowHeights,Te=g.name,Ie=g.cells,Pe=g.rows,Ne=g.cols,Me=g.meshColor,Ae=g.hasBg,De=(V=g.bgColor,g.bgOpacity),Re=g.va,Be=g.ha,Le=g.lineHeight,Oe=g.lineHeightRate,Fe=g.fontFamily,ze=g.fontSize,He=(a=g.color,g.highLight),Ue=g.italic,We=g.bolder,Ve=g.deleteLine,je=g.underLine,Ge=g.focusedCells,qe=g.focusingCell,Ke=g.xOffsetArr,Ye=g.yOffsetArr,Xe=Number.MAX_SAFE_INTEGER,Qe=0,Ze=0,Je=Number.MAX_SAFE_INTEGER;qe&&(Ge.forEach((function(e){Xe=Math.min(e.rIdx,Xe),Qe=Math.max(e.cIdx,Qe),Je=Math.min(e.cIdx,Je),Ze=Math.max(e.rIdx,Ze)})),Ie=Ie.filter((function(e,t){var n=t/Ne|0,i=t%Ne;return n>=Xe&&n<=Ze&&i>=Je&&i<=Qe})),Pe=Ze-Xe+1,Ne=Qe-Je+1,ke=ke.slice(Je,Qe+1),_e=_e.slice(Xe,Ze+1),Se={width:ke.reduce((function(e,t){return e+t}),0),height:_e.reduce((function(e,t){return e+t}),0)},Ce={x:Ce.x+Ke[Je],y:Ce.y+Ye[Xe]});var $e={},et={},tt=fe(Ie);Ie.forEach((function(e){e.clusterId&&!$e[e.clusterId]&&($e[e.clusterId]=ia()),e.clusterId&&e.clusterRoot&&(et[e.clusterId]=!0)})),tt.forEach((function(e){e.clusterId&&(et[e.clusterId]?e.clusterId=$e[e.clusterId]:e.clusterId=null)}));var nt=qe?Ge.map((function(e){return(e.rIdx-Xe)*Ne+(e.cIdx-Je)})).sort((function(e,t){return e-t})):null;return exports.E(exports.E({},i),{position:Ce,size:Se,rowWidths:ke,rowHeights:_e,name:Te,cells:tt,rows:Pe,cols:Ne,meshColor:Me,hasBg:Ae,bgColor:V,bgOpacity:De,va:Re,ha:Be,lineHeight:Le,lineHeightRate:Oe,fontFamily:Fe,fontSize:ze,color:a,highLight:He,italic:Ue,bolder:We,deleteLine:Ve,underLine:je,focusedCellsIdx:nt});case Za.GRID_TEXT:return g=e,exports.E(exports.E(exports.E(exports.E({},i),Os(g)),Fs(g)),{autoWidth:!1});case Za.WEBPAGE:var it=(g=e).name,rt=g.url,ot=g.title,at=(me=g.coverFileId,g.coverSize),st=g.description,lt=g.status,ct=g.iframeHtmlTags;return exports.E(exports.E({},i),{name:it,url:rt,title:ot,coverFileId:me,coverSize:at,description:st,status:lt,iframeHtmlTags:ct});case Za.TIMER:return ge=(g=e).duration,exports.E(exports.E({},i),{duration:ge});case Za.KANBAN:var ut=e,dt=ut.name,pt=ut.colGroupBy,ht=ut.rowGrouyBy,ft=ut.attributes,mt=ut.cards,vt=ut.filters,gt=ut.orders;return exports.E(exports.E({},_t.cloneDeep(i)),{name:dt,colGroupBy:pt,rowGrouyBy:ht,attributes:_t.cloneDeep(ft),filters:_t.cloneDeep(vt),orders:_t.cloneDeep(gt),cards:R([],mt,!0)});case Za.CARD:var yt=e,bt=yt.name,Et=(a=yt.color,me=yt.coverFileId,yt.kanbanId),xt=yt.values;return exports.E(exports.E({},i),{name:bt,color:a,coverFileId:me,kanbanId:Et,values:xt});case Za.GRAPHIC:var wt=e,Ct=wt.categoryId,St=wt.graphicId,kt=(xt=wt.values,Ae=wt.hasBg,V=wt.bgColor,De=wt.bgOpacity,wt.hasBorder),Tt=wt.borderStyle,It=wt.borderColor,Pt=wt.borderThickness,Nt=wt.borderOpacity;return exports.E(exports.E({},_t.cloneDeep(i)),{values:_t.cloneDeep(xt),categoryId:Ct,graphicId:St,hasBg:Ae,bgColor:V,bgOpacity:De,hasBorder:kt,borderStyle:Tt,borderColor:It,borderThickness:Pt,borderOpacity:Nt});case Za.RK_TEACHING_RESEARCH:var Mt=(g=e).supportMaxWindow,At=g.commentList;return exports.E(exports.E({},i),{supportMaxWindow:Mt,commentList:At});case Za.BIG_DOC:var Dt=e.name;return exports.E(exports.E({},i),{name:Dt});case Za.RK_LIVE_PLAYER:var Rt=e,Bt=Rt.playerId,Lt=Rt.playerType,Ot=Rt.finished;return exports.E(exports.E({},i),{playerId:Bt,playerType:Lt,finished:Ot});default:return exports.E({},i)}}function Hs(e,t){return e.zIndex!==t.zIndex?e.zIndex-t.zIndex:e.id>t.id?1:-1}!function(e){e[e.NONE=0]="NONE",e[e.LINE=1]="LINE",e[e.DOT=2]="DOT"}(qa||(qa={})),function(e){e[e.RECT=1]="RECT",e[e.ELLIPSE=2]="ELLIPSE",e[e.DIAMOND=3]="DIAMOND",e[e.TRIANGLE=4]="TRIANGLE",e[e.ROUNDRECT=5]="ROUNDRECT",e[e.PARALLELOGRAM=6]="PARALLELOGRAM",e[e.BIG_RIGHT_ARROW=7]="BIG_RIGHT_ARROW",e[e.BARREL=8]="BARREL",e[e.DOCUMENT=9]="DOCUMENT",e[e.BIG_LEFT_ARROW=10]="BIG_LEFT_ARROW"}(Ka||(Ka={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.MARK=1]="MARK",e[e.SMART=2]="SMART"}(Ya||(Ya={})),function(e){e[e.NONE=0]="NONE",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL"}(Xa||(Xa={})),function(e){e[e.COLORBRANCH=1]="COLORBRANCH",e[e.LITE=2]="LITE"}(Qa||(Qa={})),function(e){e[e.LINE=1]="LINE",e[e.FRAME=2]="FRAME",e[e.TEXT=3]="TEXT",e[e.SHAPE=4]="SHAPE",e[e.CONNECTIONLINE=5]="CONNECTIONLINE",e[e.IMAGE=6]="IMAGE",e[e.STICKER=7]="STICKER",e[e.DOCUMENT=8]="DOCUMENT",e[e.MINDMAP_NODE=9]="MINDMAP_NODE",e[e.MINDMAP_LINE=10]="MINDMAP_LINE",e[e.COMMENT=11]="COMMENT",e[e.VIDEO=12]="VIDEO",e[e.TABLE=13]="TABLE",e[e.GRID_TEXT=14]="GRID_TEXT",e[e.AUDIO=15]="AUDIO",e[e.WEBPAGE=16]="WEBPAGE",e[e.TIMER=17]="TIMER",e[e.KANBAN=18]="KANBAN",e[e.CARD=19]="CARD",e[e.BIG_DOC=20]="BIG_DOC",e[e.GRAPHIC=21]="GRAPHIC",e[e.RK_TEACHING_RESEARCH=1001]="RK_TEACHING_RESEARCH",e[e.RK_LIVE_PLAYER=1002]="RK_LIVE_PLAYER",e[e.RK_INNER_WINDOW=1003]="RK_INNER_WINDOW",e[e.RK_WINDOW_CTRL_BAR=1004]="RK_WINDOW_CTRL_BAR",e[e.RK_RIGHT_TOP_WINDOW=1005]="RK_RIGHT_TOP_WINDOW"}(Za||(Za={})),function(e){e[e.IMAGE=1]="IMAGE"}(Ja||(Ja={})),function(e){e[e.start=0]="start",e[e.end=1]="end",e[e.error=2]="error"}($a||($a={})),function(e){e[e.SUBSCRIBE=1]="SUBSCRIBE"}(es||(es={})),function(e){e[e.REPORT_SIGNAL=0]="REPORT_SIGNAL",e[e.NOTICE=2]="NOTICE"}(ts||(ts={})),function(e){e[e.REPORT=1]="REPORT",e[e.CANCEL=3]="CANCEL"}(ns||(ns={})),function(e){e[e.LAST_OPEN_TIME_MAP=1]="LAST_OPEN_TIME_MAP",e[e.ALL_COMMENT_MESSAGE=2]="ALL_COMMENT_MESSAGE",e[e.UPDATE_COMMENT_MESSAGE=4]="UPDATE_COMMENT_MESSAGE",e[e.MEDIA_TRANS_MESSAGE=10]="MEDIA_TRANS_MESSAGE"}(is||(is={})),function(e){e[e.CUD_COMMENT_MESSAGE=3]="CUD_COMMENT_MESSAGE",e[e.REPORT_LAST_OPEN=5]="REPORT_LAST_OPEN",e[e.READ_ALL=6]="READ_ALL"}(rs||(rs={})),function(e){e[e.START_REPORT_POS=1]="START_REPORT_POS",e[e.STOP_REPORT_POS=2]="STOP_REPORT_POS",e[e.POS_UPDATE=3]="POS_UPDATE",e[e.LASER_ENDED=4]="LASER_ENDED"}(os||(os={})),function(e){e[e.UPDATE_LASER_POS=3]="UPDATE_LASER_POS",e[e.END_USE_LASER=4]="END_USE_LASER"}(as||(as={})),function(e){e[e.CALL_FOR_FOLLOW=1]="CALL_FOR_FOLLOW",e[e.FOLLOWER_IN=2]="FOLLOWER_IN",e[e.FOLLOWER_OUT=3]="FOLLOWER_OUT",e[e.START_REPORT_DATA=4]="START_REPORT_DATA",e[e.END_REPORT_DATA=5]="END_REPORT_DATA",e[e.SYNC_FOLLOW_DATA=6]="SYNC_FOLLOW_DATA",e[e.KEY_FRAME=7]="KEY_FRAME",e[e.REQUEST_VIEW_ONCE=8]="REQUEST_VIEW_ONCE",e[e.INFORM_USER_VIEW_ONCE=9]="INFORM_USER_VIEW_ONCE"}(ss||(ss={})),function(e){e[e.CALL_FOR_FOLLOW=1]="CALL_FOR_FOLLOW",e[e.START_FOLLOW=2]="START_FOLLOW",e[e.END_FOLLOW=3]="END_FOLLOW",e[e.REPORT_SYNC_DATA=6]="REPORT_SYNC_DATA",e[e.REQUEST_USER_VIEW_ONCE=8]="REQUEST_USER_VIEW_ONCE",e[e.REPORT_VIEW_ONCE=9]="REPORT_VIEW_ONCE"}(ls||(ls={})),function(e){e[e.ALL=0]="ALL",e[e.VIEW=1]="VIEW",e[e.COMMENT=2]="COMMENT",e[e.DOC=3]="DOC",e[e.AUDIO=4]="AUDIO",e[e.VIDEO=5]="VIDEO",e[e.TIMER=6]="TIMER",e[e.FRAMEPLAYER=7]="FRAMEPLAYER",e[e.ISPRINGPPT=8]="ISPRINGPPT",e[e.CUSTOM=9]="CUSTOM"}(cs||(cs={})),function(e){e[e.ADD=1]="ADD",e[e.EDIT=2]="EDIT",e[e.DELETE=3]="DELETE"}(us||(us={})),function(e){e[e.KEYFRAMES=2]="KEYFRAMES",e[e.NEW_ACTIVITY=3]="NEW_ACTIVITY",e[e.REVERTED_ACTIVITY=4]="REVERTED_ACTIVITY",e[e.DELETE_ACTIVITY=5]="DELETE_ACTIVITY"}(ds||(ds={})),function(e){e[e.SUBSCRIBE=0]="SUBSCRIBE",e[e.UNSUBSCRIBE=1]="UNSUBSCRIBE",e[e.FETCH_ACTIVITY=2]="FETCH_ACTIVITY",e[e.REVERT_ITEM=4]="REVERT_ITEM"}(ps||(ps={})),function(e){e[e.VERSION_UPDATE=2]="VERSION_UPDATE",e[e.VERSION_NAME_UPDATE=6]="VERSION_NAME_UPDATE"}(hs||(hs={})),function(e){e[e.SUBSCRIBE=0]="SUBSCRIBE",e[e.UNSUBSCRIBE=1]="UNSUBSCRIBE",e[e.NEW_VERSION=2]="NEW_VERSION",e[e.RESTORE=4]="RESTORE",e[e.DELETE=5]="DELETE",e[e.UPDATE_NAME=6]="UPDATE_NAME"}(fs||(fs={}));var Us=function(){function e(){this.id="",this.show=!1,this.parentRefSystem=null,this.children=[],this.childRefSystems=[],this.globalTransform=sr,this.minZindex=0,this.maxZindex=0}return Object.defineProperty(e.prototype,"highDimension",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformData",{get:function(){return this.calcTransformData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unavailable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseElePos",{get:function(){var e;return null===(e=this.baseElement)||void 0===e?void 0:e.position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseEleSize",{get:function(){var e;return null===(e=this.baseElement)||void 0===e?void 0:e.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRefSystem",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.calcTransformData=function(){if(this.baseElement){var e=this.baseElement,t=e.scale,n=e.rotate,i=this.baseElePos,r=i.x,o=i.y;if(0===n)return{x:r,y:o,scaleX:t,scaleY:t,pivotX:0,pivotY:0,rotation:0};var a=this.baseEleSize,s=a.width/2,l=a.height/2;return{x:r+=s*t,y:o+=l*t,scaleX:t,scaleY:t,pivotX:s,pivotY:l,rotation:n}}return{x:0,y:0,scaleX:1,scaleY:1,pivotX:0,pivotY:0,rotation:0}},Object.defineProperty(e.prototype,"zIndex",{get:function(){var e;return(null===(e=this.baseElement)||void 0===e?void 0:e.zIndex)||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalZindex",{get:function(){var e;return(null===(e=this.parentRefSystem)||void 0===e?void 0:e.zIndex)||this.zIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxChildZindex",{get:function(){return this.maxZindex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minChildZindex",{get:function(){return this.minZindex},enumerable:!1,configurable:!0}),e.prototype.checkParentMounted=function(){var e;return(null===(e=this.parentRefSystem)||void 0===e?void 0:e.mounted)||!1},e.prototype.checkSelfMounted=function(){return void 0!==this.baseElement},Object.defineProperty(e.prototype,"mounted",{get:function(){return this.checkSelfMounted()&&this.checkParentMounted()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.compareElement=function(e,t){return Hs(e,t)},e.prototype.isInRefSystem=function(e){var t=this.parentRefSystem;return!!t&&(t===e||t.isInRefSystem(e))},e.prototype.isInRefSystemOfElement=function(e){var t;return this.baseElement===e||(null===(t=this.parentRefSystem)||void 0===t?void 0:t.isInRefSystemOfElement(e))||!1},e.prototype.getRelateInfo=function(){return{}},e.prototype.isCross=function(e){if("global"===this.id)return!0;e=this.globalTransform.applyBorderBoxInverse(e);var t=this.baseEleSize;return!!t&&Kt(e,Bt(exports.E({x:0,y:0},t)))},e.prototype.getRefSystemListIfBorderCross=function(e,t){if("global"!==this.id&&t&&!t(this))return[];if(!this.isCross(e))return[];var n=this.childRefSystems.map((function(n){return n.getRefSystemListIfBorderCross(e,t)})).flat();return"global"!==this.id&&n.push(this),n},e.prototype.checkBorderIn=function(e){if("global"===this.id)return!0;if(!this.baseElement)return!1;var t=this.baseEleSize;return Vt(e=this.globalTransform.applyBorderBoxInverse(e),exports.E({x:0,y:0},t))},e.prototype.getRefSystemIfBorderIn=function(e,t){if(this.checkBorderIn(e)){for(var n=this.childRefSystems.length-1;n>=0;n--){var i=this.childRefSystems[n].getRefSystemIfBorderIn(e,t);if(i)return i}if("global"===this.id||!t||t(this))return this}},e.prototype.checkPointIn=function(e){if("global"===this.id)return!0;if(!this.baseElement)return!1;var t=this.baseEleSize,n=t.width,i=t.height;return Ot(e=this.globalTransform.applyInverse(e),{left:0,top:0,right:n,bottom:i})},e.prototype.getRefSystemIfPointIn=function(e,t){if(this.checkPointIn(e)){for(var n=this.childRefSystems.length-1;n>=0;n--){var i=this.childRefSystems[n].getRefSystemIfPointIn(e,t);if(i)return i}if("global"===this.id||!t||t(this))return this}},e.prototype.calcPosition=function(){var e;return null!==(e=this.baseElePos)&&void 0!==e?e:{x:0,y:0}},e.prototype.getSelfTransform=function(){var e=this.transformData,t=e.x,n=e.y,i=e.scaleX,r=e.scaleY,o=e.pivotX,a=e.pivotY,s=e.rotation,l=new ar;return l.update(t,n,i,r,o,a,s*Math.PI/180),l},e.prototype.updateTransform=function(){if(this.mounted&&this.parentRefSystem){var e=this.parentRefSystem.globalTransform,t=this.getSelfTransform();this.globalTransform=e.clone().append(t),this.children.forEach((function(e){return e.updateTransform()}))}},e.prototype.updateTransformForce=function(e,t){this.baseElement!==t&&(this.baseElement=t);var n=this.getSelfTransform();this.globalTransform=e.clone().append(n),this.children.forEach((function(e){return e.updateTransform()}))},e.prototype.clear=function(){this.children=[],this.childRefSystems=[]},e.prototype.sortChildren=function(){var e=this.children,t=this.childRefSystems;if(!e.length)return this.minZindex=0,void(this.maxZindex=0);e.sort(this.compareElement),t.sort(this.compareElement),this.minZindex=e[0].zIndex,this.maxZindex=e[e.length-1].zIndex},e.prototype.updateChildIndex=function(e){var t=this.children.findIndex((function(t){return t===e}));if(-1!==t){this.children.splice(t,1);var n=e.selfRefSystem,i=n?this.children.findIndex((function(e){return e===n})):-1;i>=0&&this.children.splice(i,1);for(var r=e.zIndex<=0,o=r?1:-1,a=!1,s=r?0:this.children.length-1;s>=0&&s<=this.children.length-1;s+=o){var l=this.children[s];if(r===this.compareElement(e,l)<0){var c=r?s:s+1;i>=0&&n&&this.children.splice(c,0,n),this.children.splice(c,0,e),a=!0;break}}if(a||(r?(i>=0&&n&&this.children.push(n),this.children.push(e)):(this.children.unshift(e),i>=0&&n&&this.children.unshift(n))),this.minZindex=this.children[0].zIndex,this.maxZindex=this.children[this.children.length-1].zIndex,n){var u=this.childRefSystems.findIndex((function(e){return e===n}));if(-1!==u){this.childRefSystems.splice(u,1);var d=!1;for(s=r?0:this.childRefSystems.length-1;s>=0&&s<=this.childRefSystems.length-1;s+=o)if(l=this.childRefSystems[s],r===this.compareElement(n,l)<0){r?this.childRefSystems.splice(s,0,n):this.childRefSystems.splice(s+1,0,n),d=!0;break}d||(r?this.childRefSystems.push(n):this.childRefSystems.unshift(n))}}}},e.prototype.calcRenderTree=function(e){for(var t=[],n=0,i=this.children;n<i.length;n++){var r=i[n];if(r.isRefSystem){var o=r.calcRenderTree(e);(o.children.length||r.baseElement&&t.includes(r.baseElement))&&t.push(o)}else{var a=r;a.elementType!==Za.COMMENT&&a.checkVisible(e)&&t.push(r)}}return{refSystem:this,children:t}},e.prototype.bindBaseElement=function(e){this.baseElement=e,this.updateTransform(),e.selfRefSystem=this},e.prototype.addElement=function(e){if(e.parentRefSystem){if(e.parentRefSystem===this)return;e.parentRefSystem.removeElement(e)}if(!this.children.includes(e)){for(var t=0;t<this.children.length&&this.compareElement(this.children[t],e)<=0;t++);0===t?this.minZindex=e.zIndex:t===this.children.length&&(this.maxZindex=e.zIndex),this.children.splice(t,0,e)}e.parentRefSystem=this},e.prototype.removeElement=function(e){var t=this.children.findIndex((function(t){return t===e}));t>=0&&this.children.splice(t,1),e.parentRefSystem=null},e.prototype.addChildRS=function(e){if(e.parentRefSystem){if(e.parentRefSystem===this)return;e.parentRefSystem.removeChildRS(e)}if(!this.children.includes(e)){for(var t=0;t<this.children.length&&this.compareElement(this.children[t],e)<=0;t++);for(this.children.splice(t,0,e),t=0;t<this.childRefSystems.length&&this.compareElement(this.childRefSystems[t],e)<=0;t++);this.childRefSystems.splice(t,0,e)}e.parentRefSystem=this,e.updateTransform()},e.prototype.removeChildRS=function(e){var t=this.children.findIndex((function(t){return t===e}));t>=0&&this.children.splice(t,1),(t=this.childRefSystems.findIndex((function(t){return t===e})))>=0&&this.childRefSystems.splice(t,1),e.parentRefSystem=null},e}(),Ws=function(e){function t(){var t=e.call(this)||this;return t.id="global",t}return P(t,e),Object.defineProperty(t.prototype,"mounted",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return 100},enumerable:!1,configurable:!0}),t}(Us),Vs=function(e){for(var t=e.refSystem,n=!1,i=0,r=e.children;i<r.length;i++){var o=r[i];if(o.refSystem)o.children.length&&(n&&(n=!1,ma()),Vs(o));else{if(n||(n=!0,fa({transform:t.globalTransform})),o.elementType===Za.MINDMAP_LINE)continue;if(o.elementType===Za.MINDMAP_NODE&&!o.isRootNode)continue;o.renderer(o)}}n&&ma()},js=new ua,Gs=function(){function e(e,t){var n=e.view,i=!1;function r(){i=!1}var o=[];function a(e){o.push(e)}t.renderer={render:function(){var t=n.getViewbox();js.setContext({viewbox:t,renderApp:r,addLoadingSource:a,upime:e}),n.canvasWidgets.forEach((function(n){return n.renderer({element:n,viewbox:t,upime:e})})),js.popContext()}},this.tick=function(){var e=!n.widgetCvsUpdated||!i||o.some((function(e){return e.loaded}));n.widgetCvsUpdated||(n.widgetCvsUpdated=!0),e&&(o.length=0,i=!0,t.render())},this.unsub=n.subscribe("viewboxChange",(function(){n.canvasWidgets.length&&n.updateWidgetCvs()}))}return e.prototype.destroy=function(){this.unsub()},e}(),qs=function(t){var n=t.upime,i=t.richContentEditor,r=t.viewbox,o=t.setDom,a=n.phoneMode&&_e.isIphoneLike,s=e.useRef(null);return e.useEffect((function(){o(s.current||void 0)}),[s.current]),e.useEffect((function(){if(!a&&i&&s.current){var e=i.calcGlobalTextRect(r),t=e.x,n=e.y;e.width;var o=e.height,l=e.fontSize;s.current.style.height=o+"px",s.current.style.lineHeight=o+"px",s.current.style.fontSize=l+"px",s.current.style.width="60px",s.current.style.left=t+"px",s.current.style.top=n+"px"}}),[i,null==i?void 0:i.cursorPosition]),e.createElement("textarea",{className:j(qr,a&&Kr),ref:s,spellCheck:"false",draggable:"false","data-native-evt-handle":!!(null==i?void 0:i.editing)})},Ks=function(){function e(){var e=this;this._state="pending",this._promise=new Promise((function(t,n){e._res=t,e._rej=n}))}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.done=function(e){this._res&&(this._state="resolved",this._res(e),this._res=this._rej=void 0)},e.prototype.release=function(){},e.prototype.fail=function(e){this._rej&&(this._state="rejected",this._rej(e),this._res=this._rej=void 0)},e}();new Promise((function(e){e()}));var Ys=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.paint=function(){var e;null===(e=this.renderer)||void 0===e||e.render()},t}(ba),Xs=function(t){function n(e){var n=t.call(this,e)||this;return n.canvas=null,n}return P(n,t),n.prototype.componentDidMount=function(){var e=this.props,t=e.width,n=e.height,i=e.resolution,r=void 0===i?1:i,o=this.canvas;this.app=new Ys(o,t,n,{resolution:r})},n.prototype.componentWillUnmount=function(){this.app=void 0},n.prototype.componentDidUpdate=function(e,t,n){var i=this.props,r=i.width,o=i.height,a=i.resolution,s=void 0===a?1:a;i.children;var l=this.app;e.height===o&&e.width===r&&e.resolution===this.props.resolution||(l.width=r,l.height=o,l.resolution=s,l.resize())},n.prototype.componentDidCatch=function(e,t){t.componentStack},n.prototype.render=function(){var t=this;return e.createElement("canvas",{ref:function(e){return t.canvas=e}})},n}(e.Component);function Qs(e,t,n){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0}var Zs,Js,$s=function(){function e(){this.hasValue=!1}return e.prototype.useMemo=function(e,t,n){if(this.hasValue&&(n=n||Qs)(this.value,t,this.deps))return this.value;this.deps=t;var i=e();return this.value=i,this.hasValue=!0,i},e.prototype.useCallback=function(e,t){return this.value&&Qs(0,t,this.deps)?this.value:(this.value=e,this.deps=t,e)},e}(),el=function(){function e(){this.memoMap={}}return e.prototype.useMemo=function(e,t,n,i){return this.createMemo(e).useMemo(t,n,i)},e.prototype.useCallback=function(e,t,n){return this.createMemo(e).useCallback(t,n)},e.prototype.createMemo=function(e){var t=this.memoMap[e];return t||(t=new $s,this.memoMap[e]=t),t},e.prototype.clearMemo=function(e){void 0===e?this.memoMap={}:delete this.memoMap[e]},e}(),tl=function(t){var n,i;t.upime;var r=t.textWidget,o=t.viewbox,a=e.useRef(null),s=e.useRef(null);e.useEffect((function(){if(a.current&&r&&r[0]){var e=r[0].bindDOM(a.current);return!_e.desktop&&a.current.blur(),e}}),[r]),e.useEffect((function(){if(s.current&&r&&r[1]){var e=r[1].bindDOM(s.current);return!_e.desktop&&s.current.blur(),e}}),[r]);var l=e.useMemo((function(){return r?r.map((function(e){var t=e.element,n=t.scale,i=t.globalTransform,r=e.textRect,a=i.applyBorderBox({left:r.x,top:r.y,right:r.x+r.width*n,bottom:r.y+r.height*n,rotate:t.rotate}),s=o.scale,l=i.currentScale*n,c=(a.left-o.left)*s,u=(a.top-o.top)*s,d={x:c+r.width*l*s/2,y:u+r.height*l*s/2},p=(o.right-o.left)*s,h=(o.bottom-o.top)*s,f=30*l*s;return d.x<1?d.x=1:d.x+61>p&&(d.x=p-61),d.y<1?d.y=1:d.y+f+1>h&&(d.y=h-f-1),{textHeight:f,scale:l,viewScale:s,position:d}})):[]}),[r]),c=l[0],u=l[1];return e.useEffect((function(){[a,s].forEach((function(e){if(e.current){var t=a?c:u,n=t.textHeight,i=t.scale,r=t.viewScale,o=t.position;e.current.style.height=n+"px",e.current.style.lineHeight=n+"px",e.current.style.fontSize=30*i*r+"px",e.current.style.width="60px",e.current.style.left=o.x+"px",e.current.style.top=o.y+"px"}}))}),[r]),e.createElement(e.Fragment,null,r&&r[0]?e.createElement("input",{className:qr,ref:a,spellCheck:"false",draggable:"false","data-native-evt-handle":!!(null===(n=r[0])||void 0===n?void 0:n.editing)}):null,r&&r[1]?e.createElement("input",{className:qr,ref:s,spellCheck:"false",draggable:"false","data-native-evt-handle":!!(null===(i=r[1])||void 0===i?void 0:i.editing)}):null)},nl=(Zs=null,Js=[],function(e){null==Zs&&(Js=[],(Zs=Promise.resolve()).then((function(){Zs=null;var e=R([],Js,!0);Js=[],e.forEach((function(e){try{e()}catch(e){}}))}))),Js.push(e)}),il=function(e){return function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this,r=[],o=[],a=!1,s=function(){a=!1;var e=o;o=[];for(var t=function(t){e.filter((function(e){return 0==t.keys.size||t.keys.has(e)})).length>0&&t.cb()},n=0,i=r;n<i.length;n++)t(i[n])};return i.updateState=function(e){o.indexOf(e)<0&&o.push(e),a||(a=!0,nl(s))},i.addHook=function(e,t){return void 0===t&&(t=[]),r.findIndex((function(t){return t.cb===e}))<0&&r.push({cb:e,keys:new Set(t)}),function(){var t=r.findIndex((function(t){return t.cb===e}));t>=0&&r.splice(t,1)}},i}return P(t,e),t}(e)},rl=function(e,t){var n="_"+t;delete e[t]&&Object.defineProperty(e,t,{get:function(){return this[n]},set:function(e){e!==this[n]&&(this[n]=e,"function"==typeof this.updateState&&this.updateState(t))},enumerable:!0,configurable:!0})},ol=function(){function e(){this.tip="",this.position={x:0,y:0}}return M([rl],e.prototype,"tip",void 0),M([rl],e.prototype,"position",void 0),M([il],e)}();function al(t,n){void 0===n&&(n=[]);var i=e.useReducer((function(e){return e+1}),0)[1],r=e.useState((function(){return"function"==typeof t.addHook?t.addHook(i,n):void 0}))[0];e.useEffect((function(){return r}),[])}function sl(t,n,i){void 0===i&&(i=[]);var r=e.useReducer((function(e){return e+1}),0)[1],o=function(){r(),n()},a=e.useState((function(){return"function"==typeof t.addHook?t.addHook(o,i):void 0}))[0];e.useEffect((function(){return a}),[])}var ll={frameListBar:!0,ai:!0,miniMap:!0,fullscreen:!0,helpCenter:!0,cursor:!0,search:!0,download:!0,meeting:{enabled:!0},template:{enabled:!0},boardMemberList:{enabled:!0},sticker:{enabled:!1}},cl={button:"button_2BG20",large:"large_3PXNk",small:"small_2M9Jz",primary:"primary_rNJF3",disabled:"disabled_27yQV",danger:"danger_28o_3",text:"text_2AFFK",secondary:"secondary_VQFof",radioGroupContainer:"radioGroupContainer_1nZMc",horizontal:"horizontal_2-yV0",vertical:"vertical_3Jac3",labelContainer:"labelContainer_PmAeo",radioLabel:"radioLabel_IgyYp",radioChecked:"radioChecked_153Q2",toggleRoot:"toggleRoot_3oe9V",slider:"slider_21fs0",round:"round_1f0Dz"},ul=function(t){var n=t.className,i=t.children,r=t.size,o=t.type,a=t.disabled,s=N(t,["className","children","size","type","disabled"]);return e.createElement("div",exports.E({},s,{onClick:function(e){var t;!0!==a&&(null===(t=s.onClick)||void 0===t||t.call(s,e))},className:j(n,cl.button,r&&cl[r],o&&cl[o],a&&cl.disabled)}),i)},dl="icon_25Zn0";function pl(e){return void 0===e&&(e="upime-web-sdk-"),A(this,void 0,void 0,(function(){var t,n,i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return[4,Promise.resolve().then((function(){return require("./icon_map-994586df-6147ed29.js")}))];case 1:for(i in t=s.sent().icon_map,n="<svg>",t)n+='<symbol id="'.concat(e+i,'"')+t[i].substring(7);return n+="</svg>",(r=document.createElement("div")).innerHTML=n,(o=r.getElementsByTagName("svg")[0]).setAttribute("aria-hidden","true"),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",(a=document.body.firstChild)?document.body.insertBefore(o,a):document.body.appendChild(o),[2]}}))}))}var hl=e.forwardRef((function(t,n){var i=t.className,r=t.title,o=t.icon,a=t.iconSvg,s=t.style,l=t.size,c=N(t,["className","title","icon","iconSvg","style","size"]),u=exports.E({},s);l&&(u.width="".concat(l,"px"),u.height="".concat(l,"px"));var d="#"+(null!=a?a:"upime-web-sdk-"+o);return e.createElement("svg",exports.E({className:j(i,dl,"sdk-icon"),style:u,"aria-hidden":"true"},c,{ref:n}),e.createElement("use",{xlinkHref:d},e.createElement("title",null,r||"")))})),fl={avatar:"avatar_iXIok",rect:"rect_2G0vQ",circle:"circle_1_huE"},ml=function(t){var n=t.style,i=t.className,r=t.shape,o=void 0===r?"rect":r,a=t.children,s=t.url,l=N(t,["style","className","shape","children","url"]);return e.createElement("div",exports.E({},l,{className:j(i,fl.avatar,fl[o]),style:exports.E({backgroundImage:"url(".concat(s,")")},n)}),!s&&a)},vl={inputContainer:"inputContainer_2VcIz",active:"active_2dhSH",inputHeadIcon:"inputHeadIcon_3Krv8",input:"input_3kH84",inputTail:"inputTail_15gHE",clearInput:"clearInput_28iVx",counter:"counter_rtceU"},gl=function(t){var n=t.value,i=t.onChange,r=t.onClearClick,o=t.placeholder,a=t.className,s=t.icon,l=t.maxLen,c=W().getUpimeTrans;return e.createElement("div",{className:j(vl.inputContainer,a,n&&vl.active)},s&&e.createElement(hl,{icon:s,className:vl.inputHeadIcon}),e.createElement("input",{className:j(vl.input,s&&vl.withIcon),onChange:function(e){return i(e)},value:n,placeholder:o&&c.apply(void 0,o),maxLength:l}),e.createElement("div",{className:vl.inputTail},n&&e.createElement("div",{className:vl.clearInput,onClick:function(e){e.stopPropagation(),r()}},e.createElement(hl,{icon:"guanbi"})),l&&e.createElement("span",{className:vl.counter},"".concat(n.length,"/").concat(l))))},yl={input_wrapper:"input_wrapper_5DYxY",input:"input_TOTyV",error:"error_2_ym6",delete_btn:"delete_btn_3XEwh",addInputClearBtn:"addInputClearBtn_ip6az",editInputClearBtn:"editInputClearBtn_1xBs9",error_msg:"error_msg_3X6Uq"};function bl(t){void 0===t&&(t="");var n=e.useState(t),i=n[0],r=n[1],o=e.useState(!1),a=o[0],s=o[1],l=e.useState(!1);return{value:i,setValue:r,focus:a,setFocus:s,urlError:l[0],setError:l[1]}}var El=function(t){var n=t.placeHolder,i=void 0===n?"":n,r=t.value,o=t.setValue;t.focus;var a=t.setFocus,s=t.urlError,l=t.setError,c=t.validateUrl,u=void 0!==c&&c,d=t.className,p=void 0===d?"":d,h=t.inputClsName,f=void 0===h?"":h,m=t.btnClsName,v=void 0===m?"":m,g=t.onKeydown,y=t.autoFocus,b=t.autoSelect,E=t.onBlur,x=e.useRef(null),w=W().getUpimeTrans;return e.useEffect((function(){var e=x.current;y?(e.focus(),e.selectionStart=e.selectionEnd=e.value.length):b&&(e.focus(),e.selectionStart=0,e.selectionEnd=e.value.length)}),[]),e.createElement("div",{className:j(yl.input_wrapper,p)},e.createElement("input",{ref:x,onChange:function(e){var t=e.target.value.trim();o(t)},className:j(yl.input,f,s&&yl.error),value:r,onFocus:function(){a(!0)},onBlur:function(){if(null==E||E(),a(!1),u){var e=me(ge(r.trim()));l(!e)}},onKeyDown:g,placeholder:i}),r?e.createElement("div",{className:j(yl.delete_btn,yl[v]),onClick:function(e){var t;e.stopPropagation(),o(""),null===(t=x.current)||void 0===t||t.focus()},onPointerDown:ie},e.createElement(hl,{icon:"qingchu"})):null,s&&e.createElement("div",{className:yl.error_msg},w("webpage.insert.error")))},xl=e.createContext({upime:null,phoneMode:!1}),wl=e.createContext({uploadUpime:null}),Cl=e.createContext({getSdkPlugin:function(){return null}});function Sl(t){return(0,e.useContext(Cl).getSdkPlugin)(t)}var kl=function(t){var n=t.options,i=t.value,r=t.className,o=t.onChange,a=t.optionOutlineColor,s=e.useContext(xl).upime;return e.createElement("div",{className:j("root_2V9EJ",r)},n.map((function(t){var n=i===t.value;return e.createElement("div",{key:t.color,className:j("outer_2lzBF",!n&&"hideBg_Fq1Jf"),style:{backgroundColor:n?t.color:"unset",margin:s.phoneMode?"0 4px":"0 1px"},onClick:function(e){e.stopPropagation(),o(t.value)}},e.createElement("div",{className:j("inner_3av2Z",n&&"showOutline_2kLk8"),style:{outlineColor:n?null!=a?a:"white":"unset",background:t.color}}))})))},_l="button_rT7ev",Tl="tipBorder_3A6Hm",Il="contentWrapper_Ywfey",Pl="content_1JZaP",Nl="large_3V4Zf",Ml={cm_item:"cm_item_1XW9g",disabled:"disabled_15AXR",icon_box:"icon_box_3xZoN",active:"active_uk4vF",bling_item:"bling_item_2wKVy",hidden:"hidden_20LJi",hidden_all:"hidden_all_5Mc7C",show_all:"show_all_3Bt9g",pane:"pane_20sIA",show_a:"show_a_1Kzei",show:"show_1_gWJ",show_scale:"show_scale_1RBnp",right:"right_lctKR",left:"left_1E4kL",bottom:"bottom_1mZq7",top:"top_beFj8",left_top:"left_top_1X_Ja",top_left:"top_left_Kc7Ch",bottom_left:"bottom_left_3lWvG",right_top:"right_top_5AcWB",right_bottom:"right_bottom_34UZP",left_bottom:"left_bottom_p-YyF",btn_style:"btn_style_3XNr6",on:"on_A9n_x",propEditorIconBox:"propEditorIconBox_3hodL",titleIcon:"titleIcon_1bzhU",moreIcon:"moreIcon_3AgcZ",rotateY180:"rotateY180_2Vntu",upimeInput:"upimeInput_3KP0j",invalid:"invalid_1OOmA",loadingIcon:"loadingIcon_3NBto",loading:"loading_3y29w",AIButtonContainer:"AIButtonContainer_1C1MU",transparent:"transparent_3GYoj",AIButtonWrapper:"AIButtonWrapper_WbGnk",AIButtonImageContainer:"AIButtonImageContainer_2Jk-w",AIShow:"AIShow_3rBwB",AIHide:"AIHide_36Bvk",AIButtonHover:"AIButtonHover_1yvZL",AIButtonDisabled:"AIButtonDisabled_mU1pk",AIButtonImage:"AIButtonImage_2xVZv",phoneBgColorFcContainer:"phoneBgColorFcContainer_2a-8i"},Al=0;function Dl(n){var i=n.children,r=n.renderData,o=n.content,a=n.placement,s=void 0===a?"bottom":a,l=n.className,c=n.rootClass,u=n.rootStyle,d=n.large,p=n.autoAdjustOverflow,h=void 0===p||p,f=n.zIndex,m=n.enable,v=void 0===m||m,g=n.extraDistance,y=void 0===g?0:g,b=n.onClick,E=void 0===b?function(){return 0}:b,x=n.useClick,w=void 0!==x&&x,C=e.useState((function(){return Al++}))[0],S=e.useContext(Ic),k=S.tipId,_=S.showTip,T=S.hideTip,I=S.toggleTip,P=S.popContainer,N=S.rootContainer,M=e.useRef(null),A=e.useState(null),D=A[0],R=A[1],B=e.useContext(xl).upime,L=C==k&&D&&v;e.useEffect((function(){if(!0!==w){var e=function(e){"touch"!==e.pointerType&&T(C)},t=M.current.firstChild;return t.addEventListener("pointerenter",n),t.addEventListener("pointerleave",i),t.addEventListener("pointerdown",e),function(){t.removeEventListener("pointerenter",n),t.removeEventListener("pointerleave",i),t.removeEventListener("pointerdown",e)}}function n(e){if("touch"!==e.pointerType){var t=e.target.getBoundingClientRect(),n=t.x,i=t.y,r=t.width,o=t.height;R({left:n,top:i,width:r,height:o}),_(C)}}function i(e){"touch"!==e.pointerType&&T(C)}}),[w]),e.useEffect((function(){if(!0===w){var e,t=M.current.firstChild;return t.addEventListener("click",n),function(){null==e||e(),t.removeEventListener("click",n),document.removeEventListener("click",i)}}function n(){var n=t.getBoundingClientRect(),r=n.x,o=n.y,a=n.width,s=n.height;R({left:r,top:o,width:a,height:s}),I(C)?(document.addEventListener("click",i,{capture:!0}),null==e||e(),e=B.userEventManager.subscribe("click",(function(e){i(e.originEvent)}))):(document.removeEventListener("click",i,{capture:!0}),null==e||e())}function i(e){if(M.current){var t=e.target;V(M.current,t)||(T(C),document.removeEventListener("click",i,{capture:!0}))}}}),[w]),e.useLayoutEffect((function(){L&&h&&function(){var e,t=null===(e=P.current)||void 0===e?void 0:e.getElementsByClassName(Il)[0];if(t&&N&&D){var n=t.getBoundingClientRect(),i=n.x,r=n.y,o=n.width,a=n.height,l=N.current.getBoundingClientRect(),c=l.x,u=l.y,d={left:i,right:i+o,top:r,bottom:r+a},p={left:c,right:c+l.width,top:u,bottom:u+l.height},h=s;h.includes("top")&&d.top<p.top&&(h=h.replace("top","bottom")),h.includes("bottom")&&d.bottom>p.bottom&&(h=h.replace("bottom","top")),"top"!==h&&"bottom"!==h||(d.left<p.left?h="".concat(h,"Left"):d.right>p.right&&(h="".concat(h,"Right"))),t.style.setProperty("--tip-width-offset","".concat(D.width/2,"px")),t.style.setProperty("--tip-extra-distance","".concat(y,"px")),t.classList.replace(s,h)}}()}),[L,h]);var O=exports.E({},D);return void 0!==f&&(O.zIndex=f),e.createElement("div",{className:c,style:u,ref:M,onClick:E},i,L&&t.createPortal(e.createElement("div",{className:Tl,style:O},e.createElement("div",{className:j(Il,s,l,Ml.show_a)},r?e.createElement(r.fun,exports.E({},r.data,{key:"renderData"})):e.createElement("div",{className:j(Pl,d&&Nl)},o||""))),P.current))}var Rl="activeEffect_1DUZU",Bl=e.createContext(null);function Ll(e,t,n,i){var r,o=Date.now(),a=e.map((function(e,n){return t[n]-e}));return function t(){r=fr((function(){var r=(Date.now()-o)/i;r>1&&(r=1);var s=e.map((function(e,t){return e+a[t]*r}));n(s,1===r),1!==r&&t()}))}(),function(){mr(r)}}var Ol=e.forwardRef((function(t,n){var i=t.children,r=t.className,o=t.onFinishDrop,a=t.onStartDragging,s=t.activeItemClassName,l=t.itemWidth,c=t.readonly,u=void 0!==c&&c,d=e.useState(null),p=d[0],h=d[1],f=e.useRef(null),m=e.useRef(null),v=e.useRef(null),g=e.useRef(null),y=e.useRef(null),b=e.useRef(0),E=e.useRef(0);e.useImperativeHandle(n,(function(){return{scrollToItem:function(e,t){if(g.current){var n=e*t,i=(e+1)*t,r=g.current.scrollTop,o=g.current.clientHeight;n<r&&Ll([r],[n],(function(e){var t=e[0];g.current&&(g.current.scrollTop=t)}),200),i>g.current.clientHeight+r&&Ll([r],[i-o],(function(e){var t=e[0];g.current&&(g.current.scrollTop=t)}),200)}}}}));var x=e.useCallback((function(e){var t;if(v.current&&m.current&&g.current){y.current=+e.dataset.index,a&&a(y.current),v.current.appendChild(e.cloneNode(!0));var n=e.getBoundingClientRect(),i=n.top,r=n.height;b.current=r;var o=window.getComputedStyle(document.body).getPropertyValue("margin-top");v.current.style.top="".concat(i-+o.split("px")[0],"px"),s&&(null===(t=v.current.firstChild)||void 0===t?void 0:t.firstChild)&&v.current.firstChild.firstChild.classList.add(s),E.current=g.current.scrollTop}}),[v.current]),w=e.useCallback((function(e){if(v.current&&null!==y.current&&g.current){v.current.style.transform="translate(0, ".concat(e,"px");var t=p,n=Math.max(y.current*b.current+e+g.current.scrollTop-E.current,0),i=n/b.current|0,r=i;n-i*b.current>b.current/2&&(r+=1),r!==t&&(h(r),f.current=r)}}),[v.current]);return e.createElement(Bl.Provider,{value:{onDragStart:x,onDragging:w,onDrop:function(){v.current&&m.current&&(v.current.innerHTML="",v.current.style.transform="unset",null!==f.current&&null!==y.current&&o(y.current,f.current),m.current.dataset.selected=void 0,y.current=null,h(null),f.current=null)},listRef:m,viewportRef:g,targetIndex:p,readonly:u}},e.createElement("div",{className:j("viewport_3tZUV",r,!_e.desktop&&"noScrollBar_IAjEr"),ref:g},e.createElement("div",{className:"list_2T_ZO",ref:m},i),e.createElement("div",{className:"fakeItemContainer_f2lOi",style:{width:l},ref:v})))})),Fl=e.memo((function(t){var n,i=t.children,r=t.index,o=e.useRef(null),a=null!==(n=e.useContext(Bl))&&void 0!==n?n:{},s=a.onDragStart,l=a.onDragging,c=a.onDrop,u=a.listRef,d=a.viewportRef,p=a.targetIndex,h=a.readonly,f=e.useRef({pointerId:null,originPosY:0,originBox:{left:0,top:0,right:0,bottom:0},connected:!1,dragging:!1,target:null,longpressed:!1}),m=e.useRef(0),v=4,g=e.useRef(null),y=e.useRef(null);return e.useEffect((function(){g.current=r}),[r]),e.useEffect((function(){var e;if((null==u?void 0:u.current)&&o.current&&null!=p){var t=o.current,n=o.current.clientHeight,i=Number(null!==(e=u.current.dataset.selected)&&void 0!==e?e:"");if(!Number.isNaN(i))if(i===r){var a=(p-r)*n;t.style.transform="translate(0, ".concat(a,"px)")}else t.style.transform=p>i?r<=p&&r>i?"translate(0, ".concat(-n,"px)"):"unset":p<i&&r>=p&&r<i?"translate(0, ".concat(n,"px)"):"unset"}null===p&&o.current&&(o.current.style.transform="unset")}),[o.current,p,r]),e.useEffect((function(){var e,t,n=function(){document.removeEventListener("touchmove",k),document.removeEventListener("touchend",S),document.removeEventListener("touchcancel",S)},i=function(){document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",p),document.removeEventListener("pointercancel",p)},r=function(e){if("mouse"===e.pointerType){v=4,e.preventDefault();var t=f.current.pointerId;null!==t&&t!==e.pointerId||(b(e.pointerId,e.pageY),document.addEventListener("pointermove",a),document.addEventListener("pointerup",p),document.addEventListener("pointercancel",p))}},a=function(e){f.current.connected&&e.preventDefault(),E(e.pointerId,e.pageY)},p=function(e){var t=f.current.pointerId;null!==t&&t!==e.pointerId||f.current.connected&&(x(),i())},b=function(e,t){f.current.pointerId=e,f.current.connected=!0,f.current.originPosY=t;var n=o.current.getBoundingClientRect();f.current.originBox=n,m.current=n.height},E=function(e,t){var n,i;if((null==u?void 0:u.current)&&(null==d?void 0:d.current)&&o.current){var r=f.current.pointerId;if(null!==r&&r!==e)return;if(!f.current.connected)return;var a=f.current,c=a.originPosY,p=a.originBox;if(!f.current.dragging){var h=t-c;Math.abs(h)>v&&(f.current.dragging=!0,null==s||s(o.current),o.current.style.opacity="0.1",u.current.dataset.selected="".concat(g.current),null===(n=o.current)||void 0===n||n.classList.remove(Rl))}if(f.current.dragging){var b=t-c,E={left:p.left,top:p.top+b,right:p.right,bottom:p.bottom+b},x=d.current.getBoundingClientRect(),w=d.current.scrollTop;Math.abs(E.top-x.top)<=.75*m.current&&w>0?y.current||(y.current=Ll([w],[d.current.scrollTop-2*m.current],(function(e,t){var n=e[0];d.current&&(d.current.scrollTop=n),t&&(y.current=null)}),300)):Math.abs(E.bottom-x.bottom)<=.75*m.current&&w+d.current.clientHeight<u.current.clientHeight?y.current||(y.current=Ll([w],[d.current.scrollTop+2*m.current],(function(e,t){var n=e[0];d.current&&(d.current.scrollTop=n),t&&(y.current=null)}),300)):(null===(i=y.current)||void 0===i||i.call(y),y.current=null),b+=Xt(E,x).top-E.top,null==l||l(b)}}},x=function(){f.current.connected=!1,f.current.pointerId=null,f.current.dragging=!1,f.current.longpressed=!1,m.current=0,null==c||c(),o.current&&(o.current.style.opacity="1")},w=null,C=function(e){v=8,w&&clearTimeout(w);var t=f.current;1===e.touches.length?w=setTimeout((function(){var n;t.longpressed=!0;var i=e.touches[0];b(i.identifier,i.pageY),w=null,null===(n=o.current)||void 0===n||n.classList.add(Rl)}),500):t.dragging&&x(),document.addEventListener("touchmove",k,{passive:!1}),document.addEventListener("touchend",S),document.addEventListener("touchcancel",S)},S=function(e){var t;w&&(clearTimeout(w),w=null),f.current.dragging?x():null===(t=o.current)||void 0===t||t.classList.remove(Rl),f.current.longpressed=!1,n()},k=function(e){var t=f.current;if(w)return clearTimeout(w),void(w=null);if(t.longpressed){e.preventDefault();var n=e.touches[0];E(n.identifier,n.pageY)}};if(!h)return null===(e=o.current)||void 0===e||e.addEventListener("touchstart",C),null===(t=o.current)||void 0===t||t.addEventListener("pointerdown",r),function(){var e,t;h||(null===(e=o.current)||void 0===e||e.removeEventListener("touchstart",C),null===(t=o.current)||void 0===t||t.removeEventListener("pointerdown",r),i(),n())}}),[h]),e.createElement("div",{className:j("itemRoot_1Yolz"),"data-index":r,ref:o},i)})),zl=function(t){var n=t.radioGroupConfig,i=t.value,r=n.configs,o=n.onChange,a=n.layout,s=n.className;return e.createElement("div",{className:j(cl.radioGroupContainer,"vertical"===a?cl.vertical:cl.horizontal,s)},r.map((function(t){return e.createElement("div",{onClick:function(){return o(t.value)},key:t.value,className:cl.labelContainer},e.createElement("label",{className:j(cl.radioLabel,i===t.value&&cl.radioChecked)}," "),t.label&&e.createElement("span",{className:t.className}," ",t.label))})))},Hl=function(t){var n=t.config,i=t.value,r=n.onChange,o=n.className;return e.createElement("div",{className:j(cl.toggleRoot,o)},e.createElement("input",{type:"checkbox",checked:i,onChange:function(){}}),e.createElement("span",{className:j(cl.slider,cl.round),onClick:function(){r(!i)}}))};function Ul(t){var n=t.ref,i=t.defaultValue,r=void 0===i?0:i,o=t.onChanged,a=t.calcValue;function s(e,t,n){return e<t?t:e>n?n:e}var l=s(r,0,1),c=e.useState(void 0),u=c[0],d=c[1];return e.useEffect((function(){var e=n.current,t=!1,i=!1;function r(){document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",p)}function l(t){var n=t.clientX,i=e.getBoundingClientRect(),r=s((n-i.left)/(i.right-i.left),0,1);return a?a(r):r}var c=function(e){e.preventDefault(),e.stopPropagation(),document.addEventListener("pointermove",u),document.addEventListener("pointerup",p),t=!0,i=!1},u=function(e){var n=l(e);d(n),o(n,{isStart:t,isEnd:i}),t=!1},p=function(e){var n=l(e);o(n,{isStart:t,isEnd:i=!0}),d(void 0),r()};return e.addEventListener("pointerdown",c),function(){e.removeEventListener("pointerdown",c),r()}}),[]),{value:void 0!==u?u:l,slideValue:u,updateSlide:d}}var Wl="slide_control_3Tkdt",Vl="bottom_layer_2LnzU",jl="top_layer_1y2Hg",Gl="content_1l079",ql="ball_21U3h",Kl="tick_slider_1_03f",Yl="phoneLayout_330pS",Xl="disabled_2QWy8",Ql="tick_3gOme",Zl="shade_1EJc5",Jl="color_icon_2-Mw4",$l="color_palette_3yWHR",ec="phone_1HFeJ",tc="independent_R0vGX",nc="selected_no_border_1B-1A",ic="selected_3z-kP",rc="gray_8uJIi",oc="name_editor_2QBtO",ac="hidden_name_2aBaY",sc="input_1p_UY",lc="fontsize_editor_OPm6B",cc="btns_2F3sA",uc="size_list_DMNKn",dc="size_option_2C5N0",pc="option_list_3D_zR",hc="type_icon_select_2wez6",fc="type_icon_phoneLayout_2fcQ5",mc="type_item_3oU5q",vc="editorBtn_3OWPP",gc="draggable_resizeBtn_1qrdc",yc="draggable_resizeBar_382KS";function bc(t){for(var n=t.className,i=void 0===n?"":n,r=t.editable,o=void 0===r||r,a=t.defaultValue,s=void 0===a?0:a,l=t.start,c=void 0===l?.1:l,u=t.onChanged,d=e.useContext(Ic).phoneLayout,p=e.useRef(null),h=e.useMemo((function(){return(1-c)/.1}),[c]),f=~~(100/h)/100,m=(Ul({ref:p,defaultValue:s,onChanged:u,calcValue:function(e){return Math.floor(10*(c+.1*Math.floor((e+f/2)/f)))/10}}).value-c)/.1*f*100,v=[],g=1;g<h;g++)v.push(e.createElement("div",{key:"tick-".concat(g),className:Ql,style:{left:g*f*100+"%"}}));return e.createElement("div",{className:j(Kl,d&&Yl,o?"":Xl,i),ref:p},e.createElement("div",{className:Vl}),v,e.createElement("div",{className:Zl,style:{width:102-m+"%",left:m+"%"}},e.createElement("div",{className:ql})))}var Ec,xc=function(t){var n=t.icon,i=t.iconClassname,r=t.iconStyles,o=t.title,a=t.bodyContent,s=t.cancelText,l=t.confirmText,c=t.confirmClassname,u=t.confirmStyles,d=t.onCancel,p=t.onConfirm,h=e.useCallback((function(){d()}),[]),f=e.useCallback((function(){p()}),[]);return e.createElement("div",{className:"dialogContainer_22Hnt"},e.createElement("div",{className:"leftContainer_3pkAF"},e.createElement(hl,{icon:n,className:j("icon_1tByt",i),style:r})),e.createElement("div",{className:"rightContainer_1FRz4"},e.createElement("div",{className:"titleContainer_2CF8D"},e.createElement("span",{className:"title_3LdX_"},o)),e.createElement("div",{className:"bodyContainer_20HGt"},e.createElement("div",{className:"content_1QOuh"},a)),e.createElement("div",{className:"footerContainer_2Q6M6"},e.createElement(ul,{className:_l,type:"secondary",onClick:h},s),e.createElement(ul,{className:j(_l,c),style:u,type:"primary",onClick:f},l))))},wc=function(t){var n=t.success,i=t.content,r=i.upime,o=i.config,a=e.useState(0),s=a[0],l=a[1],c=W().getUpimeTrans,u=e.useState(!1),d=u[0],p=u[1],h=e.useRef([]),f=[{status:"move",title:c("ui.userHelper.move.title"),eventName:["moveBoard"],content:[{icon:"tuodongtishi",text:c("ui.userHelper.move.huadongshuangzhi")},{icon:"changanyoujianyidong",text:c("ui.userHelper.move.changanyoujian")},{icon:"changangunlunyidong",text:c("ui.userHelper.move.changangunlun")}]},{status:"scale",title:c("ui.userHelper.scale.title"),eventName:["scaleBoard"],content:[{icon:"nieheshuangzhisuofang",text:c("ui.userHelper.scale.nieheshuangzhi")},{icon:"huadonggunlunsuofang",text:c("ui.userHepler.scale.huadonggunlun")}]}];return e.useEffect((function(){if(!(s>=f.length)){var e=f[s],t=!0,n=function(){t&&(l(s+1),t=!1)};return h.current=R([],e.eventName.map((function(e){return"moveBoard"===e?r.subscribe("moveBoard",(function(e){var t=e||{},i=t.type,r=t.connectType;"mouse"===i&&"right"!==r&&"middle"!==r||n()})):r.subscribe(e,(function(){n()}))})),!0),function(){h.current.map((function(e){return e()})),h.current=[]}}p(!0)}),[s]),e.useEffect((function(){var e;d&&(null===(e=o.onFinish)||void 0===e||e.call(o),h.current.map((function(e){return e()})),n(null))}),[d]),d?null:e.createElement("div",{className:"operation_tips_lwI6F"},f.map((function(t,n){return e.createElement("div",{className:j("container_29VCa",s===n&&"active_3BtRQ"),key:t.status},e.createElement("span",{className:"close_1p2ND",onClick:function(){return p(!0)}},e.createElement(hl,{icon:"guanbi"})),e.createElement("div",{className:"title_2VSyT"},t.title),e.createElement("div",{className:"content_2KLYB"},t.content.map((function(t,n){return e.createElement("div",{className:"item_1l4i-",key:t.icon+n},e.createElement(hl,{icon:t.icon,className:"icon_1yBgb"}),e.createElement("span",{className:"text_27E9u"},t.text))}))))})))},Cc="confirm_3Z5EL";!function(e){e[e.next=0]="next",e[e.prev=1]="prev",e[e.close=2]="close"}(Ec||(Ec={}));var Sc=function(n){var i=n.success,r=n.content;al(r,["index"]);var o=W().getUpimeTrans,a=r,s=a.index,l=a.totalStep,c=null==r?void 0:r.steps[s],u=c&&c.selector&&document.querySelector(c.selector);return c?e.createElement(e.Fragment,null,e.createElement("div",{className:"insert_panel_Q7X5R"},e.createElement("div",{className:"content_2d2EC"},e.createElement("div",{className:"header_2iy12"},e.createElement("div",{className:"title_iyRUE"},o(c.title)),e.createElement(hl,{icon:"guanbi",onClick:function(){return i(Ec.close)},className:"close_6ghio"})),e.createElement("div",{className:"desc_2I6gQ"},o(c.desc)),e.createElement("div",{className:"body_1wKBP"},e.createElement("img",{src:c.videoSrc,width:"320",height:"180"}))),e.createElement("div",{className:"actions_tuHTo"},function(){if(r)return e.createElement(e.Fragment,null,e.createElement("div",{className:"page_1Kpb0"},s>0?"".concat(s,"/").concat(l-1):""),e.createElement("div",{className:"btn_group_3aIVO"},s>1&&s<l&&e.createElement(ul,{type:"secondary",className:Cc,onClick:function(){return r.prev()}},o("guide.btn.prevStep")),e.createElement(ul,{type:"primary",className:Cc,onClick:function(){return s===l-1?i(Ec.close):r.next()}},o(0===s?"guide.btn.start":s===l-1?"guide.btn.try":"guide.btn.nextStep"))))}())),u&&t.createPortal(e.createElement("div",{className:"guide_active_3nPnL"},e.createElement("div",{className:"guide_dot_3G_Bh"})),u)):null},kc=function(){function e(e){this.upime=e,this._steps=[{title:"guide.welcome.title",desc:"guide.welcome.desc",videoSrc:$o("guidance_welcome.gif")},{title:"guide.stickyNote.title",desc:"guide.stickyNode.desc",videoSrc:$o("guidance_stick.gif")},{title:"guide.shape.title",desc:"guide.shape.desc",videoSrc:$o("guidance_shape.gif")},{title:"guide.connectionLine.title",desc:"guide.connectionLine.desc",videoSrc:$o("guidance_line.gif")},{title:"guide.text.title",desc:"guide.text.desc",videoSrc:$o("guidance_text.gif")},{title:"guide.comment.title",desc:"guide.comment.desc",videoSrc:$o("guidance_comment.gif")},{title:"guide.helperCenter.title",desc:"guide.helperCenter.desc",videoSrc:$o("guidance_help.gif")}],this.index=0,this.isStart=!1}return Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps.map((function(e){return exports.E(exports.E({},e),{selector:e.selector?".".concat(e.selector):""})}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalStep",{get:function(){return this._steps.length},enumerable:!1,configurable:!0}),e.prototype.start=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:if(this.isStart)return[2];this.index=0,this.isStart=!0,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.upime.showWindow(Sc,this,!0,!1)];case 2:switch(t.sent()){case Ec.next:this.next();break;case Ec.prev:this.prev();break;case Ec.close:this.finish(e)}return[3,4];case 3:return t.sent(),this.finish(),[3,4];case 4:return[2]}}))}))},e.prototype.prev=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return this.index<=0||--this.index,[2]}))}))},e.prototype.next=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return this.index===this.steps.length-1||++this.index,[2]}))}))},e.prototype.finish=function(e){this.index=0,this.isStart=!1,null==e||e()},M([rl],e.prototype,"index",void 0),M([il],e)}(),_c=function(e,t){if(window.aplus_queue){var n=[e,"CLK"];t&&n.push(t),window.aplus_queue.push({action:"aplus.record",arguments:n})}},Tc=function(){function e(e){var t=this;this.upime=e,this.ready=!1,this.errorMesg="",this.leftSideOpened=!1,this.rightSideOpened=!1,this.rightSubSlideOpened=!1,this.bottomCtrlShowing=!0,this.btmMeetingCtrlShowing=!0,this.toastWidgets=[],this.dialogWindows=[],this.phoneDrawer=null,this.operationGuideStarted=!1,this.sdkPluginCmp=[],this.lastWidgetId=0,this.lastPhoneDrawerId=1,this.pluginCmpId=0,this.removeWindow=function(e){t.dialogWindows=t.dialogWindows.filter((function(t){return t.widgetId!==e}))},this.removeAllWindows=function(){t.dialogWindows=[]},this.openLeftSide=function(e){t.leftSideOpened=e},this.openRightSide=function(e){t.rightSideOpened=e},this.toggleRightSide=function(){_c("cv_help"),t.rightSideOpened=!t.rightSideOpened},this.openRightSubSlide=function(e){t.rightSubSlideOpened=e},this.closeRightSide=function(){t.rightSideOpened=!1},this.showBottomCtrl=function(e){t.bottomCtrlShowing=e},this.showBtmMeetingCtrl=function(e){t.btmMeetingCtrlShowing=e},this.removePhoneDrawer=function(){t.phoneDrawer=null},this.userGuide=new kc(e)}return e.prototype.addSdkPluginCmp=function(e,t,n){var i=++this.pluginCmpId,r={id:i,pluginId:t,Cmp:e,props:n};return this.sdkPluginCmp=R(R([],this.sdkPluginCmp,!0),[r],!1),i},e.prototype.removeSdkPluginCmp=function(e){this.sdkPluginCmp=this.sdkPluginCmp.filter((function(t){return t.id!==e}))},e.prototype.showWindow=function(e,t,n,i,r,o){void 0===n&&(n=!1),void 0===i&&(i=!1);var a=this.lastWidgetId++,s=new Ks,l={fc:e,data:t,widgetId:a,dialog:s,pierceBg:n,maskClosable:i,phoneDialog:r};return this.dialogWindows=R(R([],this.dialogWindows,!0),[l],!1),o&&o(a),s.result},e.prototype.addToast=function(e,t){var n=this;void 0===t&&(t={});var i=t.type,r=void 0===i?"normal":i,o=t.autoHide,a=void 0===o||o,s=t.autoHideTime,l=void 0===s?3e3:s,c=t.removedCB,u=t.placement,d=t.top,p=t.style,h=t.className,f=t.btn,m=this.lastWidgetId++,v={type:r,content:e,widgetId:m,autoHideTime:l,hide:!1,removedCB:c,placement:u,top:d,style:p,className:h,btn:f};return a&&(v.autoRemoveTimer=window.setTimeout((function(){n.removeToast(m)}),l)),this.toastWidgets=R(R([],this.toastWidgets,!0),[v],!1),m},e.prototype.updateOrAddToastContent=function(e,t,n){var i=this,r=this.toastWidgets.find((function(e){return e.widgetId===t}));return!r||r.hide?this.addToast(e,n):(r.content=e,void 0!==r.autoRemoveTimer&&(clearTimeout(r.autoRemoveTimer),r.autoRemoveTimer=window.setTimeout((function(){i.removeToast(r.widgetId)}),r.autoHideTime)),this.toastWidgets=R([],this.toastWidgets,!0),r.widgetId)},e.prototype.removeToast=function(e){var t,n=this.toastWidgets.find((function(t){return t.widgetId===e}));n&&(n.hide=!0,null===(t=n.removedCB)||void 0===t||t.call(n),this.toastWidgets=R([],this.toastWidgets,!0))},e.prototype.toastRemoved=function(e){this.toastWidgets.find((function(t){return t.widgetId===e}))&&(this.toastWidgets=this.toastWidgets.filter((function(t){return t.widgetId!==e})))},e.prototype.startOperationGuide=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return t=e.boardGuide,n=e.userGuide,t&&t.show?[4,this.startBoardGuide(t.onFinish)]:[3,2];case 1:i.sent(),i.label=2;case 2:return n&&n.show&&this.startUserGuide(n.onFinish),[2]}}))}))},e.prototype.startBoardGuide=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.upime.showWindow(wc,{upime:this.upime,config:{onFinish:e}},!0)];case 1:return t.sent(),[2]}}))}))},e.prototype.startUserGuide=function(e){return this.userGuide.start(e)},e.prototype.showPhoneDrawer=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return this.phoneDrawer?[4,this.closePhoneDrawer()]:[3,2];case 1:s.sent(),s.label=2;case 2:return i=new Ks,r=new Ks,o=new Ks,a=++this.lastPhoneDrawerId,this.phoneDrawer={id:a,wrapperConfig:n,Child:e,data:t,mountCB:i.done,unmountEvt:r,onCloseDrawer:this.removePhoneDrawer,forceCloseEvt:o,forceCloseSignal:o.result},[2,i.result]}}))}))},e.prototype.closePhoneDrawer=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this.phoneDrawer?(this.phoneDrawer.forceCloseEvt.done(),[4,this.phoneDrawer.unmountEvt.result]):[3,2];case 1:return[2,e.sent()];case 2:return[2]}}))}))},e.prototype.getPhoneDrawer=function(){return this.phoneDrawer},M([rl],e.prototype,"ready",void 0),M([rl],e.prototype,"errorMesg",void 0),M([rl],e.prototype,"leftSideOpened",void 0),M([rl],e.prototype,"rightSideOpened",void 0),M([rl],e.prototype,"rightSubSlideOpened",void 0),M([rl],e.prototype,"bottomCtrlShowing",void 0),M([rl],e.prototype,"btmMeetingCtrlShowing",void 0),M([rl],e.prototype,"toastWidgets",void 0),M([rl],e.prototype,"dialogWindows",void 0),M([rl],e.prototype,"phoneDrawer",void 0),M([rl],e.prototype,"operationGuideStarted",void 0),M([rl],e.prototype,"sdkPluginCmp",void 0),M([il],e)}(),Ic=e.createContext({}),Pc={mainUI:"mainUI_3WaUf",popWindow:"popWindow_2hDkA",toasts:"toasts_2UPrs",toastWidget:"toastWidget_32Rd4",type:"type_3Xltq",warning:"warning_3aS4q",icon:"icon_2JTm7",content:"content_1_dJM",normalContent:"normalContent_13S0r",show:"show_2WwpT",phoneToastWidget:"phoneToastWidget_hXRIK",btn:"btn_3KOLa",shortTrans:"shortTrans_2YQ-J",hideBottomCtrl:"hideBottomCtrl_2eOFv",bottom_ui:"bottom_ui_1uWFv",hideMeetingCtrl:"hideMeetingCtrl_2iXxV",bottom_meeting_ui:"bottom_meeting_ui_35VHE",dialogWindow:"dialogWindow_3z8f2",pierceBg:"pierceBg_21uax",mask:"mask_2TO9u",fixedFooter:"fixedFooter_1x4oN",phoneDrawerCover:"phoneDrawerCover_XqO7t",coverVisible:"coverVisible_iWVa2",phoneDrawer:"phoneDrawer_3GTxL",swipeArea:"swipeArea_Xc3qO",phoneDrawerDialog:"phoneDrawerDialog_1ibqX",phoneDrawerCancel:"phoneDrawerCancel_2YEUv",divider:"divider_1FEnd",noTransition:"noTransition_Tp5-w",fixBottom:"fixBottom_1J_KJ",aiGenerateToastContainer:"aiGenerateToastContainer_23qp4","ai-show":"ai-show_tXQYu",aiGenerateToastContainerBox:"aiGenerateToastContainerBox_2EOwh",tip:"tip_2xmIa",stop:"stop_2DYjg",bgWrapper:"bgWrapper_1Y6v-","bg-trans":"bg-trans_15Cng",bg:"bg_jmrZS","bg-rotate":"bg-rotate_1yW00",bgImage:"bgImage_2xHes",elementDeleteToastContainer:"elementDeleteToastContainer_27NYc",noclipboard:"noclipboard_uqbaT",text:"text_1cRxJ",ruhecaozuo:"ruhecaozuo_2NfgZ",pluginCmpContainer:"pluginCmpContainer_3ry36",ai_show:"ai-show_tXQYu",bg_trans:"bg-trans_15Cng",bg_rotate:"bg-rotate_1yW00"},Nc=function(t){var n=t.widget,i=t.onRemoved,r=t.index,o=e.useState(!1),a=o[0],s=o[1],l=e.useRef(null),c=e.useContext(xl).phoneMode;e.useEffect((function(){setTimeout((function(){return s(!0)}),50)}),[]),e.useEffect((function(){n.hide&&l.current&&(l.current.style.transform="translate(-50%, -10px)")}),[n.hide]),e.useEffect((function(){if(l.current){l.current.classList.add(Pc.shortTrans);var e=void 0===n.top?8+56*r:n.top;l.current.style.transform="translate(-50%, ".concat(e,"px)"),setTimeout((function(){var e;null===(e=l.current)||void 0===e||e.classList.remove(Pc.shortTrans)}),100)}}),[r,top]);var u=n.type,d=n.content,p=n.contentStyle,h="normal"===u,f=Pc.warning,m=n.btn;return e.createElement("div",{className:j(Pc.toastWidget,c&&Pc.phoneToastWidget,!n.hide&&a&&Pc.show,n.className),style:n.style,onTransitionEnd:function(){n.hide&&i()},ref:l},h?null:e.createElement("div",{className:Pc.type},e.createElement(hl,{className:j(Pc.icon,f),icon:"warning-circle"})),e.createElement("div",{className:j(Pc.content,h&&Pc.normalContent),style:p},d,m?e.createElement("div",{className:Pc.btn,onClick:m.onClick},m.text):null))};function Mc(t){var n,i=t.widget,r=t.onRemoved,o=e.useRef(null),a=function(){var e;if(i.phoneDialog&&"drawer"===i.phoneDialog.type){var t=null===(e=o.current)||void 0===e?void 0:e.drawer;if(t){t.classList.remove(Pc.noTransition);var n=t.getBoundingClientRect().height;t.style.transform="translate(0, ".concat(n,"px)"),t.addEventListener("transitionend",(function(){r()}))}}else r()},s=function(e){i.dialog.done(e),a()},l=function(e){i.dialog.fail(e),a()},c=i.fc;return e.createElement("div",{className:j(Pc.dialogWindow,i.pierceBg&&Pc.pierceBg)},e.createElement("div",{className:Pc.mask,onClick:function(){return i.maskClosable&&a()}}),"drawer"===(null===(n=i.phoneDialog)||void 0===n?void 0:n.type)?e.createElement(Ac,{closeDialog:a,ref:o,config:i.phoneDialog.config},e.createElement(c,{success:s,fail:l,content:i.data})):e.createElement(c,{success:s,fail:l,content:i.data}))}var Ac=e.forwardRef((function(t,n){var i=t.closeDialog,r=t.children,o=t.config,a=void 0===o?{showCancel:!0}:o,s=W().getUpimeTrans,l=e.useRef(null);return e.useImperativeHandle(n,(function(){return{drawer:l.current}})),e.useEffect((function(){var e=function(){var e=l.current;if(e){e.classList.remove(Pc.fixBottom);var t=e.getBoundingClientRect().height,n=function(){e.classList.add(Pc.noTransition),e.style.transform="none",e.classList.add(Pc.fixBottom),e.removeEventListener("transitionend",n)};e.addEventListener("transitionend",n),e.style.transform="translate(0, ".concat(-t,"px)")}},t=function(){setTimeout(e,100)};return window.addEventListener("orientationchange",t),e(),function(){window.removeEventListener("orientationchange",t)}}),[]),e.createElement("div",{className:j(Pc.phoneDrawerDialog,null==a?void 0:a.className),ref:l},r,(null==a?void 0:a.showCancel)&&e.createElement(e.Fragment,null,e.createElement("div",{className:Pc.divider}),e.createElement("div",{className:Pc.phoneDrawerCancel,onClick:i},s("common.cancel"))))}));function Dc(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return t=new Ks,setTimeout((function(){return t.done()}),1e3*e),[4,t.result];case 1:return n.sent(),[2]}}))}))}var Rc=function(t){var n=t.widget,i=e.useContext(xl).upime,r=n.wrapperConfig,o=void 0===r?{}:r,a=n.Child,s=n.data,l=n.forceCloseSignal,c=n.unmountEvt,u=n.onCloseDrawer,d=o.coverVisible,p=void 0===d||d,h=o.classNames,f=o.coverClassNames,m=o.supportSwipe,v=void 0===m||m,g=o.onCloseCB,y=o.closedCB,b=o.markCloseable,E=void 0===b||b,x=e.useRef(null),w=e.useRef(null);e.useEffect((function(){var e=w.current;return e&&(e.style.transform="translate(0, 0)"),function(){c.done()}}),[]);var C=function(){return A(void 0,void 0,void 0,(function(){var e,t;return D(this,(function(n){return null==g||g(),(e=w.current)&&(e.addEventListener("transitionend",(function(){null==y||y(),u()})),t=e.getBoundingClientRect().height,e.style.transform="translate(0, ".concat(t,"px)")),[2]}))}))};e.useEffect((function(){if(l.then(C),v){var e=function(){var e=w.current;e&&(e.style.transform="none")},t=x.current,n={connected:!1,initY:null,offsetY:0},i=function(t){if(n.connected)e(),n.connected=!1,n.initY=0;else if(1===t.touches.length){var i=t.touches[0].pageY;n.connected=!0,n.initY=i}},r=function(e){if(n.connected&&n.initY){var t=w.current;if(t){var i=e.touches[0].pageY-n.initY;n.offsetY=Math.max(i,0),i>=0&&t&&(t.style.transform="translate3d(0, ".concat(i,"px, 0)"))}}},o=function(){w.current&&n.connected&&n.initY&&(n.offsetY>50?C():e(),n.connected=!1,n.initY=null)};return null==t||t.addEventListener("touchstart",i),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",o),function(){null==t||t.removeEventListener("touchstart",i),document.removeEventListener("touchmove",r),document.removeEventListener("touchend",o)}}}),[]);var S=function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return E?(null==e||e.stopPropagation(),[4,Dc(.2)]):[2];case 1:return t.sent(),C(),[2]}}))}))};return e.useEffect((function(){if(!p)return i.userEventManager.subscribe("click",(function(){return S()}))}),[]),e.createElement(e.Fragment,null,p&&e.createElement("div",{className:j(Pc.phoneDrawerCover,Pc.coverVisible,f),onClick:S}),e.createElement("div",{className:j(Pc.phoneDrawer,Pc.fixBottom,h),ref:w},v&&e.createElement("div",{ref:x,className:Pc.swipeArea}),e.createElement(a,exports.E({},s))))},Bc=function(){var t=e.useContext(xl).upime,n=W().getUpimeTrans,i=n("ai.using.tip"),r=n("ai.using.stop");return t.isUsingAi?e.createElement("div",{className:Pc.aiGenerateToastContainer},e.createElement("div",{className:Pc.aiGenerateToastContainerBox},e.createElement("div",{className:Pc.tip},i),e.createElement("div",{className:Pc.divider}),e.createElement("div",{className:Pc.stop,onClick:function(){t.stopAi()}},r),e.createElement("div",{className:Pc.bgWrapper},e.createElement("div",{className:Pc.bg})))):null};function Lc(){}function Oc(){return{dragged:!1,resetDrag:Lc,dragEvent:{subscribe:function(){return Lc},once:function(){return Lc},publish:function(){return Lc}},setBaseSize:Lc,checkTranslation:Lc}}var Fc,zc=e.createContext(Oc()),Hc=e.forwardRef((function(t,n){var i,r=t.children,o=t.className,a=t.style,s=t.noTransform,l=void 0!==s&&s,c=t.initOffset,u=void 0===c?{x:0,y:0}:c,d=t.supportResize,p=void 0!==d&&d,h=t.supportFourCornersResize,f=void 0!==h&&h,m=t.minScale,v=void 0===m?.1:m,g=t.initSize,y=t.resizeBtnClzName,b=t.skip,E=t.freeMode,x=void 0!==E&&E,w=t.onResize,C=t.safeDistance,S=void 0===C?0:C,k=e.useState(!1),_=k[0],T=k[1],I=e.useRef(null),P=e.useRef(null),N=e.useRef({});function M(e,t){I.current&&(I.current.style[e]=t,P.current?P.current.style[e]=t:N.current[e]=t)}function A(e,t){l?(M("left","".concat(e,"px")),M("top","".concat(t,"px"))):M("transform","translate(".concat(e,"px, ").concat(t,"px)"))}e.useEffect((function(){if(P.current){for(var e in N.current){var t=N.current[e];e&&t&&(P.current.style[e]=t)}N.current={}}}),[P.current]);var D=e.useRef({pointerId:null,originPos:{x:0,y:0},originBox:{left:0,top:0,right:0,bottom:0},translate:exports.E({},u),connected:!1,enableDrag:!0,rootRect:{left:0,top:0,right:0,bottom:0},dragging:!1}),R=e.useRef({pointerId:null,curSize:{width:0,height:0},startPos:{x:0,y:0},rootRect:null,initSize:{width:0,height:0}}),B=e.useContext(Ic).rootContainer,L=e.useRef(new ro),O=e.useRef(void 0),F=e.useRef(void 0),z=Array.isArray(S)?S[0]:S,H=Array.isArray(S)?null!==(i=S[1])&&void 0!==i?i:S[0]:S,U=function(){D.current={pointerId:null,originPos:exports.E({},u),originBox:{left:0,top:0,right:0,bottom:0},rootRect:{left:0,top:0,right:0,bottom:0},translate:exports.E({},u),connected:!1,enableDrag:!0,dragging:!1},R.current=exports.E(exports.E({},R.current),{pointerId:null,curSize:{width:0,height:0},startPos:{x:0,y:0},rootRect:null}),A(u.x,u.y),T(!1),L.current.publish("reset",void 0)};e.useImperativeHandle(n,(function(){return{resetDrag:U,forceMoveTo:function(e,t){D.current.translate={x:e,y:t},A(e,t),T(!1)},enableDrag:function(e){D.current.enableDrag=e},setBaseSize:J,setSize:Z,isDragged:function(){return _},setStyle:function(e){for(var t in e)M(t,e[t])}}}));var W=function(e){if(D.current.enableDrag&&(!b||!b(e))){var t=D.current.pointerId;null!==t&&t!==e.pointerId||(D.current.pointerId=e.pointerId,D.current.connected=!0,D.current.originPos={x:e.pageX,y:e.pageY},D.current.originBox=I.current.getBoundingClientRect(),D.current.rootRect=B.current.getBoundingClientRect())}},V=function(e,t){if(void 0===t&&(t=!1),D.current.enableDrag){var n=D.current.pointerId;if((null===n||n===e.pointerId)&&D.current.connected){var i=D.current,r=i.originPos,o=i.originBox,a=i.translate;D.current.dragging||fn({x:e.pageX,y:e.pageY},r)>(_e.isTouchSupported?8:4)&&(D.current.dragging=!0,L.current.publish("start",void 0),T(!0));var s=e.pageX-r.x,l=e.pageY-r.y,c={x:a.x+s,y:a.y+l};if(I.current){var u={left:o.left+s,top:o.top+l,right:o.right+s,bottom:o.bottom+l},d=Xt(u,{left:D.current.rootRect.left+z,top:D.current.rootRect.top+H,right:D.current.rootRect.right-z,bottom:D.current.rootRect.bottom-H}),p={x:d.left-u.left,y:d.top-u.top};c.x+=p.x,c.y+=p.y,A(c.x,c.y)}t&&(D.current.translate=c)}}},G=function(e){if(D.current.enableDrag){var t=D.current.pointerId;null!==t&&t!==e.pointerId||D.current.connected&&(V(e,!0),D.current.connected=!1,D.current.pointerId=null,D.current.dragging&&L.current.publish("end",void 0),D.current.dragging=!1)}},q=function(e,t,n){e.stopPropagation(),O.current=t,F.current=n;var i=R.current.pointerId;null!==i&&i!==e.pointerId||(D.current.connected=!1,D.current.pointerId=null,R.current.pointerId=e.pointerId,R.current.curSize=I.current.getBoundingClientRect(),R.current.startPos={x:e.pageX,y:e.pageY},R.current.rootRect=B.current.getBoundingClientRect(),L.current.publish("start",void 0),document.addEventListener("pointermove",K),document.addEventListener("pointerup",Q))},K=function(e,t){void 0===t&&(t=!1);var n=R.current;if((null===n.pointerId||n.pointerId===e.pointerId)&&n.rootRect&&I.current){var i=n.curSize,r=D.current.translate,o=x&&!e.shiftKey?X(e):Y(e),a=o.nextWidth,s=o.nextHeight;Z(a,s);var l={x:r.x,y:r.y},c=!1;"left"===O.current&&(l.x-=a-i.width,c=!0),"top"===F.current&&(l.y-=s-i.height,c=!0),c&&(A(l.x,l.y),t&&(D.current.translate=l)),t&&(R.current.curSize={width:a,height:s}),w&&w(a,s)}},Y=function(e){var t=R.current;if(!t.rootRect)return{nextWidth:0,nextHeight:0};var n=t.startPos,i=t.curSize,r=t.rootRect,o=t.initSize,a=D.current.translate,s=i.width/i.height,l=function(){var t=e.pageX-n.x,s=0;if("right"===O.current){var l=r.right-z;s=Math.min(l,a.x+i.width+t)-a.x}else{var c=z,u=Math.max(c,a.x+t);s=i.width+(a.x-u)}return Math.max(o.width*v,s)}(),c=l/s;return"bottom"===F.current&&a.y+c>r.bottom-H&&(l=(c=r.bottom-H-a.y)*s),"top"===F.current&&a.y-(c-i.height)<r.top+H&&(l=(c=a.y+i.height-(r.top+H))*s),{nextWidth:l,nextHeight:c}},X=function(e){var t=R.current;if(!t.rootRect)return{nextWidth:0,nextHeight:0};var n=t.startPos,i=t.curSize,r=t.rootRect,o=t.initSize,a=D.current.translate;return{nextWidth:function(){if(void 0===O.current)return Math.max(o.width*v,i.width);var t=e.pageX-n.x,s=0;if("right"===O.current){var l=r.right-z;s=Math.min(l,a.x+i.width+t)-a.x}else{var c=z,u=Math.max(c,a.x+t);s=i.width+(a.x-u)}return Math.max(o.width*v,s)}(),nextHeight:function(){if(void 0===F.current)return Math.max(o.height*v,i.height);var t=e.pageY-n.y,s=0;if("bottom"===F.current){var l=r.bottom-H;s=Math.min(l,a.y+i.height+t)-a.y}else{var c=H,u=Math.max(c,a.y+t);s=i.height+(a.y-u)}return Math.max(o.height*v,s)}()}},Q=function(e){K(e,!0),R.current.pointerId=null,document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",Q),L.current.publish("end",void 0)},Z=function(e,t){I.current&&(M("width","".concat(e,"px")),M("height","".concat(t,"px")),L.current.publish("resize",{width:e,height:t}))},J=function(e,t,n){if(void 0===n&&(n="leftTop"),I.current){if(R.current.initSize.width=e,R.current.initSize.height=t,Z(e,t),"rightBottom"===n){var i=I.current.clientWidth,r=I.current.clientHeight,o=D.current.translate.x,a=D.current.translate.y,s=Math.max(0,o+i-e),l=Math.max(0,a+r-t);D.current.translate={x:s,y:l},A(s,l)}R.current.curSize={width:e,height:t},R.current.rootRect&&(R.current.rootRect=exports.E(exports.E({},R.current.rootRect),{bottom:R.current.rootRect.top+t,right:R.current.rootRect.left+e})),$()}},$=function(){if(I.current&&B.current&&g){var e=I.current.clientWidth,t=I.current.clientHeight,n=D.current.translate.x,i=D.current.translate.y,r=B.current.getBoundingClientRect(),o=exports.E({},D.current.translate),a={width:e,height:t},s=g.width/g.height,l=r.width-2*z,c=r.height-2*H,u=g.width*v,d=g.height*v;x?(a.width>l&&(a.width=Math.max(l,u)),a.height>c&&(a.height=Math.max(c,d))):(a.width>c&&(a.width=Math.max(c,u),a.height=a.width/s),a.height>c&&(a.height=Math.max(c,d),a.width=a.height*s)),Z(a.width,a.height);var p=o.x+a.width-(r.width-z),h=o.y+a.height-(r.height-H);if(p>0||h>0){var f=Math.max(n-Math.max(0,p),z),m=Math.max(i-Math.max(0,h),H);A(f,m),D.current.translate={x:f,y:m},R.current.rootRect&&(R.current.rootRect=exports.E(exports.E({},R.current.rootRect),{left:f,top:m,bottom:m+a.width,right:f+a.height}))}}};e.useLayoutEffect((function(){I.current&&(A(u.x,u.y),g?(Z(g.width,g.height),R.current.initSize=exports.E({},g)):R.current.initSize=I.current.getBoundingClientRect())}),[]),e.useEffect((function(){var e;return null===(e=I.current)||void 0===e||e.addEventListener("pointerdown",W),document.addEventListener("pointermove",V),document.addEventListener("pointerup",G),function(){var e;null===(e=I.current)||void 0===e||e.removeEventListener("pointerdown",W),document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",G),document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",Q)}}),[]);var ee=p?e.createElement(e.Fragment,null,p&&e.createElement("div",{onPointerDown:function(e){return q(e,"right","bottom")},className:j(gc,y)},e.createElement(hl,{icon:"tuozhuaijiaobiao"})),p&&f&&e.createElement(e.Fragment,null,e.createElement("div",{onPointerDown:function(e){return q(e,"right","top")},className:j(gc,"topRight_xCAxD",y)}),e.createElement("div",{onPointerDown:function(e){return q(e,"left","top")},className:j(gc,"topLeft_3pcSw",y)}),e.createElement("div",{onPointerDown:function(e){return q(e,"left","bottom")},className:j(gc,"leftBottom_1U0vI",y)})),p&&x&&e.createElement(e.Fragment,null,e.createElement("div",{onPointerDown:function(e){return q(e,void 0,"top")},className:j(yc,"top_37Phf")}),e.createElement("div",{onPointerDown:function(e){return q(e,"right",void 0)},className:j(yc,"right_3f7YJ")}),e.createElement("div",{onPointerDown:function(e){return q(e,void 0,"bottom")},className:j(yc,"bottom_thMiI")}),e.createElement("div",{onPointerDown:function(e){return q(e,"left",void 0)},className:j(yc,"left_1rSXU")}))):null;return e.createElement(e.Fragment,null,e.createElement("div",{ref:I,className:o,style:exports.E(exports.E({},a),{touchAction:"none",transformOrigin:"top left"})},e.createElement(zc.Provider,{value:{dragged:_,resetDrag:U,dragEvent:L.current,setBaseSize:J,checkTranslation:$}},r)),p&&e.createElement("div",{ref:P,className:o,style:exports.E(exports.E({},a),{overflow:"visible",userSelect:"none",pointerEvents:"none",visibility:"hidden"})},ee))})),Uc=e.memo((function(n){var i=n.meetingManager,r=e.useContext(Ic),o=r.toastContainer,a=r.rootContainer,s=i.upime,l=i.meetingConfigs,c=W().getUpimeTrans,u=e.useContext(xl).phoneMode;al(i,["meetingHints","meetings"]);var d=e.useMemo((function(){return i.meetingHints.map((function(e){return i.meetings.find((function(t){return t.id===e}))}))}),[i.meetings,i.meetingHints]);function p(){var e=s.view.viewWidth,t=u?{width:344,y:68}:{width:376,y:9};return{x:(e-t.width)/2,y:t.y}}return o.current&&a.current?e.createElement(e.Fragment,null,d.map((function(n){if(n){var r=Date.now()>n.planStart?c("meeting.alreadyStart"):c("meeting.aboutToStart");return t.createPortal(e.createElement(Hc,{className:"root_37rmg",initOffset:p()},e.createElement(e.Fragment,null,e.createElement("div",{className:"leftPart_237cW"},e.createElement("div",{className:"header_3HnWH"},e.createElement(hl,{icon:"yinshipintonghua"}),e.createElement("span",null," ",r," ")),e.createElement("div",{className:"text_1hiEQ"},n.title)),e.createElement(ul,{type:"primary",className:"action_1y6qt",onClick:function(){return function(e){return A(void 0,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return(t=i.meetingConfigs.preCheckMeetingAccessibility)?[4,t(void 0,e)]:[3,2];case 1:if(!n.sent())return[2];n.label=2;case 2:return s.clearRightSlidePanelGuard(),i.ignoreMeetingHint(e),i.joinMeeting(e),[2]}}))}))}(n.id)}},c("meeting.join")),l.enableCloseReminder&&e.createElement(hl,{icon:"guanbi",className:"closeIcon_1RUmv",onClick:function(){return function(e){i.ignoreMeetingHint(e)}(n.id)}}))),o.current,n.id)}return null}))):null})),Wc=function(t){var n=t.exporter,i=e.useContext(xl).upime,r=W().getUpimeTrans,o=n.completedTaskCount,a=n.totalTaskCount;return al(n,["completedTaskCount","totalTaskCount"]),e.createElement("div",{className:"rootWrap_fKGwf"},e.createElement("div",{className:"leftWrap_2JTXK"},e.createElement(hl,{icon:"jiazai",className:"loadingIcon_3RdRb"}),e.createElement("div",{className:"preparingTip_2RO4h"},r("export.progress.tip")),e.createElement("div",{className:"progress_33238"},"".concat(Math.min(o+1,a),"/").concat(a))),e.createElement("div",{className:"divider_iuYVx"}),e.createElement("div",{className:"rightWrap_3chaL"},e.createElement("div",{className:"cancelBtn_2naaO",onClick:function(){n.destroy(),i.removeFrameExporter(n)}},r("common.cancel"))))},Vc=function(){var t=e.useContext(xl).upime,n=Array.from(t.frameExporters);return al(t,["frameExporters"]),e.createElement("div",{className:"rootWrap_1eseE"},n.map((function(t){return e.createElement(Wc,{key:t.id,exporter:t})})))},jc=function(t){var n=t.downloader,i=W().getUpimeTrans;return e.createElement("div",{className:"rootWrap_1pnz8"},e.createElement("div",{className:"leftWrap_3RgLd"},e.createElement(hl,{icon:"jiazai",className:"loadingIcon_HFsLF"}),e.createElement("div",{className:"preparingTip_1G0uY"},i("export.progress.tip"))),e.createElement("div",{className:"divider_vHNuy"}),e.createElement("div",{className:"rightWrap_3fQU2"},e.createElement("div",{className:"cancelBtn_pGKhd",onClick:function(){n.cancel()}},i("common.cancel"))))},Gc=function(){var t=e.useContext(xl).upime,n=Array.from(t.filesZipDownloaders);return al(t,["filesZipDownloaders"]),e.createElement("div",{className:"rootWrap_CE9JY"},n.map((function(t){return e.createElement(jc,{key:t.id,downloader:t})})))},qc=function(t){var n=t.uiController,i=t.extensionConfigs,r=t.children;al(n),al(n.upime,["viewLocked"]);var o=e.useContext(xl).phoneMode,a=n.ready,s=n.leftSideOpened,l=n.openLeftSide,c=n.rightSideOpened,u=n.toggleRightSide,d=n.closeRightSide,p=n.bottomCtrlShowing;n.showBottomCtrl;var h=n.toastWidgets,f=n.dialogWindows,m=n.rightSubSlideOpened,v=n.openRightSubSlide,g=n.btmMeetingCtrlShowing,y=n.phoneDrawer,b=n.sdkPluginCmp,E=e.useState(null),x=E[0],w=E[1],C=e.useRef(x);function S(e){C.current!==e&&(C.current=e,w(e))}function k(e){e===C.current&&(C.current=null,w(null))}C.current=x;var _=e.useRef(null),T=e.useRef(null),I=e.useRef(null),P=e.useRef(null),N=e.useState(!1),M=N[0],A=N[1],D=e.useState(!1),R=D[0],B=D[1],L=e.useState(!1),O=L[0],F=L[1],z=_e.desktop&&!_e.isTouchSupported,H=h.filter((function(e){return void 0!==e.top})),U=h.filter((function(e){return void 0===e.top}));return e.createElement("div",{className:j(Pc.mainUI,z?"do-hovers":"",o?"phoneMode":"",!p&&Pc.hideBottomCtrl,!g&&Pc.hideMeetingCtrl),ref:_,id:"upime-main-ui"},e.createElement(Ic.Provider,{value:{tipId:x,showTip:S,hideTip:k,toggleTip:function(e){return C.current===e?(k(e),!1):(S(e),!0)},ready:a,leftSideOpened:s,openLeftSide:l,rightSideOpened:c,toggleRightSide:u,closeRightSide:d,bottomCtrlShowing:p,rootContainer:_,popContainer:T,toastContainer:I,rightSubSlideOpened:m,openRightSubSlide:v,showElementBar:M,setShowElementBar:A,showToolbarSubwindow:R,setShowToolbarSubwindow:B,phoneLayout:O,setPhoneLayout:F,phoneElementSubBarContainer:P,extensionConfigs:i}},e.createElement("div",{ref:T}),r,y&&e.createElement(e.Fragment,{key:y.id},e.createElement(Rc,{widget:y})),e.createElement("div",{className:Pc.toasts,ref:I},H.map((function(t,i){return e.createElement(Nc,{key:t.widgetId,widget:t,index:i,onRemoved:function(){return n.toastRemoved(t.widgetId)}})})),U.map((function(t,i){return e.createElement(Nc,{key:t.widgetId,widget:t,index:i,onRemoved:function(){return n.toastRemoved(t.widgetId)}})})),f.map((function(t){return e.createElement(Mc,{key:t.widgetId,widget:t,onRemoved:function(){var e,i,r;n.removeWindow(t.widgetId),null===(r=null===(i=null===(e=t.phoneDialog)||void 0===e?void 0:e.config)||void 0===i?void 0:i.onRemove)||void 0===r||r.call(i)}})}))),e.createElement(Bc,null),e.createElement("div",{className:Pc.pluginCmpContainer},b.length>0&&b.map((function(t){var n=t.id,i=t.Cmp;t.pluginId;var r=t.props;return e.createElement(i,exports.E({key:n},null!=r?r:{}))}))),e.createElement(Vc,null),e.createElement(Gc,null),n.upime.userManager.enableMeeting&&e.createElement(Uc,{meetingManager:n.upime.meetingManager}),e.createElement("div",{className:Pc.timerPortal,id:"timerPortal"})))},Kc=function(n){var i=n.element,r=e.useContext(Ic).popContainer;al(i);var o=i.tip,a=i.position,s=e.useContext(Ic).rootContainer;if(!o)return null;var l=s.current?s.current.getBoundingClientRect():{left:0,top:0},c={x:a.x+l.left,y:a.y+l.top};return t.createPortal(e.createElement("div",{className:"tipBorder_2k1FY",style:{left:c.x,top:c.y}},e.createElement("div",{className:"contentWrapper_2zcHR"},e.createElement("div",{className:"content_1rkGG"},o))),r.current)},Yc=function(){function e(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i,this.id="",this._name="",this._users=[],this.textData=this.genTextData()}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e,this.textData=this.genTextData()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"users",{get:function(){return this._users},set:function(e){this._users=e,e.forEach((function(e){var t=e.avatorSource;t||(t=tr(e.avatarUrl),e.avatorSource=t),e.avatarUrl&&er(t)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userAvatorSources",{get:function(){return this._users.map((function(e){return e.avatorSource}))},enumerable:!1,configurable:!0}),e.prototype.genTextData=function(){var e={text:this.name,fontFamily:He,fontSize:14,lineHeight:24,textWidth:200,lineClamp:1,textOverflow:"ellipse"};return e.metrics=Da(e),e},Object.defineProperty(e.prototype,"rect",{get:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"borderBox",{get:function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height}},enumerable:!1,configurable:!0}),e.prototype.doClip=function(e){var t=this,n=t.x,i=t.y,r=t.width,o=t.height;n=(n-e.left)*e.scale,i=(i-e.top)*e.scale,r*=e.scale,o*=e.scale,za([new wa({x:n,y:i,width:r,height:o})])},e.prototype.renderBorder=function(e){var t,n=this,i=n.x,r=n.y,o=n.width,a=n.height,s=n.textData,l=n.userAvatorSources;fa({x:-e.left*e.scale,y:-e.top*e.scale,scaleX:e.scale,scaleY:e.scale});var c=i,u=r-44,d=24,p=(null===(t=s.metrics)||void 0===t?void 0:t.width)||200;d+=p;var h,f,m,v=l.length,g=v>4?v-3:0;if(v&&(d+=8,g>0?((h={text:"+"+g,fontSize:12,lineHeight:18,fontFamily:He}).metrics=f=Da(h),d+=g>0&&g<10?84:68+Math.max(24,f.width)):d+=20*v+4),this.name&&(Na((function(e){e.beginFill(790564,.6),e.drawRoundedRect(c,u,d,38,4),e.endFill()})),Ra(s,{fill:"#fff",x:c+12,y:u+7})),v){for(var y=js.value.addLoadingSource,b=v>4?3:v,E=c+20+p,x=u+7,w=new Ca({cx:12,cy:12,rx:12,ry:12}),C=0;C<b;C++){fa({x:E,y:x,stroke:"#fff",lineWidth:2,globalAlpha:1}),za([w]);var S=l[C];!S.loaded&&y&&y(S),Oa({src:S,x:0,y:0,width:24,height:24}),m=w,sa.processElement(m),ma(),E+=20}if(h&&f){var k=f.width;Na((function(e){e.beginFill(15527150),e.lineStyle(1,16777215),g<10?e.drawCircle(E+12,x+12,11):e.drawRoundedRect(E+.5,x+.5,Math.max(k,24)+7,23,11.5)}));var _=E;g<10?_+=(24-k)/2:(_+=4,k<24&&(_+=(24-k)/2)),Ra(h,{x:_,y:x+3,fill:"#0C1024"})}}Ma((function(t){var n=t.context;n.save(),n.shadowColor="rgba(0,0,0,0.12)",n.shadowBlur=5*e.scale,n.shadowOffsetX=0,n.shadowOffsetY=0,n.lineWidth=1,n.strokeStyle="#C2C3C8";var s=new Path2D;s.rect(-10,-10,o+20,a+20),s.rect(i,r,o,a),n.clip(s,"evenodd"),n.beginPath(),n.rect(i,r,o,a),n.stroke(),n.restore()})),ma()},e}(),Xc={left:"0px",top:"0px"},Qc=function(t){var n=t.upime,i=t.viewbox,r=t.simpleContentEditor,o=t.setDom,a=n.phoneMode&&_e.isIphoneLike,s=e.useRef(null);e.useEffect((function(){o(s.current||void 0)}),[s.current]),e.useEffect((function(){var e;if(s.current&&r)return r.bindDom(s.current);r||null===(e=s.current)||void 0===e||e.blur()}),[r]);var l=function(){if(a)return{};if(!r)return Xc;if(!r.editing&&!r.standby)return Xc;var e=r.cursorPosition;if(!e)return Xc;var t=r.proxy.getPosition(),o=r.proxy.scrollX,s=r.proxy.getScale(),l=t.x+(e.x-o)*s,c=t.y+e.y*s,u=n.view.getScreenPosition({x:l,y:c}),d=r.proxy.option.lineHeight*s*i.scale,p=(i.right-i.left)*i.scale,h=(i.bottom-i.top)*i.scale,f=Math.min(Math.max(u.x,0),p-d),m=Math.min(Math.max(u.y,0),h-d);return{left:"".concat(f,"px"),top:"".concat(m,"px"),height:"".concat(d,"px"),fontSize:"".concat(d,"px"),width:"".concat(d,"px")}}();return e.createElement("textarea",{className:j(qr,a&&Kr),ref:s,style:l,spellCheck:"false",draggable:"false","data-native-evt-handle":!!(null==r?void 0:r.editing)})};function Zc(e,t){var n,i;if(null===(n=e.watermark)||void 0===n?void 0:n.src.loaded){var r,o,a=e.watermark.src,s=e.view,l=a.originWidth,c=a.originHeight,u=null!==(i=null==t?void 0:t.scale)&&void 0!==i?i:1;t?(r=t.right-t.left,o=t.bottom-t.top):(r=s.viewWidth,o=s.viewHeight);var d=Math.ceil(r/l),p=Math.ceil(o/c);fa({scaleX:u,scaleY:u});for(var h=0;h<d;h++)for(var f=0;f<p;f++)Oa({x:l*h,y:l*f,src:a,width:l,height:c});ma()}}var Jc=function(e,t){return Math.log(t)/Math.log(e)},$c={dotSize:Jc(2,12),lightness:227},eu={dotSize:Jc(2,24),lightness:196},tu=((Fc={1:24})[.5]=48,Fc[1/4]=96,Fc[1/8]=192,Fc[1/16]=384,Fc[1/32]=768,Fc[1/64]=1536,Fc[1/128]=3072,Fc[1/256]=6144,Fc[1/512]=12288,Fc[1/1024]=24576,Fc),nu=Object.entries(tu).map((function(e){var t=e[0],n=e[1];return[Number(t),n]})).sort((function(e,t){return Number(e[0])-Number(t[0])}));var iu,ru=0,ou={};function au(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e),i.onload=function(){t(i.response)},i.onerror=n,i.send()}))}function su(e){return A(this,void 0,void 0,(function(){var t,n,r;return D(this,(function(o){switch(o.label){case 0:return iu||((iu=new Worker(new URL("../worker/decoder.worker.js","undefined"==typeof document?require("url").pathToFileURL(__filename).href:i&&i.src||new URL("index-d9a8b77f.js",document.baseURI).href))).onmessage=function(e){var t=e.data;switch(t.t){case 0:case 2:!function(e){ou[e.index](e)}(t);break;case 3:!function(e){null==iu||iu.postMessage({index:e.index,t:1,e:0})}(t);break;case 1:!function(e){var t=e.index;ou[t](null),delete ou[t]}(t)}}),t=iu,n=++ru,"string"!=typeof e?[3,2]:[4,au(e)];case 1:return r=o.sent(),[3,4];case 2:return[4,(a=e,new Promise((function(e){var t=new FileReader;t.onloadend=function(t){var n;e(null===(n=t.target)||void 0===n?void 0:n.result)},t.readAsArrayBuffer(a)})))];case 3:r=o.sent(),o.label=4;case 4:return[2,new Promise((function(e){var i={index:n,d:r,t:0};ou[n]=function(t){e(t)},t.postMessage(i)}))]}var a}))}))}function lu(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,new Promise((function(t){var n={t:2,index:e.index,loop:0};ou[e.index]=function(e){t(e)},null==iu||iu.postMessage(n)}))]}))}))}var cu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.onSourceLoaded=function(e){this.publish("sourceLoaded",e)},t.prototype.onSourceError=function(e,t){this.publish("sourceError",{source:e,error:t})},t.prototype.getTempSourceFromBackup=function(e){var t,n;if(this.backupFile){var i=this.backupFile.getSource(e);i.target.loaded?n=i.target:(null===(t=i.temp)||void 0===t?void 0:t.loaded)&&(n=i.temp)}return n},t}(ro),uu=[100,1e3],du=uu[0],pu=function(e){function t(t,n,i){var r=e.call(this)||this;return r.upime=t,r.id=n,r.originSize=i,r.fileUrl="",r.loadingTasks=[],r.originSource=tr(""),r.originSource.ref(r),r.resizeSources=r.initResizeSources(),r}return P(t,e),t.prototype.initResizeSources=function(){for(var e=new Map,t=this.originSize.height,n=0;n<uu.length;n++){var i=uu[n];if(t<=i)break;var r=tr("");r.ref(this),e.set(i,r)}return t<=du?this.loadFileSource(this.originSource):this.loadFileSource(e.get(du),du),e},t.prototype.getFileUrl=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.upime.getFileInfo(this.id)];case 1:return[2,e.sent().url]}}))}))},t.prototype.onSourceLoaded=function(t){this.backupFile=void 0;var n=this.loadingTasks.find((function(e){return e.source===t}));n&&(n.work.done(t),this.loadingTasks=this.loadingTasks.filter((function(e){return e!==n}))),e.prototype.onSourceLoaded.call(this,t)},t.prototype.onSourceError=function(t,n){var i,r=this,o=this.loadingTasks.find((function(e){return e.source===t}));o&&(o.work.fail(n),t!==this.originSource&&Ce===de.PRIVATE&&(null===(i=this.upime.privateDeployConfig)||void 0===i?void 0:i.useOriResOnResizedFailed)?(this.loadingTasks=this.loadingTasks.reduce((function(e,t){return t.source===r.originSource?[t]:(t.work.fail(n),e)}),[]),this.originSource.loaded||(this.setImgSrc(this.originSource),this.loadFileSource(this.originSource))):(this.loadingTasks=this.loadingTasks.filter((function(e){return e!==o})),t.errorCount<=5&&this.creatLoadTask(o.source,o.height))),e.prototype.onSourceError.call(this,t,n)},t.prototype.setImgSrc=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return e.imgSrc?[3,3]:(n=this.fileUrl)?[3,2]:[4,this.getFileUrl()];case 1:n=o.sent(),o.label=2;case 2:Ce===de.PRIVATE?(i=n.lastIndexOf("."),r=n.substring(i+1),e.imgSrc=t?"".concat(n,"_z/h").concat(.9*t,".").concat(r):n):e.imgSrc=n+(t?"?x-oss-process=image/resize,h_".concat(.9*t):""),this.publish("imgSrcUpdate",e),o.label=3;case 3:return[2]}}))}))},t.prototype.doLoadFileSource=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.setImgSrc(e,t)];case 1:return n.sent(),er(e),[2]}}))}))},t.prototype.creatLoadTask=function(e,t){var n=this,i=new Ks,r={source:e,work:i,height:t};return this.loadingTasks.push(r),e.errorCount?setTimeout((function(){n.doLoadFileSource(e,t)}),1e3*Math.pow(2,e.errorCount)):this.doLoadFileSource(e,t),r},t.prototype.loadFileSource=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){return e.loaded||e.errorCount>5?[2,Promise.resolve(e)]:(n=this.loadingTasks.find((function(t){return t.source===e})),n||(n=this.creatLoadTask(e,t)),[2,n.work.result])}))}))},t.prototype.getSuitableResizeHeight=function(e){var t=this.originSize.height;if(!(t<=du)){for(var n,i=0,r=uu;i<r.length;i++){var o=r[i];if(o>=t)break;if(o>=e){n=o;break}}return n}},t.prototype.loadSuitableSource=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){return(t=this.getSuitableResizeHeight(e))?(n=this.resizeSources.get(t),[2,this.loadFileSource(n,t)]):[2,this.loadFileSource(this.originSource)]}))}))},t.prototype.getSource=function(e){var t=this;void 0===e&&(e={});var n=e.height,i=e.autoLoad,r=void 0===i||i,o=e.exact,a=void 0!==o&&o,s=this.originSize.height;if(void 0===n||s<=du){var l=void 0;return this.originSource.loaded||(setTimeout((function(){r?t.loadFileSource(t.originSource):t.setImgSrc(t.originSource)}),0),l=this.getTempSourceFromBackup(e)),{target:this.originSource,temp:l}}var c,u=this.getSuitableResizeHeight(n);if(u){if((c=this.resizeSources.get(u)).loaded||setTimeout((function(){r?t.loadFileSource(c,u):t.setImgSrc(c,u)}),0),c.loaded||a)return{target:c}}else if((c=this.originSource).loaded||setTimeout((function(){r?t.loadFileSource(c):t.setImgSrc(c)}),0),this.originSource.loaded||a)return{target:c};for(var d=this.resizeSources.get(du),p=1;p<uu.length;p++){var h=uu[p];if(h>n&&d.loaded)break;var f=this.resizeSources.get(h);(null==f?void 0:f.loaded)&&(d=f)}return d.loaded||(this.originSource.loaded?d=this.originSource:(l=this.getTempSourceFromBackup(e))&&(d=l)),{temp:d,target:c}},t}(cu),hu=function(e){function t(t){var n=e.call(this)||this;return n.isLocal=!0,n.id=t,n.source=tr(t),n.source.ref(n),er(n.source),n}return P(t,e),t.prototype.getSource=function(){return{target:this.source}},t}(cu),fu=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o.pageId=r,o}return P(t,e),t.prototype.getFileUrl=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.upime.getFileInfo(this.id)];case 1:return e=t.sent(),[2,"".concat(e.url,"_i/").concat(this.pageId,".jpg")]}}))}))},t}(pu),mu=new Map,vu=document.createElement("canvas"),gu=vu.getContext("2d");function yu(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h;return D(this,(function(f){switch(f.label){case 0:return t=0,n=[],i=[],[4,su(e)];case 1:o=f.sent(),f.label=2;case 2:return[4,lu(o)];case 3:return(r=f.sent())?(a=r.w,s=r.h,l=r.e,c=r.d,vu.width=a,vu.height=s,(u=new ImageData(a,s)).data.set(c),gu.putImageData(u,0,0),d=vu.toDataURL("png"),[4,ir(p=tr(d))]):[3,5];case 4:return f.sent(),n.push(p),h=10*l,i.push(h),t+=h,[3,2];case 5:return[2,{sources:n,delayList:i,duration:t}]}}))}))}var bu,Eu=function(e){function t(){var t=e.call(this)||this;return t.isGif=!0,t.gifData={sources:[],duration:1,delayList:[]},t.beginTime=0,t.firstFrame=tr(""),t.loaded=!1,t}return P(t,e),t.prototype.init=function(){var e;return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.prepareImage()];case 1:return t=n.sent(),[4,this.parseGif(t)];case 2:return 0!==n.sent()&&(null===(e=this.fallback)||void 0===e||e.call(this)),[2]}}))}))},t.prototype.parseGif=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return"string"!=typeof e?[3,2]:((n=mu.get(e))||(n=yu(e),mu.set(e,n)),[4,n]);case 1:return t=i.sent(),[3,4];case 2:return[4,yu(e)];case 3:t=i.sent(),i.label=4;case 4:return 0===t.sources.length?[2,1]:(this.beginTime=performance.now(),this.firstFrame.copyImgSource(t.sources[0]),this.publish("imgSrcUpdate",this.firstFrame),this.gifData=t,[2,0])}}))}))},t.prototype.getSource=function(e){var t=this.gifData,n=t.sources,i=t.duration,r=t.delayList;if(!n.length){var o=this.getTempSourceFromBackup(e);return{target:this.firstFrame,temp:o}}if(null==e?void 0:e.exact)return{target:this.firstFrame};for(var a,s=(performance.now()-this.beginTime)%i,l=0,c=0;l<r.length;l++)if((c+=r[l])>=s){a=c-s;break}return{target:n[l],refreshTime:a}},t}(cu),xu=function(e){function t(t,n){var i=e.call(this)||this;return i.file=t,i.localSrc=n,i.id=n,i.init(),i}return P(t,e),t.prototype.prepareImage=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.file]}))}))},t}(Eu),wu=function(e){function t(t,n){var i=e.call(this)||this;return i.upime=t,i.id=n,i.init(),i}return P(t,e),t.prototype.prepareImage=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.upime.getFileInfo(this.id)];case 1:return[2,e.sent().url]}}))}))},t}(Eu),Cu=function(){function e(e){var t=this;this.upime=e,this.bgImgArr=[],this.gridChanged=!1,this.vbChanged=!1,this.bgChanged=!1,this.immersivePlayingChanged=!1,this.lastGridType=null,this.lastViewBox=null,this.lastImmersivePlaying=!1,this.getBgImgsInViewbox=function(e){return t.bgImgArr.reduce((function(t,n){var i=n.position,r=n.size;return Kt(e,{left:i.x,right:i.x+r.width,top:i.y,bottom:i.y+r.height})?R(R([],t,!0),[exports.E({},n)],!1):t}),[])},this.renderBg=function(e){var t=e.alpha,n=e.position,i=e.size,r=e.lastestSource;fa({alpha:t}),Oa({x:n.x,y:n.y,src:r,width:i.width,height:i.height}),ma()}}return e.prototype.addBgImageData=function(e){var t=this,n=e.fileId,i=e.originSize,r=e.id;if(!this.bgImgArr.find((function(e){return e.id===r}))){var o=new pu(this.upime,n,i);this.bgImgArr.push(exports.E(exports.E({imageFile:o},e),{cleanUp:o.subscribe("sourceLoaded",(function(){t.bgChanged=!0}))})),this.bgChanged=!0}},e.prototype.removeBgImgData=function(e){var t,n=this.bgImgArr.find((function(t){return t.id===e}));n&&(null===(t=n.cleanUp)||void 0===t||t.call(n),this.bgImgArr=this.bgImgArr.filter((function(t){return t.id!==e})),this.bgChanged=!0)},e.prototype.update=function(){this.vbChanged=!0},Object.defineProperty(e.prototype,"needUpdate",{get:function(){return this.gridChanged||this.vbChanged||this.bgChanged||this.immersivePlayingChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this.upime.view},enumerable:!1,configurable:!0}),e.prototype.didRendered=function(){this.gridChanged=!1,this.vbChanged=!1,this.bgChanged=!1,this.immersivePlayingChanged=!1},e.prototype.checkUpdate=function(){var e=this.view.getViewbox(),t=!yt.exports.isEqual(this.lastViewBox,e);this.lastViewBox=e,this.vbChanged||(this.vbChanged=t);var n=this.view.viewGridType!==this.lastGridType;this.lastGridType=this.view.viewGridType,this.gridChanged=n,this.immersivePlayingChanged=this.lastImmersivePlaying!==this.view.isImmersivePlaying,this.lastImmersivePlaying=this.view.isImmersivePlaying},e.prototype.render=function(){var e=this,t=this.view;t.viewWidth,t.viewHeight;var n=t.isImmersivePlaying,i=t.viewGridType;if(this.lastViewBox){var r=this.lastViewBox,o=r.left,a=r.top,s=r.scale;fa({x:-o*s,y:-a*s,scaleX:s,scaleY:s}),this.bgImgArr.forEach((function(t){var n=t.imageFile,i=t.position,o=t.size;if(Kt({left:i.x,right:i.x+o.width,top:i.y,bottom:i.y+o.height},r)){var a=n.getSource({height:o.height*s}),l=a.temp,c=a.target;if(c.loaded||(null==l?void 0:l.loaded)){if(l)return t.lastestSource=l,void e.renderBg(t);t.lastestSource=c,e.renderBg(t)}}})),ma(),!n&&this.lastGridType&&function(e){var t=e.upime,n=e.viewbox,i=e.gridType,r=t.view;switch(i){case qa.NONE:return null;case qa.LINE:return function(e){var t=e.view,n=e.viewbox,i=t.viewWidth,r=t.viewHeight,o=n.left,a=n.top,s=n.bottom,l=n.right,c=n.scale,u=t.scale,d=t.memo.useMemo("lineGrid",(function(){for(var e=new Path2D,t=void 0,n=100,i=n*c;;)if(i<100)i=(n*=5)*c;else{if(!(i>500))break;i=(n/=5)*c}for(var r=Math.floor(o/n)*n;r<l+n;r+=n){var u=r*c-o*c;e.moveTo(u,0),e.lineTo(u,s*c-a*c)}for(r=Math.floor(a/n)*n;r<s+n;r+=n){var d=(r-a)*c;e.moveTo(0,d),e.lineTo((l-o)*c,d)}if(i>160){var p=n/5*c,h=(i-160)/500>0?.2+(i-160)/500:0;for(t=new Path2D,r=Math.floor(o/n)*n;r<l+n;r+=n){u=r*c-o*c;for(var f=1;f<5;f++)t.moveTo(u+f*p,0),t.lineTo(u+f*p,(s-a)*c)}for(r=Math.floor(a/n)*n;r<s+n;r+=n)for(d=(r-a)*c,f=1;f<5;f++)t.moveTo(0,d+f*p),t.lineTo((l-o)*c,d+f*p);return{path1:e,path2:t,alpha2:h}}return{path1:e,alpha2:0}}),[o,a,u,r,i]);return Ma((function(e){var t=e.context,n=d.path1,i=d.path2,r=d.alpha2;t.globalAlpha=1,t.lineWidth=1,t.strokeStyle="#e1e1e1",t.stroke(n),i&&(t.globalAlpha=r,t.stroke(i))}))}({view:r,viewbox:n});case qa.DOT:(function(e){var t=e.view,n=t.memo.useMemo("dotGrid",(function(){var e=t.scale,n=Mn(nu[0][0],e,nu[nu.length-1][0]),i=nu.findIndex((function(e){return e[0]>=n})),r=nu[i][1]*e,o=2*Math.max(e,1),a=function(e,t,n){var i=t[0],r=n[0],o=(e-i)/(t[1]-i);return o<0&&(o=0),o>1&&(o=1),r+o*(n[1]-r)}(Jc(2,r),[$c.dotSize,eu.dotSize],[$c.lightness,eu.lightness]);return{cellSize:r,dotSize:o,dotColor:"rgb(".concat(a,", ").concat(a,", ").concat(a,")")}}),[t.scale]),i=n.cellSize,r=n.dotSize,o=n.dotColor;Ma((function(e){var n=e.context,a=t.viewHeight,s=t.viewWidth,l=t.x,c=t.y,u=t.scale,d=l*u%i,p=c*u%i;d=d<0?-d:i-d,p=p<0?-p:i-p,n.save(),n.strokeStyle=o,n.lineWidth=r;var h=d,f=p;for(n.lineCap="round",n.beginPath();h<=s;){for(;f<=a;)n.moveTo(h,f),n.lineTo(h,f+.1),f+=i;f=p,h+=i}n.stroke(),n.restore()}))})({view:r,viewbox:n})}}({upime:this.upime,viewbox:this.lastViewBox,gridType:i}),this.didRendered()}},e.prototype.reset=function(){this.bgImgArr.forEach((function(e){var t;return null===(t=e.cleanUp)||void 0===t?void 0:t.call(e)})),this.bgImgArr=[],this.bgChanged=!0},e.prototype.destroy=function(){this.reset()},e}(),Su=function(){function e(){this.svgWidgets=[]}return e.prototype.addSvgWidget=function(e){this.svgWidgets.includes(e)||(this.svgWidgets=R(R([],this.svgWidgets,!0),[e],!1))},e.prototype.removeSvgWidget=function(e){this.svgWidgets=this.svgWidgets.filter((function(t){return t!==e}))},M([rl],e.prototype,"svgWidgets",void 0),M([il],e)}(),ku=function(t){var n=t.className,i=t.svgLayer,r=t.viewbox,o=t.width,a=t.height,s=t.resolution;al(i);var l=i.svgWidgets,c=Math.floor(o*s),u=Math.floor(a*s);return e.createElement("svg",{className:n,style:{width:o,height:a},width:c,height:u,viewBox:"0 0 ".concat(c," ").concat(u)},e.createElement("g",{transform:"scale(".concat(s,", ").concat(s,")")},l.map((function(t){return e.createElement(t.renderer,{key:t.renderKey,element:t,viewbox:r})}))))},_u=e.memo((function(t){var n=t.className,i=t.upime,r=e.useRef(null),o=W().getUpimeTrans,a=i.view,s=a.viewWidth,l=a.viewHeight,c=a.selectedEditor,u=a.domWidgets,d=a.curCommentDraft,p=a.contextMenu,h=a.connectedRichEditor,f=a.connectedSimpleEditor,m=a.setSimpleEditorTextareaDom,v=a.setEditorTextareaDom,g=a.connectedTextWidget,y=m.bind(a),b=v.bind(a),E=a.getViewbox();e.useEffect((function(){var e=r.current;return e.id="userevent_target",i.launchApp(e)}),[]);var x=a.audios.filter((function(e){return e.checkVisible(E)})),w=e.useReducer((function(e){return e+1}),0)[1],C=e.useRef(null),S=e.useRef(null),k=e.useRef(null);e.useEffect((function(){var e,t=new Gs(i,S.current.app),n=C.current.app,r=k.current,o=new Ys(r,n.width,n.height,{resolution:n.resolution});n.setBgRenderer(o),n.renderer=a,o.renderer=a.bgRender;var s=performance.now(),l=function(){e=fr((function(){var e=!a.updated;a.updated||(a.updated=!0,w()),a.bgRender.checkUpdate(),a.bgRender.needUpdate&&o.render();var r=performance.now(),c=r-s;if(s=r,null!==a.nextRenderDelay&&(a.nextRenderDelay-=c),a.reRenderTargets.forEach((function(e){return e.delay-=c})),e||(e=null!==a.nextRenderDelay&&a.nextRenderDelay<20),e||(e=a.loadingSources.some((function(e){return e.loaded}))),e){for(var u=function(e,t){return void 0===t&&(t=10),Rt({left:Math.max((e.left-a.x)*a.scale-t,0),top:Math.max((e.top-a.y)*a.scale-t,0),right:Math.min((e.right-a.x)*a.scale+t,a.viewWidth),bottom:Math.min((e.bottom-a.y)*a.scale+t,a.viewHeight)})},d=e&&i.userManager.expRenderClip?[]:null;d;){var p=d,h=a.renderBox;if(null===h){d=null;break}h&&p.push(u(h,100));for(var f=0,m=a.reRenderTargets;f<m.length;f++){var v=m[f],g=v.target;if(v.delay<20){if(!g){d=null;break}p.push(u(g.calcRenderBox()))}}if(null===d)break;a.loadingSources.some((function(e){return e.loaded}))&&(d=null);break}a.beforeRender(),(null==d?void 0:d.length)&&n.setRenderClip(d),a.nextRenderDelay=null,a.reRenderTargets=[],n.render(),a.autoRenderWidgetCvs&&a.updateWidgetCvs(),a.renderBox=void 0,n.setRenderClip()}t.tick(),l()}))};return l(),function(){t.destroy(),mr(e)}}),[]),e.useEffect((function(){void 0!==o&&(Oe.placeholder=o("text.placeholder"))}),[o]),e.useEffect((function(){var e=a.nextTickCBs;e&&(e.forEach((function(e){return e()})),a.nextTickCBs=void 0)}));var _=R(R([],a.embeddedElements,!0),x,!0);_.forEach((function(e){return e.updateIndexPath()})),_.sort((function(e,t){for(var n=e.indexPath,i=t.indexPath,r=Math.max(n.length,i.length),o=0;o<r;o++){if(void 0===n[o])return-1;if(void 0===i[o])return 1;if(n[o]!==i[o])return n[o]-i[o]}return e.id>t.id?1:-1}));var T=window.devicePixelRatio;a.lowResolution&&(T*=.5);var I=a.viewClip,P={};if(_.length&&I){var N=(I.x-a.x)*a.scale,M=(I.y-a.y)*a.scale,A=N+I.width*a.scale,D=M+I.height*a.scale;P.clipPath='path("M '.concat(N," ").concat(M," L ").concat(A," ").concat(M," L ").concat(A," ").concat(D," L ").concat(N," ").concat(D,' Z")')}return e.createElement(gs.Provider,{value:{upime:i,viewbox:E}},e.createElement("div",{className:j("board_3Lj2D",n),style:{background:a.viewGridType===qa.DOT?"#f7f7f7":"#f2f2f2"}},e.createElement("div",{className:"canvas_3T1UG",ref:r,style:{cursor:a.cursor}},e.createElement("canvas",{className:"bgCanvas_1896Z",ref:k}),e.createElement("div",{className:"embedded_2Zi5P",style:P},_.map((function(t,n){return e.createElement(t.embeddedRenderer,{key:t.embedRenderKey,element:t,upime:i,viewbox:E,zIndex:n+1})}))),e.createElement(Xs,{ref:C,width:s,height:l,resolution:T})),e.createElement("div",{className:"cvsWidgets_6uLou"},e.createElement(Xs,{ref:S,width:s,height:l,resolution:T})),e.createElement(ku,{className:"svgLayer_3I1Nh",svgLayer:a.svgLayer,viewbox:E,upime:i,width:s,height:l,resolution:T}),e.createElement("div",{className:"control_area_3LSIe"},!i.phoneMode&&d&&e.createElement(d.panelRenderer,{element:d,upime:i}),!i.phoneMode&&a.renderingComments.filter((function(e){return e.expanded})).map((function(t){return e.createElement(t.panelRenderer,{key:t.id,element:t,upime:i})})),c&&e.createElement(c.domRenderer,{element:c,upime:i,viewbox:E,key:c.renderKey}),e.createElement(qs,{setDom:b,upime:i,richContentEditor:h,viewbox:E}),e.createElement(tl,{upime:i,textWidget:g,viewbox:E}),e.createElement(Qc,{upime:i,simpleContentEditor:f,viewbox:E,setDom:y}),p&&e.createElement(p.renderer,{menu:p,key:p.renderKey})),e.createElement("div",{className:"dom_widgets_3R7vO"},u.map((function(t){return e.createElement(t.renderer,{element:t,key:t.renderKey,upime:i,viewbox:E})}))),e.createElement(Kc,{element:a.tipInView})))})),Tu=function(e){function t(t){var n=e.call(this)||this;return n.upime=t,n.x=0,n.y=0,n.viewWidth=0,n.viewHeight=0,n.scale=1,n.isWheeling=!1,n.wheelingTimer=0,n.frames=[],n.audios=[],n.curCommentDraft=null,n.opAssistWidgets=[],n.ctrlWidgets=[],n.domWidgets=[],n.usersCursors=[],n.embeddedElements=[],n.cursor="",n.locks=[],n.updated=!1,n.appRenderer=!1,n.widgetCvsUpdated=!1,n.cursorList=[],n.tipInView=new ol,n.renderingFrames=[],n.renderingComments=[],n.viewGridType=qa.LINE,n.contextMenu=null,n.canvasWidgets=[],n.elementsRoot=new Ws,n.renderingTree={refSystem:n.elementsRoot,children:[]},n.renderingNodes=new Set,n.memo=new el,n.loadingSources=[],n.nextRenderDelay=0,n.viewBoxChanged=!1,n.renderId=1,n.viewClip=null,n.viewSections=[],n.isImmersivePlayingEnabled=!0,n.isImmersivePlaying=!1,n.autoRenderWidgetCvs=!1,n.renderBox=void 0,n.svgLayer=new Su,n.reRenderTargets=[],n.renderApp=function(e,t){(null===n.nextRenderDelay||n.nextRenderDelay>e)&&(n.nextRenderDelay=e),n.upime.userManager.expRenderClip&&n.reRenderTargets.push({target:t,delay:e})},n.immersivePlayAnimationDuration=300,n.immersivePlayAnimationAlpha=0,n._showViewLockedHint=ne((function(){var e=n.upime.viewLockedHintMsg;e&&n.upime.addToast("string"==typeof e?e:O.apply(void 0,e))}),3500),n.lastViewChangeTimestamp=0,n.lowResolution=!1,n.addLoadingSource=function(e){n.loadingSources.push(e)},n.viewBox=n.calcViewBox(),window._test_viewclip=function(e){void 0===e&&(e=1),n.viewClip=new Yc(0,0,500,500),n.viewClip.name="哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈";var t=[];t.length=e;for(var i=0;i<e&&i<5;i++)t[i]=n.upime.localUserInfo;n.viewClip.users=t,n.update()},n.bgRender=new Cu(t),n}return P(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.viewWidth/this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.viewHeight/this.scale},enumerable:!1,configurable:!0}),t.prototype.enableImmersivePlaying=function(e){this.isImmersivePlayingEnabled=e},t.prototype.enterImmersivePlay=function(){!0===this.isImmersivePlayingEnabled&&(this.isImmersivePlaying=!0,this.update())},t.prototype.updatePlayingBorder=function(e){if(!0===this.isImmersivePlayingEnabled&&!0===this.isImmersivePlaying){var t=(e.titleHeight||0)*e.scale*e.globalTransform.currentScale,n=exports.E({},e.getGlobalBox());n.top+=t,this.playingBorderBox=n,this.playingElement=e,clearTimeout(this.resetPlayingBorderBoxTimer),this.startImmersivePlayAnimation(n,1).catch((function(){})),this.update()}},t.prototype.exitImmersivePlay=function(){var e=this;clearTimeout(this.resetPlayingBorderBoxTimer),this.startImmersivePlayAnimation(this.playingBorderBox,0).catch((function(){})),this.resetPlayingBorderBoxTimer=setTimeout((function(){e.isImmersivePlaying=!1,e.playingBorderBox=void 0,e.update()}),this.immersivePlayAnimationDuration)},t.prototype.startImmersivePlayAnimation=function(e,t){var n=this;return new Promise((function(i,r){n.endImmersivePlayAnimation();var o=Ll([n.immersivePlayAnimationAlpha],[t],(function(t,r){var o=t[0];n.isImmersivePlaying&&(n.playingBorderBox=e,n.immersivePlayAnimationAlpha=o,n.update()),r&&i()}),Math.max(n.immersivePlayAnimationDuration*Math.abs(n.immersivePlayAnimationAlpha-t),30));n.cancelImmersivePlayAnimation=function(){o(),r()}}))},t.prototype.endImmersivePlayAnimation=function(){var e;null===(e=this.cancelImmersivePlayAnimation)||void 0===e||e.call(this)},t.prototype.update=function(e){void 0===e&&(e=null),null!==this.renderBox&&(null===e?this.renderBox=null:this.renderBox?this.renderBox=Yt([this.renderBox,e]):this.renderBox=e),this.updated=!1},t.prototype.updateWidgetCvs=function(){this.widgetCvsUpdated=!1},t.prototype.setWidgetCvsAutoRender=function(e){this.autoRenderWidgetCvs=e},t.prototype.getRenderComments=function(e){var t=this.upime.elementManager.getAllComments((function(t){return t.checkVisible(e)}));return this.upime.phoneMode&&this.curCommentDraft?t.concat([this.curCommentDraft]):t},t.prototype.getViewbox=function(){return this.viewBox},t.prototype.calcViewBox=function(){var e=this,t=e.x,n=e.y;return{left:t,top:n,right:t+e.width,bottom:n+e.height,scale:e.scale}},t.prototype.setViewRect=function(e,t){void 0===t&&(t=!1);var n=e.x,i=e.y,r=e.width,o=e.height,a=n+r/2,s=i+o/2,l=this.viewWidth/r,c=this.viewHeight/o,u=Math.min(l,c);this.setView(a-this.viewWidth/2/u,s-this.viewHeight/2/u,u,t)},t.prototype.onViewChange=function(){var e=performance.now();e-this.lastViewChangeTimestamp<t.lowResolutionTimeGap?this.enterLowResolution():this.exitLowResolution(),this.lastViewChangeTimestamp=e},t.prototype.enterLowResolution=function(){var e=this;this.upime.userManager.expLowResolutionWhenViewChange&&(this.exitLowResolutionTimer&&clearTimeout(this.exitLowResolutionTimer),this.lowResolution=!0,this.exitLowResolutionTimer=window.setTimeout((function(){e.lowResolution=!1,e.update(),e.bgRender.update()}),t.lowResolutionTimeGap))},t.prototype.exitLowResolution=function(){this.exitLowResolutionTimer&&(clearTimeout(this.exitLowResolutionTimer),this.exitLowResolutionTimer=void 0),this.lowResolution&&(this.lowResolution=!1,this.update(),this.bgRender.update())},t.prototype.setView=function(e,t,n,i){var r=this;void 0===i&&(i=!1),this.x===e&&this.y===t&&this.scale===n||(this.upime.viewLocked&&!i&&this._showViewLockedHint(),this.upime.viewLocked&&!i||(this.x=e,this.y=t,void 0!==n&&(this.scale=n,this.isWheeling=!0,window.clearTimeout(this.wheelingTimer),this.wheelingTimer=window.setTimeout((function(){r.isWheeling=!1,r.update()}),20)),this.viewBox=this.calcViewBox(),this.viewBoxChanged=!0,this.update(),this.publish("viewboxChange",this.getViewbox()),this.onViewChange()))},t.prototype.setViewSize=function(e,t){e===this.viewWidth&&t===this.viewHeight||(this.viewWidth=e,this.viewHeight=t,this.viewBox=this.calcViewBox(),this.viewBoxChanged=!0,this.update(),this.publish("viewboxChange",this.getViewbox()))},t.prototype.nextTick=function(e){var t=new Ks,n=function(){e(),t.done()};return this.nextTickCBs?this.nextTickCBs.push(n):this.nextTickCBs=[n],t.result},t.prototype.resetData=function(){this.frames=[],this.locks=[],this.audios=[],this.embeddedElements=[],this.selectedEditor=void 0,this.opAssistWidgets=[],this.curCommentDraft=null,this.connectedRichEditor=void 0,this.connectedSimpleEditor=void 0,this.nextTickCBs=void 0,this.currentTip=void 0,this.tipInView.tip="",this.update(),this.bgRender.reset()},t.prototype.setTip=function(e,t,n){this.currentTip={tip:e,position:t,consumer:n},this.tipInView.tip=e,this.tipInView.position=t},t.prototype.clearTip=function(e){var t;(null===(t=this.currentTip)||void 0===t?void 0:t.consumer)===e&&(this.currentTip=void 0,this.tipInView.tip="")},t.prototype.setCursor=function(e,t){var n=this.cursorList;if(!t)return this.cursor=e,void this.update();var i=n.findIndex((function(e){return e.consumer===t})),r=!1;e?i>=0?(n[i].cursor=e,i===this.cursorList.length-1&&(this.cursor!==e&&(r=!0),this.cursor=e)):(n.push({consumer:t,cursor:e}),this.cursor!==e&&(r=!0),this.cursor=e):i>=0&&(n.splice(i,1),e=n.length>0?n[n.length-1].cursor:"",this.cursor!==e&&(r=!0),this.cursor=e),r&&this.update()},t.prototype.addCtrlWidget=function(e){this.ctrlWidgets=R(R([],this.ctrlWidgets,!0),[e],!1),this.update()},t.prototype.removeCtrlWidget=function(e){this.ctrlWidgets=this.ctrlWidgets.filter((function(t){return t!==e})),this.update()},t.prototype.addAssistWidget=function(e){var t;this.opAssistWidgets=R(R([],this.opAssistWidgets,!0),[e],!1),null===(t=e.onMount)||void 0===t||t.call(e),this.update()},t.prototype.removeAssistWidget=function(e){var t;this.opAssistWidgets=this.opAssistWidgets.filter((function(t){return t!==e})),null===(t=e.onUnmount)||void 0===t||t.call(e),this.update()},t.prototype.addCanvasWidget=function(e,t){var n;void 0===t&&(t=!1),this.canvasWidgets.includes(e)||(t?this.canvasWidgets.unshift(e):this.canvasWidgets.push(e),null===(n=e.onMount)||void 0===n||n.call(e)),this.updateWidgetCvs()},t.prototype.removeCanvasWidget=function(e){var t;this.canvasWidgets=this.canvasWidgets.filter((function(t){return t!==e})),null===(t=e.onUnmount)||void 0===t||t.call(e),this.updateWidgetCvs()},t.prototype.addDomWidget=function(e){this.domWidgets=R(R([],this.domWidgets,!0),[e],!1),this.update()},t.prototype.removeDomWidget=function(e){this.domWidgets=this.domWidgets.filter((function(t){var n;return t===e&&(null===(n=t.onDestroy)||void 0===n||n.call(t)),t!==e})),this.update()},t.prototype.addEmbeddedElement=function(e){this.embeddedElements.includes(e)||(this.embeddedElements=R(R([],this.embeddedElements,!0),[e],!1)),this.update()},t.prototype.removeEmbeddedElement=function(e){this.embeddedElements=this.embeddedElements.filter((function(t){return t!==e})),this.update()},t.prototype.addSvgWidget=function(e){this.svgLayer.addSvgWidget(e)},t.prototype.removeSvgWidget=function(e){this.svgLayer.removeSvgWidget(e)},t.prototype.getScreenPosition=function(e){var t=e.x,n=e.y;return{x:t=(t-this.x)*this.scale,y:n=(n-this.y)*this.scale}},t.prototype.getAbsolutePosition=function(e){var t=e.x,n=e.y;return{x:t=this.x+t/this.scale,y:n=this.y+n/this.scale}},t.prototype.addContextMenu=function(e){this.contextMenu=e,this.update()},t.prototype.removeContextMenu=function(){this.contextMenu=null,this.update()},t.prototype.setConnectedRichEditor=function(e){var t,n,i;this.upime.editable&&this.connectedRichEditor!==e&&((null===(t=this.connectedRichEditor)||void 0===t?void 0:t.editing)&&(null===(n=this.connectedRichEditor)||void 0===n||n.stopEdit()),this.connectedRichEditor=e,this.connectedEditorTextareaDom&&(null===(i=this.unbind)||void 0===i||i.call(this),this.unbind=e.bindDom(this.connectedEditorTextareaDom),!_e.desktop&&this.connectedEditorTextareaDom.blur()))},t.prototype.clearConnectedRichEditor=function(){var e,t,n,i,r;(null===(e=this.connectedRichEditor)||void 0===e?void 0:e.domLocked)||((null===(t=this.connectedRichEditor)||void 0===t?void 0:t.editing)&&(null===(n=this.connectedRichEditor)||void 0===n||n.stopEdit()),this.connectedRichEditor=void 0,null===(i=this.unbind)||void 0===i||i.call(this),this.unbind=void 0,null===(r=this.connectedEditorTextareaDom)||void 0===r||r.blur())},t.prototype.setConnectedSimpleEditor=function(e){var t,n;if(this.upime.editable)return this.connectedSimpleEditor!==e&&((null===(t=this.connectedSimpleEditor)||void 0===t?void 0:t.editing)&&(null===(n=this.connectedSimpleEditor)||void 0===n||n.stopEdit()),this.connectedSimpleEditor=e),this.connectedSimpleEditorTextareaDom},t.prototype.clearConnectedSimpleEditor=function(e){var t,n,i;e&&this.connectedSimpleEditor!==e||((null===(t=this.connectedSimpleEditor)||void 0===t?void 0:t.editing)&&(null===(n=this.connectedSimpleEditor)||void 0===n||n.stopEdit()),this.connectedSimpleEditor=void 0,null===(i=this.connectedSimpleEditorTextareaDom)||void 0===i||i.blur())},t.prototype.setSimpleEditorTextareaDom=function(e){this.connectedSimpleEditorTextareaDom=e},t.prototype.setEditorTextareaDom=function(e){this.connectedEditorTextareaDom=e},t.prototype.setConnectedTextWidget=function(e){this.upime.editable&&this.connectedTextWidget!==e&&(this.connectedTextWidget&&this.connectedTextWidget.forEach((function(e){e.editing&&e.stopEdit()})),this.connectedTextWidget=e)},t.prototype.clearConnectedTextWidget=function(){this.connectedTextWidget&&this.connectedTextWidget.forEach((function(e){e.editing&&e.stopEdit()})),this.connectedTextWidget=void 0},t.prototype.beforeRender=function(){var e,t=this;if(this.renderId++,e=this.getViewbox(),this.viewClip){var n=e.scale;null!==(e=Ln(e,Bt(this.viewClip.rect)))&&(e.scale=n)}null===e?(this.renderingFrames=[],this.renderingTree={refSystem:this.elementsRoot,children:[]},this.renderingComments=[]):(this.renderingFrames=this.frames.filter((function(t){return t.checkVisible(e)})),this.renderingTree=this.elementsRoot.calcRenderTree(e),this.renderingComments=this.getRenderComments(e));var i=this.getRenderNodes();i.forEach((function(e){e.lastRenderId=t.renderId})),this.renderingNodes.forEach((function(e){e.lastRenderId!==t.renderId&&e.onUnRender()})),this.renderingNodes=i},t.prototype.getRenderNodes=function(){for(var e=new Set,t=R([],this.renderingTree.children,!0);t.length;){var n=t.pop();n&&(n.elementType?e.add(n):t.push.apply(t,n.children))}return e},t.prototype.render=function(){var e,t=this,n=t.upime,i=t.x,r=t.y;t.viewWidth,t.viewHeight;var o=t.scale,a=t.selectedEditor,s=t.opAssistWidgets,l=t.locks,c=t.ctrlWidgets,u=t.groupSelectEles,d=t.playingBorderBox,p=t.immersivePlayAnimationAlpha,h=t.renderApp,f=t.addLoadingSource,m=t.renderingFrames,v=t.renderingTree,g=t.renderingComments,y=t.viewClip,b=t.viewSections;this.loadingSources.length=0;var E=this.getViewbox(),x=E;y&&null!==(x=Ln(E,Bt(y.rect)))&&(x.scale=E.scale);var w=n.phoneMode?g:g.filter((function(e){return!e.expanded})),C=null===x?[]:l.filter((function(e){return e.borderRect&&Kt(e.borderRect,x)}));js.setContext({renderApp:h,addLoadingSource:f,viewbox:E,upime:n,getElementAlpha:function(e){return e.groupLocked||u&&!u.includes(e)||n.searchHighlightEles&&!n.searchHighlightEles.has(e)?.3:1}}),fa({}),null==y||y.doClip(E),fa({x:-i*o,y:-r*o,scaleX:o,scaleY:o}),m.forEach((function(e){return e.bgRenderer(e)})),Vs(v),ma(),fa({x:-i*o,y:-r*o}),m.forEach((function(e){return e.renderer(e)})),w.forEach((function(e){return e.renderer(e)})),ma(),(null===(e=n.watermark)||void 0===e?void 0:e.isGlobal)&&Zc(n),ma(),b.forEach((function(e){return e.renderBorder(E)})),y&&!b.includes(y)&&(null==y||y.renderBorder(E)),s.forEach((function(e){return e.renderer({element:e,upime:n,viewbox:E})})),a&&(a.isHandMode||!a.editable?ms:a.renderer)({element:a,upime:n,viewbox:E}),C.forEach((function(e){return e.renderer({element:e,upime:n,viewbox:E})})),c.forEach((function(e){return e.renderer({element:e,upime:n,viewbox:E})})),d&&function(e){var t=e.border,n=e.viewbox,i=e.color,r=void 0===i?0:i,o=e.alpha,a=void 0===o?1:o;Ma((function(e){var i=e.context,o=n.left,s=n.top,l=n.right,c=n.bottom,u=n.scale,d=(l-o)*u,p=(c-s)*u,h=(t.left-o)*u,f=(t.top-s)*u,m=(t.right-t.left)*u,v=(t.bottom-t.top)*u;m<20&&(m=20),v<20&&(v=20),i.save();var g=new Path2D;g.rect(0,0,d,p),g.rect(h,f,m,v),i.clip(g,"evenodd"),i.fillStyle=hr(r),i.globalAlpha=a,i.fill(g),i.restore()}))}({border:d,viewbox:E,alpha:p}),js.popContext()},t.prototype.destroy=function(){this.bgRender.destroy()},t.lowResolutionTimeGap=250,t}(ro);function Iu(e){return e.elementType===Za.GRAPHIC}function Pu(e){return e.elementType===Za.STICKER}function Nu(e){return e.elementType===Za.TEXT}function Mu(e){return e.elementType===Za.GRID_TEXT}function Au(e){return e.elementType===Za.SHAPE}function Du(e){return e.elementType===Za.TABLE}function Ru(e){return e.elementType===Za.CONNECTIONLINE}function Bu(e){return e.elementType===Za.MINDMAP_NODE}function Lu(e){return e.elementType===Za.BIG_DOC}function Ou(e){return e.elementType===Za.IMAGE}function Fu(e){return e.elementType===Za.CARD}function zu(e){return e.elementType===Za.FRAME}function Hu(e){return e.elementType===Za.KANBAN}!function(e){e.POST="POST",e.GET="GET",e.PUT="PUT"}(bu||(bu={}));var Uu,Wu=function(e){function t(t){var n=e.call(this)||this;return n.requestConfig=t,n.xhr=new XMLHttpRequest,n}return P(t,e),t.prototype.getXhr=function(){return this.xhr},t.prototype.send=function(e,t){var n,i,r=this,o=this.xhr,a=this.requestConfig,s=exports.E(exports.E({},a),t),l="",c=s.query,u=void 0===c?"":c,d=s.host,p=void 0===d?"":d,h=s.method,f=void 0===h?bu.POST:h,m=s.url,v=s.timeout,g=s.headers,y=s.onprogress,b=void 0===y?null:y,E=s.onerror,x=void 0===E?null:E,w=s.onabort,C=void 0===w?null:w;if(i="function"==typeof p?p()+m:p+m,v&&(o.timeout=v),o.upload.onprogress=b,o.upload.onerror=x,o.upload.onabort=C,e instanceof FormData)l=e;else if("object"==typeof e){var S=!1;for(var k in e)if(e[k]instanceof File||e[k]instanceof Blob){S=!0;break}if(S)for(var k in l=new FormData,e){var _=e[k];if(_ instanceof File||_ instanceof Blob){var T=_ instanceof File?_.name:void 0;l.append(k,_,T)}else l.append(k,JSON.stringify(_))}else f!=bu.POST||s.type||(n="application/json"),"application/json"==n?l=JSON.stringify(e):(l=function(e){var t=[];for(var n in e)if(e[n]){var i=e[n];"object"==typeof i&&(i=JSON.stringify(i)),t.push("".concat(n,"=").concat(encodeURIComponent(i)))}return t.join("&")}(e),f!=bu.GET||u||(u=l,l=""))}o.open(f,u?i+"?"+u:i);var I="Content-Type";if(n&&o.setRequestHeader(I,n),g)for(var k in g)o.setRequestHeader(k,g[k]);o.onerror=function(e){r.fail(e)},o.onloadend=function(){if(200==o.status){var e=o.getResponseHeader(I)||"";if(e.indexOf("json")>=0){var t=o.responseText;try{var n=JSON.parse(t);r.done(n)}catch(e){r.fail(e)}}else e.indexOf("octet")>0?(t=o.responseText,r.done(t)):r.fail("content-type is not json")}else r.fail("XMLHttpRequest status error: "+o.status)},o.send(l)},t.prototype.cancel=function(){this.xhr.abort(),this.fail("XMLHttpRequest canceled")},t}(Ks);function Vu(e){var t="string"==typeof e?{url:e}:e;return function(e,n){void 0===n&&(n={});var i=new Wu(t);return i.send(e,n),i}}!function(e){e[e.OK=0]="OK",e[e.SIGNATURE_ERROR=1]="SIGNATURE_ERROR",e[e.INTERNAL_ERROR=11]="INTERNAL_ERROR",e[e.MISSING_PARAMS=12]="MISSING_PARAMS",e[e.INVALID_PARAMS=13]="INVALID_PARAMS",e[e.NOT_FOUND=14]="NOT_FOUND",e[e.NO_PERMISSION=15]="NO_PERMISSION",e[e.OVER_LIMIT=100]="OVER_LIMIT"}(Uu||(Uu={}));var ju,Gu=Vu("/fs/svg2pdf"),qu=Vu("/fs/add"),Ku=Vu("/fs/parse_ppt"),Yu=Vu("/fs/transcode_video"),Xu=function(e){return function(t,n){var i=n.host,r=N(n,["host"]),o=Object.entries(r).map((function(e){var t=e[0],n=e[1];return"".concat(t,"=").concat(n)})).join("&");return e(t,{host:i,query:o})}},Qu=Xu(Vu("/his/info")),Zu=Xu(Vu("/his/delete")),Ju=Xu(Vu("/his/audio")),$u=Xu(Vu("/his/v2/videos")),ed=Xu(Vu("/his/audio_download")),td=Xu(Vu("/his/v2/video_download")),nd=Xu(Vu("/his/v2/conclusion")),id=Xu(Vu("/his/v2/gen_conclusion")),rd=Xu(Vu("/his/v2/gen_text")),od=Xu(Vu("/his/v2/text")),ad=Vu("/fs/getDownloadUrl"),sd=Vu("/fs/downloadZip"),ld=Vu("/fs/info"),cd=Vu("/fs/excel/import"),ud=Vu("/fs/excel/export"),dd=Vu("/fs/ppt/export"),pd=Vu("/fs/stickerInfo"),hd=Vu("/fs/stickerRecent"),fd=Vu("/fs/stickerOp");!function(e){e.RECT="sq",e.CIRCLE="circle",e.PARALLELOGRAM="parall",e.LADDER="ladder",e.TRIANGLE="tria",e.DIAMOND="diamond",e.ARROW="arrow",e.LINE="line"}(ju||(ju={}));var md,vd,gd=Vu("/fs/diagram/recognize"),yd=Vu("/fs/mind/generate"),bd=Vu("/fs/content/generate"),Ed=Vu("/fs/ppt/generate"),xd=Vu("/fs/document/generate"),wd=function(){function e(){this.params=[],this.requestBuffer=new Map,this.buffer=new Map,this.requestTimer=null}return e.prototype.request=function(e,t){var n=this.buffer,i=this.requestBuffer,r=new Ks,o=e.id,a=n.get(o);if(a)r.done(a);else{var s=i.get(o);s||(s=[],this._request(e,t)),s.push(r),i.set(o,s)}return r.result},e.prototype.requestFileUrl=function(e,t,n){void 0===n&&(n={});var i=new Ks;return ad(exports.E({files:[e]},n),t).result.then((function(e){e.code===Uu.OK&&e.obj.files.forEach((function(e){i.done(e)}))})),i.result},e.prototype._request=function(e,t){0==this.params.length&&this.dealRequest(t),this.params.push(e)},e.prototype.dealRequest=function(e){var t=this;this.requestTimer=window.setTimeout((function(){var n=t.params;t.params=[];var i=n.map((function(e){return e.id}));ld({ids:i},e).result.then((function(e){e.code===Uu.OK?e.obj.files.forEach((function(e){var n=e.id;t.buffer.set(n,e);var i=t.requestBuffer.get(n)||[];t.requestBuffer.delete(n),i.forEach((function(t){t.done(e)}))})):(t.requestBuffer.forEach((function(t,n){t.forEach((function(t){t.fail("get ".concat(n," file info failed, error code: ").concat(e.code))}))})),t.requestBuffer.clear())}))}),50)},e.prototype.destroy=function(){this.requestTimer&&window.clearTimeout(this.requestTimer)},e}(),Cd=Vu("/fs/graphicsLibrary/info"),Sd=Vu("/fs/graphicsLibrary/stencilSchema"),kd=function(t){var n=t.toRemove,i=e.useContext(xl).upime,r=W().getUpimeTrans,o=i.userManager.userAccessHint;return e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"20px"}},e.createElement("span",null,r("ai.center.count.remain"),e.createElement("span",{style:{color:"#FE5250",marginLeft:"4px"}},"0")),o.AiSessionPurchaseLabelButton&&e.createElement(o.AiSessionPurchaseLabelButton,{upimeOnClick:n}))},_d=function(){var t=(0,W().getUpimeTrans)("ai.center.noremain.phone");return e.createElement("div",{style:{fontSize:"13px",wordBreak:"keep-all"}},t)},Td=function(){function t(e,t){this.upime=e,this.getFileToken=t}return t.prototype.points2Shape=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return t=o.sent(),n=t.host,i=t.query,[4,gd({points:e},{host:n,query:i}).result];case 2:if((r=o.sent()).code===Uu.OK)return[2,r.obj];throw r.code}}))}))},t.prototype.generateMindmapNodeUsingAi=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return n=o.sent(),i=n.host,r=n.query,[2,yd(exports.E(exports.E({},e),t.extraInfo),{host:i,query:r})]}}))}))},t.prototype.generateCommonContentUsingAi=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return[4,this.getFileToken()];case 1:return n=a.sent(),i=n.host,r=n.query,[4,bd(exports.E(exports.E({},e),t.extraInfo),{host:i,query:r}).result];case 2:if((o=a.sent()).code===Uu.OK)return[2,o.obj];throw o.code}}))}))},t.prototype.generatePPT=function(e,t){return void 0===t&&(t="default"),A(this,void 0,void 0,(function(){var n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return[4,Promise.all([this.getFileToken(),this.getSign()])];case 1:return n=l.sent(),i=n[0],r=n[1],o=i.host,a=i.query,s=this.upime.localUserInfo.userName,[2,Ed(exports.E({keyword:e,style:t,userName:s},r.extraInfo),{host:o,query:a})]}}))}))},t.prototype.generateDocumentUsingAi=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return n=o.sent(),i=n.host,r=n.query,[2,xd(exports.E(exports.E({},e),t.extraInfo),{host:i,query:r})]}}))}))},t.prototype.getSign=function(){var e;return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return(null===(e=this.upime)||void 0===e?void 0:e.chatgptConfig)?[4,this.upime.chatgptConfig.preCheckCredits()]:[2,{inPackageRemain:0,outPackageRemain:0,extraInfo:{}}];case 1:return[2,t.sent()]}}))}))},t.prototype.showToBuyToast=function(){var t,n=this;if(this.upime.phoneMode)this.upime.addToast(e.createElement(_d,null),{autoHide:!1});else{var i=void 0;i=null===(t=this.upime)||void 0===t?void 0:t.addToast(e.createElement(kd,{toRemove:function(){var e;void 0!==i&&(null===(e=n.upime)||void 0===e||e.removeToast(i))}}),{autoHideTime:5e3})}},t}();function Id(e){var t="string"==typeof e?{url:e}:exports.E({},e);return t.host||(t.host=Se),Vu(t)}!function(e){e[e.OK=0]="OK"}(md||(md={})),function(e){e[e.OK=0]="OK",e[e.SIGNATURE_ERROR=1]="SIGNATURE_ERROR",e[e.NO_ORG=5]="NO_ORG",e[e.NO_SERVER=10]="NO_SERVER",e[e.PARAMS_ERROR=202]="PARAMS_ERROR",e[e.NOT_FOUND=404]="NOT_FOUND"}(vd||(vd={}));var Pd,Nd=Id({method:bu.GET,url:"/bbs/getBoardConfig"}),Md=Id({method:bu.GET,url:"/u3gps/webPage"}),Ad=!1,Dd=0,Rd=0;window._test_block_websocket=function(e){void 0===e&&(e=!0),Ad=e},window._test_bad_network=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),Dd=e,Rd=t},function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.RECONNECTING=3]="RECONNECTING",e[e.CLOSED=4]="CLOSED"}(Pd||(Pd={}));var Bd=function(){function e(e,t){var n=this;this.upime=e,this.config=t,this._autoReconnect=!0,this._online=!0,this.destroyed=!1,this.dealOnline=function(){n.online=!0},this.dealOffline=function(){n.online=!1,n.state===Pd.CONNECTED&&n.close()},this.state=Pd.CONNECTING,this.open(t.url),window.addEventListener("online",this.dealOnline),window.addEventListener("offline",this.dealOffline)}return Object.defineProperty(e.prototype,"autoReconnect",{get:function(){return this._autoReconnect},set:function(e){this._autoReconnect=e,this.adjustState(this._autoReconnect&&this._online)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"online",{get:function(){return this._online},set:function(e){this._online=e,this.adjustState(this._autoReconnect&&this._online)},enumerable:!1,configurable:!0}),e.prototype.adjustState=function(e){e&&!this.destroyed?this.state===Pd.DISCONNECTED&&this.reconnect():this.state===Pd.RECONNECTING&&(clearTimeout(this.retryTimer),this.state=Pd.DISCONNECTED)},e.prototype.forceReconnect=function(){this.close(),this.reconnect()},e.prototype.forceDisconnect=function(){this.close()},e.prototype.open=function(e){var t=this,n=this.config,i=this.ws=new WebSocket(e);i.onopen=function(){switch(Ad=!1,t.state){case Pd.CLOSED:return void t.close();case Pd.CONNECTING:n.onconnected&&n.onconnected();break;case Pd.RECONNECTING:n.onreconnected&&n.onreconnected()}t.resetRecvHBTimer(),i.onmessage=function(e){Rd?setTimeout((function(){return t.dealMessage(e)}),Rd):t.dealMessage(e)},t.state=Pd.CONNECTED},i.onclose=function(e){t.close(),t.autoReconnect&&t.reconnect()},i.onerror=function(){t.close(),t.autoReconnect&&t.reconnect()}},e.prototype.close=function(){clearTimeout(this.sendHBTimer),clearTimeout(this.recvHBTimer);var e=this.ws;e&&(e.onerror=e.onclose=e.onmessage=null,e.close(),this.ws=void 0),this.state=Pd.DISCONNECTED,this.config.onClosed&&this.config.onClosed()},e.prototype.reconnect=function(){var e=this,t=this.config;this.state=Pd.RECONNECTING,t.onstartreconnect&&t.onstartreconnect(),this.retryTimer=window.setTimeout((function(){e.retry()}),this.config.reConnectDelay||1e3)},e.prototype.retry=function(){return A(this,void 0,void 0,(function(){var e,t,n=this;return D(this,(function(i){switch(i.label){case 0:if(this.state!==Pd.RECONNECTING)return[2];e=this.config.refreshUrl||function(){return Promise.resolve(n.config.url)},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e()];case 2:return t=i.sent(),this.state!==Pd.RECONNECTING?[2]:(this.open(t),[3,4]);case 3:return i.sent(),this.state!==Pd.RECONNECTING?[2]:(this.retryTimer=window.setTimeout((function(){n.state===Pd.RECONNECTING&&n.retry()}),1e3),[3,4]);case 4:return[2]}}))}))},e.prototype.dealMessage=function(e){var t=e.data;if(!Ad){this.config.crypto&&(t=this.config.crypto.decrypt(t)),this.resetRecvHBTimer();var n=t.charAt(0);if("["===n)return this.upime.dealDataCmd(JSON.parse(t));t=t.substring(1);var i=JSON.parse(t);switch(n){case"c":12===i[0]?2===i[1]||this.sendHeartbeat(i):this.upime.dealControlCmd(i);break;case"s":this.upime.dealSubServiceCmd(i);break;case"r":this.upime.dealResponseCmd(i)}}},e.prototype.send=function(e){var t=this;if(this.ws)if(this.config.crypto&&(e=this.config.crypto.encrypt(e)),Dd)setTimeout((function(){var n;return null===(n=t.ws)||void 0===n?void 0:n.send(e)}),Dd);else try{this.ws.send(e)}catch(e){}},e.prototype.sendHeartbeat=function(e){var t=e||[12,2,Date.now()];this.send("c"+JSON.stringify(t))},e.prototype.sendCmd=function(e){this.resetSendHBTimer(),this.send(e)},e.prototype.sendDataCmd=function(e){this.sendCmd(JSON.stringify(e))},e.prototype.sendControlCmd=function(e){this.sendCmd("c"+JSON.stringify(e))},e.prototype.sendRequestCmd=function(e){this.sendCmd("r"+JSON.stringify(e))},e.prototype.sendServiceCmd=function(e){this.sendCmd("s"+JSON.stringify(e))},e.prototype.sendLogout=function(){this.sendControlCmd([2])},e.prototype.resetSendHBTimer=function(){var e=this;clearTimeout(this.sendHBTimer),this.sendHBTimer=window.setTimeout((function(){e.sendHeartbeat(),e.resetSendHBTimer()}),1e4)},e.prototype.resetRecvHBTimer=function(){var e=this;clearTimeout(this.recvHBTimer),this.recvHBTimer=window.setTimeout((function(){e.sendLogout(),e.close(),e.autoReconnect&&e.reconnect()}),5e4)},e.prototype.destroy=function(){this.destroyed=!0,this.state==Pd.CONNECTED&&this.sendLogout(),this.close(),clearTimeout(this.retryTimer),this.state=Pd.CLOSED,window.removeEventListener("online",this.dealOnline),window.removeEventListener("offline",this.dealOffline)},e}(),Ld=[];try{window.addEventListener("resize",te((function(){return Ld.forEach((function(e){return e.caller.autoResize&&e.cb()}))}),200))}catch(VS){}function Od(e,t){var n=Ld.findIndex((function(t){return t.cb===e}));return n<0&&Ld.push({caller:t,cb:e}),function(){var t=Ld.findIndex((function(t){return t.cb===e}));t>=0&&Ld.splice(t,1)}}var Fd=function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this)||this;return i.view=t,i.connected=!1,i.moved=!1,i.currentPoint={x:0,y:0},i.startTouchesPoint=[],i.preTouchesPoint=[],i.touchesPoint=[],i.validFingerCount=0,i.singleFinger=!1,i.singleFingerTime=500,i.firstFingerIndex=0,i.connectType=null,i.longPress=!1,i.doubleClickTime=400,i.maxHitCount=3,i.hotKeyListeners=[],i.handleKeyDown=function(e){if(i.view.upime.useKeyboard&&!i.view.upime.isDesktopModal){var t=e.key,n=e.shiftKey,r=void 0!==n&&n,o=e.altKey,a=void 0!==o&&o,s=e.ctrlKey||e.metaKey||!1;i.currentHotKey={key:t,ctrlKey:s,shiftKey:r};var l=i.hotKeyListeners.filter((function(n){return(n.i?n.key.toLowerCase()===t.toLowerCase():n.key===t)&&(void 0===n.connected||n.connected===i.connected)&&(void 0===n.connectType||n.connectType===i.connectType)&&(void 0===n.ctrlKey||!!n.ctrlKey===s)&&(void 0===n.shiftKey||!!n.shiftKey==r)&&(void 0===n.altKey||!!n.altKey==a)&&(void 0===n.filter||n.filter(e))}));if(e.target){var c=e.target;if("INPUT"===c.tagName&&"false"!==c.dataset.nativeEvtHandle||"TEXTAREA"===c.tagName&&"false"!==c.dataset.nativeEvtHandle||"true"===c.contentEditable)return}if(l.length){var u=exports.E({},i.currentPoint),d={position:i.view.getAbsolutePosition(i.currentPoint),globalPosition:u,key:t,originEvent:e,connected:!!i.connected,connectType:i.connectType};return e.preventDefault(),i.hotKeyListeners=i.hotKeyListeners.filter((function(e){return!e.once||l.indexOf(e)<0})),l.forEach((function(e){return e.cb(d)})),!1}}},i.forceTriggerPressEvt=function(e,t){var n,r;return!(!i.targetDom||i.currentMoveEvt||i.connected||("mouse"===e&&(null===(n=i.mockMouseDown)||void 0===n||n.call(i,t)),"touch"===e&&(null===(r=i.mockTouchStart)||void 0===r||r.call(i,t)),0))},i.moveThreshold=n.moveThreshold||8,i.clickThreshold=n.clickThreshold||(_e.desktop?4:32),i}return P(t,e),Object.defineProperty(t.prototype,"mousePosition",{get:function(){return exports.E({},this.currentPoint)},enumerable:!1,configurable:!0}),t.prototype.stopCurrentEvt=function(){var e,t;if(this.currentMoveEvt)if("mousemove"===this.currentMoveEvt.type){var n=new MouseEvent("mouseup",this.currentMoveEvt);null===(e=this.triggerMouseUp)||void 0===e||e.call(this,n)}else"touchmove"===this.currentMoveEvt.type&&(n=new TouchEvent("touchend"),null===(t=this.triggerTouchEnd)||void 0===t||t.call(this,n))},t.prototype.bindDom=function(e){var t,n,i,r,o,a,s=this,l=this.view;this.targetDom=e;var c=function(e){s.publish("originEvent",{originEvent:e})},u=function(){var t=q(e);return{x:t.left,y:t.top}},d=function(){s.longPressTimer&&(clearTimeout(s.longPressTimer),s.longPressTimer=void 0)},p=function(e){s.longPressTimer=window.setTimeout((function(){s.longPressTimer=void 0,s.connected&&(s.longPress=!0,s.publish("longpress",{originEvent:e,connectType:s.connectType,connected:!0,longPress:!0,position:l.getAbsolutePosition(s.currentPoint),globalPosition:exports.E({},s.currentPoint)}))}),500)},h=function(){s.singleFingerTimer&&(window.clearTimeout(s.singleFingerTimer),s.singleFingerTimer=void 0,s.singleFinger=!1)},f=function(e){var t=s.view.upime;if("sticker"!==t.xmode&&"shape"!==t.xmode&&"text"!==t.xmode||0!==t.elementManager.getAllElements().length||t.resetZoom(),c(e),e.preventDefault(),!s.connected){var n=0===e.button?"left":1===e.button?"middle":"right";m(e,n)}},m=function(e,i){s.connected=!0,s.publish("connected",!0),s.connectType=i,s.moved=!1,t=u(),s.startPoint=s.currentPoint={x:e.pageX-t.x,y:s.getEventY(e)-t.y},n=l.getAbsolutePosition(s.startPoint),s.longPress=!1,p(e)};this.mockMouseDown=function(e,t){void 0===t&&(t=0),m(e,0===t?"left":1===t?"middle":"right")};var v=function(e){c(e),s.connected||(t=u());var r=s.currentPoint={x:e.pageX-t.x,y:s.getEventY(e)-t.y},o=l.getAbsolutePosition(r);if(s.publish("mousemove",{originEvent:e,outTarget:e.target!==s.targetDom,position:exports.E({},o),globalPosition:exports.E({},r),connectType:s.connectType,connected:s.connected}),s.connected){var a=s.startPoint,p=!1;if(!s.moved){if(r.x==a.x&&r.y==a.y)return;if(fn(r,a)<s.moveThreshold)return;s.moved=!0,p=!0,d(),s.prePoint=a,i=l.getAbsolutePosition(a)}var h=s.prePoint;s.currentMoveEvt=e,s.publish("moveto",{connected:s.connected,originEvent:e,connectType:s.connectType,isStart:p,isEnd:!1,position:o,startPosition:n,prePosition:i,longPress:s.longPress,globalPosition:exports.E({},r),startGlobalPosition:exports.E({},a),preGlobalPosition:exports.E({},h)}),i=o,s.prePoint=exports.E({},s.currentPoint)}},g=function(e){c(e),d();var r=s,o=r.connectType,a=r.connected,u=r.longPress,p=0===e.button?"left":1===e.button?"middle":"right";if(s.connected&&o===p){var h=s.startPoint,f=s.prePoint,m=s.currentPoint={x:e.pageX-t.x,y:s.getEventY(e)-t.y},v={originEvent:e,connectType:o,connected:a,longPress:u,position:l.getAbsolutePosition(m),globalPosition:exports.E({},m)};if(s.startPoint=void 0,s.prePoint=void 0,s.connected=!1,s.publish("connected",!1),s.longPress=!1,s.connectType=null,s.currentMoveEvt=void 0,s.clearRangeSelection(),!s.moved){var g=exports.E(exports.E({},v),{Hits:1}),y=Date.now(),b=s.lastClick;return b&&y-b.time<s.doubleClickTime&&b.evt.Hits<s.maxHitCount&&fn(g.globalPosition,b.evt.globalPosition)<=s.clickThreshold&&(g.Hits=b.evt.Hits+1),s.lastClick={time:y,evt:g},void s.publish("click",g)}s.publish("moveto",exports.E(exports.E({},v),{isStart:!1,isEnd:!0,longPress:u,startPosition:n,prePosition:i,startGlobalPosition:exports.E({},h),preGlobalPosition:exports.E({},f)}))}},y=function(e){0===s.validFingerCount?(s.connected=!0,s.connectType="touch",s.publish("connected",!0),s.moved=!1,s.longPress=!1,s.validFingerCount=Math.min(e.touches.length,2),s.firstFingerIndex=0,1===e.touches.length&&(p(e),s.singleFingerTimer=window.setTimeout((function(){s.singleFinger=!0,s.validFingerCount=1}),s.singleFingerTime))):(s.validFingerCount+=1,s.singleFinger=!1,h(),d()),t=u(),s.startTouchesPoint=[],r=[];for(var n=e.touches,i=s.firstFingerIndex,o=i+s.validFingerCount,a=i;a<o;a++){var c={x:n[a].pageX-t.x,y:s.getEventY(n[a])-t.y};r.push(l.getAbsolutePosition(c)),s.startTouchesPoint.push(c)}s.currentPoint=s.startTouchesPoint[0]},b=function(e){var t=s.view.upime;"sticker"!==t.xmode&&"shape"!==t.xmode&&"text"!==t.xmode||0!==t.elementManager.getAllElements().length||t.resetZoom(),c(e),e.preventDefault(),s.longPress||s.singleFinger||s.validFingerCount>=2||y(e)};this.mockTouchStart=function(e){y(e)};var E=function(e){if(c(e),s.connected){var n=[];a=[];for(var i=e.touches,u=s.firstFingerIndex,p=u+s.validFingerCount,h=u;h<p;h++){var f=i[h],m={x:f.pageX-t.x,y:s.getEventY(f)-t.y};n.push(m),a.push(l.getAbsolutePosition(m))}s.touchesPoint=n,s.currentPoint=s.touchesPoint[0];var v=R([],s.startTouchesPoint,!0),g=!1;if(!s.moved){var y=s.touchesPoint.some((function(e,t){return fn(e,s.startTouchesPoint[t])>=s.moveThreshold}));if(!y)return;s.moved=!0,g=!0,d(),s.preTouchesPoint=R([],v,!0),o=R([],r,!0)}var b=R([],s.preTouchesPoint,!0),E="moveto";if(s.validFingerCount>1&&b.length>1){var x=b[0],w=b[1],C=n[0],S=n[1];Math.abs(fn(x,w)-fn(C,S))>3&&(E="touchscale")}"moveto"===E?("touchscale"===s.latestTouchEffect&&s.publish("touchscale",{connected:s.connected,originEvent:e,connectType:s.connectType,isStart:!1,isEnd:!0,touchesPosition:a,startTouchesPosition:r,preTouchesPosition:o,longPress:s.longPress,globalTouchesPosition:R([],n,!0),startGlobalTouchesPosition:R([],v,!0),preGlobalTouchesPosition:R([],b,!0)}),s.currentMoveEvt=e,s.publish("moveto",{connected:s.connected,originEvent:e,connectType:s.connectType,isStart:"moveto"!==s.latestTouchEffect&&g,isEnd:!1,position:a[0],startPosition:r[0],prePosition:o[0],longPress:s.longPress,globalPosition:exports.E({},n[0]),startGlobalPosition:exports.E({},v[0]),preGlobalPosition:exports.E({},b[0])})):("moveto"===s.latestTouchEffect&&s.publish("moveto",{connected:s.connected,originEvent:e,connectType:s.connectType,isStart:!1,isEnd:!0,position:a[0],startPosition:r[0],prePosition:o[0],longPress:s.longPress,globalPosition:exports.E({},n[0]),startGlobalPosition:exports.E({},v[0]),preGlobalPosition:exports.E({},b[0])}),s.publish("touchscale",{connected:s.connected,originEvent:e,connectType:s.connectType,isStart:"touchscale"!==s.latestTouchEffect&&g,isEnd:!1,touchesPosition:a,startTouchesPosition:r,preTouchesPosition:o,longPress:s.longPress,globalTouchesPosition:R([],n,!0),startGlobalTouchesPosition:R([],v,!0),preGlobalTouchesPosition:R([],b,!0)})),s.latestTouchEffect=E,o=a,s.preTouchesPoint=R([],s.touchesPoint,!0)}},x=function(e){c(e),d(),h();var t=s,n=t.connectType,i=t.connected,u=t.longPress,p=t.moved;if(t.validFingerCount,i){var f=R([],s.touchesPoint,!0);p||(f=R([],s.startTouchesPoint,!0),a=f.map((function(e){return l.getAbsolutePosition(e)}))),s.currentPoint=f[0];var m=R([],s.startTouchesPoint,!0),v=R([],s.preTouchesPoint,!0);s.startTouchesPoint=[],s.preTouchesPoint=[],s.connected=!1,s.publish("connected",!1),s.longPress=!1,s.moved=!1,s.connectType=null,s.validFingerCount=0,s.singleFinger=!1,s.currentMoveEvt=void 0;var g={originEvent:e,connectType:n,connected:i,longPress:u,position:a[0],globalPosition:exports.E({},f[0])};if(s.clearRangeSelection(),!p){var y=exports.E(exports.E({},g),{Hits:1}),b=Date.now(),E=s.lastClick;return E&&b-E.time<s.doubleClickTime&&E.evt.Hits<s.maxHitCount&&fn(y.globalPosition,E.evt.globalPosition)<=s.clickThreshold&&y.Hits++,s.lastClick={time:b,evt:y},void s.publish("click",y)}"moveto"===s.latestTouchEffect?s.publish("moveto",exports.E(exports.E({},g),{isStart:!1,isEnd:!0,longPress:u,startPosition:r[0],prePosition:o[0],startGlobalPosition:exports.E({},m[0]),preGlobalPosition:exports.E({},v[0])})):s.publish("touchscale",{connected:i,originEvent:e,connectType:n,isStart:!1,isEnd:!0,touchesPosition:a,startTouchesPosition:r,preTouchesPosition:o,longPress:u,globalTouchesPosition:R([],f,!0),startGlobalTouchesPosition:R([],m,!0),preGlobalTouchesPosition:R([],v,!0)}),s.latestTouchEffect=void 0}},w=function(e){e.preventDefault(),e.stopPropagation(),c(e);var n=e.ctrlKey||e.metaKey,i=_e.safari&&_e.desktop&&e.deltaX;(n||i)&&e.preventDefault(),t=u();var r={x:e.pageX-t.x,y:s.getEventY(e)-t.y};s.publish("mousewheel",{connectType:s.connectType,connected:s.connected,ctrlkey:n,shiftkey:e.shiftKey,originEvent:e,wheelDelta:e.wheelDelta||-e.deltaY,deltaY:e.deltaY,deltaX:e.deltaX,position:l.getAbsolutePosition(r),globalPosition:r})},C=function(t){t.preventDefault(),t.stopPropagation(),e.addEventListener("dragover",S,!0),e.addEventListener("dragleave",k,!0),e.addEventListener("drop",_,!0),s.publish("dragenter",t)},S=function(e){e.preventDefault(),e.stopPropagation(),s.publish("dragover",e)},k=function(e){e.preventDefault(),e.stopPropagation(),T(),s.publish("dragleave",e)},_=function(e){e.preventDefault(),e.stopPropagation(),T(),s.publish("drop",e)},T=function(){e.removeEventListener("dragover",S),e.removeEventListener("dragleave",k),e.removeEventListener("drop",_)};e.addEventListener("mousedown",f),document.addEventListener("mousemove",v),document.addEventListener("mouseup",g),this.triggerMouseUp=g,e.addEventListener("touchstart",b),document.addEventListener("touchmove",E),document.addEventListener("touchend",x),this.triggerTouchEnd=x,document.oncontextmenu=function(e){var t=e.target;return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||!!((null==t?void 0:t.dataset.slateString)||(null==t?void 0:t.isContentEditable)||(null==t?void 0:t.dataset.nativeEvtHandle))},e.addEventListener("wheel",w),document.addEventListener("keydown",this.handleKeyDown,!0),e.addEventListener("dragenter",C,!0);var I=function(e){var t=e.target;if("INPUT"!==t.tagName&&("TEXTAREA"!==t.tagName||"false"===t.dataset.nativeEvtHandle)&&"true"!==t.contentEditable){var n=exports.E({},s.currentPoint),i=l.getAbsolutePosition(s.currentPoint),r=e.clipboardData||window.clipboardData;s.publish("paste",{globalPosition:n,position:i,clipData:r,originEvent:e})}};return document.addEventListener("paste",I),document.addEventListener("copy",(function(e){var t=e.target;t.dataset.slateString||"true"===t.dataset.nativeEvtHandle||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"true"===t.contentEditable||(e.preventDefault(),s.publish("copy",void 0))})),function(){s.targetDom=void 0,e.removeEventListener("mousedown",f),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g),e.removeEventListener("touchstart",b),document.removeEventListener("touchmove",E),document.removeEventListener("touchend",x),document.oncontextmenu=null,e.addEventListener("wheel",w),document.removeEventListener("keydown",s.handleKeyDown,!0),e.removeEventListener("dragenter",C),T(),document.removeEventListener("paste",I),s.mockMouseDown=void 0,s.mockTouchStart=void 0}},t.prototype.registerHotKey=function(e,t,n){var i=this;void 0===n&&(n=!1);var r=exports.E(exports.E({},e),{cb:t});return n&&(r.once=!0),this.hotKeyListeners.push(r),function(){i.hotKeyListeners=i.hotKeyListeners.filter((function(e){return e!==r}))}},t.prototype.clearRangeSelection=function(){var e,t=getSelection();3===(null===(e=null==t?void 0:t.anchorNode)||void 0===e?void 0:e.nodeType)&&(null==t||t.empty())},t.prototype.registerKeyup=function(e,t){var n=this,i=function(i){if(n.view.upime.useKeyboard&&!n.view.upime.isDesktopModal){if(i.target){var r=i.target;if("INPUT"===r.tagName&&"false"!==r.dataset.nativeEvtHandle||"TEXTAREA"===r.tagName&&"false"!==r.dataset.nativeEvtHandle||"true"===r.contentEditable)return}e.includes(i.key)&&t(i)}};return document.addEventListener("keyup",i),function(){document.removeEventListener("keyup",i)}},t.prototype.getEventY=function(e){return this.view.upime.phoneMode&&_e.isIphoneLike,e.pageY},t}(ro),zd=function(){function e(e){this.upime=e}return e.prototype.findAndSetParent=function(e,t){var n=this.findRefSystem(t);if(n){var i=t.calcTransformedUpdate(n);e.update(t,i)}else{var r=this.findFrame(t);r&&e.update(t,{frameId:r.id})}},e.prototype.findRefSystemByPoint=function(e,t){void 0===t&&(t=0);var n=this.upime.view.elementsRoot.getRefSystemIfPointIn(e,(function(e){return e.level>t}));return n==this.upime.view.elementsRoot?void 0:n},e.prototype.findRefSystem=function(e,t){if(e.supportChangeRS){var n=e.getGlobalBox(),i=this.upime.view.elementsRoot.getRefSystemIfBorderIn(n,(function(n){return!n.unavailable&&n.level>e.refSystemLevel&&(!t||t(n))}));return i==this.upime.view.elementsRoot?void 0:i}},e.prototype.findFrame=function(e,t){if(e.isSupportFrame)for(var n=e.getGlobalBox(),i=this.upime.elementManager.getAvailableFrames((function(e){return!e.hide&&(!t||t(e))})),r=i.length-1;r>=0;r--)if(i[r].checkBorderInFrame(n))return i[r]},e}(),Hd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.destroy=function(){},t}(zd);function Ud(){return"url(".concat($o("cross_cursor.png"),") 7 7, crosshair")}function Wd(){return"url(".concat($o("hand_cursor.png"),") 12 12, default")}function Vd(){return"url(".concat($o("hand_grab_cursor.png"),") 12 12, default")}function jd(){return"url(".concat($o("laser_pen.png"),") 16 16, default")}var Gd=function(e){function t(t){var n=e.call(this,t)||this;return n.handMode="hand"===n.upime.xmode||"pick-single-element"===n.upime.xmode,n.wheelMode="mouse",n.lastWheelTime=0,n.focusingBorder=null,n.movingView=!1,n.focusedBorderBox=null,n.focusedMinScale=.01,n.focusedPos=null,n.unsubs=[n.upime.subscribe("xmodechange",(function(e){"picking-view"!==e&&n.upime.disableViewPicker(),"hand"===e||"pick-single-element"===e?n.handMode=!0:(n.handMode&&!n.upime.userManager.commentOnlyMode&&n.upime.view.setCursor("",n),n.handMode=!1)})),n.upime.userEventManager.subscribe("moveto",(function(e){n.upime.userManager.commentOnlyMode&&"hand"===n.upime.xmode||"picking-view"!==n.upime.xmode&&"none"!==n.upime.xmode&&("laser"!==n.upime.xmode||_e.desktop)&&("hand"!==n.upime.xmode&&"view"!==n.upime.xmode&&"laser"!==n.upime.xmode&&"right"!==e.connectType&&"middle"!==e.connectType&&"pick-single-element"!==n.upime.xmode||(n.wheelMode="mouse",n.clearAnimation(),n.dealMove(e),n.upime.publish("moveBoard",{type:"mouse",connectType:e.connectType})))})),n.upime.userEventManager.subscribe("touchscale",(function(e){var t=n.upime.view;e.isStart&&(n.viewScaleStart=t.scale);var i=e.startTouchesPosition,r=e.globalTouchesPosition,o=e.preGlobalTouchesPosition,a=e.startGlobalTouchesPosition,s=o[0],l=o[1],c=a[0],u=a[1],d=r[0],p=r[1],h=vn(c,u),f=vn(i[0],i[1]),m=vn(d,p),v=fn(c,u),g=fn(d,p),y=fn(s,l),b=t.scale,E=t.scale;Math.abs(g-y)>4&&(b=n.viewScaleStart*(g/v));var x=n,w=x.maxScale,C=x.minScale;b=Math.min(w,Math.max(C,b));var S=f.x-h.x/b-(m.x-h.x)/b,k=f.y-h.y/b-(m.y-h.y)/b;n.clearAnimation(),n.setViewPosScale(S,k,b),yn(b,E)?n.upime.publish("moveBoard",{type:"touchpad",connectType:e.connectType}):n.upime.publish("scaleBoard",{type:"touchpad"})})),n.upime.userEventManager.subscribe("mousewheel",(function(e){n.clearAnimation(),n.checkMode(e.originEvent);var t=e.connectType,i=e.position,r=e.globalPosition,o=e.wheelDelta;if(null===t){var a,s=e.originEvent,l=n.upime,c=l.view,u=l.view,d=u.scale,p=u.scrollTarget,h=function(e){var t=i.x-r.x/e,o=i.y-r.y/e;n.setViewPosScale(t,o,e)};switch(n.wheelMode){case"mouse":!function(){if(0!=o){var t=-s.deltaY;e.ctrlkey||!(null==p?void 0:p.checkDealScroll(i))?(a=Math.abs(t)>=90?n.restrictScale(o>0?1.15*d:d/1.15,o>0):n.restrictScale(d*Math.exp(t/100),t>0),h(a),n.upime.publish("scaleBoard",{type:"mouse"})):p.dealScroll(e)}}();break;case"touchpad":e.ctrlkey?function(){var e=-s.deltaY;a=n.restrictScale(d*Math.exp(e/100),e>0),h(a),n.upime.publish("scaleBoard",{type:"touchpad"})}():function(){var t;if(null==p?void 0:p.checkDealScroll(i))p.dealScroll(e);else{var r=e.deltaX,o=e.deltaY;e.shiftkey&&0==r&&0!==o&&(r=(t=[o,r])[0],o=t[1]);var a=c.x+r/d,s=c.y+o/d;n.setViewPosScale(a,s),n.upime.publish("moveBoard",{type:"touchpad",connectType:e.connectType})}}()}}})),n.upime.subscribe("boardResized",(function(){n.focusedBorderBox&&n.adaptFocusBorderBox(n.focusedBorderBox)}))],n.currentSlideViewAnimationId=0,n._pressedMapData={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1},n._viewMoveSpeedFactor=0,n._pressedMapProxy=new Proxy(n._pressedMapData,{set:function(e,t,i){e[t]=i;var r=0,o=0,a=n.upime.view.scale;n._pressedMapData.ArrowUp&&!n._pressedMapData.ArrowDown?o=-15/a:!n._pressedMapData.ArrowUp&&n._pressedMapData.ArrowDown&&(o=15/a),n._pressedMapData.ArrowLeft&&!n._pressedMapData.ArrowRight?r=-15/a:!n._pressedMapData.ArrowLeft&&n._pressedMapData.ArrowRight&&(r=15/a),(n._pressedMapData.ArrowLeft&&n._pressedMapData.ArrowRight||n._pressedMapData.ArrowUp&&n._pressedMapData.ArrowDown)&&(n._viewMoveSpeedFactor=0,o=0,r=0);var s=n.upime.view;n._moveViewAnime&&mr(n._moveViewAnime);var l=function(e,t){!n.movingView&&(n.movingView=!0),n._viewMoveSpeedFactor<1&&(n._viewMoveSpeedFactor+=.02),n.setViewPosScale(s.x+e*n._viewMoveSpeedFactor,s.y+t*n._viewMoveSpeedFactor,s.scale),n._moveViewAnime=fr((function(){return l(e,t)}))};return(r||o)&&l(r,o),Object.values(n._pressedMapData).every((function(e){return!e}))&&(n.movingView=!1,n._viewMoveSpeedFactor=0,setTimeout((function(){n._moveViewAnime&&mr(n._moveViewAnime),n._moveViewAnime=null}))),!0}}),n._moveViewAnime=null,n.onGestureStart=function(e){e.preventDefault(),e.stopImmediatePropagation(),n.clearAnimation(),n.viewScaleStart=n.upime.view.scale,_e.safari&&e.scale&&isFinite(e.scale)&&(n.wheelMode="touchpad")},n.onGestureChange=function(e){e.preventDefault(),e.stopImmediatePropagation();var t=n.viewScaleStart*e.scale;t=n.restrictScale(t,e.scale>1);var i=n.upime,r=i.view,o=r.scale,a=i.userEventManager.mousePosition,s=r.getAbsolutePosition(a);n.setViewPosScale(s.x-a.x/t,s.y-a.y/t,t),_e.safari&&e.scale&&isFinite(e.scale)&&(n.wheelMode="touchpad"),yn(t,o)?n.upime.publish("moveBoard",{type:n.wheelMode,connectType:e.connectType}):n.upime.publish("scaleBoard",{type:n.wheelMode})},n.onDragStart=function(e){e.preventDefault()},n.viewScaleStart=t.view.scale,_e.desktop&&(document.body.addEventListener("gesturestart",n.onGestureStart),document.body.addEventListener("gestureend",n.onGestureChange),document.body.addEventListener("gesturechange",n.onGestureChange),document.body.addEventListener("dragstart",n.onDragStart)),n}return P(t,e),Object.defineProperty(t.prototype,"view",{get:function(){return this.upime.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){return 4},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minScale",{get:function(){if(this.focusingBorder){var e=this.focusingBorder,t=e.left,n=e.top,i=e.right,r=e.bottom,o=this.view.viewWidth/4/(i-t),a=this.view.viewHeight/4/(r-n);return Math.min(4,Math.max(o,a))}return.01},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayedViewScale",{get:function(){return this.focusedBorderBox?this.view.scale/this.focusedMinScale:this.view.scale},enumerable:!1,configurable:!0}),t.prototype.arrowKeyDownHandler=function(e){!this._pressedMapProxy[e]&&(this._pressedMapProxy[e]=!0)},t.prototype.arrowKeyUpHandler=function(e){this._pressedMapProxy[e]=!1},t.prototype.checkTouchpad=function(e){if(e.deltaX)return!0;if(e.ctrlKey||e.metaKey){if(_e.isWindows&&(0===e.wheelDelta||0!==e.deltaY&&Math.abs(e.deltaY)<100))return!0;if(_e.isMac)return!0}if(Date.now()-this.lastWheelTime>200){var t=Math.abs(e.wheelDeltaY||0);if(_e.isWindows&&t<90)return!0}return!1},t.prototype.checkMouse=function(e){if(e.ctrlKey||e.metaKey){if(_e.isWindows&&(0===e.wheelDelta||0!==e.deltaY&&Math.abs(e.deltaY)<100))return!1;if(_e.isMac)return!1}if(Date.now()-this.lastWheelTime>200){var t=Math.abs(e.wheelDeltaY||0);if(_e.isWindows&&t>=90)return!0;if(_e.isMac&&t===(_e.safari?12:120*window.devicePixelRatio))return!0}return!!e.shiftKey},t.prototype.checkMode=function(e){switch(this.wheelMode){case"mouse":this.checkTouchpad(e)&&(this.wheelMode="touchpad");break;case"touchpad":this.checkMouse(e)&&(this.wheelMode="mouse")}this.lastWheelTime=Date.now()},t.prototype.dealMove=function(e){var t=e.globalPosition,n=e.preGlobalPosition,i=this.upime.view,r=i.x-(t.x-n.x)/i.scale,o=i.y-(t.y-n.y)/i.scale;this.setViewPosScale(r,o),e.isStart?i.setCursor(Vd(),this):e.isEnd&&i.setCursor("",this)},t.prototype.changeScale=function(e){var t=this.upime.view,n=t.x+t.width/2,i=t.y+t.height/2,r=n-t.viewWidth/2/e,o=i-t.viewHeight/2/e;this.setViewPosScale(r,o,e)},t.prototype.restoreView=function(){this.clearAnimation(),this.focusedPos&&this.focusedMinScale?this.view.setView(this.focusedPos.x,this.focusedPos.y,this.focusedMinScale):this.changeScale(1)},t.prototype.zoomViewBy=function(e){var t=this.upime.view,n=this.restrictScale(t.scale+e,e>0);n!==t.scale&&(this.clearAnimation(),this.changeScale(n))},t.prototype.makeBorderInSight=function(e,t){void 0===t&&(t={});var n=this.upime.view,i=n.scale,r=e.left,o=e.top,a=e.right,s=e.bottom,l=a-r,c=s-o,u=t.left||0,d=t.top||0,p=t.right||0,h=t.bottom||0,f=void 0!==t.duration?t.duration:200,m=n.x,v=n.y;if(l<n.width-u/i-p/i&&c<n.height-d/i-h/i)return r<n.x+u/i?m=r-u/i:a>n.x+n.width-p/i&&(m=a-n.width+p/i),o<n.y+d/i?v=o-d/i:s>n.y+n.height-h/i&&(v=s-n.height+h/i),void(m===n.x&&v===n.y||this.slideViewTo(m,v,i,{duration:f,target:e}));this.makeBorderCenter(e,t)},t.prototype.makeBorderCenter=function(e,t){void 0===t&&(t={});var n=this.view,i=e.right-e.left,r=e.bottom-e.top,o=e.left+i/2,a=e.top+r/2,s=t.left||0,l=t.top||0,c=t.right||0,u=t.bottom||0,d=void 0!==t.duration?t.duration:200,p=n.viewWidth-s-c,h=n.viewHeight-l-u,f=p/i,m=h/r,v=Math.min(f,m,this.maxScale),g=o-(p/2+s)/v,y=a-(h/2+l)/v;return this.slideViewTo(g,y,v,{duration:d,target:e})},t.prototype.makeBorderXInSight=function(e,t){var n=e.left,i=e.right,r=e.top,o=e.bottom,a=this.view,s=a.scale,l=a.viewWidth,c=a.viewHeight,u=(i-n)*s,d=(o-r)*s,p=l*t,h=c*t;if(u/l<t||d/c<t){var f=Math.max(p/u,h/d)*s,m=n+(i-n)/2,v=r+(o-r)/2,g=this.view.getScreenPosition({x:m,y:v}),y=m-g.x/f,b=v-g.y/f;this.setViewPosScale(y,b,Math.min(this.maxScale,f))}},t.prototype.makeBorderFixedSizeInSight=function(e,t){var n=e.left,i=e.right,r=e.top,o=e.bottom,a=this.view.scale,s=(i-n)*a,l=(o-r)*a;if(s<t||l<t){var c=Math.max(t/s,t/l)*a,u=n+(i-n)/2,d=r+(o-r)/2,p=this.view.getScreenPosition({x:u,y:d}),h=u-p.x/c,f=d-p.y/c;this.setViewPosScale(h,f,Math.min(this.maxScale,c))}},t.prototype.keepBorderInSight=function(e){this.focusingBorder=e},t.prototype.clearAnimation=function(){this.cancelAnimation&&(this.cancelAnimation(),this.cancelAnimation=void 0)},t.prototype.slideViewTo=function(e,t,n,i){var r,o,a=this;void 0===i&&(i={});var s=new Promise((function(e,t){r=e,o=t})),l=this.view,c=l.scale,u=l.viewWidth,d=l.viewHeight;this.currentSlideViewAnimationId+=1;var p,h=this.currentSlideViewAnimationId,f=void 0!==i.duration?i.duration:200;if(0===f)return this.view.publish("viewboxChangeAnimationStart",h),l.setView(e,t,n),this.view.publish("viewboxChangeAnimationEnd",h),Promise.resolve();var m=i.target;p=m?{x:(m.left+m.right)/2,y:(m.top+m.bottom)/2}:{x:e+u/2/n,y:t+d/2/n};var v=l.getScreenPosition(p),g={x:(p.x-e)*n,y:(p.y-t)*n};this.clearAnimation(),this.view.publish("viewboxChangeAnimationStart",h);var y=Ll([v.x,v.y,c],[g.x,g.y,n],(function(e,t){var n=e[0],i=e[1],o=e[2],s=p.x-n/o,l=p.y-i/o;a.setViewPosScale(s,l,o),t&&(a.view.publish("viewboxChangeAnimationEnd",h),a.cancelAnimation=void 0,r())}),f);return this.cancelAnimation=function(){a.view.publish("viewboxChangeAnimationEnd",h),y(),o()},s},t.prototype.restrictScale=function(e,t){var n=this.maxScale,i=this.minScale;return e>n&&t&&(e=n),e<i&&!t&&(e=i),e},t.prototype.setViewPosScale=function(e,t,n,i){var r=this.view;if(this.focusingBorder){var o=this.focusingBorder,a=o.left,s=o.top,l=o.right,c=o.bottom,u=void 0!==n?n:r.scale,d=r.viewWidth/u,p=r.viewHeight/u,h=10/u;return e>l-h?e=l-h:e+d<a+h&&(e=a+h-d),t>c-h?t=c-h:t+p<s+h&&(t=s+h-p),void r.setView(e,t,n,i)}if(this.focusedBorderBox){if(!n&&yn(r.scale,this.focusedMinScale))return;var f=null!=n?n:r.scale,m=r.viewWidth/f,v=r.viewHeight/f,g={left:e,top:t,right:e+m,bottom:t+v};if(qt(g,this.focusedBorderBox))return void r.setView(e,t,f,i);if(!Kt(g,this.focusedBorderBox))return;var y=this.focusedBorderBox,b=y.left,E=y.right,x=y.top,w=y.bottom,C=E-b,S=w-x;if(f<=this.focusedMinScale)return void(this.focusedPos&&r.setView(this.focusedPos.x,this.focusedPos.y,this.focusedMinScale,i));var k=e,_=t;m>=C?k=(E+b)/2-m/2:e<b?k=b:e+m>E&&(k=E-m),v>=S?_=(w+x)/2-v/2:t<x?_=x:t+v>w&&(_=w-v),r.setView(k,_,f,i)}else r.setView(e,t,n,i)},t.prototype.clearFocusedBorderBox=function(){this.focusedMinScale=.01,this.focusedBorderBox=null,this.focusedPos=null,this.view.publish("borderBoxFocused",!1)},t.prototype.adaptFocusBorderBox=function(e){var t,n,i,r=this.view,o=r.viewHeight,a=r.viewWidth,s=o/.01,l=o/4,c=a/.01,u=a/4,d=e.right-e.left,p=e.bottom-e.top;if(p/o>d/a){if(p>s||p<l)return this.clearFocusedBorderBox(),1;t=o/p,i=e.top,n=(e.right+e.left)/2-a/2/t}else{if(d>c||d<u)return this.clearFocusedBorderBox(),1;t=a/d,n=e.left,i=(e.bottom+e.top)/2-o/2/t}return this.view.setView(n,i,t),this.focusedMinScale=t,this.focusedBorderBox=e,this.focusedPos={x:n,y:i},this.view.publish("viewboxChange",this.view.getViewbox()),this.view.publish("borderBoxFocused",!0),0},t.prototype.setViewRect=function(e,t){void 0===t&&(t=!1);var n=e.x,i=e.y,r=e.width,o=e.height,a=n+r/2,s=i+o/2,l=this.view,c=l.viewWidth,u=l.viewHeight,d=c/r,p=u/o,h=Math.min(d,p);this.setViewPosScale(a-c/2/h,s-u/2/h,h,t)},t.prototype.destroy=function(){this.unsubs.forEach((function(e){return e()})),_e.desktop&&(document.body.removeEventListener("gesturestart",this.onGestureStart),document.body.removeEventListener("gestureend",this.onGestureChange),document.body.removeEventListener("gesturechange",this.onGestureChange),document.body.removeEventListener("dragstart",this.onDragStart))},t}(zd);function qd(e){var t=e.borderRect,n=e.viewbox,i=e.connectableLocations,r=e.currentLocation,o=e.withResizePoint,a=void 0===o||o,s=e.frozed,l=void 0!==s&&s,c=e.supportRotate,u=void 0!==c&&c;Wa({borderRect:t,viewbox:n,option:{withResizePoint:a,frozed:l}}),!l&&u&&ja({viewbox:n,border:t}),function(e){var t=e.borderRect,n=e.viewbox,i=e.connectableLocations,r=e.currentLocation,o=n.left,a=n.top,s=n.scale;Na((function(e){var n=t.left,l=t.top,c=t.right,u=t.bottom,d=((n=(n-o)*s)+(c=(c-o)*s))/2,p=((l=(l-a)*s)+(u=(u-a)*s))/2;e.clear();for(var h=0;h<i.length;h++)switch(i[h]){case"l":f(n-et,p,"l");break;case"t":f(d,l-et,"t");break;case"r":f(c+et,p,"r");break;case"b":f(d,u+et,"b")}function f(t,n,i){var o=i===r?nt:tt;e.beginFill(9877747),e.drawCircle(t,n,o),e.endFill()}}))}({borderRect:t,viewbox:n,connectableLocations:i,currentLocation:r})}var Kd=function(e){var t=e.element,n=e.viewbox,i=t.borderRect,r=t.visiable,o=t.hideSelectRect,a=t.connectableLocations,s=t.currentLocation,l=t.frozed,c=t.supportRotate,u=t.resizable,d=t.hideConnectableEditorRect,p=t.hideDisplayLocations;if(!d&&!o&&r){var h=Ga(i,n),f=a.filter((function(e){return!p.includes(e)}));fa({x:h.x,y:h.y,rotation:i.rotate,pivotX:h.x,pivotY:h.y}),qd({borderRect:i,viewbox:n,connectableLocations:f,currentLocation:s,frozed:l,supportRotate:c,withResizePoint:u}),ma()}t.group&&vs({group:t.group,viewbox:n})},Yd=function(){function e(){var e=this;this.clipData=new DataTransfer,this.items={},this.clipData.setData=function(t,n){var i=new Blob([n],{type:t});e.items[t]=i}}return e.prototype.commit=function(){navigator.clipboard.write([new ClipboardItem(this.items)]).then((function(){})).catch((function(e){}))},e}();function Xd(e,t){void 0===t&&(t={}),t.debug;var n=t.forceApi,i=void 0!==n&&n,r=document.createElement("span"),o=function(){var e=document.getSelection();if(!(null==e?void 0:e.rangeCount))return function(){};for(var t,n=[],i=0;i<e.rangeCount;i++)n.push(e.getRangeAt(i));if(document.activeElement){var r=document.activeElement.tagName.toUpperCase();"INPUT"!==r&&"TEXTAREA"!==r||(t=document.activeElement)}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),a=document.createRange(),s=document.getSelection(),l=!1;r.textContent=e,r.addEventListener("copy",(function(n){n.stopPropagation();var i=n.clipboardData;t.format&&(n.preventDefault(),i.clearData(),i.setData(t.format,e)),t.onCopy&&(n.preventDefault(),t.onCopy(i))})),document.body.appendChild(r),a.selectNodeContents(r),s.addRange(a);try{if(i)throw new Error("copy command was unsuccessful");if(!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(n){var c=new Yd,u=c.clipData;t.format&&(u.clearData(),u.setData(t.format,e),c.commit()),t.onCopy&&(t.onCopy(u),c.commit())}finally{"function"==typeof s.removeRange?s.removeRange(a):s.removeAllRanges(),document.body.removeChild(r),o()}return l}var Qd="error_3svxs",Zd="commBtn_1I6wU";function Jd(t){var n=t.success,i=t.fail,r=t.content,o=e.useState(""),a=o[0],s=o[1],l=e.useRef(null),c=e.useContext(xl).upime;e.useEffect((function(){r&&"string"==typeof r&&s(r)}),[]);var u=W().getUpimeTrans;e.useEffect((function(){c.toggleSinglePickMode(!0),l.current&&l.current.focus();var e=c.subscribe("singleElementPicked",(function(e){var t;if(e){var n=null===(t=c.getElementLink)||void 0===t?void 0:t.call(c,e.id);n&&s(n)}}));return function(){e(),c.toggleSinglePickMode(!1)}}),[]);var d=e.useState(!1),p=d[0],h=d[1];return e.createElement("div",{className:j("linkDialog_C2v5X",p&&Qd)},e.createElement("div",{className:j("top_1aAYU")},e.createElement("span",{className:j("title_3V0Im")},u("link.linkTarget")),e.createElement(hl,{className:j("close_3qR0Y"),icon:"guanbi",onClick:function(){i("close")}})),e.createElement("span",{className:j("desc_3XZE7")},u("link.description")),e.createElement("input",{id:"addLink",className:j("linkInput_3grmj",p&&Qd),type:"text",placeholder:u("link.paste"),ref:l,value:a,autoComplete:"off",onChange:function(e){var t=e.target.value;s(t)},onBlur:function(e){if(!e.relatedTarget||"confirm"!==e.relatedTarget.name){var t=me(ge(a.trim()));h(!t)}}}),a&&e.createElement("div",{className:"clearInput_NZHO1",onClickCapture:function(){var e;s(""),null===(e=l.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"})),p&&e.createElement("div",{className:"error_msg_2Vx8S"},u("webpage.insert.error")),e.createElement("div",{className:j("bottomContainr_1BBJS")},e.createElement("button",{name:"confirm",className:j(Zd,"sureBtn_3-vkU"),onClick:function(){if(a.length>0){var e=ge(a.trim()),t=me(e);h(!t),t&&n(e)}else n(null)}},u("common.confirm")),a.length>0&&e.createElement("button",{className:j(Zd,"cancelBtn_30MnZ"),onClick:function(){n(null)}},u("link.delete"))))}var $d=it[it.length-1],ep=it[0],tp=30/($d-ep),np=-33/($d-ep),ip=64/($d-ep),rp={x:0,y:.5},op={x:.5,y:0},ap={x:1,y:.5},sp={x:.5,y:1};function lp(e,t){void 0===t&&(t=!1);var n=[];return e.forEach((function(i){t&&i.isRootNode||e.some((function(e){return e!==i&&e.isAncestor(i)}))||n.push(i)})),n}function cp(e){switch(e){case"l":return{start:rp,end:ap};case"t":return{start:op,end:sp};case"r":return{start:ap,end:rp};default:return{start:sp,end:op}}}var up=function(){function e(e){this.renderer=dp,this.renderKey="align-widget"+Date.now(),this.data=e}return M([rl],e.prototype,"data",void 0),M([il],e)}(),dp=function(t){var n=t.element,i=t.viewbox;al(n);var r=i.left,o=i.top,a=i.scale,s=n.data,l=s.border,c=s.leftAlign,u=s.rightAlign,d=s.hCenterAlign,p=s.topAlign,h=s.bottomAlign,f=s.vCenterAlign;function m(t){var n=(t.value-o)*a,i=(Math.min(t.border.left,l.left)-r)*a,s=(Math.max(t.border.right,l.right)-r)*a,c="M".concat(i-20,",").concat(n," L").concat(s+20,",").concat(n);return e.createElement("path",{d:c})}function v(t){var n=(t.value-r)*a,i=(Math.min(t.border.top,l.top)-o)*a,s=(Math.max(t.border.bottom,l.bottom)-o)*a,c="M".concat(n,",").concat(i-20," L").concat(n,",").concat(s+20);return e.createElement("path",{d:c})}return e.createElement("g",{stroke:"#5d98fc",strokeWidth:1},f&&m(f),p&&p.border!==(null==f?void 0:f.border)&&m(p),h&&h.border!==(null==f?void 0:f.border)&&m(h),d&&v(d),c&&c.border!==(null==d?void 0:d.border)&&v(c),u&&u.border!==(null==d?void 0:d.border)&&v(u))},pp=function(){function e(e){this.renderer=hp,this.renderKey="gap-widget"+Date.now(),this.data=e}return M([rl],e.prototype,"data",void 0),M([il],e)}(),hp=function(t){var n=t.element,i=t.viewbox;al(n);var r=i.left,o=i.top,a=i.scale,s=n.data,l=s.vertiData,c=s.horizData,u=[];function d(e,t){var n=e.border,i=e.gap,r=e.jumpBorder,o=e.sameSide,a=e.diffSide,s=o.gapLine,l=o.borders;if(a){var c=a.border,u=a.gapLine;i<0?(t(u,r,n),t(u,n,c)):(t(u,c,n),t(u,n,r))}else i<0?t(s,r,n):t(s,n,r);for(var d=0;d<l.length;d++){var p=0===d?r:l[d-1];i<0?t(s,l[d],p):t(s,p,l[d])}}return l&&d(l,(function(t,n,i){t=(t-r)*a;var s=(n.bottom-o)*a,l=(i.top-o)*a;u.push(e.createElement(e.Fragment,null,e.createElement("path",{d:"M".concat(t-4,",").concat(s+2," L").concat(t+4,",").concat(s+2)}),e.createElement("path",{d:"M".concat(t,",").concat(s+2," L").concat(t,",").concat(l-2)}),e.createElement("path",{d:"M".concat(t-4,",").concat(l-2," L").concat(t+4,",").concat(l-2)})))})),c&&d(c,(function(t,n,i){t=(t-o)*a;var s=(n.right-r)*a,l=(i.left-r)*a;u.push(e.createElement(e.Fragment,null,e.createElement("path",{d:"M".concat(s+2,",").concat(t-4," L").concat(s+2,",").concat(t+4)}),e.createElement("path",{d:"M".concat(s+2,",").concat(t," L").concat(l-2,",").concat(t)}),e.createElement("path",{d:"M".concat(l-2,",").concat(t-4," L").concat(l-2,",").concat(t+4)})))})),e.createElement("g",{stroke:"#5d98fc",strokeWidth:1},u)},fp=function(){function e(e){this.renderer=mp,this.renderKey="resize-align-widget"+Date.now(),this.infos=e}return M([rl],e.prototype,"infos",void 0),M([il],e)}(),mp=function(t){var n=t.element,i=t.viewbox;al(n);var r=i.left,o=i.top,a=i.scale,s=n.infos,l=[];return s.forEach((function(t){var n=t.border,i=t.markHeight,s=t.markWidth;i&&function(t){var n=t.left,i=t.top,s=t.bottom,c=(i-o)*a-1,u=(s-o)*a+1,d=(n-r)*a-20;l.push(e.createElement(e.Fragment,null,e.createElement("path",{d:"M".concat(d-5,",").concat(c," L").concat(d+5,",").concat(c)}),e.createElement("path",{d:"M".concat(d,",").concat(c," L").concat(d,",").concat(u)}),e.createElement("path",{d:"M".concat(d-5,",").concat(u," L").concat(d+5,",").concat(u)})))}(n),s&&function(t){var n=t.left,i=t.right,s=t.bottom,c=(n-r)*a-1,u=(i-r)*a+1,d=(s-o)*a+20;l.push(e.createElement(e.Fragment,null,e.createElement("path",{d:"M".concat(c,",").concat(d-5," L").concat(c,",").concat(d+5)}),e.createElement("path",{d:"M".concat(c,",").concat(d," L").concat(u,",").concat(d)}),e.createElement("path",{d:"M".concat(u,",").concat(d-5," L").concat(u,",").concat(d+5)})))}(n)})),e.createElement("g",{stroke:"#5d98fc",strokeWidth:1},l)},vp=[[15,.4],[30,.65],[45,.8],[60,.9],[75,.95],[90,.99]],gp=function(e){var t=e.beginTime,n=e.x,i=void 0===n?0:n,r=e.y,o=void 0===r?0:r,a=e.width,s=e.height,l=e.name,c=void 0===l?"":l,u=e.renderTarget,d=js.value.renderApp;if(d){var p=function(e){for(var t=(Date.now()-e)/1e3,n=0,i=0,r=0,o=vp;r<o.length;r++){var a=o[r],s=a[0],l=a[1];if(t<s)return n+(t-i)/(s-i)*(l-n);n=l,i=s}return n}(t);p<.95&&d(50,u);var h=1;(a<500||s<500)&&(h=Math.min(a/500,s/500)),a/=h,s/=h,fa({x:i,y:o,scaleX:h,scaleY:h}),Ma((function(e){var t=e.context;t.fillStyle="#000000",t.globalAlpha=.2,t.fillRect(0,0,a,s),t.lineWidth=12,t.strokeStyle="#ffffff",t.beginPath(),t.arc(a/2,s/2,114,0,2*Math.PI),t.stroke(),t.globalAlpha=1,t.strokeStyle="#1d6bf9",t.lineWidth=6,t.beginPath(),t.arc(a/2,s/2,114,.5*-Math.PI,p*Math.PI*2-.5*Math.PI),t.stroke()})),c&&24*h>8&&Ra({text:c,fontSize:24,lineHeight:36,textWidth:.8*a},{x:.1*a,y:s/2+114+6+18,va:"top",ha:"center",fill:"#ffffff"}),ma()}},yp=function(e,t){var n="";switch(e){case Za.COMMENT:n="toolbar.comment";break;case Za.CONNECTIONLINE:n="toolbar.connectLine";break;case Za.DOCUMENT:n="toolbar.upload.file";break;case Za.FRAME:n="toolbar.frame";break;case Za.IMAGE:n="toolbar.upload.image";break;case Za.LINE:n="toolbar.pen";break;case Za.MINDMAP_NODE:n="toolbar.mindmap";break;case Za.MINDMAP_LINE:n="mindmap.connection.line";break;case Za.SHAPE:case Za.GRAPHIC:n="toolbar.shape";break;case Za.STICKER:n="toolbar.sticker";break;case Za.TEXT:case Za.GRID_TEXT:n="toolbar.text";break;case Za.VIDEO:n="toolbar.upload.video";break;case Za.AUDIO:n="audio.element.label";break;case Za.TABLE:n="table.label";break;case Za.WEBPAGE:n="webpage.label";break;case Za.TIMER:n="toolbar.timer";break;case Za.KANBAN:n="kanban.label";break;case Za.CARD:n="card.label"}return n?t(n):"unknown element type"},bp=function(e){var t,n;switch(e.elementType){case Za.DOCUMENT:case Za.FRAME:case Za.IMAGE:case Za.VIDEO:case Za.AUDIO:case Za.TABLE:case Za.CARD:case Za.KANBAN:return e.name;case Za.MINDMAP_NODE:case Za.SHAPE:case Za.STICKER:case Za.TEXT:case Za.GRID_TEXT:return e.rawText;case Za.CONNECTIONLINE:return(null===(n=null===(t=e.texts)||void 0===t?void 0:t[0])||void 0===n?void 0:n.content.map((function(e){return e[0]})).flat().join(""))||""}return""},Ep=function(e,t){var n,i;switch(e){case Za.DOCUMENT:case Za.FRAME:case Za.IMAGE:case Za.VIDEO:case Za.AUDIO:case Za.TABLE:case Za.CARD:case Za.KANBAN:return t.name;case Za.MINDMAP_NODE:case Za.SHAPE:case Za.STICKER:case Za.TEXT:case Za.GRID_TEXT:return t.richContent.content.map((function(e){return e[0].join("")})).join("");case Za.CONNECTIONLINE:return(null===(i=null===(n=t.texts)||void 0===n?void 0:n[0])||void 0===i?void 0:i.content.map((function(e){return e[0]})).flat().join(""))||""}return""},xp=function(e){switch(e){case Za.COMMENT:return"pizhu";case Za.CONNECTIONLINE:return"lianjiexian";case Za.DOCUMENT:return"wenjian";case Za.FRAME:return"huaban";case Za.IMAGE:return"tupian";case Za.LINE:return"huabi";case Za.MINDMAP_NODE:return"siweidaotu";case Za.SHAPE:return"xingzhuang";case Za.STICKER:return"bianqian";case Za.TEXT:return"wenben";case Za.VIDEO:return"shipin";case Za.AUDIO:return"yinpin";case Za.TABLE:return"biaoge";case Za.WEBPAGE:return"neiqianwangye";case Za.TIMER:return"jishiqi";case Za.KANBAN:return"kanban";case Za.CARD:return"kapian";default:return"warning-circle"}};function wp(e){var t=this,n=new Ks,i=new FileReader;return i.onload=function(e){var i,r=new Image;r.onload=function(){return A(t,void 0,void 0,(function(){return D(this,(function(e){return n.done(r),[2]}))}))},r.src=null===(i=e.target)||void 0===i?void 0:i.result},i.readAsDataURL(e),n.result}function Cp(e){return e.elementType===Za.CARD&&!0===e.isGhost}var Sp=function(){function e(e,t,n,i){this.upime=e,this._port=t,this.evtHandler=n,this.shadowClient=i,this._opened=!1,this.manager=(null==i?void 0:i.websocketHelper.subServiceManager)||e.subServiceManager}return Object.defineProperty(e.prototype,"opened",{get:function(){return this._opened},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cmdSender",{get:function(){var e;return(null===(e=this.shadowClient)||void 0===e?void 0:e.websocketHelper)||this.upime},enumerable:!1,configurable:!0}),e.prototype.dealSCmd=function(e){var t=this._parseServiceCmd(e);"function"==typeof this.evtHandler?this.evtHandler(t):this.evtHandler.handleCmd(t)},e.prototype.open=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this._open()];case 1:return e.sent(),this.opened||(this.manager.registerService(this),this._opened=!0),[2]}}))}))},e.prototype.close=function(){this._opened&&(this.manager.unRegisterService(this),this._opened=!1,this.cmdSender.clearSubserviceRequest(this.port))},e.prototype.sendSCmd=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(t=this.cmdSender).sendSCmd.apply(t,R([this.port,e],n,!1))},e.prototype.sendRCmd=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.cmdSender).sendRCmd.apply(t,R([this.port,e],n,!1))},e}(),kp=function(){function e(){this.subServices=[]}return e.prototype.dealSCmd=function(e){var t=e[0],n=e.slice(1),i=this.subServices.find((function(e){return e.port===t}));i&&i.dealSCmd(n)},e.prototype.registerService=function(e){this.subServices.includes(e)||this.subServices.unshift(e)},e.prototype.unRegisterService=function(e){var t=this.subServices.indexOf(e);t>=0&&this.subServices.splice(t,1)},e.prototype.resetData=function(){this.subServices=[]},e}(),_p=[".mp4",".mov",".mp3",".wav",".jpg",".jpeg",".png",".gif",".bmp",".svg",".webp",".pdf",".doc",".docx",".xls",".xlsx",".csv",".ppt",".pptx"];function Tp(e){return["mp4","mov"].includes(e)}function Ip(e){return["mp3","wav"].includes(e)}function Pp(e){return["jpg","jpeg","png","gif","bmp","svg","webp"].includes(e)}function Np(e){return["pdf","doc","docx","xls","xlsx","csv","ppt","pptx"].includes(e)}function Mp(e){return["ppt","pptx"].includes(e)}function Ap(e){return["pdf"].includes(e)}function Dp(e){return["doc","docx"].includes(e)}function Rp(e){return["xls","xlsx","csv"].includes(e)}function Bp(e,t){var n=[],i=[],r=[],o=t.fileSizeLimit;return e.forEach((function(e,t){var a=Jo(e.name);Pp(a)||Np(a)?e.size>o?r.push({file:e,index:t}):Np(a)?Ce===de.PRIVATE&&["doc","docx","ppt","pptx"].includes(a)?i.push({file:e,index:t}):n.push({file:e,ext:a,type:"document",index:t}):n.push({file:e,ext:a,type:"image",index:t}):Tp(a)||Ip(a)?e.size>o?r.push({file:e,index:t}):Tp(a)?n.push({file:e,ext:a,type:"mp4",index:t}):n.push({file:e,ext:a,type:"mp3",index:t}):i.push({file:e,index:t})})),{validFiles:n,notSupportedFiles:i,exceedLimitFiles:r}}var Lp,Op=300,Fp=300;function zp(e,t,n,i,r){void 0===i&&(i=Op),void 0===r&&(r=Fp);var o=e/t;return e>i/n&&(t=i/o/n,e=i/n),t>r/n&&(e=o*r/n,t=r/n),{width:e,height:t}}function Hp(e,t,n){return void 0===n&&(n=1),A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:i=t,r=[],o=[],a=0,d.label=1;case 1:return a<e.length?(s=e[a],l={width:$p.width/n,height:$p.height/n},"document"!==s.type?[3,2]:(o.push({extFile:s,position:i}),[3,6])):[3,8];case 2:return"mp4"!==s.type?[3,3]:(o.push({extFile:s,position:i}),[3,6]);case 3:return"mp3"!==s.type?[3,4]:(o.push({extFile:s,position:i}),[3,6]);case 4:return[4,wp(s.file)];case 5:c=d.sent(),o.push({extFile:s,position:i,image:c}),d.label=6;case 6:r.push({left:i.x,top:i.y,right:i.x+l.width,bottom:i.y+l.height}),a+1<e.length&&((a+1)%10==0?(u=Yt(r),i={x:u.left,y:u.bottom+20/n}):i={x:i.x+l.width+20/n,y:i.y}),d.label=7;case 7:return a++,[3,1];case 8:return[2,{elementBounds:r,files:o}]}}))}))}function Up(e,t,n,i,r,o,a){return void 0===o&&(o={autoSize:!0}),void 0===a&&(a=1),A(this,void 0,void 0,(function(){var s,l,c,u,d,p,h,f;return D(this,(function(m){switch(m.label){case 0:return s=e.file,l=e.ext,c=r.id,[4,i.saveFile(2,{file:s,ext:l,fakeName:"".concat(i.genFileName(c),".").concat(l)})];case 1:return(u=m.sent())?(d=(o||{}).autoSize,p={width:t.naturalWidth,height:t.naturalHeight},f=p.width,d||(f=zp(p.width,p.height,a).width),h=f/p.width,[2,{position:{x:n.x+($p.width/a-f)/2,y:n.y},size:p,scale:h,clipRect:exports.E({x:0,y:0},p),fileId:u,name:s.name,imgType:l,zIndex:i.newMaxZindex()}]):[2,null]}}))}))}function Wp(e,t,n,i,r){return void 0===r&&(r=1),A(this,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,h,f,m,v,g;return D(this,(function(y){switch(y.label){case 0:return o=e.file,a=e.ext,s=i.id,[4,n.saveFile(2,{file:o,ext:a,fakeName:"".concat(n.genFileName(s),".").concat(a)})];case 1:return(l=y.sent())?(c=5,[4,n.parseIspringPpt(l)]):[3,3];case 2:return(u=y.sent())?(d=u.totalPage,p=u.coverHeight,h=u.coverWidth,f=u.estimateCompleteTime,v=zp(h,p+(m=.05416666666666667*h),r).width,g=v/h,[2,{position:{x:t.x+($p.width/r-v)/2,y:t.y},fileType:c,fileId:l,name:o.name,parseStatus:2,size:{width:h,height:p},titleHeight:m,scale:g,totalPage:d,zIndex:n.newMaxZindex(),estimateCompleteTime:f}]):[2,null];case 3:return[2,null]}}))}))}function Vp(e,t,n,i,r){return void 0===r&&(r=1),A(this,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,h,f,m,v,g;return D(this,(function(y){switch(y.label){case 0:return o=e.file,a=e.ext,s=i.id,[4,n.saveFile(2,{file:o,ext:a,fakeName:"".concat(n.genFileName(s),".").concat(a)})];case 1:if(!(l=y.sent()))return[3,3];switch(c=1,a){case"pdf":c=1;break;case"ppt":case"pptx":c=2;break;case"xls":case"xlsx":case"csv":c=3;break;case"doc":case"docx":c=4}return[4,n.sendRequest(3,l,c)];case 2:return u=y.sent(),d=u[1],p=u[2],h=p[0],f=p[1],v=zp(h,f+(m=.05416666666666667*h),r).width,g=v/h,[2,{position:{x:t.x+($p.width/r-v)/2,y:t.y},fileType:c,fileId:l,name:o.name,size:{width:h,height:f},titleHeight:m,scale:g,totalPage:d,zIndex:n.newMaxZindex()}];case 3:return[2,null]}}))}))}function jp(e,t,n,i,r){return void 0===r&&(r=1),A(this,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x;return D(this,(function(w){switch(w.label){case 0:return o=e.file,a=e.ext,s=i.id,(l=document.createElement("video")).src=URL.createObjectURL(o),l.load(),[4,n.saveFile(2,{file:o,ext:a,fakeName:"".concat(n.genFileName(s),".").concat(a)})];case 1:return(c=w.sent())?[4,n.transcodeMedia(c)]:[2,null];case 2:return(u=w.sent())?(d=u.duration,p=u.status,h=u.estimateCompleteTime,f=u.coverInfo,v=(m=f).width,g=m.height,y=m.fileId,E=zp(v,g+(b=.05416666666666667*v),r).width,x=E/v,[2,{position:{x:t.x+($p.width/r-E)/2,y:t.y},size:{width:v,height:g},titleHeight:b,scale:x,zIndex:n.newMaxZindex(),coverFileId:y,duration:d,fileId:c,name:o.name,estimateCompleteTime:h,transStatus:p}]):[2,null]}}))}))}function Gp(e,t,n,i,r){return void 0===r&&(r=1),A(this,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,h,f,m;return D(this,(function(v){switch(v.label){case 0:return o=e.file,a=e.ext,s=i.id,[4,n.saveFile(2,{file:o,ext:a,fakeName:"".concat(n.genFileName(s),".").concat(a)})];case 1:return(l=v.sent())?[4,n.transcodeMedia(l)]:[2,null];case 2:return(c=v.sent())?(u=c.duration,d=c.status,p=c.estimateCompleteTime,f=zp(ot.width,ot.height+(h=.05416666666666667*ot.width),r).width,m=f/ot.width,[2,{position:{x:t.x+($p.width/r-f)/2,y:t.y},size:ot,scale:m,titleHeight:h,zIndex:n.newMaxZindex(),duration:u,fileId:l,name:o.name,transStatus:d,estimateCompleteTime:p}]):[2,null]}}))}))}!function(e){e[e.send=1]="send",e[e.recive=2]="recive"}(Lp||(Lp={}));var qp,Kp,Yp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){return e},t}(Sp),Xp=function(){function e(e,t,n,i,r,o){void 0===r&&(r=0),this.rotate=r,this.renderer=Qp,this.renderKey="pure-rect",this.type="",this.borderColor=6134012,this.dashedBorder=!1,this.borderThickness=2,this.borderOpacity=1,this.bgColor=6134012,this.bgOpacity=0,this.crosshair=!1,this.data={x:e,y:t,width:n,height:i},this.position={x:e,y:t},this.renderKey+=o}return e.prototype.dealMove=function(e,t){this.data.x+=e,this.data.y+=t},e}(),Qp=function(e){var t=e.element,n=e.viewbox,i=t.data,r=t.bgColor,o=t.bgOpacity,a=t.borderColor,s=t.borderOpacity,l=t.borderThickness,c=t.dashedBorder,u=t.position,d=t.crosshair,p=t.rotate,h=n.left,f=n.top,m=n.scale,v=i.x,g=i.y,y=i.width,b=i.height,E=y/2*m,x=b/2*m;Na((function(e){if(y*=m,b*=m,e.clear(),d){var t=(u.x-h)*m-v,n=(u.y-f)*m-g;e.lineStyle({width:l,color:a}),e.moveTo(t-60,n),e.lineTo(t+60,n),e.moveTo(t,n-60),e.lineTo(t,n+60)}if(c)return e.beginFill(r,o),e.lineStyle(),e.drawRect(0,0,y,b),e.lineStyle({width:l,color:a,alpha:s,lineDash:[6,6]}),void e.drawRoundedRect(0,0,y,b,4);e.lineStyle({width:l,color:a,alpha:s}),e.beginFill(r,o),e.drawRect(0,0,y,b)}),{x:(v=(v-h)*m)+E,y:(g=(g-f)*m)+x,pivotX:E,pivotY:x,rotation:p})},Zp=function(){function e(){this.renderKey="drop-mask",this.renderer=Jp,qp||er(qp=tr($o("support_files_3.png"))),Kp||er(Kp=tr($o("upload.png"))),this.supportFilesImg=qp,this.uploadImg=Kp}return Object.defineProperty(e.prototype,"loaded",{get:function(){return this.supportFilesImg.loaded&&this.uploadImg.loaded},enumerable:!1,configurable:!0}),e}(),Jp=function(e){var t=e.element,n=e.upime,i=e.viewbox,r=js.value.addLoadingSource,o=i.left,a=i.top,s=i.right,l=i.bottom,c=i.scale,u=(s-o)*c,d=(l-a)*c;!t.loaded&&r&&r(t),Na((function(e){e.clear(),e.beginFill(0,.1),e.drawRect(0,0,u,d),e.beginFill(0,.1),e.drawCircle(u/2,d/2,91),e.endFill()})),Oa({src:t.supportFilesImg,width:304,height:40,x:u/2-152,y:(d-182)/2-60}),fa({x:(u-182)/2,y:(d-182)/2}),Oa({src:t.uploadImg,x:61,y:40,width:60,height:60});var p=null==O?void 0:O("uploadWidget.upload");Ra(n.view.memo.useMemo("uploadText",(function(){return{text:p,fontSize:20,lineHeight:28}}),[p]),{x:91,y:112,ha:"center",fill:"#ffffff",fontWeight:"bold"}),ma()},$p=function(){function e(e,t,n,i,r){void 0===r&&(r=1),this.name=t,this.x=n,this.y=i,this.viewScale=r,this.renderer=eh,this.renderKey="upload-progress",this.width=Op,this.height=Fp,this.beginTime=Date.now(),this.renderKey="upload-progress-".concat(e),this.width=Op,this.height=Fp}return e.prototype.calcRenderBox=function(){return{left:this.x,top:this.y,right:this.x+this.width/this.viewScale,bottom:this.y+this.height/this.viewScale}},e.width=Op,e.height=Fp,e}(),eh=function(e){var t=e.element,n=e.viewbox,i=n.left,r=n.top,o=n.scale;fa({x:(t.x-i)*o,y:(t.y-r)*o,scaleX:o/t.viewScale,scaleY:o/t.viewScale}),gp({beginTime:t.beginTime,width:t.width,height:t.height,name:t.name,renderTarget:t}),ma()},th=function(e,t,n){this.renderer=nh,this.renderKey="align-guides",this.type="",this.borderColor=4350719,this.borderThickness=1,this.data={x:e,y:t,angle:n}},nh=function(e){var t=e.element,n=e.upime,i=e.viewbox,r=i.left,o=i.top,a=i.scale,s=n.view,l=s.viewWidth,c=s.viewHeight,u=t.data,d=t.borderColor,p=t.borderThickness,h=u.x,f=u.y,m=u.angle;Na((function(e){e.clear();var t=Math.max(l,c);e.lineStyle({width:p,color:d,lineDash:[5,5]}),e.moveTo((h-r)*a-t*Math.cos(m),(f-o)*a+t*Math.sin(m)),e.lineTo((h-r)*a+t*Math.cos(m),(f-o)*a-t*Math.sin(m))}))},ih=function(e,t,n,i,r,o){this.x=t,this.y=n,this.width=i,this.height=r,this.ratio=o,this.renderer=rh,this.renderKey="frame-ratio_preview-".concat(e,"-").concat(Date.now())},rh=function(e){var t=e.element,n=e.viewbox,i=n.left,r=n.top,o=n.scale,a=t.x,s=t.y,l=t.width,c=t.height,u=t.ratio,d=In(u,l*c),p=d.width,h=d.height;Na((function(e){e.clear(),e.beginFill(3044581,.2),e.drawRect((a-i)*o,(s-r)*o,p*o,h*o),e.endFill()}))},oh=function(e,t){this.renderer=ah,this.renderKey="EleTransAlignWidget",this.x=null,this.y=null,this.x=e,this.y=t},ah=function(e){var t=e.element,n=e.viewbox,i=n.left,r=n.top,o=n.bottom,a=n.right,s=n.scale,l=t.x,c=t.y;Na((function(e){e.clear(),e.lineStyle({color:6134012,width:1}),null!==l&&(e.moveTo((l-i)*s,-1*s),e.lineTo((l-i)*s,(o-r+1)*s)),null!==c&&(e.moveTo(-1*s,(c-r)*s),e.lineTo((a-i+1)*s,(c-r)*s))}))},sh=function(e){var t=e.element,n=e.viewbox;Ma((function(e){var i=t.rubberPath;if(i.length>1){var r=e.context;e.currentPainter.setTransform(e),r.globalAlpha=.1,r.strokeStyle="#858585",r.lineWidth=8,r.lineCap="round",r.lineJoin="round";for(var o=0;o<i.length;o++){var a=(i[o].x-n.left)*n.scale,s=(i[o].y-n.top)*n.scale;0==o?(r.beginPath(),r.moveTo(a,s)):r.lineTo(a,s)}r.stroke()}}))},lh=function(){function e(e){var t=this;this.view=e,this.renderer=sh,this.renderKey="rubber-widget",this.onMount=function(){var e=t.rubberPath,n=function(){t.timer=fr((function(){t.timer=void 0;var i=Date.now(),r=t.rubberPath.filter((function(e){return i-e.time<128}));t.rubberPath===e&&r.length===e.length||(e=r,t.rubberPath=r,t.view.update()),n()}))};n()},this.onUnmount=function(){void 0!==t.timer&&mr(t.timer)},this.rubberPath=[]}return e.prototype.addPoint=function(e){this.rubberPath=R(R([],this.rubberPath,!0),[exports.E(exports.E({},e),{time:Date.now()})],!1)},e.prototype.clear=function(){this.rubberPath=[]},e}(),ch=function(e){var t=e.viewbox,n=e.element,i=t.left,r=t.top,o=t.right,a=t.bottom,s=t.scale,l=n.lastHoveredEle,c=n.lastPickedEle,u=(o-i)*s,d=(a-r)*s,p=function(e){var t=e.left,n=e.right,o=e.bottom,a=e.top,l=e.rotate,c=(t-i)*s,u=(a-r)*s,d=(n-t)*s,p=(o-a)*s,h=c+d/2,f=u+p/2;return[an({x:c,y:u},null!=l?l:0,{x:h,y:f}),an({x:c+d,y:u},null!=l?l:0,{x:h,y:f}),an({x:c+d,y:u+p},null!=l?l:0,{x:h,y:f}),an({x:c,y:u+p},null!=l?l:0,{x:h,y:f})]};Ma((function(e){var t=e.context;if(l&&l!==c){t.save();var n=p(l.getGlobalBox()),o=n[0],a=n[1],h=n[2],f=n[3];t.globalAlpha=.4,t.lineWidth=.01,t.strokeStyle="#858585",t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.lineTo(h.x,h.y),t.lineTo(f.x,f.y),t.lineTo(o.x,o.y),t.fillStyle="#858585",t.fill(),t.closePath(),t.restore()}var m=new Path2D,v=new Path2D;if(t.save(),v.rect(0,0,u,d),m.addPath(v),c){var g=c.getGlobalBox(),y=g.left,b=g.right,E=g.top,x=g.bottom,w=g.rotate,C=(y-i)*s,S=(E-r)*s,k=(b-y)*s,_=(x-E)*s,T=new Path2D;if(T.rect(C,S,k,_),w){var I=C+k/2,P=S+_/2,N=new ar;N.update(I,P,1,1,I,P,w*Math.PI/180),m.addPath(T,N.getDOMMatrix())}else m.addPath(T);t.clip(m,"evenodd")}if(t.fillStyle="#000000",t.globalAlpha=.3,t.fill(v),t.restore(),c){t.save();var M=p(c.getGlobalBox());o=M[0],a=M[1],h=M[2],f=M[3],t.globalAlpha=.4,t.lineWidth=.01,t.strokeStyle="#ffffff",t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.lineTo(h.x,h.y),t.lineTo(f.x,f.y),t.lineTo(o.x,o.y),t.fillStyle="#ffffff",t.fill(),t.closePath(),t.restore()}}))},uh=function(){this.renderer=ch,this.renderKey="single-pick-widget",this.lastHoveredEle=null,this.lastPickedEle=null},dh=function(){function e(e,t,n){this.upime=e,this._xBounceDelta=0,this._yBounceDelta=0,this._accumulateX=0,this._accumulateY=0,this._lastMouseEvt=null,this._bounceAnimation=null,this._lastTimeStamp=0,t&&(this.handler=t,n&&(this.handler=t.bind(n)))}return e.prototype._bounceView=function(){var e=this;if(this._bounceAnimation=fr((function(){return e._bounceView()})),!(Date.now()-this._lastTimeStamp<1e3/60)){var t=this.upime.view;if(this._accumulateX+=this._xBounceDelta/t.scale,this._accumulateY+=this._yBounceDelta/t.scale,this._lastMouseEvt){var n=exports.E(exports.E({},this._lastMouseEvt),{position:{x:this._lastMouseEvt.position.x+this._accumulateX,y:this._lastMouseEvt.position.y+this._accumulateY}});this.handler&&this.handler(n)}this.upime.setViewPosScale(t.x+this._xBounceDelta/t.scale,t.y+this._yBounceDelta/t.scale,t.scale),this._lastTimeStamp=Date.now()}},e.prototype.checkMoveBorderCondition=function(e){this._accumulateX=0,this._accumulateY=0;var t=this.upime.view.viewWidth,n=this.upime.view.viewHeight,i=e.globalPosition,r=i.x,o=i.y,a=e.preGlobalPosition,s=r-a.x,l=o-a.y;this._lastMouseEvt=e,r>t-30?s<0&&!this._xBounceDelta||(this._xBounceDelta=this._getCurBounceSpeed(t-r)):r<30?s>0&&!this._xBounceDelta||(this._xBounceDelta=-this._getCurBounceSpeed(r)):this._xBounceDelta=0,o>n-30?l<0&&!this._yBounceDelta||(this._yBounceDelta=this._getCurBounceSpeed(n-o)):o<30?l>0&&!this._yBounceDelta||(this._yBounceDelta=-this._getCurBounceSpeed(o)):this._yBounceDelta=0,this._bounceAnimation||!this._xBounceDelta&&!this._yBounceDelta||this._bounceView(),(!this._xBounceDelta&&!this._yBounceDelta||e.isEnd)&&(this._bounceAnimation&&mr(this._bounceAnimation),this._bounceAnimation=null,e.isEnd&&(this._xBounceDelta=0,this._yBounceDelta=0))},e.prototype._getCurBounceSpeed=function(e){return e>=30?0:e<20?8.8:8.8-.88*(e-20)},e}();function ph(e,t){return e.right<t.left?e.right-t.left:e.left>t.right?e.left-t.right:0}function hh(e,t){return e.bottom<t.top?e.bottom-t.top:e.top>t.bottom?e.top-t.bottom:0}var fh=function(){function e(e){var t=this;this.upime=e,this.breakIndex=0,this.deferRenderRequest=0,this.toolbarLeftAligned=!1,this.renderer=ms,this.propertyEditors=[],this.supportZindex=!0,this.movingEles=[],this.resizingEles=[],this.markedElements=[],this.extraWidth=0,this.extraHeight=0,this.shiftKeyDown=!1,this._candidateTablesArr=[],this.originRefData=[],this.editing=!1,this.newLockedElements=[],this.allInGlobalRs=!0,this.autoReposition=!0,this.eleTransAlignWidget=null,this.pressedMap={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1},this.createCommentOnElement=function(e){t.couldAddComment&&t.upime.createCommentOnElement(t.getElements()[0],e)},this.createFrameFromElements=function(){t.couldCreateFrame&&t.upime.createFrameFromElements(t.getElements())},this.cross=new dh(e,this.handleSelectCtrlMove,this)}return e.prototype.checkHideToolbar=function(){return!1},Object.defineProperty(e.prototype,"hideToolbar",{get:function(){return this.checkHideToolbar()},enumerable:!1,configurable:!0}),e.prototype.checkHideSelectRect=function(){return!1},Object.defineProperty(e.prototype,"hideSelectRect",{get:function(){return this.checkHideSelectRect()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frames",{get:function(){return this.getElements().filter((function(e){return e.elementType===Za.FRAME}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFrame",{get:function(){return!!this.frames.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"couldUnfroze",{get:function(){var e=this.getElements()[0].unFrozenRoles;return!e||e.includes(this.upime.userManager.userType)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"couldUnHideFrame",{get:function(){var e=this;return!!this.frames.length&&this.frames.some((function(t){return t.unHideRoles&&t.unHideRoles.includes(e.upime.userManager.userType)||!t.unHideRoles}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allFrameHided",{get:function(){return!!this.frames.length&&this.frames.every((function(e){return e.hide}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curFramesUnhideRoles",{get:function(){var e,t,n,i,r=this.frames;if(!r.length)return null;if(1===r.length)return r[0].unHideRoles||[];for(var o=null!==(t=null===(e=r[0].unHideRoles)||void 0===e?void 0:e.sort())&&void 0!==t?t:[],a=!0,s=0,l=r.slice(1);s<l.length;s++){var c=l[s];se(o,null!==(i=null===(n=c.unHideRoles)||void 0===n?void 0:n.sort())&&void 0!==i?i:[])||(a=!1)}return a?o:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSupportAI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportMoreCtrl",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dealArrowKeyInternally",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportDownload",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportFullCommonOp",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"phoneToolbarMode",{get:function(){return"phone"},enumerable:!1,configurable:!0}),e.prototype.supportLinkTo=function(){return!1},Object.defineProperty(e.prototype,"supportRotate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"couldAddComment",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.addLinkTo=function(){var e;return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:this.upime.clearSelect(),t=this.getElements()[0],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.upime.showWindow(Jd,null!==(e=t.link)&&void 0!==e?e:void 0,!0)];case 2:return null!==(n=i.sent())&&(n=oe(n)),this.updateProperty({link:n}),[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}}))}))},Object.defineProperty(e.prototype,"currentOp",{get:function(){return this._currentOp},set:function(e){this._currentOp=e},enumerable:!1,configurable:!0}),e.prototype.getMinSize=function(e,t){return 0},Object.defineProperty(e.prototype,"disableAntiResize",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableTransparentInBox",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHandMode",{get:function(){return"hand"===this.upime.xmode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editable",{get:function(){return this.upime.editable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportFrozeLock",{get:function(){return this.allInGlobalRs},enumerable:!1,configurable:!0}),e.prototype.getToolBarPosition=function(e){var t=this.upime.view,n=this.borderRect,i=n.rotate?Sn(n,n.rotate):n,r=i.left,o=i.top,a=i.bottom,s=i.right,l=t.getScreenPosition({x:r,y:o}),c=t.getScreenPosition({x:s,y:a}),u=e.width,d=e.height,p=this.toolbarLeftAligned?l.x:(l.x+c.x)/2-u/2,h=l.y-110;return h<60&&(h=c.y+110-d)>t.viewHeight-110&&(h=60),p<80?p=80:p+u>t.viewWidth-10&&(p=t.viewWidth-10-u),{x:p,y:h}},e.prototype.handleDirectMoveKeyUp=function(e){this.editing||(this.pressedMap[e]=!1,Object.values(this.pressedMap).every((function(e){return!e}))&&(this.handleDirectMove({deltaX:0,deltaY:0,isStart:!1,isEnd:!0}),this.eleTransAlignWidget&&this.upime.view.removeCanvasWidget(this.eleTransAlignWidget),this.eleTransAlignWidget=null,this.syncUpdate(),this.currentOp=void 0,this.upime.clearLock(this.currentLock),this.currentLock=void 0,this.movingEles=[]),this.updateBorderBox())},e.prototype.handleDirectMoveCtrl=function(e,t){if(void 0===t&&(t=!1),!this.editing){var n=Object.values(this.pressedMap).every((function(e){return!e}));n&&(this.opData={moveData:{originBorder:this.borderRect}}),this.dealOpStart({isStart:n,isEnd:!1}),this.pressedMap[e]=!0;var i=this.upime.view,r=i.x,o=i.y,a=i.scale,s=(("ArrowUp"===e?-1:"ArrowDown"===e&&1)||0)/a,l=(("ArrowLeft"===e?-1:"ArrowRight"===e&&1)||0)/a,c=l*(t?10:1),u=s*(t?10:1),d=this.getBorderBox(),p=d.top,h=d.left,f=d.right,m=d.bottom,v=(f+h)/2,g=(p+m)/2,y=this.upime.view.getViewbox();t&&(this.eleTransAlignWidget?(l&&(this.eleTransAlignWidget.x=null,this.eleTransAlignWidget.y=g),s&&(this.eleTransAlignWidget.y=null,this.eleTransAlignWidget.x=v),this.upime.updateWidgetCvs()):(this.eleTransAlignWidget=new oh(l?null:v,s?null:g),this.upime.view.addCanvasWidget(this.eleTransAlignWidget))),this.handleDirectMove({deltaX:c,deltaY:u,isStart:n,isEnd:!1}),this.updateBorderBox();var b=!1;v<y.left&&f<y.left?(this.upime.setViewPosScale(v+c,o),b=!0):v>y.right&&h>y.right&&(this.upime.setViewPosScale(r+v+c-y.right,o),b=!0),g<y.top&&m<y.top?(this.upime.setViewPosScale(this.upime.view.x,g+u),b=!0):g>y.bottom&&p>y.bottom&&(this.upime.setViewPosScale(this.upime.view.x,o+g+u-y.bottom),b=!0),(v<=y.left&&c<0||v>=y.right&&c>0||g<=y.top&&u<0||g>=y.bottom&&u>0)&&!b?this.upime.setViewPosScale(r+c,o+u):this.upime.updateView(),this.dealOpEnd({isStart:!1,isEnd:!1})}},e.prototype.handleDirectMove=function(e){this.elementsWillMove(e),this.handleAnyMove(e),this.elementsDidMove(e)},e.prototype.select=function(){var e=this;this.unsubList=[this.upime.subscribe("elementsLocked",(function(t){e.getElements().some((function(e){return t.includes(e.id)}))&&e.upime.clearSelect()})),this.upime.subscribe("elementsUpdated",(function(t){e.dealElementsUpdate(t)})),this.upime.subscribe("refSystemWillUnmount",(function(t){e.getElements().some((function(e){var n;return e.parentRefSystem===t||(null===(n=e.parentRefSystem)||void 0===n?void 0:n.isInRefSystem(t))}))&&e.upime.clearSelect()}))]},e.prototype.dealClickStart=function(e){},e.prototype.dealDeleteGroup=function(e){if(this.group){var t=this.group.members,n=this.getElements(),i=t.filter((function(e){return n.includes(e)}));i.length<t.length&&R([],t,!0).forEach((function(t){e.update(t,{groupId:null})}))}},e.prototype.dealHoverStart=function(e){this.updateCursor(null==e?void 0:e.metaData)},e.prototype.dealHoverEnd=function(){this.updateCursor()},e.prototype.dealTabKey=function(e){},e.prototype.dealEnterKey=function(e){},e.prototype.dealElementsUpdate=function(e){for(var t=!1,n=!1,i=!1,r=0,o=this.getElements();r<o.length;r++){var a=o[r].checkUpdateEffect(e);if(a){if(t=!0,a.moved){n=!0;break}if(a.deleted){i=!0;break}}}t&&this.updateBorderBox(),n?this.updateToolbarPos():i&&this.upime.clearSelect()},e.prototype.updateToolbarPos=function(){this.autoReposition&&this.toolbarAnchor++},e.prototype.getOp=function(){return this.editing&&this.currentOp?this.currentOp:this.upime.createOperation()},e.prototype.bringToFront=function(){var e=this.getOp(),t=this.getElements().filter((function(e){return e.elementType!==Za.FRAME})),n=t.map((function(e){return e.zIndex})).sort((function(e,t){return e-t})),i=this.upime.newMaxZindex(),r=this.upime.createLock(t.map((function(e){return e.id})));t.forEach((function(r){var o=n.indexOf(r.zIndex);if(r.elementType===Za.TABLE){var a=i+o-r.zIndex;r.getMembers().forEach((function(n){t.includes(n)||e.update(n,{zIndex:n.zIndex+a})}))}e.update(r,{zIndex:i+o})})),e.sync(),this.upime.clearLock(r)},e.prototype.sendToBack=function(){var e=this.getOp(),t=this.getElements().filter((function(e){return e.elementType!==Za.FRAME})),n=t.map((function(e){return e.zIndex})).sort((function(e,t){return e-t})),i=this.upime.newMinZindex(),r=this.upime.createLock(t.map((function(e){return e.id})));t.forEach((function(t){var r=n.indexOf(t.zIndex);e.update(t,{zIndex:i-r})})),e.sync(),this.upime.clearLock(r)},e.prototype.lockOtherElements=function(e){this.newLockedElements=this.newLockedElements.concat(e)},e.prototype.checkAddedLock=function(){if(this.newLockedElements.length){var e=this.currentLock,t=e.ids;this.upime.clearLock(e),this.currentLock=this.upime.createLock(R(R([],t,!0),this.newLockedElements.map((function(e){return e.id})),!0)),this.newLockedElements=[]}},e.prototype.updateProperty=function(e,t){var n=t||this.getOp(),i=this.getElements(),r=this.upime.createLock(i.map((function(e){return e.id})));i.forEach((function(t){return n.update(t,e)})),t||n.sync(),this.upime.clearLock(r)},e.prototype.slideUpdateProperty=function(e,t,n){void 0===n&&(n=!1);var i=this.getElements();this.dealOpStart(t);var r=this.currentOp;i.forEach((function(t){return r.update(t,e)})),this.dealOpEnd(t,n)},e.prototype.addUpdate=function(e,t){var n;null===(n=this.currentOp)||void 0===n||n.update(e,t)},e.prototype.syncUpdate=function(){var e;null===(e=this.currentOp)||void 0===e||e.sync()},e.prototype.onLockLost=function(){this.upime.clearSelect()},e.prototype.makeEleInSight=function(e){this.upime.makeBorderInSight(e,{left:90,right:20,top:60,bottom:60})},e.prototype.checkKeepRatio=function(e){return"nw"===e||"ne"===e||"sw"===e||"se"===e},e.prototype.checkPointDirection=function(e,t,n){return zt(e,t,n)},e.prototype.checkOuterBoxSelectRelation=function(e){return null},e.prototype.handleSelectCtrlRotate=function(e){},e.prototype.checkSelectRelation=function(e,t){var n=8/this.upime.view.scale,i=this.commRefSystem;if(!i)return Ot(e,this.getBorderBox(),n)?{transparent:this.enableTransparentInBox,metric:-1}:null;var r=this.getBorderBoxInRS();if(e=i.globalTransform.applyInverse(e),n/=i.globalTransform.currentScale,r.rotate){var o=r.left,a=r.top,s=r.right,l=r.bottom;e=an(e,-r.rotate,{x:(o+s)/2,y:(a+l)/2})}if(Ot(e,r,n)){var c=this.checkPointDirection(e,r,n),u={transparent:this.enableTransparentInBox,metric:-1};return c&&(u.metaData={resizeData:{direction:c,originBorder:r}},u.transparent=!1),u}return this.checkOuterBoxSelectRelation(e)},e.prototype.dealSelectCtrlEvt=function(e){this.updateCursorWhenMove(e),e.isEnd||(this.shiftKeyDown=e.originEvent.shiftKey),this.handleSelectCtrlEvt(e),e.isEnd&&(this.shiftKeyDown=!1)},e.prototype.handleSelectCtrlResize=function(e,t){var n=t.direction,i=t.originBorder,r=t.barrier,o=e.position,a=e.startPosition,s=this.commRefSystem;s&&(o=s.globalTransform.applyInverse(o),a=s.globalTransform.applyInverse(a));var l=this.checkKeepRatio(n),c=this.extraHeight,u=this.extraWidth,d=Gt(i,a,o,n,{keepRatio:l,minSize:this.getMinSize(n,e),noExtend:this.disableAntiResize,barrier:r,extraHeight:c,extraWidth:u}),p=(i.right-i.left-u)/(i.bottom-i.top-c),h=t.skipAlign?d:this.checkResizeAligns(e,t,s,o,d,l,p,i.rotate,r);this.handleAnyResize(e,t,h)},e.prototype.checkResizeAligns=function(e,t,n,i,r,o,a,s,l){if(void 0===a&&(a=0),s)return r;var c=n?n.globalTransform.applyBorderBox(exports.E(exports.E({},r),{rotate:s})):r;if(c.rotate)return r;var u=this.upime.view.scale,d=t.direction,p=t.originBorder,h=this.upime.view,f=h.renderingTree,m=h.renderingFrames,v=[],g=function(e){var t=e.left,n=e.top,i=e.right-t,r=e.bottom-n;i*r>100/u/u&&v.push(exports.E(exports.E({},e),{width:i,height:r}))},y=function(e){var t,n=e.refSystem,i=e.children;if(!(null===(t=n.baseElement)||void 0===t?void 0:t.selectStatus))for(var r=0;r<i.length;r++){var o=i[r];if(o.refSystem)y(o);else{var a=o;if(a.selectStatus||a.elementType===Za.CONNECTIONLINE||a.elementType===Za.MINDMAP_LINE||a.elementType===Za.GRID_TEXT)continue;g(a.getGlobalBox())}}};y(f);for(var b=0;b<m.length;b++){var E=m[b];E.selectStatus||g(E.getGlobalBox())}var x,w,C,S,k=c.left,_=c.right,T=c.bottom,I=c.top;l=l&&n?n.globalTransform.applyBorderBox(l):l;for(var P,N,M=function(e,t){return Math.abs(e-t)<=.01},A=function(e,t){return Math.abs(e-t)<=L&&t-e},D=_-k,B=T-I,L=4/u,O=0,F=0,z=0,H=0,U=!1,W=!1,V=!1,j=!1,G=new Map,q=0,K=0,Y=0,X=0,Q=-1!==d.search("e")&&i.x>p.left||-1!==d.search("w")&&i.x>p.right,Z=-1!==d.search("e")&&i.x<p.left||-1!==d.search("w")&&i.x<p.right,J=!o&&(-1!==d.search("n")&&i.y<p.bottom||-1!==d.search("s")&&i.y<p.top)||o&&("nw"===d&&i.x<p.right||"sw"===d&&i.x>p.right||"ne"===d&&i.x>p.left||"se"===d&&i.x<p.left),$=!o&&(-1!==d.search("n")&&i.y>p.bottom||-1!==d.search("s")&&i.y>p.top)||o&&("nw"===d&&i.x>p.right||"sw"===d&&i.x<p.right||"ne"===d&&i.x<p.left||"se"===d&&i.x>p.left),ee=0,te=v;ee<te.length;ee++){var ne,ie=te[ee],re=ie.width-D,oe=ie.height-B,ae=ie.left,se=ie.right,le=ie.top,ce=ie.bottom;Q&&!K&&(!1!==(ne=A(_,ae)||A(_,se)||A(_,(se+ae)/2))?(!l||l&&_+ne<=l.right)&&(w||(o?J?(!l||l&&I-ne/a>=l.top)&&(W=ne,Y=-ne/a):(!l||l&&T+ne/a<=l.bottom)&&(W=ne,X=ne/a):W=ne)):Math.abs(re)<=L&&!P&&!F&&(!l||l&&_+re>=l.left)&&(o?J?(!l||l&&I-re/a>=l.top)&&(P=ie.width,F=re,Y=-re/a):(!l||l&&T+re/a<=l.bottom)&&(P=ie.width,F=re,X=re/a):(P=ie.width,F=re))),Z&&!q&&(!1!==(ne=A(k,ae)||A(k,se)||A(k,(se+ae)/2))?(!l||l&&k+ne>=l.left)&&(x||(o?J?(!l||l&&I+ne/a>=l.top)&&(U=ne,Y=ne/a):(!l||l&&T-ne/a<=l.bottom)&&(U=ne,X=-ne/a):U=ne)):Math.abs(re)<=L&&!P&&!O&&(!l||l&&k-re>=l.left)&&(o?J?(!l||l&&I-re/a>=l.top)&&(P=ie.width,O=-re,Y=-re/a):(!l||l&&T+re/a<=l.bottom)&&(P=ie.width,O=-re,X=re/a):(P=ie.width,O=-re))),$&&!X&&(!1!==(ne=A(T,le)||A(T,ce)||A(T,(ce+le)/2))?(!l||l&&T+ne<=l.bottom)&&(S||(o?(Z||Q)&&(Z?(!l||l&&k-ne*a>=l.left)&&(j=ne,q=-ne*a):Q&&(!l||l&&_+ne*a<=l.right)&&(j=ne,K=ne*a)):j=ne)):Math.abs(oe)<=L&&!N&&!H&&(!l||l&&T+oe<=l.bottom)&&(o?(Z||Q)&&(Z?(!l||l&&k-oe*a>=l.left)&&(N=ie.height,H=oe,q=-oe*a):Q&&(!l||l&&_+oe*a<=l.right)&&(N=ie.height,H=oe,K=oe*a)):(N=ie.height,H=oe))),J&&!Y&&(!1!==(ne=A(I,le)||A(I,ce)||A(I,(ce+le)/2))?(!l||l&&I+ne>=l.top)&&(C||(o?(Z||Q)&&(Z?(!l||l&&k+ne*a>=l.left)&&(V=ne,q=ne*a):Q&&(!l||l&&_+ne*a<=l.right)&&(V=ne,K=-ne*a)):V=ne)):Math.abs(oe)<=L&&!N&&!z&&(!l||l&&I+oe<=l.bottom)&&(o?(Z||Q)&&(Z?(!l||l&&k-oe*a>=l.left)&&(N=ie.height,z=-oe,q=-oe*a):Q&&(!l||l&&_+oe*a<=l.right)&&(N=ie.height,z=-oe,K=oe*a)):(N=ie.height,z=-oe)))}var ue={left:c.left+(q||U||O),right:c.right+(K||W||F),top:c.top+(Y||V||z),bottom:c.bottom+(X||j||H)};v.forEach((function(e){var t=e.left,n=e.right,i=e.top,o=e.bottom;(M(ue.left,t)||M(ue.left,n)||M(ue.left,(n+t)/2))&&(!x||Math.abs(hh(e,r))<Math.abs(hh(x.border,r)))&&(x={border:e,value:ue.left}),(M(ue.right,t)||M(ue.right,n)||M(ue.right,(n+t)/2))&&(!w||Math.abs(hh(e,r))<Math.abs(hh(w.border,r)))&&(w={border:e,value:ue.right}),(M(ue.top,i)||M(ue.top,o)||M(ue.top,(o+i)/2))&&(!C||Math.abs(ph(e,r))<Math.abs(ph(C.border,r)))&&(C={border:e,value:ue.top}),(M(ue.bottom,i)||M(ue.bottom,o)||M(ue.bottom,(o+i)/2))&&(!S||Math.abs(ph(e,r))<Math.abs(ph(S.border,r)))&&(S={border:e,value:ue.bottom}),P&&M(P,e.width)&&(G.has(e)?G.set(e,exports.E(exports.E({},G.get(e)),{markWidth:!0})):G.set(e,{border:e,markWidth:!0})),N&&M(N,e.height)&&(G.has(e)?G.set(e,exports.E(exports.E({},G.get(e)),{markHeight:!0})):G.set(e,{border:e,markHeight:!0}))}));var de=x||w||C||S?{border:ue,topAlign:C,bottomAlign:S,leftAlign:x,rightAlign:w}:null,pe=null;return G.size&&(pe=R(R([],Array.from(G.values()),!0),[{border:ue,markWidth:!!P,markHeight:!!N}],!1)),pe&&x&&w&&pe.forEach((function(e){return e.markWidth=!1})),pe&&C&&S&&pe.forEach((function(e){return e.markHeight=!1})),e.isEnd?(this.resizeAlignWidgets&&(this.upime.view.removeSvgWidget(this.resizeAlignWidgets),this.resizeAlignWidgets=void 0),this.indirectResizeAlignWidgets&&(this.upime.view.removeSvgWidget(this.indirectResizeAlignWidgets),this.indirectResizeAlignWidgets=void 0)):(this.resizeAlignWidgets?de?this.resizeAlignWidgets.data=de:(this.upime.view.removeSvgWidget(this.resizeAlignWidgets),this.resizeAlignWidgets=void 0):de&&(this.resizeAlignWidgets=new up(de),this.upime.view.addSvgWidget(this.resizeAlignWidgets)),this.indirectResizeAlignWidgets?pe?this.indirectResizeAlignWidgets.infos=pe:(this.upime.view.removeSvgWidget(this.indirectResizeAlignWidgets),this.indirectResizeAlignWidgets=void 0):pe&&(this.indirectResizeAlignWidgets=new fp(pe),this.upime.view.addSvgWidget(this.indirectResizeAlignWidgets))),n?n.globalTransform.applyBorderBoxInverse(ue):ue},e.prototype.elementsWillMove=function(e){var t=this,n=this.currentOp;if(n&&e.isStart){var i=this.upime.view.elementsRoot,r=this.movingEles;this.originRefData=[],r.forEach((function(e){e.supportChangeRS&&e.parentRefSystem&&e.parentRefSystem!==i&&t.originRefData.push({element:e,refSystem:e.parentRefSystem,zIndex:e.zIndex}),e.frame&&!r.includes(e.frame)&&n.update(e,{frameId:null})})),this.updateCommRefSystem()}},e.prototype.elementsDidMove=function(e){var t=this,n=this.currentOp;if(n){var i=this.upime.view.elementsRoot,r=this.movingEles;r.forEach((function(e){return e._movingTag=!0}));for(var o=r.length,a=Yt(r.map((function(e){return e.getGlobalBox()}))),s=a?i.getRefSystemListIfBorderCross(a,(function(e){var t;return!e.unavailable&&!0!==(null===(t=e.baseElement)||void 0===t?void 0:t._movingTag)})):[],l=(new Date).valueOf(),c=!1,u=function(a){var u=a+d.breakIndex;if(u>=o&&(u-=o),!e.isEnd&&(new Date).valueOf()-l>=4)return c=!0,d.breakIndex=u,mr(d.deferRenderRequest),d.deferRenderRequest=fr((function(){t.elementsDidMove(e)})),"break";var p=r[u];if(p.elementType===Za.CONNECTIONLINE&&p.startElement&&p.endElement)return"continue";var h=p.supportChangeRS,f=!1;if(p.parentRefSystem&&p.parentRefSystem!==i){var m=p.getGlobalBox();p.parentRefSystem.checkBorderIn(m)?p.showInParentShadow=!e.isEnd:(p.showInParentShadow=!1,(E=p.calcTransformedUpdate(i)).zIndex=i.maxChildZindex+1,n.update(p,E),f=!0)}var v=void 0;if(p.parentRefSystem===i&&h&&!p.frame){for(var g=!1,y=(m=p.getGlobalBox(),s.length-1);y>=0;y--){var b=s[y];if(!g&&Hs(b,p)<0&&(g=!0),g&&b.baseElement&&!b.baseElement._movingTag&&b.level>p.refSystemLevel&&b.checkBorderIn(m)){v=b;break}}if(p.showInParentShadow=!!v&&!e.isEnd,v){var E=p.calcTransformedUpdate(v),x=d.originRefData.find((function(e){return e.element===p}));(null==x?void 0:x.refSystem)===v?E.zIndex=x.zIndex:E.zIndex=v.maxChildZindex+1,n.update(p,E),f=!0}}var w=p.connectionLines;f&&w&&w.forEach((function(e){var t=e,i=t.startElement,r=t.endElement;if(i===p&&r){var o=e.calcTransformedUpdate(p.parentRefSystem);o.zIndex=p.zIndex+1,e.frame&&(o.frameId=null),n.update(e,o)}}))},d=this,p=0;p<o&&"break"!==u(p);p++);c||(this.breakIndex=0),r.forEach((function(n){c||n.parentRefSystem!==i||n.elementType===Za.FRAME||t.checkFrameRelation(n,e),n._movingTag=!1})),e.isEnd&&(this.breakIndex=0,mr(this.deferRenderRequest),this.updateCommRefSystem(),this.originRefData=[])}},e.prototype.checkFrameRelation=function(e,t){var n=t.isEnd,i=this.currentOp,r=this.movingEles;if(i){var o=this.upime.view.elementsRoot;if(!(e.parentRefSystem&&e.parentRefSystem!==o||e.frame)){var a=e.getGlobalBox(),s=this.upime.elementManager.getAvailableFrames((function(e){return!e.hide})),l=null,c=void 0,u=e.group;if(!u||u.members.some((function(e){return"multi"!==e.selectStatus}))){if(e.isSupportFrame)for(y=s.length-1;y>=0;y--){var d=s[y];if(!r.includes(d)){var p=d.getBorderBox();c&&!qt(p,c)||!d.checkBorderInFrame(a)||(l=d,c=p)}}if(e.showInParentShadow=!!l&&!n,n){var h=l?l.id:null;h!==e.frameId&&i.update(e,{frameId:h})}}else{var f=u.members.filter((function(e){return e.selectStatus})).filter((function(e){return e.isSupportFrame})),m=u.members;if(0!==f.indexOf(e))return;for(var v=f.map((function(e){return e.getGlobalBox()})),g=function(e){var t=s[e];if(r.includes(t))return"continue";var n=t.getBorderBox();c&&!qt(n,c)||v.some((function(e){return t.checkBorderInFrame(e)}))&&(l=t,c=n)},y=s.length-1;y>=0;y--)g(y);if(m.forEach((function(e){return e.showInParentShadow=!!l&&!n})),n){var b=l?l.id:null;m.forEach((function(e){b!==e.frameId&&i.update(e,{frameId:b})}))}}}}},e.prototype.checkBeforeMove=function(e){var t,n=e.isStart,i=e.isEnd,r=e.startPosition,o=e.position,a=o.x-r.x,s=o.y-r.y,l=null===(t=this.opData)||void 0===t?void 0:t.moveData,c=l.originBorder,u=c;1===this.movingEles.length&&this.movingEles[0].rotate&&(c=Sn(c,this.movingEles[0].rotate));var d={left:c.left+a,top:c.top+s,right:c.right+a,bottom:c.bottom+s};d=this.checkAlignGap(d,{isStart:n,isEnd:i})||d,1===this.movingEles.length&&this.movingEles[0].rotate&&(a=d.left-c.left,s=d.top-c.top,d={left:u.left+a,top:u.top+s,right:u.right+a,bottom:u.bottom+s});var p=l.preBorder||l.originBorder;return l.preBorder=d,{isStart:n,isEnd:i,deltaX:d.left-p.left,deltaY:d.top-p.top,event:e}},e.prototype.checkAlignGap=function(e,t){var n=this.upime.view.getViewbox(),i=n.scale,r=this.movingEles,o=e.left,a=e.top,s=e.right,l=e.bottom,c=(a+l)/2,u=(o+s)/2,d=100/i/i,p=4/i,h=4/i;function f(t){return t.sort((function(t,n){var i=t.border,r=n.border;return Math.abs(ph(i,e))-Math.abs(ph(r,e))}))[0]}function m(t){return t.sort((function(t,n){var i=t.border,r=n.border;return Math.abs(hh(i,e))-Math.abs(hh(r,e))}))[0]}var v=[],g=this.upime.view,y=g.renderingTree,b=g.renderingFrames,E=function(e){Kt(e=Sn(e,e.rotate),n)&&v.push(e)},x=function(e){var t=e.refSystem,n=e.children;if(!t.baseElement||!r.includes(t.baseElement))for(var i=0;i<n.length;i++){var o=n[i];if(o.refSystem)x(o);else{var a=o;if(r.includes(a)||a.elementType===Za.CONNECTIONLINE||a.elementType===Za.MINDMAP_LINE||a.elementType===Za.GRID_TEXT||a.elementType===Za.MINDMAP_NODE&&a.isMindmapNodeHideByCollapsed)continue;E(a.getGlobalBox())}}};x(y);for(var w=0,C=b;w<C.length;w++){var S=C[w];r.includes(S)||E(S.getGlobalBox())}var k=v.filter((function(e){return(e.right-e.left)*(e.bottom-e.top)>d})),_=[];k.forEach((function(e){var t=(e.top+e.bottom)/2;Math.abs(t-c)<=p&&_.push({border:e,value:t})}));var T=f(_);if(T){var I=T.value-c;a+=I,l+=I,p=0}var P=[];k.forEach((function(e){Math.abs(e.top-a)<=p+.01?P.push({border:e,value:e.top}):Math.abs(e.bottom-a)<=p+.01&&P.push({border:e,value:e.bottom})}));var N=f(P);N&&p>0&&(I=N.value-a,a+=I,l+=I,p=0);var M=[];k.forEach((function(e){Math.abs(e.top-l)<=p+.01?M.push({border:e,value:e.top}):Math.abs(e.bottom-l)<=p+.01&&M.push({border:e,value:e.bottom})}));var A=f(M);A&&p>0&&(I=A.value-l,a+=I,l+=I,p=0);var D=[];k.forEach((function(e){var t=(e.left+e.right)/2;Math.abs(t-u)<=h&&D.push({border:e,value:t})}));var B=m(D);if(B){var L=B.value-u;o+=L,s+=L,h=0}var O=[];k.forEach((function(e){Math.abs(e.left-o)<=h+.01?O.push({border:e,value:e.left}):Math.abs(e.right-o)<=h+.01&&O.push({border:e,value:e.right})}));var F=m(O);F&&h>0&&(L=F.value-o,o+=L,s+=L,h=0);var z=[];k.forEach((function(e){Math.abs(e.left-s)<=h+.01?z.push({border:e,value:e.left}):Math.abs(e.right-s)<=h+.01&&z.push({border:e,value:e.right})}));var H=m(z);H&&h>0&&(L=H.value-s,o+=L,s+=L,h=0),e={left:o,top:a,right:s,bottom:l},c=(a+l)/2,u=(o+s)/2;var U=T||N||A||B||F||H?{border:e,vCenterAlign:T,topAlign:N,bottomAlign:A,hCenterAlign:B,leftAlign:F,rightAlign:H}:null;t.isEnd?this.alignWidget&&(this.upime.view.removeSvgWidget(this.alignWidget),this.alignWidget=void 0):this.alignWidget?U?this.alignWidget.data=U:(this.upime.view.removeSvgWidget(this.alignWidget),this.alignWidget=void 0):U&&(this.alignWidget=new up(U),this.upime.view.addSvgWidget(this.alignWidget));var W=8/i;function V(e,t){return t.left<=e.left+.01&&t.right>=e.right-.01&&t.top>=e.top-.01&&t.bottom<=e.bottom+.01}function j(e,t){return t.left>=e.left-.01&&t.right<=e.right+.01&&t.top<=e.top+.01&&t.bottom>=e.bottom-.01}var G=function(e,t,n){function i(e){var t=n?u:c,i=e.diffSide,r=e.sameSide,o=r.borders.length,a=o?Math.abs(r.gapLine-t):1/0;return[i?Math.abs(i.gapLine-t):1/0,a,-o]}for(var r=i(e),o=i(t),a=0;a<r.length;a++)if(r[a]!==o[a])return r[a]<o[a]?-1:1;return 0},q=[],K=[];v.forEach((function(t){if(0===ph(t,e)){var n=hh(t,e);n<0?q.push(exports.E(exports.E({},t),{distance:n})):n>0&&K.push(exports.E(exports.E({},t),{distance:n}))}}));var Y,X=R(R([],q,!0),K,!0);if(q.length+K.length>1&&q.length<200&&K.length<200){q.sort((function(e,t){return t.distance-e.distance})),K.sort((function(e,t){return e.distance-t.distance}));var Q=function(t){for(var n=t?q:K,i=t?K:q,r=function(r){var c=n[r],d=Math.abs(c.distance);if(d<W)return"continue";var h,f=Math.max(c.left,o),m=Math.min(c.right,s),v={left:f,right:m,top:t?c.top:l,bottom:t?a:c.bottom};if(X.some((function(e){return e!==c&&V(v,e)})))return"continue";for(var g=0,y=0,b=0,E=function(i,r,o,s,u,d){for(var p=!1,f=function(r){var f=n[r],m=Math.abs(hh(f,i));if(m>o+s+.01)return"break";if(m<W||m<o-s-.01||f.right<u.left||f.left>u.right)return"continue";var v={left:Math.max(f.left,u.left),right:Math.min(f.right,u.right),top:t?f.top:l,bottom:t?a:f.bottom};if(X.some((function(e){return e!==f&&e!==c&&!d.includes(e)&&V(v,e)})))return"continue";if(0!==s&&(o=m),p=!0,r==n.length-1||!E(f,r,o,0,v,R(R([],d,!0),[f],!1))){var g=(v.left+v.right)/2,y=h?{border:h,gapLine:b}:void 0,x={border:e,gap:t?-o:o,jumpBorder:c,sameSide:{borders:R(R([],d,!0),[f],!1),gapLine:g},diffSide:y};(!Y||G(x,Y,!0)<0)&&(Y=x)}},m=r+1;m<n.length&&"break"!==f(m);m++);return p},x=function(n){var r=i[n],o=Math.abs(hh(r,e));if(o>d+2*p+.01)return"break";if(o<=W||r.right<f||r.left>m||o<d-2*p-.01)return"continue";var s={left:Math.max(r.left,f),right:Math.min(r.right,m),top:t?l:r.top,bottom:t?r.bottom:a};if(X.some((function(e){return e!==r&&V(s,e)})))return"continue";o=(o+d)/2;var c=(s.left+s.right)/2,v=Math.abs(c-u);(!h||v<g)&&(h=r,y=o,b=c,g=v)},w=0;w<i.length&&"break"!==x(w);w++);if(h){if(!E(c,r,y,0,v,[])){var C={border:e,gap:t?-y:y,jumpBorder:c,sameSide:{borders:[],gapLine:0},diffSide:{border:h,gapLine:b}};(!Y||G(C,Y,!0)<0)&&(Y=C)}return"continue"}for(w=r+1;w<n.length;w++)E(c,r,d,p,v,[])},c=0;c<n.length;c++)r(c)};if(Q(!0),Q(!1),Y&&p){var Z=Y.gap,J=Y.jumpBorder;I=Z<0?J.bottom-Z-e.top:J.top-Z-e.bottom,l+=I,a+=I,c+=I,Y.border={left:o,top:a,right:s,bottom:l},p=0}}var $=[],ee=[];v.forEach((function(t){if(0===hh(t,e)){var n=ph(t,e);n<0?$.push(exports.E(exports.E({},t),{distance:n})):n>0&&ee.push(exports.E(exports.E({},t),{distance:n}))}}));var te,ne=R(R([],$,!0),ee,!0);return $.length+ee.length>1&&$.length<200&&ee.length<200&&($.sort((function(e,t){return t.distance-e.distance})),ee.sort((function(e,t){return e.distance-t.distance})),Q=function(t){for(var n=t?$:ee,i=t?ee:$,r=function(r){var u=n[r],d=Math.abs(u.distance);if(d<W)return"continue";var p,f={left:t?u.left:s,right:t?o:u.right,top:Math.max(u.top,a),bottom:Math.min(u.bottom,l)};if(ne.some((function(e){return e!==u&&j(f,e)})))return"continue";for(var m=0,v=0,g=0,y=function(i,r,a,l,c,d){for(var h=!1,f=function(r){var f=n[r],m=Math.abs(ph(f,i));if(m>a+l+.01)return"break";if(m<W||m<a-l-.01||0!==hh(f,c))return"continue";var v={left:t?f.left:s,right:t?o:f.right,top:Math.max(f.top,c.top),bottom:Math.min(f.bottom,c.bottom)};if(ne.some((function(e){return e!==f&&e!==u&&!d.includes(e)&&j(v,e)})))return"continue";if(0!==l&&(a=m),h=!0,r==n.length-1||!y(f,r,a,0,v,R(R([],d,!0),[f],!1))){var b=(v.top+v.bottom)/2,E=p?{border:p,gapLine:g}:void 0,x={border:e,gap:t?-a:a,jumpBorder:u,sameSide:{borders:R(R([],d,!0),[f],!1),gapLine:b},diffSide:E};(!te||G(x,te,!1)<0)&&(te=x)}},m=r+1;m<n.length&&"break"!==f(m);m++);return h},b=function(n){var r=i[n],a=Math.abs(ph(r,e));if(a>d+2*h+.01)return"break";if(a<=W||0!==hh(r,f)||a<d-2*h-.01)return"continue";var l={left:t?s:r.left,right:t?r.right:o,top:Math.max(r.top,f.top),bottom:Math.min(r.bottom,f.bottom)};if(ne.some((function(e){return e!==r&&j(l,e)})))return"continue";a=(a+d)/2;var u=(l.top+l.bottom)/2,y=Math.abs(u-c);(!p||y<m)&&(p=r,v=a,g=u,m=y)},E=0;E<i.length&&"break"!==b(E);E++);if(p){if(!y(u,r,v,0,f,[])){var x={border:e,gap:t?-v:v,jumpBorder:u,sameSide:{borders:[],gapLine:0},diffSide:{border:p,gapLine:g}};(!te||G(x,te,!1)<0)&&(te=x)}return"continue"}for(E=r+1;E<n.length;E++)y(u,r,d,h,f,[])},u=0;u<n.length;u++)r(u)},Q(!0),Q(!1),te&&h&&(Z=te.gap,J=te.jumpBorder,L=Z<0?J.right-Z-e.left:J.left-Z-e.right,o+=L,s+=L,u+=L,te.border={left:o,top:a,right:s,bottom:l},h=0)),t.isEnd?this.gapWidget&&(this.upime.view.removeSvgWidget(this.gapWidget),this.gapWidget=void 0):this.gapWidget?Y||te?this.gapWidget.data={vertiData:Y,horizData:te}:(this.upime.view.removeSvgWidget(this.gapWidget),this.gapWidget=void 0):(Y||te)&&(this.gapWidget=new pp({vertiData:Y,horizData:te}),this.upime.view.addSvgWidget(this.gapWidget)),{left:o,top:a,right:s,bottom:l}},e.prototype.unselect=function(){this.alignWidget&&(this.upime.view.removeSvgWidget(this.alignWidget),this.alignWidget=void 0),this.resizeAlignWidgets&&(this.upime.view.removeSvgWidget(this.resizeAlignWidgets),this.alignWidget=void 0),this.indirectResizeAlignWidgets&&(this.upime.view.removeSvgWidget(this.indirectResizeAlignWidgets),this.indirectResizeAlignWidgets=void 0),this.gapWidget&&(this.upime.view.removeSvgWidget(this.gapWidget),this.gapWidget=void 0),this.unsubList&&(this.unsubList.forEach((function(e){return e()})),this.unsubList=void 0),this.upime.view.setCursor("",this),this.getElements().forEach((function(e){return e.showSelected=!1})),this.currentOp&&(this.currentOp.sync(),this.currentOp=void 0),this.currentLock&&(this.upime.clearLock(this.currentLock),this.currentLock=void 0),this.cross._bounceAnimation&&mr(this.cross._bounceAnimation),this.cross._bounceAnimation=null,this.eleTransAlignWidget&&this.upime.view.removeCanvasWidget(this.eleTransAlignWidget),this.eleTransAlignWidget=null},e.prototype.getCursor=function(e){var t="";if(e.resizeData){var n=e.resizeData.direction,i=this.directCtrlElements;switch(1===i.length&&(n=function(e,t){if(!e)return e;t<0&&(t=(t+360)%360);var n=["n","ne","e","se","s","sw","w","nw"],i=t/45|0,r=t/45-i>=.5?i+1:i;return n[(n.indexOf(e)+r)%n.length]}(n,i[0].getGlobalBox().rotate||0)),n){case"n":case"s":t="ns-resize";break;case"e":case"w":t="ew-resize";break;case"ne":case"sw":t="nesw-resize";break;case"nw":case"se":t="nwse-resize"}}else e.selectingText&&(t="text");return t},e.prototype.getResizingElements=function(){return this.getElements()},e.prototype.getMovingElements=function(){var e=this.directCtrlElements,t=this.upime.view.elementsRoot,n=e.filter((function(e){return e.elementType===Za.FRAME})),i=R([],n,!0),r=[];n.forEach((function(e){e.getMembers().forEach((function(e){e.unavailable||(e.elementType===Za.CONNECTIONLINE?r.push(e):i.push(e))}))})),e.forEach((function(e){var n=e.parentRefSystem||t;e.elementType===Za.CONNECTIONLINE?r.includes(e)||r.push(e):i.find((function(t){var i;return t===e||(null===(i=n.parentRefSystem)||void 0===i?void 0:i.isInRefSystemOfElement(t))}))||i.push(e)}));var o=i.filter((function(e){return e.elementType===Za.MINDMAP_NODE}));lp(o).forEach((function(e){e.getDescendants((function(e){return!e.locked&&!e.isMindmapNodeHideByCollapsed})).forEach((function(e){e.unavailable||i.includes(e)||i.push(e)}))})),R([],i,!0).forEach((function(e){var t=e.connectionLines;void 0!==t&&t.forEach((function(t){var n=t;t.unavailable||t.deleted||t.elementType!==Za.CONNECTIONLINE||r.includes(t)||(n.startElement===e&&n.endElement&&i.includes(n.endElement)||n.endElement===e&&n.startElement&&i.includes(n.startElement))&&r.push(t)}))}));var a=function(e){return e===Za.CONNECTIONLINE?1:0};return i.sort((function(e,t){return a(e.elementType)-a(t.elementType)})),i=R(R([],i,!0),r,!0)},e.prototype.dealOpStart=function(e){var t,n;if(e.isStart){var i=this.getElements();if(null===(t=this.opData)||void 0===t?void 0:t.moveData){this.movingEles=this.getMovingElements();for(var r=0,o=this.movingEles;r<o.length;r++){var a=o[r];!i.includes(a)&&i.push(a)}}else if(null===(n=this.opData)||void 0===n?void 0:n.resizeData){this.resizingEles=this.getResizingElements();for(var s=0,l=this.resizingEles;s<l.length;s++)a=l[s],!i.includes(a)&&i.push(a)}if(this.editing&&this.currentOp)return;var c=i.map((function(e){return e.id}));this.currentOp=this.upime.createOperation(),this.currentLock=this.upime.createLock(c)}},e.prototype.dealOpEnd=function(e,t){if(this.checkAddedLock(),!t&&this.syncUpdate(),e.isEnd){if(t&&this.syncUpdate(),this.movingEles=[],this.resizingEles=[],this.editing)return;this.currentOp=void 0,this.upime.clearLock(this.currentLock),this.currentLock=void 0}},e.prototype.handleSelectCtrlEvt=function(e){var t,n;this.dealOpStart(e),(null===(t=this.opData)||void 0===t?void 0:t.resizeData)?this.handleSelectCtrlResize(e,this.opData.resizeData):(null===(n=this.opData)||void 0===n?void 0:n.rotateData)?this.supportRotate&&this.handleSelectCtrlRotate(e):(this.elementsWillMove(e),!this.upime.viewLocked&&this.cross.checkMoveBorderCondition(e),this.cross._xBounceDelta||this.cross._yBounceDelta||this.handleSelectCtrlMove(e),this.elementsDidMove(e)),this.updateBorderBox(),this.dealOpEnd(e)},e.prototype.updateBorderBox=function(){this.borderRect=this.getBorderBox(),this.updateToolbarPos()},e.prototype.updateCursor=function(e){var t=this.upime.view,n="";e&&(n=this.getCursor(e)),t.setCursor(n,this)},e.prototype.updateCursorWhenMove=function(e){e.isStart?this.updateCursor(this.opData):e.isEnd&&this.updateCursor()},e.prototype.unfrozeElement=function(){this.frozed=!1,this.updateProperty({frozedGroupId:null,unFrozenRoles:null}),this.updateToolbarPos()},e.prototype.updateUnfrozenAccess=function(e){this.updateProperty({unFrozenRoles:e})},e.prototype.updateFrameUnHideRoles=function(e){var t=this.frames.filter((function(e){return e.hide}));if(t){var n=this.getOp(),i=this.upime.createLock(t.map((function(e){return e.id})));t.forEach((function(t){return n.update(t,{unHideRoles:e})})),n.sync(),this.upime.clearLock(i),this.upime.updateView()}},Object.defineProperty(e.prototype,"couldCreateFrame",{get:function(){var e=this.getElements();if(e.every((function(e){return e.position.parentType})))return!1;if(e.every((function(e){return!e.isSupportFrame})))return!1;var t=e.filter((function(e){return!e.position.parentType}));return!(1===t.length&&t[0].elementType===Za.FRAME)},enumerable:!1,configurable:!0}),e}(),mh=[];function vh(e){var t=e.target,n=mh.filter((function(n){return!(n.checkSkip&&n.checkSkip(t)||n.skipElements&&void 0!==n.skipElements.find((function(e){return V(e,t)}))||!n.quick&&"mousedown"==e.type||!n.quick&&"touchstart"==e.type||n.quick&&"click"==e.type||n.quick&&"touchend"==e.type)}));mh=mh.filter((function(e){return!e.once||n.indexOf(e)<0})),n.forEach((function(t){return t.cb(e)}))}try{document.addEventListener("click",vh,{capture:!0}),document.addEventListener("touchstart",vh,{capture:!0}),document.addEventListener("mousedown",vh,{capture:!0}),document.addEventListener("touchend",vh,{capture:!0})}catch(VS){}function gh(e,t){var n=exports.E(exports.E({},t),{cb:e});return mh.push(n),function(){mh=mh.filter((function(e){return e!==n}))}}function yh(t,n){void 0===n&&(n={});var i=e.useRef(null),r=e.useRef(null),o=e.useState(t),a=o[0],s=o[1],l=e.useRef(a);e.useEffect((function(){var e;null===(e=r.current)||void 0===e||e.call(r,l.current,a),l.current=a}),[a]),e.useEffect((function(){if(!a)return gh((function(){s(!0)}),exports.E({skipElements:i.current?[i.current]:void 0},n))}),[a]);var c=e.useCallback((function(){return s(!a)}),[a]),u=e.useCallback((function(e){return r.current=e,function(){return r.current=null}}),[]);return{hide:a,setHide:s,toggleHide:c,skipRef:i,onChange:u}}var bh=function(t,n){return void 0===t&&(t=""),{sects:e.useMemo((function(){if(t&&n){var e=n.split(t);if(e.length){var i=[];return e.forEach((function(n,r){n&&i.push({value:n,highlight:!1}),r<e.length-1&&i.push({value:t,highlight:!0})})),i}return[{value:n,highlight:!1}]}return[{value:n,highlight:!1}]}),[t,n])}},Eh={"editor-toolbar":"editor-toolbar_1xxMY","property-editors":"property-editors_3pHVk","property-editor":"property-editor_2_Xm-",draggableWrapper:"draggableWrapper_EjxIy",dragIcon:"dragIcon_1grwA",cloneIconBtn:"cloneIconBtn_f86rL",delIconBtn:"delIconBtn_3R1LT",hideFrameBtn:"hideFrameBtn_1EiLY",collapseRight:"collapseRight_1wxRG",subwindow_box:"subwindow_box_27JuW","split-line":"split-line_3duOQ","more-ctrl":"more-ctrl_15shJ","sub-win":"sub-win_3DLea",center:"center_2c-Gz",right:"right_17t8u","ctrl-list":"ctrl-list_3Vmiy",divider:"divider_3aRg_","ctrl-option":"ctrl-option_3Tvb5",disabled:"disabled_2JCCv",unFrozenRoot:"unFrozenRoot_2pgkY",unFrozenContainer:"unFrozenContainer_3Ztnd",background:"background_zbxF8",cover:"cover_2m2XB",triangle:"triangle_2SX9H",expandPanel:"expandPanel_1XI-P",row:"row_3mrY3",disableIconCon:"disableIconCon_3tDxt",longPressAnimation:"longPressAnimation_3oQM2",longPress:"longPress_2jP1O",lockIcon:"lockIcon_iD4pp",alignRoot:"alignRoot_1n1Sa",left:"left_i0I-R",iconCon:"iconCon_3ZDXb",aiIconWrapper:"aiIconWrapper_2VAQS",aiIconContainer:"aiIconContainer_2FRo2",aiOptionPhoneWrapper:"aiOptionPhoneWrapper_1-zhE",aiOptionsContainer:"aiOptionsContainer_o9bX-",aiOptionRow:"aiOptionRow_3y2Z8",aiOptionIcon:"aiOptionIcon_1qFMC",arrow:"arrow_1vXV1",childrenOptionContainer:"childrenOptionContainer_38HP1",childRow:"childRow_3acRw",phoneToolbarEditorContainer:"phoneToolbarEditorContainer_3DdsS",pwa:"pwa_1lILK",inMetting:"inMetting_PnI4E",phoneToolbarBar:"phoneToolbarBar_IwP6I",phoneToolBarInner:"phoneToolBarInner_1jgOr",extraBtWrapper:"extraBtWrapper_g8vmN",hide:"hide_3wqEf",extraBtContainer:"extraBtContainer_rNRo5",shadowBar:"shadowBar_1W1Bt",phoneToolbarSubWindowEditorContainer:"phoneToolbarSubWindowEditorContainer_lw8XJ","menu-phone-container":"menu-phone-container_3HAnO",menu_phone_row:"menu_phone_row_3hvqr",danger:"danger_37bXB",editor_toolbar:"editor-toolbar_1xxMY",property_editors:"property-editors_3pHVk",property_editor:"property-editor_2_Xm-",split_line:"split-line_3duOQ",more_ctrl:"more-ctrl_15shJ",sub_win:"sub-win_3DLea",ctrl_list:"ctrl-list_3Vmiy",ctrl_option:"ctrl-option_3Tvb5",menu_phone_container:"menu-phone-container_3HAnO"},xh=function(t){var n=t.align,i=void 0===n?"left":n,r=t.className,o=t.children,a=t.selfAdjust,s=t.adjustInfo,l=void 0===s?{adjustType:"adjustPos"}:s,c=t.topGap,u=t.forceTop,d=t.extraStyle,p=void 0===d?{}:d,h=e.useContext(Ic).phoneLayout;h&&void 0===a&&(a=!0),h&&void 0===c&&(c=8);var f=e.useRef(null),m=e.useState(a?{visibility:"hidden"}:{}),v=m[0],g=m[1],y=e.useContext(Ic).rootContainer,b=e.useContext(xl).upime;e.useEffect((function(){if(a){var e=function(){var e={};switch(l.adjustType){case"adjustHeight":e=E(l.config);break;case"adjustPos":e=x();break;case"adjustCustomContainer":e=w(l.container);break;case"adjustByOutside":e=l.calcStyle(f.current)}g(e)},t=Od((function(){e()}),b);return e(),function(){t()}}}),[]);var E=function(e){var t,n,i={};if(a&&f.current&&y.current){var r=f.current.getBoundingClientRect().bottom-y.current.getBoundingClientRect().top-56-8;i={height:Math.max(null!==(t=e.minHeight)&&void 0!==t?t:332,Math.min(r,null!==(n=e.maxHeight)&&void 0!==n?n:520)),top:"unset"}}return i},x=function(){var e={};if(a&&f.current&&y.current){var t=f.current.parentElement.getBoundingClientRect(),n=t.right,i=t.top;t.left;var r=t.width,o=t.height,s=y.current.getBoundingClientRect(),l=s.right,d=s.bottom,p=s.left,h=f.current.getBoundingClientRect(),m=h.right,v=h.width,g=h.height,b=h.left,E=h.bottom,x=f.current.style.bottom;if(x&&(E+=parseInt(x||"0")+o),u)e={bottom:o+(c||0),top:"unset"},n+v>l&&(e=exports.E(exports.E({},e),{left:r-(n+v-l),right:"unset"}));else if(E>d)if(i>g)e={bottom:o+(c||0),top:"unset"},n+v>l&&(e=exports.E(exports.E({},e),{left:r-(n+v-l),right:"unset"}));else{var w=E-d;e=n+v<l?{left:r,right:"unset",top:o-w}:{left:r-(n+v-l),right:"unset",top:o-w}}else m>l?e={left:r-(n+v-l),right:"unset",transform:"unset"}:b<p&&(e={left:0,right:"unset"})}return e},w=function(e){var t={};if(a&&f.current&&e){var n=f.current.parentElement.getBoundingClientRect();n.right,n.top,n.left,n.width,n.height;var i=e.getBoundingClientRect();i.right;var r=i.bottom;i.left;var o=f.current.getBoundingClientRect();o.right;var s=o.bottom;o.width;var l=o.height;o.left,s>r&&(t={top:"-".concat(l+1,"px")})}return t};return e.createElement("div",{className:j(Eh.sub_win,r,Eh[i]),style:Object.assign({},v,p),ref:f},o)};function wh(e){return e<1e3?e.toString():(e/1e3).toFixed(1)+"k"}function Ch(e){return e<10?"0".concat(e):"".concat(e)}var Sh=function(t){var n=t.editor,i=t.upime,r=W().getUpimeTrans,o=yh(!0),a=o.hide,s=o.skipRef,l=o.toggleHide,c=e.useMemo((function(){return wh(Object.values(n.elesStatistics).reduce((function(e,t){return e+t.count}),0))}),[]),u=e.useMemo((function(){return Object.entries(n.elesStatistics).filter((function(e){return+e[0]!==Za.GRID_TEXT})).map((function(e){var t=e[0],n=e[1],i=n.count;return{elements:n.elements,count:i,icon:xp(+t),label:yp(+t,r),type:+t}})).sort((function(e,t){return t.count-e.count}))}),[n.elesStatistics]);return e.createElement("div",{ref:s},e.createElement("div",{onClick:l,className:"root_3DPyd"},e.createElement("div",{className:"left_2qXUo"},e.createElement("span",null," ",r("element.filter")),e.createElement("span",null,r("element.count",c))),e.createElement(hl,{icon:"jiantou-xia",className:j("right_3Ruxk",!a&&"opened_3T5W7")})),a?null:e.createElement(xh,{align:"left",className:"panel_2P1m_"},u.map((function(t){var n=t.label,r=t.count,o=t.elements,a=t.icon,s=t.type;return e.createElement("div",{className:"row__aWcC",key:s,onClick:function(){return function(e){i.clearSelect(),i.selectElements(e)}(o)}},e.createElement(hl,{icon:a}),e.createElement("span",{className:"label_14vlO"},n),e.createElement("span",{className:"count_2QEU3"},r))}))))},kh=function(e){function t(t,n){var i=e.call(this,t)||this;i.renderer=ms,i.domRenderer=xb,i.supportZindex=!0,i.visiable=!1,i.toolbarAnchor=0,i.frozed=!1,i.hasGroup=!1,i.allSameGroup=!1,i.allSameFrame=!0,i.couldFilter=!1,i.elesStatistics={},i.movingEditors=[],i.resizingEditors=[],i._hasFrame=!1,i._hasMindMap=!1,i._satisfyMindNodeResize=!0,i.elements=R([],n,!0);var r=!1,o=!1;return i.commRefSystem=null,i.directCtrlElements=[],i.updateCommRefSystem(),i.eleEditors=i.elements.map((function(e,n){var a,s=i.getElementType(e);s===Za.FRAME&&(r=!0),s===Za.MINDMAP_NODE&&(o=!0),s!==Za.MINDMAP_LINE&&(i.elesStatistics[s]?(null===(a=i.elesStatistics[s])||void 0===a||a.elements.push(e),i.elesStatistics[s].count+=1):i.elesStatistics[s]={elements:[e],count:1});var l=new e.editorType(t,e,i);if(e.currentEditor=l,n){if(i.propertyEditors.length){var c=l.propertyEditors.reduce((function(e,t){return t.couldAffectGroup&&!1!==t.available?R(R([],e,!0),[t.propertyName],!1):e}),[]);i.propertyEditors=i.propertyEditors.filter((function(e){return c.includes(e.propertyName)}))}}else i.propertyEditors=R([],l.propertyEditors.filter((function(e){return e.couldAffectGroup})),!0),i.upime.phoneMode&&"phone"===i.phoneToolbarMode&&(i.propertyEditors=i.propertyEditors.filter((function(e){return"textStyle"!==e.propertyName})));return l})),i.checkSameFrame(),i.checkGroup(),i.hasFrame=r,i.hasMindMap=o,i.borderRect=i.getBorderBox(),i.renderKey="multi-selected-rect-".concat(Date.now()),i.frozed=n.some((function(e){return!!e.frozedGroup})),i.couldFilter=Object.keys(i.elesStatistics).length>=2,i}return P(t,e),Object.defineProperty(t.prototype,"couldAddComment",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportDownload",{get:function(){var e=this;return!1===this.elements.some((function(t){return t.elementType!==Za.IMAGE&&!1===new t.editorType(e.upime,t).supportDownload}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canGroup",{get:function(){return this.allSameFrame&&!this.allSameGroup&&!this.group&&this.allInGlobalRs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canSplitGroup",{get:function(){return this.hasGroup&&!this.group},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frameHided",{get:function(){return this.elements.some((function(e){return e.elementType===Za.FRAME&&e.hide}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizable",{get:function(){return!this.frameHided&&this._satisfyMindNodeResize&&!!this.commRefSystem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canAlignGroup",{get:function(){return!this.elements.some((function(e){return e.elementType===Za.CONNECTIONLINE&&e.startElement||e.endElement}))&&!this.hasMindMap&&this.allInGlobalRs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canDistributeGroup",{get:function(){if(!this.canAlignGroup)return!1;for(var e=[],t=[],n=0,i=this.elements;n<i.length;n++){var r=i[n];if(r.elementType===Za.CONNECTIONLINE)return!1;if(r.groupId)e.includes(r.groupId)||e.push(r.groupId);else if(t.push(r),e.length+t.length>=3)return!0}return!1},enumerable:!1,configurable:!0}),t.prototype.getMovingEditors=function(){return this.movingEditors},Object.defineProperty(t.prototype,"hasFrame",{get:function(){return this._hasFrame},set:function(e){this._hasFrame=e,this.supportZindex=!e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasMindMap",{get:function(){return this._hasMindMap},set:function(e){this._hasMindMap=e;var t=!0,n=this.elements.filter((function(e){return Za.MINDMAP_NODE===e.elementType}));if(n.length>0){t=!1;var i=[],r=[];n.forEach((function(e){e.isRootNode?i.push(e):r.push(e)}));var o=0;i.forEach((function(e){o+=e.getDescendants().filter((function(e){return!e.isMindmapNodeHideByCollapsed})).length})),0===lp(n,!0).length&&o===r.length&&(t=!0)}this._satisfyMindNodeResize=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return this.eleEditors.some((function(e){return e.isSupportAI}))},enumerable:!1,configurable:!0}),t.prototype.getElementType=function(e){return e.elementTypeMask||e.elementType},t.prototype.makeGroup=function(){if(!this.hasMindMap){var e=this.elements,t=this.upime,n=this.getOp(),i=this.upime.genID("g"),r=t.createLock(e.map((function(e){return e.id})));e.forEach((function(e){return n.update(e,{groupId:i})})),n.sync(),t.clearLock(r),this.hasGroup=!0,this.allSameGroup=!0}},t.prototype.splitGroup=function(){var e=this.elements,t=this.upime,n=this.getOp(),i=t.createLock(e.map((function(e){return e.id})));e.forEach((function(e){e.groupId&&n.update(e,{groupId:null})})),n.sync(),t.clearLock(i),this.hasGroup=!1,this.allSameGroup=!1},t.prototype.checkSameFrame=function(){var e,t=this.elements,n=null===(e=t.find((function(e){return null!==e.frameId})))||void 0===e?void 0:e.frameId;n&&t.some((function(e){return e.elementType===Za.FRAME?e.id!==n:e.frameId!==n}))?this.allSameFrame=!1:this.allSameFrame=!0},t.prototype.checkGroup=function(){var e=[];this.elements.forEach((function(t){return!e.includes(t.groupId)&&e.push(t.groupId)})),this.hasGroup=e.length>1||null!==e[0],this.allSameGroup=1===e.length&&null!==e[0]},t.prototype.checkPointDirection=function(e,t,n){return this.resizable?this.hasMindMap||this.hasFrame?Ht(e,t,n):zt(e,t,n):""},t.prototype.delete=function(){if(!this.elements.some((function(e){return e.frozedGroupId}))){var e=this.upime.createOperation();this.dealDeleteGroup(e),this.eleEditors.forEach((function(t){return t.doDelete(e)})),e.sync()}},t.prototype.contains=function(e){return this.elements.indexOf(e)>=0},t.prototype.getElements=function(){return R([],this.elements,!0)},t.prototype.getPropertyValue=function(e){return this.elements[0][e]},t.prototype.dealClick=function(e){},t.prototype.getResizingElements=function(){for(var e=this.commRefSystem,t=this.upime.view.elementsRoot,n=this.elements.filter((function(n){return(n.parentRefSystem||t)===e})),i=R([],n,!0),r=function(e){var t=e.connectionLines;t&&t.forEach((function(t){var n=t,r=n.startElement,o=n.endElement;r===e&&o&&i.includes(o)&&(i.includes(t)||i.push(t))}))},o=0,a=n;o<a.length;o++)r(a[o]);return i},t.prototype.handleSelectCtrlResize=function(t,n){var i=this;t.isStart&&(this.resizingEditors=this.resizingEles.map((function(e){return new e.editorType(i.upime,e,i)}))),e.prototype.handleSelectCtrlResize.call(this,t,n),t.isEnd&&(this.resizingEditors=[])},t.prototype.handleAnyResize=function(e,t,n){this.resizingEditors.forEach((function(i){return i.dealMultiEditorResize(e,t,n)}))},t.prototype.handleAnyMove=function(e){e.isStart&&this.currentOp,this.movingEditors.forEach((function(t){return t.dealMultiEditorMove(e)})),e.isEnd},t.prototype.handleSelectCtrlMove=function(e){var t=this;e.isStart&&(this.movingEditors=this.movingEles.map((function(e){return new e.editorType(t.upime,e,t)})));var n=this.checkBeforeMove(e);this.handleAnyMove(n)},t.prototype.handleDirectMove=function(t){var n=this;t.isStart&&(this.movingEditors=this.movingEles.map((function(e){return new e.editorType(n.upime,e,n)}))),e.prototype.handleDirectMove.call(this,t)},t.prototype.updateCommRefSystem=function(){for(var e=this.upime.view.elementsRoot,t=[],n=[],i=0;i<this.elements.length;i++){var r=this.elements[i],o=r.parentRefSystem||e;o!==e&&(this.allInGlobalRs=!1);var a=!0;if(o.parentRefSystem)for(var s=0;s<this.elements.length;s++)if(s!==i&&o.isInRefSystemOfElement(this.elements[s])){a=!1;break}a&&(t.includes(o)||t.push(o),n.push(r))}this.commRefSystem=1===t.length?t[0]:null,this.directCtrlElements=n},t.prototype.getBorderBox=function(){var e=this.commRefSystem,t=this.getElements();if(e){var n=this.getBorderBoxInRS();return e.globalTransform.applyBorderBox(n)}return Yt(t.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate)})))},t.prototype.getBorderBoxInRS=function(){if(1===this.directCtrlElements.length)return this.directCtrlElements[0].getBorderBox();var e=this.directCtrlElements.map((function(e){var t=e.getBorderBox();return Sn(t,t.rotate)}));return Yt(e)},t.prototype.frozeElement=function(){var e,t=this.getOp(),n=this.elements,i=void 0;if(this.group){var r=R([],this.group.members,!0);e=this.upime.createLock(r.map((function(e){return e.id}))),n.length!==r.length?(r.forEach((function(e){return t.update(e,{groupId:null})})),i=n):i=r}else e=this.upime.createLock(n.map((function(e){return e.id}))),this.allSameGroup||n.forEach((function(e){return e.group&&t.update(e,{groupId:null})}));var o=this.upime.genID("fg");n.forEach((function(e){return t.update(e,{frozedGroupId:o})})),t.sync(),this.upime.clearLock(e),i?(this.upime.clearSelect(),this.upime.selectElements(i)):this.frozed=!0},t.prototype.handleHidedFrame=function(e){var t=this,n=this.getOp(),i=this.frames.filter((function(e){return!e.unHideRoles||e.unHideRoles.includes(t.upime.userManager.userType)})),r=this.upime.createLock(i.map((function(e){return e.id})));i.forEach((function(t){return n.update(t,exports.E({hide:e},!e&&{unHideRoles:null}))})),n.sync(),this.upime.clearLock(r),this.upime.updateView()},t.prototype.groupAlignElements=function(e){var t,n=this;if(this.canAlignGroup){for(var i=this.getOp(),r=this.upime.createLock(this.elements.map((function(e){return e.id}))),o={},a=new Map,s=[],l=0,c=this.elements;l<c.length;l++){var u=c[l];u.groupId?o[u.groupId]?o[u.groupId].push(u):o[u.groupId]=[u]:(u.frame&&(a.has(u.frame)?null===(t=a.get(u.frame))||void 0===t||t.push(u):a.set(u.frame,[u])),s.push(u))}if(e===bt.HORI_DISTRIBUTE||e===bt.VERT_DISTRIBUTE){if(!this.canDistributeGroup)return;var d=Object.entries(o).map((function(e){var t=e[0],n=e[1];return{border:Yt(n.map((function(e){return e.getBorderBox()}))),id:t,ele:n}})),p=R(R([],s.map((function(e){return{id:e.id,border:e.getBorderBox(),ele:e}})),!0),d,!0),h=e===bt.HORI_DISTRIBUTE,f=p.reduce((function(e,t){return e+(h?t.border.right-t.border.left:t.border.bottom-t.border.top)}),0),m=h?this.borderRect.left:this.borderRect.top,v=((h?this.borderRect.right-this.borderRect.left:this.borderRect.bottom-this.borderRect.top)-f)/(p.length-1),g=p.slice(0);g.sort((function(e,t){return h?e.border.left-t.border.left:e.border.top-t.border.top})),g.forEach((function(e){var t=h?e.border.right-e.border.left:e.border.bottom-e.border.top;if(Array.isArray(e.ele))e.ele.forEach((function(t){if(t.currentEditor){t.currentEditor.currentOp=i;var n={deltaX:h?m-e.border.left:0,deltaY:h?0:m-e.border.top,isStart:!1,isEnd:!1};t.currentEditor.dealMultiEditorMove(n),t.currentEditor.currentOp=void 0,t.showInParentShadow&&(t.showInParentShadow=!1)}}));else{var n=e.ele.currentEditor;if(n){n.currentOp=i;var r={deltaX:h?m-e.ele.position.x:0,deltaY:h?0:m-e.ele.position.y,isStart:!1,isEnd:!1};n.dealMultiEditorMove(r),n.currentOp=void 0,n.element.showInParentShadow&&(n.element.showInParentShadow=!1)}}m+=t+v}))}else s.forEach((function(t){var r,o=t.getBorderBox(),a=Nn(e,n.borderRect,o),s=a.deltaX,l=a.deltaY;t.currentEditor&&(t.currentEditor.currentOp=i,null===(r=t.currentEditor)||void 0===r||r.dealMultiEditorMove({deltaX:s,deltaY:l,isStart:!1,isEnd:!1}),t.currentEditor.currentOp=void 0,t.showInParentShadow&&(t.showInParentShadow=!1))})),Object.values(o).forEach((function(t){var r=Yt(t.map((function(e){return e.getBorderBox()}))),o=Nn(e,n.borderRect,r),a=o.deltaX,s=o.deltaY;t.forEach((function(e){e.currentEditor&&(e.currentEditor.currentOp=i,e.currentEditor.dealMultiEditorMove({deltaX:a,deltaY:s,isEnd:!1,isStart:!1}),e.showInParentShadow&&(e.showInParentShadow=!1))}))}));a.forEach((function(e,t){e.forEach((function(e){e.isSupportFrame&&t.checkBorderInFrame(e.getBorderBox())||i.update(e,{frameId:null})}))})),i.sync(),this.upime.clearLock(r),this.updateBorderBox(),this.upime.updateView()}},t.prototype.unselect=function(){var t=this;e.prototype.unselect.call(this),this.elements.forEach((function(e,n){e.currentEditor===t.eleEditors[n]&&(e.currentEditor=void 0)}))},t}(fh),_h=function(){function e(e){this.upime=e,this.id=ia(),this.asyncWork=new Ks}return e.prototype.download=function(e,t,n){var i=this;return this.upime.downloadOssFilesByZip(e,t,n).then((function(e){var t=e.downloadUrl;if("pending"===i.asyncWork.state){i.asyncWork.done(t);var n=document.createElement("a");n.href=t,_e.desktop?n.target="_blank":n.target="_self",n.click()}})).catch((function(e){i.asyncWork.fail(e)})),this.asyncWork.result},e.prototype.cancel=function(){this.asyncWork.fail(new Error("cancel"))},e}(),Th=2*Math.pow(1024,3),Ih=function(t){var n=t.editor,i=t.forceEnabled,r=W().getUpimeTrans,o=e.useContext(Ic).phoneLayout,a=n.upime;al(a,["filesZipDownloaders"]);var s=n instanceof kh&&a.filesZipDownloaders.size>0,l=r(!1===s?"common.download":"toolbar.download.button.busy.tip");return e.createElement(Dl,{placement:"top",content:l},e.createElement("div",{className:j(Ml.cm_item,(!n.supportDownload&&!i||s)&&Ml.disabled),style:{pointerEvents:"all"}},e.createElement("div",{className:Ml.propEditorIconBox,onClick:function(){if(n instanceof Lb){var e=n.element,t=e.fileId;if(!t)return;a.downloadOssFile(t,e.name,e.elementType===Za.IMAGE,e.size,e.scale)}else if(n instanceof kh){if(!0===s)return;var i=n.elements;if(!0===o||i.length>5){var l=i.reduce((function(e,t){return void 0===t.fileId||e.push({fileId:t.fileId,fileName:t.name}),e}),[]);Promise.all(l.map((function(e){var t=e.fileId;return a.getFileInfo(t)}))).then((function(e){if(e.reduce((function(e,t){return e+t.fileSize}),0)>Th)a.addToast(r("toolbar.download.filesize.overlimit.tip","2G"));else{var t=new _h(a);a.addFilesZipDownloader(t),t.download(l,function(){var e,t,n=new Date;return(null!==(t=null===(e=a.queryBoardInfo)||void 0===e?void 0:e.call(a).title)&&void 0!==t?t:"untitled")+"_".concat(n.getFullYear()).concat(Ch(n.getMonth()+1)).concat(Ch(n.getDate())).concat(Ch(n.getHours())).concat(Ch(n.getMinutes())).concat(Ch(n.getSeconds()),".zip")}(),Th).catch((function(e){})).finally((function(){a.removeFilesZipDownloader(t)}))}})).catch((function(){}))}else i.forEach((function(e){var t=e.fileId;t&&a.downloadOssFile(t,e.name,e.elementType===Za.IMAGE,e.size,e.scale)}))}}},e.createElement(hl,{icon:"file-xiazai"}))))},Ph="arrow_7T2wC";function Nh(n){var i=n.className,r=n.Content,o=n.children,a=n.placement,s=void 0===a?"top":a,l=n.noPortal,c=void 0===l||l,u=n.offset,d=n.autoAdjustOverflow,p=void 0===d||d,h=n.onStatusChange,f=e.useContext(Ic),m=f.rootContainer,v=f.popContainer,g=e.useRef(null),y=e.useRef(null),b=e.useState(),E=b[0],x=b[1],w=e.useState(),C=w[0],S=w[1],k=yh(!0,{checkSkip:function(e){return!(!y.current||!V(y.current,e))||!(!g.current||!V(g.current,e))}}),_=k.hide,T=k.setHide;e.useEffect((function(){null==h||h(_)}),[_]),e.useEffect((function(){!function(){if(g.current&&m.current){var e=g.current.getBoundingClientRect().right,t=m.current.getBoundingClientRect().right,n=(null==u?void 0:u.x)||0,i=(null==u?void 0:u.x)||0;if(p&&e+i>t){var r=e+i-t+8;i-=r,n-=r}g.current.style.left="calc(50% + ".concat(i,"px)");var o=g.current.getElementsByClassName(Ph)[0];o&&(o.style.left="calc(50% - 6px - ".concat(n,"px)"))}if(!c&&y.current){var a=y.current.getBoundingClientRect(),s=(i=a.left,a.width),l=a.height,d=a.top;!_&&x({left:i,top:d,width:s,height:l})}}()}),[_]),e.useEffect((function(){!function(){var e=s;if(g.current&&m.current&&p){var t=g.current.getBoundingClientRect(),n=t.top,i=t.bottom,r=m.current.getBoundingClientRect(),o=r.top,a=r.bottom;"top"===s&&n<o?e="bottom":"bottom"===s&&i>a&&(e="top")}S(e)}()}),[s,_,E]);var I=r?e.createElement("div",{className:j("popOverContainerWrapper_13rsP",i,C),ref:g,onClick:function(e){return e.stopPropagation()}},e.createElement("div",{className:Ph}),e.createElement(r,null)):null;return e.createElement("div",{ref:y,onClick:function(){T(!_)}},o,c&&!_&&I,v.current&&!c&&!_&&I&&t.createPortal(e.createElement("div",{style:E,className:"popover_wrapper_jmtay"},I),v.current))}var Mh="clickBorder_3kX01",Ah="container_2kTy4";function Dh(n){var i=n.children,r=n.renderData,o=n.onClick,a=n.calcRect,s=n.className,l=n.conClassName,c=n.placement,u=void 0===c?"right":c,d=n.noPortal,p=n.popToggleCB,h=n.autoHide,f=void 0===h||h,m=n.onClose,v=n.rendering,g=n.useHover,y=void 0!==g&&g,b=n.focusOpen,E=n.id,x=n.useEscape,w=void 0!==x&&x,C=n.extraStyle,S=void 0===C?{}:C,k=e.useContext(Ic).popContainer,_=e.useRef(null),T=e.useRef(null),I=e.useState(void 0),P=I[0],N=I[1],M=e.useContext(xl).upime;e.useEffect((function(){var e,t;if(P&&f){var n=function(){y&&_e.isHoverSupported||b||(N(void 0),null==p||p(!1))};e=gh(n,{checkSkip:function(e){return!(!T.current||!V(T.current,e))||!(!_.current||!V(_.current,e))}}),w&&(t=M.registerHotKey({key:"Escape"},n))}return function(){null==e||e(),null==t||t(),window.clearTimeout(void 0)}}),[P,f,b]),e.useEffect((function(){if(v&&P)return v(!0),function(){v(!1)}}),[P]);var A=e.useRef();e.useEffect((function(){return function(){window.clearTimeout(A.current)}}),[1]);var D=Ml.right;switch(u){case"rightTop":D=Ml.right_top;break;case"left":D=Ml.left;break;case"top":D=Ml.top;break;case"topLeft":D=Ml.top_left;break;case"leftTop":D=Ml.left_top;break;case"bottom":D=Ml.bottom;break;case"bottomLeft":D=Ml.bottom_left;break;case"rightBottom":D=Ml.right_bottom;break;case"leftBottom":D=Ml.left_bottom}e.useEffect((function(){if(!r){if(b)return;N(void 0)}}),[r]);var R=e.createElement("div",{className:j(Mh),style:P,onMouseEnter:function(){y&&window.clearTimeout(A.current)}},e.createElement("div",{className:j(Ah,u,l),style:S,ref:T},e.createElement("div",{className:j(Ml.show_scale,D)},r?e.createElement(r.render,exports.E({},r.data,{close:function(){b||(m&&m(),N(void 0),T.current=null)}})):e.createElement("div",null))));function B(){var e,t=null===(e=_.current)||void 0===e?void 0:e.getBoundingClientRect(),n={left:t.left,top:t.top,width:t.width,height:t.height};void 0!==a&&(n=a(n)),N(n)}return e.useEffect((function(){b&&(P||(B(),null==p||p(!0)))}),[b]),e.createElement("div",{className:j(s,P?"showing":""),ref:_,onClick:function(e){y&&_e.isHoverSupported||(window.clearTimeout(A.current),o&&o(e),P?f&&N(void 0):(B(),null==p||p(!0)))},onMouseEnter:function(){y&&(window.clearTimeout(A.current),P||(A.current=window.setTimeout((function(){var e,t=null===(e=_.current)||void 0===e?void 0:e.getBoundingClientRect(),n={left:t.left,top:t.top,width:t.width,height:t.height};void 0!==a&&(n=a(n)),N(n),null==p||p(!0)}))))},onMouseLeave:function(){y&&P&&(window.clearTimeout(A.current),b||(A.current=window.setTimeout((function(){N(void 0)}),200)))},id:E},i,!d&&P&&t.createPortal(R,k.current),d&&P&&R)}var Rh=function(t){var n=t.running,i=t.disabled,r=t.onClick,o=t.transparent;return e.createElement("div",{className:j(Ml.AIButtonContainer,o?Ml.transparent:""),onClick:r},e.createElement("div",{className:j(Ml.AIButtonWrapper)},e.createElement(Lh,{show:n}),e.createElement(Bh,{disabled:i,show:!n})))};function Bh(t){var n=t.disabled,i=t.show;return e.createElement("div",{className:j(Ml.AIButtonImageContainer,Ml.AIButtonHover,n?Ml.AIButtonDisabled:"",i?Ml.AIShow:Ml.AIHide)},e.createElement("div",{className:Ml.AIButtonImage,style:{background:"url(".concat($o("ai_button.png"),")"),backgroundSize:"100% 100%"}}))}function Lh(t){var n=t.show;return e.createElement("div",{className:j(Ml.AIButtonImageContainer,n?Ml.AIShow:Ml.AIHide)},e.createElement("div",{className:Ml.AIButtonImage,style:{background:"url(".concat($o("ai_gif.gif"),")"),backgroundSize:"100% 100%"}}))}var Oh="item_1XCug",Fh="detail_2HIAn",zh="label_2w1II",Hh=function(t){var n=t.upime,i=t.className,r=t.id,o=W().getUpimeTrans,a=e.useContext(Ic).rootContainer,s=e.useState("rightTop"),l=s[0],c=s[1];return e.createElement(Dh,{className:j("info_item_2lfoW",i),renderData:{render:Wh,data:{upime:n,id:r,placement:l}},placement:l,calcRect:function(e){var t,n=null===(t=a.current)||void 0===t?void 0:t.getBoundingClientRect(),i=!1,r=!1;return n&&e.left+e.width+244>n.left+n.width&&(i=!0),n&&e.top+164+60>n.top+n.height&&(r=!0),i&&!r&&c("leftTop"),i&&r&&c("leftBottom"),i||r||c("rightTop"),!i&&r&&c("rightBottom"),e},noPortal:!0},o("element.info"))},Uh=function(t){var n=t.user;return al(n),e.createElement(e.Fragment,null,n.userName)},Wh=function(t){var n=t.upime,i=t.id,r=t.placement,o=e.useMemo((function(){return n.getElementInfo(i)}),[]),a=o.creator,s=o.addTimeStr,l=o.editor,c=o.updateTimeStr,u=e.useMemo((function(){return!l.loginName}),[l]),d=W().getUpimeTrans;return e.createElement("div",{className:j("info_panel_kxZHk",r.startsWith("left")?"mr_minus10_23FRX":""),onClick:function(e){return e.stopPropagation()}},e.createElement("div",{className:Oh},e.createElement("div",{className:zh},d("info.creator")),e.createElement("div",{className:j(Fh,Ml.text_clip)},e.createElement(Uh,{user:a}))),e.createElement("div",{className:j(Oh,"add_1Q1oY")},e.createElement("div",{className:zh},d("info.createTime")),e.createElement("div",{className:Fh},s)),e.createElement("div",{className:j(Oh,"editor_HvfnL")},e.createElement("div",{className:zh},d("info.updatePerson")),e.createElement("div",{className:j(Fh,Ml.text_clip)},e.createElement(Uh,{user:u?a:l}))),e.createElement("div",{className:j(Oh,"update_1Vokf")},e.createElement("div",{className:zh},d("info.updateTime")),e.createElement("div",{className:Fh},u?s:c)))},Vh="globalCtx_3o4F3",jh="item_2CAzg",Gh="shortCut_1n4EQ",qh=function(t){var n=t.menu,i=W().getUpimeTrans,r=e.useRef(null),o=e.useContext(Ic).rootContainer,a=n.position,s=n.textEditor,l=n.isGlobalCtx,c=n.upime,u=n.editor,d=n.removeSelfCB,p=n.renderKey,h=n.customOptions,f=e.useState({visibility:"hidden"}),m=f[0],v=f[1],g=e.useMemo((function(){return c.view.getAbsolutePosition(a)}),[]);e.useEffect((function(){var e=r.current,t=o.current;if(e&&t){var n=e.getBoundingClientRect(),i=n.height,s=n.width,l=t.getBoundingClientRect(),u=l.top,d=l.bottom,h=l.right,f=l.left,m={left:a.x};if(a.y+i<=d)m.top=a.y;else if(a.y-i>=u)m.top=a.y-i;else{var g=a.y+i+u-d;m.top=a.y-g}var y=a.x+s+f-h;y>0&&(m.left=a.x-y),v(m)}c.publish("contextMenuOpened",p)}),[n.renderKey]),e.useEffect((function(){var e=function(e){r.current&&e.target&&(r.current.contains(e.target)||d())};document.body.addEventListener("click",e);var t=c.view.subscribe("viewboxChange",(function(){d()}));return function(){t(),document.body.removeEventListener("click",e)}}),[]);var y=c.editable&&("select"===c.xmode||"view"===c.xmode)||c.userManager.commentOnlyMode&&"hand"===c.xmode,b=[];if(s){var E=s.isSelecting,x=s.copySelected,w=s.cutSelected,C=s.dealPaste,S=s.pickAll;b.push({name:i("common.cut"),onclick:w,disabled:!E,key:"cut"},{name:i("element.copy"),onclick:x,disabled:!E,key:"copy"},{name:i("common.paste"),onclick:C,key:"paste"},{name:i("common.selectAll"),onclick:S,key:"selectAll"})}else l&&(h.length&&h.forEach((function(e){!1===e.global||!0===e.editableOnly&&!c.editable||b.push({onclick:function(){e.onClick(),d()},name:e.name,key:"custom_"+e.id})})),!c.editable||"select"!==c.xmode&&"view"!==c.xmode||b.push({onclick:function(){_c("cv_paste"),c.onReadClipboard(g),d()},name:i("common.paste"),key:"common.paste"},{onclick:function(){c.insertTextAt(g),d()},name:i("text.add"),key:"text.add"},{onclick:function(){c.insertStickerAt(g),d()},name:i("sticker.add"),key:"sticker.add"}),y&&b.push({onclick:function(){c.insertCommentAt({position:g,globalPosition:a}),d()},name:i("comment.add"),key:"comment.add"}));return e.createElement("div",{ref:r,className:"root_y3DcX",style:m},s?e.createElement("div",{className:Vh},b.map((function(t){return e.createElement("div",{key:t.key,className:j(jh,t.disabled&&"disabled_liz8Y"),onPointerDown:function(e){return e.preventDefault()},onPointerUp:function(e){e.preventDefault(),t.onclick(),d()}},t.name)}))):l?e.createElement("div",{className:Vh},b.length>0&&b.map((function(t){return e.createElement("div",{key:t.key,className:jh,onClick:t.onclick},e.createElement("span",null,t.name),e.createElement("span",{className:Gh}))})),b.length>0&&e.createElement("div",{className:"divider_1CWJ2"}),e.createElement("div",{className:jh,onClick:function(){_c("cv_showall"),c.showAerialView(),d()}},e.createElement("span",null,i("show.all.content")),e.createElement("span",{className:Gh})),e.createElement("div",{className:jh,onClick:function(){var e=!c.hideToolbar;c.publish("toolbarVisibilityChange",e?"hidden":"visible"),c.hideToolbar=e,d()}},e.createElement("span",null,i("fullscreen.showOrHideToolbar")),e.createElement("span",{className:Gh},"".concat(_e.isMac?"⌘":"Ctrl"," \\")))):e.createElement(Ug,{upime:c,editor:u,hideMenuCB:d,position:g}))},Kh=function(){function e(e,t,n,i){this.upime=e,this.position=t,this.removeSelfCB=n,this.editor=i,this.renderer=qh,this.renderKey=Date.now()+""}return Object.defineProperty(e.prototype,"isGlobalCtx",{get:function(){return!this.editor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customOptions",{get:function(){return Yh},enumerable:!1,configurable:!0}),e}(),Yh=[];function Xh(e){var t=Yh.findIndex((function(t){return t.id===e.id}));t>=0?Yh[t]=e:Yh.push(e)}function Qh(e){var t=Yh.findIndex((function(t){return t.id===e}));t>=0&&Yh.splice(t,1)}var Zh,Jh={exportFrameMenuButtonContainer:"exportFrameMenuButtonContainer_LDJCn",exportFrameMenuButton:"exportFrameMenuButton_3hZUb",icon:"icon_1RxXR",exportFrameTypesPanel:"exportFrameTypesPanel_2kIpC",exportFrameType:"exportFrameType_39BoA",fileType:"fileType_2ss2B"},$h={container:"container_2zYwx",head:"head_CPASv",title:"title_2bCBm",closeBtn:"closeBtn_3DidH",body:"body_1AoaV",leftPart:"leftPart_2IRUT",framesListContainer:"framesListContainer_13PRy",frameList:"frameList_TEla4",large:"large_1Af7k",listOperations:"listOperations_1Gdh5",switchListType:"switchListType_2Uzjj",listTypeBtn:"listTypeBtn_11f-i",small:"small_Nn3zw",active:"active_3nESE",fastSelect:"fastSelect_2K6Bq",selectAllLabel:"selectAllLabel_1n3df",selectedCount:"selectedCount_JUr8F",xinxiIconContainer:"xinxiIconContainer_3vBOF",xixiIcon:"xixiIcon_Bcwkr",hoverTipContent:"hoverTipContent_3q0iZ",divider:"divider_2oYHQ",rightPart:"rightPart_2NwG2",optionLabel:"optionLabel_3Tqq1",selectExportTypeContainer:"selectExportTypeContainer_28aw_",selectExportType:"selectExportType_1Me63",exportTypeOptionContentWrap:"exportTypeOptionContentWrap_MWkRx",selectQualityContainer:"selectQualityContainer_20MdK",selectQuality:"selectQuality_27-iO",radioContent:"radioContent_2ATQk",highQualityPDFRadioContentWrap:"highQualityPDFRadioContentWrap_19C_t",selectResolutionContainer:"selectResolutionContainer_2CFsu",selectResolution:"selectResolution_33-V4",inputFileNameContainer:"inputFileNameContainer_3LHKk",inputFileName:"inputFileName_24F7Q",dialogButtonsWrap:"dialogButtonsWrap_3NPzs",imageCountTip:"imageCountTip_2gt9n",icon:"icon_1KG_R",content:"content_2YHMc",dialogButtons:"dialogButtons_2Pu1M",cancelBtn:"cancelBtn_ihENj",confirmBtn:"confirmBtn_3yUud",exporting:"exporting_MVqTt",loadingIcon:"loadingIcon_1P-yy",loading:"loading_qsqdt"};!function(e){e.SelectNone="SelectNone",e.SelectPart="SelectPart",e.SelectAll="SelectAll"}(Zh||(Zh={}));var ef,tf,nf,rf,of=function(t){var n=t.state,i=t.disabled,r=t.className,o=t.onSelectAll,a=t.onSelectNone,s=e.useState(null!=n?n:Zh.SelectNone),l=s[0],c=s[1],u=n||l;return e.createElement("div",{className:j("checkbox_1jdta",u===Zh.SelectNone&&"selectNone_1qowX",u===Zh.SelectPart&&"selectPart_1H1ii",u===Zh.SelectAll&&"selectAll_2lHKB",!0===i&&"disabled_ugR1U",r),onClick:function(){n===Zh.SelectAll?(null==a||a(),c(Zh.SelectNone)):(null==o||o(),c(Zh.SelectAll))}})},af=function(t){var n,i,r=t.value,o=t.options,a=t.onSelect,s=t.beforeSelect,l=t.className,c=yh(!0),u=c.hide,d=c.setHide,p=c.toggleHide,h=c.skipRef,f=e.useState(null!=r?r:o[0].value),m=f[0],v=f[1],g=null!==(i=null===(n=o.find((function(e){return e.value===m})))||void 0===n?void 0:n.label)&&void 0!==i?i:"";return e.createElement("div",{className:j("select_2Xl5C",l,!1===u&&"active_2_dMA"),ref:h},e.createElement("div",{className:"currentSelected_-nI3X",onClick:function(){p()}},e.createElement("span",{className:"selectedLabelWrap_301Bu"},g),e.createElement("span",{className:"iconWrap_1pv6M"},e.createElement(hl,{className:"arrowIcon_tuSgq",icon:"xuanzejiantou"}))),!1===u&&e.createElement("div",{className:"options_1Te1t"},o.map((function(t){return e.createElement("div",{key:t.key,className:j("option_1F2O3",m===t.value&&"selected_3dmKv"),onClick:function(){!function(e){var t;!0===(null===(t=null==s?void 0:s(e))||void 0===t||t)&&(v(e),null==a||a(e)),d(!0)}(t.value)}},e.createElement("div",{className:"optionContentWrap_1S6q9"},t.content))}))))},sf={radioContainer:"radioContainer_jCkyZ",radioOuter:"radioOuter_B1Y9l",radioInner:"radioInner_17JRj",content:"content_1psaW",disabled:"disabled_1Uko3",active:"active_2M8Lo"},lf=e.createContext({selectedValue:void 0,onSelect:function(){}}),cf=function(t){var n=t.disabled,i=t.value,r=t.children,o=t.beforeSelect,a=e.useContext(lf),s=a.selectedValue,l=a.onSelect;return e.createElement("div",{className:j(sf.radioContainer,!0===n&&sf.disabled,s===i&&sf.active),onClick:function(){var e;n||!0===(null===(e=null==o?void 0:o(i))||void 0===e||e)&&l(i)}},e.createElement("div",{className:j(sf.radioOuter)},e.createElement("div",{className:sf.radioInner})),e.createElement("div",{className:sf.content},r))},uf=function(t){var n=t.className,i=t.value,r=t.children,o=t.onSelect,a=e.useState(i),s=a[0],l=a[1],c=e.useCallback((function(e){o(e),l(e)}),[]);return e.createElement(lf.Provider,{value:{selectedValue:s,onSelect:c}},e.createElement("div",{className:j(sf.radioGroupContainer,n)},r))};!function(e){e.Small="small",e.Large="large"}(ef||(ef={})),function(e){e.Pdf="pdf",e.Pptx="pptx",e.Image="image"}(tf||(tf={})),function(e){e.Low="low",e.High="high"}(nf||(nf={})),function(e){e.Low="low",e.Medium="medium",e.High="high"}(rf||(rf={}));var df=function(){function e(){}return e.loadFonts=function(t){for(var n=this,i=[],r=0;r<t.length;r++){var o=t[r];e.fontsCache.get(o.family)?i.push(Promise.resolve()):i.push(a(o.family,"".concat(o.url)))}function a(t,n){return new Promise((function(i){var r=new FontFace(t,"url(".concat(we).concat(n,")"));r.load().then((function(){document.fonts.add(r),e.fontsCache.set(t,!0),i()}),(function(e){i()}))}))}return new Promise((function(e){return A(n,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,Promise.all(i)];case 1:return t.sent(),e(),[2]}}))}))}))},e.loadAll=function(){return e.loadFonts(Array.from(Be.values()))},e.load=function(t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){return(n=Be.get(t))?[2,e.loadFonts([n])]:[2,Promise.resolve()]}))}))},e.getFont=function(e){return Be.get(e)||Re[Ae.OPEN_SANS]},e.fontsCache=new Map,e}();function pf(e){var t=e.imageFile,n=e.realHeight,i=e.exportType,r=e.renderTarget,o=js.value,a=o.addLoadingSource,s=o.renderApp,l=t.getSource({height:"svg"===i?void 0:n,exact:void 0!==i,autoLoad:"svg"!==i}),c=l.target,u=l.temp,d=l.refreshTime;return a&&(c.loaded||a(c),u&&!u.loaded&&a(c)),void 0!==d&&s&&s(d,r),u||c}function hf(e,t,n){var i=e.position;return 0===e.rotate?{x:0,y:0}:e.useMemo("elementPivot",(function(){var n=e.getBorderBox(),i=n.left,r=n.top,o=n.right,a=n.bottom;return{x:(o+i)*t*.5,y:(a+r)*t*.5}}),R([i,t],n,!0))}var ff,mf=ha((function(e,t,n){var i,r,o,a,s,l;return void 0===n&&(n=!0),D(this,(function(c){switch(c.label){case 0:return i=e.rotate,r=e.locked,o=js.value,a=o.exportType,s=o.getElementAlpha,fa({x:t.x,y:t.y,pivotX:t.x,pivotY:t.y,rotation:i,alpha:r?1:null!==(l=null==s?void 0:s(e))&&void 0!==l?l:1}),[4];case 1:return c.sent(),!a&&n&&xf(e),"base64"!==a&&e.link&&wf(e),ma(),[2]}}))})),vf=ha((function(e,t){var n,i,r,o;return void 0===t&&(t=!0),D(this,(function(a){switch(a.label){case 0:return n=js.value,i=n.exportType,r=n.getElementAlpha,fa({alpha:e.locked?1:null!==(o=null==r?void 0:r(e))&&void 0!==o?o:1}),[4];case 1:return a.sent(),!i&&t&&xf(e),"base64"!==i&&e.link&&wf(e),ma(),[2]}}))})),gf=ha((function(e,t,n){var i,r,o,a,s,l;return void 0===n&&(n=!0),D(this,(function(c){switch(c.label){case 0:return i=js.value,r=i.exportType,o=i.getElementAlpha,a=e.rotate,s=e.locked,fa({x:t.x,y:t.y,pivotX:t.x,pivotY:t.y,rotation:a,alpha:s?1:null!==(l=null==o?void 0:o(e))&&void 0!==l?l:1}),[4];case 1:return c.sent(),!r&&n&&xf(e),"base64"!==r&&e.link&&wf(e),bf(e),Ef(e),ma(),[2]}}))})),yf=ha((function(e,t){var n,i,r,o;return void 0===t&&(t=!0),D(this,(function(a){switch(a.label){case 0:return n=js.value,i=n.exportType,r=n.getElementAlpha,fa({alpha:e.locked?1:null!==(o=null==r?void 0:r(e))&&void 0!==o?o:1}),[4];case 1:return a.sent(),!i&&t&&xf(e),bf(e),Ef(e),"base64"!==i&&e.link&&wf(e),ma(),[2]}}))})),bf=function(e){if(e.showAdsorptionPoints){var t=js.value.viewbox.scale*e.globalTransform.currentScale,n=e.adsorptionPoints;Na((function(e){e.clear(),e.lineStyle({width:2/t,color:6919927}),e.beginFill(16316666,1);for(var i=0;i<n.length;i++){var r=n[i];e.drawCircle(r.x,r.y,4/t)}}))}},Ef=function(e){var t=js.value.viewbox,n=e.attachedPoint;if(n){var i=t.scale*e.globalTransform.currentScale,r=e.isAttachedPointInElement;Na((function(e){e.clear(),e.beginFill(6919927,1),e.drawCircle(n.x,n.y,(r?3:4)/i)}))}},xf=function(e){var t=null;if(e.locked&&(e.elementType!==Za.LINE||e.ended)?t="locked":e.showAttachedOnsideShadow?t="attached-onside":e.showInParentShadow?t="in-frame":e.elementType===Za.TABLE&&e.focusingCell?t="mark-cell":e.elementType===Za.KANBAN&&e.selectedCards.length?t="mark-card":e.showSelected?t=e.frozedGroup?"frozed":"selected":e.showAttachComment&&(t="attach-comment"),t){var n=js.value.viewbox,i=e.getBorderBox(),r=i.left,o=i.top,a=i.right,s=i.bottom,l=a-r,c=s-o,u=n.scale*e.globalTransform.currentScale;Na((function(n){if(n.clear(),"in-frame"==t||"attach-comment"===t)n.beginFill(8750469,.4),n.drawRect(0,0,l,c);else if("selected"==t||"frozed"==t)n.lineStyle(1/u,"frozed"==t?8421504:6134012,.8),n.drawRect(-.5/u,-.5/u,l+1/u,c+1/u);else if("attached-onside"==t)n.beginFill(8750469,.2),n.drawRect(0,0,l,c),n.endFill();else if("locked"==t)n.beginFill(790564,.1),n.drawRect(0,0,l,c);else if("mark-cell"===t)(i=e.getFocusedCellsBoxes(!0))&&i.forEach((function(e){n.beginFill(0,.05),n.lineStyle(1.5/u,3044325,1),n.drawRect(e.left-r,e.top-o,e.right-e.left,e.bottom-e.top),n.endFill()}));else if("mark-card"===t){var i=e.getSelectedCardBoxes(),a=e.scale;n.clear(),n.lineStyle({width:a,color:6134012}),i.forEach((function(e){n.drawRect(e.left-r,e.top-o,e.right-e.left,e.bottom-e.top)}))}}),{x:r,y:o})}},wf=function(e){var t=js.value.viewbox,n=e.getLinkRect(t.scale),i=e.link,r=n.x,o=n.y,a=n.width,s=n.height,l=a*(20/24),c=.1*a;fa({x:r,y:o}),Ma((function(e){var t=e.context;t.save(),t.shadowColor="rgba(0, 0, 0, 0.1)",t.shadowBlur=8,t.shadowOffsetX=0,t.shadowOffsetY=2,t.fillStyle="#ffffff",t.beginPath(),t.moveTo(a-c,0),t.arcTo(a,0,a,c,c),t.lineTo(a,s-c),t.arcTo(a,s,a-c,s,c),t.lineTo(c,s),t.arcTo(0,s,0,s-c,c),t.lineTo(0,c),t.arcTo(0,0,c,0,c),t.closePath(),t.fill(),t.restore()})),Oa({src:e.linkSource,link:i,x:a/2-l/2,y:s/2-l/2,width:l,height:l}),ma()};ff=['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="98.145%" x2="98.145%" y1="0%" x1="0%"><stop offset="0%" stop-color="#00CCAC"/><stop offset="100%" stop-color="#00B494"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill="#FFF" d="m12.693 19.39 2.563 3.326 2.279-1.146a1 1 0 0 1 1.207.24l.075.1 3.016 4.536a1 1 0 0 1-1.666 1.108l-2.525-3.799-2.223 1.12a1 1 0 0 1-1.164-.194l-.078-.09-2.014-2.613-2.24 5.405a1 1 0 0 1-1.196.58l-.11-.04a1 1 0 0 1-.54-1.306l2.9-7a1 1 0 0 1 1.716-.227ZM19.5 16a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1="0%" x1="0%"><stop offset="0%" stop-color="#EE7674"/><stop offset="100%" stop-color="#E14440"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M14.368 15.504c.95.018 1.251.532 1.467.82.4.698.163 2.328-.423 3.76.574 1.079 1.023 1.761 1.92 2.588.755-.143 1.508-.251 2.262-.251 1.62.034 1.916 1.03 1.906 1.524l-.003.059c0 1.223-1.292 1.444-1.903 1.444a4.242 4.242 0 0 1-2.55-1.049c-1.472.324-2.524.809-3.924 1.384l-.267.465c-.942 1.595-1.498 2.035-2.556 2.25h-.344c-.242-.004-.524-.022-.613-.09-.395-.18-.84-.72-.84-1.116l.004-.215c.04-.521.396-1.665 3.383-2.678.79-1.438 1.291-2.511 1.794-4.057l-.131-.233c-.482-.888-1.16-2.52-.646-3.785a1.57 1.57 0 0 1 1.464-.82Zm-3.425 10.91c-.539.215-1.014.54-1.292 1.042l.107-.036c.503-.18.898-.54 1.185-1.007Zm3.733-4.532-.036.072-.035-.036a29.689 29.689 0 0 1-1.077 2.445l.071-.036v.072c.79-.287 1.652-.539 2.441-.719l-.035-.036h.107a11.015 11.015 0 0 1-1.436-1.762Zm4.882 1.906c-.323 0-.61 0-.933.072.359.18.718.252 1.077.288.251.036.503 0 .718-.072 0-.108-.144-.288-.862-.288Zm-5.253-7.145a.219.219 0 0 0-.131.06c-.144.612-.036 1.26.215 1.835a3.027 3.027 0 0 0 .036-1.87l-.09-.022a.192.192 0 0 0-.03-.003Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1=".896%" x1=".896%"><stop offset="0%" stop-color="#F68065"/><stop offset="100%" stop-color="#E76233"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M17.5 21a1.5 1.5 0 0 0 0-3H11a1 1 0 0 1 0-2h6.5a3.5 3.5 0 0 1 0 7H12v4a1 1 0 0 1-2 0v-5a1 1 0 0 1 1-1h6.5Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1="0%" x1="0%"><stop offset="0%" stop-color="#679CF4"/><stop offset="100%" stop-color="#1377F2"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M20 17a1 1 0 0 1 1 1v9c0 .866-1.025 1.322-1.669.743L15 23.845l-4.331 3.898c-.616.554-1.58.16-1.663-.632L9 27v-9a1 1 0 0 1 2 0v6.754l3.331-2.997a1 1 0 0 1 1.239-.079l.099.079L19 24.755V18a1 1 0 0 1 .883-.993L20 17Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1="0%" x1="0%"><stop offset="0%" stop-color="#00CD7B"/><stop offset="100%" stop-color="#07B46F"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M17.5 21a3.5 3.5 0 0 1 0 7h-7.004a1 1 0 0 1 0-2H17.5a1.5 1.5 0 0 0 0-3h-5a3.5 3.5 0 0 1 0-7h7a1 1 0 0 1 0 2h-7a1.5 1.5 0 0 0 0 3h5Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1=".896%" x1=".896%"><stop offset="0%" stop-color="#9C83E8"/><stop offset="100%" stop-color="#826CF5"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M17 17a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h8Zm-1 2h-6v6h6v-6Zm5.743.5a.879.879 0 0 1 .257.62v3.755a.879.879 0 0 1-1.5.622l-1.207-1.205a1 1 0 0 1-.293-.707v-1.172a1 1 0 0 1 .293-.707l1.207-1.207a.879.879 0 0 1 1.243 0Z"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><defs><linearGradient id="a" y2="100%" x2="100%" y1="0%" x1="0%"><stop offset="0%" stop-color="#F067ED"/><stop offset="100%" stop-color="#D76AD4"/></linearGradient></defs><g fill-rule="evenodd" fill="none"><path fill-rule="nonzero" fill="#D9D9D9" d="M25.39 3a4 4 0 0 1 2.884 1.229l6.61 6.881A4 4 0 0 1 36 13.882V33a4 4 0 0 1-4 4H14a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4h11.39Zm0 1.5H14A2.5 2.5 0 0 0 11.5 7v26a2.5 2.5 0 0 0 2.5 2.5h18a2.5 2.5 0 0 0 2.5-2.5V13.882a2.5 2.5 0 0 0-.697-1.732l-6.61-6.882a2.5 2.5 0 0 0-1.804-.768Z"/><path fill="url(#a)" d="M8 11h14a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V15a4 4 0 0 1 4-4Z"/><path fill-rule="nonzero" fill="#FFF" d="M18.598 16.016 12 16.96c-.71.108-1.265.737-1.265 1.433v6.002c-.188-.206-.407-.3-.735-.302-1.104 0-2 .875-2 1.954S8.896 28 10 28s2-.874 2-1.953v-6.649l6.869-1.077v4.989c-.166-.216-.474-.331-.87-.33-1.103 0-1.999.875-1.999 1.954s.896 1.953 2 1.953c1.105 0 2-.874 2-1.953V17.18c0-.354-.15-.682-.413-.901a1.252 1.252 0 0 0-.989-.263Z"/></g></svg>','<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect data-follow-fill="#C469FC" x="1" y="1" width="22" height="22" rx="4" fill="#C469FC"/><path data-follow-stroke="#fff" data-follow-fill="#fff" d="M4.9 11.933a7.363 7.363 0 0 0 0 .08 6.999 6.999 0 0 0 1.54 4.307.385.385 0 0 0 .046.11l.002.004a.432.432 0 0 0 .18.157 7.019 7.019 0 0 0 5.266 2.377c3.852 0 6.991-3.114 7.033-6.955v-.079a7 7 0 0 0-1.47-4.299.445.445 0 0 0-.143-.179 7.023 7.023 0 0 0-5.42-2.555C8.056 4.9 4.9 8.056 4.9 11.933Zm8.998-4.417c.134.288.256.604.363.942a10.428 10.428 0 0 1-4.662-.002 7.84 7.84 0 0 1 .358-.94c.263-.57.573-1.028.911-1.343.337-.314.697-.48 1.065-.48.36 0 .717.166 1.053.48.336.315.647.773.912 1.343Zm-6.519.155a6.257 6.257 0 0 1 2.556-1.65 5.453 5.453 0 0 0-.598.945 8.188 8.188 0 0 0-.512 1.28 10.2 10.2 0 0 1-1.446-.575Zm-1.677 3.925a6.204 6.204 0 0 1 1.151-3.283c.567.29 1.158.53 1.763.72a13.05 13.05 0 0 0-.305 2.563h-2.61Zm4.233 6.25a6.253 6.253 0 0 1-2.444-1.534 10.79 10.79 0 0 1 1.386-.531c.133.405.287.78.46 1.12.179.353.38.67.598.945Zm.022-1.495c-.11-.24-.213-.5-.305-.775a10.264 10.264 0 0 1 4.56.005 7.486 7.486 0 0 1-.303.77c-.263.57-.573 1.028-.91 1.343-.338.314-.698.48-1.066.48-.367 0-.728-.166-1.065-.48-.338-.315-.648-.773-.91-1.343Zm4.562.55c.172-.338.326-.71.46-1.112.47.148.928.33 1.373.547a6.252 6.252 0 0 1-2.439 1.516c.221-.275.424-.595.606-.951Zm-.588-10.88a6.257 6.257 0 0 1 2.55 1.642c-.467.231-.948.425-1.44.582a8.175 8.175 0 0 0-.511-1.28 5.518 5.518 0 0 0-.599-.944Zm-6.965 9.686a6.208 6.208 0 0 1-1.257-3.318h2.605c.03.946.15 1.836.348 2.64-.582.18-1.15.407-1.696.678Zm11.192-3.318a6.208 6.208 0 0 1-1.258 3.319 11.006 11.006 0 0 0-1.7-.683c.199-.801.322-1.691.352-2.636h2.606Zm-1.15-4.083a6.205 6.205 0 0 1 1.157 3.29h-2.61a13.048 13.048 0 0 0-.304-2.561 10.87 10.87 0 0 0 1.758-.73Zm-5.104 6.224c-.83 0-1.66.099-2.47.288a12.04 12.04 0 0 1-.326-2.43h5.65a12.05 12.05 0 0 1-.326 2.43 11.223 11.223 0 0 0-2.528-.288Zm2.57-5.281c.165.721.266 1.515.288 2.347H9.104c.022-.833.122-1.629.284-2.351a11.049 11.049 0 0 0 5.087.004Z" fill="#fff" stroke="#fff" stroke-width=".2"/></svg>','<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z"/><path data-follow-fill="#0C1024" d="m17.203 12.67.008-.01a.681.681 0 0 0 .037-.044l.033-.045.01-.015a.992.992 0 0 0 .169-.55v-.013a1.003 1.003 0 0 0-.168-.549l-.01-.015a1.004 1.004 0 0 0-.071-.09l-.008-.008-.074-.074-8.918-8.03a1 1 0 1 0-1.338 1.487l8.093 7.285-8.093 7.287a1 1 0 0 0 1.338 1.487l8.918-8.03.074-.074Z" fill="#0C1024"/></g></svg>','<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="#0C1024" d="m6.797 12.67-.008-.01a.681.681 0 0 1-.037-.044l-.033-.045-.01-.015a.992.992 0 0 1-.169-.55v-.013a1.003 1.003 0 0 1 .168-.549l.01-.015a1.004 1.004 0 0 1 .071-.09l.008-.008.074-.074 8.918-8.03a1 1 0 1 1 1.338 1.487l-8.093 7.285 8.093 7.287a1 1 0 0 1-1.338 1.487l-8.918-8.03-.074-.074Z" fill="#0C1024"/></g></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M2.056 4.72a.54.54 0 0 1 .54.54v7.417a.54.54 0 1 1-1.08 0V5.26a.54.54 0 0 1 .54-.54Zm9.407 1.987a.54.54 0 0 1 .763-.047l2.134 1.89a.54.54 0 0 1-.02.826l-2.135 1.71a.54.54 0 0 1-.759-.084l-.054-.081a.54.54 0 0 1 .138-.678l.917-.735H5.56l.918.735a.54.54 0 0 1 .138.678l-.054.081a.54.54 0 0 1-.76.084L3.67 9.376a.54.54 0 0 1-.02-.826l2.134-1.89a.54.54 0 1 1 .716.809l-1.085.96h7.18l-1.084-.96a.54.54 0 0 1-.104-.684ZM15.96 4.72a.54.54 0 0 1 .54.54v7.417a.54.54 0 1 1-1.08 0V5.26a.54.54 0 0 1 .54-.54Z" fill="#0C1024" fill-rule="evenodd" data-follow-fill="#0C1024"/></svg>','<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 1h48v48H0z"/><circle fill-opacity=".201" fill="#2E73E5" cx="24" cy="24" r="22"/><path d="M24 2c12.15 0 22 9.85 22 22s-9.85 22-22 22S2 36.15 2 24 11.85 2 24 2Zm0 1C12.402 3 3 12.402 3 24s9.402 21 21 21 21-9.402 21-21S35.598 3 24 3Z" fill-opacity=".045" fill="#5778E6" fill-rule="nonzero"/><circle fill-opacity=".396" fill="#2E73E5" cx="24" cy="24" r="19"/><path d="M24 5c10.493 0 19 8.507 19 19s-8.507 19-19 19S5 34.493 5 24 13.507 5 24 5Zm0 1C14.059 6 6 14.059 6 24s8.059 18 18 18 18-8.059 18-18S33.941 6 24 6Z" fill-opacity=".062" fill="#142BFF" fill-rule="nonzero"/><path d="M24 8c8.837 0 16 7.163 16 16s-7.163 16-16 16S8 32.837 8 24 15.163 8 24 8Zm0 1C15.716 9 9 15.716 9 24c0 8.284 6.716 15 15 15 8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15Z" fill-opacity=".151" fill="#1964F2" fill-rule="nonzero"/><path d="M24.5 11a.5.5 0 0 1 .5.5v1a.5.5 0 1 1-1 0v-1a.5.5 0 0 1 .5-.5Zm0 24a.5.5 0 0 1 .5.5v1a.5.5 0 1 1-1 0v-1a.5.5 0 0 1 .5-.5Zm12-11a.5.5 0 0 1-.5.5h-1a.5.5 0 1 1 0-1h1a.5.5 0 0 1 .5.5Zm-3.134-8.5a.5.5 0 0 1-.183.683l-.866.5a.5.5 0 0 1-.5-.866l.866-.5a.5.5 0 0 1 .683.183Zm-18.573-.207a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707L14.793 16a.5.5 0 0 1 0-.707Zm17 16a.5.5 0 0 1 .707 0l.707.707a.5.5 0 0 1-.707.707L31.793 32a.5.5 0 0 1 0-.707Zm-14.427.207a.5.5 0 0 1-.183.683l-.866.5a.5.5 0 0 1-.5-.866l.866-.5a.5.5 0 0 1 .683.183ZM13.5 24a.5.5 0 0 1-.5.5h-1a.5.5 0 1 1 0-1h1a.5.5 0 0 1 .5.5Z" fill="#2E73E5" fill-rule="nonzero"/><path d="M24 17a1 1 0 0 1 1 1v8a1 1 0 0 1-2 0v-8a1 1 0 0 1 1-1Z" fill="#FFF"/><path d="M24 16.8a1.2 1.2 0 0 1 1.2 1.2v8a1.2 1.2 0 1 1-2.4 0v-8a1.2 1.2 0 0 1 1.2-1.2Zm0 .2a1 1 0 0 0-1 1v8a1 1 0 0 0 2 0v-8a1 1 0 0 0-1-1Z" fill-opacity=".134" fill="#2E73E5" fill-rule="nonzero"/><path d="M33 24a1 1 0 0 1-1 1h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 1 1Z" fill="#FFF"/><path d="M32 23a1 1 0 0 1 0 2h-8a1 1 0 0 1 0-2h8Zm0 .2h-8a.8.8 0 1 0 0 1.6h8a.8.8 0 1 0 0-1.6Z" fill-opacity=".391" fill="#2E73E5" fill-rule="nonzero"/><circle fill="#FFA519" cx="24" cy="25" r="3"/><path d="M24 21.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7Zm0 .5a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z" fill-opacity=".107" fill="#2E73E5" fill-rule="nonzero"/><circle stroke="#FFCB4C" stroke-width=".2" fill="#FFEBCB" cx="24" cy="25" r="1.9"/></g></svg>','<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h48v48H0z"/><path data-follow-fill="#FFA519" fill="#FFA519" d="M24 3c11.598 0 21 9.402 21 21s-9.402 21-21 21S3 35.598 3 24 12.402 3 24 3Zm0 29.4a2.1 2.1 0 1 0 0 4.2 2.1 2.1 0 0 0 0-4.2Zm0-21a2.807 2.807 0 0 0-2.8 2.993l.88 13.211a1.924 1.924 0 0 0 3.84 0l.88-13.21A2.807 2.807 0 0 0 24 11.4Z" fill-rule="nonzero"/></g></svg>','<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="#0C1024" d="M8 2a1 1 0 0 1 .117 1.993L8 4H4v4a1 1 0 0 1-1.993.117L2 8V3a1 1 0 0 1 1-1h5Zm13 0a1 1 0 0 1 .993.883L22 3v5a1 1 0 0 1-1.993.117L20 8V4h-4a1 1 0 0 1-.117-1.993L16 2h5Zm-5 20a1 1 0 0 1-.117-1.993L16 20h4v-4a1 1 0 0 1 1.993-.117L22 16v5a1 1 0 0 1-.883.993L21 22h-5ZM3 15a1 1 0 0 1 .993.883L4 16v4h4a1 1 0 0 1 .117 1.993L8 22H3a1 1 0 0 1-1-1v-5a1 1 0 0 1 1-1Z" fill="#0C1024" fill-rule="nonzero"/></g></svg>'].map((function(e){var t=tr(e="data:image/svg+xml,"+encodeURIComponent(e));return er(t),t})),ff[0];var Cf=ff[1],Sf=ff[2],kf=ff[3],_f=ff[4],Tf=ff[5],If=ff[6],Pf=ff[7],Nf=ff[8],Mf=ff[9],Af=ff[10],Df=ff[11],Rf=ff[12],Bf=ff[13];function Lf(e){return"data:image/svg+xml,"+encodeURIComponent('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="'.concat(e,'" d="m22.951 11.682.008.023a.992.992 0 0 1 .044.29v.01a.998.998 0 0 1-.052.314l-.005.014a.994.994 0 0 1-.102.208l.048-.082a.997.997 0 0 1-.042.074C19.68 17.467 16.06 20 12 20s-7.68-2.533-10.842-7.46a1.02 1.02 0 0 1-.084-.161.995.995 0 0 1 .08-.912l.004-.007C4.321 6.533 7.938 4 12 4c4.061 0 7.68 2.533 10.844 7.46l.006.008a.997.997 0 0 1 .042.073l-.048-.081a1.01 1.01 0 0 1 .102.207l.005.015ZM12 6c-3.145 0-6.075 1.96-8.802 6 2.727 4.04 5.657 6 8.802 6 3.145 0 6.076-1.959 8.805-5.998C18.076 7.959 15.145 6 12 6Zm0 2a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" fill="').concat(e,'" fill-rule="nonzero"/></g></svg>'))}er(tr("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g transform="translate(-1 -1)" fill-rule="evenodd" fill="none"><path d="M0 0h24v24H0z"/><circle r="10" cy="12" cx="12" fill="#FFF"/><circle r="11" cy="12" cx="12" fill="#5792F2"/><path d="M12 5c-3.86 0-7 3.14-7 7s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7Zm-6.067 7c0-1.463.52-2.807 1.387-3.856.09.102.165.236.2.414.072.382-.195 1.635.145 1.91.519.42 1.322.068 1.735.321.419.257 1.461 1.454 1.868 1.211.685-.409-.488-2.023-.539-2.46-.074-.647.334-1.405 1.079-1.13.467.174.565.797 1.001.822.437.026.233-1.345.231-1.566-.004-.619.605-1.059 1.254-1.28A6.075 6.075 0 0 1 18.067 12a6.028 6.028 0 0 1-.696 2.817c-.051-.544-.183-1.148-.514-1.333-.642-.36-1.356-.016-1.875-.591-.214-.238.056-1.3-.59-1.554-1.254-.496-2.27.527-2.578 1.349a2.407 2.407 0 0 0-.112 1.174c.012 1.317-.67 1.318-.41 1.846.282.579 1.295.373 1.098 1.585a.807.807 0 0 1-.246.466 7.618 7.618 0 0 1-.36.224c-.067.027-.137.05-.208.067A6.073 6.073 0 0 1 5.933 12Z" fill-rule="nonzero" fill="#FFF"/></g></svg>')));var Of=tr(Lf("#0C1024")),Ff=tr(Lf("#C2C3C8")),zf=tr("data:image/svg+xml,"+encodeURIComponent('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="#0C1024" d="m10.998 15.874-.001-.001-1.641 1.644-1.527 1.525h-.001l-1.898 1.9a1 1 0 0 1-1.415-1.415l1.542-1.54c-1.63-1.169-3.167-2.842-4.611-5.007l-.293-.448a.995.995 0 0 1-.071-.93l.05-.098.026-.044C4.321 6.533 7.938 4 12 4c2.119 0 4.117.69 5.993 2.048l2.079-2.077a1 1 0 1 1 1.414 1.414L10.998 15.874Zm9.9-7.073a24.711 24.711 0 0 1 1.63 2.176l.322.491.026.044.042.084.028.07.023.074.018.081.012.087.004.097a1 1 0 0 1-.01.145l-.026.116-.036.107-.04.086-.045.077-.235.362C19.5 17.593 15.96 20 12 20a9.464 9.464 0 0 1-2.073-.228l1.777-1.778L12 18c3.145 0 6.076-1.959 8.805-5.998a22.897 22.897 0 0 0-1.326-1.782L20.9 8.8l-.002.001ZM12 6c-3.145 0-6.075 1.96-8.802 6 1.38 2.043 2.81 3.555 4.295 4.55l1.7-1.7a4 4 0 1 1 5.657-5.657l1.706-1.71C15.09 6.49 13.572 6 12 6Zm0 4a2 2 0 0 0-1.393 3.435l2.827-2.829A1.994 1.994 0 0 0 12 10Z" fill="#0C1024" fill-rule="nonzero"/></g></svg>'));er(Of),er(Ff),er(zf);var Hf=tr("data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><g fill-rule="evenodd" fill="none"><path d="M0 0h40v40H0z"/><path fill="#91939C" d="M8.333.833h17.234a5 5 0 0 1 3.363 1.3l6.1 5.546a5 5 0 0 1 1.637 3.7v22.788a5 5 0 0 1-5 5H8.333a5 5 0 0 1-5-5V5.833a5 5 0 0 1 5-5Z"/><path fill="#C2C3C8" d="M8.333.833h17V8a3.333 3.333 0 0 0 3.334 3.333h8v22.834a5 5 0 0 1-5 5H8.333a5 5 0 0 1-5-5V5.833a5 5 0 0 1 5-5Z"/><path fill-rule="nonzero" fill="#ECECEE" d="m31.66 39.166-19.118-.005L25.784 25.4a2.667 2.667 0 0 1 3.833 0l7.043 7.279v1.488a4.998 4.998 0 0 1-4.999 5l-.001-.001Z"/><path fill-rule="nonzero" fill="#DBDBDE" d="M8.167 39.161c-1.805-.024-3.293-1.106-4.047-2.3l7.147-7.386a2.667 2.667 0 0 1 3.833 0l9.373 9.686H8.167Z"/><path fill="#ECECEE" d="M9.778 18.05c0 1.84 1.444 3.333 3.226 3.333s3.226-1.492 3.226-3.333c0-1.841-1.444-3.333-3.226-3.333s-3.226 1.492-3.226 3.333Z"/></g></svg>'));er(Hf);var Uf=function(e){var t=js.value,n=t.renderApp,i=t.exportType;if(1!==e.status)0!==e.status&&i||Vf(e);else{if(i||!n)return;Wf(e)}},Wf=function(e){var t=js.value.renderApp,n=e.position,i=e.size,r=e.scale;yf(e),t&&gp({x:n.x,y:n.y,width:i.width*r,height:i.height*r,beginTime:e.beginLoadTime,renderTarget:e}),ma()},Vf=function(e){var t,n=js.value,i=n.exportType,r=n.viewbox,o=e.position,a=e.size,s=e.scale,l=e.imageFile,c=e.coverSize,u=e.showPreviewBtn,d=e.showPreviewInfo,p=Xe.width,h=Xe.height,f=a.width/p*s,m=432,v=158,g=m,y=g*c.height/c.width;t=y<v?{x:((g=(y=v)*c.width/c.height)-m)/2/g,y:0,width:m/g,height:1}:{x:0,y:(y-v)/2/y,width:1,height:v/y};var b=y*f*e.globalTransform.currentScale*r.scale,E=[["M",p,0],["L",p,h],["L",0,h],["L",0,0],["Z"]],x=l&&pf({imageFile:l,realHeight:b,exportType:i,renderTarget:e}),w=!i&&e.preview,C=function(){var t=e.useCallback("drawHeader",(function(e){e.clear(),e.beginFill(16119542),e.drawRect(0,0,p,26),e.endFill(),e.lineStyle(1,15527150),e.moveTo(0,25.5),e.lineTo(p,25.5)}),[]);Na(t),Oa({src:Pf,x:8,y:3,width:20,height:20});var n=p;if(d){var i=O("webpage.header.info"),r=e.useMemo("infoText",(function(){return{text:i,lineHeight:20,fontSize:10}}),[i]),o=Da(r).width;Ra(r,{x:p-4-o-112,y:3,fill:"#91939C",ha:"left"}),n-=o+4}if(e.previewBtn.disabled=!u,u){n-=82,e.previewBtn.render(),Oa({src:w?zf:Of,x:376,y:6,width:14,height:14});var a=O(w?"webpage.header.cancelPreview":"webpage.header.preview");Ra(e.useMemo("btnText",(function(){return{text:a,lineHeight:20,fontSize:10,textWidth:40}}),[a]),{x:394,y:3,fill:"#0C1024",ha:"center"})}else Ra({text:O("webpage.header.preview.tip"),lineHeight:20,fontSize:10,textWidth:128},{x:322,y:3,fill:"#91939c",ha:"center"});n-=30,e.maxBtn.render(),n-=44,Ra(e.useMemo("nameData",(function(){return{text:e.name,lineHeight:20,fontSize:10,textWidth:Math.min(n,180),lineClamp:1,fontFamily:He,textOverflow:"ellipse"}}),[e.name,n]),{x:36,y:3,fill:"#0C1024"})};if(w)return yf(e),fa({x:o.x,y:o.y,scaleX:f,scaleY:f}),za([new Sa(E)]),C(),Ua({x:0,y:26,width:p,height:h-26}),fa({stroke:"#DBDBDE",lineWidth:2}),Ta(E),ma(),ma(),void ma();yf(e),fa({x:o.x,y:o.y,scaleX:f,scaleY:f}),za([new Sa(E)]),C(),fa({y:26,fill:"#fff"}),ka({x:0,y:0,width:p,height:h}),e.coverFileId?Oa({x:24,y:20,width:m,height:v,src:x,clipRect:t,backgroundColor:"#fff"}):(fa({x:24,y:20,fill:"#ECECEE"}),ka({x:0,y:0,width:m,height:v}),Oa({x:196,y:59,width:40,height:40,src:Hf}),ma());var S=e.title||(null==O?void 0:O("webpage.notitle"))||"";Ra(e.useMemo("contentTitle",(function(){return{text:S,fontFamily:He,lineHeight:24,textWidth:432,fontSize:16,lineClamp:1,textOverflow:"ellipse"}}),[S]),{x:24,y:194,fontWeight:"bold",fill:"#0C1024"});var k=e.description||(null==O?void 0:O("webpage.nodesc"))||"";Ra(e.useMemo("contentDesc",(function(){return{text:k,fontFamily:He,lineHeight:18,textWidth:432,fontSize:12,lineClamp:2,textOverflow:"ellipse"}}),[S]),{x:24,y:218,fill:"#91939C"}),ma(),fa({stroke:"#DBDBDE",lineWidth:2}),Ta(E),ma(),ma(),ma()};function jf(e,t){var n,i=t.upime,r=t.frames,o=void 0===r?[]:r,a=t.viewbox,s=t.size,l=s.width,c=s.height,u=t.renderTree,d=t.background,p=t.watermark,h=t.bgImages,f="svg"===e?"svg":"base64",m=u,v=a.left,g=a.top,y=a.scale;js.setContext({viewbox:a,upime:i,exportType:f}),Na((function(e){e.clear(),void 0!==d?e.beginFill(d,1):e.beginFill(0,0),e.drawRect(0,0,l,c)})),fa({x:-v*y,y:-g*y,scaleX:y,scaleY:y}),null==h||h.forEach((function(e){i.view.bgRender.renderBg(e)})),o.forEach((function(e){return e.bgRenderer(e)})),Vs(m),ma(),fa({x:-v*y,y:-g*y}),o.filter((function(e){return e.hide})).forEach((function(e){return e.renderer(e)})),ma(),p&&function(e){var t=e.source,n=e.position,i=e.viewbox,r=(i.right-i.left)*i.scale,o=(i.bottom-i.top)*i.scale,a=0,s=0,l=t.originWidth,c=t.originHeight;n.left&&(a=n.left),n.right&&(a=r-l-n.right),n.top&&(s=n.top),n.bottom&&(s=o-c-n.bottom),Oa({src:t,x:a,y:s,width:l,height:c})}(exports.E(exports.E({},p),{viewbox:a})),(null===(n=i.watermark)||void 0===n?void 0:n.affectExport)&&Zc(i,a),js.popContext()}var Gf,qf=function(e){function t(t){var n=this,i=document.createElement("canvas");return(n=e.call(this,i,t.size.width,t.size.height)||this).option=t,n}return P(t,e),t.prototype.paint=function(){jf("jpeg",this.option)},t}(ba),Kf=function(e){function t(t){var n=e.call(this,t.size.width,t.size.height)||this;return n.option=t,n}return P(t,e),t.prototype.paint=function(){jf("svg",this.option)},t}(Ea);function Yf(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,Zf("svg",e)]}))}))}function Xf(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,Zf("png",e)]}))}))}function Qf(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,Zf("jpeg",e)]}))}))}function Zf(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){return[2,new Promise((function(n,i){var r=t.upime,o=t.viewbox,a=t.timeout,s=void 0===a?1e3:a,l=t.renderTree,c=t.watermark,u=t.onBeforeDraw,d=t.contentType,p=N(t,["renderTree","watermark","onBeforeDraw","contentType"]),h=null!=l?l:r.view.elementsRoot.calcRenderTree(o),f=p.useBgImage?r.view.bgRender.getBgImgsInViewbox(o):void 0,m=exports.E(exports.E({},p),{renderTree:h,bgImages:f}),v="svg"===e?"svg":"base64",g=!1,y=0;if(c){var b=tr(c.watermarkUrl);m.watermark={source:b,position:c.position},er(b),S(b,!0)}var E=window.setTimeout((function(){w()}),s);function x(e){e?y++:y--,0===y&&w()}function w(){if(!g)if(g=!0,clearTimeout(E),u&&u(),"svg"===v){var t=Array.from(Be.values()).map((function(e){return{name:e.family,url:we+e.url}})),r=(o=new Kf(m)).exportSvg({fonts:t});n(r)}else{var o;(o=new qf(m)).render(),d!==Gf.Blob?n(o.base64("image/".concat(e))):o.blob("image/".concat(e)).then((function(e){null!==e?n(e):i(new Error("toBlob failed"))})).catch(i)}}function C(e,t){var n=pf({imageFile:e,realHeight:t,exportType:v,renderTarget:null});return"svg"===v?n.imgSrc||(x(!0),e.subscribe("imgSrcUpdate",(function(e){e===n&&x(!1)}))):n.loaded||(x(!0),nr(n,(function(){return x(!1)}))),n}function S(e,t){void 0===t&&(t=!1),"svg"===v&&!t||e.loaded||(x(!0),nr(e,(function(){return x(!1)})))}var k=function(e){e.children.forEach((function(e){if(e.refSystem)k(e);else switch(e.elementType){case Za.IMAGE:var t=e,n=t.imageFile,i=t.size,r=t.scale,a=t.globalTransform;n&&C(n,i.height*r*a.currentScale*o.scale);break;case Za.DOCUMENT:var s=e,l=s.currentPageFile,c=s.exportPageFile;i=s.size,r=s.scale,(n=c||l)&&C(n,i.height*r*o.scale);break;case Za.STICKER:var u=e.bgImg;u&&S(u);break;case Za.VIDEO:var d=e.coverSource;d&&S(d);break;case Za.WEBPAGE:(n=e.imageFile)&&C(n,(h=o,(m=432*(f=(p=e).coverSize).height/f.width)<158&&(m=158),m*p.scale*p.globalTransform.currentScale*h.scale))}var p,h,f,m}))};null==f||f.forEach((function(e){var t=C(e.imageFile,e.size.height*o.scale);e.lastestSource=t})),k(h),0===y&&w()}))]}))}))}function Jf(e,t,n,i,r,o,a){return void 0===i&&(i="png"),void 0===a&&(a=Gf.Base64),A(this,void 0,void 0,(function(){var s,l,c,u,d,p,h,f,m,v,g,y,b,E,x;return D(this,(function(w){return s=n.width,l=n.height,c=[t],u=t.getBorderBox(),d=u.right-u.left,p=u.bottom-u.top,h=s/d,f=l/p,m=Math.max(h,f),v=u.left,g=u.top,y={left:v,top:g,right:v+s/m,bottom:g+l/m,scale:m},b=t.getMembers(),E=e.view.elementsRoot,x={refSystem:E,children:[]},E.children.forEach((function(e){e.isRefSystem&&e.baseElement&&b.includes(e.baseElement)?x.children.push(e.calcRenderTree(y)):b.includes(e)&&x.children.push(e)})),"jpg"===i?[2,Qf({upime:e,frames:c,renderTree:x,viewbox:y,size:n,watermark:r,background:o,contentType:a})]:[2,Xf({upime:e,frames:c,renderTree:x,viewbox:y,size:n,watermark:r,background:o,contentType:a})]}))}))}function $f(e,t,n){var i,r;return A(this,void 0,void 0,(function(){var o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:if(void 0===(o=t.elementManager.getElementById(e)))throw new Error("element is undefined");return a=null!==(i=null==n?void 0:n.scale)&&void 0!==i?i:1,s=o.getBorderBox(),Bu(o)&&!0===o.isRootNode&&(l=R([o],o.getDescendants(),!0),s=Yt(l.map((function(e){return e.getGlobalBox()})))),c=(s.right-s.left)*a,u=(s.bottom-s.top)*a,d=[],o.elementType===Za.FRAME&&d.push(o),p=function(e,t){if(zu(e)){var n=e.getBorderBox(),i=exports.E(exports.E({},n),{scale:1}),r=e.getMembers(),o=t.view.elementsRoot,a={refSystem:o,children:[]};return o.children.forEach((function(e){e.isRefSystem&&e.baseElement&&r.includes(e.baseElement)?a.children.push(e.calcRenderTree(i)):r.includes(e)&&a.children.push(e)})),a}var s=t.view.elementsRoot,l={refSystem:s,children:[]};!function(e){var t=e.parentRefSystem;if(t){var n=function(e){if(e===s)return l;var t,i=e.parentRefSystem;if(i&&(t=i===s?l:n(i))){var r=t.children.find((function(t){return t.refSystem===e}));return r||(r={refSystem:e,children:[]},t.children.push(r),r)}},i=n(t);i&&i.children.push(e)}}(e);var c=function(e){e.children.forEach((function(e){e.refSystem&&c(e)})),e.children.sort((function(e,t){return Hs(e.refSystem||e,t.refSystem||t)}))};return c(l),l}(o,t),h={upime:t,frames:d,renderTree:p,viewbox:exports.E(exports.E({},s),{scale:a}),timeout:1e4,size:{width:c,height:u},contentType:null!==(r=null==n?void 0:n.contentType)&&void 0!==r?r:Gf.Base64},f=!0===(null==n?void 0:n.svg)?Yf(h).catch((function(){})):Promise.resolve(),m=!0===(null==n?void 0:n.png)?Xf(h).catch((function(){})):Promise.resolve(),v=!0===(null==n?void 0:n.jpg)?Xf(h).catch((function(){})):Promise.resolve(),[4,Promise.all([f,m,v])];case 1:return g=x.sent(),y=g[0],b=g[1],E=g[2],[2,{svg:null!=y?y:null,png:null!=b?b:null,jpg:null!=E?E:null,width:c,height:u}]}}))}))}function em(e,t,n,i){return void 0===i&&(i=1),A(this,void 0,void 0,(function(){var r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:if(void 0===(r=t.elementManager.getElementById(e)))throw new Error("element is undefined");return[4,$f(e,t,{contentType:Gf.Blob,svg:!0===n.svg,png:!0===n.png,jpg:!0===n.jpg,scale:i})];case 1:return o=x.sent(),a=o.svg,s=o.png,l=o.jpg,c=o.width,u=o.height,d=t.genFileName("element_".concat(r.id,"_snapshot")),p=[],h={svgFileId:null,pngFileId:null,jpgFileId:null,width:c,height:u},null!==a&&(f=Y(a),m=new File([f],"".concat(d,".svg"),{lastModified:Date.now()}),v=t.saveFile(2,{file:m,ext:"svg",fakeName:"".concat(d,".svg")}).then((function(e){h.svgFileId=e})).catch((function(){})),p.push(v)),null!==s&&(g=new File([s],"".concat(d,".png"),{lastModified:Date.now()}),y=t.saveFile(2,{file:g,ext:"png",fakeName:"".concat(d,".png")}).then((function(e){h.pngFileId=e})).catch((function(){})),p.push(y)),null!==l&&(b=new File([l],"".concat(d,".jpg"),{lastModified:Date.now()}),E=t.saveFile(2,{file:b,ext:"jpg",fakeName:"".concat(d,".jpg")}).then((function(e){h.jpgFileId=e})).catch((function(){})),p.push(E)),[4,Promise.all(p)];case 2:return x.sent(),[2,h]}}))}))}function tm(e,t,n,i){return void 0===i&&(i=1),A(this,void 0,void 0,(function(){var r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:if(void 0===(r=t.elementManager.getElementById(e)))throw new Error("element is undefined");return[4,$f(e,t,{contentType:Gf.Blob,svg:!0===n.svg,png:!0===n.png,jpg:!0===n.jpg,scale:i})];case 1:return o=x.sent(),a=o.svg,s=o.png,l=o.jpg,c=o.width,u=o.height,d=t.genFileName("element_".concat(r.id,"_temp_snapshot")),p=[],h={svgFilePath:null,pngFilePath:null,jpgFilePath:null,width:c,height:u},null!==a&&(f=Y(a),m=new File([f],"".concat(d,".svg"),{lastModified:Date.now()}),v=t.uploadToOssBySdk({file:m,ext:"svg",fakeName:"".concat(d,".svg")},1).then((function(e){h.svgFilePath=e.name})).catch((function(){})),p.push(v)),null!==s&&(g=new File([s],"".concat(d,".png"),{lastModified:Date.now()}),y=t.uploadToOssBySdk({file:g,ext:"png",fakeName:"".concat(d,".png")},1).then((function(e){h.pngFilePath=e.name})).catch((function(){})),p.push(y)),null!==l&&(b=new File([l],"".concat(d,".jpg"),{lastModified:Date.now()}),E=t.uploadToOssBySdk({file:b,ext:"jpg",fakeName:"".concat(d,".jpg")},1).then((function(e){h.jpgFilePath=e.name})).catch((function(){})),p.push(E)),[4,Promise.all(p)];case 2:return x.sent(),[2,h]}}))}))}!function(e){e.Blob="Blob",e.Base64="Base64"}(Gf||(Gf={}));var nm,im=function(t){var n=t.exportFileType,i=t.size,r=t.frameElement,o=t.selected,a=t.onClick,s=e.useContext(xl).upime,l=function(){var t=e.useRef(null),n=e.useState(!1),i=n[0],r=n[1];return e.useEffect((function(){var e,n=!1;return null!==t.current&&(e=new IntersectionObserver((function(e){var t=e[0];!1===n&&r(t.isIntersecting)}),{threshold:0}),e.observe(t.current)),function(){n=!0,null!==t.current&&void 0!==e&&e.unobserve(t.current)}}),[t.current]),{elementRef:t,isVisible:i}}(),c=l.elementRef,u=l.isVisible,d=e.useState(null),p=d[0],h=d[1],f=e.useRef(null);return e.useEffect((function(){if(u&&null===p){var e=r.getBorderBox();Jf(s,r,{width:e.right-e.left,height:e.bottom-e.top},"jpg",void 0,r.hasBg?void 0:16777215,Gf.Blob).then((function(e){var t=URL.createObjectURL(e);h(t),f.current=t}))}}),[u]),e.useEffect((function(){return function(){null!==f.current&&URL.revokeObjectURL(f.current)}}),[]),e.createElement("div",{className:j("frameItem_1aNbJ",i===ef.Small&&"small_2531N",i===ef.Large&&"large_3j-LO"),ref:c,onClick:function(){a(r.id)}},e.createElement(of,{className:"checkbox_1pP55",state:o?Zh.SelectAll:Zh.SelectNone}),e.createElement("div",{className:"snapshot_1KexN",style:{backgroundColor:n===tf.Pptx?pr(r.bgColor):"#000"}},i===ef.Small&&null!==p&&e.createElement("img",{src:p,alt:""}),i===ef.Large&&null!==p&&e.createElement("img",{src:p,alt:""})),i===ef.Small&&e.createElement(Dl,{content:r.name,placement:"top",rootClass:"nameContainer_1HyEg"},e.createElement("div",{className:"name_1Fpo-"},r.name)))};function rm(){var t=e.useState(!1),n=t[0],i=t[1];return{isLocking:n,start:e.useCallback((function(){i(!0)}),[]),stop:e.useCallback((function(){i(!1)}),[])}}function om(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return nm?[2,nm]:[4,import("agora-rtc-sdk-ng")];case 1:return nm=e.sent().default,[2]}}))}))}function am(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then((function(){return require("./pdf_lib-441bb0e2-1cbf02ba.js")}))];case 1:return[2,e.sent()]}}))}))}function sm(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then((function(){return require("./hls-68a5b590-c123371d.js")}))];case 1:return[2,e.sent()]}}))}))}var lm=function(){function e(e){this.concurrencyLimit=e,this.running=0,this.queue=[]}return e.prototype.push=function(e){var t=this;return new Promise((function(n,i){t.queue.push({task:e,resolve:n,reject:i}),t.run()}))},e.prototype.run=function(){return A(this,void 0,void 0,(function(){var e,t,n,i,r,o;return D(this,(function(a){switch(a.label){case 0:if(!(this.running<this.concurrencyLimit&&this.queue.length>0))return[3,5];if(void 0===(e=this.queue.shift()))return this.run(),[2];t=e.task,n=e.resolve,i=e.reject,this.running++,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t()];case 2:return r=a.sent(),n(r),[3,4];case 3:return o=a.sent(),i(o),[3,4];case 4:this.running--,this.run(),a.label=5;case 5:return[2]}}))}))},e.prototype.cancelAll=function(){this.queue=[]},e}(),cm=function(){function e(e){this.upime=e,this.id=ia(),this.destroyed=!1,this.completedTaskCount=0,this.totalTaskCount=0,this.taskQueue=new lm(1)}return e.prototype.exportPdfFromDocumentElement=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C=this;return D(this,(function(S){switch(S.label){case 0:n=[],i=this.upime,r=[],o=e.size,a=e.position,s=e.scale,l=e.titleHeight,c=Math.floor(o.width*s),u=Math.floor(o.height*s),d=Bt({x:a.x,y:a.y+l*s,width:c,height:u}),p=Math.ceil(o.height*s),h=function(o){var a,s,l,h;return D(this,(function(m){switch(m.label){case 0:return a=f.upime.elementManager.getDocumentPageRS(e.id,o),e.switchExportPage(o),s={refSystem:e.parentRefSystem,children:[e,{refSystem:a,children:a.children}]},r.push([c,p]),l=t?{watermarkUrl:t,position:{right:30,bottom:20}}:void 0,[4,Yf({upime:i,viewbox:exports.E(exports.E({},d),{scale:1}),size:{width:c,height:u},timeout:2e3,watermark:l,renderTree:s,onBeforeDraw:function(){return a.updateTransformForce(sr,e)}})];case 1:return h=m.sent(),n.push(Y(h)),[2]}}))},f=this,m=1,S.label=1;case 1:return m<=e.totalPage?[5,h(m)]:[3,4];case 2:S.sent(),S.label=3;case 3:return m++,[3,1];case 4:e.resetExportPage(),v=[],g=function(e,t){v.some((function(t){return t.pageNum===e}))||v.push({pageNum:e,annotList:[]}),v.find((function(t){return t.pageNum===e})).annotList.push(t)},this.upime.elementManager.getAllComments((function(t){var n=t.position,r=t.attached;if(n.parentType===Za.DOCUMENT){var o=n.parentId,a=n.pageId,s=n.x,l=n.y;if(o!==e.id)return;(d=i.commentManager.parseCommentTextContent(t.id))&&g(a,{position:{x:s/e.size.width,y:l/e.size.height},list:d})}else{if(n.parentType)return;if(r){var c=C.upime.elementManager.getElementById(r);if(!c||c.deleted)return;var u=c.position;if(u.parentType!==Za.DOCUMENT||u.parentId!==e.id)return;var d,p=t.getGlobalPosition(),h=e.getGlobalBox();Ot(p,h)&&(d=i.commentManager.parseCommentTextContent(t.id)).length&&g(u.pageId,{position:{x:(p.x-h.left)/(h.right-h.left),y:(p.y-h.top)/(h.bottom-h.top)},list:d})}}})),y=v.length?{annotInfo:v}:void 0,S.label=5;case 5:return S.trys.push([5,8,,9]),[4,i.svgToPdf(n,r,y)];case 6:return b=S.sent(),E=document.createElement("a"),[4,X(b)];case 7:return x=S.sent(),E.href=window.URL.createObjectURL(x),(w=e.name).endsWith(".pdf")||(w+=".pdf"),E.download=w,E.click(),[2,0];case 8:return S.sent(),[2,-1];case 9:return[2]}}))}))},e.prototype.exportPdfBySvg=function(e){return void 0===e&&(e={}),A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S=this;return D(this,(function(k){switch(k.label){case 0:if(t=e.fileName,n=void 0===t?"untitled":t,i=e.watermarkUrl,r=e.frames,o=this.upime,0===(a=null!=r?r:o.framesListManager.sequentialFrames).length)return[2];for(this.totalTaskCount=a.length,s=-1,l=-1,c=0,u=a;c<u.length;c++)E=u[c],d=E.size,p=1e3*Math.sqrt(d.width/d.height)/d.width,(-1===s||p<s)&&(s=p,l=d.width*p);for(h=[],f=[],m=[],v=function(e){var t=e.size,n=e.position,r=l/t.width,a=Bt(exports.E(exports.E({},n),t)),s=Math.floor(t.width*r),c=Math.floor(t.height*r),u=Math.ceil(t.height*r);f.push([s,u]);var d=i?{watermarkUrl:i,position:{right:30,bottom:20}}:void 0,p=g.taskQueue.push((function(){return A(S,void 0,void 0,(function(){return D(this,(function(t){return[2,new Promise((function(t,n){requestIdleCallback((function(){e.hide?Yf({upime:o,frames:[e],viewbox:exports.E(exports.E({},a),{scale:r}),size:{width:s,height:c},timeout:2e3,watermark:d,background:e.hasBg?e.bgColor:16777215,useBgImage:!e.hasBg}).then((function(e){h.push(Y(e)),t()})).catch(n):Yf({upime:o,viewbox:exports.E(exports.E({},a),{scale:r}),size:{width:s,height:c},timeout:2e3,watermark:d,background:e.hasBg?e.bgColor:16777215,useBgImage:!e.hasBg}).then((function(e){h.push(Y(e)),t()})).catch(n)}))}))]}))}))}));p.finally((function(){S.completedTaskCount+=1})),m.push(p)},g=this,y=0,b=a;y<b.length;y++)E=b[y],v(E);return[4,Promise.all(m)];case 1:k.sent(),k.label=2;case 2:return k.trys.push([2,5,,6]),[4,o.svgToPdf(h,f)];case 3:return x=k.sent(),w=document.createElement("a"),[4,X(x)];case 4:return C=k.sent(),w.href=window.URL.createObjectURL(C),w.download=n+".pdf",w.click(),[3,6];case 5:return k.sent(),[3,6];case 6:return[2]}}))}))},e.prototype.exportPdf=function(e){return void 0===e&&(e={}),A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,R=this;return D(this,(function(B){switch(B.label){case 0:if(t=e.fileName,n=void 0===t?"untitled":t,i=e.watermarkUrl,r=e.frames,o=this.upime,0===(a=null!=r?r:o.framesListManager.sequentialFrames).length)return[2];for(this.totalTaskCount=a.length,s=-1,l=-1,c=0,u=a;c<u.length;c++)b=u[c],d=b.size,p=1e3*Math.sqrt(d.width/d.height)/d.width,(-1===s||p<s)&&(s=p,l=d.width*p);for(h=[],f=[],m=function(e){var t=e.size,n=e.position,r=l/t.width,a=Bt(exports.E(exports.E({},n),t)),s=Math.floor(t.width*r),c=Math.floor(t.height*r),u=i?{watermarkUrl:i,position:{right:30,bottom:20}}:void 0,d=v.taskQueue.push((function(){return A(R,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,new Promise((function(n,i){requestIdleCallback((function(){!0===e.hide?Jf(t.upime,e,e.size,"png",u,e.hasBg?void 0:16777215).then((function(e){h.push({src:e,width:s,height:c}),n()})).catch(i):Xf({upime:o,viewbox:exports.E(exports.E({},a),{scale:r}),size:{width:s,height:c},timeout:2e3,watermark:u,background:e.hasBg?e.bgColor:16777215,useBgImage:!e.hasBg}).then((function(e){h.push({src:e,width:s,height:c}),n()})).catch(i)}))}))]}))}))}));d.finally((function(){R.completedTaskCount+=1})),f.push(d)},v=this,g=0,y=a;g<y.length;g++)b=y[g],m(b);return[4,Promise.all(f)];case 1:return B.sent(),0===h.length?[2]:[4,am()];case 2:return[4,B.sent().PDFDocument.create()];case 3:E=B.sent(),x=0,w=h,B.label=4;case 4:return x<w.length?(C=w[x],S=C.src,k=C.width,_=C.height,T=E.addPage([k,_]),[4,E.embedPng(S)]):[3,7];case 5:if(I=B.sent(),T.drawImage(I,{x:0,y:0,width:k,height:_}),this.destroyed)return[2];B.label=6;case 6:return x++,[3,4];case 7:return[4,E.save()];case 8:return P=B.sent(),this.destroyed||(N=new Blob([P],{type:"application/pdf"}),(M=document.createElement("a")).href=window.URL.createObjectURL(N),M.download=n+".pdf",M.click()),[2]}}))}))},e.prototype.destroy=function(){this.taskQueue.cancelAll(),this.destroyed=!0},M([rl],e.prototype,"completedTaskCount",void 0),M([rl],e.prototype,"totalTaskCount",void 0),M([il],e)}();function um(e){return dm(e.map((([e,t])=>new Array(e).fill(t,0,e))))}function dm(e){return e.reduce(((e,t)=>e.concat(Array.isArray(t)?dm(t):t)),[])}const pm=[0,1,2,3].concat(...um([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function hm(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.build_tree=function(n){const i=e.dyn_tree,r=e.stat_desc.static_tree,o=e.stat_desc.elems;let a,s,l,c=-1;for(n.heap_len=0,n.heap_max=573,a=0;a<o;a++)0!==i[2*a]?(n.heap[++n.heap_len]=c=a,n.depth[a]=0):i[2*a+1]=0;for(;n.heap_len<2;)l=n.heap[++n.heap_len]=c<2?++c:0,i[2*l]=1,n.depth[l]=0,n.opt_len--,r&&(n.static_len-=r[2*l+1]);for(e.max_code=c,a=Math.floor(n.heap_len/2);a>=1;a--)n.pqdownheap(i,a);l=o;do{a=n.heap[1],n.heap[1]=n.heap[n.heap_len--],n.pqdownheap(i,1),s=n.heap[1],n.heap[--n.heap_max]=a,n.heap[--n.heap_max]=s,i[2*l]=i[2*a]+i[2*s],n.depth[l]=Math.max(n.depth[a],n.depth[s])+1,i[2*a+1]=i[2*s+1]=l,n.heap[1]=l++,n.pqdownheap(i,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],function(t){const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,a=e.stat_desc.max_length;let s,l,c,u,d,p,h=0;for(u=0;u<=15;u++)t.bl_count[u]=0;for(n[2*t.heap[t.heap_max]+1]=0,s=t.heap_max+1;s<573;s++)l=t.heap[s],u=n[2*n[2*l+1]+1]+1,u>a&&(u=a,h++),n[2*l+1]=u,l>e.max_code||(t.bl_count[u]++,d=0,l>=o&&(d=r[l-o]),p=n[2*l],t.opt_len+=p*(u+d),i&&(t.static_len+=p*(i[2*l+1]+d)));if(0!==h){do{for(u=a-1;0===t.bl_count[u];)u--;t.bl_count[u]--,t.bl_count[u+1]+=2,t.bl_count[a]--,h-=2}while(h>0);for(u=a;0!==u;u--)for(l=t.bl_count[u];0!==l;)c=t.heap[--s],c>e.max_code||(n[2*c+1]!=u&&(t.opt_len+=(u-n[2*c+1])*n[2*c],n[2*c+1]=u),l--)}}(n),function(e,n,i){const r=[];let o,a,s,l=0;for(o=1;o<=15;o++)r[o]=l=l+i[o-1]<<1;for(a=0;a<=n;a++)s=e[2*a+1],0!==s&&(e[2*a]=t(r[s]++,s))}(i,e.max_code,n.bl_count)}}function fm(e,t,n,i,r){const o=this;o.static_tree=e,o.extra_bits=t,o.extra_base=n,o.elems=i,o.max_length=r}hm._length_code=[0,1,2,3,4,5,6,7].concat(...um([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),hm.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],hm.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],hm.d_code=function(e){return e<256?pm[e]:pm[256+(e>>>7)]},hm.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],hm.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],hm.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],hm.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const mm=um([[144,8],[112,9],[24,7],[8,8]]);fm.static_ltree=dm([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map(((e,t)=>[e,mm[t]])));const vm=um([[30,5]]);function gm(e,t,n,i,r){const o=this;o.good_length=e,o.max_lazy=t,o.nice_length=n,o.max_chain=i,o.func=r}fm.static_dtree=dm([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map(((e,t)=>[e,vm[t]]))),fm.static_l_desc=new fm(fm.static_ltree,hm.extra_lbits,257,286,15),fm.static_d_desc=new fm(fm.static_dtree,hm.extra_dbits,0,30,15),fm.static_bl_desc=new fm(null,hm.extra_blbits,0,19,7);const ym=[new gm(0,0,0,0,0),new gm(4,4,8,4,1),new gm(4,5,16,8,1),new gm(4,6,32,32,1),new gm(4,4,16,16,2),new gm(8,16,32,32,2),new gm(8,16,128,128,2),new gm(8,32,128,256,2),new gm(32,128,258,1024,2),new gm(32,258,258,4096,2)],bm=["need dictionary","stream end","","","stream error","data error","","buffer error","",""];function Em(e,t,n,i){const r=e[2*t],o=e[2*n];return r<o||r==o&&i[t]<=i[n]}function xm(){const e=this;let t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A,D;const R=new hm,B=new hm,L=new hm;let O,F,z,H,U,W;function V(){let t;for(t=0;t<286;t++)M[2*t]=0;for(t=0;t<30;t++)A[2*t]=0;for(t=0;t<19;t++)D[2*t]=0;M[512]=1,e.opt_len=e.static_len=0,F=z=0}function j(e,t){let n,i=-1,r=e[1],o=0,a=7,s=4;0===r&&(a=138,s=3),e[2*(t+1)+1]=65535;for(let l=0;l<=t;l++)n=r,r=e[2*(l+1)+1],++o<a&&n==r||(o<s?D[2*n]+=o:0!==n?(n!=i&&D[2*n]++,D[32]++):o<=10?D[34]++:D[36]++,o=0,i=n,0===r?(a=138,s=3):n==r?(a=6,s=3):(a=7,s=4))}function G(t){e.pending_buf[e.pending++]=t}function q(e){G(255&e),G(e>>>8&255)}function K(e,t){let n;const i=t;W>16-i?(n=e,U|=n<<W&65535,q(U),U=n>>>16-W,W+=i-16):(U|=e<<W&65535,W+=i)}function Y(e,t){const n=2*e;K(65535&t[n],65535&t[n+1])}function X(e,t){let n,i,r=-1,o=e[1],a=0,s=7,l=4;for(0===o&&(s=138,l=3),n=0;n<=t;n++)if(i=o,o=e[2*(n+1)+1],!(++a<s&&i==o)){if(a<l)do{Y(i,D)}while(0!=--a);else 0!==i?(i!=r&&(Y(i,D),a--),Y(16,D),K(a-3,2)):a<=10?(Y(17,D),K(a-3,3)):(Y(18,D),K(a-11,7));a=0,r=i,0===o?(s=138,l=3):i==o?(s=6,l=3):(s=7,l=4)}}function Q(){16==W?(q(U),U=0,W=0):W>=8&&(G(255&U),U>>>=8,W-=8)}function Z(t,n){let i,r,o;if(e.dist_buf[F]=t,e.lc_buf[F]=255&n,F++,0===t?M[2*n]++:(z++,t--,M[2*(hm._length_code[n]+256+1)]++,A[2*hm.d_code(t)]++),!(8191&F)&&T>2){for(i=8*F,r=x-g,o=0;o<30;o++)i+=A[2*o]*(5+hm.extra_dbits[o]);if(i>>>=3,z<Math.floor(F/2)&&i<Math.floor(r/2))return!0}return F==O-1}function J(t,n){let i,r,o,a,s=0;if(0!==F)do{i=e.dist_buf[s],r=e.lc_buf[s],s++,0===i?Y(r,t):(o=hm._length_code[r],Y(o+256+1,t),a=hm.extra_lbits[o],0!==a&&(r-=hm.base_length[o],K(r,a)),i--,o=hm.d_code(i),Y(o,n),a=hm.extra_dbits[o],0!==a&&(i-=hm.base_dist[o],K(i,a)))}while(s<F);Y(256,t),H=t[513]}function $(){W>8?q(U):W>0&&G(255&U),U=0,W=0}function ee(t,n,i){K(0+(i?1:0),3),function(t,n,i){$(),H=8,q(n),q(~n),e.pending_buf.set(l.subarray(t,t+n),e.pending),e.pending+=n}(t,n)}function te(t,n,i){let r,o,a=0;T>0?(R.build_tree(e),B.build_tree(e),a=function(){let t;for(j(M,R.max_code),j(A,B.max_code),L.build_tree(e),t=18;t>=3&&0===D[2*hm.bl_order[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(),r=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!=t?ee(t,n,i):o==r?(K(2+(i?1:0),3),J(fm.static_ltree,fm.static_dtree)):(K(4+(i?1:0),3),function(e,t,n){let i;for(K(e-257,5),K(t-1,5),K(n-4,4),i=0;i<n;i++)K(D[2*hm.bl_order[i]+1],3);X(M,e-1),X(A,t-1)}(R.max_code+1,B.max_code+1,a+1),J(M,A)),V(),i&&$()}function ne(e){te(g>=0?g:-1,x-g,e),g=x,t.flush_pending()}function ie(){let e,n,i,r;do{if(r=c-C-x,0===r&&0===x&&0===C)r=o;else if(-1==r)r--;else if(x>=o+o-262){l.set(l.subarray(o,o+o),0),w-=o,x-=o,g-=o,e=h,i=e;do{n=65535&d[--i],d[i]=n>=o?n-o:0}while(0!=--e);e=o,i=e;do{n=65535&u[--i],u[i]=n>=o?n-o:0}while(0!=--e);r+=o}if(0===t.avail_in)return;e=t.read_buf(l,x+C,r),C+=e,C>=3&&(p=255&l[x],p=(p<<v^255&l[x+1])&m)}while(C<262&&0!==t.avail_in)}function re(e){let t,n,i=k,r=x,a=S;const c=x>o-262?x-(o-262):0;let d=N;const p=s,h=x+258;let f=l[r+a-1],m=l[r+a];S>=P&&(i>>=2),d>C&&(d=C);do{if(t=e,l[t+a]==m&&l[t+a-1]==f&&l[t]==l[r]&&l[++t]==l[r+1]){r+=2,t++;do{}while(l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&r<h);if(n=258-(h-r),r=h-258,n>a){if(w=e,a=n,n>=d)break;f=l[r+a-1],m=l[r+a]}}}while((e=65535&u[e&p])>c&&0!=--i);return a<=C?a:C}function oe(t){return t.total_in=t.total_out=0,t.msg=null,e.pending=0,e.pending_out=0,n=113,r=0,R.dyn_tree=M,R.stat_desc=fm.static_l_desc,B.dyn_tree=A,B.stat_desc=fm.static_d_desc,L.dyn_tree=D,L.stat_desc=fm.static_bl_desc,U=0,W=0,H=8,V(),function(){c=2*o,d[h-1]=0;for(let e=0;e<h-1;e++)d[e]=0;_=ym[T].max_lazy,P=ym[T].good_length,N=ym[T].nice_length,k=ym[T].max_chain,x=0,g=0,C=0,y=S=2,E=0,p=0}(),0}e.depth=[],e.bl_count=[],e.heap=[],M=[],A=[],D=[],e.pqdownheap=function(t,n){const i=e.heap,r=i[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Em(t,i[o+1],i[o],e.depth)&&o++,!Em(t,r,i[o],e.depth));)i[n]=i[o],n=o,o<<=1;i[n]=r},e.deflateInit=function(t,n,r,c,p,g){return c||(c=8),p||(p=8),g||(g=0),t.msg=null,-1==n&&(n=6),p<1||p>9||8!=c||r<9||r>15||n<0||n>9||g<0||g>2?-2:(t.dstate=e,a=r,o=1<<a,s=o-1,f=p+7,h=1<<f,m=h-1,v=Math.floor((f+3-1)/3),l=new Uint8Array(2*o),u=[],d=[],O=1<<p+6,e.pending_buf=new Uint8Array(4*O),i=4*O,e.dist_buf=new Uint16Array(O),e.lc_buf=new Uint8Array(O),T=n,I=g,oe(t))},e.deflateEnd=function(){return 42!=n&&113!=n&&666!=n?-2:(e.lc_buf=null,e.dist_buf=null,e.pending_buf=null,d=null,u=null,l=null,e.dstate=null,113==n?-3:0)},e.deflateParams=function(e,t,n){let i=0;return-1==t&&(t=6),t<0||t>9||n<0||n>2?-2:(ym[T].func!=ym[t].func&&0!==e.total_in&&(i=e.deflate(1)),T!=t&&(T=t,_=ym[T].max_lazy,P=ym[T].good_length,N=ym[T].nice_length,k=ym[T].max_chain),I=n,i)},e.deflateSetDictionary=function(e,t,i){let r,a=i,c=0;if(!t||42!=n)return-2;if(a<3)return 0;for(a>o-262&&(a=o-262,c=i-a),l.set(t.subarray(c,c+a),0),x=a,g=a,p=255&l[0],p=(p<<v^255&l[1])&m,r=0;r<=a-3;r++)p=(p<<v^255&l[r+2])&m,u[r&s]=d[p],d[p]=r;return 0},e.deflate=function(c,f){let k,P,N,M,A;if(f>4||f<0)return-2;if(!c.next_out||!c.next_in&&0!==c.avail_in||666==n&&4!=f)return c.msg=bm[4],-2;if(0===c.avail_out)return c.msg=bm[7],-5;if(t=c,M=r,r=f,42==n&&(P=8+(a-8<<4)<<8,N=(T-1&255)>>1,N>3&&(N=3),P|=N<<6,0!==x&&(P|=32),P+=31-P%31,n=113,function(e){G(e>>8&255),G(255&e)}(P)),0!==e.pending){if(t.flush_pending(),0===t.avail_out)return r=-1,0}else if(0===t.avail_in&&f<=M&&4!=f)return t.msg=bm[7],-5;if(666==n&&0!==t.avail_in)return c.msg=bm[7],-5;if(0!==t.avail_in||0!==C||0!=f&&666!=n){switch(A=-1,ym[T].func){case 0:A=function(e){let n,r=65535;for(r>i-5&&(r=i-5);;){if(C<=1){if(ie(),0===C&&0==e)return 0;if(0===C)break}if(x+=C,C=0,n=g+r,(0===x||x>=n)&&(C=x-n,x=n,ne(!1),0===t.avail_out))return 0;if(x-g>=o-262&&(ne(!1),0===t.avail_out))return 0}return ne(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(f);break;case 1:A=function(e){let n,i=0;for(;;){if(C<262){if(ie(),C<262&&0==e)return 0;if(0===C)break}if(C>=3&&(p=(p<<v^255&l[x+2])&m,i=65535&d[p],u[x&s]=d[p],d[p]=x),0!==i&&(x-i&65535)<=o-262&&2!=I&&(y=re(i)),y>=3)if(n=Z(x-w,y-3),C-=y,y<=_&&C>=3){y--;do{x++,p=(p<<v^255&l[x+2])&m,i=65535&d[p],u[x&s]=d[p],d[p]=x}while(0!=--y);x++}else x+=y,y=0,p=255&l[x],p=(p<<v^255&l[x+1])&m;else n=Z(0,255&l[x]),C--,x++;if(n&&(ne(!1),0===t.avail_out))return 0}return ne(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(f);break;case 2:A=function(e){let n,i,r=0;for(;;){if(C<262){if(ie(),C<262&&0==e)return 0;if(0===C)break}if(C>=3&&(p=(p<<v^255&l[x+2])&m,r=65535&d[p],u[x&s]=d[p],d[p]=x),S=y,b=w,y=2,0!==r&&S<_&&(x-r&65535)<=o-262&&(2!=I&&(y=re(r)),y<=5&&(1==I||3==y&&x-w>4096)&&(y=2)),S>=3&&y<=S){i=x+C-3,n=Z(x-1-b,S-3),C-=S-1,S-=2;do{++x<=i&&(p=(p<<v^255&l[x+2])&m,r=65535&d[p],u[x&s]=d[p],d[p]=x)}while(0!=--S);if(E=0,y=2,x++,n&&(ne(!1),0===t.avail_out))return 0}else if(0!==E){if(n=Z(0,255&l[x-1]),n&&ne(!1),x++,C--,0===t.avail_out)return 0}else E=1,x++,C--}return 0!==E&&(n=Z(0,255&l[x-1]),E=0),ne(4==e),0===t.avail_out?4==e?2:0:4==e?3:1}(f)}if(2!=A&&3!=A||(n=666),0==A||2==A)return 0===t.avail_out&&(r=-1),0;if(1==A){if(1==f)K(2,3),Y(256,fm.static_ltree),Q(),1+H+10-W<9&&(K(2,3),Y(256,fm.static_ltree),Q()),H=7;else if(ee(0,0,!1),3==f)for(k=0;k<h;k++)d[k]=0;if(t.flush_pending(),0===t.avail_out)return r=-1,0}}return 4!=f?0:1}}function wm(){const e=this;e.next_in_index=0,e.next_out_index=0,e.avail_in=0,e.total_in=0,e.avail_out=0,e.total_out=0}wm.prototype={deflateInit(e,t){const n=this;return n.dstate=new xm,t||(t=15),n.dstate.deflateInit(n,e,t)},deflate(e){const t=this;return t.dstate?t.dstate.deflate(t,e):-2},deflateEnd(){const e=this;if(!e.dstate)return-2;const t=e.dstate.deflateEnd();return e.dstate=null,t},deflateParams(e,t){const n=this;return n.dstate?n.dstate.deflateParams(n,e,t):-2},deflateSetDictionary(e,t){const n=this;return n.dstate?n.dstate.deflateSetDictionary(n,e,t):-2},read_buf(e,t,n){const i=this;let r=i.avail_in;return r>n&&(r=n),0===r?0:(i.avail_in-=r,e.set(i.next_in.subarray(i.next_in_index,i.next_in_index+r),t),i.next_in_index+=r,i.total_in+=r,r)},flush_pending(){const e=this;let t=e.dstate.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+t),e.next_out_index),e.next_out_index+=t,e.dstate.pending_out+=t,e.total_out+=t,e.avail_out-=t,e.dstate.pending-=t,0===e.dstate.pending&&(e.dstate.pending_out=0))}};const Cm=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Sm=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],km=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],_m=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Tm=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Im=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Pm=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function Nm(){let e,t,n,i,r,o;function a(e,t,a,s,l,c,u,d,p,h,f){let m,v,g,y,b,E,x,w,C,S,k,_,T,I,P;S=0,b=a;do{n[e[t+S]]++,S++,b--}while(0!==b);if(n[0]==a)return u[0]=-1,d[0]=0,0;for(w=d[0],E=1;E<=15&&0===n[E];E++);for(x=E,w<E&&(w=E),b=15;0!==b&&0===n[b];b--);for(g=b,w>b&&(w=b),d[0]=w,I=1<<E;E<b;E++,I<<=1)if((I-=n[E])<0)return-3;if((I-=n[b])<0)return-3;for(n[b]+=I,o[1]=E=0,S=1,T=2;0!=--b;)o[T]=E+=n[S],T++,S++;b=0,S=0;do{0!==(E=e[t+S])&&(f[o[E]++]=b),S++}while(++b<a);for(a=o[g],o[0]=b=0,S=0,y=-1,_=-w,r[0]=0,k=0,P=0;x<=g;x++)for(m=n[x];0!=m--;){for(;x>_+w;){if(y++,_+=w,P=g-_,P=P>w?w:P,(v=1<<(E=x-_))>m+1&&(v-=m+1,T=x,E<P))for(;++E<P&&!((v<<=1)<=n[++T]);)v-=n[T];if(P=1<<E,h[0]+P>1440)return-3;r[y]=k=h[0],h[0]+=P,0!==y?(o[y]=b,i[0]=E,i[1]=w,E=b>>>_-w,i[2]=k-r[y-1]-E,p.set(i,3*(r[y-1]+E))):u[0]=k}for(i[1]=x-_,S>=a?i[0]=192:f[S]<s?(i[0]=f[S]<256?0:96,i[2]=f[S++]):(i[0]=c[f[S]-s]+16+64,i[2]=l[f[S++]-s]),v=1<<x-_,E=b>>>_;E<P;E+=v)p.set(i,3*(k+E));for(E=1<<x-1;b&E;E>>>=1)b^=E;for(b^=E,C=(1<<_)-1;(b&C)!=o[y];)y--,_-=w,C=(1<<_)-1}return 0!==I&&1!=g?-5:0}function s(a){let s;for(e||(e=[],t=[],n=new Int32Array(16),i=[],r=new Int32Array(15),o=new Int32Array(16)),t.length<a&&(t=[]),s=0;s<a;s++)t[s]=0;for(s=0;s<16;s++)n[s]=0;for(s=0;s<3;s++)i[s]=0;r.set(n.subarray(0,15),0),o.set(n.subarray(0,16),0)}this.inflate_trees_bits=function(n,i,r,o,l){let c;return s(19),e[0]=0,c=a(n,0,19,19,null,null,r,i,o,e,t),-3==c?l.msg="oversubscribed dynamic bit lengths tree":-5!=c&&0!==i[0]||(l.msg="incomplete dynamic bit lengths tree",c=-3),c},this.inflate_trees_dynamic=function(n,i,r,o,l,c,u,d,p){let h;return s(288),e[0]=0,h=a(r,0,n,257,_m,Tm,c,o,d,e,t),0!=h||0===o[0]?(-3==h?p.msg="oversubscribed literal/length tree":-4!=h&&(p.msg="incomplete literal/length tree",h=-3),h):(s(288),h=a(r,n,i,0,Im,Pm,u,l,d,e,t),0!=h||0===l[0]&&n>257?(-3==h?p.msg="oversubscribed distance tree":-5==h?(p.msg="incomplete distance tree",h=-3):-4!=h&&(p.msg="empty distance tree with lengths",h=-3),h):0)}}function Mm(){const e=this;let t,n,i,r,o=0,a=0,s=0,l=0,c=0,u=0,d=0,p=0,h=0,f=0;function m(e,t,n,i,r,o,a,s){let l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C;f=s.next_in_index,m=s.avail_in,p=a.bitb,h=a.bitk,v=a.write,g=v<a.read?a.read-v-1:a.end-v,y=Cm[e],b=Cm[t];do{for(;h<20;)m--,p|=(255&s.read_byte(f++))<<h,h+=8;if(l=p&y,c=n,u=i,C=3*(u+l),0!==(d=c[C]))for(;;){if(p>>=c[C+1],h-=c[C+1],16&d){for(d&=15,E=c[C+2]+(p&Cm[d]),p>>=d,h-=d;h<15;)m--,p|=(255&s.read_byte(f++))<<h,h+=8;for(l=p&b,c=r,u=o,C=3*(u+l),d=c[C];;){if(p>>=c[C+1],h-=c[C+1],16&d){for(d&=15;h<d;)m--,p|=(255&s.read_byte(f++))<<h,h+=8;if(x=c[C+2]+(p&Cm[d]),p>>=d,h-=d,g-=E,v>=x)w=v-x,v-w>0&&2>v-w?(a.win[v++]=a.win[w++],a.win[v++]=a.win[w++],E-=2):(a.win.set(a.win.subarray(w,w+2),v),v+=2,w+=2,E-=2);else{w=v-x;do{w+=a.end}while(w<0);if(d=a.end-w,E>d){if(E-=d,v-w>0&&d>v-w)do{a.win[v++]=a.win[w++]}while(0!=--d);else a.win.set(a.win.subarray(w,w+d),v),v+=d,w+=d,d=0;w=0}}if(v-w>0&&E>v-w)do{a.win[v++]=a.win[w++]}while(0!=--E);else a.win.set(a.win.subarray(w,w+E),v),v+=E,w+=E,E=0;break}if(64&d)return s.msg="invalid distance code",E=s.avail_in-m,E=h>>3<E?h>>3:E,m+=E,f-=E,h-=E<<3,a.bitb=p,a.bitk=h,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=v,-3;l+=c[C+2],l+=p&Cm[d],C=3*(u+l),d=c[C]}break}if(64&d)return 32&d?(E=s.avail_in-m,E=h>>3<E?h>>3:E,m+=E,f-=E,h-=E<<3,a.bitb=p,a.bitk=h,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=v,1):(s.msg="invalid literal/length code",E=s.avail_in-m,E=h>>3<E?h>>3:E,m+=E,f-=E,h-=E<<3,a.bitb=p,a.bitk=h,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=v,-3);if(l+=c[C+2],l+=p&Cm[d],C=3*(u+l),0===(d=c[C])){p>>=c[C+1],h-=c[C+1],a.win[v++]=c[C+2],g--;break}}else p>>=c[C+1],h-=c[C+1],a.win[v++]=c[C+2],g--}while(g>=258&&m>=10);return E=s.avail_in-m,E=h>>3<E?h>>3:E,m+=E,f-=E,h-=E<<3,a.bitb=p,a.bitk=h,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=v,0}e.init=function(e,o,a,s,l,c){t=0,d=e,p=o,i=a,h=s,r=l,f=c,n=null},e.proc=function(e,v,g){let y,b,E,x,w,C,S,k=0,_=0,T=0;for(T=v.next_in_index,x=v.avail_in,k=e.bitb,_=e.bitk,w=e.write,C=w<e.read?e.read-w-1:e.end-w;;)switch(t){case 0:if(C>=258&&x>=10&&(e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,g=m(d,p,i,h,r,f,e,v),T=v.next_in_index,x=v.avail_in,k=e.bitb,_=e.bitk,w=e.write,C=w<e.read?e.read-w-1:e.end-w,0!=g)){t=1==g?7:9;break}s=d,n=i,a=h,t=1;case 1:for(y=s;_<y;){if(0===x)return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);g=0,x--,k|=(255&v.read_byte(T++))<<_,_+=8}if(b=3*(a+(k&Cm[y])),k>>>=n[b+1],_-=n[b+1],E=n[b],0===E){l=n[b+2],t=6;break}if(16&E){c=15&E,o=n[b+2],t=2;break}if(!(64&E)){s=E,a=b/3+n[b+2];break}if(32&E){t=7;break}return t=9,v.msg="invalid literal/length code",g=-3,e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);case 2:for(y=c;_<y;){if(0===x)return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);g=0,x--,k|=(255&v.read_byte(T++))<<_,_+=8}o+=k&Cm[y],k>>=y,_-=y,s=p,n=r,a=f,t=3;case 3:for(y=s;_<y;){if(0===x)return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);g=0,x--,k|=(255&v.read_byte(T++))<<_,_+=8}if(b=3*(a+(k&Cm[y])),k>>=n[b+1],_-=n[b+1],E=n[b],16&E){c=15&E,u=n[b+2],t=4;break}if(!(64&E)){s=E,a=b/3+n[b+2];break}return t=9,v.msg="invalid distance code",g=-3,e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);case 4:for(y=c;_<y;){if(0===x)return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);g=0,x--,k|=(255&v.read_byte(T++))<<_,_+=8}u+=k&Cm[y],k>>=y,_-=y,t=5;case 5:for(S=w-u;S<0;)S+=e.end;for(;0!==o;){if(0===C&&(w==e.end&&0!==e.read&&(w=0,C=w<e.read?e.read-w-1:e.end-w),0===C&&(e.write=w,g=e.inflate_flush(v,g),w=e.write,C=w<e.read?e.read-w-1:e.end-w,w==e.end&&0!==e.read&&(w=0,C=w<e.read?e.read-w-1:e.end-w),0===C)))return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);e.win[w++]=e.win[S++],C--,S==e.end&&(S=0),o--}t=0;break;case 6:if(0===C&&(w==e.end&&0!==e.read&&(w=0,C=w<e.read?e.read-w-1:e.end-w),0===C&&(e.write=w,g=e.inflate_flush(v,g),w=e.write,C=w<e.read?e.read-w-1:e.end-w,w==e.end&&0!==e.read&&(w=0,C=w<e.read?e.read-w-1:e.end-w),0===C)))return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);g=0,e.win[w++]=l,C--,t=0;break;case 7:if(_>7&&(_-=8,x++,T--),e.write=w,g=e.inflate_flush(v,g),w=e.write,C=w<e.read?e.read-w-1:e.end-w,e.read!=e.write)return e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);t=8;case 8:return g=1,e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);case 9:return g=-3,e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g);default:return g=-2,e.bitb=k,e.bitk=_,v.avail_in=x,v.total_in+=T-v.next_in_index,v.next_in_index=T,e.write=w,e.inflate_flush(v,g)}},e.free=function(){}}Nm.inflate_trees_fixed=function(e,t,n,i){return e[0]=9,t[0]=5,n[0]=Sm,i[0]=km,0};const Am=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Dm(e,t){const n=this;let i,r=0,o=0,a=0,s=0;const l=[0],c=[0],u=new Mm;let d=0,p=new Int32Array(4320);const h=new Nm;n.bitk=0,n.bitb=0,n.win=new Uint8Array(t),n.end=t,n.read=0,n.write=0,n.reset=function(e,t){t&&(t[0]=0),6==r&&u.free(e),r=0,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(e,null),n.inflate_flush=function(e,t){let i,r,o;return r=e.next_out_index,o=n.read,i=(o<=n.write?n.write:n.end)-o,i>e.avail_out&&(i=e.avail_out),0!==i&&-5==t&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(o,o+i),r),r+=i,o+=i,o==n.end&&(o=0,n.write==n.end&&(n.write=0),i=n.write-o,i>e.avail_out&&(i=e.avail_out),0!==i&&-5==t&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(o,o+i),r),r+=i,o+=i),e.next_out_index=r,n.read=o,t},n.proc=function(e,t){let f,m,v,g,y,b,E,x;for(g=e.next_in_index,y=e.avail_in,m=n.bitb,v=n.bitk,b=n.write,E=b<n.read?n.read-b-1:n.end-b;;){let w,C,S,k,_,T,I,P;switch(r){case 0:for(;v<3;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}switch(f=7&m,d=1&f,f>>>1){case 0:m>>>=3,v-=3,f=7&v,m>>>=f,v-=f,r=1;break;case 1:w=[],C=[],S=[[]],k=[[]],Nm.inflate_trees_fixed(w,C,S,k),u.init(w[0],C[0],S[0],0,k[0],0),m>>>=3,v-=3,r=6;break;case 2:m>>>=3,v-=3,r=3;break;case 3:return m>>>=3,v-=3,r=9,e.msg="invalid block type",t=-3,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t)}break;case 1:for(;v<32;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}if((~m>>>16&65535)!=(65535&m))return r=9,e.msg="invalid stored block lengths",t=-3,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);o=65535&m,m=v=0,r=0!==o?2:0!==d?7:0;break;case 2:if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);if(0===E&&(b==n.end&&0!==n.read&&(b=0,E=b<n.read?n.read-b-1:n.end-b),0===E&&(n.write=b,t=n.inflate_flush(e,t),b=n.write,E=b<n.read?n.read-b-1:n.end-b,b==n.end&&0!==n.read&&(b=0,E=b<n.read?n.read-b-1:n.end-b),0===E)))return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);if(t=0,f=o,f>y&&(f=y),f>E&&(f=E),n.win.set(e.read_buf(g,f),b),g+=f,y-=f,b+=f,E-=f,0!=(o-=f))break;r=0!==d?7:0;break;case 3:for(;v<14;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}if(a=f=16383&m,(31&f)>29||(f>>5&31)>29)return r=9,e.msg="too many length or distance symbols",t=-3,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);if(f=258+(31&f)+(f>>5&31),!i||i.length<f)i=[];else for(x=0;x<f;x++)i[x]=0;m>>>=14,v-=14,s=0,r=4;case 4:for(;s<4+(a>>>10);){for(;v<3;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}i[Am[s++]]=7&m,m>>>=3,v-=3}for(;s<19;)i[Am[s++]]=0;if(l[0]=7,f=h.inflate_trees_bits(i,l,c,p,e),0!=f)return-3==(t=f)&&(i=null,r=9),n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);s=0,r=5;case 5:for(;f=a,!(s>=258+(31&f)+(f>>5&31));){let o,u;for(f=l[0];v<f;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}if(f=p[3*(c[0]+(m&Cm[f]))+1],u=p[3*(c[0]+(m&Cm[f]))+2],u<16)m>>>=f,v-=f,i[s++]=u;else{for(x=18==u?7:u-14,o=18==u?11:3;v<f+x;){if(0===y)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<v,v+=8}if(m>>>=f,v-=f,o+=m&Cm[x],m>>>=x,v-=x,x=s,f=a,x+o>258+(31&f)+(f>>5&31)||16==u&&x<1)return i=null,r=9,e.msg="invalid bit length repeat",t=-3,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);u=16==u?i[x-1]:0;do{i[x++]=u}while(0!=--o);s=x}}if(c[0]=-1,_=[],T=[],I=[],P=[],_[0]=9,T[0]=6,f=a,f=h.inflate_trees_dynamic(257+(31&f),1+(f>>5&31),i,_,T,I,P,p,e),0!=f)return-3==f&&(i=null,r=9),t=f,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);u.init(_[0],T[0],p,I[0],p,P[0]),r=6;case 6:if(n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,1!=(t=u.proc(n,e,t)))return n.inflate_flush(e,t);if(t=0,u.free(e),g=e.next_in_index,y=e.avail_in,m=n.bitb,v=n.bitk,b=n.write,E=b<n.read?n.read-b-1:n.end-b,0===d){r=0;break}r=7;case 7:if(n.write=b,t=n.inflate_flush(e,t),b=n.write,E=b<n.read?n.read-b-1:n.end-b,n.read!=n.write)return n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);r=8;case 8:return t=1,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);case 9:return t=-3,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t);default:return t=-2,n.bitb=m,n.bitk=v,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=b,n.inflate_flush(e,t)}}},n.free=function(e){n.reset(e,null),n.win=null,p=null},n.set_dictionary=function(e,t,i){n.win.set(e.subarray(t,t+i),0),n.read=n.write=i},n.sync_point=function(){return 1==r?1:0}}const Rm=[0,0,255,255];function Bm(){const e=this;function t(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=7,e.istate.blocks.reset(e,null),0):-2}e.mode=0,e.method=0,e.was=[0],e.need=0,e.marker=0,e.wbits=0,e.inflateEnd=function(t){return e.blocks&&e.blocks.free(t),e.blocks=null,0},e.inflateInit=function(n,i){return n.msg=null,e.blocks=null,i<8||i>15?(e.inflateEnd(n),-2):(e.wbits=i,n.istate.blocks=new Dm(n,1<<i),t(n),0)},e.inflate=function(e,t){let n,i;if(!e||!e.istate||!e.next_in)return-2;const r=e.istate;for(t=4==t?-5:0,n=-5;;)switch(r.mode){case 0:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,8!=(15&(r.method=e.read_byte(e.next_in_index++)))){r.mode=13,e.msg="unknown compression method",r.marker=5;break}if(8+(r.method>>4)>r.wbits){r.mode=13,e.msg="invalid win size",r.marker=5;break}r.mode=1;case 1:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.read_byte(e.next_in_index++),((r.method<<8)+i)%31!=0){r.mode=13,e.msg="incorrect header check",r.marker=5;break}if(!(32&i)){r.mode=7;break}r.mode=2;case 2:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,r.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,r.mode=3;case 3:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,r.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,r.mode=4;case 4:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,r.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,r.mode=5;case 5:return 0===e.avail_in?n:(n=t,e.avail_in--,e.total_in++,r.need+=255&e.read_byte(e.next_in_index++),r.mode=6,2);case 6:return r.mode=13,e.msg="need dictionary",r.marker=0,-2;case 7:if(n=r.blocks.proc(e,n),-3==n){r.mode=13,r.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,r.blocks.reset(e,r.was),r.mode=12;case 12:return e.avail_in=0,1;case 13:return-3;default:return-2}},e.inflateSetDictionary=function(e,t,n){let i=0,r=n;if(!e||!e.istate||6!=e.istate.mode)return-2;const o=e.istate;return r>=1<<o.wbits&&(r=(1<<o.wbits)-1,i=n-r),o.blocks.set_dictionary(t,i,r),o.mode=7,0},e.inflateSync=function(e){let n,i,r,o,a;if(!e||!e.istate)return-2;const s=e.istate;if(13!=s.mode&&(s.mode=13,s.marker=0),0===(n=e.avail_in))return-5;for(i=e.next_in_index,r=s.marker;0!==n&&r<4;)e.read_byte(i)==Rm[r]?r++:r=0!==e.read_byte(i)?0:4-r,i++,n--;return e.total_in+=i-e.next_in_index,e.next_in_index=i,e.avail_in=n,s.marker=r,4!=r?-3:(o=e.total_in,a=e.total_out,t(e),e.total_in=o,e.total_out=a,s.mode=7,0)},e.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():-2}}function Lm(){}Lm.prototype={inflateInit(e){const t=this;return t.istate=new Bm,e||(e=15),t.istate.inflateInit(t,e)},inflate(e){const t=this;return t.istate?t.istate.inflate(t,e):-2},inflateEnd(){const e=this;if(!e.istate)return-2;const t=e.istate.inflateEnd(e);return e.istate=null,t},inflateSync(){const e=this;return e.istate?e.istate.inflateSync(e):-2},inflateSetDictionary(e,t){const n=this;return n.istate?n.istate.inflateSetDictionary(n,e,t):-2},read_byte(e){return this.next_in[e]},read_buf(e,t){return this.next_in.subarray(e,e+t)}};const Om=new Date(2107,11,31),Fm=new Date(1980,0,1);class zm{constructor(e){return class extends TransformStream{constructor(t,n){const i=new e(n);super({transform(e,t){t.enqueue(i.append(e))},flush(e){const t=i.flush();t&&e.enqueue(t)}})}}}}let Hm=2;try{"undefined"!=typeof navigator&&navigator.hardwareConcurrency&&(Hm=navigator.hardwareConcurrency)}catch(e){}const Um={chunkSize:524288,maxWorkers:Hm,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:void 0,CompressionStreamNative:"undefined"!=typeof CompressionStream&&CompressionStream,DecompressionStreamNative:"undefined"!=typeof DecompressionStream&&DecompressionStream},Wm=Object.assign({},Um);function Vm(e){const{baseURL:t,chunkSize:n,maxWorkers:i,terminateWorkerTimeout:r,useCompressionStream:o,useWebWorkers:a,Deflate:s,Inflate:l,CompressionStream:c,DecompressionStream:u,workerScripts:d}=e;if(jm("baseURL",t),jm("chunkSize",n),jm("maxWorkers",i),jm("terminateWorkerTimeout",r),jm("useCompressionStream",o),jm("useWebWorkers",a),s&&(Wm.CompressionStream=new zm(s)),l&&(Wm.DecompressionStream=new zm(l)),jm("CompressionStream",c),jm("DecompressionStream",u),void 0!==d){const{deflate:e,inflate:t}=d;if((e||t)&&(Wm.workerScripts||(Wm.workerScripts={})),e){if(!Array.isArray(e))throw new Error("workerScripts.deflate must be an array");Wm.workerScripts.deflate=e}if(t){if(!Array.isArray(t))throw new Error("workerScripts.inflate must be an array");Wm.workerScripts.inflate=t}}}function jm(e,t){void 0!==t&&(Wm[e]=t)}const Gm={application:{"andrew-inset":"ez",annodex:"anx","atom+xml":"atom","atomcat+xml":"atomcat","atomserv+xml":"atomsrv",bbolin:"lin","cu-seeme":"cu","davmount+xml":"davmount",dsptype:"tsp",ecmascript:["es","ecma"],futuresplash:"spl",hta:"hta","java-archive":"jar","java-serialized-object":"ser","java-vm":"class",m3g:"m3g","mac-binhex40":"hqx",mathematica:["nb","ma","mb"],msaccess:"mdb",msword:["doc","dot","wiz"],mxf:"mxf",oda:"oda",ogg:"ogx",pdf:"pdf","pgp-keys":"key","pgp-signature":["asc","sig"],"pics-rules":"prf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],rar:"rar","rdf+xml":"rdf","rss+xml":"rss",rtf:"rtf","xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","xpdl"],"xspf+xml":"xspf",zip:"zip","vnd.android.package-archive":"apk","vnd.cinderella":"cdy","vnd.google-earth.kml+xml":"kml","vnd.google-earth.kmz":"kmz","vnd.mozilla.xul+xml":"xul","vnd.ms-excel":["xls","xlb","xlt","xlm","xla","xlc","xlw"],"vnd.ms-pki.seccat":"cat","vnd.ms-pki.stl":"stl","vnd.ms-powerpoint":["ppt","pps","pot","ppa","pwz"],"vnd.oasis.opendocument.chart":"odc","vnd.oasis.opendocument.database":"odb","vnd.oasis.opendocument.formula":"odf","vnd.oasis.opendocument.graphics":"odg","vnd.oasis.opendocument.graphics-template":"otg","vnd.oasis.opendocument.image":"odi","vnd.oasis.opendocument.presentation":"odp","vnd.oasis.opendocument.presentation-template":"otp","vnd.oasis.opendocument.spreadsheet":"ods","vnd.oasis.opendocument.spreadsheet-template":"ots","vnd.oasis.opendocument.text":"odt","vnd.oasis.opendocument.text-master":["odm","otm"],"vnd.oasis.opendocument.text-template":"ott","vnd.oasis.opendocument.text-web":"oth","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","vnd.openxmlformats-officedocument.presentationml.template":"potx","vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","vnd.smaf":"mmf","vnd.stardivision.calc":"sdc","vnd.stardivision.chart":"sds","vnd.stardivision.draw":"sda","vnd.stardivision.impress":"sdd","vnd.stardivision.math":["sdf","smf"],"vnd.stardivision.writer":["sdw","vor"],"vnd.stardivision.writer-global":"sgl","vnd.sun.xml.calc":"sxc","vnd.sun.xml.calc.template":"stc","vnd.sun.xml.draw":"sxd","vnd.sun.xml.draw.template":"std","vnd.sun.xml.impress":"sxi","vnd.sun.xml.impress.template":"sti","vnd.sun.xml.math":"sxm","vnd.sun.xml.writer":"sxw","vnd.sun.xml.writer.global":"sxg","vnd.sun.xml.writer.template":"stw","vnd.symbian.install":["sis","sisx"],"vnd.visio":["vsd","vst","vss","vsw","vsdx","vssx","vstx","vssm","vstm"],"vnd.wap.wbxml":"wbxml","vnd.wap.wmlc":"wmlc","vnd.wap.wmlscriptc":"wmlsc","vnd.wordperfect":"wpd","vnd.wordperfect5.1":"wp5","x-123":"wk","x-7z-compressed":"7z","x-abiword":"abw","x-apple-diskimage":"dmg","x-bcpio":"bcpio","x-bittorrent":"torrent","x-cbr":["cbr","cba","cbt","cb7"],"x-cbz":"cbz","x-cdf":["cdf","cda"],"x-cdlink":"vcd","x-chess-pgn":"pgn","x-cpio":"cpio","x-csh":"csh","x-director":["dir","dxr","cst","cct","cxt","w3d","fgd","swa"],"x-dms":"dms","x-doom":"wad","x-dvi":"dvi","x-httpd-eruby":"rhtml","x-font":"pcf.Z","x-freemind":"mm","x-gnumeric":"gnumeric","x-go-sgf":"sgf","x-graphing-calculator":"gcf","x-gtar":["gtar","taz"],"x-hdf":"hdf","x-httpd-php":["phtml","pht","php"],"x-httpd-php-source":"phps","x-httpd-php3":"php3","x-httpd-php3-preprocessed":"php3p","x-httpd-php4":"php4","x-httpd-php5":"php5","x-ica":"ica","x-info":"info","x-internet-signup":["ins","isp"],"x-iphone":"iii","x-iso9660-image":"iso","x-java-jnlp-file":"jnlp","x-jmol":"jmz","x-killustrator":"kil","x-latex":"latex","x-lyx":"lyx","x-lzx":"lzx","x-maker":["frm","fb","fbdoc"],"x-ms-wmd":"wmd","x-msdos-program":["com","exe","bat","dll"],"x-netcdf":["nc"],"x-ns-proxy-autoconfig":["pac","dat"],"x-nwc":"nwc","x-object":"o","x-oz-application":"oza","x-pkcs7-certreqresp":"p7r","x-python-code":["pyc","pyo"],"x-qgis":["qgs","shp","shx"],"x-quicktimeplayer":"qtl","x-redhat-package-manager":["rpm","rpa"],"x-ruby":"rb","x-sh":"sh","x-shar":"shar","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","x-stuffit":"sit","x-sv4cpio":"sv4cpio","x-sv4crc":"sv4crc","x-tar":"tar","x-tex-gf":"gf","x-tex-pk":"pk","x-texinfo":["texinfo","texi"],"x-trash":["~","%","bak","old","sik"],"x-ustar":"ustar","x-wais-source":"src","x-wingz":"wz","x-x509-ca-cert":["crt","der","cer"],"x-xcf":"xcf","x-xfig":"fig","x-xpinstall":"xpi",applixware:"aw","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-capability":"cdmia","cdmi-container":"cdmic","cdmi-domain":"cdmid","cdmi-object":"cdmio","cdmi-queue":"cdmiq","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-tdpfr":"pfr","gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix","jsonml+json":"jsonml","lost+xml":"lostxml","mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx","mathml+xml":["mathml","mml"],mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s","oebps-package+xml":"opf","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps","patch-ops-error+xml":"xer","pgp-encrypted":"pgp",pkcs10:"p10","pkcs7-mime":["p7m","p7c"],"pkcs7-signature":"p7s",pkcs8:"p8","pkix-attr-cert":"ac","pkix-crl":"crl","pkix-pkipath":"pkipath",pkixcmp:"pki","pls+xml":"pls","prs.cww":"cww","pskc+xml":"pskcxml","reginfo+xml":"rif","relax-ng-compact-syntax":"rnc","resource-lists+xml":"rl","resource-lists-diff+xml":"rld","rls-services+xml":"rs","rpki-ghostbusters":"gbr","rpki-manifest":"mft","rpki-roa":"roa","rsd+xml":"rsd","sbml+xml":"sbml","scvp-cv-request":"scq","scvp-cv-response":"scs","scvp-vp-request":"spq","scvp-vp-response":"spp",sdp:"sdp","set-payment-initiation":"setpay","set-registration-initiation":"setreg","shf+xml":"shf","sparql-query":"rq","sparql-results+xml":"srx",srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","timestamped-data":"tsd","vnd.3gpp.pic-bw-large":"plb","vnd.3gpp.pic-bw-small":"psb","vnd.3gpp.pic-bw-var":"pvb","vnd.3gpp2.tcap":"tcap","vnd.3m.post-it-notes":"pwn","vnd.accpac.simply.aso":"aso","vnd.accpac.simply.imp":"imp","vnd.acucobol":"acu","vnd.acucorp":["atc","acutc"],"vnd.adobe.air-application-installer-package+zip":"air","vnd.adobe.formscentral.fcdt":"fcdt","vnd.adobe.fxp":["fxp","fxpl"],"vnd.adobe.xdp+xml":"xdp","vnd.adobe.xfdf":"xfdf","vnd.ahead.space":"ahead","vnd.airzip.filesecure.azf":"azf","vnd.airzip.filesecure.azs":"azs","vnd.amazon.ebook":"azw","vnd.americandynamics.acc":"acc","vnd.amiga.ami":"ami","vnd.anser-web-certificate-issue-initiation":"cii","vnd.anser-web-funds-transfer-initiation":"fti","vnd.antix.game-component":"atx","vnd.apple.installer+xml":"mpkg","vnd.apple.mpegurl":"m3u8","vnd.aristanetworks.swi":"swi","vnd.astraea-software.iota":"iota","vnd.audiograph":"aep","vnd.blueice.multipass":"mpm","vnd.bmi":"bmi","vnd.businessobjects":"rep","vnd.chemdraw+xml":"cdxml","vnd.chipnuts.karaoke-mmd":"mmd","vnd.claymore":"cla","vnd.cloanto.rp9":"rp9","vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"vnd.cluetrust.cartomobile-config":"c11amc","vnd.cluetrust.cartomobile-config-pkg":"c11amz","vnd.commonspace":"csp","vnd.contact.cmsg":"cdbcmsg","vnd.cosmocaller":"cmc","vnd.crick.clicker":"clkx","vnd.crick.clicker.keyboard":"clkk","vnd.crick.clicker.palette":"clkp","vnd.crick.clicker.template":"clkt","vnd.crick.clicker.wordbank":"clkw","vnd.criticaltools.wbs+xml":"wbs","vnd.ctc-posml":"pml","vnd.cups-ppd":"ppd","vnd.curl.car":"car","vnd.curl.pcurl":"pcurl","vnd.dart":"dart","vnd.data-vision.rdz":"rdz","vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"vnd.dece.ttml+xml":["uvt","uvvt"],"vnd.dece.unspecified":["uvx","uvvx"],"vnd.dece.zip":["uvz","uvvz"],"vnd.denovo.fcselayout-link":"fe_launch","vnd.dna":"dna","vnd.dolby.mlp":"mlp","vnd.dpgraph":"dpg","vnd.dreamfactory":"dfac","vnd.ds-keypoint":"kpxx","vnd.dvb.ait":"ait","vnd.dvb.service":"svc","vnd.dynageo":"geo","vnd.ecowin.chart":"mag","vnd.enliven":"nml","vnd.epson.esf":"esf","vnd.epson.msf":"msf","vnd.epson.quickanime":"qam","vnd.epson.salt":"slt","vnd.epson.ssf":"ssf","vnd.eszigno3+xml":["es3","et3"],"vnd.ezpix-album":"ez2","vnd.ezpix-package":"ez3","vnd.fdf":"fdf","vnd.fdsn.mseed":"mseed","vnd.fdsn.seed":["seed","dataless"],"vnd.flographit":"gph","vnd.fluxtime.clip":"ftc","vnd.framemaker":["fm","frame","maker","book"],"vnd.frogans.fnc":"fnc","vnd.frogans.ltf":"ltf","vnd.fsc.weblaunch":"fsc","vnd.fujitsu.oasys":"oas","vnd.fujitsu.oasys2":"oa2","vnd.fujitsu.oasys3":"oa3","vnd.fujitsu.oasysgp":"fg5","vnd.fujitsu.oasysprs":"bh2","vnd.fujixerox.ddd":"ddd","vnd.fujixerox.docuworks":"xdw","vnd.fujixerox.docuworks.binder":"xbd","vnd.fuzzysheet":"fzs","vnd.genomatix.tuxedo":"txd","vnd.geogebra.file":"ggb","vnd.geogebra.tool":"ggt","vnd.geometry-explorer":["gex","gre"],"vnd.geonext":"gxt","vnd.geoplan":"g2w","vnd.geospace":"g3w","vnd.gmx":"gmx","vnd.grafeq":["gqf","gqs"],"vnd.groove-account":"gac","vnd.groove-help":"ghf","vnd.groove-identity-message":"gim","vnd.groove-injector":"grv","vnd.groove-tool-message":"gtm","vnd.groove-tool-template":"tpl","vnd.groove-vcard":"vcg","vnd.hal+xml":"hal","vnd.handheld-entertainment+xml":"zmm","vnd.hbci":"hbci","vnd.hhe.lesson-player":"les","vnd.hp-hpgl":"hpgl","vnd.hp-hpid":"hpid","vnd.hp-hps":"hps","vnd.hp-jlyt":"jlt","vnd.hp-pcl":"pcl","vnd.hp-pclxl":"pclxl","vnd.hydrostatix.sof-data":"sfd-hdstx","vnd.ibm.minipay":"mpy","vnd.ibm.modcap":["afp","listafp","list3820"],"vnd.ibm.rights-management":"irm","vnd.ibm.secure-container":"sc","vnd.iccprofile":["icc","icm"],"vnd.igloader":"igl","vnd.immervision-ivp":"ivp","vnd.immervision-ivu":"ivu","vnd.insors.igm":"igm","vnd.intercon.formnet":["xpw","xpx"],"vnd.intergeo":"i2g","vnd.intu.qbo":"qbo","vnd.intu.qfx":"qfx","vnd.ipunplugged.rcprofile":"rcprofile","vnd.irepository.package+xml":"irp","vnd.is-xpr":"xpr","vnd.isac.fcs":"fcs","vnd.jam":"jam","vnd.jcp.javame.midlet-rms":"rms","vnd.jisp":"jisp","vnd.joost.joda-archive":"joda","vnd.kahootz":["ktz","ktr"],"vnd.kde.karbon":"karbon","vnd.kde.kchart":"chrt","vnd.kde.kformula":"kfo","vnd.kde.kivio":"flw","vnd.kde.kontour":"kon","vnd.kde.kpresenter":["kpr","kpt"],"vnd.kde.kspread":"ksp","vnd.kde.kword":["kwd","kwt"],"vnd.kenameaapp":"htke","vnd.kidspiration":"kia","vnd.kinar":["kne","knp"],"vnd.koan":["skp","skd","skt","skm"],"vnd.kodak-descriptor":"sse","vnd.las.las+xml":"lasxml","vnd.llamagraphics.life-balance.desktop":"lbd","vnd.llamagraphics.life-balance.exchange+xml":"lbe","vnd.lotus-1-2-3":"123","vnd.lotus-approach":"apr","vnd.lotus-freelance":"pre","vnd.lotus-notes":"nsf","vnd.lotus-organizer":"org","vnd.lotus-screencam":"scm","vnd.lotus-wordpro":"lwp","vnd.macports.portpkg":"portpkg","vnd.mcd":"mcd","vnd.medcalcdata":"mc1","vnd.mediastation.cdkey":"cdkey","vnd.mfer":"mwf","vnd.mfmp":"mfm","vnd.micrografx.flo":"flo","vnd.micrografx.igx":"igx","vnd.mif":"mif","vnd.mobius.daf":"daf","vnd.mobius.dis":"dis","vnd.mobius.mbk":"mbk","vnd.mobius.mqy":"mqy","vnd.mobius.msl":"msl","vnd.mobius.plc":"plc","vnd.mobius.txf":"txf","vnd.mophun.application":"mpn","vnd.mophun.certificate":"mpc","vnd.ms-artgalry":"cil","vnd.ms-cab-compressed":"cab","vnd.ms-excel.addin.macroenabled.12":"xlam","vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","vnd.ms-excel.sheet.macroenabled.12":"xlsm","vnd.ms-excel.template.macroenabled.12":"xltm","vnd.ms-fontobject":"eot","vnd.ms-htmlhelp":"chm","vnd.ms-ims":"ims","vnd.ms-lrm":"lrm","vnd.ms-officetheme":"thmx","vnd.ms-powerpoint.addin.macroenabled.12":"ppam","vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","vnd.ms-powerpoint.slide.macroenabled.12":"sldm","vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","vnd.ms-powerpoint.template.macroenabled.12":"potm","vnd.ms-project":["mpp","mpt"],"vnd.ms-word.document.macroenabled.12":"docm","vnd.ms-word.template.macroenabled.12":"dotm","vnd.ms-works":["wps","wks","wcm","wdb"],"vnd.ms-wpl":"wpl","vnd.ms-xpsdocument":"xps","vnd.mseq":"mseq","vnd.musician":"mus","vnd.muvee.style":"msty","vnd.mynfc":"taglet","vnd.neurolanguage.nlu":"nlu","vnd.nitf":["ntf","nitf"],"vnd.noblenet-directory":"nnd","vnd.noblenet-sealer":"nns","vnd.noblenet-web":"nnw","vnd.nokia.n-gage.data":"ngdat","vnd.nokia.n-gage.symbian.install":"n-gage","vnd.nokia.radio-preset":"rpst","vnd.nokia.radio-presets":"rpss","vnd.novadigm.edm":"edm","vnd.novadigm.edx":"edx","vnd.novadigm.ext":"ext","vnd.oasis.opendocument.chart-template":"otc","vnd.oasis.opendocument.formula-template":"odft","vnd.oasis.opendocument.image-template":"oti","vnd.olpc-sugar":"xo","vnd.oma.dd2+xml":"dd2","vnd.openofficeorg.extension":"oxt","vnd.openxmlformats-officedocument.presentationml.slide":"sldx","vnd.osgeo.mapguide.package":"mgp","vnd.osgi.dp":"dp","vnd.osgi.subsystem":"esa","vnd.palm":["pdb","pqa","oprc"],"vnd.pawaafile":"paw","vnd.pg.format":"str","vnd.pg.osasli":"ei6","vnd.picsel":"efif","vnd.pmi.widget":"wg","vnd.pocketlearn":"plf","vnd.powerbuilder6":"pbd","vnd.previewsystems.box":"box","vnd.proteus.magazine":"mgz","vnd.publishare-delta-tree":"qps","vnd.pvi.ptid1":"ptid","vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"vnd.realvnc.bed":"bed","vnd.recordare.musicxml":"mxl","vnd.recordare.musicxml+xml":"musicxml","vnd.rig.cryptonote":"cryptonote","vnd.rn-realmedia":"rm","vnd.rn-realmedia-vbr":"rmvb","vnd.route66.link66+xml":"link66","vnd.sailingtracker.track":"st","vnd.seemail":"see","vnd.sema":"sema","vnd.semd":"semd","vnd.semf":"semf","vnd.shana.informed.formdata":"ifm","vnd.shana.informed.formtemplate":"itp","vnd.shana.informed.interchange":"iif","vnd.shana.informed.package":"ipk","vnd.simtech-mindmapper":["twd","twds"],"vnd.smart.teacher":"teacher","vnd.solent.sdkm+xml":["sdkm","sdkd"],"vnd.spotfire.dxp":"dxp","vnd.spotfire.sfs":"sfs","vnd.stepmania.package":"smzip","vnd.stepmania.stepchart":"sm","vnd.sus-calendar":["sus","susp"],"vnd.svd":"svd","vnd.syncml+xml":"xsm","vnd.syncml.dm+wbxml":"bdm","vnd.syncml.dm+xml":"xdm","vnd.tao.intent-module-archive":"tao","vnd.tcpdump.pcap":["pcap","cap","dmp"],"vnd.tmobile-livetv":"tmo","vnd.trid.tpt":"tpt","vnd.triscape.mxs":"mxs","vnd.trueapp":"tra","vnd.ufdl":["ufd","ufdl"],"vnd.uiq.theme":"utz","vnd.umajin":"umj","vnd.unity":"unityweb","vnd.uoml+xml":"uoml","vnd.vcx":"vcx","vnd.visionary":"vis","vnd.vsf":"vsf","vnd.webturbo":"wtb","vnd.wolfram.player":"nbp","vnd.wqd":"wqd","vnd.wt.stf":"stf","vnd.xara":"xar","vnd.xfdl":"xfdl","vnd.yamaha.hv-dic":"hvd","vnd.yamaha.hv-script":"hvs","vnd.yamaha.hv-voice":"hvp","vnd.yamaha.openscoreformat":"osf","vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","vnd.yamaha.smaf-audio":"saf","vnd.yamaha.smaf-phrase":"spf","vnd.yellowriver-custom-menu":"cmp","vnd.zul":["zir","zirz"],"vnd.zzazz.deck+xml":"zaz","voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-ace-compressed":"ace","x-authorware-bin":["aab","x32","u32","vox"],"x-authorware-map":"aam","x-authorware-seg":"aas","x-blorb":["blb","blorb"],"x-bzip":"bz","x-bzip2":["bz2","boz"],"x-cfs-compressed":"cfs","x-chat":"chat","x-conference":"nsc","x-dgc-compressed":"dgc","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-eva":"eva","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-freearc":"arc","x-gca-compressed":"gca","x-glulx":"ulx","x-gramps-xml":"gramps","x-install-instructions":"install","x-lzh-compressed":["lzh","lha"],"x-mie":"mie","x-mobipocket-ebook":["prc","mobi"],"x-ms-application":"application","x-ms-shortcut":"lnk","x-ms-xbap":"xbap","x-msbinder":"obd","x-mscardfile":"crd","x-msclip":"clp","application/x-ms-installer":"msi","x-msmediaview":["mvb","m13","m14"],"x-msmetafile":["wmf","wmz","emf","emz"],"x-msmoney":"mny","x-mspublisher":"pub","x-msschedule":"scd","x-msterminal":"trm","x-mswrite":"wri","x-nzb":"nzb","x-pkcs12":["p12","pfx"],"x-pkcs7-certificates":["p7b","spc"],"x-research-info-systems":"ris","x-silverlight-app":"xap","x-sql":"sql","x-stuffitx":"sitx","x-subrip":"srt","x-t3vm-image":"t3","x-tex-tfm":"tfm","x-tgif":"obj","x-xliff+xml":"xlf","x-xz":"xz","x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"xaml+xml":"xaml","xcap-diff+xml":"xdf","xenc+xml":"xenc","xml-dtd":"dtd","xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",envoy:"evy",fractals:"fif","internet-property-stream":"acx",olescript:"axs","vnd.ms-outlook":"msg","vnd.ms-pkicertstore":"sst","x-compress":"z","x-perfmon":["pma","pmc","pmr","pmw"],"ynd.ms-pkipko":"pko",gzip:["gz","tgz"],"smil+xml":["smi","smil"],"vnd.debian.binary-package":["deb","udeb"],"vnd.hzn-3d-crossword":"x3d","vnd.sqlite3":["db","sqlite","sqlite3","db-wal","sqlite-wal","db-shm","sqlite-shm"],"vnd.wap.sic":"sic","vnd.wap.slc":"slc","x-krita":["kra","krz"],"x-perl":["pm","pl"],yaml:["yaml","yml"]},audio:{amr:"amr","amr-wb":"awb",annodex:"axa",basic:["au","snd"],flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"prs.sid":"sid","x-aiff":"aifc","x-gsm":"gsm","x-ms-wma":"wma","x-ms-wax":"wax","x-pn-realaudio":"ram","x-realaudio":"ra","x-sd2":"sd2",adpcm:"adp",mp4:"mp4a",s3m:"s3m",silk:"sil","vnd.dece.audio":["uva","uvva"],"vnd.digital-winds":"eol","vnd.dra":"dra","vnd.dts":"dts","vnd.dts.hd":"dtshd","vnd.lucent.voice":"lvp","vnd.ms-playready.media.pya":"pya","vnd.nuera.ecelp4800":"ecelp4800","vnd.nuera.ecelp7470":"ecelp7470","vnd.nuera.ecelp9600":"ecelp9600","vnd.rip":"rip",webm:"weba","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",aac:"aac",aiff:["aiff","aif","aff"],opus:"opus",wav:"wav"},chemical:{"x-alchemy":"alc","x-cache":["cac","cache"],"x-cache-csf":"csf","x-cactvs-binary":["cbin","cascii","ctab"],"x-cdx":"cdx","x-chem3d":"c3d","x-cif":"cif","x-cmdf":"cmdf","x-cml":"cml","x-compass":"cpa","x-crossfire":"bsd","x-csml":["csml","csm"],"x-ctx":"ctx","x-cxf":["cxf","cef"],"x-embl-dl-nucleotide":["emb","embl"],"x-gamess-input":["inp","gam","gamin"],"x-gaussian-checkpoint":["fch","fchk"],"x-gaussian-cube":"cub","x-gaussian-input":["gau","gjc","gjf"],"x-gaussian-log":"gal","x-gcg8-sequence":"gcg","x-genbank":"gen","x-hin":"hin","x-isostar":["istr","ist"],"x-jcamp-dx":["jdx","dx"],"x-kinemage":"kin","x-macmolecule":"mcm","x-macromodel-input":"mmod","x-mdl-molfile":"mol","x-mdl-rdfile":"rd","x-mdl-rxnfile":"rxn","x-mdl-sdfile":"sd","x-mdl-tgf":"tgf","x-mmcif":"mcif","x-mol2":"mol2","x-molconn-Z":"b","x-mopac-graph":"gpt","x-mopac-input":["mop","mopcrt","zmt"],"x-mopac-out":"moo","x-ncbi-asn1":"asn","x-ncbi-asn1-ascii":["prt","ent"],"x-ncbi-asn1-binary":"val","x-rosdal":"ros","x-swissprot":"sw","x-vamas-iso14976":"vms","x-vmd":"vmd","x-xtel":"xtel","x-xyz":"xyz"},font:{otf:"otf",woff:"woff",woff2:"woff2"},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe","jfif","jfif-tbnl","jif"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.djvu":["djvu","djv"],"vnd.wap.wbmp":"wbmp","x-canon-cr2":"cr2","x-canon-crw":"crw","x-cmu-raster":"ras","x-coreldraw":"cdr","x-coreldrawpattern":"pat","x-coreldrawtemplate":"cdt","x-corelphotopaint":"cpt","x-epson-erf":"erf","x-icon":"ico","x-jg":"art","x-jng":"jng","x-nikon-nef":"nef","x-olympus-orf":"orf","x-portable-anymap":"pnm","x-portable-bitmap":"pbm","x-portable-graymap":"pgm","x-portable-pixmap":"ppm","x-rgb":"rgb","x-xbitmap":"xbm","x-xpixmap":"xpm","x-xwindowdump":"xwd",bmp:"bmp",cgm:"cgm",g3fax:"g3",ktx:"ktx","prs.btif":"btif",sgi:"sgi","vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"vnd.dwg":"dwg","vnd.dxf":"dxf","vnd.fastbidsheet":"fbs","vnd.fpx":"fpx","vnd.fst":"fst","vnd.fujixerox.edmics-mmr":"mmr","vnd.fujixerox.edmics-rlc":"rlc","vnd.ms-modi":"mdi","vnd.ms-photo":"wdp","vnd.net-fpx":"npx","vnd.xiff":"xif",webp:"webp","x-3ds":"3ds","x-cmx":"cmx","x-freehand":["fh","fhc","fh4","fh5","fh7"],"x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod",avif:"avifs",heic:["heif","heic"],pjpeg:["pjpg"],"vnd.adobe.photoshop":"psd","x-adobe-dng":"dng","x-fuji-raf":"raf","x-icns":"icns","x-kodak-dcr":"dcr","x-kodak-k25":"k25","x-kodak-kdc":"kdc","x-minolta-mrw":"mrw","x-panasonic-raw":["raw","rw2","rwl"],"x-pentax-pef":["pef","ptx"],"x-sigma-x3f":"x3f","x-sony-arw":"arw","x-sony-sr2":"sr2","x-sony-srf":"srf"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},model:{iges:["igs","iges"],mesh:["msh","mesh","silo"],vrml:["wrl","vrml"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":"x3dz","x3d+binary":["x3db","x3dbz"],"vnd.collada+xml":"dae","vnd.dwf":"dwf","vnd.gdl":"gdl","vnd.gtw":"gtw","vnd.mts":"mts","vnd.usdz+zip":"usdz","vnd.vtu":"vtu"},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",plain:["txt","text","brf","conf","def","list","log","in","bas","diff","ksh"],richtext:"rtx",scriptlet:["sct","wsc"],texmacs:"tm","tab-separated-values":"tsv","vnd.sun.j2me.app-descriptor":"jad","vnd.wap.wml":"wml","vnd.wap.wmlscript":"wmls","x-bibtex":"bib","x-boo":"boo","x-c++hdr":["h++","hpp","hxx","hh"],"x-c++src":["c++","cpp","cxx","cc"],"x-component":"htc","x-dsrc":"d","x-diff":"patch","x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas","pp","inc"],"x-pcs-gcd":"gcd","x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcalendar":"vcs","x-vcard":"vcf",n3:"n3","prs.lines.tag":"dsc",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl","uri-list":["uri","uris","urls"],vcard:"vcard","vnd.curl":"curl","vnd.curl.dcurl":"dcurl","vnd.curl.scurl":"scurl","vnd.curl.mcurl":"mcurl","vnd.dvb.subtitle":"sub","vnd.fly":"fly","vnd.fmi.flexstor":"flx","vnd.graphviz":"gv","vnd.in3d.3dml":"3dml","vnd.in3d.spot":"spot","x-asm":["s","asm"],"x-c":["c","h","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt",javascript:"js",json:"json",markdown:["md","markdown","mdown","markdn"],"vnd.wap.si":"si","vnd.wap.sl":"sl"},video:{avif:"avif","3gpp":"3gp",annodex:"axv",dl:"dl",dv:["dif","dv"],fli:"fli",gl:"gl",mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.dece.hd":["uvh","uvvh"],"vnd.dece.mobile":["uvm","uvvm"],"vnd.dece.pd":["uvp","uvvp"],"vnd.dece.sd":["uvs","uvvs"],"vnd.dece.video":["uvv","uvvv"],"vnd.dvb.file":"dvb","vnd.fvt":"fvt","vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv",mp2t:"ts"},"x-conference":{"x-cooltalk":"ice"},"x-world":{"x-vrml":["vrm","flr","wrz","xaf","xof"]}};(()=>{const e={};for(const t of Object.keys(Gm))for(const n of Object.keys(Gm[t])){const i=Gm[t][n];if("string"==typeof i)e[i]=t+"/"+n;else for(let r=0;r<i.length;r++)e[i[r]]=t+"/"+n}})();const qm=[];for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=t>>>1^3988292384:t>>>=1;qm[e]=t}class Km{constructor(e){this.crc=e||-1}append(e){let t=0|this.crc;for(let n=0,i=0|e.length;n<i;n++)t=t>>>8^qm[255&(t^e[n])];this.crc=t}get(){return~this.crc}}class Ym extends TransformStream{constructor(){let e;const t=new Km;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}function Xm(e){if("undefined"==typeof TextEncoder){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new TextEncoder).encode(e)}const Qm={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],i=Qm.getPartial(n);return 32===i?e.concat(t):Qm._shiftRight(t,i,0|n,e.slice(0,e.length-1))},bitLength(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+Qm.getPartial(n)},clamp(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=Qm.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,getPartial:e=>Math.round(e/1099511627776)||32,_shiftRight(e,t,n,i){for(void 0===i&&(i=[]);t>=32;t-=32)i.push(n),n=0;if(0===t)return i.concat(e);for(let r=0;r<e.length;r++)i.push(n|e[r]>>>t),n=e[r]<<32-t;const r=e.length?e[e.length-1]:0,o=Qm.getPartial(r);return i.push(Qm.partial(t+o&31,t+o>32?n:i.pop(),1)),i}},Zm={bytes:{fromBits(e){const t=Qm.bitLength(e)/8,n=new Uint8Array(t);let i;for(let r=0;r<t;r++)!(3&r)&&(i=e[r/4]),n[r]=i>>>24,i<<=8;return n},toBits(e){const t=[];let n,i=0;for(n=0;n<e.length;n++)i=i<<8|e[n],!(3&~n)&&(t.push(i),i=0);return 3&n&&t.push(Qm.partial(8*(3&n),i)),t}}},Jm=class{constructor(e){const t=this;t.blockSize=512,t._init=[1732584193,4023233417,2562383102,271733878,3285377520],t._key=[1518500249,1859775393,2400959708,3395469782],e?(t._h=e._h.slice(0),t._buffer=e._buffer.slice(0),t._length=e._length):t.reset()}reset(){const e=this;return e._h=e._init.slice(0),e._buffer=[],e._length=0,e}update(e){const t=this;"string"==typeof e&&(e=Zm.utf8String.toBits(e));const n=t._buffer=Qm.concat(t._buffer,e),i=t._length,r=t._length=i+Qm.bitLength(e);if(r>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const o=new Uint32Array(n);let a=0;for(let e=t.blockSize+i-(t.blockSize+i&t.blockSize-1);e<=r;e+=t.blockSize)t._block(o.subarray(16*a,16*(a+1))),a+=1;return n.splice(0,16*a),t}finalize(){const e=this;let t=e._buffer;const n=e._h;t=Qm.concat(t,[Qm.partial(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(e._length/4294967296)),t.push(0|e._length);t.length;)e._block(t.splice(0,16));return e.reset(),n}_f(e,t,n,i){return e<=19?t&n|~t&i:e<=39?t^n^i:e<=59?t&n|t&i|n&i:e<=79?t^n^i:void 0}_S(e,t){return t<<e|t>>>32-e}_block(e){const t=this,n=t._h,i=Array(80);for(let t=0;t<16;t++)i[t]=e[t];let r=n[0],o=n[1],a=n[2],s=n[3],l=n[4];for(let e=0;e<=79;e++){e>=16&&(i[e]=t._S(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const n=t._S(5,r)+t._f(e,o,a,s)+l+i[e]+t._key[Math.floor(e/20)]|0;l=s,s=a,a=t._S(30,o),o=r,r=n}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+l|0}},$m=class{constructor(e){const t=this;t._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],t._tables[0][0][0]||t._precompute();const n=t._tables[0][4],i=t._tables[1],r=e.length;let o,a,s,l=1;if(4!==r&&6!==r&&8!==r)throw new Error("invalid aes key size");for(t._key=[a=e.slice(0),s=[]],o=r;o<4*r+28;o++){let e=a[o-1];(o%r==0||8===r&&o%r==4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],o%r==0&&(e=e<<8^e>>>24^l<<24,l=l<<1^283*(l>>7))),a[o]=a[o-r]^e}for(let e=0;o;e++,o--){const t=a[3&e?o:o-4];s[e]=o<=4||e<4?t:i[0][n[t>>>24]]^i[1][n[t>>16&255]]^i[2][n[t>>8&255]]^i[3][n[255&t]]}}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){const e=this._tables[0],t=this._tables[1],n=e[4],i=t[4],r=[],o=[];let a,s,l,c;for(let e=0;e<256;e++)o[(r[e]=e<<1^283*(e>>7))^e]=e;for(let u=a=0;!n[u];u^=s||1,a=o[a]||1){let o=a^a<<1^a<<2^a<<3^a<<4;o=o>>8^255&o^99,n[u]=o,i[o]=u,c=r[l=r[s=r[u]]];let d=16843009*c^65537*l^257*s^16843008*u,p=257*r[o]^16843008*o;for(let n=0;n<4;n++)e[n][u]=p=p<<24^p>>>8,t[n][o]=d=d<<24^d>>>8}for(let n=0;n<5;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}_crypt(e,t){if(4!==e.length)throw new Error("invalid aes block size");const n=this._key[t],i=n.length/4-2,r=[0,0,0,0],o=this._tables[t],a=o[0],s=o[1],l=o[2],c=o[3],u=o[4];let d,p,h,f=e[0]^n[0],m=e[t?3:1]^n[1],v=e[2]^n[2],g=e[t?1:3]^n[3],y=4;for(let e=0;e<i;e++)d=a[f>>>24]^s[m>>16&255]^l[v>>8&255]^c[255&g]^n[y],p=a[m>>>24]^s[v>>16&255]^l[g>>8&255]^c[255&f]^n[y+1],h=a[v>>>24]^s[g>>16&255]^l[f>>8&255]^c[255&m]^n[y+2],g=a[g>>>24]^s[f>>16&255]^l[m>>8&255]^c[255&v]^n[y+3],y+=4,f=d,m=p,v=h;for(let e=0;e<4;e++)r[t?3&-e:e]=u[f>>>24]<<24^u[m>>16&255]<<16^u[v>>8&255]<<8^u[255&g]^n[y++],d=f,f=m,m=v,v=g,g=d;return r}},ev={getRandomValues(e){const t=new Uint32Array(e.buffer),n=e=>{let t=987654321;const n=4294967295;return function(){return t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let i,r=0;r<e.length;r+=4){const e=n(4294967296*(i||Math.random()));i=987654071*e(),t[r/4]=4294967296*e()|0}return e}},tv=class{constructor(e,t){this._prf=e,this._initIv=t,this._iv=t}reset(){this._iv=this._initIv}update(e){return this.calculate(this._prf,e,this._iv)}incWord(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}incCounter(e){0===(e[0]=this.incWord(e[0]))&&(e[1]=this.incWord(e[1]))}calculate(e,t,n){let i;if(!(i=t.length))return[];const r=Qm.bitLength(t);for(let r=0;r<i;r+=4){this.incCounter(n);const i=e.encrypt(n);t[r]^=i[0],t[r+1]^=i[1],t[r+2]^=i[2],t[r+3]^=i[3]}return Qm.clamp(t,r)}},nv={importKey:e=>new nv.hmacSha1(Zm.bytes.toBits(e)),pbkdf2(e,t,n,i){if(n=n||1e4,i<0||n<0)throw new Error("invalid params to pbkdf2");const r=1+(i>>5)<<2;let o,a,s,l,c;const u=new ArrayBuffer(r),d=new DataView(u);let p=0;const h=Qm;for(t=Zm.bytes.toBits(t),c=1;p<(r||1);c++){for(o=a=e.encrypt(h.concat(t,[c])),s=1;s<n;s++)for(a=e.encrypt(a),l=0;l<a.length;l++)o[l]^=a[l];for(s=0;p<(r||1)&&s<o.length;s++)d.setInt32(p,o[s]),p+=4}return u.slice(0,i/8)},hmacSha1:class{constructor(e){const t=this,n=t._hash=Jm,i=[[],[]];t._baseHash=[new n,new n];const r=t._baseHash[0].blockSize/32;e.length>r&&(e=(new n).update(e).finalize());for(let t=0;t<r;t++)i[0][t]=909522486^e[t],i[1][t]=1549556828^e[t];t._baseHash[0].update(i[0]),t._baseHash[1].update(i[1]),t._resultHash=new n(t._baseHash[0])}reset(){const e=this;e._resultHash=new e._hash(e._baseHash[0]),e._updated=!1}update(e){this._updated=!0,this._resultHash.update(e)}digest(){const e=this,t=e._resultHash.finalize(),n=new e._hash(e._baseHash[1]).update(t).finalize();return e.reset(),n}encrypt(e){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},iv="undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues;function rv(e){return iv?crypto.getRandomValues(e):ev.getRandomValues(e)}const ov={name:"PBKDF2"},av=Object.assign({hash:{name:"HMAC"}},ov),sv=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},ov),lv=["deriveBits"],cv=[8,12,16],uv=[16,24,32],dv=[0,0,0,0],pv="undefined"!=typeof crypto,hv=pv&&crypto.subtle,fv=pv&&void 0!==hv,mv=Zm.bytes,vv=$m,gv=tv,yv=nv.hmacSha1;let bv=pv&&fv&&"function"==typeof hv.importKey,Ev=pv&&fv&&"function"==typeof hv.deriveBits;class xv extends TransformStream{constructor({password:e,rawPassword:t,signed:n,encryptionStrength:i,checkPasswordOnly:r}){super({start(){Object.assign(this,{ready:new Promise((e=>this.resolveReady=e)),password:kv(e,t),signed:n,strength:i-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:o,resolveReady:a,ready:s}=n;i?(await async function(e,t,n,i){const r=await Sv(e,t,n,Tv(i,0,cv[t])),o=Tv(i,cv[t]);if(r[0]!=o[0]||r[1]!=o[1])throw new Error("Invalid password")}(n,o,i,Tv(e,0,cv[o]+2)),e=Tv(e,cv[o]+2),r?t.error(new Error("zipjs-abort-check-password")):a()):await s;const l=new Uint8Array(e.length-10-(e.length-10)%16);t.enqueue(Cv(n,e,l,0,10,!0))},async flush(e){const{signed:t,ctr:n,hmac:i,pending:r,ready:o}=this;if(i&&n){await o;const a=Tv(r,0,r.length-10),s=Tv(r,r.length-10);let l=new Uint8Array;if(a.length){const e=Pv(mv,a);i.update(e);const t=n.update(e);l=Iv(mv,t)}if(t){const e=Tv(Iv(mv,i.digest()),0,10);for(let t=0;t<10;t++)if(e[t]!=s[t])throw new Error("Invalid signature")}e.enqueue(l)}}})}}class wv extends TransformStream{constructor({password:e,rawPassword:t,encryptionStrength:n}){let i;super({start(){Object.assign(this,{ready:new Promise((e=>this.resolveReady=e)),password:kv(e,t),strength:n-1,pending:new Uint8Array})},async transform(e,t){const n=this,{password:i,strength:r,resolveReady:o,ready:a}=n;let s=new Uint8Array;i?(s=await async function(e,t,n){const i=rv(new Uint8Array(cv[t]));return _v(i,await Sv(e,t,n,i))}(n,r,i),o()):await a;const l=new Uint8Array(s.length+e.length-e.length%16);l.set(s,0),t.enqueue(Cv(n,e,l,s.length,0))},async flush(e){const{ctr:t,hmac:n,pending:r,ready:o}=this;if(n&&t){await o;let a=new Uint8Array;if(r.length){const e=t.update(Pv(mv,r));n.update(e),a=Iv(mv,e)}i.signature=Iv(mv,n.digest()).slice(0,10),e.enqueue(_v(a,i.signature))}}}),i=this}}function Cv(e,t,n,i,r,o){const{ctr:a,hmac:s,pending:l}=e,c=t.length-r;let u;for(l.length&&(t=_v(l,t),n=function(e,t){if(t&&t>e.length){const n=e;(e=new Uint8Array(t)).set(n,0)}return e}(n,c-c%16)),u=0;u<=c-16;u+=16){const e=Pv(mv,Tv(t,u,u+16));o&&s.update(e);const r=a.update(e);o||s.update(r),n.set(Iv(mv,r),u+i)}return e.pending=Tv(t,u),n}async function Sv(e,t,n,i){e.password=null;const r=await async function(e,t,n,i,r){if(!bv)return nv.importKey(t);try{return await hv.importKey("raw",t,n,!1,r)}catch(e){return bv=!1,nv.importKey(t)}}(0,n,av,0,lv),o=await async function(e,t,n){if(!Ev)return nv.pbkdf2(t,e.salt,sv.iterations,n);try{return await hv.deriveBits(e,t,n)}catch(i){return Ev=!1,nv.pbkdf2(t,e.salt,sv.iterations,n)}}(Object.assign({salt:i},sv),r,8*(2*uv[t]+2)),a=new Uint8Array(o),s=Pv(mv,Tv(a,0,uv[t])),l=Pv(mv,Tv(a,uv[t],2*uv[t])),c=Tv(a,2*uv[t]);return Object.assign(e,{keys:{key:s,authentication:l,passwordVerification:c},ctr:new gv(new vv(s),Array.from(dv)),hmac:new yv(l)}),c}function kv(e,t){return void 0===t?Xm(e):t}function _v(e,t){let n=e;return e.length+t.length&&(n=new Uint8Array(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function Tv(e,t,n){return e.subarray(t,n)}function Iv(e,t){return e.fromBits(t)}function Pv(e,t){return e.toBits(t)}class Nv extends TransformStream{constructor({password:e,passwordVerification:t,checkPasswordOnly:n}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),Rv(this,e)},transform(e,t){const i=this;if(i.password){const t=Av(i,e.subarray(0,12));if(i.password=null,t[11]!=i.passwordVerification)throw new Error("Invalid password");e=e.subarray(12)}n?t.error(new Error("zipjs-abort-check-password")):t.enqueue(Av(i,e))}})}}class Mv extends TransformStream{constructor({password:e,passwordVerification:t}){super({start(){Object.assign(this,{password:e,passwordVerification:t}),Rv(this,e)},transform(e,t){const n=this;let i,r;if(n.password){n.password=null;const t=rv(new Uint8Array(12));t[11]=n.passwordVerification,i=new Uint8Array(e.length+t.length),i.set(Dv(n,t),0),r=12}else i=new Uint8Array(e.length),r=0;i.set(Dv(n,e),r),t.enqueue(i)}})}}function Av(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Lv(e)^t[i],Bv(e,n[i]);return n}function Dv(e,t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=Lv(e)^t[i],Bv(e,t[i]);return n}function Rv(e,t){const n=[305419896,591751049,878082192];Object.assign(e,{keys:n,crcKey0:new Km(n[0]),crcKey2:new Km(n[2])});for(let n=0;n<t.length;n++)Bv(e,t.charCodeAt(n))}function Bv(e,t){let[n,i,r]=e.keys;e.crcKey0.append([t]),n=~e.crcKey0.get(),i=Fv(Math.imul(Fv(i+Ov(n)),134775813)+1),e.crcKey2.append([i>>>24]),r=~e.crcKey2.get(),e.keys=[n,i,r]}function Lv(e){const t=2|e.keys[2];return Ov(Math.imul(t,1^t)>>>8)}function Ov(e){return 255&e}function Fv(e){return 4294967295&e}class zv extends TransformStream{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:i}){super({});const{compressed:r,encrypted:o,useCompressionStream:a,zipCrypto:s,signed:l,level:c}=e,u=this;let d,p,h=Uv(super.readable);o&&!s||!l||(d=new Ym,h=jv(h,d)),r&&(h=Vv(h,a,{level:c,chunkSize:t},i,n)),o&&(s?h=jv(h,new Mv(e)):(p=new wv(e),h=jv(h,p))),Wv(u,h,(()=>{let e;o&&!s&&(e=p.signature),o&&!s||!l||(e=new DataView(d.value.buffer).getUint32(0)),u.signature=e}))}}class Hv extends TransformStream{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:i}){super({});const{zipCrypto:r,encrypted:o,signed:a,signature:s,compressed:l,useCompressionStream:c}=e;let u,d,p=Uv(super.readable);o&&(r?p=jv(p,new Nv(e)):(d=new xv(e),p=jv(p,d))),l&&(p=Vv(p,c,{chunkSize:t},i,n)),o&&!r||!a||(u=new Ym,p=jv(p,u)),Wv(this,p,(()=>{if((!o||r)&&a){const e=new DataView(u.value.buffer);if(s!=e.getUint32(0,!1))throw new Error("Invalid signature")}}))}}function Uv(e){return jv(e,new TransformStream({transform(e,t){e&&e.length&&t.enqueue(e)}}))}function Wv(e,t,n){t=jv(t,new TransformStream({flush:n})),Object.defineProperty(e,"readable",{get:()=>t})}function Vv(e,t,n,i,r){try{e=jv(e,new(t&&i?i:r)("deflate-raw",n))}catch(i){if(!t)return e;try{e=jv(e,new r("deflate-raw",n))}catch(t){return e}}return e}function jv(e,t){return e.pipeThrough(t)}class Gv extends TransformStream{constructor(e,t){super({});const n=this,{codecType:i}=e;let r;i.startsWith("deflate")?r=zv:i.startsWith("inflate")&&(r=Hv);let o=0,a=0;const s=new r(e,t),l=super.readable,c=new TransformStream({transform(e,t){e&&e.length&&(a+=e.length,t.enqueue(e))},flush(){Object.assign(n,{inputSize:a})}}),u=new TransformStream({transform(e,t){e&&e.length&&(o+=e.length,t.enqueue(e))},flush(){const{signature:e}=s;Object.assign(n,{signature:e,outputSize:o,inputSize:a})}});Object.defineProperty(n,"readable",{get:()=>l.pipeThrough(c).pipeThrough(s).pipeThrough(u)})}}class qv extends TransformStream{constructor(e){let t;super({transform:function n(i,r){if(t){const e=new Uint8Array(t.length+i.length);e.set(t),e.set(i,t.length),i=e,t=null}i.length>e?(r.enqueue(i.slice(0,e)),n(i.slice(e),r)):t=i},flush(e){t&&t.length&&e.enqueue(t)}})}}let Kv="undefined"!=typeof Worker;class Yv{constructor(e,{readable:t,writable:n},{options:i,config:r,streamOptions:o,useWebWorkers:a,transferStreams:s,scripts:l},c){const{signal:u}=o;return Object.assign(e,{busy:!0,readable:t.pipeThrough(new qv(r.chunkSize)).pipeThrough(new Xv(t,o),{signal:u}),writable:n,options:Object.assign({},i),scripts:l,transferStreams:s,terminate:()=>new Promise((t=>{const{worker:n,busy:i}=e;n?(i?e.resolveTerminated=t:(n.terminate(),t()),e.interface=null):t()})),onTaskFinished(){const{resolveTerminated:t}=e;t&&(e.resolveTerminated=null,e.terminated=!0,e.worker.terminate(),t()),e.busy=!1,c(e)}}),(a&&Kv?Jv:Zv)(e,r)}}class Xv extends TransformStream{constructor(e,{onstart:t,onprogress:n,size:i,onend:r}){let o=0;super({async start(){t&&await Qv(t,i)},async transform(e,t){o+=e.length,n&&await Qv(n,o,i),t.enqueue(e)},async flush(){e.size=o,r&&await Qv(r,o)}})}}async function Qv(e,...t){try{await e(...t)}catch(e){}}function Zv(e,t){return{run:()=>async function({options:e,readable:t,writable:n,onTaskFinished:i},r){try{const i=new Gv(e,r);await t.pipeThrough(i).pipeTo(n,{preventClose:!0,preventAbort:!0});const{signature:o,inputSize:a,outputSize:s}=i;return{signature:o,inputSize:a,outputSize:s}}finally{i()}}(e,t)}}function Jv(e,t){const{baseURL:n,chunkSize:i}=t;if(!e.interface){let r;try{r=function(e,t,n){const i={type:"module"};let r,o;"function"==typeof e&&(e=e());try{r=new URL(e,t)}catch(t){r=e}if($v)try{o=new Worker(r)}catch(e){$v=!1,o=new Worker(r,i)}else o=new Worker(r,i);return o.addEventListener("message",(e=>async function({data:e},t){const{type:n,value:i,messageId:r,result:o,error:a}=e,{reader:s,writer:l,resolveResult:c,rejectResult:u,onTaskFinished:d}=t;try{if(a){const{message:e,stack:t,code:n,name:i}=a,r=new Error(e);Object.assign(r,{stack:t,code:n,name:i}),p(r)}else{if("pull"==n){const{value:e,done:n}=await s.read();tg({type:"data",value:e,done:n,messageId:r},t)}"data"==n&&(await l.ready,await l.write(new Uint8Array(i)),tg({type:"ack",messageId:r},t)),"close"==n&&p(null,o)}}catch(a){tg({type:"close",messageId:r},t),p(a)}function p(e,t){e?u(e):c(t),l&&l.releaseLock(),d()}}(e,n))),o}(e.scripts[0],n,e)}catch(n){return Kv=!1,Zv(e,t)}Object.assign(e,{worker:r,interface:{run:()=>async function(e,t){let n,i;const r=new Promise(((e,t)=>{n=e,i=t}));Object.assign(e,{reader:null,writer:null,resolveResult:n,rejectResult:i,result:r});const{readable:o,options:a,scripts:s}=e,{writable:l,closed:c}=function(e){let t;const n=new Promise((e=>t=e));return{writable:new WritableStream({async write(t){const n=e.getWriter();await n.ready,await n.write(t),n.releaseLock()},close(){t()},abort:t=>e.getWriter().abort(t)}),closed:n}}(e.writable),u=tg({type:"start",scripts:s.slice(1),options:a,config:t,readable:o,writable:l},e);u||Object.assign(e,{reader:o.getReader(),writer:l.getWriter()});const d=await r;if(!u)try{l.getWriter().close()}catch(e){}return await c,d}(e,{chunkSize:i})}})}return e.interface}let $v=!0,eg=!0;function tg(e,{worker:t,writer:n,onTaskFinished:i,transferStreams:r}){try{let{value:i,readable:o,writable:a}=e;const s=[];if(i&&(i.byteLength<i.buffer.byteLength?e.value=i.buffer.slice(0,i.byteLength):e.value=i.buffer,s.push(e.value)),r&&eg?(o&&s.push(o),a&&s.push(a)):e.readable=e.writable=null,s.length)try{return t.postMessage(e,s),!0}catch(n){eg=!1,e.readable=e.writable=null,t.postMessage(e)}else t.postMessage(e)}catch(e){throw n&&n.releaseLock(),i(),e}}let ng=[];const ig=[];let rg=0;function og(e){const{terminateTimeout:t}=e;t&&(clearTimeout(t),e.terminateTimeout=null)}const ag=65536;class sg{constructor(){this.size=0}init(){this.initialized=!0}}class lg extends sg{get readable(){const e=this,{chunkSize:t=ag}=e,n=new ReadableStream({start(){this.chunkOffset=0},async pull(i){const{offset:r=0,size:o,diskNumberStart:a}=n,{chunkOffset:s}=this;i.enqueue(await fg(e,r+s,Math.min(t,o-s),a)),s+t>o?i.close():this.chunkOffset+=t}});return n}}class cg extends lg{constructor(e){super(),Object.assign(this,{blob:e,size:e.size})}async readUint8Array(e,t){const n=this,i=e+t,r=e||i<n.size?n.blob.slice(e,i):n.blob;let o=await r.arrayBuffer();return o.byteLength>t&&(o=o.slice(e,i)),new Uint8Array(o)}}class ug extends sg{constructor(e){super();const t=new TransformStream,n=[];e&&n.push(["Content-Type",e]),Object.defineProperty(this,"writable",{get:()=>t.writable}),this.blob=new Response(t.readable,{headers:n}).blob()}getData(){return this.blob}}class dg extends lg{constructor(e){super(),this.readers=e}async init(){const e=this,{readers:t}=e;e.lastDiskNumber=0,e.lastDiskOffset=0,await Promise.all(t.map((async(n,i)=>{await n.init(),i!=t.length-1&&(e.lastDiskOffset+=n.size),e.size+=n.size}))),super.init()}async readUint8Array(e,t,n=0){const i=this,{readers:r}=this;let o,a=n;-1==a&&(a=r.length-1);let s=e;for(;s>=r[a].size;)s-=r[a].size,a++;const l=r[a],c=l.size;if(s+t<=c)o=await fg(l,s,t);else{const r=c-s;o=new Uint8Array(t),o.set(await fg(l,s,r)),o.set(await i.readUint8Array(e+r,t-r,n),r)}return i.lastDiskNumber=Math.max(a,i.lastDiskNumber),o}}class pg extends sg{constructor(e,t=4294967295){super();const n=this;let i,r,o;Object.assign(n,{diskNumber:0,diskOffset:0,size:0,maxSize:t,availableSize:t});const a=new WritableStream({async write(t){const{availableSize:a}=n;if(o)t.length>=a?(await s(t.slice(0,a)),await l(),n.diskOffset+=i.size,n.diskNumber++,o=null,await this.write(t.slice(a))):await s(t);else{const{value:a,done:s}=await e.next();if(s&&!a)throw new Error("Writer iterator completed too soon");i=a,i.size=0,i.maxSize&&(n.maxSize=i.maxSize),n.availableSize=n.maxSize,await hg(i),r=a.writable,o=r.getWriter(),await this.write(t)}},async close(){await o.ready,await l()}});async function s(e){const t=e.length;t&&(await o.ready,await o.write(e),i.size+=t,n.size+=t,n.availableSize-=t)}async function l(){r.size=i.size,await o.close()}Object.defineProperty(n,"writable",{get:()=>a})}}async function hg(e,t){if(!e.init||e.initialized)return Promise.resolve();await e.init(t)}function fg(e,t,n,i){return e.readUint8Array(t,n,i)}"\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ".split("").length;const mg=["filename","rawFilename","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","lastAccessDate","creationDate","offset","diskNumberStart","diskNumberStart","internalFileAttribute","externalFileAttribute","msDosCompatible","zip64","directory","bitFlag","encrypted","signature","filenameUTF8","commentUTF8","compressionMethod","version","versionMadeBy","extraField","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class vg{constructor(e){mg.forEach((t=>this[t]=e[t]))}}const gg="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",yg=new Uint8Array([7,0,2,0,65,69,3,0,0]);let bg=0;const Eg=[];class xg{constructor(e,t={}){const n=void 0!==(e=function(e){void 0===e.writable&&"function"==typeof e.next&&(e=new pg(e)),e instanceof WritableStream&&(e={writable:e});const{writable:t}=e;return void 0===t.size&&(t.size=0),e instanceof pg||Object.assign(e,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),e}(e)).availableSize&&e.availableSize>0&&e.availableSize!==1/0&&void 0!==e.maxSize&&e.maxSize>0&&e.maxSize!==1/0;Object.assign(this,{writer:e,addSplitZipSignature:n,options:t,config:Wm,files:new Map,filenames:new Set,offset:e.writable.size,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async add(e="",t,n={}){const i=this,{pendingAddFileCalls:r,config:o}=i;let a;bg<o.maxWorkers?bg++:await new Promise((e=>Eg.push(e)));try{if(e=e.trim(),i.filenames.has(e))throw new Error("File already exists");return i.filenames.add(e),a=async function(e,t,n,i){t=t.trim(),i.directory&&!t.endsWith("/")?t+="/":i.directory=t.endsWith("/");const r=Xm(t);if(Mg(r)>65535)throw new Error("File entry name exceeds 64KB");const o=i.comment||"",a=Xm(o);if(Mg(a)>65535)throw new Error("File entry comment exceeds 64KB");const s=Sg(e,i,"version",20);if(s>65535)throw new Error("Version exceeds 65535");const l=Sg(e,i,"versionMadeBy",20);if(l>65535)throw new Error("Version exceeds 65535");const c=Sg(e,i,"lastModDate",new Date),u=Sg(e,i,"lastAccessDate"),d=Sg(e,i,"creationDate"),p=Sg(e,i,"msDosCompatible",!0),h=Sg(e,i,"internalFileAttribute",0),f=Sg(e,i,"externalFileAttribute",0),m=Sg(e,i,"password"),v=Sg(e,i,"rawPassword"),g=Sg(e,i,"encryptionStrength",3),y=Sg(e,i,"zipCrypto"),b=Sg(e,i,"extendedTimestamp",!0),E=Sg(e,i,"keepOrder",!0),x=Sg(e,i,"level"),w=Sg(e,i,"useWebWorkers"),C=Sg(e,i,"bufferedWrite"),S=Sg(e,i,"dataDescriptorSignature",!1),k=Sg(e,i,"signal"),_=Sg(e,i,"useCompressionStream");let T=Sg(e,i,"dataDescriptor",!0),I=Sg(e,i,"zip64");if(void 0!==m&&void 0!==g&&(g<1||g>3))throw new Error("The strength must equal 1, 2, or 3");let P=new Uint8Array;const{extraField:N}=i;if(N){let e=0,t=0;N.forEach((t=>e+=4+Mg(t))),P=new Uint8Array(e),N.forEach(((e,n)=>{if(n>65535)throw new Error("Extra field type exceeds 65535");if(Mg(e)>65535)throw new Error("Extra field data exceeds 64KB");Pg(P,new Uint16Array([n]),t),Pg(P,new Uint16Array([Mg(e)]),t+2),Pg(P,e,t+4),t+=4+Mg(e)}))}let M=0,A=0,D=0;const R=!0===I;n&&(n=function(e){return Array.isArray(e)&&(e=new dg(e)),e instanceof ReadableStream&&(e={readable:e}),e}(n),await hg(n),void 0===n.size?(T=!0,(I||void 0===I)&&(I=!0,D=M=4294967295)):(D=n.size,M=function(e){return e+5*(Math.floor(e/16383)+1)}(D)));const{diskOffset:B,diskNumber:L,maxSize:O}=e.writer,F=R||D>=4294967295,z=R||M>=4294967295,H=R||e.offset+e.pendingEntriesSize-B>=4294967295,U=Sg(e,i,"supportZip64SplitFile",!0)&&R||L+Math.ceil(e.pendingEntriesSize/O)>=65535;if(H||F||z||U){if(!1===I||!E)throw new Error(gg);I=!0}I=I||!1;const W=function(e){const{rawFilename:t,lastModDate:n,lastAccessDate:i,creationDate:r,rawPassword:o,password:a,level:s,zip64:l,zipCrypto:c,dataDescriptor:u,directory:d,rawExtraField:p,encryptionStrength:h,extendedTimestamp:f}=e,m=0!==s&&!d,v=Boolean(a&&Mg(a)||o&&Mg(o));let g,y,b,E,x=e.version;if(v&&!c){g=new Uint8Array(Mg(yg)+2);const e=Ng(g);_g(e,0,39169),Pg(g,yg,2),kg(e,8,h)}else g=new Uint8Array;if(f){b=new Uint8Array(9+(i?4:0)+(r?4:0));const t=Ng(b);_g(t,0,21589),_g(t,2,Mg(b)-4),E=1+(i?2:0)+(r?4:0),kg(t,4,E);let o=5;Tg(t,o,Math.floor(n.getTime()/1e3)),o+=4,i&&(Tg(t,o,Math.floor(i.getTime()/1e3)),o+=4),r&&Tg(t,o,Math.floor(r.getTime()/1e3));try{y=new Uint8Array(36);const e=Ng(y),t=Cg(n);_g(e,0,10),_g(e,2,32),_g(e,8,1),_g(e,10,24),Ig(e,12,t),Ig(e,20,Cg(i)||t),Ig(e,28,Cg(r)||t)}catch(e){y=new Uint8Array}}else y=b=new Uint8Array;let w=2048;u&&(w|=8);let C=0;m&&(C=8),l&&(x=x>45?x:45),v&&(w|=1,c||(x=x>51?x:51,C=99,m&&(g[9]=8)));const S=new Uint8Array(26),k=Ng(S);_g(k,0,x),_g(k,2,w),_g(k,4,C);const _=new Uint32Array(1),T=Ng(_);let I;I=n<Fm?Fm:n>Om?Om:n,_g(T,0,(I.getHours()<<6|I.getMinutes())<<5|I.getSeconds()/2),_g(T,2,(I.getFullYear()-1980<<4|I.getMonth()+1)<<5|I.getDate());const P=_[0];Tg(k,6,P),_g(k,22,Mg(t));const N=Mg(g,b,y,p);_g(k,24,N);const M=new Uint8Array(30+Mg(t)+N);return Tg(Ng(M),0,67324752),Pg(M,S,4),Pg(M,t,30),Pg(M,g,30+Mg(t)),Pg(M,b,30+Mg(t,g)),Pg(M,y,30+Mg(t,g,b)),Pg(M,p,30+Mg(t,g,b,y)),{localHeaderArray:M,headerArray:S,headerView:k,lastModDate:n,rawLastModDate:P,encrypted:v,compressed:m,version:x,compressionMethod:C,extraFieldExtendedTimestampFlag:E,rawExtraFieldExtendedTimestamp:b,rawExtraFieldNTFS:y,rawExtraFieldAES:g,extraFieldLength:N}}(i=Object.assign({},i,{rawFilename:r,rawComment:a,version:s,versionMadeBy:l,lastModDate:c,lastAccessDate:u,creationDate:d,rawExtraField:P,zip64:I,zip64UncompressedSize:F,zip64CompressedSize:z,zip64Offset:H,zip64DiskNumberStart:U,password:m,rawPassword:v,level:x,useWebWorkers:w,encryptionStrength:g,extendedTimestamp:b,zipCrypto:y,bufferedWrite:C,keepOrder:E,dataDescriptor:T,dataDescriptorSignature:S,signal:k,msDosCompatible:p,internalFileAttribute:h,externalFileAttribute:f,useCompressionStream:_})),V=function(e){const{zip64:t,dataDescriptor:n,dataDescriptorSignature:i}=e;let r,o=new Uint8Array,a=0;return n&&(o=new Uint8Array(t?i?24:20:i?16:12),r=Ng(o),i&&(a=4,Tg(r,0,134695760))),{dataDescriptorArray:o,dataDescriptorView:r,dataDescriptorOffset:a}}(i),j=Mg(W.localHeaderArray,V.dataDescriptorArray);let G;A=j+M,e.options.usdz&&(A+=A+64),e.pendingEntriesSize+=A;try{G=await async function(e,t,n,i,r){const{files:o,writer:a}=e,{keepOrder:s,dataDescriptor:l,signal:c}=r,{headerInfo:u}=i,{usdz:d}=e.options,p=Array.from(o.values()).pop();let h,f,m,v,g,y,b,E={};o.set(t,E);try{let u;s&&(u=p&&p.lock,E.lock=new Promise((e=>m=e))),!(r.bufferedWrite||e.writerLocked||e.bufferedWrites&&s)&&l||d?(y=a,await x()):(y=new TransformStream,b=new Response(y.readable).blob(),y.writable.size=0,h=!0,e.bufferedWrites++,await hg(a)),await hg(y);const{writable:f}=a;let{diskOffset:C}=a;if(e.addSplitZipSignature){delete e.addSplitZipSignature;const t=new Uint8Array(4);Tg(Ng(t),0,134695760),await wg(f,t),e.offset+=4}d&&function(e,t){const{headerInfo:n}=e;let{localHeaderArray:i,extraFieldLength:r}=n,o=Ng(i),a=64-(t+Mg(i))%64;a<4&&(a+=64);const s=new Uint8Array(a),l=Ng(s);_g(l,0,6534),_g(l,2,a-2);const c=i;n.localHeaderArray=i=new Uint8Array(Mg(c)+a),Pg(i,c),Pg(i,s,Mg(c)),o=Ng(i),_g(o,28,r+a),e.metadataSize+=a}(i,e.offset-C),h||(await u,await w(f));const{diskNumber:S}=a;if(g=!0,E.diskNumberStart=S,E=await async function(e,t,{diskNumberStart:n,lock:i},r,o,a){const{headerInfo:s,dataDescriptorInfo:l,metadataSize:c}=r,{localHeaderArray:u,headerArray:d,lastModDate:p,rawLastModDate:h,encrypted:f,compressed:m,version:v,compressionMethod:g,rawExtraFieldExtendedTimestamp:y,extraFieldExtendedTimestampFlag:b,rawExtraFieldNTFS:E,rawExtraFieldAES:x}=s,{dataDescriptorArray:w}=l,{rawFilename:C,lastAccessDate:S,creationDate:k,password:_,rawPassword:T,level:I,zip64:P,zip64UncompressedSize:N,zip64CompressedSize:M,zip64Offset:A,zip64DiskNumberStart:D,zipCrypto:R,dataDescriptor:B,directory:L,versionMadeBy:O,rawComment:F,rawExtraField:z,useWebWorkers:H,onstart:U,onprogress:W,onend:V,signal:j,encryptionStrength:G,extendedTimestamp:q,msDosCompatible:K,internalFileAttribute:Y,externalFileAttribute:X,useCompressionStream:Q}=a,Z={lock:i,versionMadeBy:O,zip64:P,directory:Boolean(L),filenameUTF8:!0,rawFilename:C,commentUTF8:!0,rawComment:F,rawExtraFieldExtendedTimestamp:y,rawExtraFieldNTFS:E,rawExtraFieldAES:x,rawExtraField:z,extendedTimestamp:q,msDosCompatible:K,internalFileAttribute:Y,externalFileAttribute:X,diskNumberStart:n};let J,$=0,ee=0;const{writable:te}=t;if(e){e.chunkSize=function(e){return Math.max(e.chunkSize,64)}(o),await wg(te,u);const t=e.readable,n={options:{codecType:"deflate",level:I,rawPassword:T,password:_,encryptionStrength:G,zipCrypto:f&&R,passwordVerification:f&&R&&h>>8&255,signed:!0,compressed:m,encrypted:f,useWebWorkers:H,useCompressionStream:Q,transferStreams:!1},config:o,streamOptions:{signal:j,size:t.size=e.size,onstart:U,onprogress:W,onend:V}},i=await async function(e,t){const{options:n,config:i}=t,{transferStreams:r,useWebWorkers:o,useCompressionStream:a,codecType:s,compressed:l,signed:c,encrypted:u}=n,{workerScripts:d,maxWorkers:p}=i;t.transferStreams=r||void 0===r;const h=!(l||c||u||t.transferStreams);return t.useWebWorkers=!h&&(o||void 0===o&&i.useWebWorkers),t.scripts=t.useWebWorkers&&d?d[s]:[],n.useCompressionStream=a||void 0===a&&i.useCompressionStream,(await async function(){const n=ng.find((e=>!e.busy));if(n)return og(n),new Yv(n,e,t,f);if(ng.length<p){const n={indexWorker:rg};return rg++,ng.push(n),new Yv(n,e,t,f)}return new Promise((n=>ig.push({resolve:n,stream:e,workerOptions:t})))}()).run();function f(e){if(ig.length){const[{resolve:t,stream:n,workerOptions:i}]=ig.splice(0,1);t(new Yv(e,n,i,f))}else e.worker?(og(e),function(e,t){const{config:n}=t,{terminateWorkerTimeout:i}=n;Number.isFinite(i)&&i>=0&&(e.terminated?e.terminated=!1:e.terminateTimeout=setTimeout((async()=>{ng=ng.filter((t=>t!=e));try{await e.terminate()}catch(e){}}),i))}(e,t)):ng=ng.filter((t=>t!=e))}}({readable:t,writable:te},n);ee=i.inputSize,$=i.outputSize,J=i.signature,te.size+=ee}else await wg(te,u);let ne;if(P){let e=4;N&&(e+=8),M&&(e+=8),A&&(e+=8),D&&(e+=4),ne=new Uint8Array(e)}else ne=new Uint8Array;return function(e,t){const{signature:n,rawExtraFieldZip64:i,compressedSize:r,uncompressedSize:o,headerInfo:a,dataDescriptorInfo:s}=e,{headerView:l,encrypted:c}=a,{dataDescriptorView:u,dataDescriptorOffset:d}=s,{zip64:p,zip64UncompressedSize:h,zip64CompressedSize:f,zipCrypto:m,dataDescriptor:v}=t;if(c&&!m||void 0===n||(Tg(l,10,n),v&&Tg(u,d,n)),p){const e=Ng(i);_g(e,0,1),_g(e,2,Mg(i)-4);let t=4;h&&(Tg(l,18,4294967295),Ig(e,t,BigInt(o)),t+=8),f&&(Tg(l,14,4294967295),Ig(e,t,BigInt(r))),v&&(Ig(u,d+4,BigInt(r)),Ig(u,d+12,BigInt(o)))}else Tg(l,14,r),Tg(l,18,o),v&&(Tg(u,d+4,r),Tg(u,d+8,o))}({signature:J,rawExtraFieldZip64:ne,compressedSize:$,uncompressedSize:ee,headerInfo:s,dataDescriptorInfo:l},a),B&&await wg(te,w),Object.assign(Z,{uncompressedSize:ee,compressedSize:$,lastModDate:p,rawLastModDate:h,creationDate:k,lastAccessDate:S,encrypted:f,size:c+$,compressionMethod:g,version:v,headerArray:d,signature:J,rawExtraFieldZip64:ne,extraFieldExtendedTimestampFlag:b,zip64UncompressedSize:N,zip64CompressedSize:M,zip64Offset:A,zip64DiskNumberStart:D}),Z}(n,y,E,i,e.config,r),g=!1,o.set(t,E),E.filename=t,h){await y.writable.getWriter().close();let e=await b;await u,await x(),v=!0,l||(e=await async function(e,t,n,{zipCrypto:i}){let r;r=await t.slice(0,26).arrayBuffer(),26!=r.byteLength&&(r=r.slice(0,26));const o=new DataView(r);return e.encrypted&&!i||Tg(o,14,e.signature),e.zip64?(Tg(o,18,4294967295),Tg(o,22,4294967295)):(Tg(o,18,e.compressedSize),Tg(o,22,e.uncompressedSize)),await wg(n,new Uint8Array(r)),t.slice(r.byteLength)}(E,e,f,r)),await w(f),E.diskNumberStart=a.diskNumber,C=a.diskOffset,await e.stream().pipeTo(f,{preventClose:!0,preventAbort:!0,signal:c}),f.size+=e.size,v=!1}if(E.offset=e.offset-C,E.zip64)!function(e,t){const{rawExtraFieldZip64:n,offset:i,diskNumberStart:r}=e,{zip64UncompressedSize:o,zip64CompressedSize:a,zip64Offset:s,zip64DiskNumberStart:l}=t,c=Ng(n);let u=4;o&&(u+=8),a&&(u+=8),s&&(Ig(c,u,BigInt(i)),u+=8),l&&Tg(c,u,r)}(E,r);else if(E.offset>=4294967295)throw new Error(gg);return e.offset+=E.size,E}catch(n){if(h&&v||!h&&g){if(e.hasCorruptedEntries=!0,n)try{n.corruptedEntry=!0}catch(e){}h?e.offset+=y.writable.size:e.offset=y.writable.size}throw o.delete(t),n}finally{h&&e.bufferedWrites--,m&&m(),f&&f()}async function x(){e.writerLocked=!0;const{lockWriter:t}=e;e.lockWriter=new Promise((t=>f=()=>{e.writerLocked=!1,t()})),await t}async function w(e){Mg(u.localHeaderArray)>a.availableSize&&(a.availableSize=0,await wg(e,new Uint8Array))}}(e,t,n,{headerInfo:W,dataDescriptorInfo:V,metadataSize:j},i)}finally{e.pendingEntriesSize-=A}return Object.assign(G,{name:t,comment:o,extraField:N}),new vg(G)}(i,e,t,n),r.add(a),await a}catch(t){throw i.filenames.delete(e),t}finally{r.delete(a);const e=Eg.shift();e?e():bg--}}async close(e=new Uint8Array,t={}){const{pendingAddFileCalls:n,writer:i}=this,{writable:r}=i;for(;n.size;)await Promise.allSettled(Array.from(n));return await async function(e,t,n){const{files:i,writer:r}=e,{diskOffset:o,writable:a}=r;let{diskNumber:s}=r,l=0,c=0,u=e.offset-o,d=i.size;for(const[,e]of i){const{rawFilename:t,rawExtraFieldZip64:n,rawExtraFieldAES:i,rawComment:r,rawExtraFieldNTFS:o,rawExtraField:a,extendedTimestamp:s,extraFieldExtendedTimestampFlag:l,lastModDate:u}=e;let d;if(s){d=new Uint8Array(9);const e=Ng(d);_g(e,0,21589),_g(e,2,5),kg(e,4,l),Tg(e,5,Math.floor(u.getTime()/1e3))}else d=new Uint8Array;e.rawExtraFieldCDExtendedTimestamp=d,c+=46+Mg(t,r,n,i,o,d,a)}const p=new Uint8Array(c),h=Ng(p);await hg(r);let f=0;for(const[t,o]of Array.from(i.values()).entries()){const{offset:s,rawFilename:c,rawExtraFieldZip64:u,rawExtraFieldAES:d,rawExtraFieldCDExtendedTimestamp:m,rawExtraFieldNTFS:v,rawExtraField:g,rawComment:y,versionMadeBy:b,headerArray:E,directory:x,zip64:w,zip64UncompressedSize:C,zip64CompressedSize:S,zip64DiskNumberStart:k,zip64Offset:_,msDosCompatible:T,internalFileAttribute:I,externalFileAttribute:P,diskNumberStart:N,uncompressedSize:M,compressedSize:A}=o,D=Mg(u,d,m,v,g);Tg(h,l,33639248),_g(h,l+4,b);const R=Ng(E);C||Tg(R,18,M),S||Tg(R,14,A),Pg(p,E,l+6),_g(h,l+30,D),_g(h,l+32,Mg(y)),_g(h,l+34,w&&k?65535:N),_g(h,l+36,I),P?Tg(h,l+38,P):x&&T&&kg(h,l+38,16),Tg(h,l+42,w&&_?4294967295:s),Pg(p,c,l+46),Pg(p,u,l+46+Mg(c)),Pg(p,d,l+46+Mg(c,u)),Pg(p,m,l+46+Mg(c,u,d)),Pg(p,v,l+46+Mg(c,u,d,m)),Pg(p,g,l+46+Mg(c,u,d,m,v)),Pg(p,y,l+46+Mg(c)+D);const B=46+Mg(c,y)+D;if(l-f>r.availableSize&&(r.availableSize=0,await wg(a,p.slice(f,l)),f=l),l+=B,n.onprogress)try{await n.onprogress(t+1,i.size,new vg(o))}catch(e){}}await wg(a,f?p.slice(f):p);let m=r.diskNumber;const{availableSize:v}=r;v<22&&m++;let g=Sg(e,n,"zip64");if(u>=4294967295||c>=4294967295||d>=65535||m>=65535){if(!1===g)throw new Error(gg);g=!0}const y=new Uint8Array(g?98:22),b=Ng(y);l=0,g&&(Tg(b,0,101075792),Ig(b,4,BigInt(44)),_g(b,12,45),_g(b,14,45),Tg(b,16,m),Tg(b,20,s),Ig(b,24,BigInt(d)),Ig(b,32,BigInt(d)),Ig(b,40,BigInt(c)),Ig(b,48,BigInt(u)),Tg(b,56,117853008),Ig(b,64,BigInt(u)+BigInt(c)),Tg(b,72,m+1),Sg(e,n,"supportZip64SplitFile",!0)&&(m=65535,s=65535),d=65535,u=4294967295,c=4294967295,l+=76),Tg(b,l,101010256),_g(b,l+4,m),_g(b,l+6,s),_g(b,l+8,d),_g(b,l+10,d),Tg(b,l+12,c),Tg(b,l+16,u);const E=Mg(t);if(E){if(!(E<=65535))throw new Error("Zip file comment exceeds 64KB");_g(b,l+20,E)}await wg(a,y),E&&await wg(a,t)}(this,e,t),Sg(this,t,"preventClose")||await r.getWriter().close(),i.getData?i.getData():r}}async function wg(e,t){const n=e.getWriter();try{await n.ready,e.size+=Mg(t),await n.write(t)}finally{n.releaseLock()}}function Cg(e){if(e)return(BigInt(e.getTime())+BigInt(116444736e5))*BigInt(1e4)}function Sg(e,t,n,i){const r=void 0===t[n]?e.options[n]:t[n];return void 0===r?i:r}function kg(e,t,n){e.setUint8(t,n)}function _g(e,t,n){e.setUint16(t,n,!0)}function Tg(e,t,n){e.setUint32(t,n,!0)}function Ig(e,t,n){e.setBigUint64(t,n,!0)}function Pg(e,t,n){e.set(t,n)}function Ng(e){return new DataView(e.buffer)}function Mg(...e){let t=0;return e.forEach((e=>e&&(t+=e.length))),t}let Ag;try{Ag="undefined"==typeof document?require("url").pathToFileURL(__filename).href:i&&i.src||new URL("index-d9a8b77f.js",document.baseURI).href}catch(e){}Vm({baseURL:Ag}),function(e){const t=()=>URL.createObjectURL(new Blob(['const{Array:e,Object:t,Number:n,Math:r,Error:s,Uint8Array:i,Uint16Array:o,Uint32Array:c,Int32Array:f,Map:a,DataView:l,Promise:u,TextEncoder:w,crypto:h,postMessage:d,TransformStream:p,ReadableStream:y,WritableStream:m,CompressionStream:b,DecompressionStream:g}=self,k=void 0,v="undefined",S="function";class z{constructor(e){return class extends p{constructor(t,n){const r=new e(n);super({transform(e,t){t.enqueue(r.append(e))},flush(e){const t=r.flush();t&&e.enqueue(t)}})}}}}const C=[];for(let e=0;256>e;e++){let t=e;for(let e=0;8>e;e++)1&t?t=t>>>1^3988292384:t>>>=1;C[e]=t}class x{constructor(e){this.t=e||-1}append(e){let t=0|this.t;for(let n=0,r=0|e.length;r>n;n++)t=t>>>8^C[255&(t^e[n])];this.t=t}get(){return~this.t}}class A extends p{constructor(){let e;const t=new x;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new i(4);new l(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}const _={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],r=_.i(n);return 32===r?e.concat(t):_.o(t,r,0|n,e.slice(0,e.length-1))},l(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+_.i(n)},u(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,r.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=_.h(t,e[n-1]&2147483648>>t-1,1)),e},h:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,i:e=>r.round(e/1099511627776)||32,o(e,t,n,r){for(void 0===r&&(r=[]);t>=32;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(let s=0;s<e.length;s++)r.push(n|e[s]>>>t),n=e[s]<<32-t;const s=e.length?e[e.length-1]:0,i=_.i(s);return r.push(_.h(t+i&31,t+i>32?n:r.pop(),1)),r}},I={p:{m(e){const t=_.l(e)/8,n=new i(t);let r;for(let s=0;t>s;s++)0==(3&s)&&(r=e[s/4]),n[s]=r>>>24,r<<=8;return n},g(e){const t=[];let n,r=0;for(n=0;n<e.length;n++)r=r<<8|e[n],3==(3&n)&&(t.push(r),r=0);return 3&n&&t.push(_.h(8*(3&n),r)),t}}},P=class{constructor(e){const t=this;t.blockSize=512,t.k=[1732584193,4023233417,2562383102,271733878,3285377520],t.v=[1518500249,1859775393,2400959708,3395469782],e?(t.S=e.S.slice(0),t.C=e.C.slice(0),t.A=e.A):t.reset()}reset(){const e=this;return e.S=e.k.slice(0),e.C=[],e.A=0,e}update(e){const t=this;"string"==typeof e&&(e=I._.g(e));const n=t.C=_.concat(t.C,e),r=t.A,i=t.A=r+_.l(e);if(i>9007199254740991)throw new s("Cannot hash more than 2^53 - 1 bits");const o=new c(n);let f=0;for(let e=t.blockSize+r-(t.blockSize+r&t.blockSize-1);i>=e;e+=t.blockSize)t.I(o.subarray(16*f,16*(f+1))),f+=1;return n.splice(0,16*f),t}P(){const e=this;let t=e.C;const n=e.S;t=_.concat(t,[_.h(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(r.floor(e.A/4294967296)),t.push(0|e.A);t.length;)e.I(t.splice(0,16));return e.reset(),n}D(e,t,n,r){return e>19?e>39?e>59?e>79?void 0:t^n^r:t&n|t&r|n&r:t^n^r:t&n|~t&r}V(e,t){return t<<e|t>>>32-e}I(t){const n=this,s=n.S,i=e(80);for(let e=0;16>e;e++)i[e]=t[e];let o=s[0],c=s[1],f=s[2],a=s[3],l=s[4];for(let e=0;79>=e;e++){16>e||(i[e]=n.V(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const t=n.V(5,o)+n.D(e,c,f,a)+l+i[e]+n.v[r.floor(e/20)]|0;l=a,a=f,f=n.V(30,c),c=o,o=t}s[0]=s[0]+o|0,s[1]=s[1]+c|0,s[2]=s[2]+f|0,s[3]=s[3]+a|0,s[4]=s[4]+l|0}},D={getRandomValues(e){const t=new c(e.buffer),n=e=>{let t=987654321;const n=4294967295;return()=>(t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(r.random()>.5?1:-1))};for(let s,i=0;i<e.length;i+=4){const e=n(4294967296*(s||r.random()));s=987654071*e(),t[i/4]=4294967296*e()|0}return e}},V={importKey:e=>new V.R(I.p.g(e)),B(e,t,n,r){if(n=n||1e4,0>r||0>n)throw new s("invalid params to pbkdf2");const i=1+(r>>5)<<2;let o,c,f,a,u;const w=new ArrayBuffer(i),h=new l(w);let d=0;const p=_;for(t=I.p.g(t),u=1;(i||1)>d;u++){for(o=c=e.encrypt(p.concat(t,[u])),f=1;n>f;f++)for(c=e.encrypt(c),a=0;a<c.length;a++)o[a]^=c[a];for(f=0;(i||1)>d&&f<o.length;f++)h.setInt32(d,o[f]),d+=4}return w.slice(0,r/8)},R:class{constructor(e){const t=this,n=t.M=P,r=[[],[]];t.U=[new n,new n];const s=t.U[0].blockSize/32;e.length>s&&(e=(new n).update(e).P());for(let t=0;s>t;t++)r[0][t]=909522486^e[t],r[1][t]=1549556828^e[t];t.U[0].update(r[0]),t.U[1].update(r[1]),t.K=new n(t.U[0])}reset(){const e=this;e.K=new e.M(e.U[0]),e.N=!1}update(e){this.N=!0,this.K.update(e)}digest(){const e=this,t=e.K.P(),n=new e.M(e.U[1]).update(t).P();return e.reset(),n}encrypt(e){if(this.N)throw new s("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},R=typeof h!=v&&typeof h.getRandomValues==S,B="Invalid password",E="Invalid signature",M="zipjs-abort-check-password";function U(e){return R?h.getRandomValues(e):D.getRandomValues(e)}const K=16,N={name:"PBKDF2"},O=t.assign({hash:{name:"HMAC"}},N),T=t.assign({iterations:1e3,hash:{name:"SHA-1"}},N),W=["deriveBits"],j=[8,12,16],H=[16,24,32],L=10,F=[0,0,0,0],q=typeof h!=v,G=q&&h.subtle,J=q&&typeof G!=v,Q=I.p,X=class{constructor(e){const t=this;t.O=[[[],[],[],[],[]],[[],[],[],[],[]]],t.O[0][0][0]||t.T();const n=t.O[0][4],r=t.O[1],i=e.length;let o,c,f,a=1;if(4!==i&&6!==i&&8!==i)throw new s("invalid aes key size");for(t.v=[c=e.slice(0),f=[]],o=i;4*i+28>o;o++){let e=c[o-1];(o%i==0||8===i&&o%i==4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],o%i==0&&(e=e<<8^e>>>24^a<<24,a=a<<1^283*(a>>7))),c[o]=c[o-i]^e}for(let e=0;o;e++,o--){const t=c[3&e?o:o-4];f[e]=4>=o||4>e?t:r[0][n[t>>>24]]^r[1][n[t>>16&255]]^r[2][n[t>>8&255]]^r[3][n[255&t]]}}encrypt(e){return this.W(e,0)}decrypt(e){return this.W(e,1)}T(){const e=this.O[0],t=this.O[1],n=e[4],r=t[4],s=[],i=[];let o,c,f,a;for(let e=0;256>e;e++)i[(s[e]=e<<1^283*(e>>7))^e]=e;for(let l=o=0;!n[l];l^=c||1,o=i[o]||1){let i=o^o<<1^o<<2^o<<3^o<<4;i=i>>8^255&i^99,n[l]=i,r[i]=l,a=s[f=s[c=s[l]]];let u=16843009*a^65537*f^257*c^16843008*l,w=257*s[i]^16843008*i;for(let n=0;4>n;n++)e[n][l]=w=w<<24^w>>>8,t[n][i]=u=u<<24^u>>>8}for(let n=0;5>n;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}W(e,t){if(4!==e.length)throw new s("invalid aes block size");const n=this.v[t],r=n.length/4-2,i=[0,0,0,0],o=this.O[t],c=o[0],f=o[1],a=o[2],l=o[3],u=o[4];let w,h,d,p=e[0]^n[0],y=e[t?3:1]^n[1],m=e[2]^n[2],b=e[t?1:3]^n[3],g=4;for(let e=0;r>e;e++)w=c[p>>>24]^f[y>>16&255]^a[m>>8&255]^l[255&b]^n[g],h=c[y>>>24]^f[m>>16&255]^a[b>>8&255]^l[255&p]^n[g+1],d=c[m>>>24]^f[b>>16&255]^a[p>>8&255]^l[255&y]^n[g+2],b=c[b>>>24]^f[p>>16&255]^a[y>>8&255]^l[255&m]^n[g+3],g+=4,p=w,y=h,m=d;for(let e=0;4>e;e++)i[t?3&-e:e]=u[p>>>24]<<24^u[y>>16&255]<<16^u[m>>8&255]<<8^u[255&b]^n[g++],w=p,p=y,y=m,m=b,b=w;return i}},Y=class{constructor(e,t){this.j=e,this.H=t,this.L=t}reset(){this.L=this.H}update(e){return this.F(this.j,e,this.L)}q(e){if(255==(e>>24&255)){let t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}G(e){0===(e[0]=this.q(e[0]))&&(e[1]=this.q(e[1]))}F(e,t,n){let r;if(!(r=t.length))return[];const s=_.l(t);for(let s=0;r>s;s+=4){this.G(n);const r=e.encrypt(n);t[s]^=r[0],t[s+1]^=r[1],t[s+2]^=r[2],t[s+3]^=r[3]}return _.u(t,s)}},Z=V.R;let $=q&&J&&typeof G.importKey==S,ee=q&&J&&typeof G.deriveBits==S;class te extends p{constructor({password:e,rawPassword:n,signed:r,encryptionStrength:o,checkPasswordOnly:c}){super({start(){t.assign(this,{ready:new u((e=>this.J=e)),password:ie(e,n),signed:r,X:o-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:o,J:f,ready:a}=n;r?(await(async(e,t,n,r)=>{const i=await se(e,t,n,ce(r,0,j[t])),o=ce(r,j[t]);if(i[0]!=o[0]||i[1]!=o[1])throw new s(B)})(n,o,r,ce(e,0,j[o]+2)),e=ce(e,j[o]+2),c?t.error(new s(M)):f()):await a;const l=new i(e.length-L-(e.length-L)%K);t.enqueue(re(n,e,l,0,L,!0))},async flush(e){const{signed:t,Y:n,Z:r,pending:o,ready:c}=this;if(r&&n){await c;const f=ce(o,0,o.length-L),a=ce(o,o.length-L);let l=new i;if(f.length){const e=ae(Q,f);r.update(e);const t=n.update(e);l=fe(Q,t)}if(t){const e=ce(fe(Q,r.digest()),0,L);for(let t=0;L>t;t++)if(e[t]!=a[t])throw new s(E)}e.enqueue(l)}}})}}class ne extends p{constructor({password:e,rawPassword:n,encryptionStrength:r}){let s;super({start(){t.assign(this,{ready:new u((e=>this.J=e)),password:ie(e,n),X:r-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:s,J:o,ready:c}=n;let f=new i;r?(f=await(async(e,t,n)=>{const r=U(new i(j[t]));return oe(r,await se(e,t,n,r))})(n,s,r),o()):await c;const a=new i(f.length+e.length-e.length%K);a.set(f,0),t.enqueue(re(n,e,a,f.length,0))},async flush(e){const{Y:t,Z:n,pending:r,ready:o}=this;if(n&&t){await o;let c=new i;if(r.length){const e=t.update(ae(Q,r));n.update(e),c=fe(Q,e)}s.signature=fe(Q,n.digest()).slice(0,L),e.enqueue(oe(c,s.signature))}}}),s=this}}function re(e,t,n,r,s,o){const{Y:c,Z:f,pending:a}=e,l=t.length-s;let u;for(a.length&&(t=oe(a,t),n=((e,t)=>{if(t&&t>e.length){const n=e;(e=new i(t)).set(n,0)}return e})(n,l-l%K)),u=0;l-K>=u;u+=K){const e=ae(Q,ce(t,u,u+K));o&&f.update(e);const s=c.update(e);o||f.update(s),n.set(fe(Q,s),u+r)}return e.pending=ce(t,u),n}async function se(n,r,s,o){n.password=null;const c=await(async(e,t,n,r,s)=>{if(!$)return V.importKey(t);try{return await G.importKey("raw",t,n,!1,s)}catch(e){return $=!1,V.importKey(t)}})(0,s,O,0,W),f=await(async(e,t,n)=>{if(!ee)return V.B(t,e.salt,T.iterations,n);try{return await G.deriveBits(e,t,n)}catch(r){return ee=!1,V.B(t,e.salt,T.iterations,n)}})(t.assign({salt:o},T),c,8*(2*H[r]+2)),a=new i(f),l=ae(Q,ce(a,0,H[r])),u=ae(Q,ce(a,H[r],2*H[r])),w=ce(a,2*H[r]);return t.assign(n,{keys:{key:l,$:u,passwordVerification:w},Y:new Y(new X(l),e.from(F)),Z:new Z(u)}),w}function ie(e,t){return t===k?(e=>{if(typeof w==v){const t=new i((e=unescape(encodeURIComponent(e))).length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new w).encode(e)})(e):t}function oe(e,t){let n=e;return e.length+t.length&&(n=new i(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function ce(e,t,n){return e.subarray(t,n)}function fe(e,t){return e.m(t)}function ae(e,t){return e.g(t)}class le extends p{constructor({password:e,passwordVerification:n,checkPasswordOnly:r}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;if(n.password){const t=we(n,e.subarray(0,12));if(n.password=null,t[11]!=n.passwordVerification)throw new s(B);e=e.subarray(12)}r?t.error(new s(M)):t.enqueue(we(n,e))}})}}class ue extends p{constructor({password:e,passwordVerification:n}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;let r,s;if(n.password){n.password=null;const t=U(new i(12));t[11]=n.passwordVerification,r=new i(e.length+t.length),r.set(he(n,t),0),s=12}else r=new i(e.length),s=0;r.set(he(n,e),s),t.enqueue(r)}})}}function we(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,n[r]);return n}function he(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,t[r]);return n}function de(e,n){const r=[305419896,591751049,878082192];t.assign(e,{keys:r,ee:new x(r[0]),te:new x(r[2])});for(let t=0;t<n.length;t++)pe(e,n.charCodeAt(t))}function pe(e,t){let[n,s,i]=e.keys;e.ee.append([t]),n=~e.ee.get(),s=be(r.imul(be(s+me(n)),134775813)+1),e.te.append([s>>>24]),i=~e.te.get(),e.keys=[n,s,i]}function ye(e){const t=2|e.keys[2];return me(r.imul(t,1^t)>>>8)}function me(e){return 255&e}function be(e){return 4294967295&e}const ge="deflate-raw";class ke extends p{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:r}){super({});const{compressed:s,encrypted:i,useCompressionStream:o,zipCrypto:c,signed:f,level:a}=e,u=this;let w,h,d=Se(super.readable);i&&!c||!f||(w=new A,d=xe(d,w)),s&&(d=Ce(d,o,{level:a,chunkSize:t},r,n)),i&&(c?d=xe(d,new ue(e)):(h=new ne(e),d=xe(d,h))),ze(u,d,(()=>{let e;i&&!c&&(e=h.signature),i&&!c||!f||(e=new l(w.value.buffer).getUint32(0)),u.signature=e}))}}class ve extends p{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:r}){super({});const{zipCrypto:i,encrypted:o,signed:c,signature:f,compressed:a,useCompressionStream:u}=e;let w,h,d=Se(super.readable);o&&(i?d=xe(d,new le(e)):(h=new te(e),d=xe(d,h))),a&&(d=Ce(d,u,{chunkSize:t},r,n)),o&&!i||!c||(w=new A,d=xe(d,w)),ze(this,d,(()=>{if((!o||i)&&c){const e=new l(w.value.buffer);if(f!=e.getUint32(0,!1))throw new s(E)}}))}}function Se(e){return xe(e,new p({transform(e,t){e&&e.length&&t.enqueue(e)}}))}function ze(e,n,r){n=xe(n,new p({flush:r})),t.defineProperty(e,"readable",{get:()=>n})}function Ce(e,t,n,r,s){try{e=xe(e,new(t&&r?r:s)(ge,n))}catch(r){if(!t)return e;try{e=xe(e,new s(ge,n))}catch(t){return e}}return e}function xe(e,t){return e.pipeThrough(t)}const Ae="data",_e="close";class Ie extends p{constructor(e,n){super({});const r=this,{codecType:s}=e;let i;s.startsWith("deflate")?i=ke:s.startsWith("inflate")&&(i=ve);let o=0,c=0;const f=new i(e,n),a=super.readable,l=new p({transform(e,t){e&&e.length&&(c+=e.length,t.enqueue(e))},flush(){t.assign(r,{inputSize:c})}}),u=new p({transform(e,t){e&&e.length&&(o+=e.length,t.enqueue(e))},flush(){const{signature:e}=f;t.assign(r,{signature:e,outputSize:o,inputSize:c})}});t.defineProperty(r,"readable",{get:()=>a.pipeThrough(l).pipeThrough(f).pipeThrough(u)})}}class Pe extends p{constructor(e){let t;super({transform:function n(r,s){if(t){const e=new i(t.length+r.length);e.set(t),e.set(r,t.length),r=e,t=null}r.length>e?(s.enqueue(r.slice(0,e)),n(r.slice(e),s)):t=r},flush(e){t&&t.length&&e.enqueue(t)}})}}const De=new a,Ve=new a;let Re,Be=0,Ee=!0;async function Me(e){try{const{options:t,scripts:r,config:s}=e;if(r&&r.length)try{Ee?importScripts.apply(k,r):await Ue(r)}catch(e){Ee=!1,await Ue(r)}self.initCodec&&self.initCodec(),s.CompressionStreamNative=self.CompressionStream,s.DecompressionStreamNative=self.DecompressionStream,self.Deflate&&(s.CompressionStream=new z(self.Deflate)),self.Inflate&&(s.DecompressionStream=new z(self.Inflate));const i={highWaterMark:1},o=e.readable||new y({async pull(e){const t=new u((e=>De.set(Be,e)));Ke({type:"pull",messageId:Be}),Be=(Be+1)%n.MAX_SAFE_INTEGER;const{value:r,done:s}=await t;e.enqueue(r),s&&e.close()}},i),c=e.writable||new m({async write(e){let t;const r=new u((e=>t=e));Ve.set(Be,t),Ke({type:Ae,value:e,messageId:Be}),Be=(Be+1)%n.MAX_SAFE_INTEGER,await r}},i),f=new Ie(t,s);Re=new AbortController;const{signal:a}=Re;await o.pipeThrough(f).pipeThrough(new Pe(s.chunkSize)).pipeTo(c,{signal:a,preventClose:!0,preventAbort:!0});try{await c.getWriter().close()}catch(e){}const{signature:l,inputSize:w,outputSize:h}=f;Ke({type:_e,result:{signature:l,inputSize:w,outputSize:h}})}catch(e){Ne(e)}}async function Ue(e){for(const t of e)await import(t)}function Ke(e){let{value:t}=e;if(t)if(t.length)try{t=new i(t),e.value=t.buffer,d(e,[e.value])}catch(t){d(e)}else d(e);else d(e)}function Ne(e=new s("Unknown error")){const{message:t,stack:n,code:r,name:i}=e;d({error:{message:t,stack:n,code:r,name:i}})}addEventListener("message",(({data:e})=>{const{type:t,messageId:n,value:r,done:s}=e;try{if("start"==t&&Me(e),t==Ae){const e=De.get(n);De.delete(n),e({value:new i(r),done:s})}if("ack"==t){const e=Ve.get(n);Ve.delete(n),e()}t==_e&&Re.abort()}catch(e){Ne(e)}}));const Oe=-2;function Te(t){return We(t.map((([t,n])=>new e(t).fill(n,0,t))))}function We(t){return t.reduce(((t,n)=>t.concat(e.isArray(n)?We(n):n)),[])}const je=[0,1,2,3].concat(...Te([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function He(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.ne=n=>{const s=e.re,i=e.ie.se,o=e.ie.oe;let c,f,a,l=-1;for(n.ce=0,n.fe=573,c=0;o>c;c++)0!==s[2*c]?(n.ae[++n.ce]=l=c,n.le[c]=0):s[2*c+1]=0;for(;2>n.ce;)a=n.ae[++n.ce]=2>l?++l:0,s[2*a]=1,n.le[a]=0,n.ue--,i&&(n.we-=i[2*a+1]);for(e.he=l,c=r.floor(n.ce/2);c>=1;c--)n.de(s,c);a=o;do{c=n.ae[1],n.ae[1]=n.ae[n.ce--],n.de(s,1),f=n.ae[1],n.ae[--n.fe]=c,n.ae[--n.fe]=f,s[2*a]=s[2*c]+s[2*f],n.le[a]=r.max(n.le[c],n.le[f])+1,s[2*c+1]=s[2*f+1]=a,n.ae[1]=a++,n.de(s,1)}while(n.ce>=2);n.ae[--n.fe]=n.ae[1],(t=>{const n=e.re,r=e.ie.se,s=e.ie.pe,i=e.ie.ye,o=e.ie.me;let c,f,a,l,u,w,h=0;for(l=0;15>=l;l++)t.be[l]=0;for(n[2*t.ae[t.fe]+1]=0,c=t.fe+1;573>c;c++)f=t.ae[c],l=n[2*n[2*f+1]+1]+1,l>o&&(l=o,h++),n[2*f+1]=l,f>e.he||(t.be[l]++,u=0,i>f||(u=s[f-i]),w=n[2*f],t.ue+=w*(l+u),r&&(t.we+=w*(r[2*f+1]+u)));if(0!==h){do{for(l=o-1;0===t.be[l];)l--;t.be[l]--,t.be[l+1]+=2,t.be[o]--,h-=2}while(h>0);for(l=o;0!==l;l--)for(f=t.be[l];0!==f;)a=t.ae[--c],a>e.he||(n[2*a+1]!=l&&(t.ue+=(l-n[2*a+1])*n[2*a],n[2*a+1]=l),f--)}})(n),((e,n,r)=>{const s=[];let i,o,c,f=0;for(i=1;15>=i;i++)s[i]=f=f+r[i-1]<<1;for(o=0;n>=o;o++)c=e[2*o+1],0!==c&&(e[2*o]=t(s[c]++,c))})(s,e.he,n.be)}}function Le(e,t,n,r,s){const i=this;i.se=e,i.pe=t,i.ye=n,i.oe=r,i.me=s}He.ge=[0,1,2,3,4,5,6,7].concat(...Te([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),He.ke=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],He.ve=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],He.Se=e=>256>e?je[e]:je[256+(e>>>7)],He.ze=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],He.Ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],He.xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],He.Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const Fe=Te([[144,8],[112,9],[24,7],[8,8]]);Le._e=We([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map(((e,t)=>[e,Fe[t]])));const qe=Te([[30,5]]);function Ge(e,t,n,r,s){const i=this;i.Ie=e,i.Pe=t,i.De=n,i.Ve=r,i.Re=s}Le.Be=We([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map(((e,t)=>[e,qe[t]]))),Le.Ee=new Le(Le._e,He.ze,257,286,15),Le.Me=new Le(Le.Be,He.Ce,0,30,15),Le.Ue=new Le(null,He.xe,0,19,7);const Je=[new Ge(0,0,0,0,0),new Ge(4,4,8,4,1),new Ge(4,5,16,8,1),new Ge(4,6,32,32,1),new Ge(4,4,16,16,2),new Ge(8,16,32,32,2),new Ge(8,16,128,128,2),new Ge(8,32,128,256,2),new Ge(32,128,258,1024,2),new Ge(32,258,258,4096,2)],Qe=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Xe=113,Ye=666,Ze=262;function $e(e,t,n,r){const s=e[2*t],i=e[2*n];return i>s||s==i&&r[t]<=r[n]}function et(){const e=this;let t,n,s,c,f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z,C,x,A,_,I,P,D,V,R,B,E,M,U;const K=new He,N=new He,O=new He;let T,W,j,H,L,F;function q(){let t;for(t=0;286>t;t++)E[2*t]=0;for(t=0;30>t;t++)M[2*t]=0;for(t=0;19>t;t++)U[2*t]=0;E[512]=1,e.ue=e.we=0,W=j=0}function G(e,t){let n,r=-1,s=e[1],i=0,o=7,c=4;0===s&&(o=138,c=3),e[2*(t+1)+1]=65535;for(let f=0;t>=f;f++)n=s,s=e[2*(f+1)+1],++i<o&&n==s||(c>i?U[2*n]+=i:0!==n?(n!=r&&U[2*n]++,U[32]++):i>10?U[36]++:U[34]++,i=0,r=n,0===s?(o=138,c=3):n==s?(o=6,c=3):(o=7,c=4))}function J(t){e.Ke[e.pending++]=t}function Q(e){J(255&e),J(e>>>8&255)}function X(e,t){let n;const r=t;F>16-r?(n=e,L|=n<<F&65535,Q(L),L=n>>>16-F,F+=r-16):(L|=e<<F&65535,F+=r)}function Y(e,t){const n=2*e;X(65535&t[n],65535&t[n+1])}function Z(e,t){let n,r,s=-1,i=e[1],o=0,c=7,f=4;for(0===i&&(c=138,f=3),n=0;t>=n;n++)if(r=i,i=e[2*(n+1)+1],++o>=c||r!=i){if(f>o)do{Y(r,U)}while(0!=--o);else 0!==r?(r!=s&&(Y(r,U),o--),Y(16,U),X(o-3,2)):o>10?(Y(18,U),X(o-11,7)):(Y(17,U),X(o-3,3));o=0,s=r,0===i?(c=138,f=3):r==i?(c=6,f=3):(c=7,f=4)}}function $(){16==F?(Q(L),L=0,F=0):8>F||(J(255&L),L>>>=8,F-=8)}function ee(t,n){let s,i,o;if(e.Ne[W]=t,e.Oe[W]=255&n,W++,0===t?E[2*n]++:(j++,t--,E[2*(He.ge[n]+256+1)]++,M[2*He.Se(t)]++),0==(8191&W)&&D>2){for(s=8*W,i=C-k,o=0;30>o;o++)s+=M[2*o]*(5+He.Ce[o]);if(s>>>=3,j<r.floor(W/2)&&s<r.floor(i/2))return!0}return W==T-1}function te(t,n){let r,s,i,o,c=0;if(0!==W)do{r=e.Ne[c],s=e.Oe[c],c++,0===r?Y(s,t):(i=He.ge[s],Y(i+256+1,t),o=He.ze[i],0!==o&&(s-=He.ke[i],X(s,o)),r--,i=He.Se(r),Y(i,n),o=He.Ce[i],0!==o&&(r-=He.ve[i],X(r,o)))}while(W>c);Y(256,t),H=t[513]}function ne(){F>8?Q(L):F>0&&J(255&L),L=0,F=0}function re(t,n,r){X(0+(r?1:0),3),((t,n)=>{ne(),H=8,Q(n),Q(~n),e.Ke.set(u.subarray(t,t+n),e.pending),e.pending+=n})(t,n)}function se(n){((t,n,r)=>{let s,i,o=0;D>0?(K.ne(e),N.ne(e),o=(()=>{let t;for(G(E,K.he),G(M,N.he),O.ne(e),t=18;t>=3&&0===U[2*He.Ae[t]+1];t--);return e.ue+=14+3*(t+1),t})(),s=e.ue+3+7>>>3,i=e.we+3+7>>>3,i>s||(s=i)):s=i=n+5,n+4>s||-1==t?i==s?(X(2+(r?1:0),3),te(Le._e,Le.Be)):(X(4+(r?1:0),3),((e,t,n)=>{let r;for(X(e-257,5),X(t-1,5),X(n-4,4),r=0;n>r;r++)X(U[2*He.Ae[r]+1],3);Z(E,e-1),Z(M,t-1)})(K.he+1,N.he+1,o+1),te(E,M)):re(t,n,r),q(),r&&ne()})(0>k?-1:k,C-k,n),k=C,t.Te()}function ie(){let e,n,r,s;do{if(s=w-A-C,0===s&&0===C&&0===A)s=f;else if(-1==s)s--;else if(C>=f+f-Ze){u.set(u.subarray(f,f+f),0),x-=f,C-=f,k-=f,e=y,r=e;do{n=65535&d[--r],d[r]=f>n?0:n-f}while(0!=--e);e=f,r=e;do{n=65535&h[--r],h[r]=f>n?0:n-f}while(0!=--e);s+=f}if(0===t.We)return;e=t.je(u,C+A,s),A+=e,3>A||(p=255&u[C],p=(p<<g^255&u[C+1])&b)}while(Ze>A&&0!==t.We)}function oe(e){let t,n,r=I,s=C,i=_;const o=C>f-Ze?C-(f-Ze):0;let c=B;const a=l,w=C+258;let d=u[s+i-1],p=u[s+i];R>_||(r>>=2),c>A&&(c=A);do{if(t=e,u[t+i]==p&&u[t+i-1]==d&&u[t]==u[s]&&u[++t]==u[s+1]){s+=2,t++;do{}while(u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&w>s);if(n=258-(w-s),s=w-258,n>i){if(x=e,i=n,n>=c)break;d=u[s+i-1],p=u[s+i]}}}while((e=65535&h[e&a])>o&&0!=--r);return i>A?A:i}e.le=[],e.be=[],e.ae=[],E=[],M=[],U=[],e.de=(t,n)=>{const r=e.ae,s=r[n];let i=n<<1;for(;i<=e.ce&&(i<e.ce&&$e(t,r[i+1],r[i],e.le)&&i++,!$e(t,s,r[i],e.le));)r[n]=r[i],n=i,i<<=1;r[n]=s},e.He=(t,S,x,W,j,G)=>(W||(W=8),j||(j=8),G||(G=0),t.Le=null,-1==S&&(S=6),1>j||j>9||8!=W||9>x||x>15||0>S||S>9||0>G||G>2?Oe:(t.Fe=e,a=x,f=1<<a,l=f-1,m=j+7,y=1<<m,b=y-1,g=r.floor((m+3-1)/3),u=new i(2*f),h=[],d=[],T=1<<j+6,e.Ke=new i(4*T),s=4*T,e.Ne=new o(T),e.Oe=new i(T),D=S,V=G,(t=>(t.qe=t.Ge=0,t.Le=null,e.pending=0,e.Je=0,n=Xe,c=0,K.re=E,K.ie=Le.Ee,N.re=M,N.ie=Le.Me,O.re=U,O.ie=Le.Ue,L=0,F=0,H=8,q(),(()=>{w=2*f,d[y-1]=0;for(let e=0;y-1>e;e++)d[e]=0;P=Je[D].Pe,R=Je[D].Ie,B=Je[D].De,I=Je[D].Ve,C=0,k=0,A=0,v=_=2,z=0,p=0})(),0))(t))),e.Qe=()=>42!=n&&n!=Xe&&n!=Ye?Oe:(e.Oe=null,e.Ne=null,e.Ke=null,d=null,h=null,u=null,e.Fe=null,n==Xe?-3:0),e.Xe=(e,t,n)=>{let r=0;return-1==t&&(t=6),0>t||t>9||0>n||n>2?Oe:(Je[D].Re!=Je[t].Re&&0!==e.qe&&(r=e.Ye(1)),D!=t&&(D=t,P=Je[D].Pe,R=Je[D].Ie,B=Je[D].De,I=Je[D].Ve),V=n,r)},e.Ze=(e,t,r)=>{let s,i=r,o=0;if(!t||42!=n)return Oe;if(3>i)return 0;for(i>f-Ze&&(i=f-Ze,o=r-i),u.set(t.subarray(o,o+i),0),C=i,k=i,p=255&u[0],p=(p<<g^255&u[1])&b,s=0;i-3>=s;s++)p=(p<<g^255&u[s+2])&b,h[s&l]=d[p],d[p]=s;return 0},e.Ye=(r,i)=>{let o,w,m,I,R;if(i>4||0>i)return Oe;if(!r.$e||!r.et&&0!==r.We||n==Ye&&4!=i)return r.Le=Qe[4],Oe;if(0===r.tt)return r.Le=Qe[7],-5;var B;if(t=r,I=c,c=i,42==n&&(w=8+(a-8<<4)<<8,m=(D-1&255)>>1,m>3&&(m=3),w|=m<<6,0!==C&&(w|=32),w+=31-w%31,n=Xe,J((B=w)>>8&255),J(255&B)),0!==e.pending){if(t.Te(),0===t.tt)return c=-1,0}else if(0===t.We&&I>=i&&4!=i)return t.Le=Qe[7],-5;if(n==Ye&&0!==t.We)return r.Le=Qe[7],-5;if(0!==t.We||0!==A||0!=i&&n!=Ye){switch(R=-1,Je[D].Re){case 0:R=(e=>{let n,r=65535;for(r>s-5&&(r=s-5);;){if(1>=A){if(ie(),0===A&&0==e)return 0;if(0===A)break}if(C+=A,A=0,n=k+r,(0===C||C>=n)&&(A=C-n,C=n,se(!1),0===t.tt))return 0;if(C-k>=f-Ze&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 1:R=(e=>{let n,r=0;for(;;){if(Ze>A){if(ie(),Ze>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C),0===r||(C-r&65535)>f-Ze||2!=V&&(v=oe(r)),3>v)n=ee(0,255&u[C]),A--,C++;else if(n=ee(C-x,v-3),A-=v,v>P||3>A)C+=v,v=0,p=255&u[C],p=(p<<g^255&u[C+1])&b;else{v--;do{C++,p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C}while(0!=--v);C++}if(n&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 2:R=(e=>{let n,r,s=0;for(;;){if(Ze>A){if(ie(),Ze>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C),_=v,S=x,v=2,0!==s&&P>_&&f-Ze>=(C-s&65535)&&(2!=V&&(v=oe(s)),5>=v&&(1==V||3==v&&C-x>4096)&&(v=2)),3>_||v>_)if(0!==z){if(n=ee(0,255&u[C-1]),n&&se(!1),C++,A--,0===t.tt)return 0}else z=1,C++,A--;else{r=C+A-3,n=ee(C-1-S,_-3),A-=_-1,_-=2;do{++C>r||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C)}while(0!=--_);if(z=0,v=2,C++,n&&(se(!1),0===t.tt))return 0}}return 0!==z&&(n=ee(0,255&u[C-1]),z=0),se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i)}if(2!=R&&3!=R||(n=Ye),0==R||2==R)return 0===t.tt&&(c=-1),0;if(1==R){if(1==i)X(2,3),Y(256,Le._e),$(),9>1+H+10-F&&(X(2,3),Y(256,Le._e),$()),H=7;else if(re(0,0,!1),3==i)for(o=0;y>o;o++)d[o]=0;if(t.Te(),0===t.tt)return c=-1,0}}return 4!=i?0:1}}function tt(){const e=this;e.nt=0,e.rt=0,e.We=0,e.qe=0,e.tt=0,e.Ge=0}function nt(e){const t=new tt,n=(o=e&&e.chunkSize?e.chunkSize:65536)+5*(r.floor(o/16383)+1);var o;const c=new i(n);let f=e?e.level:-1;void 0===f&&(f=-1),t.He(f),t.$e=c,this.append=(e,r)=>{let o,f,a=0,l=0,u=0;const w=[];if(e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,o=t.Ye(0),0!=o)throw new s("deflating: "+t.Le);t.rt&&(t.rt==n?w.push(new i(c)):w.push(c.subarray(0,t.rt))),u+=t.rt,r&&t.nt>0&&t.nt!=a&&(r(t.nt),a=t.nt)}while(t.We>0||0===t.tt);return w.length>1?(f=new i(u),w.forEach((e=>{f.set(e,l),l+=e.length}))):f=w[0]?new i(w[0]):new i,f}},this.flush=()=>{let e,r,o=0,f=0;const a=[];do{if(t.rt=0,t.tt=n,e=t.Ye(4),1!=e&&0!=e)throw new s("deflating: "+t.Le);n-t.tt>0&&a.push(c.slice(0,t.rt)),f+=t.rt}while(t.We>0||0===t.tt);return t.Qe(),r=new i(f),a.forEach((e=>{r.set(e,o),o+=e.length})),r}}tt.prototype={He(e,t){const n=this;return n.Fe=new et,t||(t=15),n.Fe.He(n,e,t)},Ye(e){const t=this;return t.Fe?t.Fe.Ye(t,e):Oe},Qe(){const e=this;if(!e.Fe)return Oe;const t=e.Fe.Qe();return e.Fe=null,t},Xe(e,t){const n=this;return n.Fe?n.Fe.Xe(n,e,t):Oe},Ze(e,t){const n=this;return n.Fe?n.Fe.Ze(n,e,t):Oe},je(e,t,n){const r=this;let s=r.We;return s>n&&(s=n),0===s?0:(r.We-=s,e.set(r.et.subarray(r.nt,r.nt+s),t),r.nt+=s,r.qe+=s,s)},Te(){const e=this;let t=e.Fe.pending;t>e.tt&&(t=e.tt),0!==t&&(e.$e.set(e.Fe.Ke.subarray(e.Fe.Je,e.Fe.Je+t),e.rt),e.rt+=t,e.Fe.Je+=t,e.Ge+=t,e.tt-=t,e.Fe.pending-=t,0===e.Fe.pending&&(e.Fe.Je=0))}};const rt=-2,st=-3,it=-5,ot=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],ct=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],ft=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],at=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],ut=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],wt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function ht(){let e,t,n,r,s,i;function o(e,t,o,c,f,a,l,u,w,h,d){let p,y,m,b,g,k,v,S,z,C,x,A,_,I,P;C=0,g=o;do{n[e[t+C]]++,C++,g--}while(0!==g);if(n[0]==o)return l[0]=-1,u[0]=0,0;for(S=u[0],k=1;15>=k&&0===n[k];k++);for(v=k,k>S&&(S=k),g=15;0!==g&&0===n[g];g--);for(m=g,S>g&&(S=g),u[0]=S,I=1<<k;g>k;k++,I<<=1)if(0>(I-=n[k]))return st;if(0>(I-=n[g]))return st;for(n[g]+=I,i[1]=k=0,C=1,_=2;0!=--g;)i[_]=k+=n[C],_++,C++;g=0,C=0;do{0!==(k=e[t+C])&&(d[i[k]++]=g),C++}while(++g<o);for(o=i[m],i[0]=g=0,C=0,b=-1,A=-S,s[0]=0,x=0,P=0;m>=v;v++)for(p=n[v];0!=p--;){for(;v>A+S;){if(b++,A+=S,P=m-A,P=P>S?S:P,(y=1<<(k=v-A))>p+1&&(y-=p+1,_=v,P>k))for(;++k<P&&(y<<=1)>n[++_];)y-=n[_];if(P=1<<k,h[0]+P>1440)return st;s[b]=x=h[0],h[0]+=P,0!==b?(i[b]=g,r[0]=k,r[1]=S,k=g>>>A-S,r[2]=x-s[b-1]-k,w.set(r,3*(s[b-1]+k))):l[0]=x}for(r[1]=v-A,o>C?d[C]<c?(r[0]=256>d[C]?0:96,r[2]=d[C++]):(r[0]=a[d[C]-c]+16+64,r[2]=f[d[C++]-c]):r[0]=192,y=1<<v-A,k=g>>>A;P>k;k+=y)w.set(r,3*(x+k));for(k=1<<v-1;0!=(g&k);k>>>=1)g^=k;for(g^=k,z=(1<<A)-1;(g&z)!=i[b];)b--,A-=S,z=(1<<A)-1}return 0!==I&&1!=m?it:0}function c(o){let c;for(e||(e=[],t=[],n=new f(16),r=[],s=new f(15),i=new f(16)),t.length<o&&(t=[]),c=0;o>c;c++)t[c]=0;for(c=0;16>c;c++)n[c]=0;for(c=0;3>c;c++)r[c]=0;s.set(n.subarray(0,15),0),i.set(n.subarray(0,16),0)}this.st=(n,r,s,i,f)=>{let a;return c(19),e[0]=0,a=o(n,0,19,19,null,null,s,r,i,e,t),a==st?f.Le="oversubscribed dynamic bit lengths tree":a!=it&&0!==r[0]||(f.Le="incomplete dynamic bit lengths tree",a=st),a},this.it=(n,r,s,i,f,a,l,u,w)=>{let h;return c(288),e[0]=0,h=o(s,0,n,257,at,lt,a,i,u,e,t),0!=h||0===i[0]?(h==st?w.Le="oversubscribed literal/length tree":-4!=h&&(w.Le="incomplete literal/length tree",h=st),h):(c(288),h=o(s,n,r,0,ut,wt,l,f,u,e,t),0!=h||0===f[0]&&n>257?(h==st?w.Le="oversubscribed distance tree":h==it?(w.Le="incomplete distance tree",h=st):-4!=h&&(w.Le="empty distance tree with lengths",h=st),h):0)}}function dt(){const e=this;let t,n,r,s,i=0,o=0,c=0,f=0,a=0,l=0,u=0,w=0,h=0,d=0;function p(e,t,n,r,s,i,o,c){let f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z;d=c.nt,p=c.We,w=o.ot,h=o.ct,y=o.write,m=y<o.read?o.read-y-1:o.end-y,b=ot[e],g=ot[t];do{for(;20>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(f=w&b,a=n,l=r,z=3*(l+f),0!==(u=a[z]))for(;;){if(w>>=a[z+1],h-=a[z+1],0!=(16&u)){for(u&=15,k=a[z+2]+(w&ot[u]),w>>=u,h-=u;15>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;for(f=w&g,a=s,l=i,z=3*(l+f),u=a[z];;){if(w>>=a[z+1],h-=a[z+1],0!=(16&u)){for(u&=15;u>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(v=a[z+2]+(w&ot[u]),w>>=u,h-=u,m-=k,v>y){S=y-v;do{S+=o.end}while(0>S);if(u=o.end-S,k>u){if(k-=u,y-S>0&&u>y-S)do{o.lt[y++]=o.lt[S++]}while(0!=--u);else o.lt.set(o.lt.subarray(S,S+u),y),y+=u,S+=u,u=0;S=0}}else S=y-v,y-S>0&&2>y-S?(o.lt[y++]=o.lt[S++],o.lt[y++]=o.lt[S++],k-=2):(o.lt.set(o.lt.subarray(S,S+2),y),y+=2,S+=2,k-=2);if(y-S>0&&k>y-S)do{o.lt[y++]=o.lt[S++]}while(0!=--k);else o.lt.set(o.lt.subarray(S,S+k),y),y+=k,S+=k,k=0;break}if(0!=(64&u))return c.Le="invalid distance code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,st;f+=a[z+2],f+=w&ot[u],z=3*(l+f),u=a[z]}break}if(0!=(64&u))return 0!=(32&u)?(k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,1):(c.Le="invalid literal/length code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,st);if(f+=a[z+2],f+=w&ot[u],z=3*(l+f),0===(u=a[z])){w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--;break}}else w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--}while(m>=258&&p>=10);return k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,0}e.init=(e,i,o,c,f,a)=>{t=0,u=e,w=i,r=o,h=c,s=f,d=a,n=null},e.ut=(e,y,m)=>{let b,g,k,v,S,z,C,x=0,A=0,_=0;for(_=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S;;)switch(t){case 0:if(z>=258&&v>=10&&(e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,m=p(u,w,r,h,s,d,e,y),_=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S,0!=m)){t=1==m?7:9;break}c=u,n=r,o=h,t=1;case 1:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(_++))<<A,A+=8}if(g=3*(o+(x&ot[b])),x>>>=n[g+1],A-=n[g+1],k=n[g],0===k){f=n[g+2],t=6;break}if(0!=(16&k)){a=15&k,i=n[g+2],t=2;break}if(0==(64&k)){c=k,o=g/3+n[g+2];break}if(0!=(32&k)){t=7;break}return t=9,y.Le="invalid literal/length code",m=st,e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);case 2:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(_++))<<A,A+=8}i+=x&ot[b],x>>=b,A-=b,c=w,n=s,o=d,t=3;case 3:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(_++))<<A,A+=8}if(g=3*(o+(x&ot[b])),x>>=n[g+1],A-=n[g+1],k=n[g],0!=(16&k)){a=15&k,l=n[g+2],t=4;break}if(0==(64&k)){c=k,o=g/3+n[g+2];break}return t=9,y.Le="invalid distance code",m=st,e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);case 4:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(_++))<<A,A+=8}l+=x&ot[b],x>>=b,A-=b,t=5;case 5:for(C=S-l;0>C;)C+=e.end;for(;0!==i;){if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);e.lt[S++]=e.lt[C++],z--,C==e.end&&(C=0),i--}t=0;break;case 6:if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);m=0,e.lt[S++]=f,z--,t=0;break;case 7:if(A>7&&(A-=8,v++,_--),e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,e.read!=e.write)return e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);t=8;case 8:return m=1,e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);case 9:return m=st,e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m);default:return m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=_-y.nt,y.nt=_,e.write=S,e.wt(y,m)}},e.ht=()=>{}}ht.dt=(e,t,n,r)=>(e[0]=9,t[0]=5,n[0]=ct,r[0]=ft,0);const pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function yt(e,t){const n=this;let r,s=0,o=0,c=0,a=0;const l=[0],u=[0],w=new dt;let h=0,d=new f(4320);const p=new ht;n.ct=0,n.ot=0,n.lt=new i(t),n.end=t,n.read=0,n.write=0,n.reset=(e,t)=>{t&&(t[0]=0),6==s&&w.ht(e),s=0,n.ct=0,n.ot=0,n.read=n.write=0},n.reset(e,null),n.wt=(e,t)=>{let r,s,i;return s=e.rt,i=n.read,r=(i>n.write?n.end:n.write)-i,r>e.tt&&(r=e.tt),0!==r&&t==it&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r,i==n.end&&(i=0,n.write==n.end&&(n.write=0),r=n.write-i,r>e.tt&&(r=e.tt),0!==r&&t==it&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r),e.rt=s,n.read=i,t},n.ut=(e,t)=>{let i,f,y,m,b,g,k,v;for(m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g;;){let S,z,C,x,A,_,I,P;switch(s){case 0:for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}switch(i=7&f,h=1&i,i>>>1){case 0:f>>>=3,y-=3,i=7&y,f>>>=i,y-=i,s=1;break;case 1:S=[],z=[],C=[[]],x=[[]],ht.dt(S,z,C,x),w.init(S[0],z[0],C[0],0,x[0],0),f>>>=3,y-=3,s=6;break;case 2:f>>>=3,y-=3,s=3;break;case 3:return f>>>=3,y-=3,s=9,e.Le="invalid block type",t=st,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}break;case 1:for(;32>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if((~f>>>16&65535)!=(65535&f))return s=9,e.Le="invalid stored block lengths",t=st,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);o=65535&f,f=y=0,s=0!==o?2:0!==h?7:0;break;case 2:if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(0===k&&(g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k&&(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k)))return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(t=0,i=o,i>b&&(i=b),i>k&&(i=k),n.lt.set(e.je(m,i),g),m+=i,b-=i,g+=i,k-=i,0!=(o-=i))break;s=0!==h?7:0;break;case 3:for(;14>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(c=i=16383&f,(31&i)>29||(i>>5&31)>29)return s=9,e.Le="too many length or distance symbols",t=st,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(i=258+(31&i)+(i>>5&31),!r||r.length<i)r=[];else for(v=0;i>v;v++)r[v]=0;f>>>=14,y-=14,a=0,s=4;case 4:for(;4+(c>>>10)>a;){for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}r[pt[a++]]=7&f,f>>>=3,y-=3}for(;19>a;)r[pt[a++]]=0;if(l[0]=7,i=p.st(r,l,u,d,e),0!=i)return(t=i)==st&&(r=null,s=9),n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);a=0,s=5;case 5:for(;i=c,258+(31&i)+(i>>5&31)>a;){let o,w;for(i=l[0];i>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(i=d[3*(u[0]+(f&ot[i]))+1],w=d[3*(u[0]+(f&ot[i]))+2],16>w)f>>>=i,y-=i,r[a++]=w;else{for(v=18==w?7:w-14,o=18==w?11:3;i+v>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(f>>>=i,y-=i,o+=f&ot[v],f>>>=v,y-=v,v=a,i=c,v+o>258+(31&i)+(i>>5&31)||16==w&&1>v)return r=null,s=9,e.Le="invalid bit length repeat",t=st,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w=16==w?r[v-1]:0;do{r[v++]=w}while(0!=--o);a=v}}if(u[0]=-1,A=[],_=[],I=[],P=[],A[0]=9,_[0]=6,i=c,i=p.it(257+(31&i),1+(i>>5&31),r,A,_,I,P,d,e),0!=i)return i==st&&(r=null,s=9),t=i,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w.init(A[0],_[0],d,I[0],d,P[0]),s=6;case 6:if(n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,1!=(t=w.ut(n,e,t)))return n.wt(e,t);if(t=0,w.ht(e),m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g,0===h){s=0;break}s=7;case 7:if(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,n.read!=n.write)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);s=8;case 8:return t=1,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);case 9:return t=st,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);default:return t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}}},n.ht=e=>{n.reset(e,null),n.lt=null,d=null},n.yt=(e,t,r)=>{n.lt.set(e.subarray(t,t+r),0),n.read=n.write=r},n.bt=()=>1==s?1:0}const mt=13,bt=[0,0,255,255];function gt(){const e=this;function t(e){return e&&e.gt?(e.qe=e.Ge=0,e.Le=null,e.gt.mode=7,e.gt.kt.reset(e,null),0):rt}e.mode=0,e.method=0,e.vt=[0],e.St=0,e.marker=0,e.zt=0,e.Ct=t=>(e.kt&&e.kt.ht(t),e.kt=null,0),e.xt=(n,r)=>(n.Le=null,e.kt=null,8>r||r>15?(e.Ct(n),rt):(e.zt=r,n.gt.kt=new yt(n,1<<r),t(n),0)),e.At=(e,t)=>{let n,r;if(!e||!e.gt||!e.et)return rt;const s=e.gt;for(t=4==t?it:0,n=it;;)switch(s.mode){case 0:if(0===e.We)return n;if(n=t,e.We--,e.qe++,8!=(15&(s.method=e.ft(e.nt++)))){s.mode=mt,e.Le="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.zt){s.mode=mt,e.Le="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.We)return n;if(n=t,e.We--,e.qe++,r=255&e.ft(e.nt++),((s.method<<8)+r)%31!=0){s.mode=mt,e.Le="incorrect header check",s.marker=5;break}if(0==(32&r)){s.mode=7;break}s.mode=2;case 2:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St=(255&e.ft(e.nt++))<<24&4278190080,s.mode=3;case 3:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<16&16711680,s.mode=4;case 4:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<8&65280,s.mode=5;case 5:return 0===e.We?n:(n=t,e.We--,e.qe++,s.St+=255&e.ft(e.nt++),s.mode=6,2);case 6:return s.mode=mt,e.Le="need dictionary",s.marker=0,rt;case 7:if(n=s.kt.ut(e,n),n==st){s.mode=mt,s.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,s.kt.reset(e,s.vt),s.mode=12;case 12:return e.We=0,1;case mt:return st;default:return rt}},e._t=(e,t,n)=>{let r=0,s=n;if(!e||!e.gt||6!=e.gt.mode)return rt;const i=e.gt;return s<1<<i.zt||(s=(1<<i.zt)-1,r=n-s),i.kt.yt(t,r,s),i.mode=7,0},e.It=e=>{let n,r,s,i,o;if(!e||!e.gt)return rt;const c=e.gt;if(c.mode!=mt&&(c.mode=mt,c.marker=0),0===(n=e.We))return it;for(r=e.nt,s=c.marker;0!==n&&4>s;)e.ft(r)==bt[s]?s++:s=0!==e.ft(r)?0:4-s,r++,n--;return e.qe+=r-e.nt,e.nt=r,e.We=n,c.marker=s,4!=s?st:(i=e.qe,o=e.Ge,t(e),e.qe=i,e.Ge=o,c.mode=7,0)},e.Pt=e=>e&&e.gt&&e.gt.kt?e.gt.kt.bt():rt}function kt(){}function vt(e){const t=new kt,n=e&&e.chunkSize?r.floor(2*e.chunkSize):131072,o=new i(n);let c=!1;t.xt(),t.$e=o,this.append=(e,r)=>{const f=[];let a,l,u=0,w=0,h=0;if(0!==e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,0!==t.We||c||(t.nt=0,c=!0),a=t.At(0),c&&a===it){if(0!==t.We)throw new s("inflating: bad input")}else if(0!==a&&1!==a)throw new s("inflating: "+t.Le);if((c||1===a)&&t.We===e.length)throw new s("inflating: bad input");t.rt&&(t.rt===n?f.push(new i(o)):f.push(o.subarray(0,t.rt))),h+=t.rt,r&&t.nt>0&&t.nt!=u&&(r(t.nt),u=t.nt)}while(t.We>0||0===t.tt);return f.length>1?(l=new i(h),f.forEach((e=>{l.set(e,w),w+=e.length}))):l=f[0]?new i(f[0]):new i,l}},this.flush=()=>{t.Ct()}}kt.prototype={xt(e){const t=this;return t.gt=new gt,e||(e=15),t.gt.xt(t,e)},At(e){const t=this;return t.gt?t.gt.At(t,e):rt},Ct(){const e=this;if(!e.gt)return rt;const t=e.gt.Ct(e);return e.gt=null,t},It(){const e=this;return e.gt?e.gt.It(e):rt},_t(e,t){const n=this;return n.gt?n.gt._t(n,e,t):rt},ft(e){return this.et[e]},je(e,t){return this.et.subarray(e,e+t)}},self.initCodec=()=>{self.Deflate=nt,self.Inflate=vt};\n'],{type:"text/javascript"}));Vm({workerScripts:{inflate:[t],deflate:[t]}})}(),Vm({Deflate:function(e){const t=new wm,n=(i=e&&e.chunkSize?e.chunkSize:65536)+5*(Math.floor(i/16383)+1);var i;const r=new Uint8Array(n);let o=e?e.level:-1;void 0===o&&(o=-1),t.deflateInit(o),t.next_out=r,this.append=function(e,i){let o,a,s=0,l=0,c=0;const u=[];if(e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=n,o=t.deflate(0),0!=o)throw new Error("deflating: "+t.msg);t.next_out_index&&(t.next_out_index==n?u.push(new Uint8Array(r)):u.push(r.subarray(0,t.next_out_index))),c+=t.next_out_index,i&&t.next_in_index>0&&t.next_in_index!=s&&(i(t.next_in_index),s=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return u.length>1?(a=new Uint8Array(c),u.forEach((function(e){a.set(e,l),l+=e.length}))):a=u[0]?new Uint8Array(u[0]):new Uint8Array,a}},this.flush=function(){let e,i,o=0,a=0;const s=[];do{if(t.next_out_index=0,t.avail_out=n,e=t.deflate(4),1!=e&&0!=e)throw new Error("deflating: "+t.msg);n-t.avail_out>0&&s.push(r.slice(0,t.next_out_index)),a+=t.next_out_index}while(t.avail_in>0||0===t.avail_out);return t.deflateEnd(),i=new Uint8Array(a),s.forEach((function(e){i.set(e,o),o+=e.length})),i}},Inflate:function(e){const t=new Lm,n=e&&e.chunkSize?Math.floor(2*e.chunkSize):131072,i=new Uint8Array(n);let r=!1;t.inflateInit(),t.next_out=i,this.append=function(e,o){const a=[];let s,l,c=0,u=0,d=0;if(0!==e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=n,0!==t.avail_in||r||(t.next_in_index=0,r=!0),s=t.inflate(0),r&&-5===s){if(0!==t.avail_in)throw new Error("inflating: bad input")}else if(0!==s&&1!==s)throw new Error("inflating: "+t.msg);if((r||1===s)&&t.avail_in===e.length)throw new Error("inflating: bad input");t.next_out_index&&(t.next_out_index===n?a.push(new Uint8Array(i)):a.push(i.subarray(0,t.next_out_index))),d+=t.next_out_index,o&&t.next_in_index>0&&t.next_in_index!=c&&(o(t.next_in_index),c=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return a.length>1?(l=new Uint8Array(d),a.forEach((function(e){l.set(e,u),u+=e.length}))):l=a[0]?new Uint8Array(a[0]):new Uint8Array,l}},this.flush=function(){t.inflateEnd()}}});var Dg=function(){function e(e){this.upime=e,this.destroyed=!1,this.id=ia(),this.completedTaskCount=0,this.totalTaskCount=0,this.taskQueue=new lm(1)}return e.prototype.calcImageSize=function(e,t){var n=e.width/e.height,i=Math.round(1e3/Math.sqrt(n)*t*(1==t?window.devicePixelRatio:1));return{width:Math.round(i*n),height:i}},e.prototype.getImages=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o=this;return D(this,(function(a){switch(a.label){case 0:return i=[],r=void 0!==n?{watermarkUrl:n,position:{right:30,bottom:20}}:void 0,e.forEach((function(e,n){return A(o,void 0,void 0,(function(){var o,a=this;return D(this,(function(s){return o=this.taskQueue.push((function(){return A(a,void 0,void 0,(function(){var n=this;return D(this,(function(i){return[2,new Promise((function(i,o){var a=Rt(e.getGlobalBox()),s={width:a.width,height:a.height},l={width:1,height:1};t===rf.Low?l=n.calcImageSize(s,1):t===rf.Medium?l=n.calcImageSize(s,4):t===rf.High&&(l=n.calcImageSize(s,7)),requestIdleCallback((function(){Jf(n.upime,e,l,"jpg",r,e.hasBg?void 0:16777215,Gf.Blob).then(i).catch(o)}))}))]}))}))})),o.finally((function(){a.completedTaskCount+=1})),i.push(o.then((function(t){return{frame:e,image:t,order:n+1}})).catch((function(){return{frame:e,image:void 0,order:n+1}}))),[2]}))}))})),[4,Promise.all(i)];case 1:return[2,a.sent()]}}))}))},e.prototype.exportImages=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return t=e.frames,n=e.imageResolution,i=e.watermarkUrl,this.totalTaskCount=t.length,[4,this.getImages(t,n,i)];case 1:return r.sent().forEach((function(e){var t=e.image,n=e.frame,i=e.order;if(void 0!==t){var r=document.createElement("a");r.download="image_".concat(i,"_").concat(n.name,".jpg"),r.style.display="none",r.href=URL.createObjectURL(t),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}})),[2]}}))}))},e.prototype.exportImagesByZip=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h=this;return D(this,(function(f){switch(f.label){case 0:return t=e.frames,n=e.imageResolution,i=e.fileName,r=e.watermarkUrl,this.totalTaskCount=t.length,[4,this.getImages(t,n,r)];case 1:return o=f.sent(),a=new ug,s=new xg(a),l=[],o.forEach((function(e){var t=e.image,n=e.frame,i=e.order;if(void 0!==t){var r=new cg(t),o=h.taskQueue.push((function(){return A(h,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,s.add("image_".concat(i,"_").concat(n.name,".jpg"),r)];case 1:return e.sent(),[2]}}))}))}));l.push(o)}})),[4,Promise.all(l)];case 2:return f.sent(),[4,s.close()];case 3:return c=f.sent(),u=new Date,d="".concat(i,"_").concat(u.getFullYear()).concat(Ch(u.getMonth()+1)).concat(Ch(u.getDate())).concat(Ch(u.getHours())).concat(Ch(u.getMinutes())).concat(Ch(u.getSeconds()),".zip"),(p=document.createElement("a")).download=d,p.style.display="none",p.href=URL.createObjectURL(c),document.body.appendChild(p),p.click(),URL.revokeObjectURL(p.href),document.body.removeChild(p),[2]}}))}))},e.prototype.destroy=function(){this.taskQueue.cancelAll(),this.destroyed=!0},M([rl],e.prototype,"completedTaskCount",void 0),M([rl],e.prototype,"totalTaskCount",void 0),M([il],e)}(),Rg=function(){function e(e){this.upime=e,this.destroyed=!1,this.id=ia(),this.completedTaskCount=0,this.totalTaskCount=0,this.taskQueue=new lm(1),this.frameTaskQueue=new lm(1),this.snapshotElementTypes=new Set([Za.LINE,Za.IMAGE,Za.GRAPHIC,Za.CONNECTIONLINE,Za.MINDMAP_NODE,Za.MINDMAP_LINE,Za.TIMER,Za.KANBAN,Za.CARD,Za.BIG_DOC])}return e.prototype.calcImageSize=function(e,t){var n=e.width/e.height,i=Math.round(1e3/Math.sqrt(n)*t*(1==t?window.devicePixelRatio:1));return{width:Math.round(i*n),height:i}},e.prototype.getRichContent=function(e,t){return e.map((function(e){var n=e[0],i=e[1];return{content:n.join(""),fontSize:t,fontBold:!0===i.bolder,fontUnderline:!0===i.underLine,fontItalic:!0===i.italic,fontColor:i.color,highLight:i.highLight,link:i.link||""}}))},e.prototype.getRelativePosition=function(e,t){return{x:t.left-e.left,y:t.top-e.top}},e.prototype.getHidedFrameElementInfo=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return t=Rt(e.getBorderBox()),n={width:t.width,height:t.height},[4,tm(e.id,this.upime,{jpg:!0},2)];case 1:return null!==(i=r.sent().jpgFilePath)?[2,{eleType:Za.IMAGE,position:{x:0,y:0},size:n,scale:1,rotate:0,path:i,clipRect:exports.E({x:0,y:0},n),zIndex:1}]:[2]}}))}))},e.prototype.getTextElementInfo=function(e,t){return{eleType:Za.TEXT,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,rotate:e.rotate,richContent:void 0===e.richTextClient?[]:this.getRichContent(e.richTextClient.content,e.fontSize),ha:e.ha,hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity,zIndex:e.zIndex}},e.prototype.getImageElementInfo=function(e,t){return{eleType:Za.IMAGE,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,rotate:e.rotate,fileId:e.fileId,clipRect:e.clipRect,zIndex:e.zIndex}},e.prototype.getShapeElementInfo=function(e,t){return{eleType:Za.SHAPE,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,rotate:e.rotate,shape:e.shape,richContent:void 0===e.richTextClient?[]:this.getRichContent(e.richTextClient.content,e.fontSize),ha:e.ha,va:e.va,hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity,hasBorder:e.hasBorder,borderThickness:e.borderThickness,borderColor:e.borderColor,borderStyle:e.borderStyle,borderOpacity:e.borderOpacity,zIndex:e.zIndex}},e.prototype.getStickerElementInfo=function(e,t){return{eleType:Za.STICKER,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,rotate:e.rotate,richContent:void 0===e.richTextClient?[]:this.getRichContent(e.richTextClient.content,e.fontSize),ha:e.ha,va:e.va,hasBg:!0,bgColor:e.bgColor,bgOpacity:1,zIndex:e.zIndex}},e.prototype.getWebgpageElementInfo=function(e,t){return{eleType:Za.TEXT,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,rotate:e.rotate,richContent:[{content:e.name,fontSize:14,fontBold:!1,fontUnderline:!1,fontItalic:!1,fontColor:1710618,link:e.url}],ha:"left",hasBg:!1,bgColor:16777215,bgOpacity:1,zIndex:e.zIndex}},e.prototype.getTableElementInfo=function(e,t){var n=this;return{eleType:Za.TABLE,position:this.getRelativePosition(t,e.getGlobalBox()),size:e.size,scale:e.scale,cols:e.cols,rows:e.rows,rowHeights:e.rowHeights,rowWidths:e.rowWidths,cells:e.grids.flat().map((function(e){return{cId:e.cIdx,rId:e.rIdx,hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity,clusterId:e.clusterId,clusterRoot:e.clusterRoot}})),textCells:e.grids.flat().map((function(e){var t,i=null===(t=e.selfRefSystem)||void 0===t?void 0:t.children.find((function(e){return!0!==e.isRefSystem&&e.elementType===Za.GRID_TEXT}));if(void 0!==i&&!function(e){return!0===e.isRefSystem}(i)&&!1!==Mu(i)&&void 0!==i.richTextClient){var r=i;return{cId:e.cIdx,rId:e.rIdx,richContent:n.getRichContent(r.richTextClient.content,r.fontSize),ha:r.ha,va:r.va,hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity}}})).filter((function(e){return void 0!==e})),zIndex:e.zIndex}},e.prototype.getTableCellChildElementInfos=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r=this;return D(this,(function(o){switch(o.label){case 0:return n=[],i=[],e.grids.flat().forEach((function(e){var o;null===(o=e.selfRefSystem)||void 0===o||o.children.forEach((function(e){if(!e.isRefSystem){var o=e;if(!Mu(o))if(Nu(o))n.push(r.getTextElementInfo(o,t));else if(Ou(o))n.push(r.getImageElementInfo(o,t));else if(Au(o))n.push(r.getShapeElementInfo(o,t));else if(Pu(o))n.push(r.getStickerElementInfo(o,t));else{if(!1===r.snapshotElementTypes.has(o.elementType))return;i.push(r.getElementSnapshotInfo(o,t).then((function(e){void 0!==e&&n.push(e)})))}}}))})),[4,Promise.all(i)];case 1:return o.sent(),[2,n]}}))}))},e.prototype.getMindMapElementInfo=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return n=R([e],e.getDescendants(),!0),i=Yt(n.map((function(e){return e.getGlobalBox()}))),r=Rt(i),o=this.calcImageSize(r,4),[4,this.getElementSnapshotInfo(e,t,{size:o,scale:o.width/r.width})];case 1:return void 0!==(a=l.sent())&&(s=this.getRelativePosition(t,i),a.position=s,a.size.width=r.width,a.size.height=r.height,a.clipRect.width=r.width,a.clipRect.height=r.height),[2,a]}}))}))},e.prototype.getElementSnapshotInfo=function(e,t,n){var i,r;return A(this,void 0,void 0,(function(){var o,a,s,l;return D(this,(function(c){switch(c.label){case 0:return[4,tm(e.id,this.upime,{png:!0},null!==(i=null==n?void 0:n.scale)&&void 0!==i?i:1)];case 1:return null!==(o=c.sent().pngFilePath)?(a=this.getRelativePosition(t,e.getGlobalBox()),s=Rt(e.getGlobalBox()),l=null!==(r=null==n?void 0:n.size)&&void 0!==r?r:{width:s.width,height:s.height},[2,{eleType:Za.IMAGE,position:a,size:l,scale:1,rotate:0,path:o,clipRect:exports.E({x:0,y:0},l),zIndex:e.zIndex}]):[2]}}))}))},e.prototype.getWatermarkInfo=function(e,t){var n=e.width,i=e.height,r=0,o=0;9*n>16*i?r=(9*n/16-i)/2:o=(16*i/9-n)/2;var a={width:64,height:64},s={x:n+o,y:i+r};return{eleType:Za.IMAGE,position:s,size:a,scale:1,rotate:0,path:t,clipRect:exports.E({x:0,y:0},a),zIndex:1e11,isWatermark:!0}},e.prototype.exportPpt=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a=this;return D(this,(function(s){switch(s.label){case 0:return t=e.frames,n=e.fileName,i=e.watermarkUrl,this.totalTaskCount=t.length,r=[],o=[],t.forEach((function(e){return A(a,void 0,void 0,(function(){var t,n,a,s,l,c=this;return D(this,(function(u){return t=e.getGlobalBox(),n=Rt(t),a={bgColor:e.bgColor,width:n.width,height:n.height,elements:[]},s=a.elements,l=this.taskQueue.push((function(){return A(c,void 0,void 0,(function(){var o,l,c,u,d=this;return D(this,(function(p){switch(p.label){case 0:return!0!==e.hide?[3,2]:[4,this.getHidedFrameElementInfo(e)];case 1:return void 0!==(o=p.sent())&&s.push(o),[3,4];case 2:return l=[],c=new lm(1),this.frameTaskQueue=c,e.getMembers().forEach((function(e){if(Nu(e))s.push(d.getTextElementInfo(e,t));else if(Ou(e)&&["png","jpg","jpeg"].includes(e.imgType))s.push(d.getImageElementInfo(e,t));else if(Au(e))s.push(d.getShapeElementInfo(e,t));else if(Pu(e))s.push(d.getStickerElementInfo(e,t));else if(Bu(e)){if(!0===e.isRootNode){var n=c.push((function(){return A(d,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.getMindMapElementInfo(e,t).then((function(e){void 0!==e&&s.push(e)}))];case 1:return n.sent(),[2]}}))}))}));l.push(n)}}else!function(e){return e.elementType===Za.WEBPAGE}(e)?Du(e)?(s.push(d.getTableElementInfo(e,t)),n=c.push((function(){return A(d,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.getTableCellChildElementInfos(e,t).then((function(e){s.push.apply(s,e)}))];case 1:return n.sent(),[2]}}))}))})),l.push(n)):!0===d.snapshotElementTypes.has(e.elementType)&&(n=c.push((function(){return A(d,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.getElementSnapshotInfo(e,t).then((function(e){void 0!==e&&s.push(e)}))];case 1:return n.sent(),[2]}}))}))})),l.push(n)):s.push(d.getWebgpageElementInfo(e,t))})),[4,Promise.all(l)];case 3:p.sent(),p.label=4;case 4:return void 0!==i&&(u=this.getWatermarkInfo(n,i),s.push(u)),s.sort((function(e,t){return e.zIndex-t.zIndex})),r.push(a),[2]}}))}))})),l.finally((function(){c.completedTaskCount+=1})),o.push(l),[2]}))}))})),[4,Promise.all(o)];case 1:return s.sent(),[4,this.upime.exportFrame2Ppt(r,n)];case 2:return s.sent(),[2]}}))}))},e.prototype.destroy=function(){this.taskQueue.cancelAll(),this.frameTaskQueue.cancelAll(),this.destroyed=!0},M([rl],e.prototype,"completedTaskCount",void 0),M([rl],e.prototype,"totalTaskCount",void 0),M([il],e)}();function Bg(){return e.useReducer((function(e){return e+1}),0)[1]}var Lg=function(t){var n,i=t.success,r=t.fail,o=t.content,a=null!=o?o:{},s=a.frames,l=a.fileType,c=a.aplusInfo,u=Bg(),d=e.useContext(xl).upime,p=W().getUpimeTrans,h=null!==(n=d.userManager.userAccessHint)&&void 0!==n?n:{},f=h.ExportFrameAsHighQualityPDFHint,m=h.ExportFrameAsPowerPointHint,v=h.ExportFrameAsImageHint,g=null!=s?s:d.framesListManager.sequentialFrames,y=g.slice(0,100).filter((function(e){return!1===e.deleted})),b=e.useState(new Set(y.map((function(e){return e.id})))),E=b[0],x=b[1],w=e.useRef(E);e.useEffect((function(){g.length>100&&d.addToast(p("export.frame.count.overlimit.tip",100))}),[]),e.useEffect((function(){x((function(e){var t=new Set;return y.forEach((function(n){e.has(n.id)&&t.add(n.id)})),t}))}),[y.length]),e.useEffect((function(){var e=d.subscribe("framesUpdated",(function(){u()}));return function(){e()}}),[]);var C=e.useState(ef.Small),S=C[0],k=C[1],_=[{key:"pdf",label:"PDF (pdf)",content:"PDF (pdf)",value:tf.Pdf},{key:"ppt",label:"".concat(p("export.frame.as.ppt")," (pptx)"),content:e.createElement("div",{className:$h.exportTypeOptionContentWrap},e.createElement("span",{className:$h.exportTypeOptionContent},"".concat(p("export.frame.as.ppt")," (pptx)")),!0!==d.canExportFrameAsPowerPoint&&void 0!==m&&e.createElement(m,null)),value:tf.Pptx},{key:"image",label:"".concat(p("export.frame.as.image")," (jpg)"),content:e.createElement("div",{className:$h.exportTypeOptionContentWrap},e.createElement("span",{className:$h.exportTypeOptionContent},"".concat(p("export.frame.as.image")," (jpg)")),!0!==d.canExportFrameAsImage&&void 0!==v&&e.createElement(v,null)),value:tf.Image}],T=e.useState(null!=l?l:tf.Pdf),I=T[0],P=T[1],N=e.useState(nf.Low),M=N[0],R=N[1],B=e.useState(rf.Low),L=B[0],O=B[1],F=function(){var e,t;return null!==(t=null===(e=d.queryBoardInfo)||void 0===e?void 0:e.call(d).title)&&void 0!==t?t:"untitled"},z=bl(F()),H=e.useState(!1),U=H[0],V=H[1],G=e.useRef(null),q=e.useRef(null),K=e.useRef(null),Y=rm();return e.useEffect((function(){return function(){var e;w.current.size<=5&&(null===(e=q.current)||void 0===e||e.destroy())}}),[]),e.createElement("div",{className:$h.container},e.createElement("div",{className:$h.head},e.createElement("div",{className:$h.title},p("export.frame")),e.createElement(hl,{icon:"guanbi",className:$h.closeBtn,onClick:function(){r("close")}})),e.createElement("div",{className:$h.body},e.createElement("div",{className:$h.leftPart},e.createElement("div",{className:$h.framesListContainer},e.createElement("div",{className:j($h.frameList,S===ef.Small&&$h.small,S===ef.Large&&$h.large)},y.map((function(t){return e.createElement(im,{key:t.id,exportFileType:I,size:S,frameElement:t,selected:E.has(t.id),onClick:function(e){x((function(){E.has(e)?E.delete(e):E.add(e);var t=new Set(E);return w.current=t,t}))}})})))),e.createElement("div",{className:$h.listOperations},e.createElement("div",{className:$h.switchListType},e.createElement(hl,{icon:"bujuxiao",className:j($h.listTypeBtn,$h.small,S===ef.Small&&$h.active),onClick:function(){k(ef.Small)}}),e.createElement(hl,{icon:"bujuda",className:j($h.listTypeBtn,$h.large,S===ef.Large&&$h.active),onClick:function(){k(ef.Large)}})),e.createElement("div",{className:$h.fastSelect},e.createElement(of,{state:y.length>0&&E.size===y.length?Zh.SelectAll:0===E.size?Zh.SelectNone:Zh.SelectPart,onSelectAll:function(){var e=y.map((function(e){return e.id})),t=new Set(e);x(t),w.current=t},onSelectNone:function(){var e=new Set([]);x(e),w.current=e}}),e.createElement("span",{className:$h.selectAllLabel},p("export.frame.select.all")),e.createElement("span",{className:$h.selectedCount},"".concat(E.size,"/").concat(y.length)),e.createElement(Dl,{renderData:{data:{},fun:function(){return e.createElement("div",{className:$h.hoverTipContent},p("export.frame.tip.1"),e.createElement("br",null),p("export.frame.tip.2"),e.createElement("br",null),p("export.frame.tip.3"))}},placement:"top",rootClass:$h.xinxiIconContainer},e.createElement(hl,{className:$h.xixiIcon,icon:"xinxi"}))))),e.createElement("div",{className:$h.divider}),e.createElement("div",{className:$h.rightPart},e.createElement("div",{className:$h.selectExportTypeContainer},e.createElement("div",{className:$h.optionLabel},p("export.as")),e.createElement(af,{className:$h.selectExportType,value:I,options:_,onSelect:function(e){P(e)},beforeSelect:function(e){var t,n;return!(e!==tf.Pdf&&(e===tf.Pptx?0==(!0===d.canExportFrameAsPowerPoint)&&(null===(t=d.handleExportFrameAsPowerPoint)||void 0===t||t.call(d),1):e!==tf.Image||0==(!0===d.canExportFrameAsImage)&&(null===(n=d.handleExportFrameAsImage)||void 0===n||n.call(d),1)))}})),I===tf.Pdf&&e.createElement("div",{className:$h.selectQualityContainer},e.createElement("div",{className:$h.optionLabel},p("export.frame.as.pdf.clarity")),e.createElement(uf,{value:M,className:$h.selectQuality,onSelect:function(e){R(e)}},e.createElement(cf,{value:nf.Low},e.createElement("span",{className:$h.radioContent},p("exportPdf.common"))),e.createElement(cf,{value:nf.High,beforeSelect:function(){var e;return 0!=(!0===d.canExportFrameAsHighQualityPDF)||(null===(e=d.handleExportFrameAsHighQualityPDF)||void 0===e||e.call(d),!1)}},e.createElement("div",{className:$h.highQualityPDFRadioContentWrap},e.createElement("span",{className:$h.radioContent},p("exportPdf.best")),!0!==d.canExportFrameAsHighQualityPDF&&void 0!==f&&e.createElement(f,null))))),I===tf.Image&&e.createElement("div",{className:$h.selectResolutionContainer},e.createElement("div",{className:$h.optionLabel},p("export.frame.as.image.dimensions")),e.createElement(uf,{value:L,className:$h.selectResolution,onSelect:function(e){O(e)}},e.createElement(cf,{value:"low"},e.createElement("span",null,p("export.frame.as.image.dimensions.little"))),e.createElement(cf,{value:"medium"},p("export.frame.as.image.dimensions.medium")),e.createElement(cf,{value:"high"},p("export.frame.as.image.dimensions.large")))),(I===tf.Pdf||I===tf.Pptx)&&e.createElement("div",{className:$h.inputFileNameContainer},e.createElement("div",{className:$h.optionLabel},p("export.frame.file.name")),e.createElement(El,exports.E({className:$h.inputFileName},z,{btnClsName:"addInputClearBtn",onBlur:function(){""===z.value.trim()&&z.setValue(F())}}))),e.createElement("div",{className:$h.dialogButtonsWrap},I===tf.Image&&E.size>5&&e.createElement("div",{className:$h.imageCountTip},e.createElement(hl,{className:$h.icon,icon:"xinxi2"}),e.createElement("span",{className:$h.content},p("export.image.zip.tip"))),e.createElement("div",{className:$h.dialogButtons},e.createElement(ul,{className:$h.cancelBtn,type:"secondary",onClick:function(){r("cancel")}},p("common.cancel")),e.createElement(ul,{className:j($h.confirmBtn,U&&$h.exporting),type:"primary",disabled:0===E.size||!0===U,onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,n,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return!0===Y.isLocking?[2]:(Y.start(),V(!0),void 0!==c&&(e="PDF",I===tf.Pptx?e="演示文稿":I===tf.Image&&(e="图片"),_c("cv_exportframeas",{fileType:e,entry:c.entry})),t=z.value.trim(),n=y.filter((function(e){return E.has(e.id)})),r=d.watermarkUrl,I!==tf.Pdf?[3,1]:(o=new cm(d),G.current=o,d.addFrameExporter(o),M===nf.Low?o.exportPdf({frames:n,fileName:t,watermarkUrl:r}).finally((function(){d.removeFrameExporter(o)})):M===nf.High&&o.exportPdfBySvg({frames:n,fileName:t,watermarkUrl:r}).finally((function(){d.removeFrameExporter(o)})),[3,6]));case 1:return I!==tf.Image?[3,5]:(a=new Dg(d),q.current=a,n.length<=5?[4,a.exportImages({frames:n,imageResolution:L,watermarkUrl:r})]:[3,3]);case 2:return l.sent(),[3,4];case 3:d.addFrameExporter(a),a.exportImagesByZip({frames:n,imageResolution:L,fileName:t,watermarkUrl:r}).finally((function(){d.removeFrameExporter(a)})),l.label=4;case 4:return[3,6];case 5:I===tf.Pptx&&(s=new Rg(d),K.current=s,d.addFrameExporter(s),s.exportPpt({frames:n,fileName:t,watermarkUrl:r}).catch((function(e){})).finally((function(){d.removeFrameExporter(s)}))),l.label=6;case 6:return Y.stop(),V(!1),i(),[2]}}))}))}},U?e.createElement(hl,{className:$h.loadingIcon,icon:"jiazai"}):p("export.frame.dialog.confirm")))))))},Og=function(t){var n=t.upime,i=t.className,r=t.elements,o=t.hideMenuCB,a=W().getUpimeTrans,s=e.useContext(Ic).rootContainer,l=e.useState("rightTop"),c=l[0],u=l[1];return e.createElement(Dh,{className:j(Jh.exportFrameMenuButtonContainer,i),renderData:{render:Fg,data:{upime:n,elements:r,hideMenuCB:o}},placement:c,calcRect:function(e){var t,n=null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect(),i=!1,r=!1;return n&&e.left+e.width+150>n.left+n.width&&(i=!0),n&&e.top+124+60>n.top+n.height&&(r=!0),i&&!r&&u("leftTop"),i&&r&&u("leftBottom"),i||r||u("rightTop"),!i&&r&&u("rightBottom"),e},noPortal:!0,useHover:!0,extraStyle:{marginLeft:"-8px"}},e.createElement("div",{className:Jh.exportFrameMenuButton},e.createElement("span",{className:Jh.content},a("contextmenu.exportFrameBtn")),e.createElement(hl,{className:Jh.icon,icon:"youjiantou"})))},Fg=function(t){var n,i=t.upime,r=t.elements,o=t.hideMenuCB,a=W().getUpimeTrans,s=null!==(n=i.userManager.userAccessHint)&&void 0!==n?n:{},l=s.ExportFrameAsPowerPointHint,c=s.ExportFrameAsImageHint,u=function(){var e=r.filter(zu).reduce((function(e,t){return e.add(t.id)}),new Set);return i.framesListManager.sequentialFrames.filter((function(t){return e.has(t.id)}))};return e.createElement("div",{className:Jh.exportFrameTypesPanel},e.createElement("div",{className:Jh.exportFrameType,onClick:function(){i.showWindow(Lg,{fileType:tf.Pdf,frames:u(),aplusInfo:{entry:"画布内帧框导出"}},void 0,void 0,void 0,(function(e){})),null==o||o()}},e.createElement("span",{className:Jh.fileType},"PDF")),e.createElement("div",{className:Jh.exportFrameType,onClick:function(){var e;null==o||o(),!0===i.canExportFrameAsPowerPoint?i.showWindow(Lg,{fileType:tf.Pptx,frames:u(),aplusInfo:{entry:"帧框列表导出"}},void 0,void 0,void 0,(function(e){})):null===(e=i.handleExportFrameAsPowerPoint)||void 0===e||e.call(i)}},e.createElement("span",{className:Jh.fileType},a("export.frame.as.ppt")),!0!==i.canExportFrameAsPowerPoint&&void 0!==l&&e.createElement(l,null)),e.createElement("div",{className:Jh.exportFrameType,onClick:function(){var e;null==o||o(),!0===i.canExportFrameAsImage?i.showWindow(Lg,{fileType:tf.Image,frames:u(),aplusInfo:{entry:"帧框列表导出"}},void 0,void 0,void 0,(function(e){})):null===(e=i.handleExportFrameAsImage)||void 0===e||e.call(i)}},e.createElement("span",{className:Jh.fileType},a("export.frame.as.image")),!0!==i.canExportFrameAsImage&&void 0!==c&&e.createElement(c,null)))};function zg(e,t,n){return{name:e,renderer:t,data:n}}var Hg=function(t){var n=t.upime,i=t.hideMenuCB,r=W().getUpimeTrans,o=n.userManager.userAccessHint;return e.createElement("div",{className:j(Ml.bling_item,Eh.ctrl_option),onClick:function(){n.handleTemplateUpgradeModalOpen&&n.handleTemplateUpgradeModalOpen(),null==i||i()}},e.createElement("span",null,r("element.saveCustomTemplate")),o.TemplateUpgradeLabel&&e.createElement(o.TemplateUpgradeLabel,null))},Ug=function(t){var n=t.editor,i=t.upime,r=t.hideMenuCB,o=t.position,a=W().getUpimeTrans,s=i.userManager.userAccessHint,l=e.useMemo((function(){var e,t,l=[],c=n.editable&&!n.isHandMode,u=n.getElements();if(1===u.length&&u[0].elementType===Za.TABLE){var d=n,p=d.element;if(p.focusingCell){var h=d.couldUnMergeCells;if(l.push({name:a("element.copy"),func:function(){return i.copySelected()}}),l.push({name:a("common.paste"),func:function(){return i.onReadClipboard(o)}}),1===p.focusedCells.length){var f=p.focusedCells[0].rIdx,m=p.grids.length>1&&p.grids[f].every((function(e){return p.getCellsGroup(e).every((function(e){return e.rIdx===f}))}));m&&l.push({name:a("table.delete.row"),func:function(){d.element.selectRow({row:f}),d.removeFullRows()}});var v=p.focusedCells[0].cIdx,g=p.grids[0].length>1&&p.grids.every((function(e){var t=e[v];return p.getCellsGroup(t).every((function(e){return e.cIdx===v}))}));g&&l.push({name:a("table.delete.col"),func:function(){d.element.selectCol({col:v}),d.removeFullCols()}})}return p.focusingCell&&l.push({name:a("comment.add"),func:function(){return n.createCommentOnElement(o)}}),h&&l.push({name:a("table.unmerge.cell"),func:function(){return d.unMergeCells()}}),l}}if(Yh.length){var y=0;Yh.forEach((function(e){(void 0===e.supportElements||1===u.length&&e.supportElements.includes(u[0].elementType))&&!1!==e.editor&&(!0!==e.editableOnly||c)&&(l.push({name:e.name,func:e.onClick.bind(null,u)}),y++)})),y&&l.push({name:"divider",func:function(){}})}if(1===u.length&&u[0].elementType===Za.MINDMAP_NODE){var b=u[0].children;b.length&&(b.some((function(e){return e.isMindmapNodeHideByCollapsed}))?l.push({name:a("mindmap.expand.all"),func:function(){n.expandAllChildren()}}):l.push({name:a("mindmap.collapse.all"),func:function(){n.collapseAllChildren()}}),l.push({name:"divider",func:function(){return""}}))}var E=n.couldAddComment&&(c||i.userManager.commentOnlyMode),x="function"==typeof n.copyLink,w=c&&n.supportLinkTo();if(E&&l.push({name:a("comment.add"),func:function(){return n.createCommentOnElement(o)}}),x&&l.push({name:a("link.copy"),func:n.copyLink}),w){var C=n.getElements()[0].getLinkToElement();C&&l.push({name:C.link?a("link.edit"):a("link.add"),func:function(){return n.addLinkTo()}})}(E||x||w)&&l.push({name:"divider",func:function(){}});var S=c&&n.supportZindex,k=!n.frameHided&&c;S&&l.push({name:a("element.bringToFront"),func:function(){return n.bringToFront()}},{name:a("element.sendToBack"),func:function(){return n.sendToBack()}}),k&&(u.some((function(e){return!e.supportCopy}))?l.push({name:a("element.clone"),func:function(){return i.cloneSelectedEles()}}):l.push({name:a("element.copy"),func:function(){return i.copySelected()}},{name:a("element.clone"),func:function(){return i.cloneSelectedEles()}})),(S||k)&&l.push({name:"divider",func:function(){}});var _=c&&i.downloadConfig.enable&&1===u.length&&u[0].elementType===Za.TABLE,T=n.couldCreateFrame&&c,I=i.editable&&!0===i.downloadConfig.enable&&u.some((function(e){return e.elementType===Za.FRAME})),P=!((null===(e=u[0])||void 0===e?void 0:e.elementType)===Za.KANBAN&&u[0].selectedCards.length>0)&&i.userManager.enableUploadTemplate&&c&&!n.frameHided;_&&l.push({name:a("export.table.excel"),func:function(){return i.export2Excel(u[0])}}),T&&l.push({name:a("frame.createFrame"),func:n.createFrameFromElements}),I&&l.push(zg(a("contextmenu.exportFrameBtn"),Og,{upime:i,elements:u,hideMenuCB:r})),P&&(s.TemplateUpgradeLabel?l.push(zg(a("element.saveCustomTemplate"),Hg,{upime:i,hideMenuCB:r})):l.push({name:a("element.saveCustomTemplate"),func:function(){return i.archiveSelectedElements()}})),(_||T||I||P)&&l.push({name:"divider",func:function(){}});var N="function"==typeof n.doRename&&c&&!n.frozed,M=1===u.length||n.frozed||n.allSameGroup;if(N&&l.push({name:a("element.rename"),func:n.doRename.bind(n)}),M){var A=u[0],D=A.id;A.elementType===Za.KANBAN&&(D=(null===(t=A.selectedCards[0])||void 0===t?void 0:t.cardId)||D),l.push(zg(a("element.info"),Hh,{upime:i,id:D}))}var R=c&&!n.frozed;return(M||N)&&R&&l.push({name:"divider",func:function(){}}),R&&(1===u.length&&u[0].elementType===Za.FRAME?l.push({name:a("element.frame.delete"),func:function(){return n.deleteSelf()}}):l.push({name:a("element.delete"),func:function(){return i.deleteSelected()}})),l}),[n.supportZindex,n.copyLink,a,n.frameHided]),c=e.useRef(null);return e.useEffect((function(){var e=c.current;if(e){_e.isHoverSupported||(e.style.overflow="auto");var t=function(){e.style.overflow="auto"},n=function(){e.style.overflow="hidden"};return e.addEventListener("mouseenter",t),e.addEventListener("mouseleave",n),function(){e.removeEventListener("mouseenter",t),e.removeEventListener("mouseleave",n)}}}),[]),e.useEffect((function(){_e.desktop||(c.current.style.maxHeight=.7*window.innerHeight+"px")}),[]),e.createElement("div",{className:Eh.ctrl_list,id:"editor_ctx_menu",ref:c},l.map((function(t,n){if(t.renderer){var i=t;return e.createElement(i.renderer,exports.E({key:i.name},i.data,{className:j(Ml.bling_item,Eh.ctrl_option)}))}var o=t;return"divider"===o.name?e.createElement("div",{className:Eh.divider,key:o.name+n}):e.createElement("div",{key:o.name,className:j(Ml.bling_item,Eh.ctrl_option,o.disabled&&Eh.disabled),onPointerDown:function(e){return e.preventDefault()},onPointerUp:function(e){e.preventDefault(),o.disabled||(o.func(),o.noHide||null==r||r())}},o.name)})))};function Wg(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=e.useMemo((function(){if(!i)return[];var e=i.upime,t=i.editor,n=t.editable&&!t.isHandMode,o=t.getElements(),a=[];if(1===o.length&&o[0].elementType===Za.MINDMAP_NODE){var s=o[0].children;s.length&&(s.some((function(e){return e.isMindmapNodeHideByCollapsed}))?a.push({name:r("mindmap.expand.all"),func:function(){t.expandAllChildren()}}):a.push({name:r("mindmap.collapse.all"),func:function(){t.collapseAllChildren()}}))}return"function"==typeof t.copyLink&&a.push({name:r("link.copy"),func:t.copyLink}),n&&!t.frozed&&"function"==typeof t.frozeElement&&t.supportFrozeLock&&a.push({name:r("element.lock"),func:function(){return t.frozeElement()}}),n&&t.supportZindex&&a.push({name:r("element.bringToFront"),func:function(){return t.bringToFront()}},{name:r("element.sendToBack"),func:function(){return t.sendToBack()}}),!t.frameHided&&n&&a.push({name:r("element.clone"),func:function(){return e.cloneSelectedEles()}}),n&&!t.frozed&&(1===o.length&&o[0].elementType===Za.FRAME?(a.push({name:r("element.frame.delete"),func:function(){return t.deleteSelf()}}),a.push({name:r("element.delete"),func:function(){return e.deleteSelected()},danger:!0})):a.push({name:r("element.delete"),func:function(){return e.deleteSelected()},danger:!0})),a}),[null==i?void 0:i.editor.supportZindex,null==i?void 0:i.editor.copyLink,r,null==i?void 0:i.editor.frameHided]);return i?e.createElement("div",{className:Eh.menu_phone_container},o.map((function(t,i){return e.createElement("div",{className:j(Eh.menu_phone_row,t.danger&&Eh.danger),key:i,onClick:function(){return t.func(),void n()}},t.name)}))):null}var Vg=function(t){var n=t.icon,i=t.onClick,r=t.tip,o=t.className,a=t.disabled,s=void 0!==a&&a,l=t.popOverConfig,c=e.createElement(Dl,{placement:"top",content:r},e.createElement("div",{className:j(Ml.cm_item,s&&Ml.disabled)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:i},e.createElement(hl,{icon:n}))));return e.createElement("div",{className:j(Eh.property_editor,o)},l?e.createElement(Nh,exports.E({},l),c):c)},jg=function(t){var n=t.upime,i=W().getUpimeTrans;return e.createElement(Vg,{icon:"shanchu",tip:i("element.delete"),onClick:function(){return n.deleteSelected()},className:Eh.delIconBtn})},Gg=function(t){var n=t.upime,i=W().getUpimeTrans;return e.createElement(Vg,{icon:"kelong",tip:i("element.clone"),onClick:function(){return n.cloneSelectedEles()},className:Eh.cloneIconBtn})},qg=function(t){var n=t.editor,i=t.upime,r=t.className,o=void 0===r?"":r,a=t.hidden,s=e.useContext(Ic).phoneLayout,l=yh(!0,{quick:!0}),c=l.hide,u=l.setHide,d=l.toggleHide,p=l.skipRef,h=W().getUpimeTrans;return e.useEffect((function(){a&&u(!0)}),[a]),e.useEffect((function(){var e=i.subscribe("contextMenuOpened",(function(){u(!0)}));return function(){e()}}),[]),s?e.createElement(Kg,{editor:n,upime:i}):e.createElement("div",{className:j(o,Eh.property_editor),ref:p},e.createElement(Dl,{placement:"top",content:h("element.more")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:j(Ml.propEditorIconBox,Eh.more_ctrl,Ml.moreIcon,!c&&Ml.active),onClick:d},e.createElement(hl,{icon:"gengduo"})))),!c&&!a&&e.createElement(xh,{align:"left",selfAdjust:!0},e.createElement("div",{className:Eh.subwindow_box},e.createElement(Ug,{editor:n,upime:i,hideMenuCB:function(){return u(!0)}}))))},Kg=function(t){var n=t.editor,i=t.upime;return e.createElement("div",{className:Eh.property_editor},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:j(Ml.propEditorIconBox,Eh.more_ctrl,Ml.moreIcon),onClick:function(){i.showWindow(Wg,{upime:i,editor:n},void 0,!0,{type:"drawer"})}},e.createElement(hl,{icon:"gengduo"}))))},Yg=function(t){var n,i,r,o=t.children,a=t.editor,s=e.useState(0),l=s[0],c=s[1],u=e.useState(!1),d=u[0],p=u[1],h=e.useState(!1),f=h[0],m=h[1],v=e.useRef(void 0),g=e.useRef(null),y=e.useRef(null),b=e.useState({}),E=b[0],x=b[1],w=e.useContext(xl).upime;sl(w,(function(){T()}),["meetingMode"]);var C,S,k=e.useContext(Ic).phoneElementSubBarContainer,_={transform:"translateX(".concat(-l,"px)")};function T(){if(y.current){var e=y.current.getBoundingClientRect();x({left:"".concat(e.left,"px"),width:"".concat(e.width,"px"),top:"".concat(e.top,"px"),height:"".concat(e.height,"px")})}}e.useEffect((function(){c(0),m(!1)}),[null===(n=g.current)||void 0===n?void 0:n.clientWidth]),e.useEffect((function(){var e,t;y.current&&g.current&&p((null===(e=y.current)||void 0===e?void 0:e.clientWidth)<(null===(t=g.current)||void 0===t?void 0:t.clientWidth))}),[null===(i=y.current)||void 0===i?void 0:i.clientWidth,null===(r=g.current)||void 0===r?void 0:r.clientWidth]),S=T,e.useEffect((function(){if(C.current){var e=new ResizeObserver(S);return e.observe(C.current),window.addEventListener("resize",S),function(){e.disconnect(),window.removeEventListener("resize",S)}}}),[(C=y).current]);var I=a.editable&&!a.isHandMode&&a.supportFullCommonOp,P=a.supportMoreCtrl,N=d&&(I||P);return e.createElement("div",null,e.createElement("div",{className:j(Eh.phoneToolbarEditorContainer,_e.isPwa&&Eh.pwa,w.meetingMode&&Eh.inMetting)},e.createElement("div",{className:Eh.phoneToolbarBar,ref:y,onTouchMove:function(e){if(y.current&&V(y.current,e.target)){var t=e.touches[0].clientX;if(void 0!==v.current){var n=v.current-t;v.current=t,c((function(e){var t,i,r=e+n,o=(null===(t=y.current)||void 0===t?void 0:t.getBoundingClientRect().width)||0,a=((null===(i=g.current)||void 0===i?void 0:i.getBoundingClientRect().width)||0)-o;return Math.max(Math.min(r,a),0)})),m(!0)}else v.current=t}},onTouchEnd:function(){v.current=void 0}},e.createElement("div",{className:Eh.phoneToolBarInner,ref:g,style:_},o),N&&e.createElement("div",{className:j(Eh.extraBtWrapper,f&&Eh.hide)},e.createElement("div",{className:Eh.extraBtContainer},I&&e.createElement(e.Fragment,null,e.createElement(Gg,{upime:w}),e.createElement(jg,{upime:w})),P&&e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.split_line}),e.createElement(qg,{editor:a,upime:w,hidden:!1})))))),e.createElement("div",{style:E,className:Eh.shadowBar},e.createElement("div",{className:Eh.phoneToolbarSubWindowEditorContainer,ref:k,style:{left:"max(calc(-50vw + 50% + 12px), calc(50% - 300px))",right:"max(calc(-50vw + 50% + 12px), calc(50% - 300px))"}})))},Xg=function(n){var i=n.children,r=e.useContext(Ic),o=r.phoneElementSubBarContainer;return r.phoneLayout?t.createPortal(e.createElement(e.Fragment,null,i),o.current):e.createElement(e.Fragment,null,i)},Qg=function(t){var n=t.children,i=t.className;return e.useContext(Ic).phoneLayout?e.createElement("div",{className:i},n):e.createElement(e.Fragment,null,n)},Zg=e.createContext({disableAutoHide:function(){return""},enableAutoHide:function(){return""}});function Jg(e,t,n){void 0===n&&(n=function(){return!1});var i=t.elementManager.getAllElements().filter((function(e){return!n(e)})),r=i.map((function(e){return e.getGlobalBox()}));if(0===r.length)return[!1,e];for(var o=0;o<6;o++)for(var a=$g(o,e),s=function(e){var t=a[e];if(r.every((function(e){return!Kt(e,t)})))return{value:[0!==o,t]}},l=0;l<a.length;l++){var c=s(l);if("object"==typeof c)return c.value}return[!1,e]}function $g(e,t){if(0===e)return[exports.E({},t)];for(var n=t.right-t.left,i=t.bottom-t.top,r=exports.E(exports.E({},t),{left:t.left-e*n,right:t.right-e*n,top:t.top-e*i,bottom:t.bottom-e*i}),o=Array(2*e).fill(0).map((function(e,t){return exports.E(exports.E({},r),{left:r.left+(t+1)*n,right:r.left+(t+2)*n})})),a=o[o.length-1]||r,s=Array(2*e).fill(0).map((function(e,t){return exports.E(exports.E({},a),{top:a.top+(t+1)*i,bottom:a.top+(t+2)*i})})),l=s[s.length-1]||a,c=Array(2*e).fill(0).map((function(e,t){return exports.E(exports.E({},l),{left:l.left-(t+1)*n,right:l.left-t*n})})),u=c[c.length-1]||l,d=Array(2*e).fill(0).map((function(e,t){return exports.E(exports.E({},u),{top:u.top-(t+1)*i,bottom:u.top-t*i})})),p=R(R(R(R([],s,!0),c,!0),d,!0),o,!0),h=0;h<e-1;h++){var f=p.shift();f&&p.push(f)}return p}function ey(e,t){return A(this,void 0,void 0,(function(){function n(){return A(this,void 0,void 0,(function(){var e,n,i,r;return D(this,(function(o){switch(o.label){case 0:return e=p.responseText,n=e.split("\n").slice(m).filter(Boolean).map((function(e){return oa(e)})).filter(Boolean),m+=n.length,i=n.map((function(e){return e.data.frameId?exports.E(exports.E({},e),{data:exports.E(exports.E({},e.data),{frameId:void 0})}):e})),[4,t.useElementsInfo(i,{x:d.left,y:d.top},{autoSelect:!1,scaleView:!0})];case 1:return(r=o.sent())?(f.push.apply(f,r),n.forEach((function(e,n){var i=r[n];if(i&&(h.set(e.id,i.id),e.data.frameId)){var o=h.get(e.data.frameId);if(o!==i.frameId){var a=t.createOperation();a.update(i,{frameId:o}),a.sync(),t.deleteOperation(a)}}})),[2]):[2]}}))}))}function i(){if(t.onAiGenerteEnd(),t.addToast(O("ai.using.done")),f.length>0){var e=f,n=e.map((function(e){return e.getGlobalBox()}));t.selectElements(e);var i=Yt(n);t.makeBorderCenter(i,ty(t))}}var r,o,a,s,l,c,u,d,p,h,f,m,v,g=this;return D(this,(function(y){switch(y.label){case 0:return t.isUsingAi?[2]:(r=t.aiServerHelper)?(t.isUsingAi=!0,o=!1,t.aiAborter=function(){o=!0},[4,r.generatePPT(e)]):[2];case 1:return a=y.sent(),o||(s=t.view.getViewbox(),l=s.left+(s.right-s.left)/2,c=s.top+(s.bottom-s.top)/2,u=Jg({left:l,right:l+21600,top:c,bottom:c+540},t),d=u[1],p=a.getXhr(),h=new Map,f=[],m=0,v=void 0,p.onprogress=function(){o||v||(v=new Ks,n().finally((function(){null==v||v.done(!0),v=void 0})))},a.result.then((function(){return A(g,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return o?[2]:v?[4,v.result]:[3,3];case 1:return e.sent(),o?[2]:[4,n()];case 2:return e.sent(),i(),[3,5];case 3:return[4,n()];case 4:e.sent(),i(),e.label=5;case 5:return[2]}}))}))})).catch((function(){o||(t.onAiGenerteEnd(),t.addToast(O("ai.error")))}))),[2]}}))}))}function ty(e,t){void 0===t&&(t=!1);var n=.2*e.view.viewWidth,i=.2*e.view.viewHeight;return t?{left:n,right:n,top:.1*e.view.viewHeight,bottom:.75*e.view.viewHeight,duration:500}:{left:n,right:n,top:i,bottom:i,duration:500}}var ny=function(){function e(e){this.name=e,this.type="value"}return e.prototype.getInitData=function(){return this.data},e.prototype.updateData=function(e){var t;null===(t=this.onchange)||void 0===t||t.call(this,e),this.data=e},e}(),iy=function(){function e(e,t){this.name=e,this.richTextClient=t,this.type="weakOt"}return e.prototype.bindClient=function(e){if(this.richTextClient=e,this.tempData){var t=this.tempData,n=t.version,i=t.content;e.initContent(i),e.version=n,this.tempData=void 0}},e.prototype.getInitData=function(){if(this.richTextClient)return{version:this.richTextClient.version,content:this.richTextClient.content}},e.prototype.updateData=function(e){var t=this.richTextClient,n=e.version,i=e.baseVersion,r=e.content;t?void 0!==i?t.dealWeakOt({version:n,baseVersion:i,content:r}):(t.initContent(r),t.version=n):this.tempData?this.tempData={version:n,content:Is(this.tempData.content,r)}:this.tempData={version:n,content:r}},e}(),ry=function(e){function t(t,n){var i=e.call(this)||this;return i.upime=t,i.id=n,i.elementType=Za.LINE,i.stable=!1,i.deleted=!1,i._position={x:0,y:0},i.zIndex=0,i.size={width:0,height:0},i.frameId=null,i.groupId=null,i.frozedGroupId=null,i.originId=null,i.attachedComments=[],i.link=null,i.editorType=Lb,i.renderer=function(){return null},i.showInParentShadow=!1,i.showAttachComment=!1,i.showSelected=!1,i.eleHided=!1,i.renderInView=!1,i.unsubs=[],i.eventManager=new ro,i._rotate=0,i.borderBox=Fe,i.borderBoxChanged=!1,i.globalBorderBox=Fe,i.globalBoxChanged=!1,i.bypassStableInterActCheck=!1,i.scale=1,i.selectStatus="",i.isLocked=!1,i.hoverLink=!1,i.innerWidgets=[],i.parentRefSystem=null,i.selfRefSystem=null,i.customProperties=[],i.indexPath=[],i.renderKey="element-"+n,i}return P(t,e),t.prototype.render=function(){},Object.defineProperty(t.prototype,"minVisibleSize",{get:function(){return.5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalTransform",{get:function(){var e;return(null===(e=this.parentRefSystem)||void 0===e?void 0:e.globalTransform)||sr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportCopy",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this.supportRotate&&(this._rotate=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mounted",{get:function(){return this.checkMounted()},enumerable:!1,configurable:!0}),t.prototype.checkMounted=function(){var e;return!!(null===(e=this.parentRefSystem)||void 0===e?void 0:e.mounted)},Object.defineProperty(t.prototype,"inGlobalRs",{get:function(){return this.parentRefSystem===this.upime.view.elementsRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refSystemLevel",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locked",{get:function(){return this.isLocked},set:function(e){this.isLocked=e,this.group&&(this.group.locked=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groupLocked",{get:function(){return!!this.group&&this.group.locked},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unavailable",{get:function(){return this._checkUnAvailable()},enumerable:!1,configurable:!0}),t.prototype._checkUnAvailable=function(){return this.locked||this.groupLocked||!1},Object.defineProperty(t.prototype,"hideByFrame",{get:function(){var e;return(null===(e=this.frame)||void 0===e?void 0:e.hide)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportSelected",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportFrame",{get:function(){return!this.stable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportComment",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getCustomProperty=function(e,t){var n=this.customProperties.find((function(t){return t.name===e}));return n||(n="weakOt"===t?new iy(e):new ny(e),this.customProperties.push(n)),n},t.prototype.updateIndexPath=function(){for(var e=[this.zIndex],t=this.parentRefSystem;t&&(e.unshift(t.zIndex),(t=t.parentRefSystem)!==this.upime.view.elementsRoot););this.indexPath=e},t.prototype.onAdd=function(){this.updateLinkIconSource(),this.bindRefSystem(this.position)},t.prototype.onDelete=function(){var e;this.linkSource=void 0,null===(e=this.parentRefSystem)||void 0===e||e.removeElement(this),this.unsubs.forEach((function(e){return e()})),this.unsubs=[],this.currentTipWidget&&(this.upime.view.clearTip(this.currentTipWidget),this.currentTipWidget=void 0),this.publish("elementDeleted",this)},t.prototype.destroy=function(){this.unsubs.forEach((function(e){return e()})),this.unsubs=[],this.currentTipWidget&&(this.upime.view.clearTip(this.currentTipWidget),this.currentTipWidget=void 0)},t.prototype.unmounRefSystem=function(e){e.parentRefSystem&&(e.mounted&&this.upime.publish("refSystemWillUnmount",e),e.parentRefSystem.removeChildRS(e))},t.prototype.bindRefSystem=function(e){this.upime.elementManager.getRefSystem(e).addElement(this)},t.prototype.updatePosition=function(e){this.position=e,this.deleted||this.bindRefSystem(this.position)},t.prototype.updateLinkIconSource=function(){if(this.link&&!this.deleted){var e=this.link;if(!this.linkSource||this.linkSource.id!==e){var t=tr("");t.id=e,this.linkSource=t,this.loadLinkSource(t)}}else this.linkSource=void 0},t.prototype.loadLinkSource=function(e){var t=$o("link_to.png");this.linkSource===e&&(e.imgSrc=t,er(e))},t.prototype.gotoAnchorLink=function(e){this.richTextClient&&this.hoveringTextAnchor&&(this.richTextClient.contentEditor.clearAnchorEditor(),this.hoveringTextAnchor=void 0),this.upime.gotoLink(e)},t.prototype.startEditAnchor=function(){this.isSingleSelected()||(this.hoveringTextAnchor=void 0,this.applySelectSelf())},t.prototype.dealClickStart=function(e){var t,n,i;if(null===(t=e.metaData)||void 0===t?void 0:t.clickData){var r=e.metaData.clickData,o=r.onLink,a=r.editText,s=r.textAnchor,l=r.widgetData,c=r.doubleClick,u=r.mentionStartIndex,d=r.customData;if(l){var p=l,h=this.getInnerWidget(p.name);null==h||h.dealClick(p)}else if(o)this.upime.clearSelect(),this.upime.gotoLink(this.link||"");else if(void 0!==s||void 0!==u)this.dealRichTextClick({textAnchor:s,mentionStartIndex:u});else if(void 0!==a)this.dealEditTextClick(a);else if(c)null===(n=this.dealDoubleClick)||void 0===n||n.call(this);else if(function(e){var t;return"childClickData"===(null===(t=e)||void 0===t?void 0:t.type)}(d)){var f=d.childId,m=null===(i=this.childElements)||void 0===i?void 0:i.find((function(e){return e.id===f}));null==m||m.dealClickStart(e)}}},t.prototype.openTextMenu=function(e){var t=this;if(this.richTextClient){var n=new Kh(this.upime,e,(function(){return t.upime.view.removeContextMenu()}));n.textEditor=this.richTextClient.contentEditor,this.upime.view.addContextMenu(n)}},t.prototype.dealEditTextClick=function(e){if(this.richTextClient){var t=e.position,n=e.type;if("contextMenu"!==n){var i=this.richTextClient.contentEditor;this.isEditingSelf()?("word"===n?i.pickWordAtPosition(t):"all"===n?i.pickLineAtPosition(t):i.moveCursorToPosition(t),this.upime.updateView()):this.applyEditText(i,t)}else this.openTextMenu(t)}},t.prototype.applySelectSelf=function(){return this.upime.selectElement(this)},t.prototype.applyEditText=function(e,t){var n="single"===this.selectStatus?this.currentEditor:void 0;n||(n=this.applySelectSelf());var i=n.editingEditor;i!==e&&(i?(n.stopEdit(),n.connectTextEditor(e)):(n.connectTextEditor(e),n.startEdit(),e.moveCursorToPosition(t)))},t.prototype.dealRichTextClick=function(e){var t,n=e.textAnchor,i=e.mentionStartIndex;void 0!==n?(this.upime.clearSelect(),this.gotoAnchorLink(n.link||"")):void 0!==i&&(this.upime.clearSelect(),null===(t=this.richTextClient)||void 0===t||t.contentEditor.selectMention(i))},t.prototype.dealRichTextHoverStart=function(e){var t,n=e.textAnchor,i=e.mentionStartIndex;void 0!==n?(this.upime.view.setCursor("pointer",this),this.richTextClient.contentEditor.checkAnchorLink(n.startIndex),this.hoveringTextAnchor=n):void 0!==i&&(this.upime.view.setCursor("pointer",this),null===(t=this.richTextClient)||void 0===t||t.contentEditor.hoverMention(i),this.hoveringMentionStartIndex=i)},t.prototype.dealRichTextHoverEnd=function(){var e;this.richTextClient&&this.hoveringTextAnchor&&(this.richTextClient.contentEditor.clearAnchorEditor(),this.hoveringTextAnchor=void 0),void 0!==this.hoveringMentionStartIndex&&(null===(e=this.richTextClient)||void 0===e||e.contentEditor.unHoverAllMention(),this.hoveringMentionStartIndex=void 0)},t.prototype.dealHoverStart=function(e){var t,n;if(null===(t=e.metaData)||void 0===t?void 0:t.clickData){var i=e.metaData.clickData,r=i.onLink,o=i.textAnchor,a=i.widgetData,s=i.mentionStartIndex,l=i.editText;if(r){this.upime.view.setCursor("pointer",this);var c=this.getBorderBox(),u=this.upime.view.getScreenPosition({x:c.right,y:c.top});this.upime.linkHover(!0,u,null!==(n=this.link)&&void 0!==n?n:""),this.hoverLink=!0}else if(void 0!==o||void 0!==s)this.dealRichTextHoverStart({textAnchor:o,mentionStartIndex:s});else if(l)this.upime.view.setCursor("text",this),this.upime.updateView();else if(void 0!==a){var d=a.cursor||"pointer";this.upime.view.setCursor(d,this),this.hoveringWidget=this.getInnerWidget(a.name),this.hoveringWidget.dealHoverStart(a),this.upime.updateView()}}},t.prototype.dealHoverEnd=function(){this.hoverLink&&(this.upime.linkHover(!1,{x:0,y:0},""),this.hoverLink=!1),this.hoveringWidget&&(this.hoveringWidget.dealHoverEnd(),this.hoveringWidget=void 0),this.dealRichTextHoverEnd(),this.upime.view.setCursor("",this)},t.prototype.dealSelectCtrlEvt=function(e){},t.prototype.showWidgetTip=function(e,t,n){var i=this.getBorderBox();n.x+=i.left,n.y+=i.top,n=this.globalTransform.apply(n),n=this.upime.view.getScreenPosition(n),this.upime.view.setTip(t,n,e),this.currentTipWidget=e},t.prototype.clearWidgetTip=function(e){this.upime.view.clearTip(e),this.currentTipWidget===e&&(this.currentTipWidget=void 0)},t.prototype.checkUpdateMoved=function(e){return!(!e.position&&!e.rotate)},t.prototype.checkUpdateEffect=function(e){for(var t,n=this,i=this.parentRefSystem||this.upime.view.elementsRoot,r=!1,o=0,a=e;o<a.length;o++){var s=a[o].element;if(i.isInRefSystemOfElement(s)){r=!0;break}}var l=null===(t=e.find((function(e){return e.element===n})))||void 0===t?void 0:t.update;return l?{moved:r=r||this.checkUpdateMoved(l),deleted:!0===l.deleted}:r?{moved:r,deleted:!1}:null},t.prototype.getBorderBox=function(){return this.borderBoxChanged&&(this.borderBox=this.calcBorderBox(),this.borderBoxChanged=!1),this.borderBox},t.prototype.getGlobalBox=function(){return this.globalBoxChanged&&(this.globalBorderBox=this.calcGlobalBox(),this.globalBoxChanged=!1),this.globalBorderBox},t.prototype.checkBorderBoxUpdate=function(e){return!(!e.position&&!e.size&&void 0===e.scale&&void 0===e.rotate)},t.prototype.updateBorderBox=function(){this.borderBoxChanged=!0,this.mounted&&this.updateGlobalBorderBox()},t.prototype.updateGlobalBorderBox=function(){var e;this.globalBoxChanged=!0,this.upime.updateMapPicture(),null===(e=this.childElements)||void 0===e||e.forEach((function(e){return e.updateTransform()})),this.publish("elementBorderBoxUpdated",this)},t.prototype.updateRenderingState=function(){},t.prototype.updateTransform=function(){this.updateGlobalBorderBox()},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y;return{left:t,top:n,right:t,bottom:n,rotate:0}},t.prototype.calcGlobalBox=function(){var e=this.getBorderBox(),t=this.parentRefSystem;return t&&"global"!==t.id&&(e=t.globalTransform.applyBorderBox(e)),e},t.prototype.calcTransformedUpdate=function(e){if(this.parentRefSystem===e)return{};var t=this.globalTransform,n=e.globalTransform,i=t.append(n.invert()),r=Lt(this.getBorderBox()),o=xn(this.position,r),a=En(i.apply(r),wn(o,i.currentScale));return{position:exports.E(exports.E({},a),e.getRelateInfo()),scale:this.scale*i.currentScale,rotate:(this.rotate+i.rotateDeg)%360}},t.prototype.checkSelectRelation=function(e,t){var n=e,i=this.getBorderBox();if(0!==this.rotate){var r=i.left,o=i.top,a=i.right,s=i.bottom;e=an(e,-this.rotate,{x:(r+a)/2,y:(o+s)/2})}var l=this.checkInteractRelation(e,t);return l||(this.checkChildElementRelation(n,t)||this._checkSelectRelation(e,t))},t.prototype.checkRichTextHoverClick=function(e,t){var n=this.richTextClient;if(n){var i=t.type;if("click"===i){var r=t.evt;if(r.longPress||"right"===r.connectType)return}var o=n.contentEditor,a=o.anchorEditor,s=a&&(a.editing||a.isAdd);if(a&&this.hoveringTextAnchor&&"hover"===i&&Ot(t.evt.globalPosition,o.getAnchorEditorGlobalBorder(a),8))return{textAnchor:this.hoveringTextAnchor,mobileHover:_e.mobile};var l=n.getTextRelation(e,!0),c=l.point,u=c.x,d=c.y,p=l.textWidth,h=l.textHeight;if(!(u<0||u>=p||d<0||d>=h)){if(!this.currentEditor&&!s||!this.upime.editable&&"click"===i){var f=o.getAnchorByPosition({x:u,y:d+o.scrollTop});if(f){if(!_e.mobile)return{textAnchor:f,mobileHover:!1};if(!this.hoveringTextAnchor||this.hoveringTextAnchor.startIndex!==f.startIndex)return{textAnchor:f,mobileHover:this.upime.editable}}}var m=o.checkIsPointInMention({x:u,y:d+o.scrollTop});if(m||0===m){if("hover"===i)return{mentionStartIndex:m,mobileHover:!1};if("click"===i){var v=o.activeMentionTarget;if(!v||m<v.startIndex||m>=v.endIndex)return{mentionStartIndex:m,mobileHover:!1}}}}}},t.prototype.isSingleSelected=function(){return void 0!==this.currentEditor&&"single"===this.selectStatus},t.prototype.isEditingSelf=function(){return void 0!==this.currentEditor&&void 0!==this.richTextClient&&this.currentEditor.editingEditor===this.richTextClient.contentEditor},t.prototype.isFrozed=function(){return void 0!==this.frozedGroup},t.prototype.hasGroup=function(){return void 0!==this.group&&this.group.members.length>1},t.prototype.checkPointCanEdit=function(e,t,n){return!0},t.prototype.checkTextEdit=function(e,t){if(this.isFrozed())return null;var n=this.richTextClient;if(!n)return null;var i=n.getTextRelation(e,!0),r=i.point,o=i.textWidth,a=i.textHeight,s=this.isSingleSelected(),l=this.isEditingSelf(),c={selectingText:!0},u="select"===this.upime.xmode;if(!s||!u)return!this.hasGroup()&&this.upime.editable&&"click"===t.type&&t.evt.Hits>=2?(c.clickData={editText:{position:r}},c):null;if(!l)return"click"===t.type&&this.checkPointCanEdit(r,o,a)?(c.clickData={editText:{position:r}},c):null;var d=r.x,p=r.y;if(d<0||d>=o||p<0||p>=a)return null;if("move"===t.type)return c.selectingText=!0,c;if("click"===t.type){var h=t.evt;return"right"===h.connectType?c.clickData={editText:{position:t.evt.globalPosition,type:"contextMenu"}}:c.clickData={editText:{position:r,type:1===h.Hits?void 0:2===h.Hits?"word":"all"}},c}return"hover"===t.type?(c.clickData={editText:{position:r}},c):null},t.prototype.checkChildElementRelation=function(e,t){var n=this.childElements;if(null==n?void 0:n.length)for(var i=0,r=n;i<r.length;i++){var o=r[i].checkSelectRelation(e,t);if(o)return o}return null},t.prototype.checkInteractRelation=function(e,t){if(!t||!this.bypassStableInterActCheck&&this.stable)return null;var n=t.type;if("click"==n||"hover"===n||"move"===n){var i=this.getBorderBox();if(!Ot(e,i))return null;for(var r=0,o=this.innerWidgets;r<o.length;r++){var a=o[r].checkRelation({x:e.x-i.left,y:e.y-i.top},t);if(a)return{transparent:!1,metric:-1,metaData:{clickData:{widgetData:a}}}}if(null!==this.link){var s=this.upime.view.scale,l=Ot(e,Bt(this.getLinkRect(s)));if(l)return{transparent:!1,metric:-1,metaData:{clickData:{onLink:l}}}}var c=this.checkRichTextHoverClick(e,t);if(c){var u=c.textAnchor,d=c.mobileHover,p=c.mentionStartIndex;if(void 0!==u)return{transparent:!1,metric:-1,metaData:{clickData:{textAnchor:u,mobileHover:d}}};if(void 0!==p)return{transparent:!1,metric:-1,metaData:{clickData:{mentionStartIndex:p,mobileHover:d}}}}var h=this.checkTextEdit(e,t);if(h)return{transparent:!1,metric:-1,metaData:h};if(this.dealDoubleClick&&"click"===t.type&&2===t.evt.Hits)return{transparent:!1,metric:-1,metaData:{clickData:{doubleClick:!0}}}}return null},t.prototype._checkSelectRelation=function(e,t){var n=this.getBorderBox(),i=n.left,r=n.top,o=n.right,a=n.bottom,s=this.globalTransform.currentScale,l=e.x,c=e.y;return l>=i&&l<=o&&c>=r&&c<=a?{transparent:!1,metric:(o-i)*(a-r)*s*s}:null},t.prototype.dealUpdate=function(e){var t=e.link,n=e.position,i=e.cps,r=N(e,["link","position","cps"]);if(void 0!==t&&t!==this.link&&(this.link=t,this.updateLinkIconSource()),i)for(var o=0,a=i;o<a.length;o++){var s=a[o],l=s[0],c=s[1],u=s[2];this.getCustomProperty(l,c).updateData(u)}for(var d in r){var p=e[d],h="_update_".concat(d);"function"==typeof this[h]?this[h](p):this[d]=p}n&&this.updatePosition(n)},t.prototype.getLinkRect=function(e){e*=this.globalTransform.currentScale;var t=this.getBorderBox(),n=t.left,i=t.top,r=t.right,o=r-n,a=t.bottom-i,s=Math.min(o*e,a*e),l=0,c=4;if(s>=50)l=24;else if(s>=20){var u=50-s;l=24-u/2,(c=4-u/6)<=0&&(c=0)}else l=0;return{x:r-(c+l)/e,y:i+c/e,width:l/e,height:l/e}},t.prototype.checkUpdateView=function(e,t){return this.checkVisible(e)},t.prototype.checkVisible=function(e){if(this.eleHided)return!1;var t=this.getGlobalBox(),n=this.minVisibleSize;return!((t.right-t.left)*e.scale<n||(t.bottom-t.top)*e.scale<n)&&Kt(t,t.rotate?kn(e,-t.rotate,Lt(t)):e)},t.prototype.checkVisibleInRS=function(e){var t=this.getBorderBox();return Kt(t,t.rotate?kn(e,-t.rotate,Lt(t)):e)},t.prototype.addInnerWidget=function(e){this.innerWidgets.push(e)},t.prototype.getInnerWidget=function(e){return this.innerWidgets.find((function(t){return t.name===e}))},t.prototype.removeInnerWidget=function(e){this.innerWidgets=this.innerWidgets.filter((function(t){return t!==e}))},t.prototype.onRemove=function(){},t.prototype.onRestore=function(){this.publish("elementRestored",this)},t.prototype.onFrozed=function(){},t.prototype.onUnRender=function(){this.clearMemo("offscreenTextCanvas")},t.prototype.getLinkToElement=function(){return this},t.prototype.subscribe=function(e,t){return this.eventManager.subscribe(e,t)},t.prototype.once=function(e,t){return this.eventManager.once(e,t)},t.prototype.publish=function(e,t){return this.eventManager.publish(e,t)},t.prototype.searchText=function(e){var t,n;if(e=e.toLowerCase(),this.richTextClient){var i=this.richTextClient.chars.join("");if(null===(t=i.toLowerCase())||void 0===t?void 0:t.includes(e))return i}var r=this.name;return r&&(null===(n=r.toLowerCase())||void 0===n?void 0:n.includes(e))?r:""},t.prototype.calcRenderBox=function(){return this.getGlobalBox()},t}(el),oy=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAttachedPointInElement=!1,t.adsorptionPoints=[],t.attachedPoint=null,t.showAdsorptionPoints=!1,t.showAttachedOnsideShadow=!1,t.editorType=Ob,t.connectionLines=new Map,t}return P(t,e),Object.defineProperty(t.prototype,"lineConnected",{get:function(){var e=this.connectionLines,t=0;return e.forEach((function(e){e.deleted||t++})),t>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderWidth",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transparent",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectSensitivation",{get:function(){return 8},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.globalTransform.currentScale,t=this.getBorderBox(),n=t.left,i=t.top;return(t.right-n)*(t.bottom-i)*e*e},t.prototype.attach=function(e,t){this.connectionLines.set(e,t)},t.prototype.detach=function(e){this.connectionLines.delete(e)},t.prototype.updateBorderBox=function(){e.prototype.updateBorderBox.call(this),this.updateConnectionLines()},t.prototype.updateTransform=function(){var t=this;e.prototype.updateTransform.call(this),this.connectionLines.forEach((function(e){e.parentRefSystem!==t.parentRefSystem&&e.handleAttachedElementChanged()}))},t.prototype.updateAdsorptionData=function(e){this.showAdsorptionPoints=e.showAdsorptionPoints,this.showAttachedOnsideShadow=e.showAttachedOnsideShadow,this.isAttachedPointInElement=e.isAttachedPointInElement,this.attachedPoint=e.attachedPoint,this.adsorptionPoints=e.adsorptionPoints,this.upime.view.update()},t.prototype.clearAdsorptionData=function(){this.showAdsorptionPoints=!1,this.showAttachedOnsideShadow=!1,this.isAttachedPointInElement=!1,this.attachedPoint=null,this.adsorptionPoints=[],this.upime.view.update()},t.prototype.updateConnectionLines=function(){this.connectionLines.forEach((function(e){e.handleAttachedElementChanged()}))},t.prototype.getAttachedProps=function(e,t){var n=this.getBorderBox(),i=n.left,r=n.top,o=n.right,a=n.bottom,s={x:e.x,y:e.y};switch(t){case"l":s={x:i,y:e.y};break;case"t":s={x:e.x,y:r};break;case"r":s={x:o,y:e.y};break;case"b":s={x:e.x,y:a}}var l=(s.x-i)/(o-i),c=(s.y-r)/(a-r);return{attachedElementId:this.id,attachedPointType:2,percentOffset:{x:l,y:c}}},t.prototype.getPointByPercentOffset=function(e,t){void 0===t&&(t=!1);var n=this.getBorderBox(),i=n.left,r=n.top,o=n.right,a=n.bottom,s=n.rotate,l={x:i+(o-i)*e.x,y:r+(a-r)*e.y};return s&&!t?an(l,s,{x:(i+o)/2,y:(r+a)/2}):l},t.prototype.getGlobalPointByPercentOffset=function(e,t){var n=(null==t?void 0:t.noRotate)||!1,i=this.getPointByPercentOffset(e,n);return this.globalTransform.apply(i)},t.prototype.getConnectionPointAngle=function(e,t){var n=0,i=e.x,r=e.y,o=yn(i,0),a=yn(r,0),s=yn(i,1),l=yn(r,1);return(o||a||s||l)&&(o?n=0:s&&(n=Math.PI),a?n=1.5*Math.PI:l&&(n=.5*Math.PI),3==t&&(o&&a?n=7*Math.PI/4:s&&a?n=5*Math.PI/4:s&&l?n=3*Math.PI/4:o&&l&&(n=Math.PI/4))),rn(n)},t.prototype.getAdsorptionPoints=function(){var e=this.getBorderBox(),t=e.left,n=e.top,i=e.right,r=e.bottom,o=(t+i)/2,a=(n+r)/2;return[{x:t,y:a},{x:o,y:n},{x:i,y:a},{x:o,y:r}]},t.prototype.getAttachedPoint=function(e,t){var n={x:e.x,y:e.y};if(t){var i=this.getBorderBox(),r=i.left,o=i.top,a=i.right,s=i.bottom;e.x<=r?n={x:r,y:e.y}:e.y<=o?n={x:e.x,y:o}:e.x>=a?n={x:a,y:e.y}:e.y>=s&&(n={x:e.x,y:s}),n={x:Math.min(Math.max(n.x,r),a),y:Math.min(Math.max(n.y,o),s)}}return n},t.prototype.checkPointPosition=function(e,t,n,i){var r,o=e.x,a=e.y,s=this.getBorderBox(),l=s.left,c=s.top,u=s.right,d=s.bottom,p=this.getOuterInnerSensitivation(i,t,n),h=p.outerInsideSensitivation,f=p.innerOnsideSensitivation;return{inside:r=o>=l-h&&a>=c-h&&o<=u+h&&a<=d+h,onside:r&&(o<=l+f||a<=c+f||o>=u-f||a>=d-f),onText:!1}},t.prototype.getOuterInnerSensitivation=function(e,t,n){var i=t,r=t;return e?(i=8/this.upime.view.scale/this.globalTransform.currentScale,r=0):t<n&&(i=0,r=n),{outerInsideSensitivation:i,innerOnsideSensitivation:r}},t.prototype.checkAttachedMeta=function(e,t,n){var i=this.getBorderBox(),r=this.getBorderBox(),o=r.left,a=r.top,s=r.right,l=r.bottom,c=8/this.upime.view.scale/this.globalTransform.currentScale,u=[],d=!1;Ot(e,i,10/this.upime.view.scale/this.globalTransform.currentScale)&&(d=!0,u=this.getAdsorptionPoints());for(var p=n,h=this.getAttachedPoint(e,p),f=0;f<u.length;f++){var m=u[f];if(Jt(e,m,c)){h=m,p=!0;break}}var v=p?2:t?1:0,g={};if(t){var y=(h.x-o)/(s-o),b=(h.y-a)/(l-a);g.attachedProps={attachedElementId:this.id,percentOffset:{x:y,y:b},attachedPointType:v}}return g.adsorptionData={showAdsorptionPoints:d,showAttachedOnsideShadow:p,isAttachedPointInElement:t&&!p,attachedPoint:t?h:null,adsorptionPoints:u},g},t.prototype._checkSelectRelation=function(e,t){var n,i,r=this.globalTransform,o=this.selectSensitivation/this.upime.view.scale/r.currentScale,a=this.checkPointPosition(e,o,this.borderWidth,"attach"===(null==t?void 0:t.type)),s=a.inside,l=a.onside,c=a.onText,u={transparent:!l&&this.transparent&&!c||"attach"===(null==t?void 0:t.type),metric:l||c?-1:this.getMetric()};if("attach"===(null==t?void 0:t.type)){var d=this.checkAttachedMeta(e,s,l);if(u.metaData=d,null===(n=null==d?void 0:d.adsorptionData)||void 0===n?void 0:n.showAdsorptionPoints)return 2===(null===(i=d.attachedProps)||void 0===i?void 0:i.attachedPointType)&&(u.transparent=!1,u.metric=-1),u}return s?u:null},Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return["l","t","r","b"]},enumerable:!1,configurable:!0}),t.prototype.checkConnectionRelation=function(e,t,n,i,r){var o;void 0===r&&(r=!1);var a=(null===(o=this.parentRefSystem)||void 0===o?void 0:o.globalTransform)||sr,s=this.upime.view.scale*a.currentScale;n/=s,t/=s;for(var l=this.getBorderBox(),c=l.left,u=l.top,d=l.right,p=l.bottom,h=(c+d)/2,f=(u+p)/2,m="",v={x:e.x,y:e.y},g={x:c-t,y:f},y={x:h,y:u-t},b={x:d+t,y:f},E={x:h,y:p+t},x=r?t-n:0,w={left:c-t-n,top:f-n,right:c-t+n+x,bottom:f+n},C={left:h-n,top:u-t-n,right:h+n,bottom:u-t+n+x},S={left:d+t-n-x,top:f-n,right:d+t+n,bottom:f+n},k={left:h-n,top:p+t-n-x,right:h+n,bottom:p+t+n},_=0;_<i.length;_++)switch(i[_]){case"l":Ot(e,w)&&(m="l",v=g);break;case"t":Ot(e,C)&&(m="t",v=y);break;case"r":Ot(e,S)&&(m="r",v=b);break;case"b":Ot(e,k)&&(m="b",v=E)}return m?{transparent:!1,metric:-1,metaData:{connectionData:{location:m,attachedProps:this.getAttachedProps(v,m)}}}:null},t.prototype.getConnectLineStyle=function(e){var t=this,n=3,i=void 0;if(this.connectionLines.forEach((function(r){if(!r.deleted&&r.startElement===t){var o=r.startPosition,a=o.x,s=o.y,l=Math.abs(a-e.x)+Math.abs(s-e.y);l<n&&(n=l,i=r)}})),!i)return null;var r=i;return{startArrow:r.startArrow,endArrow:r.endArrow,lineWidth:r.lineWidth,lineStyle:r.lineStyle,lineType:r.lineType,lineColor:r.lineColor}},t}(ry),ay=function(e,t){this.editor=e,this.element=t,this.couldAffectGroup=!0},sy=function(t){var n=t.isText,i=t.switchToText,r=t.switchToWebpage,o=W().getUpimeTrans;return e.createElement(e.Fragment,null,e.createElement(Dl,{placement:"top",content:o("webpage.toolbar.textMode")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:i,style:{color:n?"#2E73E5":"#303445"}},e.createElement(hl,{icon:"wenbenlianjie"})))),e.createElement(Dl,{placement:"top",content:o("webpage.toolbar.webpageMode")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:r,style:{color:n?"#303445":"#2E73E5"}},e.createElement(hl,{icon:"wangyechuangkou"})))))},ly=function(t){var n=t.propEditor.editor;return e.createElement(sy,{isText:!1,switchToText:function(){return n.switchToText()}})},cy=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.element=n,i.couldAffectGroup=!1,i.propertyName="webpageLinkMode",i.renderer=ly,i}return P(t,e),t}(ay),uy="btn_17KQi",dy="btn_wrapper_3GpT-",py="input_group_1HItO",hy="label_1HvdM",fy="input_1reWF",my="button_BS8i7",vy="selected_2_g7j",gy="row_uxoqO",yy="info_2NULQ",by="avatar_3Cyd_",Ey="userName_32xBe",xy="rest_GahhO",wy=function(){function e(e){var t=this;this.parent=e,this.text="",this.editable=!0,this.isAdd=!1,this.editing=!1,this.link="",this.start=0,this.end=0,this.position={x:0,y:0},this.lineHeight=0,this.renderer=Iy,this.canSwitchToWebpage=!1,this.startEdit=function(){t.editing=!0,t.parent.startEditAnchor()},this.deleteAnchor=function(){t.parent.startEditAnchor(),t.parent.deleteAnchor(t)},this.cancelAdd=function(){var e,n;null===(n=(e=t.parent).cancelAddAnchor)||void 0===n||n.call(e,t)},this.gotoLink=function(){t.parent.gotoAnchorLink(t)},this.cancelEdit=function(){t.parent.onAnchorCancelEdit(t)},this.renderKey="anchorEditor+"+Date.now()}return e.prototype.setAnchorUrl=function(e){e=oe(e),this.parent.setAnchorUrl(this,e)},e.prototype.changeAnchorTextAndUrl=function(e,t){e!==this.text?this.parent.changeAnchorTextAndUrl(this,e,t):this.setAnchorUrl(t)},e.prototype.switchToWebpage=function(){this.parent.switchToWebpage(this)},e.prototype.clear=function(){this.parent.anchorEditor===this&&this.parent.clearAnchorEditor()},e}();function Cy(){var t=e.useRef(null);return e.useEffect((function(){var e=t.current;if(e){var n=function(e){e.stopPropagation()};return e.addEventListener("mousemove",n),function(){e.removeEventListener("mousemove",n)}}}),[t.current]),t}var Sy,ky=function(t){var n=t.element,i=W().getUpimeTrans,r=Cy(),o=bl(),a=function(){var e=me(ge(o.value.trim()));o.setError(!e),e&&n.setAnchorUrl(o.value)},s=n.parent.getAnchorEditorGlobalBorder(n),l=s.left,c=s.top;return e.createElement("div",{className:"add_anchor_3mHnl",style:{transform:"translate(".concat(l,"px, ").concat(c,"px)")},ref:r},e.createElement(El,exports.E({className:"add_input_n9bTK"},o,{autoFocus:!0,onKeydown:function(e){"Enter"!==e.key||e.isComposing||(e.preventDefault(),a())},placeHolder:i("text.anchor.edit.placeholder"),validateUrl:!0,btnClsName:"addInputClearBtn"})),e.createElement("div",{className:"add_btns_1-y9z",onPointerDown:ie},e.createElement("div",{className:j(uy,!o.value&&"disable_3k8tZ"),onClick:a},i("common.save")),e.createElement("div",{className:uy,onClick:function(){n.cancelAdd()}},i("common.cancel"))))},_y=function(t){var n=t.element,i=W().getUpimeTrans,r=e.useContext(xl).upime,o=n.parent.getAnchorEditorGlobalBorder(n),a=o.left,s=o.top,l=Cy();return e.createElement("div",{className:"hover_anchor_2SjZq",style:{transform:"translate(".concat(a,"px, ").concat(s,"px)")},ref:l},n.editable&&n.canSwitchToWebpage?e.createElement("div",{className:j(dy,"switch_btn_group_16v5o")},e.createElement(sy,{isText:!0,switchToWebpage:function(){me(n.link)?n.switchToWebpage():r.addToast(i("text.anchor.switchToWebpage.error"),{autoHideTime:2e3,type:"normal"})}})):null,e.createElement("div",{className:j(dy)},e.createElement(Dl,{placement:"top",content:i("webpage.openLink")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:n.gotoLink},e.createElement(hl,{icon:"dakailianjie"}))))),n.editable?e.createElement("div",{className:j(dy,"edit_btn_group_24D_T")},e.createElement(Dl,{placement:"top",content:i("common.edit")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:function(){n.startEdit()}},e.createElement(hl,{icon:"bianji"})))),e.createElement(Dl,{placement:"top",content:i("hyperlink.discard")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:n.deleteAnchor},e.createElement(hl,{icon:"lianjieduankai"}))))):null)},Ty=function(t){var n=t.element,i=W().getUpimeTrans,r=bl(n.text),o=bl(n.link);function a(e){"Enter"!==e.key||e.isComposing||(e.preventDefault(),e.currentTarget.blur())}var s=Cy(),l=n.parent.getAnchorEditorGlobalBorder(n),c=l.left,u=l.top;return e.createElement("div",{className:"edit_anchor_3rspJ",style:{transform:"translate(".concat(c,"px, ").concat(u,"px)")},ref:s},e.createElement("div",{className:py},e.createElement("div",{className:hy},i("text.anchor.edit.content")),e.createElement(El,exports.E({className:fy},r,{placeHolder:n.text,autoSelect:!0,onKeydown:a,btnClsName:"editInputClearBtn"}))),e.createElement("div",{className:py},e.createElement("div",{className:hy},i("text.anchor.edit.link")),e.createElement(El,exports.E({className:fy},o,{onKeydown:a,placeHolder:i("text.anchor.edit.placeholder"),validateUrl:!0,btnClsName:"editInputClearBtn"}))),e.createElement("div",{className:"edit_btns_2y480"},e.createElement(ul,{type:"secondary",className:my,onClick:function(){n.cancelEdit()}},i("common.cancel")),e.createElement(ul,{type:"primary",className:my,onClick:function(){var e=r.value||n.text,t=ge(o.value.trim()),i=me(t);o.setError(!i),i&&n.changeAnchorTextAndUrl(e,t)},disabled:!o.value},i("common.save"))))},Iy=function(t){var n=t.element;return n.isAdd?e.createElement(ky,{element:n}):n.editing?e.createElement(Ty,{element:n}):e.createElement(_y,{element:n})},Py=function(){function e(e,t,n){this.insertIndex=e,this.editor=t,this.upime=n,this.renderKey="mentionEditor ".concat(Date.now()),this.renderer=Ny,this.searchChars=[],this.searchText="",this.composingText="",this.allUsersData=[],this.allGroupsData=[],this.searchedMembers=[],this.loading=!0,this.selectedIndex=0,this.groupSize=0,this.selected=!1,this.isDestoried=!1,this.getAllMembers()}return Object.defineProperty(e.prototype,"enteredText",{get:function(){return"".concat(this.searchText).concat(this.composingText)},enumerable:!1,configurable:!0}),e.prototype.setSelectedIndex=function(e){this.selectedIndex=e},e.prototype.setComposingText=function(e){this.composingText=e},e.prototype.addSearchText=function(e,t){this.searchChars=R(R([],this.searchChars,!0),t,!0),this.composingText="",this.searchText+=e,this.updateSearchedMembers(),this.selectedIndex>=this.searchedMembers.length&&(this.selectedIndex=0)},e.prototype.deleteSearchText=function(e){this.searchChars=this.searchChars.slice(0,-e),this.searchText=bi(this.searchChars),this.updateSearchedMembers(),this.selectedIndex>=this.searchedMembers.length&&(this.selectedIndex=0)},e.prototype.handleKeyDowm=function(e){var t=e.key;return"Escape"===t?(this.editor.endMention(),this.searchedMembers.length>0):0!==this.searchedMembers.length&&("ArrowUp"===t?(0===this.selectedIndex?this.selectedIndex=this.searchedMembers.length-1:this.selectedIndex--,this.upime.updateView(),!0):"ArrowDown"===t?(this.selectedIndex===this.searchedMembers.length-1?this.selectedIndex=0:this.selectedIndex++,this.upime.updateView(),!0):"Enter"===t&&(this.onSelect(),!0))},e.prototype.handleInsertLineBreak=function(){return 0!==this.searchedMembers.length&&(this.onSelect(),!0)},e.prototype.onSelect=function(e){var t=this;if(!this.selected){this.selected=!0,void 0===e&&(e=this.selectedIndex),this.selectedIndex=e;var n=this.searchedMembers[this.selectedIndex];this.stop().then((function(){t.selectedIndex<t.groupSize?t.editor.insertMention(t.insertIndex,t.searchChars.length,n.groupName,n.userIds.join(",")):t.editor.insertMention(t.insertIndex,t.searchChars.length,n.userName,n.loginName)}))}},e.prototype.getAllMembers=function(){var e=this,t=this.upime.getMentionCandidate||this.upime.getMentionGroupAndCandidate;null==t||t().then((function(t){if(!e.isDestoried&&null!=t){if(Array.isArray(t)){if(0===t.length)return void e.editor.endMention();e.allUsersData=t,e.allGroupsData=[{groupName:O("all.group.members"),userIds:t.map((function(e){return e.loginName}))}]}else{var n=t.groups,i=t.users;if(0===i.length)return void e.editor.endMention();e.allUsersData=i,e.allGroupsData=n}e.updateSearchedMembers(),e.upime.updateView()}})).catch((function(){e.isDestoried||(e.editor.endMention(),e.allGroupsData=[],e.allUsersData=[])})).finally((function(){e.isDestoried||(e.loading=!1)}))},e.prototype.updateSearchedMembers=function(){for(var e,t,n,i=this.searchText.toLocaleLowerCase(),r=[],o=0,a=this.allGroupsData;o<a.length;o++){var s=a[o];s.groupName.startsWith(i)&&r.push(s)}this.groupSize=r.length;for(var l=0,c=this.allUsersData;l<c.length;l++){var u=c[l];((null===(e=u.userName)||void 0===e?void 0:e.toLowerCase().includes(i))||(null===(t=u.email)||void 0===t?void 0:t.toLowerCase().includes(i))||(null===(n=u.phone)||void 0===n?void 0:n.toLowerCase().includes(i)))&&r.push(u)}this.searchedMembers=r},e.prototype.stop=function(){var e=this;return new Promise((function(t){fr((function(){t(e.editor.endMention())}))}))},e.prototype.onDestroy=function(){this.isDestoried=!0},e}(),Ny=function(t){return t.upime.phoneMode?e.createElement(Ay,exports.E({},t)):e.createElement(My,exports.E({},t))},My=function(t){var n,i,r,o,a=t.element,s=e.useReducer((function(e){return e+1}),0)[1],l=function(){var t=e.useState(!1),n=t[0],i=t[1],r=e.useRef(null);function o(){i(!0),r.current&&clearTimeout(r.current),r.current=window.setTimeout((function(){i(!1)}),100)}return e.useEffect((function(){return window.addEventListener("mousemove",o),function(){r.current&&clearTimeout(r.current),window.removeEventListener("mousemove",o)}}),[]),[n,o]}(),c=l[0],u=l[1],d=(r=u,o=e.useRef(null),e.useEffect((function(){var e=o.current;if(e){var t=function(e){e.stopPropagation(),null==r||r()};return e.addEventListener("mousemove",t),function(){e.removeEventListener("mousemove",t)}}}),[o.current]),o),p=e.useRef(null),h=e.useContext(Ic).rootContainer,f=a.searchedMembers,m=a.groupSize;function v(e){c&&(a.setSelectedIndex(e),s())}function g(){a.onSelect()}e.useEffect((function(){if(!m||0!==a.selectedIndex){var e=p.current;if(e){var t=40*(a.selectedIndex-m)+8,n=t+40;t>=Math.floor(e.scrollTop+e.clientHeight)?e.scrollTop=n-e.clientHeight:n<=Math.ceil(e.scrollTop)&&(e.scrollTop=t)}}}),[a.selectedIndex,p.current,a.searchedMembers.length]);var y=a.selectedIndex,b=a.editor.getCharWindoPosition(a.insertIndex),E=a.upime.view.getScreenPosition(b);if(E.x=Math.max(E.x,80),E.y+=12,h.current&&p.current){var x=null===(n=h.current)||void 0===n?void 0:n.getBoundingClientRect(),w=null===(i=p.current)||void 0===i?void 0:i.getBoundingClientRect(),C=w.width+E.x-x.right;C>0&&(E.x=E.x-C),E.y+w.height>x.bottom&&(E.y-=w.height+36+a.editor.client.element.lineHeight)}var S={left:"".concat(E.x,"px"),top:"".concat(E.y,"px")};return a.loading||a.isDestoried||0===f.length?null:e.createElement("div",{className:"mentionWrapper_3cWn1",style:S,onPointerDown:function(e){return e.preventDefault()},onPointerUp:function(e){return e.preventDefault()},ref:d},0!==m&&f.slice(0,m).map((function(t,n){var i=t.groupName,r=t.userIds;return e.createElement("div",{key:n,className:j("allmenberRow_3QlTz",n===y&&vy,n+1===m&&f.length>m&&"withBorder_3B8M8"),onPointerEnter:function(){return v(n)},onClick:function(){a.setSelectedIndex(n),g()}},"@",i,"(",null==r?void 0:r.length,")")})),e.createElement("div",{className:j("mentionContainer_UWTQf"),ref:p},e.createElement("div",{className:"list_AU6sH"},f.slice(m).map((function(t,n){var i,r,o=m?n+m:n;return e.createElement("div",{key:o,className:j(gy,o===y&&vy),onPointerEnter:function(){return v(o)},onClick:function(){a.setSelectedIndex(o),g()}},e.createElement(ml,{url:t.avatarUrl,className:by}),e.createElement("span",{className:j(Ey)},t.userName),e.createElement("span",{className:yy}," ",null!==(r=null!==(i=t.email)&&void 0!==i?i:t.phone)&&void 0!==r?r:""," "))})),0===f.length&&e.createElement("div",{className:j(gy,Ey)}," Empty "))))},Ay=function(n){var i=n.element,r=i.searchedMembers,o=i.groupSize;function a(e){i.setSelectedIndex(e),i.onSelect()}return 0===r.length?null:t.createPortal(e.createElement("div",{className:"mentionMask_23Ia7",onPointerDown:function(e){return e.preventDefault()},onPointerUp:function(e){return e.preventDefault()},onClick:function(e){i.editor.endMention(),e.preventDefault()}},e.createElement("div",{className:"mentionListPhoneWrapper_3nZor",onClick:function(e){e.preventDefault(),e.stopPropagation()}},e.createElement("div",{className:j("mentionListPhoneList_273fv")},o&&r.slice(0,o).map((function(t,n){var i;return e.createElement("div",{key:n,className:j(gy,"allMentionRow_2gvRf"),onClick:function(){return a(n)}},e.createElement(ml,{url:$o("at_all_member.png"),className:j(by)}),e.createElement("div",{className:xy},e.createElement("div",{className:Ey},t.groupName),e.createElement("div",{className:yy},null===(i=t.userIds)||void 0===i?void 0:i.length,O("common.people"))))})),r.slice(o).map((function(t,n){var i,r,s=o?n+o:n;return e.createElement("div",{key:s,className:j(gy),onClick:function(){return a(s)}},e.createElement(ml,{url:t.avatarUrl,className:by}),e.createElement("div",{className:xy},e.createElement("div",{className:j(Ey)},t.userName),e.createElement("div",{className:yy}," ",null!==(r=null!==(i=t.email)&&void 0!==i?i:t.phone)&&void 0!==r?r:""," ")))}))),e.createElement("div",{className:"mentionInputContainer_1njob"},e.createElement("div",{className:"mentionInputInner_3BYES"},e.createElement("div",{className:"mentionIcon_Ftq9S"},"@"),e.createElement("div",{className:"content_1PCvD"},i.enteredText),e.createElement("div",{className:j("cursor_2egYz")}),e.createElement("div",{className:"fillIn_3Id91"}))))),document.body)},Dy=function(){function e(e,t,n,i,r){this.mentionTo=e,this.mentionTextIndexAnchor=t,this.type=n,this.editor=i,this.upime=r,this.renderKey="mentionEditor ".concat(Math.random()),this.renderer=function(){return null},this.isActive=!1,this.removeDelay=0,this.isRemoving=!1,this.isRemoveWhenDeActive=!1,this.removeDelay="hover"===this.type?200:0}return e.prototype.active=function(){this.isActive=!0,this.isRemoving&&(clearTimeout(this.removeTimer),this.isRemoveWhenDeActive=!0,this.isRemoving=!1)},e.prototype.deActive=function(){this.isActive=!1,this.isRemoveWhenDeActive&&(this.editor.removeMentionCard(this),this.isRemoveWhenDeActive=!1,this.isRemoving=!1)},e.prototype.isInMention=function(e,t){return this.mentionTextIndexAnchor>=e&&this.mentionTextIndexAnchor<=t},e.prototype.cancelRemove=function(){clearTimeout(this.removeTimer),this.isRemoving=!1},e.prototype.remove=function(){var e=this;this.isRemoving||(this.isRemoving=!0,this.isActive?this.isRemoveWhenDeActive=!0:0!==this.removeDelay?this.removeTimer=window.setTimeout((function(){e.editor.removeMentionCard(e)}),this.removeDelay):this.editor.removeMentionCard(this))},e.prototype.removeSync=function(){clearTimeout(this.removeTimer),this.editor.removeMentionCard(this)},e}(),Ry={color:1710618};!function(e){e[e.Send=1]="Send"}(Sy||(Sy={}));var By,Ly=function(){function e(e){var t=this;this.client=e,this.editing=!1,this.preferEnd=!1,this.isComposing=!1,this.compositionStr="",this.selectedNextNode=!1,this.multiSelected=!1,this.lastEditTime=-1,this.actionHistory=[],this.undoHistory=[],this._currentStyle=exports.E({},Ry),this.defaultRichStyle=exports.E({},Ry),this.scrollTop=0,this._selectionStart=0,this._selectionEnd=0,this.windowblurState={start:0,end:0},this.syncedMention=!0,this.mentionCards=[],this.excludedStyles=[],this.pickAll=function(){t.setSelectionStart(0),t.setSelectionEnd(t.client.chars.length),t.preferEnd=!1,t.anchorEditor=void 0,t.defaultRichStyle=t.getRichStyleByCursor(t._selectionEnd),t.updateView()},this.copySelected=function(){if(t.isSelecting){var e=Ei(t.client.chars,t.selectionStart,t.selectionEnd);Xd("1",{onCopy:function(t){t.setData("text/plain",e)}}),t.checkFocusing(!0),t.updateTextAreaSelection()}},this.cutSelected=function(){t.isSelecting&&(t.copySelected(),t.preventHistoryMerge(),t.doDelete(t.selectionStart,t.selectionEnd-t.selectionStart))},this.dealPaste=function(e){return A(t,void 0,void 0,(function(){var t,n,i,r=this;return D(this,(function(o){switch(o.label){case 0:return(n=e)?[3,2]:[4,this.element.upime.readClipboardData()];case 1:n=o.sent(),o.label=2;case 2:return t=n,this.editing&&t?(this.preventHistoryMerge(),t.htmlData&&this.element.elementType!==Za.STICKER?((i=Nr(t.htmlData))&&this.excludedStyles.length&&i.forEach((function(e){r.excludedStyles.forEach((function(t){t in e[1]&&delete e[1][t]}))})),null==i||i.forEach((function(e){r.doAdd(e[0].join(""),e[1])}))):t.plainData&&this.pastePlainData(t.plainData),[2]):[2]}}))}))},this.inputObservers=[],this.composePotentialLick=function(e){if(!t.excludedStyles.includes("link")){e=e||exports.E({},t.currentStyle);var n=t.selectionStart;if(!(n<7||e.link)){var i=n-1,r=t.getRichStyleByChar(i),o=t.client.chars,a=o[i];if(!r.link&&"\n"!==a&&" "!==a){for(var s=i;s>=0;){var l=o[s];if(" "===l||"\n"===l||!/^[a-zA-Z0-9.:\?%&=#\/]$/i.test(l)){s++;break}s--}s=Math.max(0,s);var c=o.slice(s,n).join("");if(c){var u=function(e,t){for(var n,i=[];null!==(n=t.exec(e));)i.push(n.index),n.index===t.lastIndex&&t.lastIndex++;return i}(c,Zo);if(u.length){var d=u[u.length-1],p=c.slice(d);p.startsWith("http")||(p="https://".concat(p));var h=s+d;if(t.getRichStyleByChar(h).link)for(var f=0,m=0,v=t.client.content;m<v.length;m++){var g=f+v[m][0].length;if(h>=f&&h<g){h=f;break}f=g}return t.doEdit(h,n-h,{link:p}),!0}}}}}}}return Object.defineProperty(e.prototype,"isSelecting",{get:function(){return this._selectionStart!==this._selectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentStyle",{get:function(){return this._currentStyle},set:function(e){this._currentStyle=exports.E({},e),delete this._currentStyle.mention},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.client.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){return this.client.currentEditor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorEditor",{get:function(){return this._anchorEditor},set:function(e){this.setAnchorEditor(e)},enumerable:!1,configurable:!0}),e.prototype.setAnchorEditor=function(e){e!==this._anchorEditor&&(this._anchorEditor&&(this.element.upime.view.removeDomWidget(this._anchorEditor),this._anchorEditor=void 0),e?this.element.upime.view.addDomWidget(e):(this.checkFocusing(),this.updateTextAreaSelection()),this._anchorEditor=e)},Object.defineProperty(e.prototype,"selectionStart",{get:function(){return Math.min(this._selectionStart,this._selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return Math.max(this._selectionStart,this._selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursorIndex",{get:function(){return this._selectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hoveredMentionTarget",{get:function(){var e=this.hoveredMention;if(void 0!==e)return this.getAllMentions().reverse().find((function(t){return t.startIndex<=e&&t.endIndex>=e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeMentionTarget",{get:function(){var e=this.activeMention;if(void 0!==e)return this.getAllMentions().reverse().find((function(t){return t.startIndex<=e&&t.endIndex>=e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMentioning",{get:function(){return Boolean(this.mentionEditor)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelectingMention",{get:function(){var e,t=null===(e=this.mentionEditor)||void 0===e?void 0:e.searchedMembers;return Boolean(t&&t.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"standby",{get:function(){return void 0!==this.textareaDom&&!this.editing},enumerable:!1,configurable:!0}),e.prototype.calcGlobalTextRect=function(e){var t=this.client.element,n=t.lineHeight,i=t.scale,r=t.globalTransform,o=t.textRect,a=t.position,s=t.fontSize,l=a.x+o.x*i,c=a.y+o.y*i,u=r.applyBorderBox({left:l,top:c,right:l+o.width*i,bottom:c+o.height*i,rotate:t.rotate}),d=e.scale,p=u.rotate||0,h=r.currentScale*i,f=(u.left-e.left)*d,m=(u.top-e.top)*d,v=o.width*h*d,g=o.height*h*d,y=f+v/2,b=m+g/2,E=this.cursorPosition;if(E){var x={x:E.x*h*d-v/2,y:E.y*h*d-g/2};p&&(x=an(x,p)),y+=x.x,b+=x.y}var w=(e.right-e.left)*d,C=(e.bottom-e.top)*d,S=n*h*d;return y<1?y=1:y+61>w&&(y=w-61),b<1?b=1:b+S+1>C&&(b=C-S-1),{x:y,y:b,width:60,height:S,fontSize:s*h*d}},e.prototype.dealTextSelect=function(e){var t=e.position,n=e.startPosition,i=this.element.globalTransform;t=i.applyInverse(t),n=i.applyInverse(n);var r=this.client,o=r.getTextRelation(t).point;if(e.isStart){var a=r.getTextRelation(n).point;a.y+=this.scrollTop,this.setSelectionStart(this.getIndexByPosition(a).index)}o.y+=this.scrollTop,this.updateSelection(this.getIndexByPosition(o).index)},e.prototype.switchToWebpage=function(e){0===e.start&&e.end===this.client.length&&"function"==typeof this.element.switchToWebpage&&(this.clearAnchorEditor(),this.element.switchToWebpage())},e.prototype.getTextPropertyStatus=function(e){var t,n;if(this.editing?(t=this.selectionStart,n=this.selectionEnd):(t=0,n=this.client.length),t===n)return!!this.currentStyle[e];for(var i=0,r=!0,o=0,a=this.client.content;o<a.length;o++){var s=a[o],l=s[0].length;if(i+l<=t)i+=l;else{if(i>=n)break;if(!s[1][e]){r=!1;break}i+=l}}return r},e.prototype.setTextStyle=function(e,t){var n,i,r;this.editing?(i=this.selectionStart,r=this.selectionEnd):(i=0,r=this.client.length);var o=((n={})[e]=t,n);this.currentStyle=Ss(this.currentStyle,o),i!==r&&(this.doEdit(i,r-i,o),this.editing||this.client.syncBufferedOperation())},e.prototype.startEditAnchor=function(){this.element.startEditAnchor()},e.prototype.clearAnchorEditor=function(){this.anchorEditor=void 0},e.prototype.callEditorEditSelf=function(){var e=this.editor;if(e){var t=e.editingEditor;t!==this&&(t&&e.stopEdit(),e.connectTextEditor(this),e.startEdit())}},e.prototype.selectElementAndEditSelf=function(){this.domLocked=!0;var e=this.element.applySelectSelf();this.domLocked=!1,e.connectTextEditor(this),e.startEdit()},e.prototype.recoverEditAfterAnchor=function(e){if(!this.editing){this.callEditorEditSelf();var t=e.start,n=e.end;t===n?this.updateCursor(n,!0):(this.setSelectionStart(t),this.updateSelection(n))}this.anchorEditor=void 0,this.updateView()},e.prototype.onAnchorCancelEdit=function(e){this.recoverEditAfterAnchor(e)},e.prototype.unselect=function(){this.anchorEditor=void 0,this.endMention(),this.unSelectMention(),this.computMentionCard()},e.prototype.checkFocusing=function(e){void 0===e&&(e=!1),this.editing&&this.textareaDom&&(this.textareaDom!==document.activeElement||e)&&(this.textareaDom.focus(),this.textareaDom.selectionStart=0,this.textareaDom.selectionEnd=0)},e.prototype.updateTextAreaSelection=function(){var e=this.textareaDom;if(e){var t=this.client.chars,n=this.selectionStart,i=this.selectionEnd,r=t.slice(0,n).join("").length,o=r+t.slice(n,i).join("").length;(_e.isIOS||_e.safari)&&(e.selectionStart=r,e.selectionEnd=o),this.defaultRichStyle=this.getRichStyleByCursor(i)}},e.prototype.updateTextAreaValue=function(){var e=this.textareaDom;if(e&&(_e.isIOS||_e.safari)){var t=this.client.chars;e.value=t.join("")}},e.prototype.isAnchorEditorValid=function(e){var t=e.start,n=e.end;if(e.isAdd)return!0;for(var i=0,r=0,o=this.client.content;r<o.length;r++){var a=o[r][0].length;if(i===t&&i+a===n)return!0;i+=a}return!1},e.prototype.deleteAnchor=function(e){if(this.isAnchorEditorValid(e)){var t=e.start,n=e.end;this.editing||(this.callEditorEditSelf(),this.setSelectionStart(t),this.setSelectionEnd(n)),this.doEdit(t,n-t,{link:null}),this.updateCursor(t)}this.anchorEditor=void 0},e.prototype.setAnchorUrl=function(e,t){var n=e.start,i=e.end;if(this.editing||(this.callEditorEditSelf(),this.setSelectionStart(n),this.setSelectionEnd(i)),e.isAdd)if(n!==i)this.doEdit(n,i-n,{link:t}),this.updateCursor(i,!0);else{var r=this.getRichStyleByCursor(n);r=exports.E(exports.E({},r),{link:t}),this.doAdd(t,r)}else this.isAnchorEditorValid(e)&&(this.doEdit(n,i-n,{link:t}),this.updateCursor(i,!0));this.anchorEditor=void 0},e.prototype.changeAnchorTextAndUrl=function(e,t,n){var i=e.start,r=e.end;if(this.editing||(this.callEditorEditSelf(),this.setSelectionStart(i),this.setSelectionEnd(r)),this.isAnchorEditorValid(e)){var o=this.getRichStyleByCursor(i);o=exports.E(exports.E({},o),{link:n}),this.doDelete(i,r-i),this.doAdd(t,o)}this.anchorEditor=void 0},e.prototype.cancelAddAnchor=function(e){this.recoverEditAfterAnchor(e),this.anchorEditor=void 0},e.prototype.gotoAnchorLink=function(e){this.element.gotoAnchorLink(e.link)},e.prototype.getAnchorByPosition=function(e){var t=this.client.renderData,n=this.element,i=n.ha,r=n.lineHeight,o=e.x,a=e.y,s=Math.floor(a/r);if(s<t.lines.length){var l=t.lines[s],c=t.width-l.width;if("center"===i?c/=2:"left"===i&&(c=0),o>=c&&o<c+l.width)for(var u=l.spans,d=l.startIndex,p=0;p<u.length;p++){var h=p===u.length-1?l.width-u[p].x:u[p+1].x-u[p].x;if(o>=u[p].x+c&&o<u[p].x+h+c){var f=u[p].data.link;if(f)return{startIndex:d,link:f};break}d+=yi(u[p].text).length}}return null},e.prototype.getAnchorSpanCenterPosition=function(e,t){void 0===t&&(t=!1);for(var n=this.client,i=n.renderData,r=n.element,o=i.lines[0],a=0,s=1;s<i.lines.length;s++){var l=i.lines[s];if(l.startIndex>e||t&&l.startIndex===e)break;o=l,a=s}var c=r.lineHeight,u=r.va,d=r.ha,p=r.fontSize,h=r.fontFamily,f=r.textRect,m=r.scale,v=r.rotate,g=i.width-o.width;"left"===d?g=0:"center"===d&&(g/=2);var y=ut({fontSize:p,fontFamily:h}),b=st;b.font=y;for(var E=o.startIndex,x={x:g+o.width/2,y:c*a},w=0,C=o.spans;w<C.length;w++){var S=C[w],k=yi(S.text).length;if(E<=e&&E+k>e){x={x:g+(b.measureText(Ei(o.chars,0,E-o.startIndex)).width+b.measureText(Ei(o.chars,0,E+k-o.startIndex)).width)/2,y:c*a};break}E+=k}var _=r.getBorderBox(),T=(f.x+x.x)*m+_.left,I=(f.y+x.y-this.scrollTop)*m+_.top,P=this.client.renderData.height,N=0;if("top"!==u&&f.height>P&&(N=f.height-P,"middle"===u&&(N/=2)),I+=N*m,v){var M=(_.left+_.right)/2,A=(_.top+_.bottom)/2,D=an({x:T-M,y:I-A},v);T=M+D.x,I=A+D.y}return{x:T,y:I}},e.prototype.getAnchorPosition=function(e,t){void 0===t&&(t=!1);var n=this.client.element,i=n.textRect,r=n.scale,o=n.rotate,a=n.va,s=this.getPositionByIndex(e,t),l=n.getBorderBox(),c=(i.x+s.x)*r+l.left,u=(i.y+s.y-this.scrollTop)*r+l.top,d=this.client.renderData.height,p=0;if("top"!==a&&i.height>d&&(p=i.height-d,"middle"===a&&(p/=2)),u+=p*r,o){var h=(l.left+l.right)/2,f=(l.top+l.bottom)/2,m=an({x:c-h,y:u-f},o);c=h+m.x,u=f+m.y}return{x:c,y:u}},e.prototype.getAnchorEditorGlobalBorder=function(e){var t,n,i,r=this.element.upime.view.getViewbox(),o=r.left,a=r.top,s=r.right,l=r.scale,c=(s-o)*l,u=this.element.globalTransform.apply(e.position),d=e.isAdd?76:e.editing?208:50;return e.isAdd||e.editing?t=400:(t=56,e.editable&&(t+=96,e.canSwitchToWebpage&&(t+=96))),e.isAdd?(n=(u.x-o)*l-16,i=(u.y-a)*l-d):(n=(u.x-o)*l-t/2,i=(u.y-a)*l-d),n<0?n=0:n+t>c&&(n=c-t),i<0&&(i=i+d+e.lineHeight*this.element.globalTransform.currentScale*l),{left:n,top:i,right:n+t,bottom:i+d}},e.prototype.addAnchorLink=function(){var e,t,n=new wy(this);n.isAdd=!0,this.editing?(e=this.selectionStart,t=this.selectionEnd):(e=0,t=this.client.length),n.start=e,n.end=t;var i=e===t&&this.preferEnd;n.position=this.getAnchorPosition(e,i);var r=this.element,o=r.lineHeight,a=r.scale;n.lineHeight=o*a,this.anchorEditor=n},e.prototype.checkAnchorLink=function(e,t){void 0===t&&(t=!1);var n=this.client,i=n.content;"\n"===n.chars[e]&&(t=!0);for(var r=0,o=0,a=0,s="",l="",c=0,u=i;c<u.length;c++){var d=u[c],p=d[0].length;if(r+p>e||t&&r+p===e){if(void 0===d[1].link||null===d[1].link)break;l=d[1].link,s=d[0].join(""),o=r,a=r+p;break}r+=p}if(0!==o||0!==a){var h=this.getAnchorSpanCenterPosition(e,t),f=this.anchorEditor,m=this.element.upime.editable;if(f&&!f.isAdd&&f.start===o&&f.end===a)return f.position=h,void(f.editable=m);var v=new wy(this);v.start=o,v.end=a;var g=this.element,y=g.scale,b=g.lineHeight;v.position=h,v.lineHeight=b*y,v.link=l,v.text=s,this.element.upime.userManager.enableWebpage&&this.element.supportSwitchToWebpage&&"function"==typeof this.element.switchToWebpage&&0===o&&a===this.client.length&&(v.canSwitchToWebpage=!0),v.editable=m,this.anchorEditor=v}else this.anchorEditor=void 0},e.prototype.pickWordAtPosition=function(e){var t=this.getIndexByPosition(e),n=t.index,i=t.atEnd,r=t.charIndex;if(void 0!==r){var o=this.getMentionByIndex(r);if(o)return this.setSelectionStart(o.startIndex),void this.updateSelection(o.endIndex);var a=function(e,t){var n=Math.max(0,t-500),i=Math.min(e.length-1,t+500)+1,r=e.slice(n,i);if(!Intl.Segmenter){var o=function(e,t){var n=t,i=t+1;function r(e){return function(e){return/[\u4e00-\u9fa5]/.test(e)}(e)?"cn":function(e){return/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff]/.test(e)}(e)?"letter":""}for(var o=r(e[t]),a=t-1;a>=0&&r(e[a])===o;a--)n=a;for(a=t+1;a<e.length&&r(e[a])===o;a++)i=a+1;return{start:n,end:i}}(r,t-n);return{start:o.start+n,end:o.end+n}}for(var a=new Intl.Segmenter("cn",{granularity:"word"}),s=Array.from(a.segment(r.join(""))),l=n,c=0,u=0;u<s.length&&(c=l+yi(s[u].segment).length,!(l<=t&&c>t));u++)l=c;return{start:l,end:c}}(this.client.chars,r);if(a){var s=a.start,l=a.end,c=this.getMentionByIndex(s);c&&(s=c.endIndex);var u=this.getMentionByIndex(l);if(u&&(l=u.startIndex),s<l)return this.setSelectionStart(s),void this.updateSelection(l)}this.setSelectionStart(r),this.updateSelection(r+1)}else this.updateCursor(n,i)},e.prototype.pickLineAtPosition=function(e){var t=this.getIndexByPosition(e).index,n=function(e,t){for(var n=0,i=0,r=0;r<e.length;r++){if(_i(e[r])){if(r>=t){i=r;break}n=r+1}i=r+1}return{start:n,end:i}}(this.client.chars,t),i=n.start,r=n.end;this.setSelectionStart(i),this.updateSelection(r)},e.prototype.insertLineBreak=function(){this.preventHistoryMerge(),this.composePotentialLick(),this.doAdd("\n")},e.prototype.moveCursorToEnd=function(){var e=this.client.length;this.updateCursor(e)},e.prototype.moveCursorToPosition=function(e){var t=this.getIndexByPosition(e),n=t.index,i=t.atEnd;this.updateCursor(n,i)},e.prototype.startEdit=function(e,t){var n,i;if(void 0===e&&(e=!0),void 0===t&&(t=!0),!_e.desktop){if(t&&e){var r=this.client.element,o=r.upime,a=o.view,s=r.getGlobalBox(),l=Lt(s),c=a.getViewbox(),u=c.bottom,d=c.top,p=c.left,h=u-d;if(o.phoneMode&&_e.isIphoneLike)l.y<d+h/2&&o.slideViewTo(p,(s.top+s.bottom)/2-h/1.8,a.scale,0);else if(l.y>=d+h/2){var f=l.y-(d+h/4);o.slideViewTo(p,d+f,a.scale,100)}}e&&(null===(n=this.textareaDom)||void 0===n||n.focus())}this.editing=!0,this.actionHistory=[],this.undoHistory=[],this.currentOp=null===(i=this.editor)||void 0===i?void 0:i.currentOp,this.unSelectMention()},e.prototype.stopEdit=function(){var e;!_e.desktop&&(null===(e=this.textareaDom)||void 0===e||e.blur()),this.saveSelection(),this.client.willStopEditing(),this.lastEditTime=-1,this.actionHistory=[],this.undoHistory=[],this.scrollTop=0,this.setSelectionStart(0),this.setSelectionEnd(0),this.editing=!1,this.endMention(),this.computMentionCard(),this.syncMention(),this.composingAction=void 0},e.prototype.preventHistoryMerge=function(){this.lastEditTime=-1},e.prototype.getRichStyleByChar=function(e){var t=this.client.content;if(0==t.length)return Ry;for(var n=0,i=0;i<t.length&&!((n+=t[i][0].length)>e||i==t.length-1);i++);return exports.E({},t[i][1])},e.prototype.getRichStyleByCursor=function(e){var t,n=this.client,i=n.content,r=n.chars,o=n.length;if(0==i.length)return this.defaultRichStyle;var a=r[e-1];"\n"===a&&e!==o&&e++;for(var s=0,l=0,c=e===o,u=0===e;l<i.length;l++)if((s+=i[l][0].length)>=e||l==i.length-1){s===e&&(c=!0);break}var d=exports.E({},i[l][1]);if(c&&d.mention){var p=null===(t=i[l+1])||void 0===t?void 0:t[1];d.color=p?p.color:this.defaultRichStyle.color}return(u||c||"\n"===a&&i[l][1].link)&&delete d.link,d},e.prototype.setRichStyle=function(e){if(0===this.client.content.length&&(this.defaultRichStyle=Ss(this.defaultRichStyle,e)),this.currentStyle=Ss(this.currentStyle,e),!this.editing)return this.doEdit(0,this.client.length,e),void this.client.syncBufferedOperation();this.isSelecting?this.doEdit(this.selectionStart,this.selectionEnd-this.selectionStart,e):void 0!==e.color&&this.updateView()},e.prototype.updateView=function(){this.element.upime.updateView()},e.prototype.saveSelection=function(){var e=this;_e.desktop&&(this.windowblurState={start:this._selectionStart,end:this._selectionEnd},this.windowBlurTimer=fr((function(){e.windowblurState=void 0,e.windowBlurTimer=void 0})))},e.prototype.setSelectionStart=function(e){this._selectionStart=e},e.prototype.setSelectionEnd=function(e){var t=this.getMentionByIndex(e);t?this._selectionStart>t.startIndex&&this._selectionStart<t.endIndex?this._selectionStart<e?(this.setSelectionStart(t.startIndex),this._selectionEnd=t.endIndex):(this.setSelectionStart(t.endIndex),this._selectionEnd=t.startIndex):this._selectionStart<e?this._selectionEnd=t.endIndex:this._selectionEnd=t.startIndex:this._selectionEnd=e},e.prototype.updateSelection=function(e){this.setSelectionEnd(e),this.preferEnd=!1,this.anchorEditor=void 0,this.updateView(),this.updateTextAreaSelection(),this.computMentionCard()},e.prototype.updateCursor=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var i=this.correctCursorWithMention(e);this.setSelectionStart(i),this.setSelectionEnd(i),this.preferEnd=t,this.currentStyle=this.getRichStyleByCursor(i),this.clearAnchorEditor(),this.checkFocusing(),this.updateView(),this.updateTextAreaSelection(),n&&this.endMention(),this.computMentionCard()},e.prototype.correctCursorWithMention=function(e){var t=this.getMentionByIndex(e);return t?t.endIndex:e},e.prototype.getAllMentions=function(){var e=[];return this.client.content.reduce((function(t,n){var i=n[0],r=n[1];return r.mention&&e.push({startIndex:t,endIndex:t+i.length,content:i.join(""),mentionTo:r.mention}),t+n[0].length}),0),e},e.prototype.getMentionByIndex=function(e){return this.getAllMentions().find((function(t){return t.startIndex<e&&t.endIndex>e}))},e.prototype.updateCursorBySelfAction=function(e,t){var n=0,i=0;e.opList.forEach((function(e){if(Array.isArray(e)){var t="number"==typeof e[0]?e[0]:e[0].length;i=n+=t}else e<0?i=n:n+=e})),this.updateCursor(i,!1,t)},e.prototype.updateContentByRemoteAction=function(e){this.setSelectionStart(Oy(this._selectionStart,e.opList)),this.setSelectionEnd(Oy(this._selectionEnd,e.opList)),this.transformMentionEditor(e.opList),this.transformAnchorPos(e.opList),this.transformComposingAction(e.opList),this.updateView()},e.prototype.transformMentionEditor=function(e){if(this.mentionEditor){for(var t=this.mentionEditor,n=t.searchChars,i=t.composingText,r=this.mentionEditor.insertIndex,o=r+1+n.length+yi(i).length,a=0,s=!1,l=0,c=e;l<c.length;l++){var u=c[l];if(a>o)break;if(Array.isArray(u))if("number"==typeof u[0])a+=u[0];else{var d=u[0].length;if(!(a<=r)){s=!0;break}a+=d,r+=d}else if(u<0){if(a-u>r){s=!0;break}r+=u}else a+=u}s?this.endMention():this.mentionEditor.insertIndex=r}void 0!==this.hoveredMention&&(this.hoveredMention=Oy(this.hoveredMention,e))},e.prototype.transformAnchorPos=function(e){var t=this.anchorEditor;if(t){var n=t.start,i=t.end,r=i-n;if(n=Oy(n,e),i=Oy(i,e),0!==r&&n===i)this.anchorEditor=void 0;else{t.start=n,t.end=i;var o=n===i&&this.preferEnd;t.position=t.isAdd?this.getAnchorPosition(n,o):this.getAnchorSpanCenterPosition(n,o)}}},e.prototype.transformComposingAction=function(e){var t;if(this.composingAction){var n=this.composingAction.reverseOpList.slice(0),i=e.slice(0);i=(t=Ps(i,n))[0],n=t[1];var r=this.calcReverseOt(n);this.composingAction={opList:r,reverseOpList:n}}},e.prototype.isAtEnd=function(e){return this.client.renderData.lines.some((function(t){return t.startIndex===e}))||this.client.length===e},e.prototype.getIndexByPosition=function(e){var t=this.element,n=t.lineHeight,i=t.ha,r=t.fontSize,o=t.fontFamily,a=this.client.renderData,s=a.lines,l=a.width,c=s[Math.max(Math.floor(e.y/n),0)]||s[s.length-1];if(!c)return{index:0};var u=c.startIndex,d=c.chars,p=l-c.width;"left"===i?p=0:"center"===i&&(p/=2);var h=e.x-p;if(h<0)return{index:u,charIndex:d.length?u:void 0};var f=ut({fontSize:r,fontFamily:o}),m=st;m.font=f;for(var v,g=[0],y=Math.min(zi(d,h,r,o),d.length),b=function(e){var t=g[e];return void 0===t&&(t=g[e]=m.measureText(Ei(d,0,e)).width),t},E=void 0;(v=b(y))!==h;)if(v<h){if(y===d.length){E=u+y-1;break}if(b(y+1)>h)break;y++}else{if(0===y)break;if(b(y-1)<h){y-=1;break}y--}return void 0===E&&(E=u+y),0===y&&0===d.length&&(E=void 0),y<d.length&&h-b(y)>b(y+1)-h&&y++,{index:u+y,atEnd:0!==d.length&&y===d.length,charIndex:E}},e.prototype.getLineIdByIndex=function(e,t){for(var n=this.client.renderData.lines,i=0,r=0;r<n.length&&!(t&&n[r].startIndex>=e||!t&&n[r].startIndex>e);r++)i=r;return i},e.prototype.getPositionByLineAndIndex=function(e,t){var n=this.client.element,i=n.lineHeight,r=n.ha,o=n.fontSize,a=n.fontFamily,s=this.client.renderData,l=s.lines,c=s.width,u=l[e],d=i*e,p=c-u.width;"left"===r?p=0:"center"===r&&(p/=2);var h=ut({fontSize:o,fontFamily:a}),f=st;return f.font=h,{x:p+f.measureText(Ei(u.chars,0,t-u.startIndex)).width,y:d}},e.prototype.getPositionByIndex=function(e,t){var n=this.getLineIdByIndex(e,t);return this.getPositionByLineAndIndex(n,e)},e.prototype.getRichTextByRange=function(e,t){for(var n=[],i=0,r=0,o=this.client.content;r<o.length;r++){var a=o[r],s=a[0],l=s.length;if(i>=t)break;if(i+l<=e)i+=l;else{var c=Math.max(i,e),u=Math.min(i+l,t);u>c&&n.push([s.slice(c-i,u-i),a[1]]),i+=l}}return n},e.prototype.deleteSelected=function(){this.preventHistoryMerge(),this.doDelete(this.selectionStart,this.selectionEnd-this.selectionStart)},e.prototype.deleteBackword=function(){this.doDelete(this.selectionStart-1,1)},e.prototype.deleteForward=function(){this.doDelete(this.selectionStart,1)},e.prototype.doCut=function(e,t,n){this.doCopy(e,t,n),this.preventHistoryMerge(),this.doDelete(t,n)},e.prototype.pastePlainData=function(e){var t=e;t=t.replace(/\r\n/g,"\n");var n=exports.E({},this.currentStyle);!n.link&&ae(t)&&(n.link=t),this.doAdd(t,n)},e.prototype.doCopy=function(e,t,n){var i,r,o,a=Ei(this.client.chars,t,t+n),s=this.convertSelectedRichText2HTML();e.preventDefault(),e.stopPropagation(),null===(i=e.clipboardData)||void 0===i||i.clearData(),null===(r=e.clipboardData)||void 0===r||r.setData("text/plain",a),s&&(null===(o=e.clipboardData)||void 0===o||o.setData("text/html",s.outerHTML))},e.prototype.doDelete=function(e,t){var n,i=this.getMentionByIndex(e);if(i){var r=i.endIndex-e;e=i.startIndex,t=i.content.length+t-r}var o=this.client.length,a={opList:[e,-t,o-e-t],reverseOpList:R(R([e],this.getRichTextByRange(e,e+t),!0),[o-e-t],!1)};this.applyAction(a),this.saveHistoryAction(a),this.mentionEditor&&e<=this.mentionEditor.insertIndex&&this.endMention(),this.updateCursor(e,!1,!1),null===(n=this.mentionEditor)||void 0===n||n.deleteSearchText(t)},e.prototype.genAddAction=function(e,t,n,i){i=i||this.currentStyle;var r=this.client.length,o=[t],a=[t];if(n>t){var s=this.getRichTextByRange(t,n);o.push(t-n),a.push.apply(a,s)}o.push([e,exports.E({},i)],r-n);var l=e.length;return a.push(-l,r-n),{opList:o,reverseOpList:a}},e.prototype.applyAction=function(e,t){var n=this.client.applyAction(e,t);return this.updateTextAreaValue(),n},e.prototype.doOverwriteAll=function(e){if(e){var t=yi(e),n=t.length,i=this.genAddAction(t,0,this.client.chars.length,exports.E({},this.currentStyle));this.applyAction(i)||(this.saveHistoryAction(i),this.updateCursor(n),"@"===e&&this.startMention(0))}},e.prototype.doAdd=function(e,t){if(e){var n=this.selectionStart,i=this.selectionEnd,r=yi(e),o=r.length,a=this.genAddAction(r,n,i,t);if(!this.applyAction(a)){this.saveHistoryAction(a);var s=n+o;this.updateCursor(s,!1,!1),"@"===e?this.startMention(n):this.mentionEditor&&this.mentionEditor.addSearchText(e,r)}}},e.prototype.doEdit=function(e,t,n){var i=this.client.length,r=this.getRichTextByRange(e,e+t),o=[e],a=[e];o.push([t,n],i-e-t),r.forEach((function(e){var t={};for(var i in n){var r=e[1][i],o=n[i];void 0===r&&(r="boolean"!=typeof o&&null),t[i]=r}a.push([e[0].length,t])})),a.push(i-e-t);var s={opList:o,reverseOpList:a};this.applyAction(s,!0),this.saveHistoryAction(s),this.updateView()},e.prototype.saveHistoryAction=function(e,t){var n=e.opList,i=e.reverseOpList,r=Date.now();if(0===this.actionHistory.length||this.lastEditTime<r-1e3)this.actionHistory.push(e);else{var o=this.actionHistory[this.actionHistory.length-1];o.opList=Is(o.opList,n),o.reverseOpList=Is(i,o.reverseOpList)}this.lastEditTime=r,this.undoHistory.length=0},e.prototype.undo=function(){this.revertAction(this.actionHistory,this.undoHistory)},e.prototype.redo=function(){this.revertAction(this.undoHistory,this.actionHistory)},e.prototype.revertAction=function(e,t){var n=e.pop();if(n){var i={opList:n.reverseOpList,reverseOpList:n.opList};this.applyAction(i),t.push(i),this.preventHistoryMerge(),this.updateCursorBySelfAction(i)}},e.prototype.addInputObserver=function(e){this.inputObservers.push(e)},e.prototype.removeInputObserver=function(e){this.inputObservers=this.inputObservers.filter((function(t){return t!==e}))},e.prototype.checkInputContent=function(e,t){for(var n=0,i=this.inputObservers;n<i.length;n++)if((0,i[n])(e,t))return!0;if(" "===e&&this.composePotentialLick(t))return this.doAdd(e,t),!0},e.prototype.filterInput=function(e){var t,n,i=this.selectionStart,r=this.client.length;if("insertCompositionText"===e.inputType||e.isComposing)return null===(t=this.mentionEditor)||void 0===t||t.setComposingText(e.data),!1;if(this.client.handleInput(e))return!1;switch(e.inputType){case"deleteContentBackward":if(this.isSelecting)this.deleteSelected();else{if(0===i)return this.handleDeleteStart(),!1;if((s=e.target).selectionEnd!==s.selectionStart){var o=s.value.substring(s.selectionStart,s.selectionEnd),a=yi(o).length;this.doDelete(this.selectionEnd-a,a)}else this.deleteBackword()}break;case"deleteContentForward":if(this.isSelecting)this.deleteSelected();else{if(i===r)return this.handleDeleteEnd(),!1;this.deleteForward()}break;case"insertLineBreak":if(null===(n=this.mentionEditor)||void 0===n?void 0:n.handleInsertLineBreak())return!1;this.insertLineBreak();break;case"insertText":var s=e.data,l=exports.E({},this.currentStyle);if(this.standby)"single"===this.element.selectStatus?(this.callEditorEditSelf(),this.doOverwriteAll(s)):(this.selectElementAndEditSelf(),this.doOverwriteAll(s));else{if(this.checkInputContent(s,l))return;this.doAdd(s,l)}}return!0},e.prototype.filterKeydown=function(e){var t;if(!(e.isComposing||this.standby||(null===(t=this.mentionEditor)||void 0===t?void 0:t.handleKeyDowm(e))||this.client.handleKeyDown(e))){var n=e.key,i=e.shiftKey,r=e.ctrlKey,o=e.metaKey,a=e.altKey;if("Home"===n||_e.isMac&&"ArrowLeft"===n&&o||!_e.isMac&&"ArrowLeft"===n&&r){e.preventDefault(),this.preventHistoryMerge();var s=void 0;if(e.ctrlKey&&("Home"===n||_e.isMac&&"ArrowLeft"===n&&o))s=0;else{var l=this.isSelecting?this._selectionEnd>this._selectionStart:this.preferEnd,c=this.getLineIdByIndex(this._selectionEnd,l);s=(u=this.client.renderData.lines[c]).startIndex}s=(v=this.getMentionByIndex(s))?v.startIndex:s,e.shiftKey?this.updateSelection(s):this.updateCursor(s)}else if("End"===n||_e.isMac&&"ArrowRight"===n&&o||!_e.isMac&&"ArrowRight"===n&&r){this.preventHistoryMerge(),e.preventDefault(),s=void 0;var u,d=!0;if(e.ctrlKey&&("End"===n||_e.isMac&&"ArrowRight"===n&&o))s=this.client.chars.length;else l=this.isSelecting?this._selectionEnd>this._selectionStart:this.preferEnd,c=this.getLineIdByIndex(this._selectionEnd,l),s=(u=this.client.renderData.lines[c]).startIndex+u.chars.length,d=0!==u.chars.length;s=(v=this.getMentionByIndex(s))?v.endIndex:s,e.shiftKey?this.updateSelection(s):this.updateCursor(s,d)}else if("ArrowLeft"===n){if(i)this._selectionEnd>0?(s=(v=this.getMentionByIndex(this._selectionEnd-1))?v.startIndex:this._selectionEnd-1,this.updateSelection(s)):this.onExtraContentStart(e);else if(this.isSelecting){var p=this.selectionStart;this.updateCursor(p)}else this._selectionStart>0?(v=this.getMentionByIndex(this._selectionStart-1))?this.updateSelection(v.startIndex):this.updateCursor(this._selectionStart-1):this.onExtraContentStart(e);this.preventHistoryMerge()}else if("ArrowRight"===n)i?this._selectionEnd<this.client.length?(s=(v=this.getMentionByIndex(this._selectionEnd+1))?v.endIndex:this._selectionEnd+1,this.updateSelection(s)):this.onExtraContentEnd(e):this.isSelecting?(p=this.selectionEnd,this.updateCursor(p,this.isAtEnd(p))):this._selectionStart<this.client.length?(v=this.getMentionByIndex(this._selectionStart+1))?this.updateSelection(v.endIndex):(p=this._selectionStart+1,this.updateCursor(p)):this.onExtraContentEnd(e),this.preventHistoryMerge();else if("ArrowUp"===n){this.preventHistoryMerge(),l=this.isSelecting?this._selectionEnd>this._selectionStart:this.preferEnd,c=this.getLineIdByIndex(this._selectionEnd,l);var h=this.getPositionByLineAndIndex(c,this._selectionEnd);if(0===c)return void this.onExtraContentStartLine(e,h.x);var f=this.getIndexByPosition({x:h.x,y:h.y-this.client.element.lineHeight}),m=f.index;d=f.atEnd,p=m,p=(v=this.getMentionByIndex(p))?v.startIndex:p,i?this.updateSelection(p):this.updateCursor(p,d)}else if("ArrowDown"===n){if(this.preventHistoryMerge(),l=this.isSelecting?this._selectionEnd>this._selectionStart:this.preferEnd,c=this.getLineIdByIndex(this._selectionEnd,l),h=this.getPositionByLineAndIndex(c,this._selectionEnd),c===this.client.renderData.lines.length-1)return void this.onExtraContentEndLine(e,h.x);var v,g=this.getIndexByPosition({x:h.x,y:h.y+this.client.element.lineHeight});m=g.index,d=g.atEnd,p=m,p=(v=this.getMentionByIndex(p))?v.endIndex:p,i?this.updateSelection(p):this.updateCursor(p,d)}else"z"===n.toLowerCase()?e.ctrlKey||e.metaKey?(e.preventDefault(),this.undo()):e.shiftKey&&(e.preventDefault(),this.redo()):"y"===n.toLowerCase()?(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.redo()):"a"===n.toLowerCase()?(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.pickAll()):"b"===n.toLowerCase()?this.excludedStyles.includes("bolder")||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),this.setTextStyle("bolder",!this.getTextPropertyStatus("bolder"))):"i"===n.toLowerCase()?this.excludedStyles.includes("italic")||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),this.setTextStyle("italic",!this.getTextPropertyStatus("italic"))):"u"===n.toLowerCase()?this.excludedStyles.includes("underLine")||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),this.setTextStyle("underLine",!this.getTextPropertyStatus("underLine"))):"backspace"===n.toLocaleLowerCase()&&(a||o)&&_e.safari&&(e.preventDefault(),this.isSelecting?this.deleteSelected():this.selectionStart>0&&this.deleteBackword())}},e.prototype.onCompositionStart=function(e){this.isComposing=!0,this.composingAction=void 0},e.prototype.undoComposingAction=function(e){var t=e.opList,n={opList:e.reverseOpList,reverseOpList:t},i=this.currentStyle;this.applyAction(n),this.updateCursorBySelfAction(n,!1),this.currentStyle=i},e.prototype.onCompositionUpdate=function(e){var t=this.composingAction;if(t?(this.undoComposingAction(t),this.composingAction=void 0):(this.isSelecting&&(this.preventHistoryMerge(),this.doDelete(this.selectionStart,this.selectionEnd-this.selectionStart)),this.standby&&(this.preventHistoryMerge(),"single"===this.element.selectStatus?this.callEditorEditSelf():this.selectElementAndEditSelf(),this.doDelete(0,this.client.chars.length))),e.data){var n=this.selectionStart,i=yi(e.data),r=this.genAddAction(i,n,n);if(this.applyAction(r))t&&(this.applyAction(t),this.updateCursorBySelfAction(t),this.composingAction=t);else{this.composingAction=r;var o=n+i.length;this.updateCursor(o,!1,!1)}}},e.prototype.onCompositionEnd=function(e){this.editing?(this.composingAction&&(this.undoComposingAction(this.composingAction),this.composingAction=void 0),this.textareaDom&&(this.textareaDom.value=""),e.data?this.doAdd(e.data):(this.updateTextAreaValue(),this.updateTextAreaSelection())):this.composingAction=void 0},e.prototype.bindDom=function(e){var t=this;e.value="",_e.desktop&&e.focus(),this.textareaDom=e,this.isComposing=!1,this.updateTextAreaValue(),this.updateTextAreaSelection();var n=function(e){(t.editing||t.standby)&&t.filterInput(e)},i=function(e){t.filterKeydown(e)},r=function(n){var i;window._test_no_blur?e.focus():null===(i=t.editor)||void 0===i||i.stopEdit()},o=this.onCompositionStart.bind(this),a=this.onCompositionUpdate.bind(this),s=this.onCompositionEnd.bind(this),l=function(e){t.isSelecting&&!t.standby&&t.doCut(e,t.selectionStart,t.selectionEnd-t.selectionStart)},c=function(e){if(t.standby)return e.preventDefault(),e.stopPropagation(),t.element.upime.userEventManager.publish("copy",void 0),void t.updateTextAreaSelection();t.isSelecting&&t.doCopy(e,t.selectionStart,t.selectionEnd-t.selectionStart)},u=function(e){if(t.standby)e.preventDefault();else{var n=t.element.upime.readClipboardDataFromClipboardEvent(e);t.dealPaste(n)}},d=function(){t.windowblurState&&(t.callEditorEditSelf(),t.setSelectionStart(t.windowblurState.start),t.setSelectionEnd(t.windowblurState.end),t.windowblurState=void 0)},p=function(){void 0!==t.windowBlurTimer&&mr(t.windowBlurTimer)};return e.addEventListener("compositionstart",o),e.addEventListener("compositionupdate",a),e.addEventListener("compositionend",s),e.addEventListener("beforeinput",n),e.addEventListener("blur",r),e.addEventListener("keydown",i),e.addEventListener("cut",l),e.addEventListener("copy",c),e.addEventListener("paste",u),window.addEventListener("focus",d),window.addEventListener("blur",p),function(){e.removeEventListener("beforeinput",n),e.removeEventListener("blur",r),e.removeEventListener("keydown",i),e.removeEventListener("compositionstart",o),e.removeEventListener("compositionupdate",a),e.removeEventListener("compositionend",s),e.removeEventListener("cut",l),e.removeEventListener("copy",c),e.removeEventListener("paste",u),window.removeEventListener("focus",d),window.removeEventListener("blur",p),t.textareaDom=void 0,t.isComposing=!1,t.composingAction=void 0}},e.prototype.dealRemoteAction=function(e,t){void 0===t&&(t=!1),this.updateContentByRemoteAction(e),t||(this.actionHistory=[],this.undoHistory=[])},e.prototype.convertSelectedRichText2HTML=function(){if(this.editing&&this.selectionStart===this.selectionEnd)return null;try{var e=this.selectionStart,t=this.selectionEnd||this.client.chars.length,n=this.client.chars.slice(e,t).filter((function(e){return"\n"===e})).length+1,i=new Array(n).fill(null).map((function(){return{spans:[]}})),r=fe(this.client.content),o=0,a=0;r.forEach((function(n){var r=n[0],s=n[1];if(e<=o+r.length&&t>=o){var l=Math.max(0,e-o),c=Math.min(t-o,r.length),u=r.slice(l,c),d="";u.forEach((function(e){"\n"===e?(d?i[a].spans.push({text:d,data:s}):i[a].spans.push({text:"",data:s}),a+=1,d=""):d+=e})),i[a].spans.push({text:d,data:s})}o+=r.length}));var s=document.createElement("div");return i.forEach((function(e){var t=document.createElement("p");e.spans.forEach((function(e){var n=document.createElement("span");n.appendChild(document.createTextNode(e.text));var i=e.data,r=i.color,o=void 0===r?0:r,a=i.link,s=i.deleteLine,l=i.underLine,c=i.bolder,u=i.italic,d=i.highLight,p=n,h="#"+"00000".concat(o.toString(16)).slice(-6),f="color: ".concat(h,";");if(u&&(f+="font-style: italic;"),d&&(f+="background-color: #"+"00000".concat(d.toString(16)).slice(-6)+";"),(s||l)&&(f+="text-decoration: ".concat("".concat(s?"line-through":""," ").concat(l?"underline":"")),s)){var m=document.createElement("s");m.append(p),p=m}if(c){var v=document.createElement("b");v.append(p),p=v}if(a){var g=document.createElement("a");g.href=a,g.append(p),p=g}n.setAttribute("style",f),t.append(p)})),s.append(t)})),s}catch(e){return null}},e.prototype.updateStyle=function(e){this.defaultRichStyle=Ss(this.defaultRichStyle,e),this.currentStyle=Ss(this.currentStyle,e)},e.prototype.startMention=function(e){this.excludedStyles.includes("mention")||(this.element.upime.getMentionCandidate||this.element.upime.getMentionGroupAndCandidate)&&(this.endMention(),this.mentionEditor=new Py(e,this,this.element.upime),this.element.upime.view.addDomWidget(this.mentionEditor))},e.prototype.endMention=function(){var e=this.mentionEditor;e&&(this.element.upime.view.removeDomWidget(e),this.mentionEditor=void 0)},e.prototype.getCharWindoPosition=function(e){var t,n,i=(null===(t=this.element.parentRefSystem)||void 0===t?void 0:t.globalTransform.currentScale)||1,r=this.element.scale*i,o=this.client.renderData.lines,a=(1+(n=0===e?0:o[o.length-1].startIndex<=e?o.length-1:o.findIndex((function(t){return t.startIndex>e}))-1))*this.element.lineHeight,s=0,l=o[n],c=this.client.renderData.width-l.width;"left"===this.element.ha&&(c=0),"center"===this.element.ha&&(c/=2),s+=c;var u=e-o[n].startIndex;if(u>0){var d={fontSize:this.element.fontSize,fontFamily:this.element.fontFamily,lineHeight:this.element.lineHeight};s+=Wi(l.chars.slice(0,u),d).width}var p=this.element.textRect,h=p.x,f=p.y,m=p.height;p.width,s+=h,a+=f;var v=0;"bottom"===this.element.va&&(v=m-this.client.renderData.height),"middle"===this.element.va&&(v=(m-this.client.renderData.height)/2),a+=this.scrollTop+v,s*=r,a*=r;var g=Rt(this.element.getGlobalBox());return{x:s+=g.x,y:a+=g.y}},e.prototype.insertMention=function(e,t,n,i){var r=this.currentStyle,o=r.color,a=r.underLine,s=r.italic;this.updateCursor(e,!1,!1),this.doDelete(e,t+1),this.preventHistoryMerge();var l={color:1710618,underLine:a,italic:s,mention:i};this.doAdd("@".concat(n),l),this.currentStyle.color=o,this.doAdd(" "),this.syncedMention=!1},e.prototype.computMentionCard=function(){var e=this,t=[],n=this.getAllMentions().reverse();if(this.editing)if(this.isSelecting){var i=n.find((function(t){return t.startIndex===e.selectionStart&&t.endIndex===e.selectionEnd}));i&&t.push(exports.E(exports.E({},i),{type:"cursor"}))}else{var r=n.find((function(t){return t.startIndex===e.selectionStart||t.endIndex===e.selectionEnd}));r&&t.push(exports.E(exports.E({},r),{type:"cursor"}))}var o=this.hoveredMention;if(void 0!==o){var a=n.find((function(e){return e.startIndex<=o&&e.endIndex>=o}));a&&t.push(exports.E(exports.E({},a),{anchor:o,type:"hover"}))}R([],this.mentionCards,!0).forEach((function(n){if("hover"!==n.type||void 0===e.hoveredMention){var i=t.some((function(e){return n.isInMention(e.startIndex,e.endIndex)}));i?n.cancelRemove():n.remove()}else n.removeSync()})),t.forEach((function(t){var n;if(!e.mentionCards.some((function(e){return e.isInMention(t.startIndex,t.endIndex)}))){var i=new Dy(t.mentionTo,null!==(n=t.anchor)&&void 0!==n?n:t.startIndex,t.type,e,e.element.upime);e.element.upime.view.addDomWidget(i),e.mentionCards.push(i)}}))},e.prototype.removeMentionCard=function(e){this.mentionCards=this.mentionCards.filter((function(t){return t!==e})),this.element.upime.view.removeDomWidget(e)},e.prototype.checkIsPointInMention=function(e){var t=this.client.renderData,n=this.element,i=n.ha,r=n.lineHeight,o=e.x,a=e.y,s=Math.floor(a/r);if(s>=t.lines.length)return!1;var l=t.lines[s],c=t.width-l.width;if("center"===i&&(c/=2),"left"===i&&(c=0),o<c||o>=c+l.width)return!1;for(var u=l.spans,d=l.startIndex,p=0;p<u.length;p++){var h=p===u.length-1?l.width-u[p].x:u[p+1].x-u[p].x;if(o>=u[p].x+c&&o<u[p].x+h+c&&u[p].data.mention)return d;d+=yi(u[p].text).length}return!1},e.prototype.hoverMention=function(e){this.hoveredMention=e,this.computMentionCard()},e.prototype.unHoverAllMention=function(){this.hoveredMention=void 0,this.computMentionCard()},e.prototype.selectMention=function(e){this.activeMention=e,this.computMentionCard(),this.element.applySelectSelf()},e.prototype.unSelectMention=function(){this.activeMention=void 0,this.computMentionCard()},e.prototype.syncMention=function(){var e,t=this;if(!this.syncedMention){this.syncedMention=!0;var n=this.currentOp,i=null===(e=this.editor)||void 0===e?void 0:e.getElements()[0];if(n&&i){var r=function(){var e,r=n.getReverseData().find((function(e){return e.element===i}));if(r){var o=r.localOtActions;if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a],c=l.localOt,u=l.property;if(u&&(null===(e=u.richTextClient)||void 0===e?void 0:e.contentEditor)===t||!u&&t.element===i)return c.opList}return r.isCreate?t.client.content:void 0}}();if(r){var o=r.map((function(e){if("add"===Es(e))return e[1].mention})).filter(Boolean);if(0!==o.length){var a=i.id;this.element.upime.sendSCmd(9,Sy.Send,a,o,bi(this.client.chars))}}}}},e.prototype.onExtraContentStart=function(e){},e.prototype.onExtraContentEnd=function(e){},e.prototype.onExtraContentStartLine=function(e,t){},e.prototype.onExtraContentEndLine=function(e,t){},e.prototype.handleDeleteStart=function(){},e.prototype.handleDeleteEnd=function(){},e.prototype.calcReverseOt=function(e){for(var t=[],n=0,i=0,r=e;i<r.length;i++){var o=r[i];if("number"==typeof o)if(o>=0)t.push(o),n+=o;else{var a=n-o,s=this.getRichTextByRange(n,a);t.push.apply(t,s),n=a}else if("number"==typeof o[0]){for(var l=o[0],c=o[1],u=(a=n+l,0),d=s=this.getRichTextByRange(n,a);u<d.length;u++){var p=d[u],h=p[0],f=p[1],m={};for(var v in c)m[v]=f[v];t.push([h.length,m])}n=a}else h=o[0],t.push(-h.length)}return t},e}();function Oy(e,t){for(var n=0,i=0,r=t;i<r.length;i++){var o=r[i];if(n>e)break;if(Array.isArray(o))if("number"==typeof o[0])n+=o[0];else{var a=o[0].length;n+=a,e+=a}else if(o<0){if(n-o>e)return n;e+=o}else n+=o}return e}!function(e){e[e.mention=0]="mention",e[e.link=1]="link",e[e.italic=2]="italic",e[e.underLine=3]="underLine",e[e.bolder=4]="bolder",e[e.deleteLine=5]="deleteLine"}(By||(By={}));var Fy=function(){function e(e){this.element=e,this.hasNewRichText=!0,this._renderData={width:0,height:0,lines:[]},this.renderParams=[],this.chars=[],this._content=[],this.scroll=0,this.contentEditor=this.createContentEditor()}return e.prototype.handleKeyDown=function(e){return!1},e.prototype.handleInput=function(e){return!1},e.prototype.handlePaste=function(e){},e.prototype.initContent=function(e){if(this.content=e,this.chars=this.getCharsFromContent(this.content),this.contentEditor){var t=this.length;(this.contentEditor.selectionStart>t||this.contentEditor.selectionEnd>t)&&this.contentEditor.moveCursorToEnd()}},e.prototype.syncBufferedOperation=function(){},Object.defineProperty(e.prototype,"renderData",{get:function(){var e=this.renderParams,t=this.element,n=[t.fontSize,t.fontFamily,t.wordWrapWidth,t.lineHeight];return!this.hasNewRichText&&function(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}(e,n)||(this._renderData=this.calcRenderData()),this.renderParams=n,this.hasNewRichText=!1,this._renderData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(e){this.hasNewRichText=!0,this._content=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.chars.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEditor",{get:function(){return this.element.currentEditor},enumerable:!1,configurable:!0}),e.prototype.dealAck=function(){},e.prototype.applyAction=function(e){return this.updateContentWidthAction(e),0},e.prototype.updateContentWidthAction=function(e){this.content=Is(this.content,e.opList),this.chars=this.getCharsFromContent(this.content)},e.prototype.getCharsFromContent=function(e){var t=[];return e.forEach((function(e){return e[0].forEach((function(e){return t.push(e)}))})),t},e.prototype.createContentEditor=function(){return new Ly(this)},e.prototype.dealRemoteAction=function(e){this.updateContentWidthAction(e)},e.prototype.calcRenderData=function(){var e=this,t=this.content,n=this.chars,i=this.element,r=i.lineHeight,o=i.textRect.width;if(0===t.length)return{width:o,height:r,lines:[{startIndex:0,chars:[],width:0,spans:[]}]};var a=Ui(n),s=0,l=[],c=0,u=0,d=t[u][0].length,p=t[u][1],h=function(){0==d&&(u++,t[u]&&(d=t[u][0].length,p=t[u][1]))};return a.forEach((function(t){if(0===t.length){var n={startIndex:c,width:0,chars:[],spans:[]};return d-=1,c+=1,l.push(n),s+=r,void h()}var i=Wi(t,e.element,e.element.wordWrapWidth);o=Math.max(i.width,o),s+=i.lines.length*r,i.lines.forEach((function(e,t){for(var n="",r=[],o=e.length;e.length;){var a=Vi(n),s=Math.min(d,e.length),u=e.slice(0,s).join(""),f=pr((p.link||p.mention)&&1710618===p.color?3044325:p.color);r.push({text:u,data:p,x:a,textColor:f}),n+=u,d-=s,e=e.slice(s),h()}l.push({startIndex:c,width:i.lineWidths[t],spans:r,chars:i.lines[t]}),c+=o,t==i.lines.length-1&&(c+=1,d-=1,h())}))})),{width:o,height:s,lines:l}},e.prototype.getTextRelation=function(e,t){void 0===t&&(t=!1);var n=this.element,i=n.getBorderBox();if(!t&&0!==n.rotate){var r=i.left,o=i.top,a=i.right,s=i.bottom;e=an(e,-n.rotate,{x:(r+a)/2,y:(o+s)/2})}var l=n.scale,c=void 0===l?1:l,u=n.textRect,d=n.va,p=Math.min(u.height,this.renderData.height),h="top"===d?0:u.height-p;return"middle"===d&&(h/=2),{point:{x:(e.x-i.left)/c-u.x,y:(e.y-i.top)/c-u.y-h},textWidth:u.width,textHeight:p}},e.prototype.willStopEditing=function(){},e}(),zy=function(e){function t(t,n){var i=e.call(this,t)||this;return i.docContentEditor=n,i.fullSelected=!1,i}return P(t,e),Object.defineProperty(t.prototype,"standby",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSelectionStart",{get:function(){return this._selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSelectionEnd",{get:function(){return this._selectionEnd},enumerable:!1,configurable:!0}),t.prototype.fullSelect=function(e){void 0===e&&(e=!1),this.fullSelected=!0,e?(this._selectionStart=this.client.length,this._selectionEnd=0):(this._selectionStart=0,this._selectionEnd=this.client.length)},t.prototype.startNodeEdit=function(){this.editing=!0,this.fullSelected=!0,this.updateView()},t.prototype.stopNodeEdit=function(){this.editing=!1,this.fullSelected=!1,this.multiSelected=!1,this.selectedNextNode=!1,this._selectionStart=this._selectionEnd=0,this.endMention(),this.unSelectMention(),this.updateView()},t.prototype.moveCursorToPosition=function(t){this.fullSelected=!1,e.prototype.moveCursorToPosition.call(this,t)},t.prototype.setSelectionStart=function(t){this.fullSelected=!1,e.prototype.setSelectionStart.call(this,t)},t.prototype.setSelectionEnd=function(t){this.fullSelected=!1,e.prototype.setSelectionEnd.call(this,t)},t.prototype.handleDocInput=function(e){this.filterInput(e)},t.prototype.handleDocKeydown=function(e){this.filterKeydown(e)},t.prototype.onExtraContentStart=function(e){this.docContentEditor.selectToPrevNode({shiftKey:e.shiftKey})},t.prototype.onExtraContentEnd=function(e){this.docContentEditor.selectToNextNode({shiftKey:e.shiftKey})},t.prototype.onExtraContentStartLine=function(e,t){e.shiftKey||this.updateCursor(this._selectionEnd);var n=this.client.element,i=n.position;t+=n.textRect.x+i.x,this.docContentEditor.selectToPrevNode({shiftKey:e.shiftKey,pointInDoc:{x:t,y:0}})},t.prototype.onExtraContentEndLine=function(e,t){e.shiftKey||this.updateCursor(this._selectionEnd);var n=this.client.element,i=n.position;t+=n.textRect.x+i.x,this.docContentEditor.selectToNextNode({shiftKey:e.shiftKey,pointInDoc:{x:t,y:0}})},t.prototype.getSelectedContent=function(){return this.getRichTextByRange(this.selectionStart,this.selectionEnd)},t.prototype.deleteContentByRange=function(e,t){this.doDelete(e,t-e)},t.prototype.addContent=function(e){var t=this.client.length;this.selectionStart;var n=this.selectionEnd,i=0;e.forEach((function(e){return i+=e[0].length}));var r={opList:R(R([n],e,!0),[t-n],!1),reverseOpList:[n,-i,t-n]};this.applyAction(r),this.updateCursor(n+i,!1,!1)},t.prototype.addContentToEnd=function(e){var t=this.client.length,n=0;e.forEach((function(e){return n+=e[0].length}));var i={opList:R([t],e,!0),reverseOpList:[t,-n]};this.applyAction(i)},t.prototype.handleDeleteStart=function(){this.docContentEditor.mergeTextToPrevNode(this.client.element)},t.prototype.handleDeleteEnd=function(){this.docContentEditor.mergeNextNodeText(this.client.element)},t.prototype.mentionHandleKeydown=function(e){var t;return null===(t=this.mentionEditor)||void 0===t?void 0:t.handleKeyDowm(e)},t.prototype.selectMention=function(e){this.activeMention=e,this.computMentionCard(),this.docContentEditor.activeMentionClient=this},t.prototype.selectAnchor=function(e){this.docContentEditor.editing||this.docContentEditor.startEdit(),this.startNodeEdit(),this.docContentEditor.setSelectedNodes([this.client.element]),this.setSelectionStart(e.start),this.setSelectionEnd(e.end)},t.prototype.deleteAnchor=function(t){this.selectAnchor(t),e.prototype.deleteAnchor.call(this,t)},t.prototype.setAnchorUrl=function(t,n){this.selectAnchor(t),e.prototype.setAnchorUrl.call(this,t,n)},t.prototype.changeAnchorTextAndUrl=function(t,n,i){this.selectAnchor(t),e.prototype.changeAnchorTextAndUrl.call(this,t,n,i)},t.prototype.recoverEditAfterAnchor=function(e){this.selectAnchor(e),this.anchorEditor=void 0,this.updateView()},t.prototype.applyAction=function(t,n){var i=e.prototype.applyAction.call(this,t,n);return i||this.docContentEditor.recordTextOp(this.client.element,t),i},t.prototype.saveHistoryAction=function(){},t.prototype.preventHistoryMerge=function(){},t.prototype.setAnchorEditor=function(t){void 0===t&&this.anchorEditor!==this.docContentEditor.currentAnchorEditor||(this.docContentEditor.currentAnchorEditor=t),e.prototype.setAnchorEditor.call(this,t)},t.prototype.insertMention=function(t,n,i,r){e.prototype.insertMention.call(this,t,n,i,r),this.element.upime.sendSCmd(9,Sy.Send,this.client.element.docTree.id,[r])},t}(Ly),Hy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),Object.defineProperty(t.prototype,"textRect",{get:function(){return this.element.textRect},enumerable:!1,configurable:!0}),t.prototype.createContentEditor=function(){return new zy(this,this.element.docTree.docContentEditor)},t.prototype.applyAction=function(t){var n=e.prototype.applyAction.call(this,t);return n||(this.element.docTree.updateRenderFlow(),n)},t}(Fy),Uy="undefined"!=typeof OffscreenCanvas,Wy=function(e){function t(t){var n=e.call(this)||this;return n.richText=t,n.scrollTop=0,n.fontSize=14,n.textOpacity=1,n}return P(t,e),t.prototype.paint=function(e){if(!this.hide){var t=this,n=t.richText,i=t.fontSize,r=t.fontFamily,o=t.lineHeight,a=void 0===o?22:o,s=t.ha,l=void 0===s?"left":s,c=t.defaultFontWeight,u=this.textOpacity,d=e.context;e.transform;var p=e.alpha;if(e.viewWidth,e.viewHeight,p*u!=0){var h=ut({fontSize:14,fontFamily:r,fontWeight:c}),f=ut({fontSize:14,fontFamily:r,fontWeight:"bold"}),m=ut({fontSize:14,fontFamily:r,fontWeight:c,fontStyle:"italic"}),v=ut({fontSize:14,fontFamily:r,fontStyle:"italic",fontWeight:"bold"});n.width;var g=n.height,y=Math.max(0,Math.min(this.maxHeight||g,g)),b=this.scrollTop;b<0?b=0:b>g-y&&(b=g-y);var E=n.width,x=ct(i,r),w=y;d.font=h,d.globalAlpha=p*u;var C=!1,S=(a-x.height)/2;S-=b;var k=n.placeholder,_=k?[{spans:[{x:0,text:k.text,data:k.data,textColor:pr(k.data.color)}],width:k.width}]:n.lines,T="",I=i/14;d.save(),d.transform(I,0,0,I,0,0);for(var P=function(e){var t=_[e],n=t.spans,r=t.width,o=0;if(e*a+a-b<=0)return"continue";if(e*a-b>w)return"break";var s=e*a+x.ascent+S;"right"===l?o+=E-r:"center"===l&&(o+=(E-r)/2),n.forEach((function(r,l){var c=(r.x+o)/I,u=(l===n.length-1?t.width-r.x:n[l+1].x-r.x)/I,p=s/I,g=r.data,y=r.text,E=r.textColor,x=g.link,w=g.underLine,S=g.deleteLine,k=g.bolder,_=g.italic;T!==E&&(T=E,d.fillStyle=E),k||_?(d.font=k&&_?v:k?f:m,C=!0):C&&(d.font=h);var P=_?-i/20/I:0;if(d.fillText(y,c+P,p,u),(w||x||S)&&((w||x)&&(d.beginPath(),d.strokeStyle=E,d.lineWidth=1,d.moveTo(c,p+1.5),d.lineTo(c+u,p+1.5),d.stroke()),S)){var N=((e+.5)*a-b)/I;d.beginPath(),d.strokeStyle=E,d.lineWidth=1,d.moveTo(c,N+1.5),d.lineTo(c+u,N+1.5),d.stroke()}}))},N=0;N<_.length&&"break"!==P(N);N++);d.restore()}}},t.prototype.paintSvg=function(e){if(!this.hide){var t=this,n=t.richText,i=t.fontSize,r=t.fontFamily,o=t.lineHeight,a=void 0===o?22:o,s=t.ha,l=void 0===s?"left":s,c=t.defaultFontWeight;e.transform;var u=e.currentRoot;e.viewWidth,e.viewHeight,n.width;var d=n.height,p=Math.max(0,Math.min(this.maxHeight||d,d)),h=this.scrollTop;h<0?h=0:h>d-p&&(h=d-p);var f=n.width,m=ct(i,r),v=(a-m.height)/2;v-=h;var g=n.placeholder,y=g?[{spans:[{x:0,text:g.text,data:g.data}],width:g.width}]:n.lines,b=Jn("text");oi(b,{"font-family":r,"font-size":i}),u.appendChild(b);for(var E=function(e){var t=y[e],n=t.spans,r=t.width,o=0;if(e*a+a-h<=0)return"continue";if(e*a-h>p)return"break";var s=e*a+m.ascent+v;"right"===l?o+=f-r:"center"===l&&(o+=(f-r)/2),n.forEach((function(e,r){var a=e.x+o;r===n.length-1?(t.width,e.x):(n[r+1].x,e.x);var l=s,u=e.data,d=e.text,p=u.link,h=u.underLine,f=u.deleteLine,m=u.bolder,v=u.italic,g=pr(p&&1710618===u.color?3044325:u.color),y=Jn("tspan");y.appendChild(document.createTextNode(aa(d))),oi(y,{x:a+(v?-i/20:0),y:l,fill:g}),m?ri(y,"font-weight","bold"):c&&ri(y,"font-weight",c),v&&ri(y,"font-style","italic");var E="";if((h||p)&&(E+="underline"),f&&(E&&(E+=" "),E+="line-through"),E&&ri(y,"text-decoration",E),p){var x=Jn("a");oi(x,{href:p,target:"_blank"}),b.appendChild(x),x.appendChild(y)}else b.appendChild(y)}))},x=0;x<y.length&&"break"!==E(x);x++);}},t}(ht);var Vy=function(){function e(e){this.offscreenCanvas=e,this.opacity=1}return e.prototype.paint=function(e){var t=e.context,n=e.alpha,i=this.opacity;n*i!=0&&(t.globalAlpha=n*i,t.drawImage(this.offscreenCanvas,0,0,this.offscreenCanvas.width,this.offscreenCanvas.height))},e.prototype.paintSvg=function(){},e}(),jy=function(e){var t=e.x,n=e.y,i=e.element,r=e.richClient,o=e.maxHeight,a=e.isWheeling,s=void 0!==a&&a,l=e.inputBlocked,c=void 0!==l&&l,u=e.defaultFontWeight,d=js.value,p=d.viewbox,h=void 0!==d.exportType,f=i.fontSize,m=i.lineHeight,v=i.ha,g=void 0===v?"left":v,y=i.va,b=void 0===y?"top":y,E=i.fontFamily,x=i.scale,w=void 0===x?1:x,C=i.wordWrapWidth,S=i.globalTransform.currentScale*i.scale*p.scale,k=m*S,_=1;k<5&&(_=k>1?(k-1)/4:0);var T=w,I=r.renderData,P=r.contentEditor,M=P.selectedNextNode,A=P.multiSelected,D=P.anchorEditor,R=P.hoveredMentionTarget,B=P.activeMentionTarget,L=!P.editing&&void 0!==D,O=B||R,F=!P.editing&&void 0!==O,z=L||F,H=P.editing?P.selectionStart:L?D.start:F?O.startIndex:void 0,U=P.editing?P.selectionEnd:L?D.end:F?O.endIndex:void 0,W=P.currentStyle,V=P.preferEnd,j=i.useMemo("selectData",(function(){var e=void 0;if(void 0===H||void 0===U)return{};var t=0,n=I.lines,i=P.getLineIdByIndex(H,H===U&&V),o=i*m,a={fontSize:f,fontFamily:E,lineHeight:m},s=n[i]||{width:0,startIndex:0,chars:""},l=I.width-s.width;if("left"===g?l=0:"center"===g&&(l/=2),t+=l,H>s.startIndex&&(t+=Wi(s.chars.slice(0,H-s.startIndex),a).width),U===H)return A?H===r.length&&M?{selectionArea:[{x:t,y:o,width:m/5}]}:{}:{selectionCursor:{x:t,y:o}};var c=P.getLineIdByIndex(U,!0),u=n[c],d=0,p=c*m,h=I.width-u.width;if("left"===g?h=0:"center"===g&&(h/=2),d+=h,U>u.startIndex&&(d+=Wi(u.chars.slice(0,U-u.startIndex),a).width),i===c)e=[{x:t,y:o,width:d-t}];else{e=[{x:t,y:o,width:l+s.width-t}];for(var v=o,y=i+1;y<c;y++){var b=I.width-n[y].width;"left"===g?b=0:"center"===g&&(b/=2),v+=m,e.push({x:b,y:v,width:n[y].width})}e.push({x:h,y:p,width:d-h})}return U===r.length&&M&&(e[e.length-1].width+=m/5),{selectionArea:e}}),[A,M,r.length,H,U,V,I,g]),G=j.selectionCursor,q=j.selectionArea,K=0;if(P.editing&&void 0!==o){if(K=P.scrollTop,o<I.height){K>I.height-o&&(K=I.height-o);var Y=void 0;G?Y=G.y:q&&(Y=P.cursorIndex===H?q[0].y:q[q.length-1].y),void 0!==Y&&(Y+m===I.height&&0!==Y?K=Y+m-o:Y<=K?K=Y:Y+m>o+K&&(K=m>=o?Y:Y+m-o))}else K=0;P.scrollTop=K}else void 0!==o&&o<m&&(K=(m-o)/2);var X=0;void 0!==o&&"top"!==b&&I.height<o&&(X=o-I.height,"middle"===b&&(X/=2)),P&&(P.cursorPosition=G?{x:G.x,y:G.y+X-K}:void 0);var Q={fontSize:f,fontFamily:E,lineHeight:m,ha:g},Z=i.useMemo("offscreenTextCanvas",(function(){return function(e){var t=e.richText,n=N(e,["richText"]),i=_e.safari?4096:1e4;if(t.width>=i||t.height>=i)return null;for(var r=0,o=0;o<t.lines.length&&!((r+=t.lines[o].chars.length)>=128);o++);if(r<128)return null;var a=new Wy(t);Object.assign(a,exports.E(exports.E({},n),{textOpacity:1}));var s=t.width,l=t.height,c=Uy?function(e,t){var n=new OffscreenCanvas(e,t),i=n.getContext("2d");return{canvas:n,ctx:i}}(s,l):function(e,t){var n=document.createElement("canvas");n.width=e,n.height=t;var i=n.getContext("2d");return{canvas:n,ctx:i}}(s,l),u=c.canvas,d={context:c.ctx,alpha:1,transform:sr,viewWidth:0,viewHeight:0,drawImageCount:0};return a.paint(d),u}(exports.E({richText:I,scrollTop:K,maxHeight:o,textOpacity:_},Q))}),[I,g,b,K,o]);if(fa({x:t,y:n}),void 0!==o&&I.height>o&&za([new wa({x:-m*T/30,y:0,width:C*T+m*T/15,height:o*T})]),Ky({element:i,y:X*T,richText:I,style:Q,viewScale:T,scrollTop:K}),q&&!h&&qy({data:q,lineHeight:m,scale:T,deltaY:X-K,isFocusing:z}),_>0){fa({y:X*T,scaleX:T,scaleY:T});var J=T*i.globalTransform.a*p.scale*Q.fontSize,$=_e.desktop?10:6,ee=s?$:6;"svg"!==js.value.exportType&&Z&&J<=ee?function(e){var t=new Vy(e);sa.processElement(t)}(Z):function(e){var t=e.richText,n=N(e,["richText"]),i=new Wy(t);Object.assign(i,n),sa.processElement(i)}(exports.E(exports.E({richText:I,scrollTop:K,maxHeight:o,textOpacity:_},Q),{defaultFontWeight:u})),ma()}G&&!h&&Gy({element:i,data:G,lineHeight:m,scale:T,currentStyle:W,deltaY:X-K,isFocusing:z,inputBlocked:c}),ma()},Gy=function(e){var t=e.element,n=e.data,i=e.lineHeight,r=e.scale,o=e.currentStyle,a=e.deltaY,s=void 0===a?0:a,l=e.isFocusing,c=e.inputBlocked,u=void 0!==c&&c,d=(performance.now()-t.useMemo("cursorShowTime",(function(){return performance.now()}),[n,l,o]))%1e3,p=d<500||u,h=js.value.renderApp;!u&&(null==h||h(d<500?500-d:1e3-d,t)),(p||l)&&Na((function(e){e.clear();var t=o.link,a=o.color;e.beginFill(l?12632256:t&&1710618===a?3044325:a,1),e.drawRect(n.x*r-i*r/30,n.y*r+s*r,i*r/15,i*r)}))},qy=function(e){var t=e.data,n=e.lineHeight,i=e.scale,r=e.deltaY,o=void 0===r?0:r,a=e.isFocusing;Na((function(e){e.clear(),e.beginFill(a?12632256:6134012,.5),t.forEach((function(t){var r=t.x,a=t.width,s=t.y;0==a&&(a=n/4),e.drawRect(r*i,s*i+o*i,a*i,n*i)}))}))},Ky=function(e){var t=e.element,n=e.richText,i=e.style,r=e.viewScale,o=e.y,a=void 0===o?0:o,s=e.scrollTop,l=void 0===s?0:s,c=i.lineHeight,u=i.ha,d=t.useCallback("drawHighLight",(function(e){e.clear();for(var t=c*r,i=n.lines,o=Math.floor(l/c);o<i.length;o++){var a=c*o;if(a>=l+n.height)break;var s=i[o],d=n.width-s.width;"center"===u?d/=2:"left"===u&&(d=0);for(var p=s.spans,h=0;h<p.length;h++){var f=p[h],m=f.data.highLight;if(null!=m){var v=(d+f.x)*r,g=(a-l)*r,y=h===p.length-1?s.width-f.x:p[h+1].x-f.x;y*=r,e.beginFill(m,1),e.drawRect(v,g,y,t)}}}}),[n,c,u,r,l]);Na(d,{y:a})};function Yy(e){return"text"===e.nodeTag}var Xy=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.docTree=i,r.nodeSelected=!1,r.blockSelected=!1,r.moving=!1,r.va="top",r.editing=!1,r.ha="left",r.lineHeightRate=We,r.lineHeight=16*We,r.fontFamily=He,r.nodeTag="text",r.childIndex=-1,r.children=[],r.hasBg=!1,r.textStyle={type:"rawText"},r.fontSize=16,r.bgColor=0,r.richTextClient=new Hy(r),r.textRect={x:0,y:0,width:0,height:0},r.marginTop=12,r.marginBottom=0,r.marginLeft=0,r.paddingLeft=0,r.indentWidth=32,r.outerWidth=0,r.wordWrapWidth=0,r.treeHeight=0,r.topDistance=0,r.bottomDistance=0,r._seqText="",r.parentRefSystem=i.docRefsystem,r}return P(t,e),Object.defineProperty(t.prototype,"supportChild",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return"rawText"===this.textStyle.type&&0===this.textClient.length&&0===this.children.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seqText",{get:function(){return this._seqText},set:function(e){var t;this._seqText,this._seqText=e,e?(this.updateSeqTextData(),this.paddingLeft=((null===(t=this.seqTextData)||void 0===t?void 0:t.metrics.width)||0)+8):(this.seqTextData=void 0,this.paddingLeft=0),this._seqText=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textClient",{get:function(){return this.richTextClient},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.richTextClient.content},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentPath",{get:function(){return this.parent?"root"===this.parent.nodeTag?[]:R(R([],this.parent.parentPath,!0),[this.parent.id],!1):["null"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentId",{get:function(){return this.parent?"root"===this.parent.nodeTag?"root":this.parent.id:"null"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderSize",{get:function(){return this.size},enumerable:!1,configurable:!0}),t.prototype.getBorderBox=function(){var e=this.position,t=this.size;return{left:e.x,top:e.y,right:e.x+t.width,bottom:e.y+t.height}},t.prototype.getGlobalBox=function(){var e=this.getBorderBox();return this.globalTransform.applyBorderBox(e)},t.prototype.init=function(e,t){this.dealStateChange(e),t&&this.richTextClient.initContent(t),this.updateInputObserver()},t.prototype.dealStateChange=function(e){var t=e.textStyle,n=e.ha,i=this.fontSize;if(n&&(this.ha=n),t){this.marginTop="title"===t.type?20:12;var r;(r="title"===t.type&&[26,22,20,18,16][t.level-1]||16)!==i&&(this.fontSize=r,this.lineHeight=r*this.lineHeightRate,this.seqText&&this.updateSeqTextData()),this.textStyle=t,this.updateInputObserver()}},t.prototype.getInitState=function(){return{textStyle:this.textStyle,ha:this.ha}},t.prototype.updateOuterWidth=function(e){this.outerWidth=e,this.textRect.width=this.wordWrapWidth=e-this.paddingLeft;var t=this.richTextClient.renderData;this.size={width:e,height:t.height},this.textRect={x:this.paddingLeft,y:0,width:this.wordWrapWidth,height:t.height}},t.prototype.render=function(){var e=js.value.renderApp,t=this;t.textStyle,t.richTextClient,t.textRect;var n=t.position,i=n.x,r=n.y,o=t.blockSelected,a=t.docTree,s=a.scrollTop,l=a.size.height,c=t.size,u=c.width,d=c.height,p=t.treeHeight;if(o&&r-4<s+l&&r+p+8>s&&Na((function(e){e.beginFill(15397372,1),e.drawRoundedRect(i-4,r-4,u+8,p+8,4)})),void 0!==this.blinkStartTime&&!o&&r-4<s+l&&r+p+8>s){var h=performance.now()-this.blinkStartTime;if(h<1500){var f=.5*(h<1e3?1:(1500-h)/500);Na((function(e){e.beginFill(6134012,f),e.drawRoundedRect(i-4,r-4,u+8,p+8,4)})),null==e||e(h<1e3?1e3-h:0,this.docTree)}}r+d>s&&r<s+l&&this.renderContent()},t.prototype.renderContent=function(){var e=this,t=e.textStyle,n=e.richTextClient,i=e.textRect,r=e.position,o=r.x,a=r.y,s=e.seqTextData;fa({x:o,y:a});var l="title"===t.type?"700":void 0;if(s){var c=ct(this.fontSize,this.fontFamily),u=s.metrics.fontProperties,d=c.ascent-c.height/2-u.ascent+u.height/2,p=0;if("left"!==this.ha){var h=this.richTextClient.renderData;p=h.width-h.lines[0].width,"center"===this.ha&&(p/=2)}Ra(s,{x:p,y:d,fill:"#1456f0",fontWeight:l})}this.docTree.isEmpty&&Ra({text:O("bigDoc.placeholder"),lineHeight:this.lineHeight,fontSize:this.fontSize,fontFamily:this.fontFamily},{x:i.x,y:i.y,fill:"#C2C3C8"}),jy({x:i.x,y:i.y,element:this,richClient:n,isWheeling:this.upime.view.isWheeling,inputBlocked:this.docTree.docContentEditor.inputLocked,defaultFontWeight:l}),ma()},t.prototype.textSelect=function(e){void 0===e&&(e=!1),this.nodeSelected=!0,this.richTextClient.contentEditor.startNodeEdit(),this.richTextClient.contentEditor.fullSelect(e)},t.prototype.unTextSelect=function(){this.richTextClient.contentEditor.stopNodeEdit(),this.nodeSelected=!1},t.prototype.startEditAnchor=function(){if(this.hoveringTextAnchor=void 0,this.upime.selectElement(this.docTree),this.textClient.contentEditor.anchorEditor){var e=this.docTree.docContentEditor;e.editing||e.startEdit()}},t.prototype.blockBlink=function(){var e=this;this.blinkStartTime=performance.now(),setTimeout((function(){e.blinkStartTime=void 0}),1500),this.upime.updateView()},t.prototype.updateSeqTextData=function(){var e=this.seqTextData,t=this,n=t.seqText,i=t.fontSize,r=t.lineHeight;if(n){if(!e||e.text!==n||e.fontSize!==i){var o={text:n,fontFamily:'"Helvetica Neue","Consolas"',fontSize:i,lineHeight:r};this.seqTextData=exports.E(exports.E({},o),{metrics:Da(o)})}}else this.seqTextData=void 0},t.prototype.updateInputObserver=function(){var e=this.textStyle;"rawText"===e.type||"title"===e.type&&null===e.index?this.inputOberver||(this.inputOberver=this.checkIsSeq.bind(this),this.textClient.contentEditor.addInputObserver(this.inputOberver)):this.inputOberver&&(this.textClient.contentEditor.removeInputObserver(this.inputOberver),this.inputOberver=void 0)},t.prototype.checkIsSeq=function(e,t){if(" "!==e)return!1;var n=this.textClient,i=n.contentEditor,r=n.chars,o=i.selectionStart,a=i.selectionEnd;if(o!==a)return!1;if(1===a&&"*"===r[0])return this.docTree.docContentEditor.addSeqToNode(this),!0;for(var s=0,l=0;l<a-1;l++){var c=r[l];if(!/^\d$/.test(c))return!1;s=10*s+parseInt(c)}return"."===r[a-1]&&(this.docTree.docContentEditor.addSeqToNode(this,s),!0)},t.prototype.checkNodeRelation=function(e,t){var n,i=t.type,r=void 0!==this.docTree.currentEditor,o="select"===this.upime.xmode,a={},s={transparent:!1,metric:-1,metaData:a};if(r&&"click"===i&&o){var l=t.evt;if("right"===l.connectType)return n={type:"textMenu",position:l.globalPosition},a.clickData={customData:n},s}if(!r&&("hover"===i||"click"===i)||!o&&"click"===i){var c=this.checkRichTextHoverClick(e,t);if(c){n="hover"===i?{type:"hover",nodeId:this.id}:{type:"click",node:this};var u=c.textAnchor,d=c.mentionStartIndex,p=c.mobileHover;return n.mobileHover=p,u&&(n.textAnchor=u),void 0!==d&&(n.mentionStartIndex=d),a.clickData={customData:n},s}if("hover"===i)return null}if(!o||!r)return null;var h=this.textRect,f=e.x-this.position.x,m=e.y-this.position.y,v={x:f-h.x,y:m-h.y};if(m>=-this.topDistance/2&&v.y<=h.height+this.bottomDistance/2){var g,y=this.docTree.docContentEditor.editing;if(g="hover"===i?{type:"hover",nodeId:this.id,cursor:y?"text":""}:{type:"nodeSelect",node:this,pointInNode:v},"move"===i){if(!y)return null;a.directCtrlData=g}else a.clickData={customData:g};return s}return null},t}(oy);function Qy(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,e.freshAiCount()];case 1:return(t=n.sent())?e.aiCountInPackage+e.aiCountOutPackage<1?(e.aiServerHelper.showToBuyToast(),[2,!1]):(e.minusCurrentAiCount(),[2,t]):[2,!1]}}))}))}function Zy(e,t,n,i){return A(this,void 0,void 0,(function(){function r(t){e.publish("sdkAction",{type:"useAiGenerateMindmapEnd",payload:{success:!1,errorType:5050===t?"noAISession":"unkonw",rootId:n.id}})}function o(t){if(void 0===t&&(t=!0),e.clearLock(h),n&&!n.deleted){var i=y||e.createOperation(),o=n.onAlignTheTree(i);i.sync(),0===o.length&&e.deleteOperation(i)}t&&function(){var t=g.filter((function(e){return!e.deleted&&!e.isMindmapNodeHideByCollapsed}));if(l&&t.push(n),t.length>0&&!e.followManager.forcedFollowing){e.operationInterrupt(),e.selectElements(t);var i=Yt(t.map((function(e){return e.getGlobalBox()}))),o=.2*e.view.viewWidth,a=.2*e.view.viewHeight;null==c||c(),Promise.race([e.makeBorderCenter(i,{left:o,right:o,top:a,bottom:a}),Dc(1)]).finally((function(){null==u||u()}))}g.length>0?(e.addToast(O("ai.using.done")),e.publish("sdkAction",{type:"useAiGenerateMindmapEnd",payload:{success:!0,rootId:n.id}})):r(0)}()}var a,s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:return e.isUsingAi?[2]:(e.isUsingAi=!0,s=(a=i||{}).isSelectRoot,l=void 0!==s&&s,c=a.beforeMoveBoard,u=a.afterMoveBoard,d=a.onFreshedAiCount,p=a.onFreshAiCountEndAbort,h=e.createLock([n.id]),f=!1,e.aiAborter=function(){f=!0,o(n&&!n.eleHided)},(m=new Map).set(1,n.id),v=new Set,g=[],y=void 0,b=0,[4,Qy(e)]);case 1:return E=x.sent(),f?(null==p||p(),[2]):(null==d||d(Boolean(E)),E?(e.aiServerHelper.generateMindmapNodeUsingAi(t,E).then((function(t){if(!f){if(!t)return e.onAiGenerteEnd(),o(!1),void r(5050);var i=t.getXhr(),a=t.result;i.onprogress=function(t){var i;if(!f){if(n.deleted)return e.onAiGenerteEnd(),o(!1),void(f=!0);var r,a=(r=(null===(i=t.target)||void 0===i?void 0:i.responseText).split("\n").slice(b).filter(Boolean).map((function(e){return oa(e)})).filter(Boolean),b+=r.length,r.map((function(t){var n,i;v.add(t.id);var r=m.get(t.parentId);if(r){var o=e.elementManager.getElementById(r);if(o&&!o.deleted&&o.elementType===Za.MINDMAP_NODE){var a=e.createOperation();y=a;var s=o.mindMapConnectableLocations[0],l=[[t.text.split(""),{color:1710618}]],c=e.insertMindMapNode(o,{location:s},void 0,{op:y,noEdit:!0,noSelect:!0,content:l}),u=null==c?void 0:c.root;return(null==u?void 0:u.getDescendants().some((function(e){return!e.isRootNode&&e.isOutofLayout})))&&((null===(n=null==c?void 0:c.parent)||void 0===n?void 0:n.isOutofLayout)||null===(i=null==c?void 0:c.parent)||void 0===i||i.alignChildNodes(y,{isFitLayout:!1})),c&&m.set(t.id,c.id),c}}})));a.forEach((function(e){e&&g.push(e)}))}},a.then((function(t){var n=t.code;f||5050===n&&(e.onAiGenerteEnd(),o(!1),e.aiServerHelper.showToBuyToast(),r(5050))})).finally((function(){f||(e.onAiGenerteEnd(),o(),0===g.length&&(e.addToast(O("ai.error")),r(0)))}))}})).catch((function(t){e.addToast(O("ai.error")),r(t)})),[2]):(e.isUsingAi=!1,[2,!1]))}}))}))}function Jy(e){return[yi(e.text),{color:1710618,italic:e.italic,bolder:e.border}]}function $y(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return t.isUsingAi?[2]:(t.isUsingAi=!0,n=!1,t.aiAborter=function(){n=!0},[4,Qy(t)]);case 1:return i=s.sent(),n?[2,!1]:i?(r=new Ks,[4,t.aiServerHelper.generateDocumentUsingAi({keyword:e},i)]):(t.isUsingAi=!1,[2,!1]);case 2:return!(o=s.sent())||n?[2,!1]:(a=o.getXhr(),o.result.then((function(){n||(function(){var e,n=a.responseText.split("\n").filter(Boolean).map((function(e){return oa(e)})).filter(Boolean);if(n.length){var i={nodes:[],tree:[]},r=null===(e=n.find((function(e){return"title"===e.type})))||void 0===e?void 0:e.richContent.map((function(e){return e.text})).join("");n.forEach((function(e){var n=t.genID("n"+Za.BIG_DOC),r=void 0;switch(e.type){case"title":r={type:"title",level:e.level,index:null};break;case"orderedList":r={type:"orderedList",index:-1};break;case"todo":r={type:"todo",checked:!1};break;default:r={type:e.type}}var o={id:n,nodeTag:"text",content:e.richContent.map(Jy),state:{textStyle:r}};i.nodes.push(o),i.tree.push(n)}));var o=t.createOperation(),s=function(e,n,i){var r=t.view.getViewbox(),o=r.left+(r.right-r.left)/2,a=r.top+(r.bottom-r.top)/2,s=t.insertBigDocAt({x:o,y:a},{op:e,nodeTree:n,name:i,unSelect:!0}),l=s.getBorderBox(),c=Rt(l),u=Jg({left:l.left-c.width/2,right:l.right-c.width/2,top:l.top-c.height/2,bottom:l.bottom-c.height/2},t,(function(e){return e===s}));u[0];var d=u[1];e.update(s,{position:{x:d.left,y:d.top}});var p=Lt(d);if(!t.followManager.forcedFollowing){var h=t.view.getViewbox(),f=Lt(h),m=p.x-f.x,v=p.y-f.y,g={left:h.left+m,right:h.right+m,top:h.top+v,bottom:h.bottom+v};t.makeBorderCenter(g)}return s}(o,i,r);o.sync(),t.switchMode("select"),t.selectElement(s)}}(),t.onAiGenerteEnd(),t.addToast(O("ai.using.done")))})).catch((function(e){n||(t.onAiGenerteEnd(),t.addToast(O("ai.error")))})).finally((function(){return r.done(!0)})),[2,r.result])}}))}))}var eb,tb={S:.54,M:1.07,L:1.85};!function(e){e[e.SQUARE=0]="SQUARE",e[e.RECT=1]="RECT"}(eb||(eb={}));var nb,ib=function(e,t){return Math.ceil(e*(t||1.36))};function rb(e,t,n,i,r,o){return A(this,void 0,void 0,(function(){function a(){window.clearInterval(g),e.clearLock(v)}var s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:return e.isUsingAi?[2]:(e.isUsingAi=!0,s=!1,e.aiAborter=function(){s=!0,a()},c=(l=o||{}).isSelectRoot,u=void 0!==c&&c,d=l.beforeMoveBoard,p=l.afterMoveBoard,h=l.onFreshedAiCount,f=l.onFreshAiCountEndAbort,m=Yt(n.map((function(e){return e.getGlobalBox()}))),v=e.createLock(n.map((function(e){return e.id}))),g=window.setInterval((function(){n.every((function(e){return e.deleted}))&&(s=!0,e.onAiGenerteEnd(),a())}),100),y=n.length>1?80:.2*Rt(n[0].getGlobalBox()).width,b=function(t){s||(e.onAiGenerteEnd(),a(),5050!==t?e.addToast(O("ai.error")):e.aiServerHelper.showToBuyToast())},[4,Qy(e)]);case 1:return E=x.sent(),s?(null==f||f(),[2]):(null==h||h(Boolean(E)),E?(e.aiServerHelper.generateCommonContentUsingAi({texts:t,type:i,translate:r},E).then((function(t){if(!s){if(!t)return e.onAiGenerteEnd(),void a();(0,ab[i])(t,{targets:n,upime:e,originBorder:m,placeGap:y}).then((function(t){if(!s)if(e.onAiGenerteEnd(),a(),t&&t.length>0){u&&t.push.apply(t,n),e.addToast(O("ai.using.done")),e.followManager.forcedFollowing||e.selectElements(t);var i=Yt(t.map((function(e){return e.getGlobalBox()})));!function(e,t,n){if(!t.followManager.forcedFollowing){var i=n||{},r=i.beforeMoveBoard,o=i.afterMoveBoard,a=.2*t.view.viewWidth,s=.2*t.view.viewHeight;null==r||r(),Promise.race([t.makeBorderCenter(e,{left:a,right:a,top:s,bottom:s}),Dc(1)]).finally((function(){null==o||o()}))}}(i,e,{afterMoveBoard:p,beforeMoveBoard:d})}else e.addToast(O("ai.error"))})).catch(b)}})).catch(b),[2]):(e.isUsingAi=!1,[2,!1]))}}))}))}var ob,ab=((nb={})[Ct.Sticker]=function(e,t){return A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){return n=t.upime,i=t.targets,cb(e)?[2,!1]:[2,mb(lb(e),n,i)]}))}))},nb[Ct.Summary]=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){return n=t.upime,i=t.targets,r=t.originBorder,o=t.placeGap,cb(e)?[2,!1]:[2,gb(sb(e),n,i,r,o)]}))}))},nb[Ct.Todo]=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){return n=t.upime,i=t.targets,r=t.originBorder,o=t.placeGap,cb(e)?[2,!1]:[2,gb(lb(e).join("\n"),n,i,r,o)]}))}))},nb[Ct.Translate]=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){return cb(e)?[2,!1]:(n=t.upime,i=t.targets,r=t.originBorder,o=t.placeGap,Nu(i[0])?[2,gb(sb(e),n,i,r,o)]:[2,vb(e,n,i,r,o)])}))}))},nb[Ct.Polishing]=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){return cb(e)?[2,!1]:(n=t.upime,i=t.targets,r=t.originBorder,o=t.placeGap,[2,gb(sb(e),n,i,r,o)])}))}))},nb);function sb(e){return Array.isArray(e)?e.join(""):e}function lb(e){return Array.isArray(e)?e:[e]}function cb(e){return""===sb(e)}function ub(e,t,n){e.forEach((function(e){if(e.isSupportFrame&&e.parentRefSystem===n.view.elementsRoot){var i=e.getBorderBox(),r=n.getAllFrames().find((function(e){return e.checkBorderInFrame(i)}));r&&t.update(e,{frameId:r.id})}}))}function db(e,t,n,i,r){var o=t+r,a=n+r,s={x:i.x+i.width+o*e-t,y:i.y,place:"right",place2:"bottom"},l={x:i.x-o*e,y:i.y,place:"left",place2:"bottom"},c={x:i.x+i.width/2-t/2,y:i.y+i.height+a*e-n,place:"right",place2:"bottom"},u={x:i.x+i.width/2-t/2,y:i.y-a*e,place:"right",place2:"top"},d=T(s,e,"right","bottom"),p=d.pop(),h=I(c,e-1,"right","bottom"),f=R(R(R([],d,!0),h,!0),[p],!1),m=P(s,e,"right","top"),v=m.pop(),g=I(u,e-1,"right","top"),y=R(R(R([],m,!0),g,!0),[v],!1),b=T(l,e,"left","bottom"),E=b.pop(),x=N(c,e-1,"left","bottom"),w=R(R(R([],b,!0),x,!0),[E],!1),C=P(l,e,"left","top"),S=C.pop(),k=N(u,e-1,"left","top"),_=R(R(R([],C,!0),k,!0),[S],!1);function T(e,t,n,i){for(var r=[],o=1;o<=t;o++)r.push({x:e.x,y:e.y+o*a,place:n,place2:i});return r}function I(e,t,n,i){for(var r=[],a=1;a<=t;a++)r.push({x:e.x+a*o,y:e.y,place:n,place2:i});return r}function P(e,t,n,i){for(var r=[],o=1;o<=t;o++)r.push({x:e.x,y:e.y-o*a,place:n,place2:i});return r}function N(e,t,n,i){for(var r=[],a=1;a<=t;a++)r.push({x:e.x-a*o,y:e.y,place:n,place2:i});return r}return R(R(R(R(R([s,c],f,!0),y,!0),[u,l],!1),w,!0),_,!0)}function pb(e,t,n,i,r,o,a){var s=.8*a,l=o.filter((function(t){return Kt(t,e)})),c=[];if("right"===i)for(var u=e.left;u<=e.right;u+=a+t)c.push(u);else for(u=e.right-t;u+t>=e.left;u-=a+t)c.push(u);for(var d=R(["bottom"===r?e.top:e.bottom],l.map((function(e){return"bottom"===r?e.bottom+a:e.top-a})),!0).filter((function(t){return"bottom"===r?t>=e.top&&t+n<=e.bottom:t-n>=e.top&&t<=e.bottom})),p=0;p<c.length;p++)for(var h=c[p],f=function(e){var i=d[e],o={left:h,right:h+t,bottom:0,top:0};"bottom"===r?(o.top=i,o.bottom=i+n):(o.bottom=i,o.top=i-n);var a={left:o.left-s,right:o.right+s,top:o.top-s,bottom:o.bottom+s};if(0===l.length||l.every((function(e){return!Kt(a,e)})))return{value:[!0,{x:o.left,y:o.top}]}},m=0;m<d.length;m++){var v=f(m);if("object"==typeof v)return v.value}return[!1,{x:0,y:0}]}function hb(e,t,n,i,r,o){for(var a=n.filter((function(e){return!e.deleted})),s=a.length>0?Yt(a.map((function(e){return e.getGlobalBox()}))):i,l=Rt(s),c=o.elementManager.getAllElements().filter((function(e){return e.elementType!==Za.FRAME})).map((function(e){return e.getGlobalBox()})),u=1;u<6;u++)for(var d=Math.max(e,l.width),p=Math.max(t,l.height),h=db(u,d,p,l,r),f=0;f<h.length;f++){var m=h[f],v=pb({left:m.x,right:m.x+d,top:m.y,bottom:m.y+p},e,t,m.place,m.place2,c,r),g=v[0],y=v[1];if(g)return y}return{x:s.right+r,y:s.top}}function fb(e,t){var n={scale:e.scale,hasBg:e.hasBg,bgColor:e.bgColor,bgOpacity:e.bgOpacity,ha:e.ha,va:e.va,fontSize:e.fontSize,lineHeight:e.lineHeight,fontFamily:e.fontFamily};t.updateTextConfig(n)}function mb(e,t,n){var i=n[0],r=20*i.scale,o=10*i.scale;t.operationInterrupt();var a=function(e){for(var t=1;Math.pow(t,2)<e;t++);return t}(e.length),s=_t.chunk(e,a),l=s.length,c=t.createOperation(),u=[];s.forEach((function(e){u.push([]),e.forEach((function(e){var t=function(e,t,n,i){var r=i[0],o=zs(r,r.elementType);o.position={x:0,y:0},o.frameId=void 0,o.shape=eb.SQUARE,o.size={width:Ke.width,height:Ke.height},o.textSize=exports.E({},Ze);var a=[[yi(t),{color:1710618}]];o.richContent.content=a;var s=n.create(r.elementType,o),l=s.richTextClient.calcMaxSize(s.richTextClient.chars),c=ib(l,s.lineHeightRate);return n.update(s,{fontSize:l,lineHeight:c,autoFontSize:!0}),s}(0,e,c,n);u[u.length-1].push(t)}))}));var d=Rt(u[0][0].getGlobalBox()),p=d.width,h=d.height,f=hb(a*(p+r)-r,l*(h+o)-o,n,i.getGlobalBox(),20,t),m=f.x,v=f.y;u.forEach((function(e,t){e.forEach((function(e,n){var i={x:m+n*(p+r),y:v+t*(h+o)};c.update(e,{position:i})}))}));var g=u.flat();return ub(g,c,t),g.length?(c.sync(),g):[]}function vb(e,t,n,i,r){t.operationInterrupt();var o=n[0],a=Rt(o.getGlobalBox()),s=hb(a.width,a.height,n,i,r,t),l=zs(o,o.elementType);if(l.position=s,l.frameId=void 0,Iu(o)){var c=l,u=lb(e),d=[];n.forEach((function(e,n){var i,r="text".concat(n+1,"_style"),o=u[n];d.push(["text".concat(n+1,"_text"),"weakOt",{version:t.genOtVersion(0),content:[[yi(o),{color:1710618}]]}]);var a=null===(i=c.cps)||void 0===i?void 0:i.find((function(e){return e[0]===r}));a&&d.push(_t.cloneDeep(a))})),c.cps=d}else{var p=[[yi(sb(e)),{color:1710618}]];l.richContent.content=p}var h=t.createOperation(),f=h.create(o.elementType,l);if(o.elementType===Za.TEXT&&(fb(f,t),function(e,t){var n=e.rawText,i=e.fontSize,r=e.lineHeight,o=e.fontFamily,a=e.boxBorder,s=e.padding,l=e.size.width,c=0,u=l-s.left-s.right;a&&(c=a.borderWidth,u-=2*a.borderRadius);var d={size:{width:l,height:Wi(yi(n),{fontSize:i,lineHeight:r,fontFamily:o},u).height+s.top+s.bottom+2*c}};t.update(e,d)}(f,h)),o.elementType===Za.STICKER&&o.autoFontSize){var m=f.richTextClient.calcMaxSize(f.richTextClient.chars),v=ib(m,f.lineHeightRate);h.update(f,{fontSize:m,lineHeight:v})}return ub([f],h,t),h.sync(),[f]}function gb(e,t,n,i,r){t.operationInterrupt();var o=t.createOperation(),a=function(e){if(1===e.length){var t=e[0];return Lu(t)?{fontSize:14,lineHeight:Ue}:t.elementType===Za.TEXT||t.elementType===Za.STICKER?{fontSize:Math.round(t.scale*t.fontSize),lineHeight:Math.round(t.scale*t.lineHeight)}:{fontSize:t.fontSize||14,lineHeight:t.lineHeight||Ue}}return{fontSize:14,lineHeight:Ue}}(n).fontSize,s=t.lastTextColor;t.lastTextColor=1710618;var l=t.insertTextAt({x:0,y:0},{text:e,autoStartEdit:!1,verticalPos:"center",currentOp:o,noSync:!0,slient:!0}),c=a/14;o.update(l,{scale:c}),fb(l,t),t.lastTextColor=s;var u=Rt(l.getGlobalBox()),d=hb(u.width,u.height,n,i,r,t);return o.update(l,{position:d}),ub([l],o,t),o.sync(),t.updateBorderBox(),[l]}var yb=function(e){return[{label:e("ai.common.translate.chinese"),type:1},{label:e("ai.common.translate.english"),type:2},{label:e("ai.common.translate.japanese"),type:3},{label:e("ai.common.translate.korean"),type:4},{label:e("ai.common.translate.france"),type:5},{label:e("ai.common.translate.german"),type:6},{label:e("ai.common.translate.russian"),type:7}]},bb=function(t){var n=t.element,i=t.upime,r=t.extraButtons,o=t.addressHideFrame,a=void 0!==o&&o,s=i.view,l=e.useState(!0),c=l[0],u=l[1],d=e.useRef({first:!0}),p=e.useRef(null),h=e.useRef(0),f=e.useContext(Ic),m=f.setShowElementBar,v=f.setPhoneLayout,g=f.phoneLayout,y=e.useRef(null);e.useEffect((function(){return m(!0),function(){return m(!1)}}),[]),e.useEffect((function(){return v(i.phoneMode&&"phone"===n.phoneToolbarMode),function(){return v(!1)}}),[]);var b=n.visiable&&!n.hideToolbar&&!c,E=e.useRef(!1);e.useMemo((function(){E.current=!0}),[n.frozed]),e.useLayoutEffect((function(){u(!0);var e=setTimeout((function(){u(!1)}),100);return function(){clearTimeout(e)}}),[n.frameHided]);var x=e.useState({width:0,height:0}),w=x[0],C=x[1],S=n.propertyEditors.filter((function(e){return!1!==e.available}));e.useLayoutEffect((function(){var e,t;E.current=!1;var n=(null===(e=p.current)||void 0===e?void 0:e.offsetWidth)||0,i=(null===(t=p.current)||void 0===t?void 0:t.offsetHeight)||0;C({width:n,height:i})}),[n.frozed,n.frameHided,S.length]),e.useEffect((function(){if(!d.current.first){u(!0);var e=window.setTimeout((function(){u(!1)}),300);return function(){clearTimeout(e)}}d.current.first=!1,u(!1)}),[s.x,s.y]);var k=e.useMemo((function(){var e=i.view,t=n.borderRect,r=t.rotate?Sn(t,t.rotate):t,o=n.getToolBarPosition(w);return{x:o.x,y:o.y,in_sight:!E.current&&Kt(r,Bt(e))}}),[b,s.viewWidth,s.viewHeight,w,n.toolbarAnchor,n.toolbarLeftAligned]),_=k.x,T=k.y,I=k.in_sight,P=b&&I,N=P?{left:_,top:T}:{left:0,top:0,visibility:"hidden",pointerEvents:"none"};e.useLayoutEffect((function(){y.current&&!y.current.isDragged()&&y.current.resetDrag()}),[_,T]);var M=function(){u(!1),clearTimeout(h.current),h.current=window.setTimeout((function(){u(!0)}),1e4)},A=e.useRef(!1),D=function(e){0!==e.buttons||n.editing||A.current||M()},R=function(e){if(e.target){var t=e.target,n=document.getElementById("editor_ctx_menu");t.parentNode&&n&&t.parentNode.isEqualNode(n)&&M()}};e.useLayoutEffect((function(){return!P||n.editing||A.current||(clearTimeout(h.current),h.current=window.setTimeout((function(){u(!0)}),1e4)),window.addEventListener("mousemove",D,!0),window.addEventListener("touchmove",R,!0),function(){clearTimeout(h.current),window.removeEventListener("mousemove",D,!0),window.removeEventListener("touchmove",R,!0)}}),[P]);var B=function(){A.current=!0,u(!1),clearTimeout(h.current)};if(e.useEffect((function(){n.editing&&B()}),[n.editing]),e.useEffect((function(){_e.desktop||M()}),[n.borderRect.left,n.borderRect.right,n.borderRect.top,n.borderRect.bottom]),a)return e.createElement("div",{className:Eh.editor_toolbar,ref:p,style:N},e.createElement("div",{className:Eh.property_editors},e.createElement(wb,null),e.createElement(Pb,{editor:n,alwaysShow:!0})));var L=n.frozed&&n.editable&&!n.isHandMode&&!n.frameHided&&e.createElement(e.Fragment,null,e.createElement(Ib,{editor:n}),void 0!==n.frameHided&&e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.split_line}),e.createElement(Pb,{editor:n,showOnHide:!1})),e.createElement("div",{className:Eh.split_line})),O=n.editable&&!n.isHandMode&&Boolean(i.chatgptConfig)?e.createElement(Nb,{hidden:c&&!i.phoneMode,editor:n,upime:i,showAIButton:P||i.phoneMode}):null,F=!n.frozed&&!n.frameHided&&e.createElement(e.Fragment,null,S.map((function(t,n){return e.createElement(e.Fragment,{key:t.propertyName},n>=1&&e.createElement("div",{className:Eh.split_line}),e.createElement("div",{className:Eh.property_editor},e.createElement(t.renderer,{propEditor:t})))})),S.length>0?e.createElement("div",{className:Eh.split_line}):null,r,i.phoneMode&&O,n.editable&&!n.isHandMode&&n.supportFullCommonOp?e.createElement(e.Fragment,null,e.createElement(Gg,{upime:i}),e.createElement(jg,{upime:i}),!g&&n.supportFrozeLock?e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.split_line}),e.createElement(Tb,{editor:n})):null,e.createElement(Pb,{editor:n,showOnHide:!1,className:j(n.supportFrozeLock&&Eh.hideFrameBtn)}),e.createElement("div",{className:Eh.split_line})):null,!i.phoneMode&&O),z=void 0!==n.frameHided&&!n.isHandMode&&e.createElement(e.Fragment,null,e.createElement(Pb,{editor:n,showOnHide:!0}),n.frameHided&&e.createElement("div",{className:Eh.split_line}));if(g)return e.createElement(Yg,{editor:n},F,L,z,n.supportMoreCtrl&&e.createElement(qg,{editor:n,upime:i,hidden:!b}));var H=P?{width:w.width,height:w.height}:{visibility:"hidden",pointerEvents:"none"};return e.createElement(Zg.Provider,{value:{disableAutoHide:B,enableAutoHide:function(){A.current=!1,M()}}},e.createElement(Hc,{ref:y,className:Eh.draggableWrapper,style:H,initOffset:{x:_,y:T},noTransform:!0,skip:function(e){var t=e.target,n=document.getElementById("dragIcon");return t!==n&&!V(n,t)||(e.preventDefault(),!1)}},e.createElement("div",{className:Eh.editor_toolbar,ref:p},e.createElement("div",{className:Eh.property_editors},e.createElement(wb,null),F,L,z,n.supportMoreCtrl&&e.createElement(qg,{editor:n,upime:i,hidden:!b})))))},Eb=function(t){var n=t.element,i=t.upime,r=n.supportDownload&&i.downloadConfig.enable?e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.property_editor},e.createElement(Ih,{editor:n})),e.createElement("div",{className:Eh.split_line})):null;return e.createElement(bb,{element:n,upime:i,extraButtons:r})},xb=function(t){var n=t.element,i=t.upime,r=e.useContext(Ic).phoneLayout,o=n.isHandMode||n.frameHided?null:e.createElement(e.Fragment,null,!r&&n.couldFilter?e.createElement(e.Fragment,null,e.createElement(Sh,{editor:n,upime:i})," ",e.createElement("div",{className:Eh.split_line})):null,n.supportDownload&&i.downloadConfig.enable&&e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.property_editor},e.createElement(Ih,{editor:n})),e.createElement("div",{className:Eh.split_line})),n.canGroup||n.canAlignGroup?e.createElement(kb,{editor:n}):null,n.canSplitGroup?e.createElement(_b,{editor:n}):null,n.canGroup||n.canSplitGroup?e.createElement("div",{className:Eh.split_line}):null);return e.createElement(bb,{element:n,upime:i,extraButtons:o,addressHideFrame:n.frameHided})},wb=function(){return e.createElement("div",{className:Eh.dragIcon,id:"dragIcon"},e.createElement(hl,{icon:"liugedian"}))},Cb=function(t){var n=t.icon,i=t.onClick,r=t.tip,o=t.className,a=t.disabled,s=void 0!==a&&a,l=t.popOverConfig,c=e.createElement(Dl,{placement:"top",content:r},e.createElement("div",{className:j(Ml.cm_item,s&&Ml.disabled)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:i},e.createElement(hl,{icon:n}))));return e.createElement("div",{className:j(Eh.property_editor,o)},l?e.createElement(Nh,exports.E({},l),c):c)},Sb=((ob={})[bt.LEFT]="zuoduiqi",ob[bt.HORIZONTAL]="shuipingjuzhongduiqi",ob[bt.RIGHT]="youduiqi",ob[bt.TOP]="dingduiqi",ob[bt.VERTICAL]="chuizhijuzhongduiqi",ob[bt.BOTTOM]="diduiqi",ob[bt.HORI_DISTRIBUTE]="shuipingfenbu",ob[bt.VERT_DISTRIBUTE]="chuizhifenbu",ob),kb=function(t){var n=t.editor,i=W().getUpimeTrans,r=yh(!0),o=r.hide,a=r.toggleHide,s=r.skipRef,l=function(e){return n.groupAlignElements(e)},c=e.useContext(Ic).phoneLayout;return e.createElement(e.Fragment,null,n.canAlignGroup&&e.createElement("div",{ref:s,style:{position:"relative"}},!c&&e.createElement(Cb,{icon:"duiqi",tip:i("element.align"),onClick:a,className:j((n.canGroup||n.canSplitGroup)&&Eh.collapseRight)}),!o&&e.createElement(xh,{align:"left",className:Eh.alignRoot},e.createElement("div",{className:Eh.left},[bt.LEFT,bt.VERTICAL,bt.RIGHT,bt.TOP,bt.HORIZONTAL,bt.BOTTOM].map((function(t){return e.createElement("div",{key:t,className:Eh.iconCon,onClick:function(){return l(t)}},e.createElement(hl,{icon:Sb[t]}))}))),e.createElement("div",{className:Eh.divider}),e.createElement("div",{className:Eh.right},[bt.HORI_DISTRIBUTE,bt.VERT_DISTRIBUTE].map((function(t){return e.createElement("div",{key:t,className:j(Eh.iconCon,!n.canDistributeGroup&&Eh.disabled),onClick:function(){return l(t)}},e.createElement(hl,{icon:Sb[t]}))}))))),n.canGroup&&e.createElement(Cb,{icon:"zuhe",tip:i("element.makeGroup"),onClick:function(){return n.makeGroup()},className:j(n.canSplitGroup&&Eh.collapseRight)}))},_b=function(t){var n=t.editor,i=W().getUpimeTrans;return e.createElement(Cb,{icon:"jiezu",tip:i("element.splitGroup"),onClick:function(){return n.splitGroup()}})},Tb=function(t){var n=t.editor,i=W().getUpimeTrans;return e.createElement(Cb,{icon:"suoding",tip:i("element.lock"),onClick:function(){return n.frozeElement()},className:Eh.lockIcon})},Ib=function(t){var n,i=t.editor,r=W().getUpimeTrans,o=e.useRef(null),a=function(t,n){var i=e.useState("idle"),r=i[0],o=i[1],a=e.useRef(null),s=e.useRef(!1);e.useEffect((function(){return t.current&&(t.current.addEventListener("pointerdown",l),t.current.addEventListener("pointerup",c),t.current.addEventListener("pointerleave",u)),function(){t.current&&(t.current.removeEventListener("pointerdown",l),t.current.removeEventListener("pointerup",c),t.current.removeEventListener("pointerleave",u))}}),[t.current]);var l=function(){o("pressing"),s.current=!1,a.current=setTimeout((function(){s.current=!0,o("end")}),null!=n?n:800)},c=function(){d()},u=function(){d()},d=function(){clearTimeout(a.current),o("idle"),a.current=null,s.current=!1};return{longPressState:r,reset:d}}(o,1e3).longPressState,s=i.upime.userManager,l=yh(!0),c=l.hide,u=l.toggleHide,d=l.setHide,p=l.skipRef,h=!(null===(n=i.getElements()[0].unFrozenRoles)||void 0===n?void 0:n.includes("owner"));e.useEffect((function(){o.current&&("pressing"===a&&o.current.firstChild.classList.add(Eh.longPressAnimation),"idle"===a&&o.current.firstChild.classList.remove(Eh.longPressAnimation),"end"===a&&i.unfrozeElement())}),[a,o.current]);var f=h?["element.unlock"]:["element.lock.condition.by.owner"];return e.createElement("div",{className:Eh.unFrozenRoot,ref:p},e.createElement(Dl,{placement:"top",content:r.apply(void 0,f)},i.couldUnfroze?e.createElement("div",{className:Eh.unFrozenContainer,ref:o},e.createElement("div",{className:Eh.background}),e.createElement(hl,{icon:h?"jiesuo":"suo-quanxian"}),e.createElement("span",null,r("element.longPressUnLock")),e.createElement("div",{className:Eh.cover})):e.createElement("div",{className:Eh.disableIconCon},e.createElement(hl,{icon:"suo-quanxian"}))),s.editUnlockCondition&&e.createElement("div",{className:Eh.triangle,onClick:function(e){e.stopPropagation(),u()}},e.createElement("div",null)),!c&&e.createElement(xh,{className:Eh.expandPanel},e.createElement("div",{className:Eh.row,onClick:function(){i.updateUnfrozenAccess(null),d(!0)}},h&&e.createElement(hl,{icon:"gouxuan"}),e.createElement("span",null,r("element.lock.condition.by.everyone"))),e.createElement("div",{className:Eh.row,onClick:function(){i.updateUnfrozenAccess(["owner"]),d(!0)}},!h&&e.createElement(hl,{icon:"gouxuan"}),e.createElement("span",null,r("element.lock.condition.by.owner")))))},Pb=function(t){var n=t.editor,i=t.showOnHide,r=t.alwaysShow,o=t.className,a=e.useRef(n.getElements().length>1),s=n.upime.userManager,l=W().getUpimeTrans,c=n.allFrameHided,u=n.curFramesUnhideRoles,d=n.upime.userManager,p=d.enableHideFrame,h=d.userAccessHint,f=yh(!0),m=f.hide,v=f.setHide,g=f.toggleHide,y=f.skipRef,b=e.useMemo((function(){return c?null===u?"owner"!==s.userType?["frame.partial.unhidable.hint"]:["frame.unhide"]:0===u.length?["frame.unhide"]:["frame.unhide.condition.by.owner"]:["frame.hide"]}),[u,c]),E=c?0===(null==u?void 0:u.length)?"yanjing-guan2":"view-quanxian":"yanjing-kai",x=!p&&h.HideFrameHint&&"yanjing-kai"===E;return n.hasFrame&&(c===i||r)?e.createElement("div",{className:Eh.unFrozenRoot,ref:y},e.createElement(Cb,{icon:E,tip:l.apply(void 0,b),onClick:function(){c&&!n.couldUnHideFrame||x||(a.current?n.handleHidedFrame(!c):n.hideFrame(!c))},popOverConfig:x&&h.HideFrameHint?{Content:h.HideFrameHint,state:{anchor:n.toolbarAnchor}}:void 0,className:o}),c&&s.editUnHideCondition&&e.createElement("div",{className:Eh.triangle,onClick:function(){return g()}},e.createElement("div",null)),!m&&e.createElement(xh,{className:Eh.expandPanel},e.createElement("div",{className:Eh.row,onClick:function(){n.updateFrameUnHideRoles(null),v(!0)}},u&&!u.length&&e.createElement(hl,{icon:"gouxuan"}),e.createElement("span",null,l("frame.unhide.condition.by.everyone"))),e.createElement("div",{className:Eh.row,onClick:function(){n.updateFrameUnHideRoles(["owner"]),v(!0)}},(null==u?void 0:u.includes("owner"))&&e.createElement(hl,{icon:"gouxuan"}),e.createElement("span",null,l("frame.unhide.condition.by.owner"))))):null},Nb=function(t){var n=t.upime,i=t.editor,r=t.hidden,o=t.showAIButton,a=function(e){var t=W().getUpimeTrans;return t(e?"ai.using.tip":"ai.icon")}(n.isUsingAi),s=yh(!0),l=s.hide,c=s.setHide,u=s.toggleHide,d=s.skipRef;if(!i.isSupportAI)return null;var p=Rb(i).length>0,h=n.isUsingAi,f=!h&&p;return e.createElement(e.Fragment,null,e.createElement("div",{className:Eh.aiIconWrapper,ref:d},e.createElement(Dl,{placement:"top",content:a},e.createElement("div",{className:j(Eh.aiIconContainer)},e.createElement(Rh,{running:h,disabled:!p,onClick:f?function(){_c("cv_menubar_ai"),u()}:function(){return[]},transparent:!o}))),!l&&e.createElement(xh,{align:"left",selfAdjust:!0,className:n.phoneMode?Eh.aiOptionPhoneWrapper:void 0},e.createElement(Mb,{upime:n,editor:i,onHide:function(){return c(!0)},hidden:r}))),e.createElement("div",{className:Eh.split_line}))},Mb=function(t){var n,i=t.upime,r=t.editor,o=t.onHide,a=t.hidden,s=W().getUpimeTrans,l=e.useState("rightTop"),c=l[0],u=l[1],d=e.useContext(Ic).rootContainer,p={label:s("ai.common.addsticker"),icon:"tianjialeisidebianqian",type:Ct.Sticker},h={label:s("ai.common.addtodo"),icon:"shengchengdaiban",type:Ct.Todo},f={label:s("ai.common.addsummary"),icon:"shengchengzongjie",type:Ct.Summary},m={label:s("ai.common.translate"),icon:"fanyi",type:Ct.Translate,children:yb(s)},v={label:s("ai.gen.ppt"),icon:"yanshiwengao",type:St.PPT},g={label:s("ai.center.generate.doc"),icon:"wendangyuansu",type:St.DOCUMENT},y={label:s("ai.center.generate.polish"),icon:"wenanrunse",type:Ct.Polishing,children:(n=s,[{label:n("ai.center.polish.business"),type:0},{label:n("ai.center.polish.concise"),type:1},{label:n("ai.center.polish.poems"),type:2},{label:n("ai.center.polish.academic"),type:3},{label:n("ai.center.polish.colloquial"),type:4}]),panelWidth:140},b={label:s("ai.options.expand.questions"),icon:"siweidaotuzhankai",type:kt.QUESTION},E={label:s("ai.options.expand.ideas"),icon:"siweidaotuzhankai",type:kt.IDEAS},x={label:s("ai.options.expand.topics"),icon:"siweidaotuzhankai",type:kt.TOPICS},w={label:s("ai.options.generate.mindmap"),icon:"jixushengchengsiweidaotu",type:kt.MINDMAP},C=[],S=r.getElements(),k=i.userManager.enableAIGenPPT,_=i.userManager.enableDocument;if(S.length>1)C.push(f,h,y);else{var T=S[0];switch(T.elementType){case Za.STICKER:C.push(p,h,y,m);break;case Za.SHAPE:case Za.TEXT:case Za.GRAPHIC:C.push(f,h,y,m);break;case Za.BIG_DOC:C.push(f,h,y);break;case Za.MINDMAP_NODE:C.push(f,h),Bu(T)&&T.isRootNode&&C.push(exports.E(exports.E({},w),{disabled:T.childrenCount>0,tip:T.childrenCount>0?s("ai.options.generate.mindmap.disabled"):void 0})),C.push(b,E,x)}}function I(e){o();var t=e[0],n=e[1],a=Db(r),l=Rb(r),c=a.map((function(e){return e.contentList})).flat(),u=c.join("\n"),d=l.map((function(e){return e.contentList})).flat(),p=d.join("\n"),h=a.map((function(e){return e.element}));if(It(t)){if(p.length>3e3)return void i.addToast(s("ai.gen.ppt.error",3e3))}else if(u.length>3e3)return void i.addToast(s("ai.gen.ppt.error",3e3));if(t===St.PPT)return _c("cv_menubar_generatepresentation_ai"),void ey(u,i);if(t!==St.DOCUMENT)if(It(t)){for(var f=r.element,m=[],v=f;v.parent;)m.push(v.parent),v=v.parent;var g=m.map((function(e){return e.richTextClient.chars.join("")})).filter(Boolean).reverse();Zy(i,{keyword:p,type:t,preconditions:g,useChinese:!0},f)}else(function(e){return Dt.includes(e)})(t)&&rb(i,c,h,t,n);else $y(u,i)}return k&&C.push(v),_&&C.push(g),e.createElement("div",{className:Eh.aiOptionsContainer},!a&&C.map((function(t,n){var r=t.children||[];if(r.length&&!i.phoneMode)return e.createElement(Dh,{renderData:{render:Ab,data:{options:r,onSelect:function(e){return I([t.type,e])},placement:c,width:t.panelWidth}},placement:c,calcRect:function(e){return function(e,t){var n,i=null===(n=d.current)||void 0===n?void 0:n.getBoundingClientRect();if(!i)return e;var r=e.left+e.width+(t||140)>i.left+i.width,o=e.top+e.height+300>i.top+i.height;return r&&o&&u("leftBottom"),r&&!o&&u("leftTop"),!r&&o&&u("rightBottom"),r||o||u("rightTop"),e}(e,t.panelWidth)},key:n,useHover:!0,noPortal:!0},e.createElement("div",{className:j(Eh.aiOptionRow)},e.createElement(hl,{icon:t.icon,className:Eh.aiOptionIcon}),e.createElement("div",null,t.label),e.createElement(hl,{icon:"youjiantou",className:Eh.arrow})));var o=e.createElement("div",{key:n,className:j(Eh.aiOptionRow,t.disabled&&Eh.disabled),onClick:function(){t.disabled||(t.type!==Ct.Translate?t.type!==Ct.Polishing?I([t.type]):i.showWindow(Bb,{options:y.children||[]},void 0,!0,{type:"drawer",config:{showCancel:!0}}).then((function(e){I([Ct.Polishing,e])})):i.showWindow(Bb,{options:m.children||[]},void 0,!0,{type:"drawer",config:{showCancel:!0}}).then((function(e){I([Ct.Translate,e])})))}},e.createElement(hl,{icon:t.icon,className:Eh.aiOptionIcon}),e.createElement("div",null,t.label),r.length?e.createElement(hl,{icon:"youjiantou",className:Eh.arrow}):null);return t.tip?e.createElement(Dl,{key:n,placement:"top",content:t.tip},o):o})))},Ab=function(t){var n=t.options,i=t.onSelect,r=t.placement,o=t.width,a={};return r.includes("left")?a.transform="translateX(6px)":a.transform="translateX(-6px)",o&&(a.width="".concat(o,"px")),e.createElement("div",{className:Eh.childrenOptionContainer,onClick:function(e){return e.stopPropagation()},style:a},n.map((function(t,n){return e.createElement("div",{className:Eh.childRow,key:n,onClick:function(){return i(t.type)}},t.label)})))};function Db(e){var t=e.getElements().filter((function(e){return e.isSupportAI||e.elementType===Za.TEXT})),n=[],i=new Set;return t.forEach((function(e){var r;if(Iu(e))(o=e.textNodes.map((function(e){return e.rawText.trim()}))).length>0&&o.some((function(e){return e.length>0}))&&n.push({element:e,contentList:o});else if(Du(e)){var o=e.grids.flat().map((function(e){var t,n,i,r=null===(t=e.selfRefSystem)||void 0===t?void 0:t.children.find((function(e){return e.elementType===Za.GRID_TEXT}));return(null===(i=null===(n=null==r?void 0:r.richTextClient)||void 0===n?void 0:n.chars)||void 0===i?void 0:i.join("").trim())||""})).filter(Boolean);o.length>0&&n.push({element:e,contentList:o})}else{if(Bu(e)){if(i.has(e))return;for(var a=function(e){return R([e],e.children.filter((function(e){return!i.has(e)})).map((function(e){return a(e)})).flat(),!0)},s=e;;){var l=s.parent;if(!l||!t.includes(l))break;s=l}var c=a(s);return c.forEach((function(e){return i.add(e)})),void c.forEach((function(e){var t,i=null===(t=e.richTextClient)||void 0===t?void 0:t.chars.join("");i&&n.push({element:e,contentList:[i]})}))}if(Ru(e)){var u=Array.from(e.textNodes.values()).map((function(e){return e.richTextClient.chars.join("")})).join("");u&&n.push({element:e,contentList:[u]})}else if(Lu(e)){var d=e.renderFlow,p=[e.name];d.forEach((function(e){var t,n=e.node;if(Yy(n)){var i=null===(t=n.richTextClient)||void 0===t?void 0:t.chars.join("");i&&p.push(i)}}));var h=p.join("\n");n.push({element:e,contentList:[h]})}else{var f=(null===(r=e.richTextClient)||void 0===r?void 0:r.chars.join("").trim())||"";f&&n.push({element:e,contentList:[f]})}}})),n}function Rb(e){var t=Db(e),n=e.getElements().filter((function(e){return e.isSupportAI||e.elementType===Za.TEXT}));return t.filter((function(e){return n.includes(e.element)}))}function Bb(t){var n=t.success,i=t.content,r=(null==i?void 0:i.options)||[];return e.createElement("div",{className:Eh.menu_phone_container},r.map((function(t,i){return e.createElement("div",{className:j(Eh.menu_phone_row),key:i,onClick:function(){return n(t.type)}},t.label)})))}var Lb=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.element=n,r.visiable=!1,r.toolbarAnchor=0,r.editing=!1,r.frozed=!1,r.renderer=ms,r.domRenderer=Eb,r.multiResizeDirection=["nw","ne","sw","se"],r.manager=i||null,r.commRefSystem=n.parentRefSystem||t.view.elementsRoot,r.directCtrlElements=[n],r.borderRect=r.getBorderBox(),r.renderKey="selected-rect-".concat(n.id,"-").concat(Date.now()),r.frozed=!!n.frozedGroup,r}return P(t,e),Object.defineProperty(t.prototype,"resizable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return this.element.supportRotate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentOp",{get:function(){var e;return this._currentOp||(null===(e=this.manager)||void 0===e?void 0:e.currentOp)},set:function(e){this._currentOp=e},enumerable:!1,configurable:!0}),t.prototype.checkHideToolbar=function(){var e,t,n;return!!(null===(t=null===(e=this.richContentEditor)||void 0===e?void 0:e.anchorEditor)||void 0===t?void 0:t.editing)||!!(null===(n=this.richContentEditor)||void 0===n?void 0:n.isSelectingMention)},t.prototype.syncWeakOt=function(e,t,n){var i=this.currentOp;this.element.frameId&&this.upime.elementManager.frameCoverChanged(this.element.frameId),null==i||i.sendWeakOt(this.element,e,t,n),null==i||i.sync()},t.prototype.connectTextEditor=function(e){var t=e||this.element.defaultConnectEditor||this.richContentEditor;t&&!this.frozed&&(this.upime.view.setConnectedRichEditor(t),this.connectedEditor=t)},t.prototype.switchConnectedEditor=function(e){this.upime.view.setConnectedRichEditor(e),this.connectedEditor=e},t.prototype.disconnectTextEditor=function(){this.connectedEditor=void 0,this.upime.view.clearConnectedRichEditor()},t.prototype.select=function(){var t=this;e.prototype.select.call(this);var n=this.upime.getElementLink;this.element.currentEditor=this,n&&(this.copyLink=function(){var e=n(t.element.id);Xd(e,{onCopy:function(n){t.upime.addToast(O("link.copy.success.toast"),{type:"normal"}),n.setData("text/plain",e)}})}),this.connectTextEditor()},t.prototype.startEdit=function(e){var t,n=this;if(void 0===e&&(e={}),!this.editing){var i=this.connectedEditor||this.richContentEditor;if(i){var r=e.lock,o=e.op,a=e.checkMobileFocus,s=e.optimizeView;this.currentOp=o||this.getNewOperation(),this.editing=!0,this.element.editing=!0,i.startEdit(a,s),this.editingEditor=i,this.upime.view.update();var l=this.upime.view.getAbsolutePosition(this.upime.userEventManager.mousePosition),c=this.checkSelectRelation(l,{type:"move"});(null===(t=null==c?void 0:c.metaData)||void 0===t?void 0:t.selectingText)&&this.upime.view.setCursor("text",this.element),this.currentLock=r||this.upime.createLock([this.element.id]),Promise.resolve().then((function(){n.upime}))}}},t.prototype.checkParentAndUpdate=function(){var e=this.currentOp,t=this.element;if(e){var n=this.upime.view.elementsRoot;if(t.parentRefSystem&&t.parentRefSystem!==n){var i=t.getGlobalBox();if(!t.parentRefSystem.checkBorderIn(i)){var r=t.calcTransformedUpdate(n);r.zIndex=n.maxChildZindex+1,e.update(t,r)}}t.frame&&(i=t.getGlobalBox(),!t.isSupportFrame&&t.frame.checkBorderInFrame(i)||e.update(t,{frameId:null}))}},t.prototype.lockOtherElements=function(t){this.manager?this.manager.lockOtherElements(t):e.prototype.lockOtherElements.call(this,t)},t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t),this.manager?this.manager.updateBorderBox():this.updateBorderBox(),null===t.frozedGroupId&&(this.connectTextEditor(),this.upime.view.update())},t.prototype.lockUpdateToolbarPos=function(){this.manager?this.manager.autoReposition=!1:this.autoReposition=!1},t.prototype.unlockUpdateToolbarPos=function(){this.manager?this.manager.autoReposition=!0:this.autoReposition=!0},t.prototype.stopEdit=function(){var e,t;this.editing&&(this.editing=!1,this.element.editing=!1,this.upime.view.setCursor("",this.element),null===(e=this.editingEditor)||void 0===e||e.stopEdit(),this.editingEditor=void 0,this.upime.view.update(),null===(t=this.currentOp)||void 0===t||t.checkIsEmpty(),this.currentOp=void 0,this.upime.clearLock(this.currentLock),this.currentLock=void 0)},t.prototype.dealMultiEditorResize=function(e,t,n){var i,r=t.originBorder,o=t.direction;e.isStart&&(this.selfOriginBorder=this.element.getBorderBox());var a,s,l,c,u=r.right-r.left,d=r.bottom-r.top,p=n.right-n.left,h=n.bottom-n.top,f=p/u,m=h/d,v=this.selfOriginBorder,g=v.right-v.left,y=v.bottom-v.top,b=v.left-r.left,E=v.top-r.top;if(this.multiResizeDirection.indexOf(o)>=0){l=(a=b*f+n.left)+f*g,c=(s=E*m+n.top)+m*y;var x=this.getMinSize(o,e),w=Array.isArray(x)?x[0]:x,C=Array.isArray(x)?null!==(i=x[1])&&void 0!==i?i:x[0]:x;l-a<w&&(o.includes("w")?a=l-w:l=a+w),c-s<C&&(o.includes("n")?s=c-C:c=s+C),this.handleAnyResize(e,t,{left:a,top:s,right:l,bottom:c})}else{var S=r.right-v.right,k=r.bottom-v.bottom;l=(a=0===b&&0===S?"w"===o||"nw"===o||"sw"===o?n.left:n.right-g:(p-g)/(b+S)*b+n.left)+g,c=(s=0===E&&0===k?"n"===o||"nw"===o||"ne"===o?n.top:n.bottom-y:(h-y)/(E+k)*E+n.top)+y,this.multiResizeFallback(e,t,{left:a,top:s,right:l,bottom:c})}},t.prototype.multiResizeFallback=function(e,t,n){var i=this.element.getBorderBox(),r=xn(Lt(n),Lt(i)),o=this.element.position,a=exports.E(exports.E({},o),En(o,r));this.updateSelf({position:a})},t.prototype.dealInternalArrowKeyDown=function(e,t){},t.prototype.dealInternalArrowKeyUp=function(e,t,n){},t.prototype.dealMultiEditorMove=function(e){this.handleAnyMove(e)},t.prototype.getElements=function(){return this.manager?this.manager.getElements():[this.element]},t.prototype.delete=function(){if(!this.element.frozedGroupId){var e=this.getOp();this.dealDeleteGroup(e),this.doDelete(e),e.sync()}},t.prototype.doDelete=function(e){var t=this;if(!this.element.frozedGroupId){var n={deleted:!0};this.element.frameId&&(n.frameId=null),e.update(this.element,n),this.upime.getAllComments((function(e){return e.attached===t.element.id||!!e.position.parentType&&e.position.parentId===t.element.id})).forEach((function(t){e.update(t,n)}))}},t.prototype.contains=function(e){return e===this.element},t.prototype.dealSelectCtrlEvt=function(t){var n,i;return(null===(n=this.opData)||void 0===n?void 0:n.directCtrlData)?this.dealDirectCtrl(t,this.opData.directCtrlData):(null===(i=this.opData)||void 0===i?void 0:i.selectingText)?this.dealTextSelect(t):e.prototype.dealSelectCtrlEvt.call(this,t)},t.prototype.dealDirectCtrl=function(e,t){if(function(e){var t;return"childCtrlData"===(null===(t=e)||void 0===t?void 0:t.type)}(t)){var n=t.child,i=t.data;n.dealParentEditCtrl(e,i)}},t.prototype.dealTextSelect=function(e){var t;null===(t=this.richContentEditor)||void 0===t||t.dealTextSelect(e)},t.prototype.dealClick=function(e){var t=this.editingEditor;t&&(this.stopEdit(),t.unselect())},t.prototype.dealEnterKey=function(e){this.richContentEditor&&!this.frozed&&(this.startEdit(),this.richContentEditor.moveCursorToEnd())},t.prototype.moveElement=function(e){var t={x:e.deltaX,y:e.deltaY},n=this.element.globalTransform.applyVectorInverse(t),i=n.x,r=n.y,o=this.element.position,a=exports.E(exports.E({},o),{x:i+o.x,y:r+o.y});this.updateSelf({position:a})},t.prototype.handleSelectCtrlMove=function(e){var t=this.checkBeforeMove(e);this.handleAnyMove(t)},t.prototype.handleAnyMove=function(e){this.moveElement(e)},t.prototype.handleAnyResize=function(e,t,n){this.dealBorderResize(e,n,t.direction)},t.prototype.dealBorderResize=function(e,t,n){},t.prototype.updateCommRefSystem=function(){var e=this.element,t=this.upime.view.elementsRoot;this.commRefSystem=e.parentRefSystem||t,this.allInGlobalRs=this.commRefSystem===t},t.prototype.getBorderBox=function(){var e=this.commRefSystem;if(e===this.upime.view.elementsRoot)return this.element.getGlobalBox();var t=this.element.getBorderBox();return e.globalTransform.applyBorderBox(t)},t.prototype.getBorderBoxInRS=function(){return this.element.getBorderBox()},t.prototype.getPropertyValue=function(e){return this.element[e]},t.prototype.startSimpleEdit=function(){this.currentOp||(this.currentOp=this.getNewOperation(),this.currentLock&&this.upime.clearLock(this.currentLock),this.currentLock=this.upime.createLock([this.element.id]))},t.prototype.stopSimpleEdit=function(){this.currentOp=void 0,this.currentLock&&this.upime.clearLock(this.currentLock)},t.prototype.updateSelf=function(e){var t=this.currentOp;t&&t.update(this.element,e)},t.prototype.updateSelfSync=function(e){this.updateSelf(e),this.syncUpdate()},t.prototype.frozeElement=function(){this.editing&&this.stopEdit();var e,t=this.getOp();if(this.group){var n=R([],this.group.members,!0);e=this.upime.createLock(n.map((function(e){return e.id}))),n.forEach((function(e){return t.update(e,{groupId:null})}))}else e=this.upime.createLock([this.element.id]);var i=this.upime.genID("fg");t.update(this.element,{frozedGroupId:i}),t.sync(),this.upime.clearLock(e),this.group?(this.upime.clearSelect(),this.upime.selectElement(this.element)):this.frozed=!0,this.disconnectTextEditor()},t.prototype.unselect=function(){this.editing&&this.stopEdit(),this.disconnectTextEditor(),this.richContentEditors&&this.richContentEditors.forEach((function(e){return e.unselect()})),this.richContentEditor&&this.richContentEditor.unselect(),this.element.currentEditor=void 0,e.prototype.unselect.call(this)},Object.defineProperty(t.prototype,"rotateIconBorderBox",{get:function(){var e=this.commRefSystem,t=this.element.getBorderBox(),n=t.left,i=t.bottom,r=this.upime.view.scale*e.globalTransform.currentScale,o=30/r,a=20/r,s=n-o,l=i+o;return{left:s-a/2,top:l-1.1*a/2,right:s+a/2,bottom:l+1.1*a/2}},enumerable:!1,configurable:!0}),t.prototype.checkOuterBoxSelectRelation=function(e){return Ot(e,this.rotateIconBorderBox)?{transparent:!1,metric:-1,metaData:{rotateData:{oriThetaDegree:this.element.rotate}}}:null},t.prototype.handleSelectCtrlRotate=function(e){var t,n,i;if(!(this.getElements().length>1)){var r=e.startPosition,o=r.x,a=r.y,s=e.position,l=s.x,c=s.y,u=Lt(this.element.getGlobalBox()),d=180/Math.PI,p=l-u.x,h=c-u.y,f=o-u.x,m=a-u.y,v=(d*Math.atan2(h,p)-d*Math.atan2(m,f)+(null!==(i=null===(n=null===(t=this.opData)||void 0===t?void 0:t.rotateData)||void 0===n?void 0:n.oriThetaDegree)&&void 0!==i?i:0)+360)%360,g=fn(e.startPosition,u),y=Math.min(4,20/this.upime.view.scale*360/(2*g*Math.PI)),b=90*Math.round(v/90)-v;b>-y&&b<y&&(v+=b),this.updateSelf({rotate:v})}},t.prototype.getNewOperation=function(){return this.upime.createOperation()},t.prototype.checkSelectRelation=function(t,n){var i,r,o;if(this.editing){var a=this.element.globalTransform.applyInverse(t),s=this.element.checkSelectRelation(a,n);if(null===(i=null==s?void 0:s.metaData)||void 0===i?void 0:i.selectingText)return s.transparent=!0,s;if(null===(r=this.element.childElements)||void 0===r?void 0:r.length){var l=this.element.checkChildElementRelation(a,n);if(null===(o=null==l?void 0:l.metaData)||void 0===o?void 0:o.selectingText)return l.transparent=!0,l}}return e.prototype.checkSelectRelation.call(this,t,n)},t}(fh),Ob=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=Kd,t.currentLocation="",t}return P(t,e),t.prototype.setCurrentLocation=function(e){this.currentLocation=e},Object.defineProperty(t.prototype,"hideDisplayLocations",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return this.element.connectableLocations},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hideConnectableEditorRect",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.handleSelectCtrlEvt=function(t){var n;(null===(n=this.opData)||void 0===n?void 0:n.connectionData)?this.opData.connectionData.isMindMapLocation||(t.isStart&&this.upime.hideEditor(),t.isEnd&&this.upime.clearSelect(),this.upime.drawConnectionLine(t,this.opData.connectionData.attachedProps)):e.prototype.handleSelectCtrlEvt.call(this,t)},t.prototype.getCursor=function(t){return t.connectionData?"url(".concat($o("connect_cursor.png"),") 2 0, default"):e.prototype.getCursor.call(this,t)},t.prototype.checkConnectionRelation=function(e){return this.element.checkConnectionRelation(e,et,nt,this.connectableLocations)},t.prototype.checkOuterBoxSelectRelation=function(t){var n=e.prototype.checkOuterBoxSelectRelation.call(this,t),i=this.checkConnectionRelation(t);return null!=i?i:n},t.prototype.dealHoverStart=function(t){var n,i,r;this.setCurrentLocation(null!==(r=null===(i=null===(n=t.metaData)||void 0===n?void 0:n.connectionData)||void 0===i?void 0:i.location)&&void 0!==r?r:""),e.prototype.dealHoverStart.call(this,t)},t.prototype.dealHoverEnd=function(){this.setCurrentLocation(""),e.prototype.dealHoverEnd.call(this)},t.prototype.doDelete=function(t){e.prototype.doDelete.call(this,t),this.element.connectionLines.forEach((function(e){if(!e.deleted){var n={deleted:!0};e.frameId&&(n.frameId=null),t.update(e,n)}}))},t}(Lb);function Fb(e){return null===e?"#ffffff":pr(e)}var zb=function(n){var i=n.oriBox,r=n.containerBox,o=n.children,a=n.startPos,s=n.color,l=e.useContext(xl).upime,c=e.useContext(Ic).toastContainer,u=e.useRef(null),d=e.useState({visibility:"hidden"}),p=d[0],h=d[1],f=e.useRef(!1);return e.useEffect((function(){var e=u.current,t=null,n=function(n,o){if(e){var u=c.current.getBoundingClientRect(),d=n-a.x,p=o-a.y;e.style.transform="translate(".concat(d-u.left,"px, ").concat(p-u.top,"px)"),Kt(r,{left:i.left+d,right:i.right+d,top:i.top+p,bottom:i.bottom+p})||(e.style.opacity="0",null===s||f.current||(f.current=!0,t=setTimeout((function(){l.userManager.removeColor(s),t=null}),200)))}},o=function(e){n(e.pageX,e.pageY)},d=function(e){n(e.touches[0].pageX,e.touches[0].pageY)};return e&&h({position:"absolute",top:i.top,left:i.left,zIndex:1e3,opacity:1,transition:"opacity .2s"}),document.addEventListener("pointermove",o),document.addEventListener("touchmove",d),function(){document.removeEventListener("pointermove",o),document.removeEventListener("touchmove",d),t&&clearTimeout(t)}}),[]),t.createPortal(e.createElement("div",{ref:u,style:p},o),c.current)},Hb=e.memo((function(t){var n=t.defaultColor,i=t.color,r=t.onClick,o=t.className,a=t.toggleParentAutoHide,s=N(t,["defaultColor","color","onClick","className","toggleParentAutoHide"]),l=e.useContext(xl).upime,c=W().getUpimeTrans,u=e.useState(!1),d=u[0],p=u[1],h=e.useRef(null),f=e.useRef({connected:!1,pointerId:null,baseX:0,baseY:0,xDiff:0,yDiff:0,startX:0,startY:0,oriBox:{left:0,right:0,top:0,bottom:0},containerBox:{left:0,right:0,top:0,bottom:0}});return e.useEffect((function(){var e=h.current,t=f.current,i=null,r=null,o=function(){r&&clearTimeout(r),r=null},s=function(n){t.pointerId=n.pointerId,t.startX=n.pageX,t.startY=n.pageY,t.connected=!0,e&&(t.containerBox=e.parentElement.getBoundingClientRect(),t.oriBox=e.getBoundingClientRect())},u=function(e){null!==t.pointerId&&t.pointerId!==e.pointerId||(_e.isHoverSupported?s(e):(t.startX=e.pageX,t.startY=e.pageY,r=setTimeout((function(){s(e),o()}),500)))},d=function(e){if(r&&Math.sqrt(Math.pow(e.pageX-t.startX,2)+Math.pow(e.pageY-t.startY,2))>8&&o(),(null===t.pointerId||t.pointerId===e.pointerId)&&t.connected&&(Math.abs(e.pageX-t.startX)>=2||Math.abs(e.pageY-t.startY)>=2)){if(n)return l.addToast(c("color.remove.default.hint"),{autoHideTime:2e3,type:"normal"}),t.connected=!1,t.pointerId=null,void(i=setTimeout((function(){p(!1),i=null})));p(!0),null==a||a(!1)}},m=function(){t.connected&&(t.pointerId=null,t.connected=!1,i=setTimeout((function(){p(!1),i=null,null==a||a(!0)})))},v=function(e){o(),null!==t.pointerId&&t.pointerId!==e.pointerId||m()},g=function(){o(),m()};return e&&e.addEventListener("pointerdown",u),document.addEventListener("pointermove",d),document.addEventListener("pointerup",v),document.addEventListener("touchcancel",g),document.addEventListener("touchend",g),function(){e&&e.removeEventListener("pointerdown",u),document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",v),document.removeEventListener("touchcancel",g),document.removeEventListener("touchend",g),i&&clearTimeout(i)}}),[]),e.createElement(e.Fragment,null,e.createElement("div",{ref:h,style:{opacity:d?"0":"1"}},e.createElement(Wb,exports.E({color:i,onClick:d?void 0:r,className:o},s))),d&&e.createElement(zb,{oriBox:f.current.oriBox,containerBox:f.current.containerBox,releaseSelf:function(){f.current.pointerId=null,f.current.connected=!1,p(!1)},startPos:{x:f.current.startX,y:f.current.startY},color:i},e.createElement(Wb,exports.E({color:i,onClick:void 0},s,{className:j("color_circle_placeholder_2UnvN",o)}))))})),Ub=e.memo((function(t){t.defaultColor;var n=t.color,i=t.onClick,r=t.className;t.toggleParentAutoHide;var o=N(t,["defaultColor","color","onClick","className","toggleParentAutoHide"]);return e.createElement("div",null,e.createElement(Wb,exports.E({color:n,onClick:i,className:r},o)))})),Wb=e.memo((function(t){var n=t.className,i=void 0===n?"":n,r=t.color,o=t.onClick,a={backgroundColor:Fb(r)};return e.createElement("div",{className:j("color_circle_2W9T7",null===r?"color_null_1UQl9":"",i),style:a,onClick:o},null===r?e.createElement(hl,{className:Jl,icon:"wuyanse"}):null)})),Vb=e.memo((function(t){var n=t.className,i=void 0===n?"":n,r=t.color,o=t.opacity,a=t.onClick,s=t.size,l={};return s&&(l.width="".concat(s,"px"),l.height="".concat(s,"px")),e.createElement("div",{className:j("bg_color_circle_xY-0k",i),onClick:a,style:l},e.createElement(hl,{className:Jl,icon:"wubeijing",size:s}),null===r?null:e.createElement("div",{className:"bg_color_1hvGz",style:exports.E({backgroundColor:hr(r,o)},l)}))})),jb=e.memo((function(t){var n=t.className,i=void 0===n?"":n,r=t.color,o=t.opacity,a=t.onClick;return e.createElement("div",{className:j("border_color_circle_23Avq",i),onClick:a},e.createElement(hl,{className:Jl,icon:"wubiankuang"}),null===r?null:e.createElement("div",{className:"border_color_23nll",style:{borderColor:hr(r,o)}}),16777215===r?e.createElement(e.Fragment,null,e.createElement("div",{className:"white_border1_2a_0n"}),e.createElement("div",{className:"white_border2_14Fa5"})):null)})),Gb=e.memo((function(t){var n=t.className,i=void 0===n?"":n,r=t.color,o=t.onClick,a=t.icon,s=Fb(r);return e.createElement("div",{className:j("text_color_btn_2C8Oe",i),onClick:o},e.createElement(hl,{className:Jl,icon:a||"wenbenyanse"}),e.createElement("div",{className:j("text_color_3hHJz",16777215===r?"white_2KIRs":""),style:{background:s,cursor:"pointer"}},null===r?e.createElement("div",{className:j("transparent_17aRR")},e.createElement("div",{className:j(rc)}),e.createElement("div",{className:j(rc)})):null))})),qb=function(t){var n=t.success,i=t.content,r=e.useContext(xl).upime,o=i,a=o.position,s=o.closeSideEffect,l=o.openSideEffect,c=o.initColor,u=o.onColorPickerChange,d=e.useRef(null!=c?c:16777215),p=e.useRef(yr(d.current)),h=e.useRef([p.current.h,p.current.s,p.current.b]),f=e.useState(vr(h.current[0],1,1)),m=f[0],v=f[1],g=e.useState(166*p.current.h),y=g[0],b=g[1],E=e.useState(gr.apply(void 0,h.current).substring(1)),x=E[0],w=E[1],C=e.useRef(null),S=e.useRef(null),k=e.useRef(null),_=e.useRef(null),T=e.useRef(x),I=e.useRef({connected:!1,pointerId:null,originX:0,baseX:0}),P=e.useRef({connected:!1,pointerId:null,originX:0,baseX:0,baseY:0}),N=function(e){var t=parseInt(T.current,16);u(t,e),r.publish("colorPickerValueChanged",t)},M=e.useCallback((function(e,t){h.current[0]=e,v(vr(h.current[0],1,1));var n=gr.apply(void 0,h.current).substring(1);w(n),T.current=n,N(t)}),[]),A=e.useCallback((function(e,t,n){h.current[1]=e,h.current[2]=t;var i=gr.apply(void 0,h.current).substring(1);w(i),T.current=i,N(n)}),[]);e.useEffect((function(){var e=S.current,t=I.current,n=function(e,n){var i=e.pageX-t.baseX;M(i<=8||i>=174?1:(i-8)/166,n),b(Mn(0,e.pageX-t.baseX-8,166))},i=function(e){e.stopPropagation();var i=I.current.pointerId;null!==i&&i!==e.pointerId||(t.pointerId=e.pointerId,t.connected=!0,n(e,{isStart:!0,isEnd:!1}))},r=function(e){null!==t.pointerId&&t.pointerId!==e.pointerId||t.connected&&n(e,{isStart:!1,isEnd:!1})},o=function(e){null!==t.pointerId&&t.pointerId!==e.pointerId||t.connected&&(t.pointerId=null,t.connected=!1,n(e,{isStart:!1,isEnd:!0}))};if(e){var a=e.getBoundingClientRect().left;I.current.baseX=a,e.addEventListener("pointerdown",i),document.addEventListener("pointermove",r),document.addEventListener("pointerup",o)}return function(){e&&(e.removeEventListener("pointerdown",i),document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",o))}}),[]),e.useEffect((function(){var e=P.current,t=k.current,n=C.current,i=function(t,i){var r=Mn(0,t.pageX-e.baseX,182),o=Mn(0,t.pageY-e.baseY,120);n.style.transform="translate(".concat(r,"px, ").concat(o,"px)"),A(r/182,1-o/120,i)},r=function(r){r.stopPropagation();var o=I.current.pointerId;null!==o&&o!==r.pointerId||(e.pointerId=r.pointerId,e.connected=!0,i(r,{isStart:!0,isEnd:!1}),n.style.cursor="unset",t.style.cursor="none")},o=function(t){null!==e.pointerId&&e.pointerId!==t.pointerId||e.connected&&i(t,{isStart:!1,isEnd:!1})},a=function(r){null!==e.pointerId&&e.pointerId!==r.pointerId||e.connected&&(i(r,{isStart:!1,isEnd:!0}),e.pointerId=null,e.connected=!1,n.style.cursor="move",t.style.cursor="crosshair")};if(t&&n){var s=t.getBoundingClientRect(),l=s.left,c=s.top;e.baseX=l,e.baseY=c,n.style.transform="translate(".concat(182*h.current[1],"px, ").concat(120-120*h.current[2],"px)"),t.addEventListener("pointerdown",r),document.addEventListener("pointermove",o),document.addEventListener("pointerup",a)}return function(){t&&n&&(t.removeEventListener("pointerdown",r),document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",a))}}),[]),e.useEffect((function(){null==l||l();var e=[r.view.subscribe("viewboxChange",(function(){return n(null)})),r.registerHotKey({key:"Escape"},(function(){return n(null)}))],t=function(e){var t=_.current;t&&!t.contains(e.target)&&n(null)};return document.addEventListener("pointerdown",t,!0),function(){r.userManager.mergeColor(parseInt(T.current,16)),e.forEach((function(e){return e()})),null==s||s(),document.removeEventListener("pointerdown",t,!0)}}),[]);var D=function(e){var t=function(e){var t={h:1,s:1,b:1};if(e.startsWith("#")&&(e=e.substring(1)),6!==e.length)return t;try{var n=parseInt(e,16);return yr(n)}catch(e){return t}}(e);M(t.h,{isStart:!0,isEnd:!1}),A(t.s,t.b,{isStart:!1,isEnd:!0}),C.current&&(C.current.style.transform="translate(".concat(182*t.s,"px, ").concat(120-120*t.b,"px)")),b(166*t.h),T.current=e},R=e.useMemo((function(){return!!window.EyeDropper}),[]);return e.createElement("div",{id:"upime-color-picker",className:"root_3VXND",style:{top:"".concat(a.y,"px"),left:"".concat(a.x+10,"px"),height:"".concat(180,"px")},ref:_},e.createElement("div",{className:"palette_1Pnte",style:{background:"rgb(".concat(m.r,", ").concat(m.g,", ").concat(m.b,")")},ref:k},e.createElement("div",{className:"saturation_cover_17N2f"},e.createElement("div",{className:"brightness_cover_MaJU7"})),e.createElement("div",{className:"picker_y34Hc",ref:C})),e.createElement("div",{className:"hueTrack_1zOPb",ref:S},e.createElement("div",{className:"trackCon_1FImJ",style:{padding:"0 ".concat(8,"px")}},e.createElement("div",{className:"trackBg_1_jiO"})),e.createElement("div",{className:"btn_273Je",style:{left:y}})),e.createElement("div",{className:"inputCon_3VLM5",style:{fontFamily:He}},e.createElement("div",null,e.createElement("span",null,"#"),e.createElement("input",{value:x,maxLength:6,onChange:function(e){return w(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.target.blur())},onBlur:function(){/^([0-9]|[a-f]|[A-F]){6}$/.test(x)?D(x):w(T.current)}})),R&&e.createElement(hl,{icon:"xiguan",className:j("eyedropper_2khia"),onClick:function(){R&&(new window.EyeDropper).open().then((function(e){if(e.sRGBHex){var t=e.sRGBHex.startsWith("rgb")?br(e.sRGBHex):e.sRGBHex;D(t.substring(1)),w(t.substring(1))}})).catch((function(e){}))}})))},Kb=function(t){var n=t.config,i=t.initColor,r=e.useContext(xl).upime,o=e.useContext(Ic).rootContainer,a=e.useRef(null),s=e.useState(!1),l=s[0],c=s[1],u=e.useState(null!=i?i:null),d=u[0],p=u[1];return e.useEffect((function(){i&&p(i)}),[i]),e.useEffect((function(){var e=r.subscribe("colorPickerValueChanged",(function(e){p(e)}));return function(){e()}}),[]),e.createElement(e.Fragment,{key:"plus-icon"},l?e.createElement("div",{style:{position:"relative"}},e.createElement(Wb,{color:d}),e.createElement("div",{className:"color_placeholder_mark_1Wo93"},e.createElement(hl,{icon:"gou"}))):e.createElement("div",{className:"plusCon_1HUi7",ref:a,onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,i,s,l;return D(this,(function(u){switch(u.label){case 0:return e=a.current.getBoundingClientRect(),t=o.current.getBoundingClientRect(),i=e.right,s=e.top,l=t.bottom,s+180>l&&(s=l-180),c(!0),[4,r.enableColorPickerPopup(exports.E({position:{x:i-t.left,y:s-t.top}},n))];case 1:return u.sent(),c(!1),[2]}}))}))}},e.createElement(hl,{icon:"plus"})))};function Yb(t){var n=t.className,i=void 0===n?"":n,r=t.colorItemClassName,o=t.colorPalettes,a=void 0===o?je:o,s=t.defaultValue,l=void 0===s?1710618:s,c=t.enableTransparent,u=void 0!==c&&c,d=t.onChanged,p=t.colorPickerConfig,h=t.toggleParentAutoHide,f=t.isIndependent,m=void 0===f||f,v=l,g=function(e){d(e)},y=e.useContext(Ic).phoneLayout,b=y?Ub:Hb,E=[];u&&E.push(e.createElement(b,{color:null,key:"color-transparent",className:j(null===v?nc:"",r),onClick:g.bind(null,null),defaultColor:!0}));for(var x=0;x<a.length;x++){var w=a[x],C=v===w;E.push(e.createElement(b,{key:"color-".concat(w,"}"),className:j(C?ic:"",r),color:w,onClick:g.bind(null,w),defaultColor:x<=je.length-1,toggleParentAutoHide:h}))}return p&&!y&&E.push(e.createElement(Kb,{key:"plus-color",config:exports.E(exports.E({},p),{initColor:v}),initColor:v})),e.createElement("div",{className:j($l,y&&ec,m&&tc,i)},E)}var Xb=function(t){var n=t.propEditor,i=t.opacitySlider,r=W().getUpimeTrans,o=e.useContext(Ic),a=o.phoneLayout,s=o.phoneElementSubBarContainer,l=n.editor,c=n.element,u=c.bgColor,d=c.hasBg,p=void 0===d||d,h=c.bgOpacity,f=void 0===h?1:h,m=p?u:null,v=e.useCallback((function(e){null===e?l.updateProperty({hasBg:!1}):!1===c.hasBg?l.updateProperty({bgColor:e,hasBg:!0}):l.updateProperty({bgColor:e}),a&&E(!0)}),[]),g={};a&&(g.checkSkip=function(e){return!!s.current&&V(s.current,e)});var y=yh(!0,g),b=y.hide,E=y.setHide,x=y.toggleHide,w=y.skipRef,C=a?Xg:xh,S=e.createElement(e.Fragment,null,i,e.createElement(Yb,{colorPalettes:n.getBgColors(),defaultValue:m,onChanged:v,enableTransparent:void 0!==c.hasBg,colorPickerConfig:n.customizeColor?{onColorPickerChange:function(e,t){l.slideUpdateProperty(exports.E({bgColor:e},!c.hasBg&&{hasBg:!0}),t,!0)}}:void 0,isIndependent:!1,className:j(a?Qr:void 0)}));return e.createElement("div",{className:Ar,ref:w,onPointerDown:ie},e.createElement(Dl,{content:r(i?"element.bg&opacity":"element.bg"),placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:x},e.createElement(Vb,{color:m,opacity:f})))),!b&&e.createElement(C,{align:"center",selfAdjust:!0},a?e.createElement("div",{className:Ml.phoneBgColorFcContainer},S):S))},Qb=function(t){var n=t.propEditor,i=e.useContext(Ic).phoneLayout,r=W().getUpimeTrans,o=n.editor,a=n.element,s=a.hasBg,l=a.bgOpacity,c=e.useCallback((function(e,t){o.slideUpdateProperty({bgOpacity:e},t,!0)}),[]),u=e.createElement(Qg,{className:i?Xr:void 0},e.createElement(bc,{className:"bg_opacity_3u5Kz",onChanged:c,editable:s,defaultValue:l}),e.createElement("label",{className:j(Lr,i&&Or)},r("element.opacity"),e.createElement("span",{className:Fr},100*l,"%")));return e.createElement(Xb,{propEditor:n,opacitySlider:u})},Zb=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="bgColor",t.renderer=Xb,t.customizeColor=!0,t}return P(t,e),t.prototype.getBgColors=function(){return this.editor.upime.userManager.userPalette},t}(ay),Jb=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="bgStyle",t.renderer=Qb,t.customizeColor=!0,t}return P(t,e),t.prototype.getBgColors=function(){return this.editor.upime.userManager.userPalette},Object.defineProperty(t.prototype,"available",{get:function(){return!this.block||!this.block.color||!this.block.opacity},enumerable:!1,configurable:!0}),t}(ay);function $b(t){var n=t.className,i=void 0===n?"":n,r=t.value,o=t.data,a=t.onChanged,s=e.useContext(Ic).phoneLayout,l=function(e){r!==e&&a(e)};return e.createElement("div",{className:j(hc,s&&fc,i)},Array.from(o.entries()).map((function(t){var n=t[0],i=t[1],o=i.icon,a=i.disabled;return e.createElement("div",{className:j(mc,a?Xl:""),key:o,onClick:a?void 0:l.bind(null,n)},e.createElement(hl,{icon:o,className:n===r?ic:""}))})))}var eE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.editor,l=n.element,c=l.borderColor,u=l.borderOpacity,d=l.hasBorder,p=d?c:null,h=e.useCallback((function(e){if(null===e)s.updateProperty({hasBorder:!1});else{var t={borderColor:e};l.hasBorder||(t.hasBorder=!0),s.updateProperty(t)}o&&E(!0)}),[]),f=e.useCallback((function(e,t){s.slideUpdateProperty({borderOpacity:e},t,!0)}),[]),m=(it.findIndex((function(e){return e===l.borderThickness}))+1)/10,v=e.useCallback((function(e,t){e=it[10*e-1],(l.borderThickness!==e||t.isStart||t.isEnd)&&s.slideUpdateProperty({borderThickness:e},t,!0)}),[]),g={};o&&(g.checkSkip=function(e){return!!a.current&&V(a.current,e)});var y=yh(!0,g),b=y.hide,E=y.setHide,x=y.toggleHide,w=y.skipRef,C=e.useMemo((function(){return new Map([[1,{icon:"shixian"}],[3,{icon:"xuxian"}],[2,{icon:"dianzhuang"}]])}),[]),S=o?Xg:xh,k=n.block,_=e.createElement(e.Fragment,null,!(null==k?void 0:k.style)&&e.createElement($b,{className:j("type_select_3-Oju",(null==k?void 0:k.color)&&"type_select_padding_2PIr7"),value:l.borderStyle,data:C,onChanged:function(e){s.updateProperty({borderStyle:e})}}),!(null==k?void 0:k.width)&&e.createElement(e.Fragment,null,e.createElement(Qg,{className:o?Xr:void 0},e.createElement("div",{className:Dr},e.createElement(bc,{className:Rr,onChanged:v,editable:d,defaultValue:m})),e.createElement("label",{className:j(Lr,o&&Or)},i("element.borderWidth"))),e.createElement("div",{className:Br})),!(null==k?void 0:k.opacity)&&e.createElement(e.Fragment,null,e.createElement(Qg,{className:o?Xr:void 0},e.createElement("div",{className:Dr},e.createElement(bc,{className:Rr,onChanged:f,editable:d,defaultValue:u})),e.createElement("label",{className:j(Lr,o&&Or)},i("element.opacity"),e.createElement("span",{className:Fr},100*u,"%"))),e.createElement("div",{className:Br})),!(null==k?void 0:k.color)&&e.createElement(Yb,{colorPalettes:n.getBorderColors(),enableTransparent:!0,defaultValue:p,onChanged:h,colorPickerConfig:{onColorPickerChange:function(e,t){s.slideUpdateProperty({borderColor:e},t,!0)}},isIndependent:!1,className:j(o?Qr:void 0)}));return e.createElement("div",{className:Ar,ref:w,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("element.borderStyle")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:x},e.createElement(jb,{color:p,opacity:u})))),!b&&e.createElement(S,{align:"center",selfAdjust:!0},o?e.createElement("div",{className:Ml.phoneBgColorFcContainer},_):_))},tE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="borderStyle",t.renderer=eE,t.couldAffectGroup=!0,t}return P(t,e),t.prototype.getBorderColors=function(){return this.editor.upime.userManager.userPalette},Object.defineProperty(t.prototype,"available",{get:function(){var e=this.block;return!(e&&e.color&&e.opacity&&e.style&&e.width)},enumerable:!1,configurable:!0}),t}(ay);function nE(t){var n=t.className,i=void 0===n?"":n,r=t.defaultValue,o=t.getValue,a=t.onChanged,s=e.useRef(null),l=100*Ul({ref:s,defaultValue:r=r||o&&o()||0,onChanged:a}).value;return l<0?l=0:l>100&&(l=100),e.createElement("div",{className:j(Wl,i),ref:s},e.createElement("div",{className:Vl}),e.createElement("div",{className:jl},e.createElement("div",{className:Gl,style:{width:l+"%"}}),e.createElement("div",{className:ql,style:{left:l+"%"}})))}var iE,rE,oE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.editor,l=n.element,c=l.lineColor,u=l.lineOpacity,d=n.getCcolorPalettes(),p=e.useRef(!0),h=yh(!0,{checkSkip:function(e){var t;return!!(o&&a.current&&V(a.current,e))||!p.current||!!(null===(t=v.current)||void 0===t?void 0:t.contains(e))}}),f=h.hide,m=h.toggleHide,v=h.skipRef,g=h.setHide,y=l.penType===Ya.NORMAL,b=o?Xg:xh,E=e.createElement(e.Fragment,null,!y&&e.createElement("div",{className:j(zr,o&&Ur)},e.createElement(bc,{onChanged:function(e){!y&&s.updateProperty({lineOpacity:e})},defaultValue:null!=u?u:.5}),e.createElement("span",null,i("element.opacity")),e.createElement("span",{className:Hr},"".concat(100*(null!=u?u:.5),"%"))),e.createElement(Yb,{colorPalettes:d,defaultValue:c,onChanged:function(e){g(!0),e!==c&&s.updateProperty({lineColor:e})},colorPickerConfig:{onColorPickerChange:function(e,t){s.slideUpdateProperty({lineColor:e},t,!0)}},toggleParentAutoHide:function(e){p.current=e},isIndependent:!1}));return e.createElement("div",{className:Ar,ref:v},e.createElement(Dl,{placement:"top",content:i(y?"element.color":"element.bg&opacity")},e.createElement("div",{className:Ar},e.createElement("div",{className:Mr,onClick:m},y?e.createElement(Wb,{color:c}):e.createElement(Vb,{color:c,opacity:null!=u?u:.5})))),!(f&&p)&&e.createElement(b,{align:"center",selfAdjust:!0},o?e.createElement("div",{className:Yr},E):E))},aE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.editor,l=n.element,c=l.lineColor,u=l.lineOpacity,d=n.getCcolorPalettes(),p=e.useRef(!0),h=yh(!0,{checkSkip:function(e){var t;return!!(o&&a.current&&V(a.current,e))||!p.current||!!(null===(t=v.current)||void 0===t?void 0:t.contains(e))}}),f=h.hide,m=h.toggleHide,v=h.skipRef,g=h.setHide,y=l.penType===Ya.NORMAL,b=e.useCallback((function(e,t){t.isEnd&&(s.updateProperty({lineWidth:29*e+1}),s.updateBorderBox())}),[]),E=e.createElement(e.Fragment,null,e.createElement("div",{className:j(zr,o&&Ur)},e.createElement(nE,{getValue:function(){return(l.lineWidth-1)/29},onChanged:b}),e.createElement("span",null,i("element.borderWidth"))),!y&&e.createElement("div",{className:j(zr,o&&Ur)},e.createElement(bc,{onChanged:function(e){!y&&s.updateProperty({lineOpacity:e})},defaultValue:null!=u?u:.5}),e.createElement("span",null,i("element.opacity")),e.createElement("span",{className:j(Hr,"right20_1dfpX")},"".concat(100*(null!=u?u:.5),"%"))),e.createElement(Yb,{colorPalettes:d,defaultValue:c,onChanged:function(e){g(!0),e!==c&&s.updateProperty({lineColor:e})},colorPickerConfig:{onColorPickerChange:function(e,t){s.slideUpdateProperty({lineColor:e},t,!0)}},toggleParentAutoHide:function(e){p.current=e},isIndependent:!1,className:Qr}));return e.createElement("div",{className:Ar,ref:v},e.createElement("div",{className:Ar},e.createElement("div",{className:Mr,onClick:m},y?e.createElement(Wb,{color:c}):e.createElement(Vb,{color:c,opacity:null!=u?u:.5}))),!(f&&p)&&e.createElement(Xg,null,e.createElement("div",{className:Yr},E)))},sE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="lineColor",t.renderer=oE,t}return P(t,e),t.prototype.getCcolorPalettes=function(){return this.editor.upime.userManager.userPalette},t}(ay),lE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="lineColorAndWidth",t.renderer=aE,t}return P(t,e),t.prototype.getCcolorPalettes=function(){return this.editor.upime.userManager.userPalette},t}(ay),cE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.editor,o=n.element,a=e.useCallback((function(e,t){t.isEnd&&(r.updateProperty({lineWidth:29*e+1}),r.updateBorderBox())}),[]);return e.createElement(Dl,{placement:"top",content:i("line.width")},e.createElement("div",{className:"line_width_container__RLf1"},e.createElement(nE,{className:"line_width_editor_1bRmM",getValue:function(){return(o.lineWidth-1)/29},onChanged:a})))},uE=function(e,t){this.editor=e,this.element=t,this.propertyName="lineWidth",this.couldAffectGroup=!0,this.renderer=cE},dE=function(t){var n=t.propEditor,i=n.borderEditor,r=n.bgEditor;return e.createElement(e.Fragment,null,!1!==i.available&&e.createElement(i.renderer,{propEditor:i}),!1!==r.available&&e.createElement(r.renderer,{propEditor:r}))},pE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="shapeStyle",t.borderEditor=new tE(t.editor,t.element),t.bgEditor=new Jb(t.editor,t.element),t.renderer=dE,t}return P(t,e),Object.defineProperty(t.prototype,"available",{get:function(){return!1!==this.borderEditor.available||!1!==this.bgEditor.available},enumerable:!1,configurable:!0}),t}(ay),hE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.getColor(),l=n.getColorPalettes(),c={};o&&(c.checkSkip=function(e){return!!a.current&&V(a.current,e)});var u=yh(!0,c),d=u.hide,p=u.toggleHide,h=u.skipRef,f=u.setHide,m=o?Xg:xh;return e.createElement("div",{className:Ar,ref:h,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.color")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:p},e.createElement(Gb,{color:s})))),!d&&e.createElement(m,{align:"center",selfAdjust:!0},e.createElement(Yb,{colorPalettes:l,defaultValue:s,onChanged:function(e){f(!0),n.changeColor(e)},colorPickerConfig:{onColorPickerChange:function(e,t){n.slideChangeColor(e,t)}}})))},fE=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.getHighLight(),l=n.getColorPalettes(),c={};o&&(c.checkSkip=function(e){return!!a.current&&V(a.current,e)});var u=yh(!0,c),d=u.hide,p=u.toggleHide,h=u.skipRef,f=u.setHide,m=o?Xg:xh;return e.createElement("div",{className:Ar,ref:h,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.highLight")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:p},e.createElement(Gb,{color:s,icon:"highLight"})))),!d&&e.createElement(m,{align:"center",selfAdjust:!0},e.createElement(Yb,{enableTransparent:!0,colorPalettes:l,defaultValue:s,onChanged:function(e){f(!0),n.changeHighLight(e)},colorPickerConfig:{onColorPickerChange:function(e,t){n.slideChangeHighLight(e,t)}}})))},mE=function(t){var n=t.propEditor;return e.createElement(e.Fragment,null,e.createElement(hE,{propEditor:n}),e.createElement(fE,{propEditor:n}))},vE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="textColor",t.renderer=mE,t.curOp=void 0,t.curLock=null,t}return P(t,e),Object.defineProperty(t.prototype,"curTextEditor",{get:function(){return this.editor.connectedEditor||this.element},enumerable:!1,configurable:!0}),t.prototype.getHighLight=function(){return this.curTextEditor.currentStyle.highLight||null},t.prototype.changeHighLight=function(e){this.onSetRichStyle({highLight:e})},t.prototype.slideChangeHighLight=function(e,t){this.slideSetRichStyle({highLight:e},t)},t.prototype.getColor=function(){return this.curTextEditor.currentStyle.color},t.prototype.getColorPalettes=function(){return this.editor.upime.userManager.userPalette},t.prototype.changeColor=function(e){this.onSetRichStyle({color:e}),this.editor.lastColor=e},t.prototype.slideChangeColor=function(e,t){this.slideSetRichStyle({color:e},t),this.editor.lastColor=e},t.prototype.onSetRichStyle=function(e){if(this.editor.editingEditor)this.editor.editingEditor.setRichStyle(e);else{var t=this.editor.upime,n=this.editor.getElements(),i=this.editor.upime.createOperation(),r=n.map((function(e){return e.id})),o=t.createLock(r);n.forEach((function(t){var n,r=t.currentEditor;r&&(r.richContentEditor||(null===(n=r.richContentEditors)||void 0===n?void 0:n.length))&&(r.currentOp=i,r.richContentEditors?r.richContentEditors.forEach((function(t){return t.setRichStyle(e)})):r.richContentEditor&&r.richContentEditor.setRichStyle(e),r.currentOp=void 0)})),i.sync(),t.clearLock(o)}},t.prototype.slideSetRichStyle=function(e,t){var n,i=this,r=this.editor.upime,o=this.editor.getElements();if(t.isStart){this.curOp=r.createOperation(),this.editor.getElements();var a=o.map((function(e){return e.id}));this.curLock=r.createLock(a)}this.curOp&&o.forEach((function(t){var n,r=t.currentEditor;r&&(r.richContentEditor||(null===(n=r.richContentEditors)||void 0===n?void 0:n.length))&&(r.currentOp=i.curOp,r.richContentEditors?r.richContentEditors.forEach((function(t){return t.setRichStyle(e)})):r.richContentEditor&&r.richContentEditor.setRichStyle(e),r.currentOp=void 0)})),t.isEnd&&(null===(n=this.curOp)||void 0===n||n.sync(),this.curLock&&r.clearLock(this.curLock),this.curOp=void 0,this.curLock=null)},t}(ay),gE=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.editable&&!r.isHandMode&&(r.upime.phoneMode&&"phone"===r.phoneToolbarMode?r.propertyEditors.push(new lE(r,n)):(r.propertyEditors.push(new uE(r,n)),r.propertyEditors.push(new sE(r,n)))),r}return P(t,e),t.prototype.dealBorderResize=function(e,t,n){var i=t.left,r=t.top,o=t.right-i,a=this.element,s=a.lineBorderRect,l=a.lineWidth,c=o/(s.right-s.left+l),u=i-(s.left-l/2)*c,d=r-(s.top-l/2)*c,p=this.element.position;this.updateSelf({position:exports.E(exports.E({},p),{x:u,y:d}),scale:c})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t}(Ob),yE=function(e){var t=e.position,n=e.lineColor,i=e.scale,r=e.ended,o=e.penType,a=e.lineOpacity,s=e.lineWidth*i,l=t.x,c=t.y,u=e.useCallback("drawLine",(function(t){t.clear();var l=e.path.map((function(e){return e*i}));if(l.length){t.lineStyle({width:s,color:n,cap:"round",join:"round",alpha:o===Ya.MARK?a:1});for(var c=0;c<l.length;c+=4)if(0===c)t.quadraticCurveTo(l[c],l[c+1],l[c+2],l[c+3]);else{var u=l[c-2],d=l[c-1],p=l[c],h=l[c+1],f=l[c+2],m=l[c+3],v=gn({x:u,y:d},{x:p,y:h}),g=gn({x:p,y:h},{x:f,y:m}),y=.015*s;v<=y||g<=y?t.lineTo(l[c+2],l[c+3]):t.quadraticCurveTo(l[c],l[c+1],l[c+2],l[c+3])}}else r&&(t.moveTo(0,0),t.beginFill(n,o===Ya.MARK?a:1),t.drawCircle(0,0,s/2),t.endFill())}),[e.path,i,s,n,r,a]),d=hf(e,1,[e.path,i]);gf(e,d),Na(u,{x:l,y:c}),ma()},bE=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=yE,t.editorType=gE,t.lineWidth=4,t.lineColor=1710618,t.ended=!1,t.drawPoints=[],t.path=[],t.penType=Ya.NORMAL,t.lineBorderRect={left:0,top:0,right:0,bottom:0},t}return P(t,e),Object.defineProperty(t.prototype,"minVisibleSize",{get:function(){return.05},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype._checkUnAvailable=function(){return e.prototype._checkUnAvailable.call(this)||!this.ended},t.prototype.dealUpdate=function(t){var n=t.drawPoints,i=t.straightLine,r=t.deleted,o=N(t,["drawPoints","straightLine","deleted"]);n&&(!1===r&&(this.drawPoints=[],this.path=[]),this.updateDrawPoints(n)),i&&this.replaceDrawPoints(i),e.prototype.dealUpdate.call(this,o),(t.drawPoints||t.position||void 0!==t.rotate||void 0!==t.lineWidth)&&this.updateBorderBox()},t.prototype.updateDrawPoints=function(e){for(var t=this.drawPoints,n=R([],this.path,!0),i={x:t[t.length-2]||0,y:t[t.length-1]||0},r=0;r<e.length;r+=2)n.push(i.x,i.y,(i.x+e[r])/2,(i.y+e[r+1])/2),i.x=e[r],i.y=e[r+1];this.drawPoints=R(R([],this.drawPoints,!0),e,!0),this.path=n,this.updateBorderRect(e)},t.prototype.replaceDrawPoints=function(e){this.drawPoints=[],this.path=[],this.lineBorderRect={left:0,top:0,right:0,bottom:0},this.updateDrawPoints(e)},t.prototype.updateBorderRect=function(e){for(var t=this.lineBorderRect,n=t.left,i=t.top,r=t.right,o=t.bottom,a=0;a<e.length;a+=2){var s=e[a],l=e[a+1];s<n?n=s:s>r&&(r=s),l<i?i=l:l>o&&(o=l)}this.lineBorderRect={left:n,top:i,right:r,bottom:o}},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y,i=this.scale,r=this.lineBorderRect,o=r.left,a=r.top,s=r.right,l=r.bottom;return{left:t+(o-this.lineWidth/2)*i,top:n+(a-this.lineWidth/2)*i,right:t+(s+this.lineWidth/2)*i,bottom:n+(l+this.lineWidth/2)*i,rotate:this.rotate}},t.prototype._checkSelectRelation=function(t,n){var i;if("attach"===n.type)return e.prototype._checkSelectRelation.call(this,t,n);var r=this.getBorderBox(),o=r.left,a=r.top,s=r.right,l=r.bottom,c=t.x,u=t.y,d=(null===(i=this.parentRefSystem)||void 0===i?void 0:i.globalTransform.currentScale)||1,p=this.upime.view.scale*d,h=(s-o)*(l-a)*p*p,f=h<=13225,m=f?0:8/p;if(c>=o-m&&c<=s+m&&u>=a-m&&u<=l+m){var v=this.scale,g=this.lineWidth*v,y=null;f&&(y={transparent:!1,metric:h});var b=-1,E=this.path;if(E.length>0){for(var x=[],w={x:c-this.position.x,y:u-this.position.y},C=0;C<E.length;C+=4){var S={x:E[C-2]*v||0,y:E[C-1]*v||0},k={x:E[C]*v,y:E[C+1]*v},_={x:E[C+2]*v,y:E[C+3]*v};x.push(ln(S,k,_,w))}b=x.sort((function(e,t){return e-t}))[0]}else b=fn(this.position,t);return g/2>m?b<=g/2&&(y={transparent:!1,metric:-1}):b<=m&&(y={transparent:!1,metric:-1}),y}return null},t}(oy),EE=function(e,t){var n=this;this.upime=e,this.style=t,this.position={x:0,y:0},this.renderer=xE,this.renderKey="pure-circle",this.borderThickness=1,this.hide=!1,this.onMount=function(){n.onUnmount=n.upime.userEventManager.subscribe("mousemove",(function(e){n.hide||(n.position=e.globalPosition,n.upime.updateWidgetCvs())}))}},xE=function(e){var t=e.element,n=e.viewbox;e.upime;var i=t.style,r=t.hide,o=t.borderThickness,a=t.position;if(!r){var s=i.lineColor,l=i.lineWidth,c=n.scale;Na((function(e){e.clear(),e.lineStyle({width:o,color:s}),e.drawCircle(0,0,l/2*c)}),a)}},wE=function(){function e(e,t,n){this.upime=e,this.style=t,this.renderer=CE,this.renderKey="draftLine"+Date.now(),this.path=[],this.lastPoint={x:0,y:0},this.linePath="",this.lastPoint=n}return e.prototype.appendPoints=function(e){var t=this.lastPoint,n=exports.E({},t),i={x:(t.x+e.x)/2,y:(t.y+e.y)/2};0===this.path.length&&(this.linePath="M".concat(t.x,",").concat(t.y)),this.path.push(n,i),gn(n,i)<=2?this.linePath+=" L".concat(i.x,",").concat(i.y):this.linePath+=" Q".concat(n.x,",").concat(n.y," ").concat(i.x,",").concat(i.y),this.lastPoint=e},e.prototype.replacePoints=function(e){if(0!==e.length){this.path=e,this.lastPoint=e[e.length-1];for(var t="M".concat(e[0].x,",").concat(e[0].y),n=0;n<e.length;n+=2)gn(e[n],e[n+1])<=2?t+=" L".concat(e[n+1].x,",").concat(e[n+1].y):t+=" Q".concat(e[n].x,",").concat(e[n].y," ").concat(e[n+1].x,",").concat(e[n+1].y);this.linePath=t}},M([rl],e.prototype,"linePath",void 0),M([il],e)}(),CE=function(t){var n=t.element,i=t.viewbox;al(n);var r=n.style,o=n.linePath,a=r.lineColor,s=r.lineOpacity,l=void 0===s?1:s,c=r.lineWidth*i.scale;return e.createElement("path",{d:o,strokeOpacity:l,strokeWidth:c,stroke:pr(a),strokeLinejoin:"round",strokeLinecap:"round",fill:"none"})},SE=((iE={})[Za.STICKER]=tb.S,iE[Za.TEXT]=1,iE);function kE(e){var t=e.upime,n=e.size,i=e.id,r=e.scale,o=e.currentScale,a=e.position,s=e.eleType,l=t.view.viewWidth,c=t.view.viewHeight,u=n.width*r*t.view.scale,d=n.height*r*t.view.scale;if(s===Za.STICKER){if(t.phoneMode)return(l-220)/Ke.width/o/t.view.scale;if(u<.05*l||u>.75*l||d<.05*c||d>.75*c){var p=t.elementManager.getAllElements().filter((function(e){return e.elementType===s&&e.id!==i})).map((function(e){var t=Lt(e.getGlobalBox());return{id:e.id,size:e.size,scale:e.scale,currentScale:e.globalTransform.currentScale,centerPoint:t}})),h=null,f=Number.MAX_VALUE;if(p.forEach((function(e){var t=Math.sqrt(Math.pow(a.x-e.centerPoint.x,2)+Math.pow(a.y-e.centerPoint.y,2));t<f&&(h=e,f=t)})),h){var m=h,v=m.size,g=m.scale,y=m.currentScale,b=v.width*g*y*t.view.scale,E=v.height*g*y*t.view.scale;r=b<.05*l||b>.75*l||E<.05*c||E>.75*c?SE[s]/t.view.scale/o:g}else r=SE[s]/t.view.scale/o}}else s===Za.TEXT&&(u<=56||d<=18?r*=Math.max(56/u,18/d)/o:(u>=1270||d>=370)&&(r*=Math.min(1270/u,370/d)/o));return r}var _E,TE=((rE={})[Za.SHAPE]=Je,rE[Za.GRAPHIC]=Je,rE);function IE(e){var t=e.upime,n=e.element,i=n.size,r=n.position,o=n.scale,a=n.globalTransform,s=n.elementType,l=n.id,c=n.fontSize,u=n.lineHeight,d=n.lineHeightRate,p=a.currentScale,h=t.view.viewWidth,f=t.view.viewHeight,m=i.width*o*p*t.view.scale,v=i.height*o*p*t.view.scale;if(t.phoneMode){var g=(h-220)/TE[s].width*14/t.view.scale/p;return{size:{width:(h-220)/p/t.view.scale,height:(h-220)/p/t.view.scale},fontSize:g,lineHeight:ib(g,d),changed:!0}}var y=i,b=c,E=u,x=m<.05*h||m>.75*h||v<.05*f||v>.75*f;if(x){var w=Array.from(t.view.getRenderNodes()).filter((function(e){return e.elementType===s&&e.id!==l})).filter((function(e){return e.elementType!==Za.GRAPHIC||e.textNodes.length>0})).map((function(e){var t=Lt(e.getGlobalBox());return exports.E({id:e.id,size:e.size,scale:e.scale,currentScale:e.globalTransform.currentScale,centerPoint:t},function(e){var t,n;if(e.elementType===Za.GRAPHIC){var i=null===(n=null===(t=e.textNodes)||void 0===t?void 0:t[0])||void 0===n?void 0:n.styleProperty.getInitData();return{fontSize:(null==i?void 0:i.fontSize)||14,lineHeight:(null==i?void 0:i.lineHeight)||Ue}}return{fontSize:e.fontSize,lineHeight:e.lineHeight}}(e))})),C=null,S=Number.MAX_VALUE;if(w.forEach((function(e){var t=Math.sqrt(Math.pow(r.x-e.centerPoint.x,2)+Math.pow(r.y-e.centerPoint.y,2));t<S&&(C=e,S=t)})),C){var k=C,_=k.size,T=k.scale,I=k.currentScale,P=k.fontSize,N=k.lineHeight,M=_.width*T*I*t.view.scale,A=_.height*T*I*t.view.scale;M<.05*h||M>.75*h||A<.05*f||A>.75*f?(y={width:TE[s].width/t.view.scale/p,height:TE[s].height/t.view.scale/p},b=14/t.view.scale/p,E=ib(b,d)):(y=_,b=P,E=N)}else y={width:TE[s].width/t.view.scale/p,height:TE[s].height/t.view.scale/p},b=14/t.view.scale/p,E=ib(b,d)}return{size:y,fontSize:b,lineHeight:E,changed:x}}!function(e){e[e.hor=1e3]="hor",e[e.ver=1001]="ver"}(_E||(_E={}));var PE={"basic-square":Ka.RECT,"basic-rounded":Ka.ROUNDRECT,"basic-oval":Ka.ELLIPSE,"basic-triangle":Ka.TRIANGLE,"basic-rhombus":Ka.DIAMOND,"basic-parall":Ka.PARALLELOGRAM,"basic-arrow-left":Ka.BIG_LEFT_ARROW,"basic-arrow-right":Ka.BIG_RIGHT_ARROW,"basic-barrel":Ka.BARREL,"flowchart-document":Ka.DOCUMENT},NE={graphicSideContainer:"graphicSideContainer_jScOm",title:"title_2y8qG",titleIconContainer:"titleIconContainer_2HpFh",rotate:"rotate_3mkgL",searchContentContainer:"searchContentContainer_2aGCw",inputDomContainer:"inputDomContainer_aORAa",qingchuHotarea:"qingchuHotarea_CavnD",qingchuIcon:"qingchuIcon_2Z2NJ",searchIcon:"searchIcon_2yMds",input:"input_S5_HS",categroyWrapper:"categroyWrapper_2QXR0",emptyContainer:"emptyContainer_1tl6E",emptyImg:"emptyImg_PnK1N",categroyContainer:"categroyContainer_2fReq",categroyTitle:"categroyTitle_1jXxy",hasHover:"hasHover_3obj2",iconContainer:"iconContainer_aHe3e",iconRotate:"iconRotate_R8Zzg",colorpalettesWrapper:"colorpalettesWrapper_26FnQ",colorpalettesOptionContainer:"colorpalettesOptionContainer_3B7E_",colorpalettesContaienr:"colorpalettesContaienr_2Tw5t",tinyColorPa:"tinyColorPa_2hUVD",tinyCate:"tinyCate_38BwA",defaultColorTheme:"defaultColorTheme_2B6iW",simpleColorTheme:"simpleColorTheme_21RUC",simpleColorCircle:"simpleColorCircle_314Rw",childrenOptionContainer:"childrenOptionContainer_3c2BF",options:"options_39ftb",iconListContainer:"iconListContainer_92Ipt",iconListView:"iconListView_sqkVV",iconCell:"iconCell_2I3tD",draggingIcon:"draggingIcon_1wKts",tinyIconList:"tinyIconList_3JAOj"},ME={color:1710618,highLight:null,bolder:!1,italic:!1,underLine:!1,deleteLine:!1},AE=function(e){return exports.E(exports.E(exports.E({hasBg:!0,bgColor:je[0],bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He},ME),e),{clusterId:null,clusterRoot:!1})},DE=[Za.GRID_TEXT,Za.IMAGE,Za.TEXT,Za.STICKER,Za.SHAPE,Za.LINE],RE=_e.isTouchSupported?8:4,BE=Object.values(Ka).filter((function(e){return yt.exports.isNumber(e)})),LE=function(t){var n=t.category,i=t.currentColor,r=t.onPick,o=t.tiny,a=void 0!==o&&o,s=t.draggle,l=void 0===s||s,c=t.colorPalettes,u=e.useContext(xl).upime;function d(){return!i||!c||$E(c[c.length-1],i)}function p(e){if(r)r(e);else{if(e.is){if(BE.includes(e.is))return void zE(e.is,e,u,{silent:!1,currentColor:i,isDefaultColor:d()});if(e.is===_E.hor||e.is===_E.ver)return void HE(e.is,u)}UE(e,u,{currentColor:i,isDefaultColor:d()})}}function h(e,t,n){var r,o=u.view.getAbsolutePosition(t),a=void 0;if(u.switchMode("select"),e.is)if(BE.includes(e.is)){var s=zE(e.is,e,u,{silent:!0,position:o,currentColor:i,isDefaultColor:d()}),l=s.shape,c=s.textColor;a=l,void 0!==c&&(null===(r=l.richTextClient)||void 0===r||r.contentEditor.updateStyle({color:c}))}else e.is!==_E.hor&&e.is!==_E.ver||(a=HE(e.is,u,{position:o}));else{var p=UE(e,u,{currentColor:i,silent:!0,position:o,isDefaultColor:d()}),h=p.graphicElement,f=p.textColor,m=p.fontStyle;a=h,h.onGetSchema=function(){var e=u.createOperation();_e.desktop&&h.textNodes.forEach((function(t){t.updateStyle(e,m),e.sync(),u.deleteOperation(e)}))},h.onDragInsertEnd=function(){var e,t;if(_e.desktop){var n=h.currentEditor;n&&(n.connectedEditor||n.connectTextEditor(),_t.isNil(f)||null===(e=n.connectedEditor)||void 0===e||e.updateStyle({color:f}),n.startEdit(),null===(t=n.connectedEditor)||void 0===t||t.pickAll())}}}return a&&(u.setDirectMoveTarget(a),u.userEventManager.forceTriggerPressEvt(n instanceof TouchEvent?"touch":"mouse",n)||u.clearDirectMoveTarget()),a}return e.createElement("div",{className:j(NE.iconListContainer,a&&NE.tinyIconList)},e.createElement("div",{className:NE.iconListView},n.list.map((function(t){return t.deleted?null:e.createElement(OE,{key:t.id,item:t,onSelect:p,onDragInsert:h,currentColor:i,draggle:l})}))))};function OE(t){var n=t.item,i=t.onSelect,r=t.onDragInsert,o=t.currentColor,a=t.draggle,s=void 0===a||a,l=e.useState(!1),c=l[0],u=l[1],d=e.useState({x:0,y:0}),p=d[0],h=d[1],f=e.useState({x:0,y:0}),m=f[0],v=f[1],g=e.useState(!1),y=g[0],b=g[1];function E(e,t,i){y||b(!0),v(e),e.x>=348&&(t(),r(n,e,i))}function x(e){c&&(!y&&Math.sqrt(Math.pow(e.pageX-p.x,2)+Math.pow(e.pageY-p.y,2))<RE||E({x:e.pageX,y:e.pageY},w,e))}function w(){b(!1),u(!1)}function C(){b(!1),u(!1)}function S(e){if(c)if(1===e.touches.length){var t=e.touches[0];!y&&Math.sqrt(Math.pow(t.pageX-p.x,2)+Math.pow(t.pageY-p.y,2))<RE||E({x:t.pageX,y:t.pageY},C,e)}else C()}return e.useEffect((function(){if(c)return _e.isTouchSupported?(document.addEventListener("touchmove",S),document.addEventListener("touchend",C)):(document.addEventListener("pointermove",x),document.addEventListener("pointerup",w)),function(){document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",w),document.removeEventListener("touchmove",S),document.removeEventListener("touchend",C)}}),[c]),e.createElement(e.Fragment,null,e.createElement(Dl,{placement:"top",content:n.name},e.createElement("div",{className:NE.iconCell,onClick:function(){return i(n)},onPointerDown:function(e){s&&(h({x:e.pageX,y:e.pageY}),v({x:e.pageX,y:e.pageY}),u(!0))},onTouchStart:function(e){s&&1===e.touches.length&&(h({x:e.touches[0].pageX,y:e.touches[0].pageY}),v({x:e.touches[0].pageX,y:e.touches[0].pageY}),u(!0))}},e.createElement(FE,{graphicInfo:n,currentColor:o}))),y&&e.createElement("div",{className:NE.draggingIcon,style:{left:"".concat(m.x,"px"),top:"".concat(m.y,"px")}},e.createElement(FE,{graphicInfo:n,currentColor:o})))}function FE(t){var n=t.graphicInfo,i=t.currentColor,r=e.useMemo((function(){var e=nx(n,i);return{fillColor:e.fillColor||"white",strokeColor:e.strokeColor}}),[i,n]),o=r.fillColor,a=r.strokeColor,s=e.useMemo((function(){return n.svg.replace(/{fill}/g,o).replace(/{stroke}/g,a)}),[n,o,a]);return e.createElement("div",{dangerouslySetInnerHTML:{__html:s},style:{width:"26px",height:"26px"}})}function zE(e,t,n,i){var r=null==i?void 0:i.currentColor,o=nx(t,r),a=o.fillColor,s=o.strokeColor,l=o.textColor,c=(null==i?void 0:i.position)||Lt(n.view.getViewbox()),u=n.getGraphicStyleByCategory(t.categoryId),d=exports.E(exports.E({},ix.getDefaultShapeStyle()),u),p={x:c.x-d.size.width/2,y:c.y-d.size.height/2},h=n.createOperation(),f=exports.E(exports.E({},ix.findInitShapeData(n,e,p,d.size)),d),m=null==i?void 0:i.isDefaultColor;r&&(m&&u||(f.borderColor=xr(s),a?(f.bgColor=xr(a),f.hasBg=!0):""===a&&(f.bgColor=0,f.hasBg=!1)));var v=IE({upime:n,element:exports.E(exports.E({},f),{scale:f.scale||1,elementType:Za.SHAPE,globalTransform:sr,id:"fake-element"})}),g=v.size,y=v.fontSize,b=v.lineHeight,E=exports.E({},g),x={x:f.position.x-(E.width-f.size.width)/2,y:f.position.y-(E.height-f.size.height)/2};f.size=E,f.fontSize=y,f.lineHeight=b,f.position=x;var w=h.create(Za.SHAPE,f);n.updateShapeParent(h,w),h.sync();var C=0;if(C=r&&!m?xr(l):n.getGraphicLastColorByCategory(t.categoryId)||n.lastShapeColor||(r?xr(l):void 0),!(null==i?void 0:i.silent)){var S=n.createLock([w.id]),k=n.selectElement(w);k.startEdit({lock:S}),void 0!==C&&k.richContentEditor.updateStyle({color:C})}return{shape:w,textColor:C}}function HE(e,t,n){var i=e===_E.hor,r=(null==n?void 0:n.position)||Lt(t.view.getViewbox()),o=i?2:3,a=i?3:2,s=Array(o*a).fill(null).map((function(e,t){var n=t/a|0,r=t%a,o="left";return i&&0===r&&(o="center"),i||0!==n||(o="center"),exports.E(exports.E({},AE({ha:o})),{rId:n.toString(),cId:r.toString()})})),l=Array(o).fill(void 0).map((function(e,t){return i?200:0===t?48:336})),c=Array(a).fill(void 0).map((function(e,t){return i?0===t?48:336:200})),u={height:l.reduce((function(e,t){return e+t}),0),width:c.reduce((function(e,t){return e+t}),0)},d=O(i?"graphic.swinLane.hor.name":"graphic.swinLane.ver.name"),p=t.newMaxZindex(),h={x:r.x-u.width/2,y:r.y-u.height/2},f=t.createOperation(),m={position:h,zIndex:p,name:d,rows:o,cols:a,cells:s,size:u,rotate:0,scale:1,rowHeights:l,rowWidths:c,meshColor:9540508,color:1710618,hasBg:!0,bgColor:je[0],bgOpacity:1,va:"middle",ha:"center",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,focusedCellsIdx:null},v=f.create(Za.TABLE,m);function g(e,n){var i=O("graphic.swinLane.default.title"),r={hasBg:!1,bgColor:0,bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,position:{x:0,y:0,parentType:Za.TABLE,parentId:v.id,rowId:e,columnId:n},size:{width:0,height:0},autoWidth:!1,zIndex:t.newMaxZindex(),richContent:{version:t.genOtVersion(0),content:[[yi(i),{color:790564}]]}};f.create(Za.GRID_TEXT,r)}return i?(g("0","0"),g("1","0")):(g("0","0"),g("0","1")),f.sync(),t.selectElement(v),v}function UE(e,t,n){var i,r=null==n?void 0:n.currentColor,o=nx(e,r),a=o.fillColor,s=o.strokeColor,l=o.textColor,c=(null==n?void 0:n.position)||Lt(t.view.getViewbox()),u=t.getGraphicStyleByCategory(e.categoryId),d=exports.E(exports.E({},tx()),u),p={ha:d.ha,va:d.va,fontSize:d.fontSize,lineHeight:d.lineHeight,lineHeightRate:d.lineHeightRate,fontFamily:d.fontFamily},h=e.width||e.height||100,f=e.height||100,m={height:d.size.height,width:h/f*d.size.height},v={x:c.x-m.width/2,y:c.y-m.height/2},g=t.createOperation(),y=exports.E(exports.E({},d),{size:m,position:v,zIndex:t.newMaxZindex(),values:{},categoryId:e.categoryId,graphicId:e.id}),b=null==n?void 0:n.isDefaultColor;r&&(b&&u||(y.borderColor=xr(s),a?(y.bgColor=xr(a),y.hasBg=!0):""===a&&(y.bgColor=0,y.hasBg=!1)));var E=IE({upime:t,element:exports.E(exports.E({},_t.cloneDeep(y)),{scale:y.scale||1,fontSize:p.fontSize,lineHeight:p.lineHeight,lineHeightRate:p.lineHeightRate,elementType:Za.GRAPHIC,globalTransform:sr,id:"fake-element"})}),x=E.size,w=E.fontSize,C=E.lineHeight;if(E.changed){var S=exports.E({},x);S.width=y.size.width/y.size.height*S.height,p.fontSize=w,p.lineHeight=C;var k={x:y.position.x-(S.width-y.size.width)/2,y:y.position.y-(S.height-y.size.height)/2};y.size=exports.E({},S),y.position=exports.E({},k)}var _=t.getGraphicLastColorByCategory(e.categoryId),T=b&&_?_:xr(l),I=[];null===(i=e.texts)||void 0===i||i.map((function(e,n){var i=e.value.text,r=[yi(i),{color:T}];I.push(["text".concat(n+1,"_text"),"weakOt",{version:t.genOtVersion(0),content:[r]}]),I.push(["text".concat(n+1,"_style"),"value",p])})),y.cps=I;var P=g.create(Za.GRAPHIC,_t.cloneDeep(y));t.updateElementParent(g,P),g.sync();var N=t.selectElement(P);return(null==n?void 0:n.silent)||(P.onGetSchema=function(){var e,n,i=t.createOperation();_e.desktop&&(P.textNodes.forEach((function(e){e.updateStyle(i,p)})),i.sync(),t.deleteOperation(i),P.currentEditor===N&&(N.connectedEditor||N.connectTextEditor(),_t.isNil(T)||null===(e=N.connectedEditor)||void 0===e||e.updateStyle({color:T}),N.startEdit(),null===(n=N.connectedEditor)||void 0===n||n.pickAll(),P.onGetSchema=void 0))}),{graphicElement:P,textColor:T,fontStyle:p}}var WE=function(){var t=e.useContext(xl).upime,n=W().getUpimeTrans,i=e.useState(""),r=i[0],o=i[1],a=e.useState([]),s=a[0],l=a[1],c=e.useState((function(){var e;return(null===(e=t.graphicConfig.config)||void 0===e?void 0:e.openState)||{}})),u=c[0],d=c[1];function p(){d({})}e.useEffect((function(){var e;_t.isEqual(u,null===(e=t.graphicConfig.config)||void 0===e?void 0:e.openState)||(function(){var e;if(t.graphicConfig.saveGraphicConfig){var n=exports.E({},u);t.graphicConfig.saveGraphicConfig({openState:n,colorPalettes:(null===(e=t.graphicConfig.config)||void 0===e?void 0:e.colorPalettes)||{}})}}(),t.graphicConfig.config=exports.E(exports.E({},t.graphicConfig.config),{openState:exports.E({},u)}))}),[u]),e.useEffect((function(){r&&0!==Object.keys(u).length&&p()}),[r]),e.useEffect((function(){t.getGraphicLib().then((function(e){l(e)}))}),[]);var h=e.useMemo((function(){return r?s.map((function(e){return exports.E(exports.E({},e),{list:e.list.filter((function(e){return e.keywords.some((function(e){return e.includes(r)}))}))})})).filter((function(e){return e.list.length>0})):s}),[r,s]);return e.createElement("div",{className:j(NE.graphicSideContainer)},e.createElement(VE,{openAll:p,closeAll:function(){d(s.reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t.categoryId]=!0,n))}),{}))}}),e.createElement(jE,{searchQuery:r,setSearchQuery:o}),e.createElement("div",{className:NE.categroyWrapper},h.map((function(t){return e.createElement(GE,{category:t,key:t.categoryId,isOpen:!u[t.categoryId],setIsOpen:function(){return e=t.categoryId,void d((function(t){var n;return exports.E(exports.E({},t),((n={})[e]=!t[e],n))}));var e}})})),r&&0===h.length&&e.createElement("div",{className:NE.emptyContainer},e.createElement("img",{src:$o("no_content.png"),className:NE.emptyImg}),e.createElement("div",null,n("common.search.none")))))};function VE(t){var n=t.openAll,i=t.closeAll,r=e.useState(!0),o=r[0],a=r[1],s=W().getUpimeTrans;return e.createElement("div",{className:NE.title},e.createElement("div",null,s("graphic.sidebar.title")),e.createElement(Dl,{placement:"bottom",content:s(o?"graphic.sidebar.title.close":"graphic.sidebar.title.open")},e.createElement("div",{className:NE.titleIconContainer,onClick:function(){a((function(e){return!e})),o?i():n()}},e.createElement(hl,{icon:"icon-zhankai",size:24,className:j(o&&NE.rotate)}))))}function jE(t){var n=t.searchQuery,i=t.setSearchQuery,r=W().getUpimeTrans,o=e.useRef(null);return e.createElement("div",{className:NE.searchContentContainer},e.createElement("div",{className:NE.inputDomContainer},e.createElement("input",{value:n,onChange:function(e){i(e.target.value)},placeholder:r("graphic.sidebar.search.placeholder"),ref:o,type:"text",className:j(NE.input,NE.oneLine),enterKeyHint:"send"}),e.createElement(hl,{size:20,icon:"sousuo",className:NE.searchIcon}),n&&e.createElement("div",{className:j(NE.qingchuHotarea),onClick:function(){var e;i(""),null===(e=o.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"qingchu",className:j(NE.qingchuIcon),size:16}))))}var GE=function(t){var n=t.category,i=t.isOpen,r=void 0===i||i,o=t.setIsOpen,a=t.tiny,s=void 0!==a&&a,l=t.draggle,c=void 0===l||l,u=t.onPick,d=e.useContext(xl).upime,p=e.useReducer((function(e){return e+1}),0);p[0];var h=p[1],f=d.getGraphicColorByCategory(n.categoryId);return e.createElement("div",{className:j(NE.categroyContainer,s&&NE.tinyCate)},e.createElement("div",{className:j(NE.categroyTitle,o&&NE.hasHover),onClick:o},e.createElement("b",null,n.categoryName),o&&e.createElement("div",{className:j(NE.iconContainer,!r&&NE.iconRotate)},e.createElement(hl,{icon:"jiantou-xia",size:20}))),r&&n.colorPalettes&&e.createElement(qE,{currentColor:f,colorPalettes:n.colorPalettes,setCurrentColor:function(e){d.setGraphicColorByCategory(n.categoryId,e),e&&!function(e){return!e||!n.colorPalettes||$E(n.colorPalettes[n.colorPalettes.length-1],e)}(e)||(d.setGraphicStyleByCategory(n.categoryId,void 0),d.setGraphicLastColorByCategory(n.categoryId,1710618)),h()},tiny:s}),r&&e.createElement(LE,{onPick:u,category:n,currentColor:f,colorPalettes:n.colorPalettes,tiny:s,draggle:c}))},qE=function(t){var n=t.colorPalettes,i=t.currentColor,r=t.setCurrentColor,o=t.tiny,a=void 0!==o&&o,s=yh(!0),l=s.hide,c=s.toggleHide,u=s.setHide,d=s.skipRef,p=!i||n.length&&$E(n[n.length-1],i);return e.createElement("div",{className:NE.colorpalettesWrapper,ref:d},e.createElement("div",{className:j(NE.colorpalettesContaienr,a&&NE.tinyColorPa),onClick:c},p?e.createElement(XE,null):e.createElement(YE,{gcp:i}),e.createElement(hl,{icon:"jiantou-xia",size:20})),!l&&e.createElement("div",{className:NE.colorpalettesOptionContainer},e.createElement(KE,{colorPalettes:n,currentColor:i,setCurrentColor:function(e){r(e),u(!0)}})))},KE=function(t){var n=t.colorPalettes,i=t.currentColor,r=t.setCurrentColor;return e.createElement("div",{className:NE.childrenOptionContainer},n.map((function(t,o){return o===n.length-1?e.createElement("div",{className:NE.options,onClick:function(){return r(t)},key:o},e.createElement(XE,null),(!i||0===n.length||$E(n[n.length-1],i))&&e.createElement(hl,{icon:"gouxuan",size:20})):e.createElement(YE,{key:o,gcp:t,currentColor:i,onPick:function(){return r(t)}})})))};function YE(t){var n=t.gcp,i=t.currentColor,r=t.onPick,o=e.useMemo((function(){var e=[];return n.forEach((function(t){_t.isNil(t.backgroundColor)||e.some((function(e){return JE(e,t)}))||e.push(t)})),e}),[n]),a=e.useMemo((function(){return!!i&&$E(n,i)}),[i,n]);return e.createElement("div",{className:NE.options,onClick:r},e.createElement("div",{className:NE.simpleColorTheme},o.map((function(t,n){var i=QE(t.backgroundColor),r=QE(t.borderColor);return e.createElement("div",{key:n,className:NE.simpleColorCircle,style:{borderColor:r,backgroundColor:i}})}))),a&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",size:16}))}function XE(){var t=W().getUpimeTrans;return e.createElement("div",{className:NE.defaultColorTheme},e.createElement(hl,{icon:"tiaosepan",size:16}),e.createElement("div",null,t("graphic.sidebar.colorpalettes.default")))}function QE(e){if(_t.isNil(e))throw new Error("color is null");return""===e?"white":e}function ZE(e,t){var n=_t.isNil(e),i=_t.isNil(t);return!(!n||!i)||e===t||i&&n}function JE(e,t){return ZE(e.backgroundColor,t.backgroundColor)&&ZE(e.borderColor,t.borderColor)&&ZE(e.textColor,t.textColor)}function $E(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!JE(e[n],t[n]))return!1;return!0}var ex=function(e){function t(t){var n=e.call(this,t)||this;return n.currentColorMap=new Map,n.lastColorMap=new Map,n.graphicCategorystyleMap=new Map,n}return P(t,e),t.prototype.destroy=function(){},t.prototype.updateConfig=function(){var e,t,n=this,i=null===(t=null===(e=this.upime.graphicConfig)||void 0===e?void 0:e.config)||void 0===t?void 0:t.colorPalettes;i&&Object.keys(i).forEach((function(e){n.currentColorMap.set(e,i[e])}))},t.prototype.getGraphicLibSync=function(){return this.graphicCategoryList||[]},t.prototype.getGraphicLib=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return this.graphicCategoryList?[2,Promise.resolve(this.graphicCategoryList)]:(this.fetchingWork||(this.fetchingWork=new Ks,this.fetchGraphicLib().then((function(t){var n;e.graphicCategoryList=t.map((function(e){return exports.E(exports.E({},e),{list:e.list.map((function(e){return exports.E(exports.E({},e),{is:PE[e.id]})}))})})).map((function(e){return"flowchart"===e.categoryId?exports.E(exports.E({},e),{list:R(R([],e.list,!0),[{id:"SwimHorGraphicInfo",categoryId:"flowchart",name:O("graphic.swinLane.hor.name"),keywords:["Horizontal Swimlane","水平泳道"],svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 26 26"><path fill="#fff" d="M1 5a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V5Z"/><path fill="#000" d="M3.5 11.5v-6H6v6H3.5Zm0 2.5v6.5H6V14H3.5Zm5 6.5h14V14h-14v6.5Zm14-9v-6h-14v6h14ZM1 5a2 2 0 0 1 2-2h20a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V5Z" clip-rule="evenodd" fill-rule="evenodd"/></svg>',width:0,height:0,sort:1e3,is:_E.hor,texts:[]},{id:"SwimVerGraphicInfo",categoryId:"flowchart",name:O("graphic.swinLane.ver.name"),keywords:["Vertical Swimlane","垂直泳道"],svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 26 26"><path fill="#fff" d="M21 1a2 2 0 0 1 2 2v20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h16Z"/><path fill="#000" d="M14.25 3.5h6.25v3h-6.25v-3Zm-2.5 0H5.5v3h6.25v-3ZM5.5 9v13.5h6.25V9H5.5Zm8.75 13.5h6.25V9h-6.25v13.5ZM21 1a2 2 0 0 1 2 2v20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h16Z" clip-rule="evenodd" fill-rule="evenodd"/></svg>',width:0,height:0,sort:1001,is:_E.ver,texts:[]}],!1)}):e})).map((function(e){return exports.E(exports.E({},e),{list:e.list.map((function(t){return exports.E(exports.E({},t),{categoryId:e.categoryId})}))})})),null===(n=e.fetchingWork)||void 0===n||n.done(e.graphicCategoryList)})).finally((function(){e.fetchingWork=void 0}))),[2,this.fetchingWork.result])}))}))},t.prototype.fetchGraphicLib=function(){var e;return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.upime.fileHelper.getFileToken()];case 1:return t=o.sent(),n=t.host,i=t.query,[4,Cd({lang:this.upime.getLang()},{host:n,query:i}).result];case 2:return r=o.sent(),[2,(null===(e=r.obj)||void 0===e?void 0:e.data)||[]]}}))}))},t.prototype.getGraphicColorByCategory=function(e){return this.currentColorMap.get(e)},t.prototype.setGraphicColorByCategory=function(e,t){t?this.currentColorMap.set(e,t):this.currentColorMap.delete(e),this.saveUserConfig()},t.prototype.getGraphicStyleByCategory=function(e){return this.graphicCategorystyleMap.get(e)},t.prototype.setGraphicStyleByCategory=function(e,t){if(t){var n=this.graphicCategorystyleMap.get(e),i=exports.E(exports.E({},n),t);this.graphicCategorystyleMap.set(e,i)}else this.graphicCategorystyleMap.delete(e)},t.prototype.getGraphicLastColorByCategory=function(e){return this.lastColorMap.get(e)},t.prototype.setGraphicLastColorByCategory=function(e,t){this.lastColorMap.set(e,t)},t.prototype.saveUserConfig=function(){var e;if(this.upime.graphicConfig.saveGraphicConfig){var t={};this.currentColorMap.forEach((function(e,n){t[n]=e})),this.upime.graphicConfig.saveGraphicConfig({colorPalettes:t,openState:(null===(e=this.upime.graphicConfig.config)||void 0===e?void 0:e.openState)||{}})}},t.prototype.genPickWidgetUpdateFromElement=function(e,t,n){var i,r=this.getGraphicStyleByCategory(t),o=exports.E(exports.E({},tx()),r);if(Au(e))o=exports.E(exports.E({},o),{size:exports.E({},e.size),ha:e.ha,va:e.va,fontSize:e.fontSize,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate,fontFamily:e.fontFamily});else if(Nu(e))o=exports.E(exports.E({},o),{ha:e.ha,va:e.va,fontSize:e.fontSize,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate,fontFamily:e.fontFamily});else if(Iu(e)){o=exports.E(exports.E({},o),{size:exports.E({},e.size)});var a=e.textNodes[0];a&&(o=exports.E(exports.E({},o),{ha:a.ha,va:a.va,fontSize:a.fontSize,lineHeight:a.lineHeight,lineHeightRate:a.lineHeightRate,fontFamily:a.fontFamily}))}var s=null===(i=this.graphicCategoryList)||void 0===i?void 0:i.find((function(e){return e.categoryId===t})),l=null==s?void 0:s.list.find((function(e){return e.id===n}));if(l){var c=l.width/l.height*o.size.height;o.size.width=c}var u=null==s?void 0:s.colorPalettes,d=this.getGraphicColorByCategory(t),p=!d||!u||$E(u[u.length-1],d),h=void 0;if(l&&d){var f=nx(l,d),m=f.fillColor,v=f.strokeColor,g=f.textColor,y=this.getGraphicLastColorByCategory(t);h=p&&y?y:xr(g),p&&r||(o.borderColor=xr(v),m?(o.hasBg=!0,o.bgColor=xr(m)):""===m&&(o.hasBg=!1,o.bgColor=0))}return{update:exports.E(exports.E({},o),{values:{},categoryId:t,graphicId:n}),textColor:h}},t}(zd);function tx(){return{size:{width:0,height:100},hasBorder:!0,borderStyle:1,borderColor:1710618,borderThickness:2,borderOpacity:1,hasBg:!1,bgColor:0,bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He}}function nx(e,t){var n=null==t?void 0:t.find((function(t){return e.paletteLabel===t.name}));return n?{fillColor:null==n?void 0:n.backgroundColor,strokeColor:(null==n?void 0:n.borderColor)||pr(1710618),textColor:(null==n?void 0:n.textColor)||pr(1710618)}:{fillColor:null,strokeColor:pr(1710618),textColor:pr(1710618)}}var ix=function(e){function t(n){var i=e.call(this,n)||this;return i._shapeStyle=t.getDefaultShapeStyle(),i._lastDrawnShape=Ka.RECT,i.unsub_xmode=i.upime.subscribe("xmodechange",(function(e){"shape"===e?i.listenEvent(!0):i.listenEvent(!1)})),i.getInitShapeData=function(e,n){return t.findInitShapeData(i.upime,i.upime.shapeType,e,n)},i.onFinishShapeCreation=function(e,t,n,r,o,a){if(void 0===r&&(r=!0),t&&n){if(a){var s=IE({upime:i.upime,element:n}),l=s.size,c=s.fontSize,u=s.lineHeight;s.changed;var d=exports.E(exports.E({},i._shapeStyle),{position:{x:n.position.x+.5*(e.width-l.width),y:n.position.y+.5*(e.height-l.height)}});d.size=l,d.fontSize=c,d.lineHeight=u,t.update(n,d),i.findAndSetParent(t,n)}else t.update(n,exports.E(exports.E({},i._shapeStyle),{size:e})),i.findAndSetParent(t,n),t.update(n,{fontSize:i._shapeStyle.fontSize,lineHeight:i._shapeStyle.lineHeight});if(t.sync(),r){var p=i.upime.createLock([n.id]),h=i.upime.selectElement(n);h.startEdit({lock:p,optimizeView:o}),void 0!==i.upime.lastShapeColor&&h.richContentEditor.updateStyle({color:i.upime.lastShapeColor})}i.shapeStyle({size:e},i.upime.shapeType)}},i.insertShapeAt=function(e,t,n){void 0===t&&(t=!0);var r=e.x,o=e.y,a=i.upime.createOperation(),s=i.upime.shapeType===i._lastDrawnShape?i._shapeStyle.size:{width:i._shapeStyle.size.height,height:i._shapeStyle.size.height},l={x:r-s.width/2,y:o-s.height/2},c=a.create(Za.SHAPE,i.getInitShapeData(l,s));return i.onFinishShapeCreation(s,a,c,t,n,!0),i.upime.switchMode("select"),c},"shape"===n.xmode&&i.listenEvent(!0),i}return P(t,e),t.prototype.shapeStyle=function(e,t){Object.assign(this._shapeStyle,e),t&&(this._lastDrawnShape=t)},t.getDefaultShapeStyle=function(){return{size:Je,hasBorder:!0,borderStyle:1,borderColor:1710618,borderThickness:2,borderOpacity:1,hasBg:!1,bgColor:0,bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He}},t.findInitShapeData=function(e,t,n,i){return{hasBorder:!0,borderStyle:1,borderColor:1928185,borderThickness:2,borderOpacity:1,hasBg:!1,bgColor:0,bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,position:n,shape:t,size:i,zIndex:e.newMaxZindex(),stable:!!window._test_stable_||void 0,richContent:{version:e.genOtVersion(0),content:[]}}},t.prototype.listenEvent=function(e){var t=this;if(this.unsubs&&this.unsubs(),e){var n,i,r=[this.upime.userEventManager.subscribe("moveto",(function(e){var r=e.isStart,o=e.isEnd,a=e.position,s=e.startPosition;if("left"===e.connectType||"touch"===e.connectType){var l=jt(a.x,s.x),c=l[0],u=l[1],d=jt(a.y,s.y),p=d[0],h=u-c,f=d[1]-p,m={x:c,y:p};e.originEvent.shiftKey&&(a.y<s.y&&(m.y+=f-h),f=h);var v={width:h,height:f};if(i){var g=n;i.update(g,{size:v,position:m}),o&&(g.size.width<=4&&g.size.height<=4?(t.upime.elementManager.removeElement(g),i.cancelCreate()):t.onFinishShapeCreation(v,i,g),t.upime.switchMode("select"),i=void 0,n=void 0)}else{if(!r)return;i=t.upime.createOperation(),n=i.create(Za.SHAPE,t.getInitShapeData(m,v))}}})),this.upime.userEventManager.subscribe("click",(function(e){return t.insertShapeAt(e.position)}))];this.unsubs=function(){return r.forEach((function(e){return e()}))}}},t.prototype.genPickWidgetUpdateFromElement=function(e,t){var n,i=this._shapeStyle;if(e.elementType===Za.SHAPE)i={size:(r=e).size,hasBorder:r.hasBorder,borderStyle:r.borderStyle,borderColor:r.borderColor,borderThickness:r.borderThickness,borderOpacity:r.borderOpacity,hasBg:r.hasBg,bgColor:r.bgColor,bgOpacity:r.bgOpacity,ha:r.ha,va:r.va,fontSize:r.fontSize,lineHeight:r.lineHeight,lineHeightRate:r.lineHeightRate,fontFamily:r.fontFamily},this.shapeStyle(i);else if(e.elementType===Za.TEXT){var r=e;i.hasBg=r.hasBg,i.bgColor=r.bgColor,i.bgOpacity=r.bgOpacity,i.ha=r.ha,i.va=r.va,i.fontSize=r.fontSize*r.scale,i.lineHeightRate=r.lineHeightRate,i.lineHeight=ib(i.fontSize,i.lineHeightRate),i.fontFamily=r.fontFamily,this.shapeStyle(i)}else if(e.elementType===Za.GRAPHIC){r=e,i=exports.E(exports.E({},i),{size:r.size,hasBorder:r.hasBorder,borderStyle:r.borderStyle,borderColor:r.borderColor,borderThickness:r.borderThickness,borderOpacity:r.borderOpacity,hasBg:r.hasBg,bgColor:r.bgColor,bgOpacity:r.bgOpacity});var o=r.textNodes[0];o&&(i.ha=o.ha,i.va=o.va,i.fontSize=o.fontSize,i.lineHeight=o.lineHeight,i.lineHeightRate=o.lineHeightRate,i.fontFamily=o.fontFamily),this.shapeStyle(i)}var a=this.upime.getGraphicLibSync(),s=null==a?void 0:a.find((function(e){return e.list.some((function(e){return e.is===t}))})),l=null==s?void 0:s.list.find((function(e){return e.is===t})),c=void 0;if(l){var u=this.upime.getGraphicStyleByCategory(l.categoryId);u&&(i=exports.E(exports.E(exports.E({},i),u),{size:i.size}));var d=this.upime.getGraphicColorByCategory(l.categoryId),p=null==s?void 0:s.colorPalettes,h=!d||!p||$E(p[p.length-1],d);if(d){var f=nx(l,d),m=f.fillColor,v=f.strokeColor,g=f.textColor,y=this.upime.getGraphicLastColorByCategory(l.categoryId);c=h&&null!==(n=null!=y?y:this.upime.lastShapeColor)&&void 0!==n?n:xr(g),h&&u||(i.borderColor=xr(v),m?(i.hasBg=!0,i.bgColor=xr(m)):""===m&&(i.hasBg=!1,i.bgColor=0))}}return{update:exports.E(exports.E({shape:t},i),{richContent:{version:this.upime.genOtVersion(0),content:[]}}),textColor:c}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsubs;null==e||e()},t}(zd),rx={near:ax,average:ox,test:function(e,t,n){return 2989040===t.borderColor?ox(e,t,n):ax(e,t,n)}};function ox(e,t,n){var i=t.getGlobalBox(),r=Rt(i),o=n.view.getScreenPosition({x:i.left,y:i.top}),a=n.view.scale;function s(e){return e*a+o.x}function l(e){return e*a+o.y}function c(e){var t=e.x,n=e.y;return{x:s(t),y:l(n)}}var u=lx(sx(t)).map((function(e){return cx(e,t.rotate,{x:r.width/2,y:r.height/2})})).map((function(e){return{start:c(e.start),end:c(e.end)}})),d=e.path[0],p=1/0,h=0;u.forEach((function(e,t){var n=mn(e.start,d);n<p&&(p=n,h=t)})),u=R(R([],u.slice(h),!0),u.slice(0,h),!0);var f=Math.ceil(e.path.length/u.length),m=u.map((function(e){return function(e,t,n){for(var i=[],r=0;r<n;r++){var o=r/n,a=Rn(e.x,t.x,o),s=Rn(e.y,t.y,o);i.push({x:a,y:s})}return i}(e.start,e.end,f)})).flat().slice(0,e.path.length),v=m[Math.round(m.length/4)],g=e.path[Math.round(m.length/4)];return Math.sqrt(Math.pow(v.x-g.x,2)+Math.pow(v.y-g.y,2))>(i.right-i.left)/2*a&&m.reverse(),ux(m,t,n)}function ax(e,t,n){var i=t.getGlobalBox(),r=Rt(i),o=n.view.getScreenPosition({x:i.left,y:i.top}),a=n.view.scale;function s(e){return e*a+o.x}function l(e){return e*a+o.y}function c(e){var t=e.x,n=e.y;return{x:s(t),y:l(n)}}var u=lx(sx(t)).map((function(e){return cx(e,t.rotate,{x:r.width/2,y:r.height/2})})).map((function(e){return{start:c(e.start),end:c(e.end)}})),d=e.path.map((function(e){var t=1/0,n={x:0,y:0};return u.forEach((function(i){var r=Bn(i.start,i.end,e),o=mn(r,e);o<t&&(t=o,n=r)})),n}));return ux(d,t,n)}function sx(e){var t=Rt(e.getGlobalBox());return e.shape===Ka.RECT?[["M",0,0],["L",t.width,0],["L",t.width,t.height],["L",0,t.height],["Z"]]:e.shapeClient.getIPathData(t,1)}function lx(e){var t=0,n=0,i=[];return e.forEach((function(r){switch(r[0]){case"M":t=r[1],n=r[2];break;case"L":i.push({start:{x:t,y:n},end:{x:r[1],y:r[2]}}),t=r[1],n=r[2];break;case"Z":var o=e.find((function(e){return"M"===e[0]}));if(o)return i.push({start:{x:t,y:n},end:{x:o[1],y:o[2]}}),i}})),i}function cx(e,t,n){return{start:an(e.start,t,n),end:an(e.end,t,n)}}function ux(e,t,n){var i=Lt(t.getGlobalBox()),r=n.view.getScreenPosition(i),o=n.view.scale*t.borderThickness/2;return e.map((function(e){var t=e.x<r.x,n=e.y<r.y;return t&&n?{x:e.x+o,y:e.y+o}:t&&!n?{x:e.x+o,y:e.y-o}:!t&&n?{x:e.x-o,y:e.y+o}:t||n?e:{x:e.x-o,y:e.y-o}}))}var dx=[{type:Za.TEXT,name:"文本",icon:"wenben"},{type:Za.STICKER,stickerType:eb.SQUARE,name:"便签",icon:"bianqian"},{type:Za.STICKER,stickerType:eb.RECT,name:"长便签",icon:"changbianqian"}],px=function(){function e(e,t,n,i){var r=this;this.globalPosition=t,this.originElement=n,this.handleWidgetTypePick=i,this.renderer=hx,this.graphLib=[],this.currentGraphicInfo=void 0,this.isBase=!1,this.category=void 0,this.renderKey="widget-type-picker-".concat(e),this.originElement.upime.getGraphicLib().then((function(e){var t;r.graphLib=e,r.updateGraphicInfo(),r.updateIsBase(),r.updateCategory(),null===(t=r.reFreshUI)||void 0===t||t.call(r)}))}return e.prototype.updateGraphicInfo=function(){var e,t,n=this.originElement;if(Iu(n))this.currentGraphicInfo=null===(t=null===(e=this.graphLib.find((function(e){return e.categoryId===n.categoryId})))||void 0===e?void 0:e.list)||void 0===t?void 0:t.find((function(e){return e.id===n.graphicId}));else if(Au(n))for(var i=0;i<this.graphLib.length;i++){var r=this.graphLib[i].list.find((function(e){return e.is===n.shape}));if(r)return void(this.currentGraphicInfo=r)}},e.prototype.updateIsBase=function(){var e,t=this.originElement;Au(t)||Iu(t)?this.isBase="base"===(null===(e=this.currentGraphicInfo)||void 0===e?void 0:e.categoryId):this.isBase=!0},e.prototype.updateCategory=function(){var e,t=this.isBase?"base":null===(e=this.currentGraphicInfo)||void 0===e?void 0:e.categoryId,n=this.graphLib.find((function(e){return e.categoryId===t}));n&&(this.category=exports.E(exports.E({},n),{list:n.list.filter((function(e){return e.is!==_E.hor&&e.is!==_E.ver}))}))},e}(),hx=function(t){var n=t.element,i=t.upime,r=e.useReducer((function(e){return e+1}),0);r[0];var o=r[1];e.useEffect((function(){return n.reFreshUI=function(){return o()},function(){n.reFreshUI=void 0}}),[]);var a=e.useRef(null);e.useEffect((function(){var e=i.view.subscribe("viewboxChange",(function(){return l()})),t=gh((function(){l()}),{skipElements:a.current?[a.current]:void 0});return function(){e(),t()}}),[]);var s=n.globalPosition,l=n.handleWidgetTypePick,c=n.isBase,u=n.category;return e.createElement("div",{ref:a,className:"widgetTypePicker_5H8Qx",style:{left:"".concat(s.x,"px"),top:"".concat(s.y,"px")}},e.createElement("div",{className:"widgetTypeInner_3Uulu"},c&&e.createElement(e.Fragment,null,e.createElement("div",{className:"baseTypeBox_2NVBF"},dx.map((function(t,n){return e.createElement(Dl,{placement:"top",content:t.name,key:n},e.createElement("div",{className:"baseTypeItem_2ZO0E",onClick:function(){return function(e){l(e.type,{stickerType:e.stickerType})}(t)}},e.createElement(hl,{icon:t.icon})))}))),e.createElement("div",{className:"baseTypeDivider_L_aZN"})),e.createElement("div",{className:"listContainer_3ZQHL"},u&&e.createElement(GE,{category:u,tiny:!0,draggle:!1,onPick:function(e){l(e.is?Za.SHAPE:Za.GRAPHIC,{graphicInfo:e})}}))))};function fx(e,t,n){var i=t.view.elementsRoot,r=[];if(function t(i){for(var o=i.globalTransform,a=i.children,s=o.applyInverse(e),l=a.length-1;l>=0;l--){var c=a[l];if(c.isRefSystem){if(t(c))continue;return!1}if(c instanceof oy){if(n===c)continue;var u=c.checkSelectRelation(s,{type:"attach"});if(u){if(r.push(exports.E(exports.E({},u),{element:c})),u.transparent)continue;return!1}}}return!0}(i),r.length>0){for(var o=r[0],a=0;a<r.length;a++)r[a].metric<o.metric&&(o=r[a]);return o}return null}var mx,vx,gx=function(e){function t(t){var n=e.call(this,t)||this;return n._lineConfig={startArrow:0,endArrow:1,lineWidth:1,lineType:1,lineStyle:1,lineColor:0,textDirection:1},n.shiftKeyDown=!1,n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"connection-line"===e?n.listenMoveto(!0):(n.listenMoveto(!1),n.clearAdsorptionData())})),n.currentConnectionLine=null,n.startAttachedProps=null,n.endAttachedProps=null,n.connectingElement=void 0,n.createOp=void 0,n.startPosition={x:0,y:0},n.prepareDraw=function(e){if(!e.connected){var t=fx(e.position,n.upime);n.setConnectingElement(t)}},n.drawConnectionLine=function(e,t,i){var r,o,a=e.isStart,s=e.isEnd,l=e.position,c=e.startPosition;if("left"===e.connectType||"touch"===e.connectType){var u=n,d=u.createOp,p=u.startAttachedProps,h=u.endAttachedProps,f=n.upime;if(d){var m=n.currentConnectionLine,v=(A={},l),g=null===(o=null==(N=fx(v,f,m.startElement))?void 0:N.metaData)||void 0===o?void 0:o.attachedProps;if(n.setConnectingElement(N),g)D=(h=g).attachedElementId,R=h.attachedPointType,B=h.percentOffset,A.endElementId=D,A.endPosition=B,A.endType=R,n.alignGuides&&(f.view.removeAssistWidget(n.alignGuides),n.alignGuides=void 0);else{if(e.isEnd||(n.shiftKeyDown=e.originEvent.shiftKey),n.shiftKeyDown){var y=n.startPosition,b=_n(l,n.startPosition,y),E=b.finalRotatePosition,x=b.rotateAngle;v=E,void 0===n.alignGuides?(n.alignGuides=new th(y.x,y.y,x),f.view.addAssistWidget(n.alignGuides)):n.alignGuides.data={x:y.x,y:y.y,angle:x}}else n.alignGuides&&(f.view.removeAssistWidget(n.alignGuides),n.alignGuides=void 0);A.endElementId=null;var w=m.globalTransform.applyInverse(v);1!==m.lineType&&2!==m.lineType||(w=n.adjustPointToAxis(w,n.startPosition)),A.endPosition=w,A.endType=0,h=null}if(d.update(m,A),e.isEnd&&n.alignGuides&&(n.shiftKeyDown=!1,f.view.removeAssistWidget(n.alignGuides),n.alignGuides=void 0),s){f.switchMode("select");var C=m.startElement,S=m.endElement,k=f.view.elementsRoot;C&&S||m.parentRefSystem===k&&n.findAndSetParent(d,m);var _=f.createLock([m.id]);if(d.sync(),f.clearLock(_),C&&!m.endElement){var T=e.globalPosition,I={x:T.x,y:T.y};T.x+212>f.view.viewWidth&&(I.x=T.x-212),T.y+306>f.view.viewHeight&&(I.y=T.y-306);var P=new px(C.id,I,C,(function(e,t){e&&n.onWdigetInsert(C,e,m,t),f.view.removeDomWidget(P)}));setTimeout((function(){f.view.addDomWidget(P)}),0)}else f.selectElement(m);n.createOp=void 0,n.currentConnectionLine=null,p=null,h=null,n.clearAdsorptionData()}}else{if(!a)return;var N,M=(d=f.createOperation()).create(Za.CONNECTIONLINE,exports.E(exports.E({},n._lineConfig),i&&{lineType:i})),A={startPosition:c,endPosition:c,startElementId:null,zIndex:f.newMaxZindex()};if(t?p=t:(null===(r=null==(N=fx(c,f))?void 0:N.metaData)||void 0===r?void 0:r.attachedProps)&&(p=N.metaData.attachedProps),p){var D=p.attachedElementId,R=p.attachedPointType,B=p.percentOffset,L=n.upime.elementManager.getElementById(D);if(L){var O=L.getConnectLineStyle(B);O&&(Object.assign(A,O),n.upime.updateConnectionLineConfig(O))}A.startElementId=D,A.startPosition=B,A.startType=R}d.update(M,A);var F=M.startElement;if(F){if(F.parentRefSystem&&F.parentRefSystem!==f.view.elementsRoot){var z=exports.E({x:0,y:0},F.parentRefSystem.getRelateInfo());d.update(M,{position:z});var H=M.globalTransform.applyInverse(c);d.update(M,{endPosition:H})}}else{var U=n.findRefSystemByPoint(c);if(U){var W=exports.E({x:0,y:0},U.getRelateInfo());H=U.globalTransform.applyInverse(c),d.update(M,{position:W,startPosition:H,endPosition:H})}}n.currentConnectionLine=M,n.createOp=d,n.startPosition=M.globalTransform.apply(exports.E({},M.startPoint))}n.startAttachedProps=p,n.endAttachedProps=h}},"connection-line"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.getDefaultLineConfig=function(){return{startArrow:0,endArrow:1,lineWidth:1,lineType:1,lineStyle:1,lineColor:0,textDirection:1}},Object.defineProperty(t.prototype,"curLineConfig",{get:function(){return this._lineConfig},enumerable:!1,configurable:!0}),t.prototype.lineConfig=function(e){Object.assign(this._lineConfig,e)},t.prototype.listenMoveto=function(e){if(this.unsub_move&&this.unsub_move(),e){var t=[this.upime.userEventManager.subscribe("mousemove",this.prepareDraw),this.upime.userEventManager.subscribe("moveto",this.drawConnectionLine)];this.unsub_move=function(){return t.forEach((function(e){return e()}))}}},t.prototype.setConnectingElement=function(e){var t;this.connectingElement&&this.connectingElement!==(null==e?void 0:e.element)&&this.connectingElement.clearAdsorptionData(),(null===(t=null==e?void 0:e.metaData)||void 0===t?void 0:t.adsorptionData)&&e.element.updateAdsorptionData(e.metaData.adsorptionData),this.connectingElement=null==e?void 0:e.element},t.prototype.clearAdsorptionData=function(){this.connectingElement&&this.connectingElement.clearAdsorptionData(),this.connectingElement=void 0},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t.prototype.onWdigetInsert=function(e,t,n,i){var r,o,a,s,l=this.upime.createOperation(),c=null===(r=null==i?void 0:i.graphicInfo)||void 0===r?void 0:r.is,u=null===(o=null==i?void 0:i.graphicInfo)||void 0===o?void 0:o.categoryId,d=null===(a=null==i?void 0:i.graphicInfo)||void 0===a?void 0:a.id,p=this.upime.genPickWidgetUpdateFromElement(e,t,{shapeType:c,stickerType:null==i?void 0:i.stickerType,categoryId:u,graphicId:d}),h=p.update,f=p.textColor,m=l.create(t,exports.E({zIndex:this.upime.newMaxZindex()},h)),v=Rt(m.getBorderBox()),g=n.endRadius,y=Math.round(g/(Math.PI/2)),b=y*(Math.PI/2),E=n.endPoint,x=exports.E(exports.E({},n.position),{x:E.x+v.width/2*Math.cos(b)-v.width/2,y:E.y-v.height/2*Math.sin(b)-v.height/2});l.update(m,{position:x});var w="l";1===y?w="b":2===y?w="r":3===y&&(w="t");var C=m.getAttachedProps(E,w);l.update(n,{endElementId:C.attachedElementId,endPosition:C.percentOffset,endType:C.attachedPointType}),l.update(n,{frameId:null});var S=e.parentRefSystem;if(n.parentRefSystem!==S){var k=n.calcTransformedUpdate(S);k.zIndex=e.zIndex+1,l.update(n,k)}var _=this.upime.createLock([n.id,m.id]);this.findAndSetParent(l,m),this.upime.clearLock(_),l.sync();var T=this.upime.selectElement(m);Iu(m)?m.onGetSchema=function(){var e,t;if(_e.desktop&&m.currentEditor===T){T.connectedEditor||T.connectTextEditor();var n=h,i={ha:n.ha,va:n.va,fontSize:n.fontSize,lineHeight:n.lineHeight,fontFamily:n.fontFamily};m.textNodes.forEach((function(e){e.updateStyle(l,i)})),void 0!==f&&(null===(e=T.connectedEditor)||void 0===e||e.updateStyle({color:f})),T.startEdit(),null===(t=T.connectedEditor)||void 0===t||t.pickAll(),m.onGetSchema=void 0,m.textNodes.length&&l.sync()}}:((Au(m)||Nu(m))&&void 0!==f&&(null===(s=T.connectedEditor)||void 0===s||s.updateStyle({color:f})),T.startEdit())},t.prototype.adjustPointToAxis=function(e,t){var n=8/this.upime.view.scale,i=Math.abs(e.x-t.x)<n,r=Math.abs(e.y-t.y)<n;return i&&!r?{x:t.x,y:e.y}:r&&!i?{x:e.x,y:t.y}:e},t}(zd),yx=[{id:0,lineWidth:3,lineColor:je[12],lineOpacity:1},{id:1,lineWidth:10,lineColor:je[3],lineOpacity:1},{id:2,lineWidth:15,lineColor:je[10],lineOpacity:1}],bx=[{id:0,lineWidth:22,lineColor:je[7],lineOpacity:.5},{id:1,lineWidth:22,lineColor:je[2],lineOpacity:.5},{id:2,lineWidth:22,lineColor:je[5],lineOpacity:.5}],Ex=((mx={})[Ya.NORMAL]=yx,mx[Ya.MARK]=bx,mx[Ya.SMART]=yx,mx),xx=((vx={})[ju.CIRCLE]=Ka.ELLIPSE,vx[ju.RECT]=Ka.RECT,vx[ju.PARALLELOGRAM]=Ka.PARALLELOGRAM,vx[ju.TRIANGLE]=Ka.TRIANGLE,vx[ju.DIAMOND]=Ka.DIAMOND,vx[ju.LADDER]=void 0,vx[ju.ARROW]=void 0,vx[ju.LINE]=void 0,vx),wx=function(e){function t(t){var n,i=e.call(this,t)||this;return i.drawStraightLine=!1,i.penType=Ya.NORMAL,i.pens=Ex,i.lineStyle={lineColor:i.pens[Ya.NORMAL][0].lineColor,lineWidth:i.pens[Ya.NORMAL][0].lineWidth},i.curPenTypeIndex=((n={})[Ya.NORMAL]=0,n[Ya.MARK]=0,n[Ya.SMART]=0,n),i.smartDrawDraftLineList=[],i.unsub_xmode=i.upime.subscribe("xmodechange",(function(e){"draw"===e?i.listenMoveto(!0):i.listenMoveto(!1)})),"draw"===t.xmode&&i.listenMoveto(!0),i}return P(t,e),t.prototype.setStyle=function(e){Object.assign(this.lineStyle,e),this.pureCircle&&(this.pureCircle.style=this.lineStyle,this.upime.updateWidgetCvs())},t.prototype.initDrawStyles=function(e){var t=this,n=null!=e?e:{},i=n.pen,r=n.mark;i&&i.slice(0,3).forEach((function(e,n){t.pens[Ya.NORMAL][n]=exports.E(exports.E({},t.pens[Ya.NORMAL][n]),e),t.pens[Ya.SMART][n]=exports.E(exports.E({},t.pens[Ya.SMART][n]),e)})),r&&r.slice(0,3).forEach((function(e,n){t.pens[Ya.MARK][n]=exports.E(exports.E({},t.pens[Ya.MARK][n]),e)}))},t.prototype.setPenStyles=function(e,t,n){this.pens[e][t]=exports.E(exports.E({},this.pens[e][t]),n)},t.prototype.setCurPenTypeIndex=function(e,t){this.curPenTypeIndex[e]=t},t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n,i,r,o,a=null;_e.desktop&&!_e.isTouchSupported&&((a=new EE(this.upime,this.lineStyle)).position=this.upime.userEventManager.mousePosition,this.pureCircle=a,this.upime.view.addCanvasWidget(this.pureCircle));var s=0;this.drawStraightLine=!1;var l=[this.upime.userEventManager.subscribe("moveto",(function(e){var l,c,u,d,p,h=e.isStart,f=e.isEnd,m=void 0!==f&&f,v=e.position,g=e.startPosition,y=e.globalPosition;if("left"===e.connectType||"touch"===e.connectType){var b=[v.x-g.x,v.y-g.y],E="touch"===e.connectType&&1!==e.originEvent.touches.length;if(E&&t.upime.dealMove(e),h&&!E){var x=new wE(t.upime,t.lineStyle,e.startGlobalPosition);t.upime.view.addSvgWidget(x),x.appendPoints(y),t.penType!==Ya.SMART?t.draftLine=x:t.smartDrawDraftLineList.push({draftLine:x,points:[b],isEnd:!1})}if(t.penType!==Ya.SMART)if(r){var w=n,C=r,S=w.drawPoints[w.drawPoints.length-2],k=w.drawPoints[w.drawPoints.length-1],_=exports.E({},y);if(!m&&t.upime.isHighResolution&&(null===(c=t.draftLine)||void 0===c?void 0:c.lastPoint)&&fn(null===(u=t.draftLine)||void 0===u?void 0:u.lastPoint,_)<=3)return;if((null===(d=t.draftLine)||void 0===d?void 0:d.lastPoint)&&t.disturbancePoints(_,t.draftLine.lastPoint),t.drawStraightLine){if(t.draftLine){var T=t.draftLine.path[0];t.draftLine.replacePoints([T,_])}}else null===(p=t.draftLine)||void 0===p||p.appendPoints(_);t.disturbancePoints(b,{x:S,y:k});var I={};t.drawStraightLine?t.draftLine&&(T=[g.x-g.x,g.y-g.y],I.straightLine=R(R([T[0],T[1]],b,!0),b,!0)):I.drawPoints=b,m||E?(I.ended=!0,clearInterval(s),w.eleHided=!1,C.update(w,I),t.draftLine&&t.upime.view.removeSvgWidget(t.draftLine),t.draftLine=void 0,!E&&C.update(w,I),o||t.findAndSetParent(C,w),C.sync(),t.upime.clearLock(i),i=void 0,r=null,n=null):!E&&C.update(w,I)}else{if(!h||E)return;o=t.findRefSystemByPoint(g),r=t.upime.createOperation();var P=void 0,N=1;if(o){var M=o.globalTransform;P=exports.E(exports.E({},M.applyInverse(g)),o.getRelateInfo()),N=1/o.globalTransform.currentScale}else P=exports.E({},g);var A=exports.E({lineWidth:t.lineStyle.lineWidth,lineColor:t.lineStyle.lineColor,position:P,scale:N,drawPoints:b,zIndex:t.upime.newMaxZindex(),penType:t.penType},t.penType===Ya.MARK&&{lineOpacity:null!==(l=t.lineStyle.lineOpacity)&&void 0!==l?l:.5});if(!o){var D=t.upime.elementManager.getAvailableFrames((function(e){return!e.hide})),B=D.find((function(e){var t=e.getGlobalBox();return Ot(g,t)}));B&&(A.frameId=B.id)}n=r.create(Za.LINE,A,{hide:!0}),i=t.upime.createLock([n.id]),s=window.setInterval((function(){return null==r?void 0:r.sync()}),40)}else{var L=t.smartDrawDraftLineList[t.smartDrawDraftLineList.length-1];if(L.isEnd)return;x=L.draftLine;var O=L.points;_=exports.E({},y),(null==x?void 0:x.lastPoint)&&t.disturbancePoints(_,x.lastPoint),null==x||x.appendPoints(_),O.push(b),(m||E)&&x&&(L.isEnd=!0,t.draftToShape(O,x,e))}h&&a&&(a.hide=!0,t.upime.updateWidgetCvs()),m&&a&&(a.hide=!1,a.position=e.globalPosition,t.upime.updateWidgetCvs())}})),this.upime.userEventManager.subscribe("click",(function(e){return function(e){var n;if("left"===e.connectType||"touch"===e.connectType){var i=e.position,r=t.upime.createOperation(),o=r.create(Za.LINE,exports.E({zIndex:t.upime.newMaxZindex(),lineWidth:t.lineStyle.lineWidth,lineColor:t.lineStyle.lineColor,position:{x:i.x,y:i.y},drawPoints:[],ended:!0,penType:t.penType},t.penType===Ya.MARK&&{lineOpacity:null!==(n=t.lineStyle.lineOpacity)&&void 0!==n?n:.5})),a=t.upime.createLock([o.id]);t.findAndSetParent(r,o),r.sync(),t.upime.clearLock(a)}}(e)})),this.upime.registerHotKey({key:"Shift"},(function(){t.drawStraightLine=!0})),this.upime.registerKeyup(["Shift"],(function(){t.drawStraightLine=!1}))];this.unsub_move=function(){l.forEach((function(e){return e()})),t.pureCircle&&(t.upime.view.removeCanvasWidget(t.pureCircle),t.pureCircle=void 0),t.draftLine&&(t.upime.view.removeSvgWidget(t.draftLine),t.draftLine=void 0),t.smartDrawDraftLineList.forEach((function(e){t.upime.view.removeSvgWidget(e.draftLine)})),t.smartDrawDraftLineList=[]}}},t.prototype.draftToLine=function(e,t,n){this.upime.view.removeSvgWidget(t);var i,r=n.startPosition,o=this.findRefSystemByPoint(r),a=this.upime.createOperation(),s=1;if(o){var l=o.globalTransform;i=exports.E(exports.E({},l.applyInverse(r)),o.getRelateInfo()),s=1/o.globalTransform.currentScale}else i=exports.E({},r);a.create(Za.LINE,{lineWidth:this.lineStyle.lineWidth,lineColor:this.lineStyle.lineColor,position:i,scale:s,drawPoints:e.flat(),zIndex:this.upime.newMaxZindex(),penType:this.penType,ended:!0}),a.sync()},t.prototype.draftToShape=function(e,t,n){var i=this;this.points2Shape(e).then((function(r){var o=i.recognize2SDKInfo(r,n);if(o){var a=i.upime.createOperation(),s=a.create(o.elementType,o.initData,{hide:!0});i.findAndSetParent(a,s),function(e,t,n){var i=R([],e.path,!0),r=function(e,t,n){return t.elementType===Za.CONNECTIONLINE?function(e,t,n){var i=t.startPosition,r=t.endPosition,o=t.globalTransform;o&&(i=o.apply(i),r=o.apply(r));var a=n.view.getScreenPosition(i),s=n.view.getScreenPosition(r);return e.path.map((function(e){return Bn(a,s,e)}))}(e,t,n):t.shape===Ka.ELLIPSE?function(e,t,n){var i=t.getGlobalBox(),r=Rt(i),o=Lt(i),a=n.view.getScreenPosition(o),s=n.view.scale,l=t.rotate;function c(e){return e*s+a.x}function u(e){return e*s+a.y}var d=function(e,t,n){for(var i=t/2,r=e/2,o=function(e){return i*Math.sqrt(1-Math.pow(e/r,2))},a=[],s=[],l=0;l<50;l++){var c=Rn(-r,r,l/49),u=o(c);a.push({x:c,y:u}),s.unshift({x:c,y:-u})}return a.concat(s)}(r.width,r.height).map((function(e){return an(e,l,{x:0,y:0})})).map((function(e){var t=e.x,n=e.y;return{x:c(t),y:u(n)}})),p=[];return e.path.forEach((function(e){var t=1/0,n=d[0];d.forEach((function(i){var r=mn(e,i);r>=t||(t=r,n=i)})),p.push(n)})),ux(p,t,n)}(e,t,n):rx.near(e,t,n)}(e,t,n);return new Promise((function(t){var o=0;!function a(){var s=++o/10,l=e.path.map((function(e,t){return{x:Rn(i[t].x,r[t].x,s),y:Rn(i[t].y,r[t].y,s)}}));n.updateWidgetCvs(),o<10?fr(a):t(),e.replacePoints(l)}()}))}(t,s,i.upime).then((function(){i.upime.view.removeSvgWidget(t),s.eleHided=!1,i.upime.updateView(),a.sync()}))}else i.draftToLine(e,t,n)})).catch((function(r){i.draftToLine(e,t,n)}))},t.prototype.disturbancePoints=function(e,t){if(Array.isArray(e))return e[0]===t.x&&(e[0]+=.01),void(e[1]===t.y&&(e[1]+=.01));e.x===t.x&&(e.x+=.01),e.y===t.y&&(e.y+=.01)},t.prototype.recognize2SDKInfo=function(e,t){var n=e.angle,i=e.centerPoint,r=e.width,o=e.height,a=e.shape,s=e.extra,l=t.startPosition;if(a===ju.ARROW||a===ju.LINE){var c=s.start_point||[0,0],u=s.end_point||[0,0],d=gx.getDefaultLineConfig();return d.lineColor=this.lineStyle.lineColor,a===ju.LINE&&(d.endArrow=0),{elementType:Za.CONNECTIONLINE,initData:exports.E(exports.E({},d),{position:{x:0,y:0},startPosition:{x:c[0]+l.x,y:c[1]+l.y},endPosition:{x:u[0]+l.x,y:u[1]+l.y},zIndex:this.upime.newMaxZindex()})}}if(0!==r&&0!==o){var p=xx[a];if(p){var h={x:i[0]-r/2+l.x,y:i[1]-o/2+l.y},f=ix.findInitShapeData(this.upime,p,h,{width:r,height:o});return f.borderColor=this.lineStyle.lineColor,f.borderOpacity=this.lineStyle.lineOpacity||1,f.borderThickness=this.lineStyle.lineWidth,n&&(f.rotate=180-n),{elementType:Za.SHAPE,type:p,initData:f}}}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t.prototype.points2Shape=function(e){return Promise.race([this.upime.points2Shape(e),new Promise((function(e,t){return setTimeout((function(){return t("points2Shape to slow")}),500)}))])},t}(zd),Cx={draftContainer:"draftContainer_UuOXY",textPart:"textPart_GSblp",editor:"editor_12tyR",actionRow:"actionRow_3GZwe",active:"active_1PXIw",draftActions:"draftActions_FEgSS",micCon:"micCon_3R3ED",phone:"phone_1AAw-",mic:"mic_Qk8ae",fasongContainer:"fasongContainer_1JmyT",send:"send_3A3br",guanbi:"guanbi_czW5R",editTextPart:"editTextPart_1Dbg8",upload:"upload_QWZzg",editmode:"editmode_28RLT",atContainer:"atContainer_L-8EN",recorderContainer:"recorderContainer_14Ow8",coverblock:"coverblock_i__Kp",closebar:"closebar_2rxUU",commentWrapper:"commentWrapper_2tPfS",connectionLine:"connectionLine_2yASh",pivot:"pivot_17Isl",commentBody:"commentBody_1nmBD",panelRoot:"panelRoot_DCbrc",header:"header_1MxK8",toggleRoot:"toggleRoot_35-It",resolvedText:"resolvedText_LiVDf",actions:"actions_3L1j-",themeSelector:"themeSelector_1-iBt",body:"body__a4mA",panelSubmenu:"panelSubmenu_2ZDSQ",row:"row_3B7Qx",content:"content_3xLwN",headIcon:"headIcon_1Gh3W",pin:"pin_w94iy",activeIcon:"activeIcon_2Uyb6",guideRoot:"guideRoot_3BhxH",title:"title_3sP2y",link:"link_1a0Wl"},Sx=function(t,n){void 0===n&&(n=!1);var i=function(e){e.stopPropagation()};e.useEffect((function(){return t.every((function(e){return e.current}))&&!n&&t.forEach((function(e){var t;return null===(t=e.current)||void 0===t?void 0:t.addEventListener("pointerdown",i)})),function(){t.every((function(e){return e.current}))&&n&&t.forEach((function(e){var t;return null===(t=e.current)||void 0===t?void 0:t.removeEventListener("pointerdown",i)}))}}),R([t],t.map((function(e){return e.current})),!0))};
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function kx(e){return"[object Object]"===Object.prototype.toString.call(e)}function _x(e){var t,n;return!1!==kx(e)&&(void 0===(t=e.constructor)||!1!==kx(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf"))}function Tx(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("production"!==process.env.NODE_ENV){var r=hw[e],o=r?"function"==typeof r?r.apply(null,n):r:"unknown error nr: "+e;throw Error("[Immer] "+o)}throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ix(e){return!!e&&!!e[pw]}function Px(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===fw}(e)||Array.isArray(e)||!!e[dw]||!!e.constructor[dw]||Rx(e)||Bx(e))}function Nx(e,t,n){void 0===n&&(n=!1),0===Mx(e)?(n?Object.keys:mw)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function Mx(e){var t=e[pw];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Rx(e)?2:Bx(e)?3:0}function Ax(e,t){return 2===Mx(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Dx(e,t,n){var i=Mx(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function Rx(e){return sw&&e instanceof Map}function Bx(e){return lw&&e instanceof Set}function Lx(e){return e.o||e.t}function Ox(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=vw(e);delete t[pw];for(var n=mw(t),i=0;i<n.length;i++){var r=n[i],o=t[r];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[r]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function Fx(e,t){return void 0===t&&(t=!1),Hx(e)||Ix(e)||!Px(e)||(Mx(e)>1&&(e.set=e.add=e.clear=e.delete=zx),Object.freeze(e),t&&Nx(e,(function(e,t){return Fx(t,!0)}),!0)),e}function zx(){Tx(2)}function Hx(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Ux(e){var t=gw[e];return t||Tx(18,e),t}function Wx(){return"production"===process.env.NODE_ENV||ow||Tx(0),ow}function Vx(e,t){t&&(Ux("Patches"),e.u=[],e.s=[],e.v=t)}function jx(e){Gx(e),e.p.forEach(Kx),e.p=null}function Gx(e){e===ow&&(ow=e.l)}function qx(e){return ow={p:[],l:ow,h:e,m:!0,_:0}}function Kx(e){var t=e[pw];0===t.i||1===t.i?t.j():t.O=!0}function Yx(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.g||Ux("ES5").S(t,e,i),i?(n[pw].P&&(jx(t),Tx(4)),Px(e)&&(e=Xx(t,e),t.l||Zx(t,e)),t.u&&Ux("Patches").M(n[pw].t,e,t.u,t.s)):e=Xx(t,n,[]),jx(t),t.u&&t.v(t.u,t.s),e!==uw?e:void 0}function Xx(e,t,n){if(Hx(t))return t;var i=t[pw];if(!i)return Nx(t,(function(r,o){return Qx(e,i,t,r,o,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return Zx(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=Ox(i.k):i.o;Nx(3===i.i?new Set(r):r,(function(t,o){return Qx(e,i,r,t,o,n)})),Zx(e,r,!1),n&&e.u&&Ux("Patches").R(i,n,e.u,e.s)}return i.o}function Qx(e,t,n,i,r,o){if("production"!==process.env.NODE_ENV&&r===n&&Tx(5),Ix(r)){var a=Xx(e,r,o&&t&&3!==t.i&&!Ax(t.D,i)?o.concat(i):void 0);if(Dx(n,i,a),!Ix(a))return;e.m=!1}if(Px(r)&&!Hx(r)){if(!e.h.F&&e._<1)return;Xx(e,r),t&&t.A.l||Zx(e,r)}}function Zx(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&Fx(t,n)}function Jx(e,t){var n=e[pw];return(n?Lx(n):e)[t]}function $x(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function ew(e){e.P||(e.P=!0,e.l&&ew(e.l))}function tw(e){e.o||(e.o=Ox(e.t))}function nw(e,t,n){var i=Rx(t)?Ux("MapSet").N(t,n):Bx(t)?Ux("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:Wx(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=i,o=yw;n&&(r=[i],o=bw);var a=Proxy.revocable(r,o),s=a.revoke,l=a.proxy;return i.k=l,i.j=s,l}(t,n):Ux("ES5").J(t,n);return(n?n.A:Wx()).p.push(i),i}function iw(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Ox(e)}var rw,ow,aw="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),sw="undefined"!=typeof Map,lw="undefined"!=typeof Set,cw="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,uw=aw?Symbol.for("immer-nothing"):((rw={})["immer-nothing"]=!0,rw),dw=aw?Symbol.for("immer-draftable"):"__$immer_draftable",pw=aw?Symbol.for("immer-state"):"__$immer_state",hw={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},fw=""+Object.prototype.constructor,mw="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,vw=Object.getOwnPropertyDescriptors||function(e){var t={};return mw(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},gw={},yw={get:function(e,t){if(t===pw)return e;var n=Lx(e);if(!Ax(n,t))return function(e,t,n){var i,r=$x(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!Px(i)?i:i===Jx(e.t,t)?(tw(e),e.o[t]=nw(e.A.h,i,e)):i},has:function(e,t){return t in Lx(e)},ownKeys:function(e){return Reflect.ownKeys(Lx(e))},set:function(e,t,n){var i=$x(Lx(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var r=Jx(Lx(e),t),o=null==r?void 0:r[pw];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,r)&&(void 0!==n||Ax(e.t,t)))return!0;tw(e),ew(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Jx(e.t,t)||t in e.t?(e.D[t]=!1,tw(e),ew(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Lx(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){Tx(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Tx(12)}},bw={};Nx(yw,(function(e,t){bw[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),bw.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&Tx(13),bw.set.call(this,e,t,void 0)},bw.set=function(e,t,n){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&Tx(14),yw.set.call(this,e[0],t,n,e[0])};var Ew=function(){function e(e){var t=this;this.g=cw,this.F=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var r=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,a=Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return o.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(a))}))}}var a;if("function"!=typeof n&&Tx(6),void 0!==i&&"function"!=typeof i&&Tx(7),Px(e)){var s=qx(t),l=nw(t,e,void 0),c=!0;try{a=n(l),c=!1}finally{c?jx(s):Gx(s)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return Vx(s,i),Yx(e,s)}),(function(e){throw jx(s),e})):(Vx(s,i),Yx(a,s))}if(!e||"object"!=typeof e){if(void 0===(a=n(e))&&(a=e),a===uw&&(a=void 0),t.F&&Fx(a,!0),i){var u=[],d=[];Ux("Patches").M(e,a,u,d),i(u,d)}return a}Tx(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(r))}))};var i,r,o=t.produce(e,n,(function(e,t){i=e,r=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,i,r]})):[o,i,r]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Px(e)||Tx(8),Ix(e)&&(e=function(e){return Ix(e)||Tx(22,e),function e(t){if(!Px(t))return t;var n,i=t[pw],r=Mx(t);if(i){if(!i.P&&(i.i<4||!Ux("ES5").K(i)))return i.t;i.I=!0,n=iw(t,r),i.I=!1}else n=iw(t,r);return Nx(n,(function(t,r){i&&function(e,t){return 2===Mx(e)?e.get(t):e[t]}(i.t,t)===r||Dx(n,t,e(r))})),3===r?new Set(n):n}(e)}(e));var t=qx(this),n=nw(this,e,void 0);return n[pw].C=!0,Gx(t),n},t.finishDraft=function(e,t){var n=e&&e[pw];"production"!==process.env.NODE_ENV&&(n&&n.C||Tx(9),n.I&&Tx(10));var i=n.A;return Vx(i,t),Yx(void 0,i)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!cw&&Tx(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=Ux("Patches").$;return Ix(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}(),xw=new Ew,ww=xw.produce;xw.produceWithPatches.bind(xw),xw.setAutoFreeze.bind(xw),xw.setUseProxies.bind(xw),xw.applyPatches.bind(xw);var Cw=xw.createDraft.bind(xw),Sw=xw.finishDraft.bind(xw);function kw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _w=new WeakMap,Tw=new WeakMap,Iw=new WeakMap,Pw=new WeakMap,Nw=new WeakMap,Mw=new WeakMap,Aw=new WeakMap;function Dw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Rw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dw(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dw(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bw(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Lw,Ow=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!t,i=t?Vw(e):e,r=Lw.None,o=Lw.None,a=0,s=null;for(var l of i){var c=l.codePointAt(0);if(!c)break;var u=tC(l,c);if([r,o]=n?[o,u]:[u,r],nC(r,Lw.ZWJ)&&nC(o,Lw.ExtPict)&&!aC(n?e.substring(0,a):e.substring(0,e.length-a)))break;if(nC(r,Lw.RI)&&nC(o,Lw.RI)&&!(s=null!==s?!s:!!n||lC(e.substring(0,e.length-a))))break;if(r!==Lw.None&&o!==Lw.None&&rC(r,o))break;a+=l.length}return a||1},Fw=/\s/,zw=/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,Hw=/['\u2018\u2019]/,Uw=(e,t,n)=>{if(n){var i=e.length-t;return[e.slice(i,e.length),e.slice(0,i)]}return[e.slice(0,t),e.slice(t)]},Ww=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Fw.test(t))return!1;if(Hw.test(t)){var r=Ow(n,i),[o,a]=Uw(n,r,i);if(e(o,a,i))return!0}return!zw.test(t)},Vw=function*(e){for(var t=e.length-1,n=0;n<e.length;n++){var i=e.charAt(t-n);if(Gw(i.charCodeAt(0))){var r=e.charAt(t-n-1);if(jw(r.charCodeAt(0))){yield r+i,n++;continue}}yield i}},jw=e=>e>=55296&&e<=56319,Gw=e=>e>=56320&&e<=57343;!function(e){e[e.None=0]="None",e[e.Extend=1]="Extend",e[e.ZWJ=2]="ZWJ",e[e.RI=4]="RI",e[e.Prepend=8]="Prepend",e[e.SpacingMark=16]="SpacingMark",e[e.L=32]="L",e[e.V=64]="V",e[e.T=128]="T",e[e.LV=256]="LV",e[e.LVT=512]="LVT",e[e.ExtPict=1024]="ExtPict",e[e.Any=2048]="Any"}(Lw||(Lw={}));var qw=/^(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C04\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62\u0D63\u0D81\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1AC0\u1B00-\u1B03\u1B34-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u200C\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E\uFF9F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDEAB\uDEAC\uDF46-\uDF50]|\uD804[\uDC01\uDC38-\uDC46\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDC9-\uDDCC\uDDCF\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3B\uDF3C\uDF3E\uDF40\uDF57\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDC5E\uDCB0\uDCB3-\uDCB8\uDCBA\uDCBD\uDCBF\uDCC0\uDCC2\uDCC3\uDDAF\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D-\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD806[\uDC2F-\uDC37\uDC39\uDC3A\uDD30\uDD3B\uDD3C\uDD3E\uDD43\uDDD4-\uDDD7\uDDDA\uDDDB\uDDE0\uDE01-\uDE0A\uDE33-\uDE38\uDE3B-\uDE3E\uDE47\uDE51-\uDE56\uDE59-\uDE5B\uDE8A-\uDE96\uDE98\uDE99]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD90\uDD91\uDD95\uDD97\uDEF3\uDEF4]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF8F-\uDF92\uDFE4]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD65\uDD67-\uDD69\uDD6E-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD30-\uDD36\uDEEC-\uDEEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uD83C[\uDFFB-\uDFFF]|\uDB40[\uDC20-\uDC7F\uDD00-\uDDEF])$/,Kw=/^(?:[\u0600-\u0605\u06DD\u070F\u0890\u0891\u08E2\u0D4E]|\uD804[\uDCBD\uDCCD\uDDC2\uDDC3]|\uD806[\uDD3F\uDD41\uDE3A\uDE84-\uDE89]|\uD807\uDD46)$/,Yw=/^(?:[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E\u094F\u0982\u0983\u09BF\u09C0\u09C7\u09C8\u09CB\u09CC\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB\u0ACC\u0B02\u0B03\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0C01-\u0C03\u0C41-\u0C44\u0C82\u0C83\u0CBE\u0CC0\u0CC1\u0CC3\u0CC4\u0CC7\u0CC8\u0CCA\u0CCB\u0D02\u0D03\u0D3F\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D82\u0D83\u0DD0\u0DD1\u0DD8-\u0DDE\u0DF2\u0DF3\u0E33\u0EB3\u0F3E\u0F3F\u0F7F\u1031\u103B\u103C\u1056\u1057\u1084\u1715\u1734\u17B6\u17BE-\u17C5\u17C7\u17C8\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1A19\u1A1A\u1A55\u1A57\u1A6D-\u1A72\u1B04\u1B3B\u1B3D-\u1B41\u1B43\u1B44\u1B82\u1BA1\u1BA6\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1C24-\u1C2B\u1C34\u1C35\u1CE1\u1CF7\uA823\uA824\uA827\uA880\uA881\uA8B4-\uA8C3\uA952\uA953\uA983\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9C0\uAA2F\uAA30\uAA33\uAA34\uAA4D\uAAEB\uAAEE\uAAEF\uAAF5\uABE3\uABE4\uABE6\uABE7\uABE9\uABEA\uABEC]|\uD804[\uDC00\uDC02\uDC82\uDCB0-\uDCB2\uDCB7\uDCB8\uDD2C\uDD45\uDD46\uDD82\uDDB3-\uDDB5\uDDBF\uDDC0\uDDCE\uDE2C-\uDE2E\uDE32\uDE33\uDE35\uDEE0-\uDEE2\uDF02\uDF03\uDF3F\uDF41-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF62\uDF63]|\uD805[\uDC35-\uDC37\uDC40\uDC41\uDC45\uDCB1\uDCB2\uDCB9\uDCBB\uDCBC\uDCBE\uDCC1\uDDB0\uDDB1\uDDB8-\uDDBB\uDDBE\uDE30-\uDE32\uDE3B\uDE3C\uDE3E\uDEAC\uDEAE\uDEAF\uDEB6\uDF26]|\uD806[\uDC2C-\uDC2E\uDC38\uDD31-\uDD35\uDD37\uDD38\uDD3D\uDD40\uDD42\uDDD1-\uDDD3\uDDDC-\uDDDF\uDDE4\uDE39\uDE57\uDE58\uDE97]|\uD807[\uDC2F\uDC3E\uDCA9\uDCB1\uDCB4\uDD8A-\uDD8E\uDD93\uDD94\uDD96\uDEF5\uDEF6]|\uD81B[\uDF51-\uDF87\uDFF0\uDFF1]|\uD834[\uDD66\uDD6D])$/,Xw=/^[\u1100-\u115F\uA960-\uA97C]$/,Qw=/^[\u1160-\u11A7\uD7B0-\uD7C6]$/,Zw=/^[\u11A8-\u11FF\uD7CB-\uD7FB]$/,Jw=/^[\uAC00\uAC1C\uAC38\uAC54\uAC70\uAC8C\uACA8\uACC4\uACE0\uACFC\uAD18\uAD34\uAD50\uAD6C\uAD88\uADA4\uADC0\uADDC\uADF8\uAE14\uAE30\uAE4C\uAE68\uAE84\uAEA0\uAEBC\uAED8\uAEF4\uAF10\uAF2C\uAF48\uAF64\uAF80\uAF9C\uAFB8\uAFD4\uAFF0\uB00C\uB028\uB044\uB060\uB07C\uB098\uB0B4\uB0D0\uB0EC\uB108\uB124\uB140\uB15C\uB178\uB194\uB1B0\uB1CC\uB1E8\uB204\uB220\uB23C\uB258\uB274\uB290\uB2AC\uB2C8\uB2E4\uB300\uB31C\uB338\uB354\uB370\uB38C\uB3A8\uB3C4\uB3E0\uB3FC\uB418\uB434\uB450\uB46C\uB488\uB4A4\uB4C0\uB4DC\uB4F8\uB514\uB530\uB54C\uB568\uB584\uB5A0\uB5BC\uB5D8\uB5F4\uB610\uB62C\uB648\uB664\uB680\uB69C\uB6B8\uB6D4\uB6F0\uB70C\uB728\uB744\uB760\uB77C\uB798\uB7B4\uB7D0\uB7EC\uB808\uB824\uB840\uB85C\uB878\uB894\uB8B0\uB8CC\uB8E8\uB904\uB920\uB93C\uB958\uB974\uB990\uB9AC\uB9C8\uB9E4\uBA00\uBA1C\uBA38\uBA54\uBA70\uBA8C\uBAA8\uBAC4\uBAE0\uBAFC\uBB18\uBB34\uBB50\uBB6C\uBB88\uBBA4\uBBC0\uBBDC\uBBF8\uBC14\uBC30\uBC4C\uBC68\uBC84\uBCA0\uBCBC\uBCD8\uBCF4\uBD10\uBD2C\uBD48\uBD64\uBD80\uBD9C\uBDB8\uBDD4\uBDF0\uBE0C\uBE28\uBE44\uBE60\uBE7C\uBE98\uBEB4\uBED0\uBEEC\uBF08\uBF24\uBF40\uBF5C\uBF78\uBF94\uBFB0\uBFCC\uBFE8\uC004\uC020\uC03C\uC058\uC074\uC090\uC0AC\uC0C8\uC0E4\uC100\uC11C\uC138\uC154\uC170\uC18C\uC1A8\uC1C4\uC1E0\uC1FC\uC218\uC234\uC250\uC26C\uC288\uC2A4\uC2C0\uC2DC\uC2F8\uC314\uC330\uC34C\uC368\uC384\uC3A0\uC3BC\uC3D8\uC3F4\uC410\uC42C\uC448\uC464\uC480\uC49C\uC4B8\uC4D4\uC4F0\uC50C\uC528\uC544\uC560\uC57C\uC598\uC5B4\uC5D0\uC5EC\uC608\uC624\uC640\uC65C\uC678\uC694\uC6B0\uC6CC\uC6E8\uC704\uC720\uC73C\uC758\uC774\uC790\uC7AC\uC7C8\uC7E4\uC800\uC81C\uC838\uC854\uC870\uC88C\uC8A8\uC8C4\uC8E0\uC8FC\uC918\uC934\uC950\uC96C\uC988\uC9A4\uC9C0\uC9DC\uC9F8\uCA14\uCA30\uCA4C\uCA68\uCA84\uCAA0\uCABC\uCAD8\uCAF4\uCB10\uCB2C\uCB48\uCB64\uCB80\uCB9C\uCBB8\uCBD4\uCBF0\uCC0C\uCC28\uCC44\uCC60\uCC7C\uCC98\uCCB4\uCCD0\uCCEC\uCD08\uCD24\uCD40\uCD5C\uCD78\uCD94\uCDB0\uCDCC\uCDE8\uCE04\uCE20\uCE3C\uCE58\uCE74\uCE90\uCEAC\uCEC8\uCEE4\uCF00\uCF1C\uCF38\uCF54\uCF70\uCF8C\uCFA8\uCFC4\uCFE0\uCFFC\uD018\uD034\uD050\uD06C\uD088\uD0A4\uD0C0\uD0DC\uD0F8\uD114\uD130\uD14C\uD168\uD184\uD1A0\uD1BC\uD1D8\uD1F4\uD210\uD22C\uD248\uD264\uD280\uD29C\uD2B8\uD2D4\uD2F0\uD30C\uD328\uD344\uD360\uD37C\uD398\uD3B4\uD3D0\uD3EC\uD408\uD424\uD440\uD45C\uD478\uD494\uD4B0\uD4CC\uD4E8\uD504\uD520\uD53C\uD558\uD574\uD590\uD5AC\uD5C8\uD5E4\uD600\uD61C\uD638\uD654\uD670\uD68C\uD6A8\uD6C4\uD6E0\uD6FC\uD718\uD734\uD750\uD76C\uD788]$/,$w=/^[\uAC01-\uAC1B\uAC1D-\uAC37\uAC39-\uAC53\uAC55-\uAC6F\uAC71-\uAC8B\uAC8D-\uACA7\uACA9-\uACC3\uACC5-\uACDF\uACE1-\uACFB\uACFD-\uAD17\uAD19-\uAD33\uAD35-\uAD4F\uAD51-\uAD6B\uAD6D-\uAD87\uAD89-\uADA3\uADA5-\uADBF\uADC1-\uADDB\uADDD-\uADF7\uADF9-\uAE13\uAE15-\uAE2F\uAE31-\uAE4B\uAE4D-\uAE67\uAE69-\uAE83\uAE85-\uAE9F\uAEA1-\uAEBB\uAEBD-\uAED7\uAED9-\uAEF3\uAEF5-\uAF0F\uAF11-\uAF2B\uAF2D-\uAF47\uAF49-\uAF63\uAF65-\uAF7F\uAF81-\uAF9B\uAF9D-\uAFB7\uAFB9-\uAFD3\uAFD5-\uAFEF\uAFF1-\uB00B\uB00D-\uB027\uB029-\uB043\uB045-\uB05F\uB061-\uB07B\uB07D-\uB097\uB099-\uB0B3\uB0B5-\uB0CF\uB0D1-\uB0EB\uB0ED-\uB107\uB109-\uB123\uB125-\uB13F\uB141-\uB15B\uB15D-\uB177\uB179-\uB193\uB195-\uB1AF\uB1B1-\uB1CB\uB1CD-\uB1E7\uB1E9-\uB203\uB205-\uB21F\uB221-\uB23B\uB23D-\uB257\uB259-\uB273\uB275-\uB28F\uB291-\uB2AB\uB2AD-\uB2C7\uB2C9-\uB2E3\uB2E5-\uB2FF\uB301-\uB31B\uB31D-\uB337\uB339-\uB353\uB355-\uB36F\uB371-\uB38B\uB38D-\uB3A7\uB3A9-\uB3C3\uB3C5-\uB3DF\uB3E1-\uB3FB\uB3FD-\uB417\uB419-\uB433\uB435-\uB44F\uB451-\uB46B\uB46D-\uB487\uB489-\uB4A3\uB4A5-\uB4BF\uB4C1-\uB4DB\uB4DD-\uB4F7\uB4F9-\uB513\uB515-\uB52F\uB531-\uB54B\uB54D-\uB567\uB569-\uB583\uB585-\uB59F\uB5A1-\uB5BB\uB5BD-\uB5D7\uB5D9-\uB5F3\uB5F5-\uB60F\uB611-\uB62B\uB62D-\uB647\uB649-\uB663\uB665-\uB67F\uB681-\uB69B\uB69D-\uB6B7\uB6B9-\uB6D3\uB6D5-\uB6EF\uB6F1-\uB70B\uB70D-\uB727\uB729-\uB743\uB745-\uB75F\uB761-\uB77B\uB77D-\uB797\uB799-\uB7B3\uB7B5-\uB7CF\uB7D1-\uB7EB\uB7ED-\uB807\uB809-\uB823\uB825-\uB83F\uB841-\uB85B\uB85D-\uB877\uB879-\uB893\uB895-\uB8AF\uB8B1-\uB8CB\uB8CD-\uB8E7\uB8E9-\uB903\uB905-\uB91F\uB921-\uB93B\uB93D-\uB957\uB959-\uB973\uB975-\uB98F\uB991-\uB9AB\uB9AD-\uB9C7\uB9C9-\uB9E3\uB9E5-\uB9FF\uBA01-\uBA1B\uBA1D-\uBA37\uBA39-\uBA53\uBA55-\uBA6F\uBA71-\uBA8B\uBA8D-\uBAA7\uBAA9-\uBAC3\uBAC5-\uBADF\uBAE1-\uBAFB\uBAFD-\uBB17\uBB19-\uBB33\uBB35-\uBB4F\uBB51-\uBB6B\uBB6D-\uBB87\uBB89-\uBBA3\uBBA5-\uBBBF\uBBC1-\uBBDB\uBBDD-\uBBF7\uBBF9-\uBC13\uBC15-\uBC2F\uBC31-\uBC4B\uBC4D-\uBC67\uBC69-\uBC83\uBC85-\uBC9F\uBCA1-\uBCBB\uBCBD-\uBCD7\uBCD9-\uBCF3\uBCF5-\uBD0F\uBD11-\uBD2B\uBD2D-\uBD47\uBD49-\uBD63\uBD65-\uBD7F\uBD81-\uBD9B\uBD9D-\uBDB7\uBDB9-\uBDD3\uBDD5-\uBDEF\uBDF1-\uBE0B\uBE0D-\uBE27\uBE29-\uBE43\uBE45-\uBE5F\uBE61-\uBE7B\uBE7D-\uBE97\uBE99-\uBEB3\uBEB5-\uBECF\uBED1-\uBEEB\uBEED-\uBF07\uBF09-\uBF23\uBF25-\uBF3F\uBF41-\uBF5B\uBF5D-\uBF77\uBF79-\uBF93\uBF95-\uBFAF\uBFB1-\uBFCB\uBFCD-\uBFE7\uBFE9-\uC003\uC005-\uC01F\uC021-\uC03B\uC03D-\uC057\uC059-\uC073\uC075-\uC08F\uC091-\uC0AB\uC0AD-\uC0C7\uC0C9-\uC0E3\uC0E5-\uC0FF\uC101-\uC11B\uC11D-\uC137\uC139-\uC153\uC155-\uC16F\uC171-\uC18B\uC18D-\uC1A7\uC1A9-\uC1C3\uC1C5-\uC1DF\uC1E1-\uC1FB\uC1FD-\uC217\uC219-\uC233\uC235-\uC24F\uC251-\uC26B\uC26D-\uC287\uC289-\uC2A3\uC2A5-\uC2BF\uC2C1-\uC2DB\uC2DD-\uC2F7\uC2F9-\uC313\uC315-\uC32F\uC331-\uC34B\uC34D-\uC367\uC369-\uC383\uC385-\uC39F\uC3A1-\uC3BB\uC3BD-\uC3D7\uC3D9-\uC3F3\uC3F5-\uC40F\uC411-\uC42B\uC42D-\uC447\uC449-\uC463\uC465-\uC47F\uC481-\uC49B\uC49D-\uC4B7\uC4B9-\uC4D3\uC4D5-\uC4EF\uC4F1-\uC50B\uC50D-\uC527\uC529-\uC543\uC545-\uC55F\uC561-\uC57B\uC57D-\uC597\uC599-\uC5B3\uC5B5-\uC5CF\uC5D1-\uC5EB\uC5ED-\uC607\uC609-\uC623\uC625-\uC63F\uC641-\uC65B\uC65D-\uC677\uC679-\uC693\uC695-\uC6AF\uC6B1-\uC6CB\uC6CD-\uC6E7\uC6E9-\uC703\uC705-\uC71F\uC721-\uC73B\uC73D-\uC757\uC759-\uC773\uC775-\uC78F\uC791-\uC7AB\uC7AD-\uC7C7\uC7C9-\uC7E3\uC7E5-\uC7FF\uC801-\uC81B\uC81D-\uC837\uC839-\uC853\uC855-\uC86F\uC871-\uC88B\uC88D-\uC8A7\uC8A9-\uC8C3\uC8C5-\uC8DF\uC8E1-\uC8FB\uC8FD-\uC917\uC919-\uC933\uC935-\uC94F\uC951-\uC96B\uC96D-\uC987\uC989-\uC9A3\uC9A5-\uC9BF\uC9C1-\uC9DB\uC9DD-\uC9F7\uC9F9-\uCA13\uCA15-\uCA2F\uCA31-\uCA4B\uCA4D-\uCA67\uCA69-\uCA83\uCA85-\uCA9F\uCAA1-\uCABB\uCABD-\uCAD7\uCAD9-\uCAF3\uCAF5-\uCB0F\uCB11-\uCB2B\uCB2D-\uCB47\uCB49-\uCB63\uCB65-\uCB7F\uCB81-\uCB9B\uCB9D-\uCBB7\uCBB9-\uCBD3\uCBD5-\uCBEF\uCBF1-\uCC0B\uCC0D-\uCC27\uCC29-\uCC43\uCC45-\uCC5F\uCC61-\uCC7B\uCC7D-\uCC97\uCC99-\uCCB3\uCCB5-\uCCCF\uCCD1-\uCCEB\uCCED-\uCD07\uCD09-\uCD23\uCD25-\uCD3F\uCD41-\uCD5B\uCD5D-\uCD77\uCD79-\uCD93\uCD95-\uCDAF\uCDB1-\uCDCB\uCDCD-\uCDE7\uCDE9-\uCE03\uCE05-\uCE1F\uCE21-\uCE3B\uCE3D-\uCE57\uCE59-\uCE73\uCE75-\uCE8F\uCE91-\uCEAB\uCEAD-\uCEC7\uCEC9-\uCEE3\uCEE5-\uCEFF\uCF01-\uCF1B\uCF1D-\uCF37\uCF39-\uCF53\uCF55-\uCF6F\uCF71-\uCF8B\uCF8D-\uCFA7\uCFA9-\uCFC3\uCFC5-\uCFDF\uCFE1-\uCFFB\uCFFD-\uD017\uD019-\uD033\uD035-\uD04F\uD051-\uD06B\uD06D-\uD087\uD089-\uD0A3\uD0A5-\uD0BF\uD0C1-\uD0DB\uD0DD-\uD0F7\uD0F9-\uD113\uD115-\uD12F\uD131-\uD14B\uD14D-\uD167\uD169-\uD183\uD185-\uD19F\uD1A1-\uD1BB\uD1BD-\uD1D7\uD1D9-\uD1F3\uD1F5-\uD20F\uD211-\uD22B\uD22D-\uD247\uD249-\uD263\uD265-\uD27F\uD281-\uD29B\uD29D-\uD2B7\uD2B9-\uD2D3\uD2D5-\uD2EF\uD2F1-\uD30B\uD30D-\uD327\uD329-\uD343\uD345-\uD35F\uD361-\uD37B\uD37D-\uD397\uD399-\uD3B3\uD3B5-\uD3CF\uD3D1-\uD3EB\uD3ED-\uD407\uD409-\uD423\uD425-\uD43F\uD441-\uD45B\uD45D-\uD477\uD479-\uD493\uD495-\uD4AF\uD4B1-\uD4CB\uD4CD-\uD4E7\uD4E9-\uD503\uD505-\uD51F\uD521-\uD53B\uD53D-\uD557\uD559-\uD573\uD575-\uD58F\uD591-\uD5AB\uD5AD-\uD5C7\uD5C9-\uD5E3\uD5E5-\uD5FF\uD601-\uD61B\uD61D-\uD637\uD639-\uD653\uD655-\uD66F\uD671-\uD68B\uD68D-\uD6A7\uD6A9-\uD6C3\uD6C5-\uD6DF\uD6E1-\uD6FB\uD6FD-\uD717\uD719-\uD733\uD735-\uD74F\uD751-\uD76B\uD76D-\uD787\uD789-\uD7A3]$/,eC=/^(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u2388\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2605\u2607-\u2612\u2614-\u2685\u2690-\u2705\u2708-\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763-\u2767\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDD0F\uDD2F\uDD6C-\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDAD-\uDDE5\uDE01-\uDE0F\uDE1A\uDE2F\uDE32-\uDE3A\uDE3C-\uDE3F\uDE49-\uDFFA]|\uD83D[\uDC00-\uDD3D\uDD46-\uDE4F\uDE80-\uDEFF\uDF74-\uDF7F\uDFD5-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE-\uDCFF\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDEFF]|\uD83F[\uDC00-\uDFFD])$/,tC=(e,t)=>{var n=Lw.Any;return-1!==e.search(qw)&&(n|=Lw.Extend),8205===t&&(n|=Lw.ZWJ),t>=127462&&t<=127487&&(n|=Lw.RI),-1!==e.search(Kw)&&(n|=Lw.Prepend),-1!==e.search(Yw)&&(n|=Lw.SpacingMark),-1!==e.search(Xw)&&(n|=Lw.L),-1!==e.search(Qw)&&(n|=Lw.V),-1!==e.search(Zw)&&(n|=Lw.T),-1!==e.search(Jw)&&(n|=Lw.LV),-1!==e.search($w)&&(n|=Lw.LVT),-1!==e.search(eC)&&(n|=Lw.ExtPict),n};function nC(e,t){return!!(e&t)}var iC=[[Lw.L,Lw.L|Lw.V|Lw.LV|Lw.LVT],[Lw.LV|Lw.V,Lw.V|Lw.T],[Lw.LVT|Lw.T,Lw.T],[Lw.Any,Lw.Extend|Lw.ZWJ],[Lw.Any,Lw.SpacingMark],[Lw.Prepend,Lw.Any],[Lw.ZWJ,Lw.ExtPict],[Lw.RI,Lw.RI]];function rC(e,t){return-1===iC.findIndex((n=>nC(e,n[0])&&nC(t,n[1])))}var oC=/(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u2388\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2605\u2607-\u2612\u2614-\u2685\u2690-\u2705\u2708-\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763-\u2767\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDD0F\uDD2F\uDD6C-\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDAD-\uDDE5\uDE01-\uDE0F\uDE1A\uDE2F\uDE32-\uDE3A\uDE3C-\uDE3F\uDE49-\uDFFA]|\uD83D[\uDC00-\uDD3D\uDD46-\uDE4F\uDE80-\uDEFF\uDF74-\uDF7F\uDFD5-\uDFFF]|\uD83E[\uDC0C-\uDC0F\uDC48-\uDC4F\uDC5A-\uDC5F\uDC88-\uDC8F\uDCAE-\uDCFF\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDEFF]|\uD83F[\uDC00-\uDFFD])(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09BE\u09C1-\u09C4\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3E\u0B3F\u0B41-\u0B44\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE\u0BC0\u0BCD\u0BD7\u0C00\u0C04\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC2\u0CC6\u0CCC\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D3E\u0D41-\u0D44\u0D4D\u0D57\u0D62\u0D63\u0D81\u0DCA\u0DCF\u0DD2-\u0DD4\u0DD6\u0DDF\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1AC0\u1B00-\u1B03\u1B34-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u200C\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFF9E\uFF9F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDEAB\uDEAC\uDF46-\uDF50]|\uD804[\uDC01\uDC38-\uDC46\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDC9-\uDDCC\uDDCF\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3B\uDF3C\uDF3E\uDF40\uDF57\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDC5E\uDCB0\uDCB3-\uDCB8\uDCBA\uDCBD\uDCBF\uDCC0\uDCC2\uDCC3\uDDAF\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D-\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD806[\uDC2F-\uDC37\uDC39\uDC3A\uDD30\uDD3B\uDD3C\uDD3E\uDD43\uDDD4-\uDDD7\uDDDA\uDDDB\uDDE0\uDE01-\uDE0A\uDE33-\uDE38\uDE3B-\uDE3E\uDE47\uDE51-\uDE56\uDE59-\uDE5B\uDE8A-\uDE96\uDE98\uDE99]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD90\uDD91\uDD95\uDD97\uDEF3\uDEF4]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF8F-\uDF92\uDFE4]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD65\uDD67-\uDD69\uDD6E-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDD30-\uDD36\uDEEC-\uDEEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uD83C[\uDFFB-\uDFFF]|\uDB40[\uDC20-\uDC7F\uDD00-\uDDEF])*\u200D$/,aC=e=>-1!==e.search(oC),sC=/(?:\uD83C[\uDDE6-\uDDFF])+$/g,lC=e=>{var t=e.match(sC);return null!==t&&t[0].length/2%2==1},cC=e=>_x(e)&&xC.isNodeList(e.children)&&!vC.isEditor(e),uC={isAncestor:e=>_x(e)&&xC.isNodeList(e.children),isElement:cC,isElementList:e=>Array.isArray(e)&&e.every((e=>uC.isElement(e))),isElementProps:e=>void 0!==e.children,isElementType:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"type";return cC(e)&&e[n]===t},matches(e,t){for(var n in t)if("children"!==n&&e[n]!==t[n])return!1;return!0}},dC=["text"],pC=["text"];function hC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mC=new WeakMap,vC={above(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{voids:n=!1,mode:i="lowest",at:r=e.selection,match:o}=t;if(r){var a=vC.path(e,r),s="lowest"===i;for(var[l,c]of vC.levels(e,{at:a,voids:n,match:o,reverse:s}))if(!WC.isText(l))if(DC.isRange(r)){if(kC.isAncestor(c,r.anchor.path)&&kC.isAncestor(c,r.focus.path))return[l,c]}else if(!kC.equals(a,c))return[l,c]}},addMark(e,t,n){e.addMark(t,n)},after(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={anchor:vC.point(e,t,{edge:"end"}),focus:vC.end(e,[])},{distance:o=1}=i,a=0;for(var s of vC.positions(e,fC(fC({},i),{},{at:r}))){if(a>o)break;0!==a&&(n=s),a++}return n},before(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={anchor:vC.start(e,[]),focus:vC.point(e,t,{edge:"start"})},{distance:o=1}=i,a=0;for(var s of vC.positions(e,fC(fC({},i),{},{at:r,reverse:!0}))){if(a>o)break;0!==a&&(n=s),a++}return n},deleteBackward(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{unit:n="character"}=t;e.deleteBackward(n)},deleteForward(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{unit:n="character"}=t;e.deleteForward(n)},deleteFragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{direction:n="forward"}=t;e.deleteFragment(n)},edges:(e,t)=>[vC.start(e,t),vC.end(e,t)],end:(e,t)=>vC.point(e,t,{edge:"end"}),first(e,t){var n=vC.path(e,t,{edge:"start"});return vC.node(e,n)},fragment(e,t){var n=vC.range(e,t);return xC.fragment(e,n)},hasBlocks:(e,t)=>t.children.some((t=>uC.isElement(t)&&vC.isBlock(e,t))),hasInlines:(e,t)=>t.children.some((t=>WC.isText(t)||vC.isInline(e,t))),hasTexts:(e,t)=>t.children.every((e=>WC.isText(e))),insertBreak(e){e.insertBreak()},insertSoftBreak(e){e.insertSoftBreak()},insertFragment(e,t){e.insertFragment(t)},insertNode(e,t){e.insertNode(t)},insertText(e,t){e.insertText(t)},isBlock:(e,t)=>!e.isInline(t),isEditor(e){var t=mC.get(e);if(void 0!==t)return t;if(!_x(e))return!1;var n="function"==typeof e.addMark&&"function"==typeof e.apply&&"function"==typeof e.deleteBackward&&"function"==typeof e.deleteForward&&"function"==typeof e.deleteFragment&&"function"==typeof e.insertBreak&&"function"==typeof e.insertSoftBreak&&"function"==typeof e.insertFragment&&"function"==typeof e.insertNode&&"function"==typeof e.insertText&&"function"==typeof e.isInline&&"function"==typeof e.isVoid&&"function"==typeof e.normalizeNode&&"function"==typeof e.onChange&&"function"==typeof e.removeMark&&"function"==typeof e.getDirtyPaths&&(null===e.marks||_x(e.marks))&&(null===e.selection||DC.isRange(e.selection))&&xC.isNodeList(e.children)&&SC.isOperationList(e.operations);return mC.set(e,n),n},isEnd(e,t,n){var i=vC.end(e,n);return PC.equals(t,i)},isEdge:(e,t,n)=>vC.isStart(e,t,n)||vC.isEnd(e,t,n),isEmpty(e,t){var{children:n}=t,[i]=n;return 0===n.length||1===n.length&&WC.isText(i)&&""===i.text&&!e.isVoid(t)},isInline:(e,t)=>e.isInline(t),isNormalizing(e){var t=Pw.get(e);return void 0===t||t},isStart(e,t,n){if(0!==t.offset)return!1;var i=vC.start(e,n);return PC.equals(t,i)},isVoid:(e,t)=>e.isVoid(t),last(e,t){var n=vC.path(e,t,{edge:"end"});return vC.node(e,n)},leaf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=vC.path(e,t,n);return[xC.leaf(e,i),i]},*levels(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{at:n=e.selection,reverse:i=!1,voids:r=!1}=t,{match:o}=t;if(null==o&&(o=()=>!0),n){var a=[],s=vC.path(e,n);for(var[l,c]of xC.levels(e,s))if(o(l,c)&&(a.push([l,c]),!r&&uC.isElement(l)&&vC.isVoid(e,l)))break;i&&a.reverse(),yield*a}},marks(e){var{marks:t,selection:n}=e;if(!n)return null;if(t)return t;if(DC.isExpanded(n)){var[i]=vC.nodes(e,{match:WC.isText});if(i){var[r]=i;return Bw(r,dC)}return{}}var{anchor:o}=n,{path:a}=o,[s]=vC.leaf(e,a);if(0===o.offset){var l=vC.previous(e,{at:a,match:WC.isText}),c=vC.above(e,{match:t=>uC.isElement(t)&&vC.isVoid(e,t)&&e.markableVoid(t)});if(!c){var u=vC.above(e,{match:t=>uC.isElement(t)&&vC.isBlock(e,t)});if(l&&u){var[d,p]=l,[,h]=u;kC.isAncestor(h,p)&&(s=d)}}}return Bw(s,pC)},next(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mode:n="lowest",voids:i=!1}=t,{match:r,at:o=e.selection}=t;if(o){var a=vC.after(e,o,{voids:i});if(a){var[,s]=vC.last(e,[]),l=[a.path,s];if(kC.isPath(o)&&0===o.length)throw new Error("Cannot get the next node from the root node!");if(null==r)if(kC.isPath(o)){var[c]=vC.parent(e,o);r=e=>c.children.includes(e)}else r=()=>!0;var[u]=vC.nodes(e,{at:l,match:r,mode:n,voids:i});return u}}},node(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=vC.path(e,t,n);return[xC.get(e,i),i]},*nodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{at:n=e.selection,mode:i="all",universal:r=!1,reverse:o=!1,voids:a=!1}=t,{match:s}=t;if(s||(s=()=>!0),n){var l,c;if(gC.isSpan(n))l=n[0],c=n[1];else{var u=vC.path(e,n,{edge:"start"}),d=vC.path(e,n,{edge:"end"});l=o?d:u,c=o?u:d}var p,h=xC.nodes(e,{reverse:o,from:l,to:c,pass:t=>{var[n]=t;return!a&&uC.isElement(n)&&vC.isVoid(e,n)}}),f=[];for(var[m,v]of h){var g=p&&0===kC.compare(v,p[1]);if("highest"!==i||!g)if(s(m,v))if("lowest"===i&&g)p=[m,v];else{var y="lowest"===i?p:[m,v];y&&(r?f.push(y):yield y),p=[m,v]}else if(r&&!g&&WC.isText(m))return}"lowest"===i&&p&&(r?f.push(p):yield p),r&&(yield*f)}},normalize(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{force:n=!1,operation:i}=t,r=e=>_w.get(e)||[],o=e=>{var t=r(e).pop(),n=t.join(",");return(e=>Tw.get(e)||new Set)(e).delete(n),t};if(vC.isNormalizing(e)){if(n){var a=Array.from(xC.nodes(e),(e=>{var[,t]=e;return t})),s=new Set(a.map((e=>e.join(","))));_w.set(e,a),Tw.set(e,s)}0!==r(e).length&&vC.withoutNormalizing(e,(()=>{for(var t of r(e))if(xC.has(e,t)){var n=vC.node(e,t),[a,s]=n;uC.isElement(a)&&0===a.children.length&&e.normalizeNode(n,{operation:i})}for(var l=r(e),c=l.length,u=0;0!==l.length;){if(!e.shouldNormalize({dirtyPaths:l,iteration:u,initialDirtyPathsLength:c,operation:i}))return;var d=o(e);if(xC.has(e,d)){var p=vC.node(e,d);e.normalizeNode(p,{operation:i})}u++,l=r(e)}}))}},parent(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=vC.path(e,t,n),r=kC.parent(i);return vC.node(e,r)},path(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{depth:i,edge:r}=n;if(kC.isPath(t))if("start"===r){var[,o]=xC.first(e,t);t=o}else if("end"===r){var[,a]=xC.last(e,t);t=a}return DC.isRange(t)&&(t="start"===r?DC.start(t):"end"===r?DC.end(t):kC.common(t.anchor.path,t.focus.path)),PC.isPoint(t)&&(t=t.path),null!=i&&(t=t.slice(0,i)),t},hasPath:(e,t)=>xC.has(e,t),pathRef(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{affinity:i="forward"}=n,r={current:t,affinity:i,unref(){var{current:t}=r;return vC.pathRefs(e).delete(r),r.current=null,t}};return vC.pathRefs(e).add(r),r},pathRefs(e){var t=Nw.get(e);return t||(t=new Set,Nw.set(e,t)),t},point(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{edge:i="start"}=n;if(kC.isPath(t)){var r;if("end"===i){var[,o]=xC.last(e,t);r=o}else{var[,a]=xC.first(e,t);r=a}var s=xC.get(e,r);if(!WC.isText(s))throw new Error("Cannot get the ".concat(i," point in the node at path [").concat(t,"] because it has no ").concat(i," text node."));return{path:r,offset:"end"===i?s.text.length:0}}if(DC.isRange(t)){var[l,c]=DC.edges(t);return"start"===i?l:c}return t},pointRef(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{affinity:i="forward"}=n,r={current:t,affinity:i,unref(){var{current:t}=r;return vC.pointRefs(e).delete(r),r.current=null,t}};return vC.pointRefs(e).add(r),r},pointRefs(e){var t=Mw.get(e);return t||(t=new Set,Mw.set(e,t)),t},*positions(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{at:n=e.selection,unit:i="offset",reverse:r=!1,voids:o=!1}=t;if(n){var a=vC.range(e,n),[s,l]=DC.edges(a),c=r?l:s,u=!1,d="",p=0,h=0,f=0;for(var[m,v]of vC.nodes(e,{at:n,reverse:r,voids:o})){if(uC.isElement(m)){if(!o&&e.isVoid(m)){yield vC.start(e,v);continue}if(e.isInline(m))continue;if(vC.hasInlines(e,m)){var g=kC.isAncestor(v,l.path)?l:vC.end(e,v),y=kC.isAncestor(v,s.path)?s:vC.start(e,v);d=vC.string(e,{anchor:y,focus:g},{voids:o}),u=!0}}if(WC.isText(m)){var b=kC.equals(v,c.path);for(b?(h=r?c.offset:m.text.length-c.offset,f=c.offset):(h=m.text.length,f=r?h:0),(b||u||"offset"===i)&&(yield{path:v,offset:f},u=!1);;){if(0===p){if(""===d)break;p=E(d,i,r),d=Uw(d,p,r)[1]}if(f=r?f-p:f+p,(h-=p)<0){p=-h;break}p=0,yield{path:v,offset:f}}}}}function E(e,t,n){return"character"===t?Ow(e,n):"word"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0,i=!1;e.length>0;){var r=Ow(e,t),[o,a]=Uw(e,r,t);if(Ww(o,a,t))i=!0,n+=r;else{if(i)break;n+=r}e=a}return n}(e,n):"line"===t||"block"===t?e.length:1}},previous(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mode:n="lowest",voids:i=!1}=t,{match:r,at:o=e.selection}=t;if(o){var a=vC.before(e,o,{voids:i});if(a){var[,s]=vC.first(e,[]),l=[a.path,s];if(kC.isPath(o)&&0===o.length)throw new Error("Cannot get the previous node from the root node!");if(null==r)if(kC.isPath(o)){var[c]=vC.parent(e,o);r=e=>c.children.includes(e)}else r=()=>!0;var[u]=vC.nodes(e,{reverse:!0,at:l,match:r,mode:n,voids:i});return u}}},range:(e,t,n)=>DC.isRange(t)&&!n?t:{anchor:vC.start(e,t),focus:vC.end(e,n||t)},rangeRef(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{affinity:i="forward"}=n,r={current:t,affinity:i,unref(){var{current:t}=r;return vC.rangeRefs(e).delete(r),r.current=null,t}};return vC.rangeRefs(e).add(r),r},rangeRefs(e){var t=Aw.get(e);return t||(t=new Set,Aw.set(e,t)),t},removeMark(e,t){e.removeMark(t)},setNormalizing(e,t){Pw.set(e,t)},start:(e,t)=>vC.point(e,t,{edge:"start"}),string(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{voids:i=!1}=n,r=vC.range(e,t),[o,a]=DC.edges(r),s="";for(var[l,c]of vC.nodes(e,{at:r,match:WC.isText,voids:i})){var u=l.text;kC.equals(c,a.path)&&(u=u.slice(0,a.offset)),kC.equals(c,o.path)&&(u=u.slice(o.offset)),s+=u}return s},unhangRange(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{voids:i=!1}=n,[r,o]=DC.edges(t);if(0!==r.offset||0!==o.offset||DC.isCollapsed(t)||kC.hasPrevious(o.path))return t;var a=vC.above(e,{at:o,match:t=>uC.isElement(t)&&vC.isBlock(e,t),voids:i}),s=a?a[1]:[],l={anchor:vC.start(e,r),focus:o},c=!0;for(var[u,d]of vC.nodes(e,{at:l,match:WC.isText,reverse:!0,voids:i}))if(c)c=!1;else if(""!==u.text||kC.isBefore(d,s)){o={path:d,offset:u.text.length};break}return{anchor:r,focus:o}},void(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return vC.above(e,fC(fC({},t),{},{match:t=>uC.isElement(t)&&vC.isVoid(e,t)}))},withoutNormalizing(e,t){var n=vC.isNormalizing(e);vC.setNormalizing(e,!1);try{t()}finally{vC.setNormalizing(e,n)}vC.normalize(e)}},gC={isSpan:e=>Array.isArray(e)&&2===e.length&&e.every(kC.isPath)},yC=["children"],bC=["text"],EC=new WeakMap,xC={ancestor(e,t){var n=xC.get(e,t);if(WC.isText(n))throw new Error("Cannot get the ancestor node at path [".concat(t,"] because it refers to a text node instead: ").concat(LC.stringify(n)));return n},*ancestors(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var i of kC.ancestors(t,n)){var r=[xC.ancestor(e,i),i];yield r}},child(e,t){if(WC.isText(e))throw new Error("Cannot get the child of a text node: ".concat(LC.stringify(e)));var n=e.children[t];if(null==n)throw new Error("Cannot get child at index `".concat(t,"` in node: ").concat(LC.stringify(e)));return n},*children(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{reverse:i=!1}=n,r=xC.ancestor(e,t),{children:o}=r,a=i?o.length-1:0;i?a>=0:a<o.length;){var s=xC.child(r,a),l=t.concat(a);yield[s,l],a=i?a-1:a+1}},common(e,t,n){var i=kC.common(t,n);return[xC.get(e,i),i]},descendant(e,t){var n=xC.get(e,t);if(vC.isEditor(n))throw new Error("Cannot get the descendant node at path [".concat(t,"] because it refers to the root editor node instead: ").concat(LC.stringify(n)));return n},*descendants(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var[n,i]of xC.nodes(e,t))0!==i.length&&(yield[n,i])},*elements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var[n,i]of xC.nodes(e,t))uC.isElement(n)&&(yield[n,i])},extractProps:e=>uC.isAncestor(e)?Bw(e,yC):Bw(e,bC),first(e,t){for(var n=t.slice(),i=xC.get(e,n);i&&!WC.isText(i)&&0!==i.children.length;)i=i.children[0],n.push(0);return[i,n]},fragment(e,t){if(WC.isText(e))throw new Error("Cannot get a fragment starting from a root text node: ".concat(LC.stringify(e)));var n=ww({children:e.children},(e=>{var[n,i]=DC.edges(t),r=xC.nodes(e,{reverse:!0,pass:e=>{var[,n]=e;return!DC.includes(t,n)}});for(var[,o]of r){if(!DC.includes(t,o)){var a=xC.parent(e,o),s=o[o.length-1];a.children.splice(s,1)}if(kC.equals(o,i.path)){var l=xC.leaf(e,o);l.text=l.text.slice(0,i.offset)}if(kC.equals(o,n.path)){var c=xC.leaf(e,o);c.text=c.text.slice(n.offset)}}vC.isEditor(e)&&(e.selection=null)}));return n.children},get(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(WC.isText(n)||!n.children[r])throw new Error("Cannot find a descendant at path [".concat(t,"] in node: ").concat(LC.stringify(e)));n=n.children[r]}return n},has(e,t){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(WC.isText(n)||!n.children[r])return!1;n=n.children[r]}return!0},isNode:e=>WC.isText(e)||uC.isElement(e)||vC.isEditor(e),isNodeList(e){if(!Array.isArray(e))return!1;var t=EC.get(e);if(void 0!==t)return t;var n=e.every((e=>xC.isNode(e)));return EC.set(e,n),n},last(e,t){for(var n=t.slice(),i=xC.get(e,n);i&&!WC.isText(i)&&0!==i.children.length;){var r=i.children.length-1;i=i.children[r],n.push(r)}return[i,n]},leaf(e,t){var n=xC.get(e,t);if(!WC.isText(n))throw new Error("Cannot get the leaf node at path [".concat(t,"] because it refers to a non-leaf node: ").concat(LC.stringify(n)));return n},*levels(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(var i of kC.levels(t,n)){var r=xC.get(e,i);yield[r,i]}},matches:(e,t)=>uC.isElement(e)&&uC.isElementProps(t)&&uC.matches(e,t)||WC.isText(e)&&WC.isTextProps(t)&&WC.matches(e,t),*nodes(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{pass:n,reverse:i=!1}=t,{from:r=[],to:o}=t,a=new Set,s=[],l=e;!o||!(i?kC.isBefore(s,o):kC.isAfter(s,o));)if(a.has(l)||(yield[l,s]),a.has(l)||WC.isText(l)||0===l.children.length||null!=n&&!1!==n([l,s])){if(0===s.length)break;if(!i){var c=kC.next(s);if(xC.has(e,c)){s=c,l=xC.get(e,s);continue}}i&&0!==s[s.length-1]?(s=kC.previous(s),l=xC.get(e,s)):(s=kC.parent(s),l=xC.get(e,s),a.add(l))}else{a.add(l);var u=i?l.children.length-1:0;kC.isAncestor(s,r)&&(u=r[s.length]),s=s.concat(u),l=xC.get(e,s)}},parent(e,t){var n=kC.parent(t),i=xC.get(e,n);if(WC.isText(i))throw new Error("Cannot get the parent of path [".concat(t,"] because it does not exist in the root."));return i},string:e=>WC.isText(e)?e.text:e.children.map(xC.string).join(""),*texts(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var[n,i]of xC.nodes(e,t))WC.isText(n)&&(yield[n,i])}};function wC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function CC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var SC={isNodeOperation:e=>SC.isOperation(e)&&e.type.endsWith("_node"),isOperation(e){if(!_x(e))return!1;switch(e.type){case"insert_node":case"remove_node":return kC.isPath(e.path)&&xC.isNode(e.node);case"insert_text":case"remove_text":return"number"==typeof e.offset&&"string"==typeof e.text&&kC.isPath(e.path);case"merge_node":return"number"==typeof e.position&&kC.isPath(e.path)&&_x(e.properties);case"move_node":return kC.isPath(e.path)&&kC.isPath(e.newPath);case"set_node":return kC.isPath(e.path)&&_x(e.properties)&&_x(e.newProperties);case"set_selection":return null===e.properties&&DC.isRange(e.newProperties)||null===e.newProperties&&DC.isRange(e.properties)||_x(e.properties)&&_x(e.newProperties);case"split_node":return kC.isPath(e.path)&&"number"==typeof e.position&&_x(e.properties);default:return!1}},isOperationList:e=>Array.isArray(e)&&e.every((e=>SC.isOperation(e))),isSelectionOperation:e=>SC.isOperation(e)&&e.type.endsWith("_selection"),isTextOperation:e=>SC.isOperation(e)&&e.type.endsWith("_text"),inverse(e){switch(e.type){case"insert_node":return CC(CC({},e),{},{type:"remove_node"});case"insert_text":return CC(CC({},e),{},{type:"remove_text"});case"merge_node":return CC(CC({},e),{},{type:"split_node",path:kC.previous(e.path)});case"move_node":var{newPath:t,path:n}=e;if(kC.equals(t,n))return e;if(kC.isSibling(n,t))return CC(CC({},e),{},{path:t,newPath:n});var i=kC.transform(n,e),r=kC.transform(kC.next(n),e);return CC(CC({},e),{},{path:i,newPath:r});case"remove_node":return CC(CC({},e),{},{type:"insert_node"});case"remove_text":return CC(CC({},e),{},{type:"insert_text"});case"set_node":var{properties:o,newProperties:a}=e;return CC(CC({},e),{},{properties:a,newProperties:o});case"set_selection":var{properties:s,newProperties:l}=e;return CC(CC({},e),{},null==s?{properties:l,newProperties:null}:null==l?{properties:null,newProperties:s}:{properties:l,newProperties:s});case"split_node":return CC(CC({},e),{},{type:"merge_node",path:kC.next(e.path)})}}},kC={ancestors(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reverse:n=!1}=t,i=kC.levels(e,t);return n?i.slice(1):i.slice(0,-1)},common(e,t){for(var n=[],i=0;i<e.length&&i<t.length;i++){var r=e[i];if(r!==t[i])break;n.push(r)}return n},compare(e,t){for(var n=Math.min(e.length,t.length),i=0;i<n;i++){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1}return 0},endsAfter(e,t){var n=e.length-1,i=e.slice(0,n),r=t.slice(0,n),o=e[n],a=t[n];return kC.equals(i,r)&&o>a},endsAt(e,t){var n=e.length,i=e.slice(0,n),r=t.slice(0,n);return kC.equals(i,r)},endsBefore(e,t){var n=e.length-1,i=e.slice(0,n),r=t.slice(0,n),o=e[n],a=t[n];return kC.equals(i,r)&&o<a},equals:(e,t)=>e.length===t.length&&e.every(((e,n)=>e===t[n])),hasPrevious:e=>e[e.length-1]>0,isAfter:(e,t)=>1===kC.compare(e,t),isAncestor:(e,t)=>e.length<t.length&&0===kC.compare(e,t),isBefore:(e,t)=>-1===kC.compare(e,t),isChild:(e,t)=>e.length===t.length+1&&0===kC.compare(e,t),isCommon:(e,t)=>e.length<=t.length&&0===kC.compare(e,t),isDescendant:(e,t)=>e.length>t.length&&0===kC.compare(e,t),isParent:(e,t)=>e.length+1===t.length&&0===kC.compare(e,t),isPath:e=>Array.isArray(e)&&(0===e.length||"number"==typeof e[0]),isSibling(e,t){if(e.length!==t.length)return!1;var n=e.slice(0,-1),i=t.slice(0,-1);return e[e.length-1]!==t[t.length-1]&&kC.equals(n,i)},levels(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reverse:n=!1}=t,i=[],r=0;r<=e.length;r++)i.push(e.slice(0,r));return n&&i.reverse(),i},next(e){if(0===e.length)throw new Error("Cannot get the next path of a root path [".concat(e,"], because it has no next index."));var t=e[e.length-1];return e.slice(0,-1).concat(t+1)},operationCanTransformPath(e){switch(e.type){case"insert_node":case"remove_node":case"merge_node":case"split_node":case"move_node":return!0;default:return!1}},parent(e){if(0===e.length)throw new Error("Cannot get the parent path of the root path [".concat(e,"]."));return e.slice(0,-1)},previous(e){if(0===e.length)throw new Error("Cannot get the previous path of a root path [".concat(e,"], because it has no previous index."));var t=e[e.length-1];if(t<=0)throw new Error("Cannot get the previous path of a first child path [".concat(e,"] because it would result in a negative index."));return e.slice(0,-1).concat(t-1)},relative(e,t){if(!kC.isAncestor(t,e)&&!kC.equals(e,t))throw new Error("Cannot get the relative path of [".concat(e,"] inside ancestor [").concat(t,"], because it is not above or equal to the path."));return e.slice(t.length)},transform(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return null;var i=[...e],{affinity:r="forward"}=n;if(0===e.length)return i;switch(t.type){case"insert_node":var{path:o}=t;(kC.equals(o,i)||kC.endsBefore(o,i)||kC.isAncestor(o,i))&&(i[o.length-1]+=1);break;case"remove_node":var{path:a}=t;if(kC.equals(a,i)||kC.isAncestor(a,i))return null;kC.endsBefore(a,i)&&(i[a.length-1]-=1);break;case"merge_node":var{path:s,position:l}=t;kC.equals(s,i)||kC.endsBefore(s,i)?i[s.length-1]-=1:kC.isAncestor(s,i)&&(i[s.length-1]-=1,i[s.length]+=l);break;case"split_node":var{path:c,position:u}=t;if(kC.equals(c,i)){if("forward"===r)i[i.length-1]+=1;else if("backward"!==r)return null}else kC.endsBefore(c,i)?i[c.length-1]+=1:kC.isAncestor(c,i)&&e[c.length]>=u&&(i[c.length-1]+=1,i[c.length]-=u);break;case"move_node":var{path:d,newPath:p}=t;if(kC.equals(d,p))return i;if(kC.isAncestor(d,i)||kC.equals(d,i)){var h=p.slice();return kC.endsBefore(d,p)&&d.length<p.length&&(h[d.length-1]-=1),h.concat(i.slice(d.length))}kC.isSibling(d,p)&&(kC.isAncestor(p,i)||kC.equals(p,i))?kC.endsBefore(d,i)?i[d.length-1]-=1:i[d.length-1]+=1:kC.endsBefore(p,i)||kC.equals(p,i)||kC.isAncestor(p,i)?(kC.endsBefore(d,i)&&(i[d.length-1]-=1),i[p.length-1]+=1):kC.endsBefore(d,i)&&(kC.equals(p,i)&&(i[p.length-1]+=1),i[d.length-1]-=1)}return i}},_C={transform(e,t){var{current:n,affinity:i}=e;if(null!=n){var r=kC.transform(n,t,{affinity:i});e.current=r,null==r&&e.unref()}}};function TC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function IC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var PC={compare(e,t){var n=kC.compare(e.path,t.path);return 0===n?e.offset<t.offset?-1:e.offset>t.offset?1:0:n},isAfter:(e,t)=>1===PC.compare(e,t),isBefore:(e,t)=>-1===PC.compare(e,t),equals:(e,t)=>e.offset===t.offset&&kC.equals(e.path,t.path),isPoint:e=>_x(e)&&"number"==typeof e.offset&&kC.isPath(e.path),transform(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ww(e,(e=>{if(null===e)return null;var{affinity:i="forward"}=n,{path:r,offset:o}=e;switch(t.type){case"insert_node":case"move_node":e.path=kC.transform(r,t,n);break;case"insert_text":kC.equals(t.path,r)&&(t.offset<o||t.offset===o&&"forward"===i)&&(e.offset+=t.text.length);break;case"merge_node":kC.equals(t.path,r)&&(e.offset+=t.position),e.path=kC.transform(r,t,n);break;case"remove_text":kC.equals(t.path,r)&&t.offset<=o&&(e.offset-=Math.min(o-t.offset,t.text.length));break;case"remove_node":if(kC.equals(t.path,r)||kC.isAncestor(t.path,r))return null;e.path=kC.transform(r,t,n);break;case"split_node":if(kC.equals(t.path,r)){if(t.position===o&&null==i)return null;(t.position<o||t.position===o&&"forward"===i)&&(e.offset-=t.position,e.path=kC.transform(r,t,IC(IC({},n),{},{affinity:"forward"})))}else e.path=kC.transform(r,t,n)}}))}},NC={transform(e,t){var{current:n,affinity:i}=e;if(null!=n){var r=PC.transform(n,t,{affinity:i});e.current=r,null==r&&e.unref()}}},MC=["anchor","focus"];function AC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var DC={edges(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reverse:n=!1}=t,{anchor:i,focus:r}=e;return DC.isBackward(e)===n?[i,r]:[r,i]},end(e){var[,t]=DC.edges(e);return t},equals:(e,t)=>PC.equals(e.anchor,t.anchor)&&PC.equals(e.focus,t.focus),includes(e,t){if(DC.isRange(t)){if(DC.includes(e,t.anchor)||DC.includes(e,t.focus))return!0;var[n,i]=DC.edges(e),[r,o]=DC.edges(t);return PC.isBefore(n,r)&&PC.isAfter(i,o)}var[a,s]=DC.edges(e),l=!1,c=!1;return PC.isPoint(t)?(l=PC.compare(t,a)>=0,c=PC.compare(t,s)<=0):(l=kC.compare(t,a.path)>=0,c=kC.compare(t,s.path)<=0),l&&c},intersection(e,t){var n=Bw(e,MC),[i,r]=DC.edges(e),[o,a]=DC.edges(t),s=PC.isBefore(i,o)?o:i,l=PC.isBefore(r,a)?r:a;return PC.isBefore(l,s)?null:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({anchor:s,focus:l},n)},isBackward(e){var{anchor:t,focus:n}=e;return PC.isAfter(t,n)},isCollapsed(e){var{anchor:t,focus:n}=e;return PC.equals(t,n)},isExpanded:e=>!DC.isCollapsed(e),isForward:e=>!DC.isBackward(e),isRange:e=>_x(e)&&PC.isPoint(e.anchor)&&PC.isPoint(e.focus),*points(e){yield[e.anchor,"anchor"],yield[e.focus,"focus"]},start(e){var[t]=DC.edges(e);return t},transform(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ww(e,(e=>{if(null===e)return null;var i,r,{affinity:o="inward"}=n;if("inward"===o){var a=DC.isCollapsed(e);DC.isForward(e)?(i="forward",r=a?i:"backward"):(i="backward",r=a?i:"forward")}else"outward"===o?DC.isForward(e)?(i="backward",r="forward"):(i="forward",r="backward"):(i=o,r=o);var s=PC.transform(e.anchor,t,{affinity:i}),l=PC.transform(e.focus,t,{affinity:r});if(!s||!l)return null;e.anchor=s,e.focus=l}))}},RC={transform(e,t){var{current:n,affinity:i}=e;if(null!=n){var r=DC.transform(n,t,{affinity:i});e.current=r,null==r&&e.unref()}}},BC=void 0,LC={setScrubber(e){BC=e},stringify:e=>JSON.stringify(e,BC)},OC=(e,t)=>{for(var n in e){var i=e[n],r=t[n];if(_x(i)&&_x(r)){if(!OC(i,r))return!1}else if(Array.isArray(i)&&Array.isArray(r)){if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(i[o]!==r[o])return!1}else if(i!==r)return!1}for(var a in t)if(void 0===e[a]&&void 0!==t[a])return!1;return!0},FC=["text"],zC=["anchor","focus"];function HC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function UC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var WC={equals(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{loose:i=!1}=n;function r(e){return Bw(e,FC)}return OC(i?r(e):e,i?r(t):t)},isText:e=>_x(e)&&"string"==typeof e.text,isTextList:e=>Array.isArray(e)&&e.every((e=>WC.isText(e))),isTextProps:e=>void 0!==e.text,matches(e,t){for(var n in t)if("text"!==n&&(!e.hasOwnProperty(n)||e[n]!==t[n]))return!1;return!0},decorations(e,t){var n=[UC({},e)];for(var i of t){var r=Bw(i,zC),[o,a]=DC.edges(i),s=[],l=0,c=o.offset,u=a.offset;for(var d of n){var{length:p}=d.text,h=l;if(l+=p,c<=h&&l<=u)Object.assign(d,r),s.push(d);else if(c!==u&&(c===l||u===h)||c>l||u<h||u===h&&0!==h)s.push(d);else{var f=d,m=void 0,v=void 0;if(u<l){var g=u-h;v=UC(UC({},f),{},{text:f.text.slice(g)}),f=UC(UC({},f),{},{text:f.text.slice(0,g)})}if(c>h){var y=c-h;m=UC(UC({},f),{},{text:f.text.slice(0,y)}),f=UC(UC({},f),{},{text:f.text.slice(y)})}Object.assign(f,r),m&&s.push(m),s.push(f),v&&s.push(v)}}n=s}return n}};function VC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function jC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var GC={transform(e,t){e.children=Cw(e.children);var n=e.selection&&Cw(e.selection);try{n=((e,t,n)=>{switch(n.type){case"insert_node":var{path:i,node:r}=n,o=xC.parent(e,i),a=i[i.length-1];if(a>o.children.length)throw new Error('Cannot apply an "insert_node" operation at path ['.concat(i,"] because the destination is past the end of the node."));if(o.children.splice(a,0,r),t)for(var[s,l]of DC.points(t))t[l]=PC.transform(s,n);break;case"insert_text":var{path:c,offset:u,text:d}=n;if(0===d.length)break;var p=xC.leaf(e,c),h=p.text.slice(0,u),f=p.text.slice(u);if(p.text=h+d+f,t)for(var[m,v]of DC.points(t))t[v]=PC.transform(m,n);break;case"merge_node":var{path:g}=n,y=xC.get(e,g),b=kC.previous(g),E=xC.get(e,b),x=xC.parent(e,g),w=g[g.length-1];if(WC.isText(y)&&WC.isText(E))E.text+=y.text;else{if(WC.isText(y)||WC.isText(E))throw new Error('Cannot apply a "merge_node" operation at path ['.concat(g,"] to nodes of different interfaces: ").concat(LC.stringify(y)," ").concat(LC.stringify(E)));E.children.push(...y.children)}if(x.children.splice(w,1),t)for(var[C,S]of DC.points(t))t[S]=PC.transform(C,n);break;case"move_node":var{path:k,newPath:_}=n;if(kC.isAncestor(k,_))throw new Error("Cannot move a path [".concat(k,"] to new path [").concat(_,"] because the destination is inside itself."));var T=xC.get(e,k),I=xC.parent(e,k),P=k[k.length-1];I.children.splice(P,1);var N=kC.transform(k,n),M=xC.get(e,kC.parent(N)),A=N[N.length-1];if(M.children.splice(A,0,T),t)for(var[D,R]of DC.points(t))t[R]=PC.transform(D,n);break;case"remove_node":var{path:B}=n,L=B[B.length-1];if(xC.parent(e,B).children.splice(L,1),t)for(var[O,F]of DC.points(t)){var z=PC.transform(O,n);if(null!=t&&null!=z)t[F]=z;else{var H=void 0,U=void 0;for(var[W,V]of xC.texts(e)){if(-1!==kC.compare(V,B)){U=[W,V];break}H=[W,V]}var j=!1;H&&U&&(j=kC.equals(U[1],B)?!kC.hasPrevious(U[1]):kC.common(H[1],B).length<kC.common(U[1],B).length),H&&!j?(O.path=H[1],O.offset=H[0].text.length):U?(O.path=U[1],O.offset=0):t=null}}break;case"remove_text":var{path:G,offset:q,text:K}=n;if(0===K.length)break;var Y=xC.leaf(e,G),X=Y.text.slice(0,q),Q=Y.text.slice(q+K.length);if(Y.text=X+Q,t)for(var[Z,J]of DC.points(t))t[J]=PC.transform(Z,n);break;case"set_node":var{path:$,properties:ee,newProperties:te}=n;if(0===$.length)throw new Error("Cannot set properties on the root node!");var ne=xC.get(e,$);for(var ie in te){if("children"===ie||"text"===ie)throw new Error('Cannot set the "'.concat(ie,'" property of nodes!'));var re=te[ie];null==re?delete ne[ie]:ne[ie]=re}for(var oe in ee)te.hasOwnProperty(oe)||delete ne[oe];break;case"set_selection":var{newProperties:ae}=n;if(null==ae)t=ae;else{if(null==t){if(!DC.isRange(ae))throw new Error('Cannot apply an incomplete "set_selection" operation properties '.concat(LC.stringify(ae)," when there is no current selection."));t=jC({},ae)}for(var se in ae){var le=ae[se];if(null==le){if("anchor"===se||"focus"===se)throw new Error('Cannot remove the "'.concat(se,'" selection property'));delete t[se]}else t[se]=le}}break;case"split_node":var{path:ce,position:ue,properties:de}=n;if(0===ce.length)throw new Error('Cannot apply a "split_node" operation at path ['.concat(ce,"] because the root node cannot be split."));var pe,he=xC.get(e,ce),fe=xC.parent(e,ce),me=ce[ce.length-1];if(WC.isText(he)){var ve=he.text.slice(0,ue),ge=he.text.slice(ue);he.text=ve,pe=jC(jC({},de),{},{text:ge})}else{var ye=he.children.slice(0,ue),be=he.children.slice(ue);he.children=ye,pe=jC(jC({},de),{},{children:be})}if(fe.children.splice(me+1,0,pe),t)for(var[Ee,xe]of DC.points(t))t[xe]=PC.transform(Ee,n)}return t})(e,n,t)}finally{e.children=Sw(e.children),e.selection=n?Ix(n)?Sw(n):n:null}}},qC=["text"],KC=["children"];function YC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function XC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YC(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YC(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var QC={insertNodes(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vC.withoutNormalizing(e,(()=>{var{hanging:i=!1,voids:r=!1,mode:o="lowest"}=n,{at:a,match:s,select:l}=n;if(xC.isNode(t)&&(t=[t]),0!==t.length){var[c]=t;if(a||(a=e.selection?e.selection:e.children.length>0?vC.end(e,[]):[0],l=!0),null==l&&(l=!1),DC.isRange(a))if(i||(a=vC.unhangRange(e,a,{voids:r})),DC.isCollapsed(a))a=a.anchor;else{var[,u]=DC.edges(a),d=vC.pointRef(e,u);aS.delete(e,{at:a}),a=d.unref()}if(PC.isPoint(a)){null==s&&(s=WC.isText(c)?e=>WC.isText(e):e.isInline(c)?t=>WC.isText(t)||vC.isInline(e,t):t=>uC.isElement(t)&&vC.isBlock(e,t));var[p]=vC.nodes(e,{at:a.path,match:s,mode:o,voids:r});if(!p)return;var[,h]=p,f=vC.pathRef(e,h),m=vC.isEnd(e,a,h);aS.splitNodes(e,{at:a,match:s,mode:o,voids:r});var v=f.unref();a=m?kC.next(v):v}var g=kC.parent(a),y=a[a.length-1];if(r||!vC.void(e,{at:g})){for(var b of t){var E=g.concat(y);y++,e.apply({type:"insert_node",path:E,node:b}),a=kC.next(a)}if(a=kC.previous(a),l){var x=vC.end(e,a);x&&aS.select(e,x)}}}}))},liftNodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{at:n=e.selection,mode:i="lowest",voids:r=!1}=t,{match:o}=t;if(null==o&&(o=kC.isPath(n)?$C(e,n):t=>uC.isElement(t)&&vC.isBlock(e,t)),n){var a=vC.nodes(e,{at:n,match:o,mode:i,voids:r}),s=Array.from(a,(t=>{var[,n]=t;return vC.pathRef(e,n)}));for(var l of s){var c=l.unref();if(c.length<2)throw new Error("Cannot lift node at a path [".concat(c,"] because it has a depth of less than `2`."));var u=vC.node(e,kC.parent(c)),[d,p]=u,h=c[c.length-1],{length:f}=d.children;if(1===f){var m=kC.next(p);aS.moveNodes(e,{at:c,to:m,voids:r}),aS.removeNodes(e,{at:p,voids:r})}else if(0===h)aS.moveNodes(e,{at:c,to:p,voids:r});else if(h===f-1){var v=kC.next(p);aS.moveNodes(e,{at:c,to:v,voids:r})}else{var g=kC.next(c),y=kC.next(p);aS.splitNodes(e,{at:g,voids:r}),aS.moveNodes(e,{at:c,to:y,voids:r})}}}}))},mergeNodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{match:n,at:i=e.selection}=t,{hanging:r=!1,voids:o=!1,mode:a="lowest"}=t;if(i){if(null==n)if(kC.isPath(i)){var[s]=vC.parent(e,i);n=e=>s.children.includes(e)}else n=t=>uC.isElement(t)&&vC.isBlock(e,t);if(!r&&DC.isRange(i)&&(i=vC.unhangRange(e,i,{voids:o})),DC.isRange(i))if(DC.isCollapsed(i))i=i.anchor;else{var[,l]=DC.edges(i),c=vC.pointRef(e,l);aS.delete(e,{at:i}),i=c.unref(),null==t.at&&aS.select(e,i)}var[u]=vC.nodes(e,{at:i,match:n,voids:o,mode:a}),d=vC.previous(e,{at:i,match:n,voids:o,mode:a});if(u&&d){var[p,h]=u,[f,m]=d;if(0!==h.length&&0!==m.length){var v,g,y=kC.next(m),b=kC.common(h,m),E=kC.isSibling(h,m),x=Array.from(vC.levels(e,{at:h}),(e=>{var[t]=e;return t})).slice(b.length).slice(0,-1),w=vC.above(e,{at:h,mode:"highest",match:t=>x.includes(t)&&ZC(e,t)}),C=w&&vC.pathRef(e,w[1]);if(WC.isText(p)&&WC.isText(f)){var S=Bw(p,qC);g=f.text.length,v=S}else{if(!uC.isElement(p)||!uC.isElement(f))throw new Error("Cannot merge the node at path [".concat(h,"] with the previous sibling because it is not the same kind: ").concat(LC.stringify(p)," ").concat(LC.stringify(f)));S=Bw(p,KC),g=f.children.length,v=S}E||aS.moveNodes(e,{at:h,to:y,voids:o}),C&&aS.removeNodes(e,{at:C.current,voids:o}),uC.isElement(f)&&vC.isEmpty(e,f)||WC.isText(f)&&""===f.text&&0!==m[m.length-1]?aS.removeNodes(e,{at:m,voids:o}):e.apply({type:"merge_node",path:y,position:g,properties:v}),C&&C.unref()}}}}))},moveNodes(e,t){vC.withoutNormalizing(e,(()=>{var{to:n,at:i=e.selection,mode:r="lowest",voids:o=!1}=t,{match:a}=t;if(i){null==a&&(a=kC.isPath(i)?$C(e,i):t=>uC.isElement(t)&&vC.isBlock(e,t));var s=vC.pathRef(e,n),l=vC.nodes(e,{at:i,match:a,mode:r,voids:o}),c=Array.from(l,(t=>{var[,n]=t;return vC.pathRef(e,n)}));for(var u of c){var d=u.unref(),p=s.current;0!==d.length&&e.apply({type:"move_node",path:d,newPath:p}),s.current&&kC.isSibling(p,d)&&kC.isAfter(p,d)&&(s.current=kC.next(s.current))}s.unref()}}))},removeNodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{hanging:n=!1,voids:i=!1,mode:r="lowest"}=t,{at:o=e.selection,match:a}=t;if(o){null==a&&(a=kC.isPath(o)?$C(e,o):t=>uC.isElement(t)&&vC.isBlock(e,t)),!n&&DC.isRange(o)&&(o=vC.unhangRange(e,o,{voids:i}));var s=vC.nodes(e,{at:o,match:a,mode:r,voids:i}),l=Array.from(s,(t=>{var[,n]=t;return vC.pathRef(e,n)}));for(var c of l){var u=c.unref();if(u){var[d]=vC.node(e,u);e.apply({type:"remove_node",path:u,node:d})}}}}))},setNodes(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vC.withoutNormalizing(e,(()=>{var{match:i,at:r=e.selection,compare:o,merge:a}=n,{hanging:s=!1,mode:l="lowest",split:c=!1,voids:u=!1}=n;if(r){if(null==i&&(i=kC.isPath(r)?$C(e,r):t=>uC.isElement(t)&&vC.isBlock(e,t)),!s&&DC.isRange(r)&&(r=vC.unhangRange(e,r,{voids:u})),c&&DC.isRange(r)){if(DC.isCollapsed(r)&&vC.leaf(e,r.anchor)[0].text.length>0)return;var d=vC.rangeRef(e,r,{affinity:"inward"}),[p,h]=DC.edges(r),f="lowest"===l?"lowest":"highest",m=vC.isEnd(e,h,h.path);aS.splitNodes(e,{at:h,match:i,mode:f,voids:u,always:!m});var v=vC.isStart(e,p,p.path);aS.splitNodes(e,{at:p,match:i,mode:f,voids:u,always:!v}),r=d.unref(),null==n.at&&aS.select(e,r)}for(var[g,y]of(o||(o=(e,t)=>e!==t),vC.nodes(e,{at:r,match:i,mode:l,voids:u}))){var b={},E={};if(0!==y.length){var x=!1;for(var w in t)"children"!==w&&"text"!==w&&o(t[w],g[w])&&(x=!0,g.hasOwnProperty(w)&&(b[w]=g[w]),a?null!=t[w]&&(E[w]=a(g[w],t[w])):null!=t[w]&&(E[w]=t[w]));x&&e.apply({type:"set_node",path:y,properties:b,newProperties:E})}}}}))},splitNodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{mode:n="lowest",voids:i=!1}=t,{match:r,at:o=e.selection,height:a=0,always:s=!1}=t;if(null==r&&(r=t=>uC.isElement(t)&&vC.isBlock(e,t)),DC.isRange(o)&&(o=JC(e,o)),kC.isPath(o)){var l=o,c=vC.point(e,l),[u]=vC.parent(e,l);r=e=>e===u,a=c.path.length-l.length+1,o=c,s=!0}if(o){var d,p=vC.pointRef(e,o,{affinity:"backward"});try{var[h]=vC.nodes(e,{at:o,match:r,mode:n,voids:i});if(!h)return;var f=vC.void(e,{at:o,mode:"highest"});if(!i&&f){var[m,v]=f;if(uC.isElement(m)&&e.isInline(m)){var g=vC.after(e,v);if(!g){var y=kC.next(v);aS.insertNodes(e,{text:""},{at:y,voids:i}),g=vC.point(e,y)}o=g,s=!0}a=o.path.length-v.length+1,s=!0}d=vC.pointRef(e,o);var b=o.path.length-a,[,E]=h,x=o.path.slice(0,b),w=0===a?o.offset:o.path[b]+0;for(var[C,S]of vC.levels(e,{at:x,reverse:!0,voids:i})){var k=!1;if(S.length<E.length||0===S.length||!i&&uC.isElement(C)&&vC.isVoid(e,C))break;var _=p.current,T=vC.isEnd(e,_,S);if(s||!p||!vC.isEdge(e,_,S)){k=!0;var I=xC.extractProps(C);e.apply({type:"split_node",path:S,position:w,properties:I})}w=S[S.length-1]+(k||T?1:0)}if(null==t.at){var P=d.current||vC.end(e,[]);aS.select(e,P)}}finally{var N;p.unref(),null===(N=d)||void 0===N||N.unref()}}}))},unsetNodes(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Array.isArray(t)||(t=[t]);var i={};for(var r of t)i[r]=null;aS.setNodes(e,i,n)},unwrapNodes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{mode:n="lowest",split:i=!1,voids:r=!1}=t,{at:o=e.selection,match:a}=t;if(o){null==a&&(a=kC.isPath(o)?$C(e,o):t=>uC.isElement(t)&&vC.isBlock(e,t)),kC.isPath(o)&&(o=vC.range(e,o));var s=DC.isRange(o)?vC.rangeRef(e,o):null,l=vC.nodes(e,{at:o,match:a,mode:n,voids:r}),c=Array.from(l,(t=>{var[,n]=t;return vC.pathRef(e,n)})).reverse(),u=function(t){var n=t.unref(),[o]=vC.node(e,n),a=vC.range(e,n);i&&s&&(a=DC.intersection(s.current,a)),aS.liftNodes(e,{at:a,match:e=>uC.isAncestor(o)&&o.children.includes(e),voids:r})};for(var d of c)u(d);s&&s.unref()}}))},wrapNodes(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vC.withoutNormalizing(e,(()=>{var{mode:i="lowest",split:r=!1,voids:o=!1}=n,{match:a,at:s=e.selection}=n;if(s){if(null==a&&(a=kC.isPath(s)?$C(e,s):e.isInline(t)?t=>uC.isElement(t)&&vC.isInline(e,t)||WC.isText(t):t=>uC.isElement(t)&&vC.isBlock(e,t)),r&&DC.isRange(s)){var[l,c]=DC.edges(s),u=vC.rangeRef(e,s,{affinity:"inward"});aS.splitNodes(e,{at:c,match:a,voids:o}),aS.splitNodes(e,{at:l,match:a,voids:o}),s=u.unref(),null==n.at&&aS.select(e,s)}var d=Array.from(vC.nodes(e,{at:s,match:e.isInline(t)?t=>uC.isElement(t)&&vC.isBlock(e,t):e=>vC.isEditor(e),mode:"lowest",voids:o}));for(var[,p]of d){var h=DC.isRange(s)?DC.intersection(s,vC.range(e,p)):s;if(h){var f=Array.from(vC.nodes(e,{at:h,match:a,mode:i,voids:o}));if(f.length>0){var m=function(){var[n]=f,i=f[f.length-1],[,r]=n,[,a]=i;if(0===r.length&&0===a.length)return"continue";var s=kC.equals(r,a)?kC.parent(r):kC.common(r,a),l=vC.range(e,r,a),c=vC.node(e,s),[u]=c,d=s.length+1,p=kC.next(a.slice(0,d)),h=XC(XC({},t),{},{children:[]});aS.insertNodes(e,h,{at:p,voids:o}),aS.moveNodes(e,{at:l,match:e=>uC.isAncestor(u)&&u.children.includes(e),to:p.concat(0),voids:o})}();if("continue"===m)continue}}}}}))}},ZC=(e,t)=>{if(uC.isElement(t)){var n=t;return!!vC.isVoid(e,t)||1===n.children.length&&ZC(e,n.children[0])}return!vC.isEditor(t)},JC=(e,t)=>{if(DC.isCollapsed(t))return t.anchor;var[,n]=DC.edges(t),i=vC.pointRef(e,n);return aS.delete(e,{at:t}),i.unref()},$C=(e,t)=>{var[n]=vC.node(e,t);return e=>e===n};function eS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function tS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eS(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nS={collapse(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{edge:n="anchor"}=t,{selection:i}=e;if(i)if("anchor"===n)aS.select(e,i.anchor);else if("focus"===n)aS.select(e,i.focus);else if("start"===n){var[r]=DC.edges(i);aS.select(e,r)}else if("end"===n){var[,o]=DC.edges(i);aS.select(e,o)}},deselect(e){var{selection:t}=e;t&&e.apply({type:"set_selection",properties:t,newProperties:null})},move(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{selection:n}=e,{distance:i=1,unit:r="character",reverse:o=!1}=t,{edge:a=null}=t;if(n){"start"===a&&(a=DC.isBackward(n)?"focus":"anchor"),"end"===a&&(a=DC.isBackward(n)?"anchor":"focus");var{anchor:s,focus:l}=n,c={distance:i,unit:r},u={};if(null==a||"anchor"===a){var d=o?vC.before(e,s,c):vC.after(e,s,c);d&&(u.anchor=d)}if(null==a||"focus"===a){var p=o?vC.before(e,l,c):vC.after(e,l,c);p&&(u.focus=p)}aS.setSelection(e,u)}},select(e,t){var{selection:n}=e;if(t=vC.range(e,t),n)aS.setSelection(e,t);else{if(!DC.isRange(t))throw new Error("When setting the selection and the current selection is `null` you must provide at least an `anchor` and `focus`, but you passed: ".concat(LC.stringify(t)));e.apply({type:"set_selection",properties:n,newProperties:t})}},setPoint(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{selection:i}=e,{edge:r="both"}=n;if(i){"start"===r&&(r=DC.isBackward(i)?"focus":"anchor"),"end"===r&&(r=DC.isBackward(i)?"anchor":"focus");var{anchor:o,focus:a}=i,s="anchor"===r?o:a;aS.setSelection(e,{["anchor"===r?"anchor":"focus"]:tS(tS({},s),t)})}},setSelection(e,t){var{selection:n}=e,i={},r={};if(n){for(var o in t)("anchor"===o&&null!=t.anchor&&!PC.equals(t.anchor,n.anchor)||"focus"===o&&null!=t.focus&&!PC.equals(t.focus,n.focus)||"anchor"!==o&&"focus"!==o&&t[o]!==n[o])&&(i[o]=n[o],r[o]=t[o]);Object.keys(i).length>0&&e.apply({type:"set_selection",properties:i,newProperties:r})}}},iS={delete(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vC.withoutNormalizing(e,(()=>{var{reverse:n=!1,unit:i="character",distance:r=1,voids:o=!1}=t,{at:a=e.selection,hanging:s=!1}=t;if(a){var l=!1;if(DC.isRange(a)&&DC.isCollapsed(a)&&(l=!0,a=a.anchor),PC.isPoint(a)){var c=vC.void(e,{at:a,mode:"highest"});if(!o&&c){var[,u]=c;a=u}else{var d={unit:i,distance:r};a={anchor:a,focus:n?vC.before(e,a,d)||vC.start(e,[]):vC.after(e,a,d)||vC.end(e,[])},s=!0}}if(kC.isPath(a))aS.removeNodes(e,{at:a,voids:o});else if(!DC.isCollapsed(a)){if(!s){var[,p]=DC.edges(a),h=vC.end(e,[]);PC.equals(p,h)||(a=vC.unhangRange(e,a,{voids:o}))}var[f,m]=DC.edges(a),v=vC.above(e,{match:t=>uC.isElement(t)&&vC.isBlock(e,t),at:f,voids:o}),g=vC.above(e,{match:t=>uC.isElement(t)&&vC.isBlock(e,t),at:m,voids:o}),y=v&&g&&!kC.equals(v[1],g[1]),b=kC.equals(f.path,m.path),E=o?null:vC.void(e,{at:f,mode:"highest"}),x=o?null:vC.void(e,{at:m,mode:"highest"});if(E){var w=vC.before(e,f);w&&v&&kC.isAncestor(v[1],w.path)&&(f=w)}if(x){var C=vC.after(e,m);C&&g&&kC.isAncestor(g[1],C.path)&&(m=C)}var S,k=[];for(var _ of vC.nodes(e,{at:a,voids:o})){var[T,I]=_;S&&0===kC.compare(I,S)||(!o&&uC.isElement(T)&&vC.isVoid(e,T)||!kC.isCommon(I,f.path)&&!kC.isCommon(I,m.path))&&(k.push(_),S=I)}var P=Array.from(k,(t=>{var[,n]=t;return vC.pathRef(e,n)})),N=vC.pointRef(e,f),M=vC.pointRef(e,m),A="";if(!b&&!E){var D=N.current,[R]=vC.leaf(e,D),{path:B}=D,{offset:L}=f,O=R.text.slice(L);O.length>0&&(e.apply({type:"remove_text",path:B,offset:L,text:O}),A=O)}if(P.reverse().map((e=>e.unref())).filter((e=>null!==e)).forEach((t=>aS.removeNodes(e,{at:t,voids:o}))),!x){var F=M.current,[z]=vC.leaf(e,F),{path:H}=F,U=b?f.offset:0,W=z.text.slice(U,m.offset);W.length>0&&(e.apply({type:"remove_text",path:H,offset:U,text:W}),A=W)}!b&&y&&M.current&&N.current&&aS.mergeNodes(e,{at:M.current,hanging:!0,voids:o}),l&&n&&"character"===i&&A.length>1&&A.match(/[\u0E00-\u0E7F]+/)&&aS.insertText(e,A.slice(0,A.length-r));var V=N.unref(),j=M.unref(),G=n?V||j:j||V;null==t.at&&G&&aS.select(e,G)}}}))},insertFragment(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vC.withoutNormalizing(e,(()=>{var{hanging:i=!1,voids:r=!1}=n,{at:o=e.selection}=n;if(t.length&&o){if(DC.isRange(o))if(i||(o=vC.unhangRange(e,o,{voids:r})),DC.isCollapsed(o))o=o.anchor;else{var[,a]=DC.edges(o);if(!r&&vC.void(e,{at:a}))return;var s=vC.pointRef(e,a);aS.delete(e,{at:o}),o=s.unref()}else kC.isPath(o)&&(o=vC.start(e,o));if(r||!vC.void(e,{at:o})){var l=vC.above(e,{at:o,match:t=>uC.isElement(t)&&vC.isInline(e,t),mode:"highest",voids:r});if(l){var[,c]=l;vC.isEnd(e,o,c)?o=vC.after(e,c):vC.isStart(e,o,c)&&(o=vC.before(e,c))}var u=vC.above(e,{match:t=>uC.isElement(t)&&vC.isBlock(e,t),at:o,voids:r}),[,d]=u,p=vC.isStart(e,o,d),h=vC.isEnd(e,o,d),f=p&&h,m=!p||p&&h,v=!h,[,g]=xC.first({children:t},[]),[,y]=xC.last({children:t},[]),b=[],E=t=>{var[n,i]=t;return!(0===i.length||!f&&(m&&kC.isAncestor(i,g)&&uC.isElement(n)&&!e.isVoid(n)&&!e.isInline(n)||v&&kC.isAncestor(i,y)&&uC.isElement(n)&&!e.isVoid(n)&&!e.isInline(n)))};for(var x of xC.nodes({children:t},{pass:E}))E(x)&&b.push(x);var w=[],C=[],S=[],k=!0,_=!1;for(var[T]of b)uC.isElement(T)&&!e.isInline(T)?(k=!1,_=!0,C.push(T)):k?w.push(T):S.push(T);var[I]=vC.nodes(e,{at:o,match:t=>WC.isText(t)||vC.isInline(e,t),mode:"highest",voids:r}),[,P]=I,N=vC.isStart(e,o,P),M=vC.isEnd(e,o,P),A=vC.pathRef(e,h&&!S.length?kC.next(d):d),D=vC.pathRef(e,M?kC.next(P):P);aS.splitNodes(e,{at:o,match:t=>_?uC.isElement(t)&&vC.isBlock(e,t):WC.isText(t)||vC.isInline(e,t),mode:_?"lowest":"highest",always:_&&(!p||w.length>0)&&(!h||S.length>0),voids:r});var R,B=vC.pathRef(e,!N||N&&M?kC.next(P):P);if(aS.insertNodes(e,w,{at:B.current,match:t=>WC.isText(t)||vC.isInline(e,t),mode:"highest",voids:r}),f&&!w.length&&C.length&&!S.length&&aS.delete(e,{at:d,voids:r}),aS.insertNodes(e,C,{at:A.current,match:t=>uC.isElement(t)&&vC.isBlock(e,t),mode:"lowest",voids:r}),aS.insertNodes(e,S,{at:D.current,match:t=>WC.isText(t)||vC.isInline(e,t),mode:"highest",voids:r}),!n.at&&(S.length>0&&D.current?R=kC.previous(D.current):C.length>0&&A.current?R=kC.previous(A.current):B.current&&(R=kC.previous(B.current)),R)){var L=vC.end(e,R);aS.select(e,L)}B.unref(),A.unref(),D.unref()}}}))},insertText(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vC.withoutNormalizing(e,(()=>{var{voids:i=!1}=n,{at:r=e.selection}=n;if(r){if(kC.isPath(r)&&(r=vC.range(e,r)),DC.isRange(r))if(DC.isCollapsed(r))r=r.anchor;else{var o=DC.end(r);if(!i&&vC.void(e,{at:o}))return;var a=DC.start(r),s=vC.pointRef(e,a),l=vC.pointRef(e,o);aS.delete(e,{at:r,voids:i});var c=s.unref(),u=l.unref();r=c||u,aS.setSelection(e,{anchor:r,focus:r})}if(i||!vC.void(e,{at:r})){var{path:d,offset:p}=r;t.length>0&&e.apply({type:"insert_text",path:d,offset:p,text:t})}}}))}};function rS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function oS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rS(Object(n),!0).forEach((function(t){kw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rS(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var aS=oS(oS(oS(oS({},GC),QC),nS),iS),sS=function(e){return e=String(e||""),cS.test(e)?"rtl":uS.test(e)?"ltr":"neutral"},lS="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",cS=new RegExp("^[^"+lS+"]*[֑-߿יִ-﷽ﹰ-ﻼ]"),uS=new RegExp("^[^֑-߿יִ-﷽ﹰ-ﻼ]*["+lS+"]"),dS=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},pS="object"==typeof mt&&mt&&mt.Object===Object&&mt,hS="object"==typeof self&&self&&self.Object===Object&&self,fS=pS||hS||Function("return this")(),mS=fS,vS=/\s/,gS=/^\s+/,yS=fS.Symbol,bS=yS,ES=Object.prototype,xS=ES.hasOwnProperty,wS=ES.toString,CS=bS?bS.toStringTag:void 0,SS=Object.prototype.toString,kS=function(e){var t=xS.call(e,CS),n=e[CS];try{e[CS]=void 0;var i=!0}catch(e){}var r=wS.call(e);return i&&(t?e[CS]=n:delete e[CS]),r},_S=yS?yS.toStringTag:void 0,TS=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_S&&_S in Object(e)?kS(e):function(e){return SS.call(e)}(e)},IS=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&vS.test(e.charAt(t)););return t}(e)+1).replace(gS,""):e},PS=dS,NS=/^[-+]0x[0-9a-f]+$/i,MS=/^0b[01]+$/i,AS=/^0o[0-7]+$/i,DS=parseInt,RS=dS,BS=function(){return mS.Date.now()},LS=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==TS(e)}(e))return NaN;if(PS(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=PS(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=IS(e);var n=MS.test(e);return n||AS.test(e)?DS(e.slice(2),n?2:8):NS.test(e)?NaN:+e},OS=Math.max,FS=Math.min,zS=function(e,t,n){var i,r,o,a,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=i,o=r;return i=r=void 0,c=t,a=e.apply(o,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=o}function m(){var e=BS();if(f(e))return v(e);s=setTimeout(m,function(e){var n=t-(e-l);return d?FS(n,o-(e-c)):n}(e))}function v(e){return s=void 0,p&&i?h(e):(i=r=void 0,a)}function g(){var e=BS(),n=f(e);if(i=arguments,r=this,l=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(m,t),u?h(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),h(l)}return void 0===s&&(s=setTimeout(m,t)),a}return t=LS(t)||0,RS(n)&&(u=!!n.leading,o=(d="maxWait"in n)?OS(LS(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),g.cancel=function(){void 0!==s&&clearTimeout(s),c=0,i=l=r=s=void 0},g.flush=function(){return void 0===s?a:v(BS())},g},HS=zS,US=dS;function WS(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function VS(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function jS(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return VS(n.overflowY,t)||VS(n.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function GS(e,t,n,i,r,o,a,s){return o<e&&a>t||o>e&&a<t?0:o<=e&&s<=n||a>=t&&s>=n?o-e-i:a>t&&s<n||o<e&&s>n?a-t+r:0}function qS(e,t){var n=window,i=t.scrollMode,r=t.block,o=t.inline,a=t.boundary,s=t.skipOverflowHiddenElements,l="function"==typeof a?a:function(e){return e!==a};if(!WS(e))throw new TypeError("Invalid target");for(var c=document.scrollingElement||document.documentElement,u=[],d=e;WS(d)&&l(d);){if((d=d.parentElement)===c){u.push(d);break}null!=d&&d===document.body&&jS(d)&&!jS(document.documentElement)||null!=d&&jS(d,s)&&u.push(d)}for(var p=n.visualViewport?n.visualViewport.width:innerWidth,h=n.visualViewport?n.visualViewport.height:innerHeight,f=window.scrollX||pageXOffset,m=window.scrollY||pageYOffset,v=e.getBoundingClientRect(),g=v.height,y=v.width,b=v.top,E=v.right,x=v.bottom,w=v.left,C="start"===r||"nearest"===r?b:"end"===r?x:b+g/2,S="center"===o?w+y/2:"end"===o?E:w,k=[],_=0;_<u.length;_++){var T=u[_],I=T.getBoundingClientRect(),P=I.height,N=I.width,M=I.top,A=I.right,D=I.bottom,R=I.left;if("if-needed"===i&&b>=0&&w>=0&&x<=h&&E<=p&&b>=M&&x<=D&&w>=R&&E<=A)return k;var B=getComputedStyle(T),L=parseInt(B.borderLeftWidth,10),O=parseInt(B.borderTopWidth,10),F=parseInt(B.borderRightWidth,10),z=parseInt(B.borderBottomWidth,10),H=0,U=0,W="offsetWidth"in T?T.offsetWidth-T.clientWidth-L-F:0,V="offsetHeight"in T?T.offsetHeight-T.clientHeight-O-z:0;if(c===T)H="start"===r?C:"end"===r?C-h:"nearest"===r?GS(m,m+h,h,O,z,m+C,m+C+g,g):C-h/2,U="start"===o?S:"center"===o?S-p/2:"end"===o?S-p:GS(f,f+p,p,L,F,f+S,f+S+y,y),H=Math.max(0,H+m),U=Math.max(0,U+f);else{H="start"===r?C-M-O:"end"===r?C-D+z+V:"nearest"===r?GS(M,D,P,O,z+V,C,C+g,g):C-(M+P/2)+V/2,U="start"===o?S-R-L:"center"===o?S-(R+N/2)+W/2:"end"===o?S-A+F+W:GS(R,A,N,L,F+W,S,S+y,y);var j=T.scrollLeft,G=T.scrollTop;C+=G-(H=Math.max(0,Math.min(G+H,T.scrollHeight-P+V))),S+=j-(U=Math.max(0,Math.min(j+U,T.scrollWidth-N+W)))}k.push({el:T,top:H,left:U})}return k}function KS(e){return e===Object(e)&&0!==Object.keys(e).length}var YS,XS=[],QS="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(YS||(YS={}));var ZS,JS=function(e){return Object.freeze(e)},$S=function(e,t){this.inlineSize=e,this.blockSize=t,JS(this)},ek=function(){function e(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,JS(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),tk=function(e){return e instanceof SVGElement&&"getBBox"in e},nk=function(e){if(tk(e)){var t=e.getBBox(),n=t.width,i=t.height;return!n&&!i}var r=e,o=r.offsetWidth,a=r.offsetHeight;return!(o||a||e.getClientRects().length)},ik=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},rk="undefined"!=typeof window?window:{},ok=new WeakMap,ak=/auto|scroll/,sk=/^tb|vertical/,lk=/msie|trident/i.test(rk.navigator&&rk.navigator.userAgent),ck=function(e){return parseFloat(e||"0")},uk=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new $S((n?t:e)||0,(n?e:t)||0)},dk=JS({devicePixelContentBoxSize:uk(),borderBoxSize:uk(),contentBoxSize:uk(),contentRect:new ek(0,0,0,0)}),pk=function(e,t){if(void 0===t&&(t=!1),ok.has(e)&&!t)return ok.get(e);if(nk(e))return ok.set(e,dk),dk;var n=getComputedStyle(e),i=tk(e)&&e.ownerSVGElement&&e.getBBox(),r=!lk&&"border-box"===n.boxSizing,o=sk.test(n.writingMode||""),a=!i&&ak.test(n.overflowY||""),s=!i&&ak.test(n.overflowX||""),l=i?0:ck(n.paddingTop),c=i?0:ck(n.paddingRight),u=i?0:ck(n.paddingBottom),d=i?0:ck(n.paddingLeft),p=i?0:ck(n.borderTopWidth),h=i?0:ck(n.borderRightWidth),f=i?0:ck(n.borderBottomWidth),m=d+c,v=l+u,g=(i?0:ck(n.borderLeftWidth))+h,y=p+f,b=s?e.offsetHeight-y-e.clientHeight:0,E=a?e.offsetWidth-g-e.clientWidth:0,x=r?m+g:0,w=r?v+y:0,C=i?i.width:ck(n.width)-x-E,S=i?i.height:ck(n.height)-w-b,k=C+m+E+g,_=S+v+b+y,T=JS({devicePixelContentBoxSize:uk(Math.round(C*devicePixelRatio),Math.round(S*devicePixelRatio),o),borderBoxSize:uk(k,_,o),contentBoxSize:uk(C,S,o),contentRect:new ek(d,l,C,S)});return ok.set(e,T),T},hk=function(e,t,n){var i=pk(e,n),r=i.borderBoxSize,o=i.contentBoxSize,a=i.devicePixelContentBoxSize;switch(t){case YS.DEVICE_PIXEL_CONTENT_BOX:return a;case YS.BORDER_BOX:return r;default:return o}},fk=function(e){var t=pk(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=JS([t.borderBoxSize]),this.contentBoxSize=JS([t.contentBoxSize]),this.devicePixelContentBoxSize=JS([t.devicePixelContentBoxSize])},mk=function(e){if(nk(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},vk=function(){var e=1/0,t=[];XS.forEach((function(n){if(0!==n.activeTargets.length){var i=[];n.activeTargets.forEach((function(t){var n=new fk(t.target),r=mk(t.target);i.push(n),t.lastReportedSize=hk(t.target,t.observedBox),r<e&&(e=r)})),t.push((function(){n.callback.call(n.observer,i,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,i=t;n<i.length;n++)(0,i[n])();return e},gk=function(e){XS.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(mk(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},yk=[],bk=0,Ek={attributes:!0,characterData:!0,childList:!0,subtree:!0},xk=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],wk=function(e){return void 0===e&&(e=0),Date.now()+e},Ck=!1,Sk=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!Ck){Ck=!0;var n,i=wk(e);n=function(){var n=!1;try{n=function(){var e,t=0;for(gk(t);XS.some((function(e){return e.activeTargets.length>0}));)t=vk(),gk(t);return XS.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:QS}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=QS),window.dispatchEvent(e)),t>0}()}finally{if(Ck=!1,e=i-wk(),!bk)return;n?t.run(1e3):e>0?t.run(e):t.start()}},function(e){if(!ZS){var t=0,n=document.createTextNode("");new MutationObserver((function(){return yk.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),ZS=function(){n.textContent="".concat(t?t--:t++)}}yk.push(e),ZS()}((function(){requestAnimationFrame(n)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,Ek)};document.body?t():rk.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),xk.forEach((function(t){return rk.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),xk.forEach((function(t){return rk.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),kk=function(e){!bk&&e>0&&Sk.start(),!(bk+=e)&&Sk.stop()},_k=function(){function e(e,t){this.target=e,this.observedBox=t||YS.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=hk(this.target,this.observedBox,!0);return e=this.target,tk(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),Tk=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},Ik=new WeakMap,Pk=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},Nk=function(){function e(){}return e.connect=function(e,t){var n=new Tk(e,t);Ik.set(e,n)},e.observe=function(e,t,n){var i=Ik.get(e),r=0===i.observationTargets.length;Pk(i.observationTargets,t)<0&&(r&&XS.push(i),i.observationTargets.push(new _k(t,n&&n.box)),kk(1),Sk.schedule())},e.unobserve=function(e,t){var n=Ik.get(e),i=Pk(n.observationTargets,t),r=1===n.observationTargets.length;i>=0&&(r&&XS.splice(XS.indexOf(n),1),n.observationTargets.splice(i,1),kk(-1))},e.disconnect=function(e){var t=this,n=Ik.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),Mk=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Nk.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!ik(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Nk.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!ik(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Nk.unobserve(this,e)},e.prototype.disconnect=function(){Nk.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),Ak={};Object.defineProperty(Ak,"__esModule",{value:!0});for(var Dk="undefined"!=typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Rk={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},Bk={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:Dk?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},Lk={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},Ok=1;Ok<20;Ok++)Lk["f"+Ok]=111+Ok;function Fk(e,t,n){t&&!("byKey"in t)&&(n=t,t=null),Array.isArray(e)||(e=[e]);var i=e.map((function(e){return zk(e,t)})),r=function(e){return i.some((function(t){return Hk(t,e)}))};return null==n?r:r(n)}function zk(e,t){var n=t&&t.byKey,i={},r=(e=e.replace("++","+add")).split("+"),o=r.length;for(var a in Rk)i[Rk[a]]=!1;var s=!0,l=!1,c=void 0;try{for(var u,d=r[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value,h=p.endsWith("?")&&p.length>1;h&&(p=p.slice(0,-1));var f=Wk(p),m=Rk[f];1!==o&&m||(n?i.key=f:i.which=Uk(p)),m&&(i[m]=!h||null)}}catch(e){l=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw c}}return i}function Hk(e,t){for(var n in e){var i=e[n],r=void 0;if(null!=i&&(null!=(r="key"===n&&null!=t.key?t.key.toLowerCase():"which"===n?91===i&&93===t.which?91:t.which:t[n])||!1!==i)&&r!==i)return!1}return!0}function Uk(e){return e=Wk(e),Lk[e]||e.toUpperCase().charCodeAt(0)}function Wk(e){return e=e.toLowerCase(),Bk[e]||e}Ak.default=Fk,Ak.isHotkey=Fk,Ak.isCodeHotkey=function(e,t){return Fk(e,t)};var Vk=Ak.isKeyHotkey=function(e,t){return Fk(e,{byKey:!0},t)};function jk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gk(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}Ak.parseHotkey=zk,Ak.compareHotkey=Hk,Ak.toKeyCode=Uk,Ak.toKeyName=Wk;var qk=0;class Kk{constructor(){this.id="".concat(qk++)}}var Yk=new WeakMap,Xk=new WeakMap,Qk=new WeakMap,Zk=new WeakMap,Jk=new WeakMap,$k=new WeakMap,e_=new WeakMap,t_=new WeakMap,n_=new WeakMap,i_=new WeakMap,r_=new WeakMap,o_=new WeakMap,a_=new WeakMap,s_=new WeakMap,l_=new WeakMap,c_=new WeakMap,u_=new WeakMap,d_=new WeakMap,p_=new WeakMap,h_=new WeakMap,f_=new WeakMap,m_=Symbol("placeholder"),v_=Symbol("mark-placeholder"),g_=globalThis.Text,y_=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView||null,b_=e=>E_(e)&&1===e.nodeType,E_=e=>{var t=y_(e);return!!t&&e instanceof t.Node},x_=e=>{var t=e&&e.anchorNode&&y_(e.anchorNode);return!!t&&e instanceof t.Selection},w_=e=>E_(e)&&3===e.nodeType,C_=(e,t,n)=>{for(var i,{childNodes:r}=e,o=r[t],a=t,s=!1,l=!1;(E_(i=o)&&8===i.nodeType||b_(o)&&0===o.childNodes.length||b_(o)&&"false"===o.getAttribute("contenteditable"))&&(!s||!l);)a>=r.length?(s=!0,a=t-1,n="backward"):a<0?(l=!0,a=t+1,n="forward"):(o=r[a],t=a,a+="forward"===n?1:-1);return[o,t]},S_=(e,t,n)=>{var[i]=C_(e,t,n);return i},k_=e=>{var t="";if(w_(e)&&e.nodeValue)return e.nodeValue;if(b_(e)){for(var n of Array.from(e.childNodes))t+=k_(n);var i=getComputedStyle(e).getPropertyValue("display");"block"!==i&&"list"!==i&&"BR"!==e.tagName||(t+="\n")}return t},__=/data-slate-fragment="(.+?)"/m,T_=(e,t,n)=>{var{target:i}=t;if(b_(i)&&i.matches('[contentEditable="false"]'))return!1;var{document:r}=V_.getWindow(e);if(r.contains(i))return V_.hasDOMNode(e,i,{editable:!0});var o=n.find((e=>{var{addedNodes:t,removedNodes:n}=e;for(var r of t)if(r===i||r.contains(i))return!0;for(var o of n)if(o===i||o.contains(i))return!0}));return!(!o||o===t)&&T_(e,o,n)},I_=parseInt(e.version.split(".")[0],10)>=17,P_="undefined"!=typeof navigator&&"undefined"!=typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,N_="undefined"!=typeof navigator&&/Mac OS X/.test(navigator.userAgent),M_="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent),A_="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),D_="undefined"!=typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),R_="undefined"!=typeof navigator&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])(?:\.)/i.test(navigator.userAgent),B_="undefined"!=typeof navigator&&/Chrome/i.test(navigator.userAgent),L_="undefined"!=typeof navigator&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])(?:\.)/i.test(navigator.userAgent),O_=M_&&"undefined"!=typeof navigator&&/Chrome?\/(?:[0-5]?\d)(?:\.)/i.test(navigator.userAgent),F_="undefined"!=typeof navigator&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])(?:\.)).*/i.test(navigator.userAgent),z_="undefined"!=typeof navigator&&/.*UCBrowser/.test(navigator.userAgent),H_="undefined"!=typeof navigator&&/.*Wechat/.test(navigator.userAgent),U_=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),W_=(!L_||!O_)&&!R_&&"undefined"!=typeof globalThis&&globalThis.InputEvent&&"function"==typeof globalThis.InputEvent.prototype.getTargetRanges,V_={isComposing:e=>!!o_.get(e),getWindow(e){var t=Qk.get(e);if(!t)throw new Error("Unable to find a host window element for this editor");return t},findKey(e,t){var n=t_.get(t);return n||(n=new Kk,t_.set(t,n)),n},findPath(e,t){for(var n=[],i=t;;){var r=Xk.get(i);if(null==r){if(vC.isEditor(i))return n;break}var o=Yk.get(i);if(null==o)break;n.unshift(o),i=r}throw new Error("Unable to find the path for Slate node: ".concat(LC.stringify(t)))},findDocumentOrShadowRoot(e){var t=V_.toDOMNode(e,e),n=t.getRootNode();return(n instanceof Document||n instanceof ShadowRoot)&&null!=n.getSelection?n:t.ownerDocument},isFocused:e=>!!r_.get(e),isReadOnly:e=>!!i_.get(e),blur(e){var t=V_.toDOMNode(e,e),n=V_.findDocumentOrShadowRoot(e);r_.set(e,!1),n.activeElement===t&&t.blur()},focus(e){var t=V_.toDOMNode(e,e),n=V_.findDocumentOrShadowRoot(e);r_.set(e,!0),n.activeElement!==t&&t.focus({preventScroll:!0})},deselect(e){var{selection:t}=e,n=V_.findDocumentOrShadowRoot(e).getSelection();n&&n.rangeCount>0&&n.removeAllRanges(),t&&aS.deselect(e)},hasDOMNode(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{editable:r=!1}=i,o=V_.toDOMNode(e,e);try{n=b_(t)?t:t.parentElement}catch(e){if(!e.message.includes('Permission denied to access property "nodeType"'))throw e}return!!n&&!(n.closest("[data-slate-editor]")!==o||r&&!n.isContentEditable&&("boolean"!=typeof n.isContentEditable||n.closest('[contenteditable="false"]')!==o)&&!n.getAttribute("data-slate-zero-width"))},insertData(e,t){e.insertData(t)},insertFragmentData:(e,t)=>e.insertFragmentData(t),insertTextData:(e,t)=>e.insertTextData(t),setFragmentData(e,t,n){e.setFragmentData(t,n)},toDOMNode(e,t){var n=n_.get(e),i=vC.isEditor(t)?Zk.get(e):null==n?void 0:n.get(V_.findKey(e,t));if(!i)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(LC.stringify(t)));return i},toDOMPoint(e,t){var n,[i]=vC.node(e,t.path),r=V_.toDOMNode(e,i);vC.void(e,{at:t})&&(t={path:t.path,offset:0});for(var o=Array.from(r.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),a=0,s=0;s<o.length;s++){var l=o[s],c=l.childNodes[0];if(null!=c&&null!=c.textContent){var{length:u}=c.textContent,d=l.getAttribute("data-slate-length"),p=a+(null==d?u:parseInt(d,10)),h=o[s+1];if(t.offset===p&&null!=h&&h.hasAttribute("data-slate-mark-placeholder")){var f,m=h.childNodes[0];n=[m instanceof g_?m:h,null!==(f=h.textContent)&&void 0!==f&&f.startsWith("\ufeff")?1:0];break}if(t.offset<=p){n=[c,Math.min(u,Math.max(0,t.offset-a))];break}a=p}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(LC.stringify(t)));return n},toDOMRange(e,t){var{anchor:n,focus:i}=t,r=DC.isBackward(t),o=V_.toDOMPoint(e,n),a=DC.isCollapsed(t)?o:V_.toDOMPoint(e,i),s=V_.getWindow(e).document.createRange(),[l,c]=r?a:o,[u,d]=r?o:a,p=!!(b_(l)?l:l.parentElement).getAttribute("data-slate-zero-width"),h=!!(b_(u)?u:u.parentElement).getAttribute("data-slate-zero-width");return s.setStart(l,p?1:c),s.setEnd(u,h?1:d),s},toSlateNode(e,t){var n=b_(t)?t:t.parentElement;n&&!n.hasAttribute("data-slate-node")&&(n=n.closest("[data-slate-node]"));var i=n?$k.get(n):null;if(!i)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(n));return i},findEventRange(e,t){"nativeEvent"in t&&(t=t.nativeEvent);var{clientX:n,clientY:i,target:r}=t;if(null==n||null==i)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));var o,a=V_.toSlateNode(e,t.target),s=V_.findPath(e,a);if(uC.isElement(a)&&vC.isVoid(e,a)){var l=r.getBoundingClientRect(),c=e.isInline(a)?n-l.left<l.left+l.width-n:i-l.top<l.top+l.height-i,u=vC.point(e,s,{edge:c?"start":"end"}),d=c?vC.before(e,u):vC.after(e,u);if(d)return vC.range(e,d)}var{document:p}=V_.getWindow(e);if(p.caretRangeFromPoint)o=p.caretRangeFromPoint(n,i);else{var h=p.caretPositionFromPoint(n,i);h&&((o=p.createRange()).setStart(h.offsetNode,h.offset),o.setEnd(h.offsetNode,h.offset))}if(!o)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));return V_.toSlateRange(e,o,{exactMatch:!1,suppressThrow:!1})},toSlatePoint(e,t,n){var{exactMatch:i,suppressThrow:r}=n,[o,a]=i?t:(e=>{var[t,n]=e;if(b_(t)&&t.childNodes.length){var i=n===t.childNodes.length,r=i?n-1:n;for([t,r]=C_(t,r,i?"backward":"forward"),i=r<n;b_(t)&&t.childNodes.length;){var o=i?t.childNodes.length-1:0;t=S_(t,o,i?"backward":"forward")}n=i&&null!=t.textContent?t.textContent.length:0}return[t,n]})(t),s=o.parentNode,l=null,c=0;if(s){var u,d,p=V_.toDOMNode(e,e),h=s.closest('[data-slate-void="true"]'),f=h&&p.contains(h)?h:null,m=s.closest("[data-slate-leaf]"),v=null;if(m){if(l=m.closest('[data-slate-node="text"]')){var g=V_.getWindow(e).document.createRange();g.setStart(l,0),g.setEnd(o,a);var y=g.cloneContents();[...Array.prototype.slice.call(y.querySelectorAll("[data-slate-zero-width]")),...Array.prototype.slice.call(y.querySelectorAll("[contenteditable=false]"))].forEach((e=>{M_&&!i&&e.hasAttribute("data-slate-zero-width")&&e.textContent.length>0&&"\ufeff"!==e.textContext?e.textContent.startsWith("\ufeff")&&(e.textContent=e.textContent.slice(1)):e.parentNode.removeChild(e)})),c=y.textContent.length,v=l}}else if(f){for(var b=f.querySelectorAll("[data-slate-leaf]"),E=0;E<b.length;E++){var x=b[E];if(V_.hasDOMNode(e,x)){m=x;break}}m?(l=m.closest('[data-slate-node="text"]'),c=(v=m).textContent.length,v.querySelectorAll("[data-slate-zero-width]").forEach((e=>{c-=e.textContent.length}))):c=1}v&&c===v.textContent.length&&M_&&"z"===v.getAttribute("data-slate-zero-width")&&null!==(u=v.textContent)&&void 0!==u&&u.startsWith("\ufeff")&&(s.hasAttribute("data-slate-zero-width")||A_&&null!==(d=v.textContent)&&void 0!==d&&d.endsWith("\n\n"))&&c--}if(M_&&!l&&!i){var w=s.hasAttribute("data-slate-node")?s:s.closest("[data-slate-node]");if(w&&V_.hasDOMNode(e,w,{editable:!0})){var C=V_.toSlateNode(e,w),{path:S,offset:k}=vC.start(e,V_.findPath(e,C));return w.querySelector("[data-slate-leaf]")||(k=a),{path:S,offset:k}}}if(!l){if(r)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t))}var _=V_.toSlateNode(e,l);return{path:V_.findPath(e,_),offset:c}},toSlateRange(e,t,n){var i,r,o,a,s,l,{exactMatch:c,suppressThrow:u}=n;if((x_(t)?t.anchorNode:t.startContainer)&&(x_(t)?(i=t.anchorNode,r=t.anchorOffset,o=t.focusNode,a=t.focusOffset,s=B_&&(e=>{for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1})(i)?t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset:t.isCollapsed):(i=t.startContainer,r=t.startOffset,o=t.endContainer,a=t.endOffset,s=t.collapsed)),null==i||null==o||null==r||null==a)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));"getAttribute"in o&&"false"===o.getAttribute("contenteditable")&&(o=i,a=(null===(l=i.textContent)||void 0===l?void 0:l.length)||0);var d=V_.toSlatePoint(e,[i,r],{exactMatch:c,suppressThrow:u});if(!d)return null;var p=s?d:V_.toSlatePoint(e,[o,a],{exactMatch:c,suppressThrow:u});if(!p)return null;if(A_&&!s&&i!==o){var h=vC.isEnd(e,d,d.path),f=vC.isStart(e,p,p.path);h&&(d=vC.after(e,d)||d),f&&(p=vC.before(e,p)||p)}var m={anchor:d,focus:p};return DC.isExpanded(m)&&DC.isForward(m)&&b_(o)&&vC.void(e,{at:m.focus,mode:"highest"})&&(m=vC.unhangRange(e,m,{voids:!0})),m},hasRange(e,t){var{anchor:n,focus:i}=t;return vC.hasPath(e,n.path)&&vC.hasPath(e,i.path)},hasTarget:(e,t)=>E_(t)&&V_.hasDOMNode(e,t),hasEditableTarget:(e,t)=>E_(t)&&V_.hasDOMNode(e,t,{editable:!0}),hasSelectableTarget:(e,t)=>V_.hasEditableTarget(e,t)||V_.isTargetInsideNonReadonlyVoid(e,t),isTargetInsideNonReadonlyVoid(e,t){if(i_.get(e))return!1;var n=V_.hasTarget(e,t)&&V_.toSlateNode(e,t);return uC.isElement(n)&&vC.isVoid(e,n)},androidScheduleFlush(e){var t;null===(t=l_.get(e))||void 0===t||t()},androidPendingDiffs:e=>d_.get(e)},j_=["anchor","focus"],G_=["anchor","focus"],q_=(e,t)=>{var n,i,r=Gk(e,j_),o=Gk(t,G_);return e[m_]===t[m_]&&(n=r,i=o,Object.keys(n).length===Object.keys(i).length&&Object.keys(n).every((e=>i.hasOwnProperty(e)&&n[e]===i[e])))},K_=U_?e.useLayoutEffect:e.useEffect,Y_=t=>{var{isLast:n,leaf:i,parent:r,text:o}=t,a=$_(),s=V_.findPath(a,o),l=kC.parent(s),c=!0===i[v_];return a.isVoid(r)?e.createElement(Z_,{length:xC.string(r).length}):""!==i.text||r.children[r.children.length-1]!==o||a.isInline(r)||""!==vC.string(a,l)?""===i.text?e.createElement(Z_,{isMarkPlaceholder:c}):n&&"\n"===i.text.slice(-1)?e.createElement(X_,{isTrailing:!0,text:i.text}):e.createElement(X_,{text:i.text}):e.createElement(Z_,{isLineBreak:!0,isMarkPlaceholder:c})},X_=t=>{var{text:n,isTrailing:i=!1}=t,r=e.useRef(null),o=()=>"".concat(null!=n?n:"").concat(i?"\n":""),[a]=e.useState(o);return K_((()=>{var e=o();r.current&&r.current.textContent!==e&&(r.current.textContent=e)})),e.createElement(Q_,{ref:r},a)},Q_=e.memo(e.forwardRef(((t,n)=>e.createElement("span",{"data-slate-string":!0,ref:n},t.children)))),Z_=t=>{var{length:n=0,isLineBreak:i=!1,isMarkPlaceholder:r=!1}=t,o={"data-slate-zero-width":i?"n":"z","data-slate-length":n};return r&&(o["data-slate-mark-placeholder"]=!0),e.createElement("span",Object.assign({},o),M_&&i?null:"\ufeff",i?e.createElement("br",null):null)},J_=e.createContext(null),$_=()=>{var t=e.useContext(J_);if(!t)throw new Error("The `useSlateStatic` hook must be used inside the <Slate> component's context.");return t},eT=e.memo((t=>{var{leaf:n,isLast:i,text:r,parent:o,renderPlaceholder:a,renderLeaf:s=(t=>e.createElement(tT,Object.assign({},t)))}=t,l=e.useRef(null),c=e.useRef(null),u=$_(),d=e.useRef(null);e.useEffect((()=>()=>{d.current&&d.current.disconnect()}),[]),e.useEffect((()=>{var e=null==c?void 0:c.current;if(e?Jk.set(u,e):Jk.delete(u),d.current)d.current.disconnect(),e&&d.current.observe(e);else if(e){var t=window.ResizeObserver||Mk;d.current=new t((()=>{var e=f_.get(u);null==e||e()})),d.current.observe(e)}if(!e&&l.current){var n=f_.get(u);null==n||n()}return l.current=c.current,()=>{Jk.delete(u)}}),[c,n]);var p=e.createElement(Y_,{isLast:i,leaf:n,parent:o,text:r});if(n[m_]){var h={children:n.placeholder,attributes:{"data-slate-placeholder":!0,style:{position:"absolute",pointerEvents:"none",width:"100%",maxWidth:"100%",display:"block",opacity:"0.333",userSelect:"none",textDecoration:"none"},contentEditable:!1,ref:c}};p=e.createElement(e.Fragment,null,a(h),p)}return s({attributes:{"data-slate-leaf":!0},children:p,leaf:n,text:r})}),((e,t)=>t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&WC.equals(t.leaf,e.leaf)&&t.leaf[m_]===e.leaf[m_])),tT=t=>{var{attributes:n,children:i}=t;return e.createElement("span",Object.assign({},n),i)},nT=e.memo((t=>{for(var{decorations:n,isLast:i,parent:r,renderPlaceholder:o,renderLeaf:a,text:s}=t,l=$_(),c=e.useRef(null),u=WC.decorations(s,n),d=V_.findKey(l,s),p=[],h=0;h<u.length;h++){var f=u[h];p.push(e.createElement(eT,{isLast:i&&h===u.length-1,key:"".concat(d.id,"-").concat(h),renderPlaceholder:o,leaf:f,text:s,parent:r,renderLeaf:a}))}var m=e.useCallback((e=>{var t=n_.get(l);e?(null==t||t.set(d,e),e_.set(s,e),$k.set(e,s)):(null==t||t.delete(d),e_.delete(s),c.current&&$k.delete(c.current)),c.current=e}),[c,l,d,s]);return e.createElement("span",{"data-slate-node":"text",ref:m},p)}),((e,t)=>t.parent===e.parent&&t.isLast===e.isLast&&t.renderLeaf===e.renderLeaf&&t.renderPlaceholder===e.renderPlaceholder&&t.text===e.text&&((e,t)=>{if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var i=e[n],r=t[n];if(i.anchor.offset!==r.anchor.offset||i.focus.offset!==r.focus.offset||!q_(i,r))return!1}return!0})(t.decorations,e.decorations))),iT=e.memo((t=>{var{decorations:n,element:i,renderElement:r=(t=>e.createElement(rT,Object.assign({},t))),renderPlaceholder:o,renderLeaf:a,selection:s}=t,l=$_(),c=cT(),u=l.isInline(i),d=V_.findKey(l,i),p=e.useCallback((e=>{var t=n_.get(l);e?(null==t||t.set(d,e),e_.set(i,e),$k.set(e,i)):(null==t||t.delete(d),e_.delete(i))}),[l,d,i]),h=sT({decorations:n,node:i,renderElement:r,renderPlaceholder:o,renderLeaf:a,selection:s}),f={"data-slate-node":"element",ref:p};if(u&&(f["data-slate-inline"]=!0),!u&&vC.hasInlines(l,i)){var m=xC.string(i),v=sS(m);"rtl"===v&&(f.dir=v)}if(vC.isVoid(l,i)){f["data-slate-void"]=!0,!c&&u&&(f.contentEditable=!1);var g=u?"span":"div",[[y]]=xC.texts(i);h=e.createElement(g,{"data-slate-spacer":!0,style:{height:"0",color:"transparent",outline:"none",position:"absolute"}},e.createElement(nT,{renderPlaceholder:o,decorations:[],isLast:!1,parent:i,text:y})),Yk.set(y,0),Xk.set(y,i)}return r({attributes:f,children:h,element:i})}),((e,t)=>e.element===t.element&&e.renderElement===t.renderElement&&e.renderLeaf===t.renderLeaf&&e.renderPlaceholder===t.renderPlaceholder&&((e,t)=>{if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var i=e[n],r=t[n];if(!DC.equals(i,r)||!q_(i,r))return!1}return!0})(e.decorations,t.decorations)&&(e.selection===t.selection||!!e.selection&&!!t.selection&&DC.equals(e.selection,t.selection)))),rT=t=>{var{attributes:n,children:i,element:r}=t,o=$_().isInline(r)?"span":"div";return e.createElement(o,Object.assign({},n,{style:{position:"relative"}}),i)},oT=e.createContext((()=>[])),aT=e.createContext(!1),sT=t=>{for(var{decorations:n,node:i,renderElement:r,renderPlaceholder:o,renderLeaf:a,selection:s}=t,l=e.useContext(oT),c=$_(),u=V_.findPath(c,i),d=[],p=uC.isElement(i)&&!c.isInline(i)&&vC.hasInlines(c,i),h=0;h<i.children.length;h++){var f=u.concat(h),m=i.children[h],v=V_.findKey(c,m),g=vC.range(c,f),y=s&&DC.intersection(g,s),b=l([m,f]);for(var E of n){var x=DC.intersection(E,g);x&&b.push(x)}uC.isElement(m)?d.push(e.createElement(aT.Provider,{key:"provider-".concat(v.id),value:!!y},e.createElement(iT,{decorations:b,element:m,key:v.id,renderElement:r,renderPlaceholder:o,renderLeaf:a,selection:y}))):d.push(e.createElement(nT,{decorations:b,key:v.id,isLast:p&&h===i.children.length-1,parent:i,renderPlaceholder:o,renderLeaf:a,text:m})),Yk.set(m,h),Xk.set(m,i)}return d},lT=e.createContext(!1),cT=()=>e.useContext(lT),uT=e.createContext(null),dT={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},pT={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},hT={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},fT=e=>{var t=dT[e],n=pT[e],i=hT[e],r=t&&Vk(t),o=n&&Vk(n),a=i&&Vk(i);return e=>!(!r||!r(e))||!!(N_&&o&&o(e))||!(N_||!a||!a(e))},mT={isBold:fT("bold"),isCompose:fT("compose"),isMoveBackward:fT("moveBackward"),isMoveForward:fT("moveForward"),isDeleteBackward:fT("deleteBackward"),isDeleteForward:fT("deleteForward"),isDeleteLineBackward:fT("deleteLineBackward"),isDeleteLineForward:fT("deleteLineForward"),isDeleteWordBackward:fT("deleteWordBackward"),isDeleteWordForward:fT("deleteWordForward"),isExtendBackward:fT("extendBackward"),isExtendForward:fT("extendForward"),isExtendLineBackward:fT("extendLineBackward"),isExtendLineForward:fT("extendLineForward"),isItalic:fT("italic"),isMoveLineBackward:fT("moveLineBackward"),isMoveLineForward:fT("moveLineForward"),isMoveWordBackward:fT("moveWordBackward"),isMoveWordForward:fT("moveWordForward"),isRedo:fT("redo"),isSoftBreak:fT("insertSoftBreak"),isSplitBlock:fT("splitBlock"),isTransposeCharacter:fT("transposeCharacter"),isUndo:fT("undo")},vT={subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0};class gT extends e.Component{constructor(){super(...arguments),this.context=null,this.manager=null,this.mutationObserver=null}observe(){var e,{node:t}=this.props;if(!t.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");null===(e=this.mutationObserver)||void 0===e||e.observe(t.current,vT)}componentDidMount(){var{receivedUserInput:e}=this.props,t=this.context;this.manager=((e,t)=>{var n=[],i=()=>{n=[]};return{registerMutations:i=>{if(t.current){var r=i.filter((t=>T_(e,t,i)));n.push(...r)}},restoreDOM:function(){n.length>0&&(n.reverse().forEach((e=>{"characterData"!==e.type&&(e.removedNodes.forEach((t=>{e.target.insertBefore(t,e.nextSibling)})),e.addedNodes.forEach((t=>{e.target.removeChild(t)})))})),i())},clear:i}})(t,e),this.mutationObserver=new MutationObserver(this.manager.registerMutations),this.observe()}getSnapshotBeforeUpdate(){var e,t,n,i,r=null===(e=this.mutationObserver)||void 0===e?void 0:e.takeRecords();return null!=r&&r.length&&(null===(i=this.manager)||void 0===i||i.registerMutations(r)),null===(t=this.mutationObserver)||void 0===t||t.disconnect(),null===(n=this.manager)||void 0===n||n.restoreDOM(),null}componentDidUpdate(){var e;null===(e=this.manager)||void 0===e||e.clear(),this.observe()}componentWillUnmount(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}render(){return this.props.children}}gT.contextType=J_;var yT=M_?gT:t=>{var{children:n}=t;return e.createElement(e.Fragment,null,n)};function bT(e,t){var{path:n,diff:i}=t;if(!vC.hasPath(e,n))return!1;var r=xC.get(e,n);if(!WC.isText(r))return!1;if(i.start!==r.text.length||0===i.text.length)return r.text.slice(i.start,i.start+i.text.length)===i.text;var o=kC.next(n);if(!vC.hasPath(e,o))return!1;var a=xC.get(e,o);return WC.isText(a)&&a.text.startsWith(i.text)}function ET(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce(((e,t)=>e.slice(0,t.start)+t.text+e.slice(t.end)),e)}function xT(e,t){var{start:n,end:i,text:r}=t,o=e.slice(n,i),a=function(e,t){for(var n=Math.min(e.length,t.length),i=0;i<n;i++)if(e.charAt(i)!==t.charAt(i))return i;return n}(o,r),s=function(e,t,n){for(var i=Math.min(e.length,t.length,n),r=0;r<i;r++)if(e.charAt(e.length-r-1)!==t.charAt(t.length-r-1))return r;return i}(o,r,Math.min(o.length-a,r.length-a)),l={start:n+a,end:i-s,text:r.slice(a,r.length-s)};return l.start===l.end&&0===l.text.length?null:l}function wT(e){var{path:t,diff:n}=e;return{anchor:{path:t,offset:n.start},focus:{path:t,offset:n.end}}}function CT(e,t){var{path:n,offset:i}=t;if(!vC.hasPath(e,n))return null;var r=xC.get(e,n);if(!WC.isText(r))return null;var o=vC.above(e,{match:t=>uC.isElement(t)&&vC.isBlock(e,t),at:n});if(!o)return null;for(;i>r.text.length;){var a=vC.next(e,{at:n,match:WC.isText});if(!a||!kC.isDescendant(a[1],o[1]))return null;i-=r.text.length,r=a[0],n=a[1]}return{path:n,offset:i}}function ST(e,t){var n=CT(e,t.anchor);if(!n)return null;if(DC.isCollapsed(t))return{anchor:n,focus:n};var i=CT(e,t.focus);return i?{anchor:n,focus:i}:null}function kT(e,t,n){var i=d_.get(e),r=null==i?void 0:i.find((e=>{var{path:n}=e;return kC.equals(n,t.path)}));if(!r||t.offset<=r.diff.start)return PC.transform(t,n,{affinity:"backward"});var{diff:o}=r;if(t.offset<=o.start+o.text.length){var a={path:t.path,offset:o.start},s=PC.transform(a,n,{affinity:"backward"});return s?{path:s.path,offset:s.offset+t.offset-o.start}:null}var l={path:t.path,offset:t.offset-o.text.length+o.end-o.start},c=PC.transform(l,n,{affinity:"backward"});return c?"split_node"===n.type&&kC.equals(n.path,t.path)&&l.offset<n.position&&o.start<n.position?c:{path:c.path,offset:c.offset+o.text.length-o.end+o.start}:null}function _T(e,t,n){var i=kT(e,t.anchor,n);if(!i)return null;if(DC.isCollapsed(t))return{anchor:i,focus:i};var r=kT(e,t.focus,n);return r?{anchor:i,focus:r}:null}function TT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function IT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TT(Object(n),!0).forEach((function(t){jk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var PT=["node"];function NT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var MT={subtree:!0,childList:!0,characterData:!0};function AT(t){var{node:n}=t,i=Gk(t,PT);if(!M_)return null;var r,o=$_(),a=(r=e.useRef(!1),e.useEffect((()=>(r.current=!0,()=>{r.current=!1})),[]),r.current),[s]=e.useState((()=>function(e){var{editor:t,scheduleOnDOMSelectionChange:n,onDOMSelectionChange:i}=e,r=!1,o=null,a=null,s=null,l=0,c=!1,u=()=>{var e=h_.get(t);if(h_.delete(t),e){var{selection:n}=t,i=ST(t,e);!i||n&&DC.equals(i,n)||aS.select(t,i)}},d=()=>{if(a&&(clearTimeout(a),a=null),s&&(clearTimeout(s),s=null),v()||m()){r||(r=!0,setTimeout((()=>r=!1))),m()&&(r="action");var e=t.selection&&vC.rangeRef(t,t.selection,{affinity:"forward"});u_.set(t,t.marks),p_.get(t),d_.get(t);for(var o,l=v();o=null===(d=d_.get(t))||void 0===d?void 0:d[0];){var d,p,h=c_.get(t);void 0!==h&&(c_.delete(t),t.marks=h),h&&!1===c&&(c=null);var f=wT(o);t.selection&&DC.equals(t.selection,f)||aS.select(t,f),o.diff.text?vC.insertText(t,o.diff.text):vC.deleteFragment(t),d_.set(t,null===(p=d_.get(t))||void 0===p?void 0:p.filter((e=>{var{id:t}=e;return t!==o.id}))),bT(t,o)||(l=!1,p_.delete(t),u_.delete(t),r="action",h_.delete(t),n.cancel(),i.cancel(),null==e||e.unref())}var g=null==e?void 0:e.unref();if(!g||h_.get(t)||t.selection&&DC.equals(g,t.selection)||aS.select(t,g),m())(()=>{var e=p_.get(t);if(p_.delete(t),e){if(e.at){var n=PC.isPoint(e.at)?CT(t,e.at):ST(t,e.at);if(!n)return;var i=vC.range(t,n);t.selection&&DC.equals(t.selection,i)||aS.select(t,n)}e.run()}})();else{l&&n(),n.flush(),i.flush(),u();var y=u_.get(t);u_.delete(t),void 0!==y&&(t.marks=y,t.onChange())}}else u()},p=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Jk.get(t);n&&(v()||e?n.style.display="none":n.style.removeProperty("display"))},h=(e,n)=>{var i,r=null!==(i=d_.get(t))&&void 0!==i?i:[];d_.set(t,r);var o=xC.leaf(t,e),a=r.findIndex((t=>kC.equals(t.path,e)));if(a<0)return xT(o.text,n)&&r.push({path:e,diff:n,id:l++}),void p();var s=function(e,t,n){var i=Math.min(t.start,n.start),r=Math.max(0,Math.min(t.start+t.text.length,n.end)-n.start),o=ET(e,t,n),a=Math.max(n.start+n.text.length,t.start+t.text.length+(t.start+t.text.length>n.start?n.text.length:0)-r),s=o.slice(i,a);return xT(e,{start:i,end:Math.max(t.end,n.end-t.text.length+(t.end-t.start)),text:s})}(o.text,r[a].diff,n);if(!s)return r.splice(a,1),void p();r[a]=IT(IT({},r[a]),{},{diff:s})},f=function(e){var{at:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c=!1,h_.delete(t),n.cancel(),i.cancel(),m()&&d(),p_.set(t,{at:r,run:e}),s=setTimeout(d)},m=()=>!!p_.get(t),v=()=>{var e;return!(null===(e=d_.get(t))||void 0===e||!e.length)},g=e=>{h_.set(t,e),a&&(clearTimeout(a),a=null);var{selection:n}=t;if(e){var i=!n||!kC.equals(n.anchor.path,e.anchor.path),r=!n||!kC.equals(n.anchor.path.slice(0,-1),e.anchor.path.slice(0,-1));(i&&c||r)&&(c=!1),(i||v())&&(a=setTimeout(d,200))}},y=()=>{m()||(s=setTimeout(d))};return{flush:d,scheduleFlush:y,hasPendingDiffs:v,hasPendingAction:m,hasPendingChanges:()=>m()||v(),isFlushing:()=>r,handleUserSelect:g,handleCompositionEnd:e=>{o&&clearTimeout(o),o=setTimeout((()=>{o_.set(t,!1),d()}),25)},handleCompositionStart:e=>{o_.set(t,!0),o&&(clearTimeout(o),o=null)},handleDOMBeforeInput:e=>{var n;a&&(clearTimeout(a),a=null);var{inputType:i}=e,r=null,o=e.dataTransfer||e.data||void 0;!1!==c&&"insertText"!==i&&"insertCompositionText"!==i&&(c=!1);var[s]=e.getTargetRanges();s&&(r=V_.toSlateRange(t,s,{exactMatch:!1,suppressThrow:!0}));var l=V_.getWindow(t).getSelection();if(!r&&l&&(s=l,r=V_.toSlateRange(t,l,{exactMatch:!1,suppressThrow:!0})),r=null!==(n=r)&&void 0!==n?n:t.selection){var u=!0;if(i.startsWith("delete")){if(DC.isExpanded(r)){var[d,p]=DC.edges(r);if(xC.leaf(t,d.path).text.length===d.offset&&0===p.offset){var m=vC.next(t,{at:d.path,match:WC.isText});m&&kC.equals(m[1],p.path)&&(r={anchor:p,focus:p})}}var v=i.endsWith("Backward")?"backward":"forward",[b,E]=DC.edges(r),[x,w]=vC.leaf(t,b.path),C={text:"",start:b.offset,end:E.offset},S=d_.get(t),k=null==S?void 0:S.find((e=>kC.equals(e.path,w))),_=k?[k.diff,C]:[C];if(0===ET(x.text,..._).length&&(u=!1),DC.isExpanded(r)){if(u&&kC.equals(r.anchor.path,r.focus.path)){var T={path:r.anchor.path,offset:b.offset},I=vC.range(t,T,T);return g(I),h(r.anchor.path,{text:"",end:E.offset,start:b.offset})}return f((()=>vC.deleteFragment(t,{direction:v})),{at:r})}}switch(i){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":return f((()=>vC.deleteFragment(t)),{at:r});case"deleteContent":case"deleteContentForward":var{anchor:P}=r;if(u&&DC.isCollapsed(r)){var N=xC.leaf(t,P.path);if(P.offset<N.text.length)return h(P.path,{text:"",start:P.offset,end:P.offset+1})}return f((()=>vC.deleteForward(t)),{at:r});case"deleteContentBackward":var M,{anchor:A}=r,D=x_(s)?s.isCollapsed:!(null===(M=s)||void 0===M||!M.collapsed);return u&&D&&DC.isCollapsed(r)&&A.offset>0?h(A.path,{text:"",start:A.offset-1,end:A.offset}):f((()=>vC.deleteBackward(t)),{at:r});case"deleteEntireSoftLine":return f((()=>{vC.deleteBackward(t,{unit:"line"}),vC.deleteForward(t,{unit:"line"})}),{at:r});case"deleteHardLineBackward":return f((()=>vC.deleteBackward(t,{unit:"block"})),{at:r});case"deleteSoftLineBackward":return f((()=>vC.deleteBackward(t,{unit:"line"})),{at:r});case"deleteHardLineForward":return f((()=>vC.deleteForward(t,{unit:"block"})),{at:r});case"deleteSoftLineForward":return f((()=>vC.deleteForward(t,{unit:"line"})),{at:r});case"deleteWordBackward":return f((()=>vC.deleteBackward(t,{unit:"word"})),{at:r});case"deleteWordForward":return f((()=>vC.deleteForward(t,{unit:"word"})),{at:r});case"insertLineBreak":return f((()=>vC.insertSoftBreak(t)),{at:r});case"insertParagraph":return f((()=>vC.insertBreak(t)),{at:r});case"insertCompositionText":case"deleteCompositionText":case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":if("DataTransfer"===(null==o?void 0:o.constructor.name))return f((()=>V_.insertData(t,o)),{at:r});if("string"==typeof o&&o.includes("\n"))return f((()=>vC.insertSoftBreak(t)),{at:DC.end(r)});var R=null!=o?o:"";if(c_.get(t)&&(R=R.replace("\ufeff","")),kC.equals(r.anchor.path,r.focus.path)){var[B,L]=DC.edges(r),O={start:B.offset,end:L.offset,text:R};if(R&&c&&"insertCompositionText"===i){var F=c.start+c.text.search(/\S|$/);O.start+O.text.search(/\S|$/)===F+1&&O.end===c.start+c.text.length?(O.start-=1,c=null,y()):c=!1}else c="insertText"===i&&(null===c?O:!(!c||!DC.isCollapsed(r)||c.end+c.text.length!==B.offset)&&IT(IT({},c),{},{text:c.text+R}));if(u)return void h(B.path,O)}return f((()=>vC.insertText(t,R)),{at:r})}}},handleKeyDown:e=>{v()||(p(!0),setTimeout(p))},handleDomMutations:e=>{var n;v()||m()||e.some((n=>T_(t,n,e)))&&(null===(n=f_.get(t))||void 0===n||n())},handleInput:()=>{!m()&&v()||d()}}}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NT(Object(n),!0).forEach((function(t){jk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({editor:o},i))));return function(t,n,i){var[r]=e.useState((()=>new MutationObserver(n)));K_((()=>{r.takeRecords()})),e.useEffect((()=>{if(!t.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");return r.observe(t.current,i),()=>r.disconnect()}),[])}(n,s.handleDomMutations,MT),l_.set(o,s.scheduleFlush),a&&s.flush(),s}var DT=["autoFocus","decorate","onDOMBeforeInput","placeholder","readOnly","renderElement","renderLeaf","renderPlaceholder","scrollSelectionIntoView","style","as","disableDefaultStyles"],RT=["text"];function BT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function LT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?BT(Object(n),!0).forEach((function(t){jk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var OT=t=>e.createElement(e.Fragment,null,sT(t)),FT=t=>{var n,i,r=e.useCallback((t=>e.createElement(zT,Object.assign({},t))),[]),{autoFocus:o,decorate:a=HT,onDOMBeforeInput:s,placeholder:l,readOnly:c=!1,renderElement:u,renderLeaf:d,renderPlaceholder:p=r,scrollSelectionIntoView:h=UT,style:f={},as:m="div",disableDefaultStyles:v=!1}=t,g=Gk(t,DT),y=(()=>{var t=e.useContext(uT);if(!t)throw new Error("The `useSlate` hook must be used inside the <Slate> component's context.");var{editor:n}=t;return n})(),[b,E]=e.useState(!1),x=e.useRef(null),w=e.useRef([]),{onUserInput:C,receivedUserInput:S}=function(){var t=$_(),n=e.useRef(!1),i=e.useRef(0),r=e.useCallback((()=>{if(!n.current){n.current=!0;var e=V_.getWindow(t);e.cancelAnimationFrame(i.current),i.current=e.requestAnimationFrame((()=>{n.current=!1}))}}),[]);return e.useEffect((()=>()=>cancelAnimationFrame(i.current)),[]),{receivedUserInput:n,onUserInput:r}}(),[,k]=e.useReducer((e=>e+1),0);f_.set(y,k),i_.set(y,c);var _=e.useMemo((()=>({isDraggingInternally:!1,isUpdatingSelection:!1,latestElement:null,hasMarkPlaceholder:!1})),[]);e.useEffect((()=>{x.current&&o&&x.current.focus()}),[o]);var T=e.useCallback(function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return US(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),HS(e,t,{leading:i,maxWait:t,trailing:r})}((()=>{if((M_||!V_.isComposing(y))&&(!_.isUpdatingSelection||null!=P&&P.isFlushing())&&!_.isDraggingInternally){var e=V_.findDocumentOrShadowRoot(y),{activeElement:t}=e,n=V_.toDOMNode(y,y),i=e.getSelection();if(t===n?(_.latestElement=t,r_.set(y,!0)):r_.delete(y),!i)return aS.deselect(y);var{anchorNode:r,focusNode:o}=i,a=V_.hasEditableTarget(y,r)||V_.isTargetInsideNonReadonlyVoid(y,r),s=V_.hasEditableTarget(y,o)||V_.isTargetInsideNonReadonlyVoid(y,o);if(a&&s){var l=V_.toSlateRange(y,i,{exactMatch:!1,suppressThrow:!0});l&&(V_.isComposing(y)||null!=P&&P.hasPendingChanges()||null!=P&&P.isFlushing()?null==P||P.handleUserSelect(l):aS.select(y,l))}!c||a&&s||aS.deselect(y)}}),100),[c]),I=e.useMemo((()=>zS(T,0)),[T]),P=AT({node:x,onDOMSelectionChange:T,scheduleOnDOMSelectionChange:I});K_((()=>{var e;x.current&&(e=y_(x.current))?(Qk.set(y,e),Zk.set(y,x.current),e_.set(y,x.current),$k.set(x.current,y)):e_.delete(y);var{selection:t}=y,n=V_.findDocumentOrShadowRoot(y).getSelection();if(n&&V_.isFocused(y)&&(null==P||!P.hasPendingAction())){var i=e=>{var i="None"!==n.type;if(t||i){var r=Zk.get(y),o=!1;if(r.contains(n.anchorNode)&&r.contains(n.focusNode)&&(o=!0),i&&o&&t&&!e){var a=V_.toSlateRange(y,n,{exactMatch:!0,suppressThrow:!0});if(a&&DC.equals(a,t)){var s;if(!_.hasMarkPlaceholder)return;var{anchorNode:l}=n;if(null!=l&&null!==(s=l.parentElement)&&void 0!==s&&s.hasAttribute("data-slate-mark-placeholder"))return}}if(!t||V_.hasRange(y,t)){_.isUpdatingSelection=!0;var c=t&&V_.toDOMRange(y,t);return c?(DC.isBackward(t)?n.setBaseAndExtent(c.endContainer,c.endOffset,c.startContainer,c.startOffset):n.setBaseAndExtent(c.startContainer,c.startOffset,c.endContainer,c.endOffset),h(y,c)):n.removeAllRanges(),c}y.selection=V_.toSlateRange(y,n,{exactMatch:!1,suppressThrow:!0})}},r=i(),o="action"===(null==P?void 0:P.isFlushing());if(M_&&o){var a=null,s=requestAnimationFrame((()=>{if(o){var e=e=>{try{V_.toDOMNode(y,y).focus(),i(e)}catch(e){}};e(),a=setTimeout((()=>{e(!0),_.isUpdatingSelection=!1}))}}));return()=>{cancelAnimationFrame(s),a&&clearTimeout(a)}}setTimeout((()=>{r&&A_&&V_.toDOMNode(y,y).focus(),_.isUpdatingSelection=!1}))}}));var N=e.useCallback((e=>{if(C(),!c&&V_.hasEditableTarget(y,e.target)&&!VT(e,s)){var t;if(P)return P.handleDOMBeforeInput(e);I.flush(),T.flush();var{selection:n}=y,{inputType:i}=e,r=e.dataTransfer||e.data||void 0,o="insertCompositionText"===i||"deleteCompositionText"===i;if(o&&V_.isComposing(y))return;var a=!1;if("insertText"===i&&n&&DC.isCollapsed(n)&&e.data&&1===e.data.length&&/[a-z ]/i.test(e.data)&&0!==n.anchor.offset){var l,u;a=!0,y.marks&&(a=!1);var{anchor:d}=n,[p,h]=V_.toDOMPoint(y,d),f=null===(l=p.parentElement)||void 0===l?void 0:l.closest("a"),m=V_.getWindow(y);if(a&&f&&V_.hasDOMNode(y,f)){var v,g=null==m?void 0:m.document.createTreeWalker(f,NodeFilter.SHOW_TEXT).lastChild();g===p&&(null===(v=g.textContent)||void 0===v?void 0:v.length)===h&&(a=!1)}if(a&&p.parentElement&&"pre"===(null==m||null===(u=m.getComputedStyle(p.parentElement))||void 0===u?void 0:u.whiteSpace)){var b=vC.above(y,{at:d.path,match:e=>uC.isElement(e)&&vC.isBlock(y,e)});b&&xC.string(b[0]).includes("\t")&&(a=!1)}}if(!i.startsWith("delete")||i.startsWith("deleteBy")){var[x]=e.getTargetRanges();if(x){var S=V_.toSlateRange(y,x,{exactMatch:!1,suppressThrow:!1});if(!n||!DC.equals(n,S)){a=!1;var k=!o&&y.selection&&vC.rangeRef(y,y.selection);aS.select(y,S),k&&a_.set(y,k)}}}if(o)return;if(a||e.preventDefault(),n&&DC.isExpanded(n)&&i.startsWith("delete")){var _=i.endsWith("Backward")?"backward":"forward";return void vC.deleteFragment(y,{direction:_})}switch(i){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":vC.deleteFragment(y);break;case"deleteContent":case"deleteContentForward":vC.deleteForward(y);break;case"deleteContentBackward":vC.deleteBackward(y);break;case"deleteEntireSoftLine":vC.deleteBackward(y,{unit:"line"}),vC.deleteForward(y,{unit:"line"});break;case"deleteHardLineBackward":vC.deleteBackward(y,{unit:"block"});break;case"deleteSoftLineBackward":vC.deleteBackward(y,{unit:"line"});break;case"deleteHardLineForward":vC.deleteForward(y,{unit:"block"});break;case"deleteSoftLineForward":vC.deleteForward(y,{unit:"line"});break;case"deleteWordBackward":vC.deleteBackward(y,{unit:"word"});break;case"deleteWordForward":vC.deleteForward(y,{unit:"word"});break;case"insertLineBreak":vC.insertSoftBreak(y);break;case"insertParagraph":vC.insertBreak(y);break;case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":"insertFromComposition"===i&&V_.isComposing(y)&&(E(!1),o_.set(y,!1)),"DataTransfer"===(null==r?void 0:r.constructor.name)?V_.insertData(y,r):"string"==typeof r&&(a?w.current.push((()=>vC.insertText(y,r))):vC.insertText(y,r))}var N=null===(t=a_.get(y))||void 0===t?void 0:t.unref();a_.delete(y),!N||y.selection&&DC.equals(y.selection,N)||aS.select(y,N)}}),[c,s]),M=e.useCallback((e=>{null==e?(T.cancel(),I.cancel(),Zk.delete(y),e_.delete(y),x.current&&W_&&x.current.removeEventListener("beforeinput",N)):W_&&e.addEventListener("beforeinput",N),x.current=e}),[x,N,T,I]);K_((()=>{var e=V_.getWindow(y);return e.document.addEventListener("selectionchange",I),()=>{e.document.removeEventListener("selectionchange",I)}}),[I]);var A=a([y,[]]);if(l&&1===y.children.length&&1===Array.from(xC.texts(y)).length&&""===xC.string(y)&&!b){var D=vC.start(y,[]);A.push({[m_]:!0,placeholder:l,anchor:D,focus:D})}var{marks:R}=y;if(_.hasMarkPlaceholder=!1,y.selection&&DC.isCollapsed(y.selection)&&R){var{anchor:B}=y.selection,L=xC.leaf(y,B.path),O=Gk(L,RT);if(!WC.equals(L,R,{loose:!0})){_.hasMarkPlaceholder=!0;var F=Object.fromEntries(Object.keys(O).map((e=>[e,null])));A.push(LT(LT(LT({[v_]:!0},F),R),{},{anchor:B,focus:B}))}}e.useEffect((()=>{setTimeout((()=>{var{selection:e}=y;if(e){var{anchor:t}=e,n=xC.leaf(y,t.path);if(R&&!WC.equals(n,R,{loose:!0}))return void c_.set(y,R)}c_.delete(y)}))}));var z=null===(n=Jk.get(y))||void 0===n||null===(i=n.getBoundingClientRect())||void 0===i?void 0:i.height;return e.createElement(lT.Provider,{value:c},e.createElement(oT.Provider,{value:a},e.createElement(yT,{node:x,receivedUserInput:S},e.createElement(m,Object.assign({role:c?void 0:"textbox","aria-multiline":!c||void 0},g,{spellCheck:!(!W_&&U_)&&g.spellCheck,autoCorrect:W_||!U_?g.autoCorrect:"false",autoCapitalize:W_||!U_?g.autoCapitalize:"false","data-slate-editor":!0,"data-slate-node":"value",contentEditable:!c,zindex:-1,suppressContentEditableWarning:!0,ref:M,style:LT(LT({},v?{}:LT({position:"relative",outline:"none",whiteSpace:"pre-wrap",wordWrap:"break-word"},z?{minHeight:z}:{})),f),onBeforeInput:e.useCallback((e=>{if(!W_&&!c&&!WT(e,g.onBeforeInput)&&V_.hasSelectableTarget(y,e.target)&&(e.preventDefault(),!V_.isComposing(y))){var t=e.data;vC.insertText(y,t)}}),[c]),onInput:e.useCallback((e=>{if(!WT(e,g.onInput))if(P)P.handleInput();else{for(var t of w.current)t();w.current=[]}}),[]),onBlur:e.useCallback((e=>{if(!c&&!_.isUpdatingSelection&&V_.hasSelectableTarget(y,e.target)&&!WT(e,g.onBlur)){var t=V_.findDocumentOrShadowRoot(y);if(_.latestElement!==t.activeElement){var{relatedTarget:n}=e;if(!(n===V_.toDOMNode(y,y)||b_(n)&&n.hasAttribute("data-slate-spacer"))){if(null!=n&&E_(n)&&V_.hasDOMNode(y,n)){var i=V_.toSlateNode(y,n);if(uC.isElement(i)&&!y.isVoid(i))return}if(D_){var r=t.getSelection();null==r||r.removeAllRanges()}r_.delete(y)}}}}),[c,g.onBlur]),onClick:e.useCallback((e=>{if(V_.hasTarget(y,e.target)&&!WT(e,g.onClick)&&E_(e.target)){var t=V_.toSlateNode(y,e.target),n=V_.findPath(y,t);if(!vC.hasPath(y,n)||xC.get(y,n)!==t)return;if(3===e.detail&&n.length>=1){var i=n;if(!uC.isElement(t)||!vC.isBlock(y,t)){var r,o=vC.above(y,{match:e=>uC.isElement(e)&&vC.isBlock(y,e),at:n});i=null!==(r=null==o?void 0:o[1])&&void 0!==r?r:n.slice(0,1)}var a=vC.range(y,i);return void aS.select(y,a)}if(c)return;var s=vC.start(y,n),l=vC.end(y,n),u=vC.void(y,{at:s}),d=vC.void(y,{at:l});if(u&&d&&kC.equals(u[1],d[1])){var p=vC.range(y,s);aS.select(y,p)}}}),[c,g.onClick]),onCompositionEnd:e.useCallback((e=>{if(V_.hasSelectableTarget(y,e.target)){if(V_.isComposing(y)&&(E(!1),o_.set(y,!1)),null==P||P.handleCompositionEnd(e),WT(e,g.onCompositionEnd)||M_)return;if(!D_&&!F_&&!P_&&!H_&&!z_&&e.data){var t=c_.get(y);c_.delete(y),void 0!==t&&(u_.set(y,y.marks),y.marks=t),vC.insertText(y,e.data);var n=u_.get(y);u_.delete(y),void 0!==n&&(y.marks=n)}}}),[g.onCompositionEnd]),onCompositionUpdate:e.useCallback((e=>{V_.hasSelectableTarget(y,e.target)&&!WT(e,g.onCompositionUpdate)&&(V_.isComposing(y)||(E(!0),o_.set(y,!0)))}),[g.onCompositionUpdate]),onCompositionStart:e.useCallback((e=>{if(V_.hasSelectableTarget(y,e.target)){if(null==P||P.handleCompositionStart(e),WT(e,g.onCompositionStart)||M_)return;E(!0);var{selection:t}=y;if(t){if(DC.isExpanded(t))return void vC.deleteFragment(y);var n=vC.above(y,{match:e=>uC.isElement(e)&&vC.isInline(y,e),mode:"highest"});if(n){var[,i]=n;if(vC.isEnd(y,t.anchor,i)){var r=vC.after(y,i);aS.setSelection(y,{anchor:r,focus:r})}}}}}),[g.onCompositionStart]),onCopy:e.useCallback((e=>{V_.hasSelectableTarget(y,e.target)&&!WT(e,g.onCopy)&&(e.preventDefault(),V_.setFragmentData(y,e.clipboardData,"copy"))}),[g.onCopy]),onCut:e.useCallback((e=>{if(!c&&V_.hasSelectableTarget(y,e.target)&&!WT(e,g.onCut)){e.preventDefault(),V_.setFragmentData(y,e.clipboardData,"cut");var{selection:t}=y;if(t)if(DC.isExpanded(t))vC.deleteFragment(y);else{var n=xC.parent(y,t.anchor.path);vC.isVoid(y,n)&&aS.delete(y)}}}),[c,g.onCut]),onDragOver:e.useCallback((e=>{if(V_.hasTarget(y,e.target)&&!WT(e,g.onDragOver)){var t=V_.toSlateNode(y,e.target);uC.isElement(t)&&vC.isVoid(y,t)&&e.preventDefault()}}),[g.onDragOver]),onDragStart:e.useCallback((e=>{if(!c&&V_.hasTarget(y,e.target)&&!WT(e,g.onDragStart)){var t=V_.toSlateNode(y,e.target),n=V_.findPath(y,t);if(uC.isElement(t)&&vC.isVoid(y,t)||vC.void(y,{at:n,voids:!0})){var i=vC.range(y,n);aS.select(y,i)}_.isDraggingInternally=!0,V_.setFragmentData(y,e.dataTransfer,"drag")}}),[c,g.onDragStart]),onDrop:e.useCallback((e=>{if(!c&&V_.hasTarget(y,e.target)&&!WT(e,g.onDrop)){e.preventDefault();var t=y.selection,n=V_.findEventRange(y,e),i=e.dataTransfer;aS.select(y,n),_.isDraggingInternally&&(!t||DC.equals(t,n)||vC.void(y,{at:n,voids:!0})||aS.delete(y,{at:t})),V_.insertData(y,i),V_.isFocused(y)||V_.focus(y)}_.isDraggingInternally=!1}),[c,g.onDrop]),onDragEnd:e.useCallback((e=>{!c&&_.isDraggingInternally&&g.onDragEnd&&V_.hasTarget(y,e.target)&&g.onDragEnd(e),_.isDraggingInternally=!1}),[c,g.onDragEnd]),onFocus:e.useCallback((e=>{if(!c&&!_.isUpdatingSelection&&V_.hasEditableTarget(y,e.target)&&!WT(e,g.onFocus)){var t=V_.toDOMNode(y,y),n=V_.findDocumentOrShadowRoot(y);if(_.latestElement=n.activeElement,A_&&e.target!==t)return void t.focus();r_.set(y,!0)}}),[c,g.onFocus]),onKeyDown:e.useCallback((e=>{if(!c&&V_.hasEditableTarget(y,e.target)){null==P||P.handleKeyDown(e);var{nativeEvent:t}=e;if(V_.isComposing(y)&&!1===t.isComposing&&(o_.set(y,!1),E(!1)),WT(e,g.onKeyDown)||V_.isComposing(y))return;var{selection:n}=y,i=y.children[null!==n?n.focus.path[0]:0],r="rtl"===sS(xC.string(i));if(mT.isRedo(t)){e.preventDefault();var o=y;return void("function"==typeof o.redo&&o.redo())}if(mT.isUndo(t)){e.preventDefault();var a=y;return void("function"==typeof a.undo&&a.undo())}if(mT.isMoveLineBackward(t))return e.preventDefault(),void aS.move(y,{unit:"line",reverse:!0});if(mT.isMoveLineForward(t))return e.preventDefault(),void aS.move(y,{unit:"line"});if(mT.isExtendLineBackward(t))return e.preventDefault(),void aS.move(y,{unit:"line",edge:"focus",reverse:!0});if(mT.isExtendLineForward(t))return e.preventDefault(),void aS.move(y,{unit:"line",edge:"focus"});if(mT.isMoveBackward(t))return e.preventDefault(),void(n&&DC.isCollapsed(n)?aS.move(y,{reverse:!r}):aS.collapse(y,{edge:"start"}));if(mT.isMoveForward(t))return e.preventDefault(),void(n&&DC.isCollapsed(n)?aS.move(y,{reverse:r}):aS.collapse(y,{edge:"end"}));if(mT.isMoveWordBackward(t))return e.preventDefault(),n&&DC.isExpanded(n)&&aS.collapse(y,{edge:"focus"}),void aS.move(y,{unit:"word",reverse:!r});if(mT.isMoveWordForward(t))return e.preventDefault(),n&&DC.isExpanded(n)&&aS.collapse(y,{edge:"focus"}),void aS.move(y,{unit:"word",reverse:r});if(W_){if((B_||D_)&&n&&(mT.isDeleteBackward(t)||mT.isDeleteForward(t))&&DC.isCollapsed(n)){var s=xC.parent(y,n.anchor.path);if(uC.isElement(s)&&vC.isVoid(y,s)&&(vC.isInline(y,s)||vC.isBlock(y,s)))return e.preventDefault(),void vC.deleteBackward(y,{unit:"block"})}}else{if(mT.isBold(t)||mT.isItalic(t)||mT.isTransposeCharacter(t))return void e.preventDefault();if(mT.isSoftBreak(t))return e.preventDefault(),void vC.insertSoftBreak(y);if(mT.isSplitBlock(t))return e.preventDefault(),void vC.insertBreak(y);if(mT.isDeleteBackward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"backward"}):vC.deleteBackward(y));if(mT.isDeleteForward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"forward"}):vC.deleteForward(y));if(mT.isDeleteLineBackward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"backward"}):vC.deleteBackward(y,{unit:"line"}));if(mT.isDeleteLineForward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"forward"}):vC.deleteForward(y,{unit:"line"}));if(mT.isDeleteWordBackward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"backward"}):vC.deleteBackward(y,{unit:"word"}));if(mT.isDeleteWordForward(t))return e.preventDefault(),void(n&&DC.isExpanded(n)?vC.deleteFragment(y,{direction:"forward"}):vC.deleteForward(y,{unit:"word"}))}}}),[c,g.onKeyDown]),onPaste:e.useCallback((e=>{c||!V_.hasEditableTarget(y,e.target)||WT(e,g.onPaste)||W_&&!(e=>e.clipboardData&&""!==e.clipboardData.getData("text/plain")&&1===e.clipboardData.types.length)(e.nativeEvent)||(e.preventDefault(),V_.insertData(y,e.clipboardData))}),[c,g.onPaste])}),e.createElement(OT,{decorations:A,node:y,renderElement:u,renderPlaceholder:p,renderLeaf:d,selection:y.selection})))))},zT=t=>{var{attributes:n,children:i}=t;return e.createElement("span",Object.assign({},n),i,M_&&e.createElement("br",null))},HT=()=>[],UT=(e,t)=>{if(t.getBoundingClientRect&&(!e.selection||e.selection&&DC.isCollapsed(e.selection))){var n=t.startContainer.parentElement;n.getBoundingClientRect=t.getBoundingClientRect.bind(t),function(e,t){var n=e.isConnected||e.ownerDocument.documentElement.contains(e);if(KS(t)&&"function"==typeof t.behavior)return t.behavior(n?qS(e,t):[]);if(n){var i=function(e){return!1===e?{block:"end",inline:"nearest"}:KS(e)?e:{block:"start",inline:"nearest"}}(t);(function(e,t){void 0===t&&(t="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var i=e.el,r=e.top,o=e.left;i.scroll&&n?i.scroll({top:r,left:o,behavior:t}):(i.scrollTop=r,i.scrollLeft=o)}))})(qS(e,i),i.behavior)}}(n,{scrollMode:"if-needed"}),delete n.getBoundingClientRect}},WT=(e,t)=>{if(!t)return!1;var n=t(e);return null!=n?n:e.isDefaultPrevented()||e.isPropagationStopped()},VT=(e,t)=>{if(!t)return!1;var n=t(e);return null!=n?n:e.defaultPrevented},jT=e.createContext(!1),GT=e.createContext({}),qT=["editor","children","onChange","value"],KT=t=>{var{editor:n,children:i,onChange:r,value:o}=t,a=Gk(t,qT),s=e.useRef(!1),[l,c]=e.useState((()=>{if(!xC.isNodeList(o))throw new Error("[Slate] value is invalid! Expected a list of elements but got: ".concat(LC.stringify(o)));if(!vC.isEditor(n))throw new Error("[Slate] editor is invalid! You passed: ".concat(LC.stringify(n)));return n.children=o,Object.assign(n,a),{v:0,editor:n}})),{selectorContext:u,onChange:d}=function(t){var n=e.useRef([]).current,i=e.useRef({editor:t}).current,r=e.useCallback((e=>{i.editor=e,n.forEach((t=>t(e)))}),[]);return{selectorContext:e.useMemo((()=>({getSlate:()=>i.editor,addEventListener:e=>(n.push(e),()=>{n.splice(n.indexOf(e),1)})})),[n,i]),onChange:r}}(n),p=e.useCallback((()=>{r&&r(n.children),c((e=>({v:e.v+1,editor:n}))),d(n)}),[r]);e.useEffect((()=>(s_.set(n,p),()=>{s_.set(n,(()=>{})),s.current=!0})),[p]);var[h,f]=e.useState(V_.isFocused(n));return e.useEffect((()=>{f(V_.isFocused(n))})),K_((()=>{var e=()=>f(V_.isFocused(n));return I_?(document.addEventListener("focusin",e),document.addEventListener("focusout",e),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",e)}):(document.addEventListener("focus",e,!0),document.addEventListener("blur",e,!0),()=>{document.removeEventListener("focus",e,!0),document.removeEventListener("blur",e,!0)})}),[]),e.createElement(GT.Provider,{value:u},e.createElement(uT.Provider,{value:l},e.createElement(J_.Provider,{value:l.editor},e.createElement(jT.Provider,{value:h},i))))},YT=(e,t)=>{var n=(t.top+t.bottom)/2;return e.top<=n&&e.bottom>=n},XT=(e,t,n)=>{var i=V_.toDOMRange(e,t).getBoundingClientRect(),r=V_.toDOMRange(e,n).getBoundingClientRect();return YT(i,r)&&YT(r,i)};function QT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ZT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QT(Object(n),!0).forEach((function(t){jk(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QT(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var JT=(e,t)=>{var n=[];for(var[i,r]of vC.levels(e,{at:t})){var o=V_.findKey(e,i);n.push([r,o])}return n},$T="panel_cBaOW",eI="viewport_3E_T_",tI="phone_sJL1i",nI="list_2d87t",iI="row_kKkyD",rI="avatar_2YMZh",oI="userName_65nEG",aI="info_388sG",sI="selected_hhIDs",lI=function(t){var n=t.element,i=t.attributes,r=t.children,o=e.useContext(aT),a=e.useContext(jT);return e.createElement("span",exports.E({},i,{contentEditable:!1,className:j("mentionEle_B33RQ",o&&a&&"focus_2YKUk"),"data-ismention":!0}),r,"@",n.userName," ")},cI=e.createContext({domContainer:null,editor:null,editable:!1}),uI=function(e,t){var n,i,r={type:"mention",userName:null!==(n=t.groupName)&&void 0!==n?n:t.userName,ids:null!==(i=t.userIds)&&void 0!==i?i:[t.loginName],children:[{text:""}]};aS.insertNodes(e,r),aS.move(e),V_.focus(e)},dI=function(t,n){var i=W().getUpimeTrans,r=e.useContext(xl).upime,o=e.useState(null),a=o[0],s=o[1],l=e.useState(0),c=l[0],u=l[1],d=e.useRef(""),p=e.useRef(null),h=e.useRef(null),f=e.useRef(""),m=e.useState([]),v=m[0],g=m[1],y=e.useRef(0),b=e.useCallback((function(){return A(void 0,void 0,void 0,(function(){var e,t,n;return D(this,(function(o){switch(o.label){case 0:return e=r.getMentionCandidate,t=r.getMentionGroupAndCandidate,e?[4,e()]:[3,2];case 1:return n=o.sent(),p.current=n,h.current=[{groupName:i("all.group.members"),userIds:n.map((function(e){return e.loginName}))}],[3,5];case 2:return t?[4,t()]:[3,4];case 3:return n=o.sent(),p.current=n.users,h.current=n.groups,[3,5];case 4:p.current=null,h.current=null,o.label=5;case 5:return[2]}}))}))}),[]);e.useEffect((function(){b()}),[]);var E=e.useCallback(te((function(){var e=p.current,t=h.current,n=f.current||d.current,i=[];t&&t.length&&i.push.apply(i,t.filter((function(e){return e.groupName.startsWith(n)}))),y.current=i.length,e&&e.length>0&&i.push.apply(i,e.filter((function(e){return-1!==e.userName.toLocaleLowerCase().search(n.toLocaleLowerCase())}))),g(i)}),200),[]);e.useEffect((function(){null!==a&&E()}),[d,a]);var x=e.useCallback((function(e){var n;if(a&&(null===(n=p.current)||void 0===n?void 0:n.length))switch(a&&e.stopPropagation(),e.key){case"ArrowDown":e.preventDefault();var i=c>=v.length-1?0:c+1;u(i);break;case"ArrowUp":e.preventDefault();var r=c<=0?v.length-1:c-1;u(r);break;case"Enter":e.preventDefault(),aS.select(t,a),uI(t,v[c]),s(null);break;case"Escape":a&&(e.preventDefault(),e.stopPropagation(),s(null))}}),[c,a,v]);return{mentionEditorChange:function(){return A(void 0,void 0,void 0,(function(){var e,i,r,o,a,l,c,p,h,f,m,v;return D(this,(function(g){if(!n)return[2];if((e=t.selection)&&DC.isCollapsed(e)){if(i=DC.edges(e)[0],"@"===((r=vC.before(t,e,{unit:"character"}))&&vC.string(t,vC.range(t,r,i))))return s(vC.range(t,r,i)),d.current="",E(),u(0),[2];if(o=vC.before(t,i,{unit:"word"}),a=o&&vC.before(t,o),l=a&&vC.range(t,a,i),c=l&&vC.string(t,l),p=c&&c.match(/^@((\w|[\u3400-\u9FBF])+)$/),h=vC.after(t,i),f=vC.range(t,i,h),m=vC.string(t,f),v=m.match(/^(\s|$)/),p&&v)return s(l),d.current=p[1],E(),u(0),[2]}return s(null),[2]}))}))},mentionKeyDown:x,mentionIndex:c,mentionTarget:a,members:v,groupSize:y.current,setMemberListIndex:u,onCompositionUpdate:function(e){f.current=e.data,E()},onCompositionEnd:function(e){f.current=""}}},pI=e.forwardRef((function(n,i){var r=n.editable,o=e.useContext(cI),a=o.editor,s=o.domContainer,l=e.useContext(Ic).rootContainer,c=e.useContext(xl).upime,u=e.useRef(null),d=e.useRef(null),p=dI(a,r),h=p.mentionIndex,f=p.mentionTarget,m=p.mentionEditorChange,v=p.mentionKeyDown,g=p.members,y=p.groupSize,b=p.setMemberListIndex,E=p.onCompositionUpdate,x=p.onCompositionEnd;e.useImperativeHandle(i,(function(){return{handleChange:function(){return m()},handleKeydown:function(e){return v(e)},onCompositionUpdate:function(e){return E(e)},onCompositionEnd:function(e){return x(e)}}}));var w=function(e){f&&setTimeout((function(){aS.select(a,f),uI(a,e)}))},C=e.useRef(0);return e.useEffect((function(){function e(){C.current+=1}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),e.useEffect((function(){var e,t;if(u.current){var n=u.current;if(f&&g.length>0){var i=V_.toDOMRange(a,f).getBoundingClientRect(),r=s.getBoundingClientRect();c.phoneMode||i.top-(null!==(t=null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect().top)&&void 0!==t?t:0)>344?n.style.bottom="".concat(r.height-(i.top-r.top)+22,"px"):n.style.top="".concat(i.top-r.top+22,"px"),i.right+280>r.right?n.style.right="0px":n.style.left="".concat(i.left-r.left,"px"),n.style.visibility="visible"}else n.style.visibility="hidden"}}),[g.length,a,h,f,C.current]),e.useEffect((function(){if(d.current){if(y&&!h)return;var e=Math.max(y?h-y:h,0),t=d.current,n=40*e+8,i=40*(e+y)+8;n>=Math.floor(t.scrollTop+t.clientHeight)?t.scrollTop=i-t.clientHeight:i<=Math.ceil(t.scrollTop)&&(t.scrollTop=n)}}),[h,d.current,y]),g.length&&f&&g.length>0?t.createPortal(e.createElement("div",{ref:u,className:$T},e.createElement(e.Fragment,null,y>0?g.slice(0,y).map((function(t,n){var i=t.groupName,r=t.userIds;return e.createElement("div",{className:j("header_2p8tf",h===n&&sI,n+1===y&&g.length>y&&"withBorder_1stey"),key:n,onClick:function(){return w(g[n])},onPointerEnter:function(){return b(n)}},"@".concat(i,"(").concat(null==r?void 0:r.length,")"))})):null,g.slice(y).length>0?e.createElement("div",{className:eI,ref:d},e.createElement("div",{className:nI},g.slice(y).map((function(t,n){var i,r;return e.createElement("div",{key:n+y,className:j(iI,h===n+y&&sI),onClick:function(){return w(g[n+y])},onPointerEnter:function(){return b(n+y)}},e.createElement(ml,{url:t.avatarUrl,className:rI}),e.createElement("span",{className:oI,style:{marginBottom:0}}," ".concat(t.userName," ")),e.createElement("span",{className:aI}," ",null!==(r=null!==(i=t.email)&&void 0!==i?i:t.phone)&&void 0!==r?r:""," "))})))):null)),s):null})),hI=e.forwardRef((function(n,i){var r=n.editable,o=e.useContext(cI),a=o.editor,s=o.domContainer,l=e.useContext(xl).upime,c=e.useRef(null),u=e.useRef(null),d=dI(a,r),p=d.mentionIndex,h=d.mentionTarget,f=d.mentionEditorChange,m=d.mentionKeyDown,v=d.members,g=d.setMemberListIndex,y=d.onCompositionUpdate,b=d.onCompositionEnd;e.useImperativeHandle(i,(function(){return{handleChange:function(){return f()},handleKeydown:function(e){return m(e)},onCompositionUpdate:function(e){return y(e)},onCompositionEnd:function(e){return b(e)}}})),e.useEffect((function(){if(u.current){if(!p)return;var e=Math.max(p,0),t=u.current,n=40*e+8,i=40*(e+1)+8;n>=Math.floor(t.scrollTop+t.clientHeight)?t.scrollTop=i-t.clientHeight:i<=Math.ceil(t.scrollTop)&&(t.scrollTop=n)}}),[p,u.current]);var E=!!(v.length&&h&&v.length>0);e.useEffect((function(){l.mentionListOpenedPhone=E}),[E]);var x=W().getUpimeTrans;return E?t.createPortal(e.createElement("div",{ref:c,className:j($T,"panelPhone_2ouSJ")},e.createElement("div",{className:j(eI,tI),ref:u},e.createElement("div",{className:j(nI,tI)},v.map((function(t,n){var i,r,o;return e.createElement("div",{key:n,className:j(iI,tI),onClick:function(){return function(e){h&&setTimeout((function(){aS.select(a,h),uI(a,e)}))}(v[n])},onPointerEnter:function(){return g(n)}},void 0!==t.groupName?e.createElement(e.Fragment,null,e.createElement(ml,{url:$o("at_all_member.png"),className:j(rI,"nobgcolor_256Pd",tI)}),e.createElement("div",null,e.createElement("div",{className:j(oI,tI)},t.groupName),e.createElement("div",{className:j(aI,tI)},null===(i=t.userIds)||void 0===i?void 0:i.length,x("common.people")))):e.createElement(e.Fragment,null,e.createElement(ml,{url:t.avatarUrl,className:j(rI,tI)}),e.createElement("div",null,e.createElement("div",{className:j(oI,tI)},t.userName),e.createElement("div",{className:j(aI,tI)},null!==(o=null!==(r=t.email)&&void 0!==r?r:t.phone)&&void 0!==o?o:""))))}))))),s):null})),fI=function(t){var n=t.element,i=t.attributes,r=t.children,o=e.useContext(cI).editable;return e.createElement("span",exports.E({},i,{onClick:function(e){var t;o||(e.stopPropagation(),t=n.url,n.url.startsWith("www.")&&(t="https://".concat(t)),window.open(t))},className:j("link_38yHX",!o&&"clickable_1ikEY")}),r)},mI=[{type:"paragraph",children:[{text:""}]}],vI=function(e,t){return void 0===t&&(t=mI),!se(e,t)},gI=function(t){var n=t.attributes,i=t.children;switch(t.element.type){case"mention":return e.createElement(lI,exports.E({},t));case"url":return e.createElement(fI,exports.E({},t));case"paragraph":return e.createElement("p",exports.E({},n,{"content-editable":"true",className:"paragraph_2jidS"}),i);default:return e.createElement(rT,exports.E({},t))}},yI=V_.toSlateRange;V_.toSlateRange=function(e,t,n){var i,r,o=null===(r=null===(i=t.focusNode)||void 0===i?void 0:i.dataset)||void 0===r?void 0:r.ismention;o&&t.focusNode.setAttribute("contenteditable","true");var a=yI(e,t,n);return o&&t.focusNode.setAttribute("contenteditable","false"),a};var bI=e.forwardRef((function(n,i){var r,o=this,a=n.initValue,s=n.editable,l=void 0===s||s,c=n.domContainer,u=n.className,d=n.placeholder,p=n.autoFocus,h=n.onChange,f=n.onFocus,m=n.onEscape,v=n.onEnter,g=n.onPaste,y=n.onBlur,b=n.upime,E=e.useMemo((function(){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x-slate-fragment",i=e,{apply:r,onChange:o,deleteBackward:a,addMark:s,removeMark:l}=i;return n_.set(i,new WeakMap),i.addMark=(e,t)=>{var n,r;null===(n=l_.get(i))||void 0===n||n(),!c_.get(i)&&null!==(r=d_.get(i))&&void 0!==r&&r.length&&c_.set(i,null),u_.delete(i),s(e,t)},i.removeMark=e=>{var t;!c_.get(i)&&null!==(t=d_.get(i))&&void 0!==t&&t.length&&c_.set(i,null),u_.delete(i),l(e)},i.deleteBackward=e=>{if("line"!==e)return a(e);if(i.selection&&DC.isCollapsed(i.selection)){var t=vC.above(i,{match:e=>uC.isElement(e)&&vC.isBlock(i,e),at:i.selection});if(t){var[,n]=t,r=vC.range(i,n,i.selection.anchor),o=((e,t)=>{var n=vC.range(e,DC.end(t)),i=Array.from(vC.positions(e,{at:t})),r=0,o=i.length,a=Math.floor(o/2);if(XT(e,vC.range(e,i[r]),n))return vC.range(e,i[r],n);if(i.length<2)return vC.range(e,i[i.length-1],n);for(;a!==i.length&&a!==r;)XT(e,vC.range(e,i[a]),n)?o=a:r=a,a=Math.floor((r+o)/2);return vC.range(e,i[o],n)})(i,r);DC.isCollapsed(o)||aS.delete(i,{at:o})}}},i.apply=e=>{var t=[],n=d_.get(i);if(null!=n&&n.length){var o=n.map((t=>function(e,t){var{path:n,diff:i,id:r}=e;switch(t.type){case"insert_text":return!kC.equals(t.path,n)||t.offset>=i.end?e:t.offset<=i.start?{diff:{start:t.text.length+i.start,end:t.text.length+i.end,text:i.text},id:r,path:n}:{diff:{start:i.start,end:i.end+t.text.length,text:i.text},id:r,path:n};case"remove_text":return!kC.equals(t.path,n)||t.offset>=i.end?e:t.offset+t.text.length<=i.start?{diff:{start:i.start-t.text.length,end:i.end-t.text.length,text:i.text},id:r,path:n}:{diff:{start:i.start,end:i.end-t.text.length,text:i.text},id:r,path:n};case"split_node":return!kC.equals(t.path,n)||t.position>=i.end?{diff:i,id:r,path:kC.transform(n,t,{affinity:"backward"})}:t.position>i.start?{diff:{start:i.start,end:Math.min(t.position,i.end),text:i.text},id:r,path:n}:{diff:{start:i.start-t.position,end:i.end-t.position,text:i.text},id:r,path:kC.transform(n,t,{affinity:"forward"})};case"merge_node":return kC.equals(t.path,n)?{diff:{start:i.start+t.position,end:i.end+t.position,text:i.text},id:r,path:kC.transform(n,t)}:{diff:i,id:r,path:kC.transform(n,t)}}var o=kC.transform(n,t);return o?{diff:i,path:o,id:r}:null}(t,e))).filter(Boolean);d_.set(i,o)}var a=h_.get(i);a&&h_.set(i,_T(i,a,e));var s=p_.get(i);if(null!=s&&s.at){var l=PC.isPoint(null==s?void 0:s.at)?kT(i,s.at,e):_T(i,s.at,e);p_.set(i,l?ZT(ZT({},s),{},{at:l}):null)}switch(e.type){case"insert_text":case"remove_text":case"set_node":case"split_node":t.push(...JT(i,e.path));break;case"set_selection":var c;null===(c=a_.get(i))||void 0===c||c.unref(),a_.delete(i);break;case"insert_node":case"remove_node":t.push(...JT(i,kC.parent(e.path)));break;case"merge_node":var u=kC.previous(e.path);t.push(...JT(i,u));break;case"move_node":var d=kC.common(kC.parent(e.path),kC.parent(e.newPath));t.push(...JT(i,d))}for(var[p,h]of(r(e),t)){var[f]=vC.node(i,p);t_.set(f,h)}},i.setFragmentData=e=>{var{selection:t}=i;if(t){var[r,o]=DC.edges(t),a=vC.void(i,{at:r.path}),s=vC.void(i,{at:o.path});if(!DC.isCollapsed(t)||a){var l=V_.toDOMRange(i,t),c=l.cloneContents(),u=c.childNodes[0];if(c.childNodes.forEach((e=>{e.textContent&&""!==e.textContent.trim()&&(u=e)})),s){var[d]=s,p=l.cloneRange(),h=V_.toDOMNode(i,d);p.setEndAfter(h),c=p.cloneContents()}if(a&&(u=c.querySelector("[data-slate-spacer]")),Array.from(c.querySelectorAll("[data-slate-zero-width]")).forEach((e=>{var t="n"===e.getAttribute("data-slate-zero-width");e.textContent=t?"\n":""})),w_(u)){var f=u.ownerDocument.createElement("span");f.style.whiteSpace="pre",f.appendChild(u),c.appendChild(f),u=f}var m=i.getFragment(),v=JSON.stringify(m),g=window.btoa(encodeURIComponent(v));u.setAttribute("data-slate-fragment",g),e.setData("application/".concat(n),g);var y=c.ownerDocument.createElement("div");return y.appendChild(c),y.setAttribute("hidden","true"),c.ownerDocument.body.appendChild(y),e.setData("text/html",y.innerHTML),e.setData("text/plain",k_(y)),c.ownerDocument.body.removeChild(y),e}}},i.insertData=e=>{i.insertFragmentData(e)||i.insertTextData(e)},i.insertFragmentData=e=>{var t=e.getData("application/".concat(n))||(e=>{var t=e.getData("text/html"),[,n]=t.match(__)||[];return n})(e);if(t){var r=decodeURIComponent(window.atob(t)),o=JSON.parse(r);return i.insertFragment(o),!0}return!1},i.insertTextData=e=>{var t=e.getData("text/plain");if(t){var n=t.split(/\r\n|\r|\n/),r=!1;for(var o of n)r&&aS.splitNodes(i,{always:!0}),i.insertText(o),r=!0;return!0}return!1},i.onChange=e=>{t.unstable_batchedUpdates((()=>{var t=s_.get(i);t&&t(),o(e)}))},i}((()=>{var e={children:[],operations:[],selection:null,marks:null,isInline:()=>!1,isVoid:()=>!1,markableVoid:()=>!1,onChange:()=>{},apply:t=>{for(var n of vC.pathRefs(e))_C.transform(n,t);for(var i of vC.pointRefs(e))NC.transform(i,t);for(var r of vC.rangeRefs(e))RC.transform(r,t);var o,a,s=_w.get(e)||[],l=Tw.get(e)||new Set,c=e=>{if(e){var t=e.join(",");a.has(t)||(a.add(t),o.push(e))}};if(kC.operationCanTransformPath(t))for(var u of(o=[],a=new Set,s))c(kC.transform(u,t));else o=s,a=l;var d=e.getDirtyPaths(t);for(var p of d)c(p);_w.set(e,o),Tw.set(e,a),aS.transform(e,t),e.operations.push(t),vC.normalize(e,{operation:t}),"set_selection"===t.type&&(e.marks=null),Iw.get(e)||(Iw.set(e,!0),Promise.resolve().then((()=>{Iw.set(e,!1),e.onChange({operation:t}),e.operations=[]})))},addMark:(t,n)=>{var{selection:i,markableVoid:r}=e;if(i){var o=(t,n)=>{if(!WC.isText(t))return!1;var[i,r]=vC.parent(e,n);return!e.isVoid(i)||e.markableVoid(i)},a=DC.isExpanded(i),s=!1;if(!a){var[l,c]=vC.node(e,i);if(l&&o(l,c)){var[u]=vC.parent(e,c);s=u&&e.markableVoid(u)}}if(a||s)aS.setNodes(e,{[t]:n},{match:o,split:!0,voids:!0});else{var d=Rw(Rw({},vC.marks(e)||{}),{},{[t]:n});e.marks=d,Iw.get(e)||e.onChange()}}},deleteBackward:t=>{var{selection:n}=e;n&&DC.isCollapsed(n)&&aS.delete(e,{unit:t,reverse:!0})},deleteForward:t=>{var{selection:n}=e;n&&DC.isCollapsed(n)&&aS.delete(e,{unit:t})},deleteFragment:t=>{var{selection:n}=e;n&&DC.isExpanded(n)&&aS.delete(e,{reverse:"backward"===t})},getFragment:()=>{var{selection:t}=e;return t?xC.fragment(e,t):[]},insertBreak:()=>{aS.splitNodes(e,{always:!0})},insertSoftBreak:()=>{aS.splitNodes(e,{always:!0})},insertFragment:t=>{aS.insertFragment(e,t)},insertNode:t=>{aS.insertNodes(e,t)},insertText:t=>{var{selection:n,marks:i}=e;if(n){if(i){var r=Rw({text:t},i);aS.insertNodes(e,r)}else aS.insertText(e,t);e.marks=null}},normalizeNode:t=>{var[n,i]=t;if(!WC.isText(n))if(uC.isElement(n)&&0===n.children.length)aS.insertNodes(e,{text:""},{at:i.concat(0),voids:!0});else for(var r=!vC.isEditor(n)&&uC.isElement(n)&&(e.isInline(n)||0===n.children.length||WC.isText(n.children[0])||e.isInline(n.children[0])),o=0,a=0;a<n.children.length;a++,o++){var s=xC.get(e,i);if(!WC.isText(s)){var l=n.children[a],c=s.children[o-1],u=a===n.children.length-1;(WC.isText(l)||uC.isElement(l)&&e.isInline(l))!==r?(aS.removeNodes(e,{at:i.concat(o),voids:!0}),o--):uC.isElement(l)?e.isInline(l)&&(null!=c&&WC.isText(c)?u&&(aS.insertNodes(e,{text:""},{at:i.concat(o+1),voids:!0}),o++):(aS.insertNodes(e,{text:""},{at:i.concat(o),voids:!0}),o++)):null!=c&&WC.isText(c)&&(WC.equals(l,c,{loose:!0})?(aS.mergeNodes(e,{at:i.concat(o),voids:!0}),o--):""===c.text?(aS.removeNodes(e,{at:i.concat(o-1),voids:!0}),o--):""===l.text&&(aS.removeNodes(e,{at:i.concat(o),voids:!0}),o--))}}},removeMark:t=>{var{selection:n}=e;if(n){var i=(t,n)=>{if(!WC.isText(t))return!1;var[i,r]=vC.parent(e,n);return!e.isVoid(i)||e.markableVoid(i)},r=DC.isExpanded(n),o=!1;if(!r){var[a,s]=vC.node(e,n);if(a&&i(a,s)){var[l]=vC.parent(e,s);o=l&&e.markableVoid(l)}}if(r||o)aS.unsetNodes(e,t,{match:i,split:!0,voids:!0});else{var c=Rw({},vC.marks(e)||{});delete c[t],e.marks=c,Iw.get(e)||e.onChange()}}},getDirtyPaths:e=>{switch(e.type){case"insert_text":case"remove_text":case"set_node":var{path:t}=e;return kC.levels(t);case"insert_node":var{node:n,path:i}=e,r=kC.levels(i),o=WC.isText(n)?[]:Array.from(xC.nodes(n),(e=>{var[,t]=e;return i.concat(t)}));return[...r,...o];case"merge_node":var{path:a}=e;return[...kC.ancestors(a),kC.previous(a)];case"move_node":var{path:s,newPath:l}=e;if(kC.equals(s,l))return[];var c=[],u=[];for(var d of kC.ancestors(s)){var p=kC.transform(d,e);c.push(p)}for(var h of kC.ancestors(l)){var f=kC.transform(h,e);u.push(f)}var m=u[u.length-1],v=l[l.length-1],g=m.concat(v);return[...c,...u,g];case"remove_node":var{path:y}=e;return[...kC.ancestors(y)];case"split_node":var{path:b}=e;return[...kC.levels(b),kC.next(b)];default:return[]}},shouldNormalize:e=>{var{iteration:t,initialDirtyPathsLength:n}=e,i=42*n;if(t>i)throw new Error("Could not completely normalize the editor after ".concat(i," iterations! This is usually due to incorrect normalization logic that leaves a node in an invalid state."));return!0}};return e})())}),[]),x=e.useState({})[1],w=function(t){var n=t.isInline,i=t.isVoid,r=t.insertData;return t.isInline=function(e){return"mention"===e.type||"url"===e.type||"text"===e.type||n(e)},t.isVoid=function(e){return"mention"===e.type||i(e)},t.insertData=function(e){var n=e.getData("text/plain");Qo.test(n)?function(e,t){var n=e.selection,i=function(){aS.insertNodes(e,{type:"url",url:t,children:[{text:t}]}),aS.move(e)};if(n){var r=DC.edges(n)[0],o=vC.before(e,n,{unit:"character"});if(!o)return void i();if(" "===vC.string(e,vC.range(e,o,r)))return void i();aS.insertNodes(e,{type:"text",children:[{text:" "}]}),aS.move(e),i()}}(t,n):r(e)},{renderElement:e.useCallback((function(t){return e.createElement(gI,exports.E({},t))}),[])}}(E).renderElement,C=e.useRef(null),S=function(e){return{urlEditorChange:function(){var t,n=e.selection;if(n&&DC.isCollapsed(n)){var i=vC.parent(e,n)[0],r=vC.node(e,n),o=r[0],a=r[1];if("url"===(null===(t=i)||void 0===t?void 0:t.type)){var s=vC.point(e,a,{edge:"start"}),l=vC.point(e,a,{edge:"end"}),c=vC.range(e,s,l),u=vC.string(e,c);return void(Qo.test(u)||function(e){var t=e.selection,n=null!=vC.above(e,{at:t,match:function(e){return"url"===e.type}});n&&aS.unwrapNodes(e,{match:function(e){return uC.isElement(e)&&"url"===e.type}})}(e))}if(!WC.isText(o))return;var d=DC.edges(n)[0],p=vC.before(e,n,{unit:"character"});if(!p)return;var h=vC.string(e,vC.range(e,p,d));if(" "!==h&&!h.match(/[\u3400-\u9FBF]/))return;var f=vC.point(e,a,{edge:"start"}),m=p,v=vC.before(e,m,{unit:"character"});if(!v)return;for(var g=vC.string(e,vC.range(e,v,m));" "!==g&&v&&!PC.isBefore(v,f);)m=v,g=(v=vC.before(e,m,{unit:"character"}))?vC.string(e,vC.range(e,v,m)):" ";var y=vC.range(e,m,p),b=vC.string(e,y);Qo.test(b)&&Promise.resolve().then((function(){!function(e,t,n,i){aS.wrapNodes(e,{type:"url",url:i,children:[{text:n}]},{split:!0,at:t})}(e,y,b,b)}))}}}}(E).urlEditorChange;e.useEffect((function(){k()}),[p]);var k=function(){return A(o,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return p?(null==b?void 0:b.phoneMode)?[4,Dc(.4)]:[3,2]:[3,3];case 1:e.sent(),e.label=2;case 2:_e.isAndroid?setTimeout((function(){aS.select(E,{offset:0,path:[0,0]}),V_.focus(E)})):(aS.select(E,{offset:0,path:[0,0]}),V_.focus(E)),e.label=3;case 3:return[2]}}))}))};return e.useImperativeHandle(i,(function(){return{reset:function(e){aS.delete(E,{at:{anchor:vC.start(E,[]),focus:vC.end(E,[])}}),E.children=e,x({})},insertMention:function(e){uI(E,e)},insertText:function(e){!function(e,t){aS.insertNodes(e,{type:"text",children:[{text:t}]}),aS.move(e),V_.focus(e)}(E,e)},focus:k}}),[E]),e.createElement("div",{className:u},e.createElement(cI.Provider,{value:{domContainer:c,editor:E,editable:l}},e.createElement(KT,{editor:E,value:a,onChange:function(e){var t;null===(t=C.current)||void 0===t||t.handleChange(),S(),null==h||h(e)}},e.createElement(FT,{autoFocus:!!p,renderElement:w,readOnly:!l,onKeyDown:function(e){var t;null===(t=C.current)||void 0===t||t.handleKeydown(e),"Escape"===e.key&&(null==m||m()),"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),vC.insertBreak(E))},onKeyPress:function(e){if("Enter"===e.key&&!e.shiftKey&&!(null==b?void 0:b.phoneMode))return e.stopPropagation(),e.preventDefault(),void(null==v||v())},onCompositionUpdate:null===(r=C.current)||void 0===r?void 0:r.onCompositionUpdate,onCompositionEnd:function(e){var t;null===(t=C.current)||void 0===t||t.onCompositionEnd(e),(null==b?void 0:b.phoneMode)||(Ee()?e.preventDefault():function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("micromessenger")&&-1===e.indexOf("wxwork")}()&&aS.insertText(E,e.data))},onInput:function(){if(_e.isAndroid){var e=V_.androidPendingDiffs(E);e&&e.length>0&&V_.androidScheduleFlush(E)}},onPaste:function(e){null==g||g(e),e.stopPropagation()},placeholder:l&&null!=d?d:"",onFocus:function(){null==f||f()},onBlur:y}),(null==b?void 0:b.phoneMode)?e.createElement(hI,{editable:l,ref:C}):e.createElement(pI,{editable:l,ref:C}))))})),EI=function(){function e(){}return e.applyMediaPerm=function(t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:if(e.micGranted||e.camGranted){if(e.micGranted&&e.camGranted)return[2,!0];if(t.audio&&!t.video&&e.micGranted)return[2,!0];if(t.video&&!t.audio&&e.camGranted)return[2,!0]}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(t)];case 2:return n.sent().getTracks().forEach((function(e){"live"==e.readyState&&e.stop()})),t.video&&(e.camGranted=!0),t.audio&&(e.micGranted=!0),[2,!0];case 3:return n.sent(),t.video&&(e.camGranted=!1),t.audio&&(e.micGranted=!1),[2,!1];case 4:return[2]}}))}))},e.startRecordAudio=function(){var e,t;return A(this,void 0,void 0,(function(){var n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 1:return n=l.sent(),i=null!==(t=(null===(e=n.getAudioTracks()[0])||void 0===e?void 0:e.getSettings()).channelCount)&&void 0!==t?t:1,r=window.AudioContext||window.webkitAudioContext,o=new r,a=o.createMediaStreamSource(n),(s=new window.Recorder(a,{numChannels:i})).record(),[2,function(){return new Promise((function(e){s.stop(),n.getTracks().forEach((function(e){"live"==e.readyState&&"audio"===e.kind&&e.stop()})),s.exportWAV(e)}))}]}}))}))},e.micGranted=void 0,e.camGranted=void 0,e}(),xI="phone_1spnP",wI="btn_2SgAE",CI=function(e){return"".concat("0".concat(Math.ceil(e.duration)/60|0).slice(-2),":").concat("0".concat(Math.ceil(e.duration)%60).slice(-2))},SI=function(t){var n=t.onFinish,i=t.className,r=t.recordLimit,o=void 0===r?6e4:r,a=t.setRecordModeWorking,s=W().getUpimeTrans,l=e.useState(!1),c=l[0],u=l[1],d=e.useState(!1),p=d[0],h=d[1],f=e.useState("record"),m=f[0],v=f[1],g=e.useRef([1,2,3,4,3,2,1,2,1,1]),y=e.useRef(0),b=e.useRef(null),E=e.useRef(null),x=e.useRef(null),w=e.useRef(null),C=e.useRef(null),S=e.useRef(null),k=e.useRef(null);e.useEffect((function(){return function(){var e,t;E.current&&mr(E.current),null===(e=x.current)||void 0===e||e.call(x),!1===(null===(t=w.current)||void 0===t?void 0:t.paused)&&w.current.pause()}}),[]);var _,T=function(){return A(void 0,void 0,void 0,(function(){var e,t,n,i,r;return D(this,(function(o){switch(o.label){case 0:if(E.current&&mr(E.current),e=b.current.frame,!x.current)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,x.current()];case 2:return t=o.sent(),x.current=null,C.current=t,n=URL.createObjectURL(t),i=new Audio(n),w.current=i,r=S.current,i.onloadedmetadata=function(){var t=function(){i.currentTime=0,i.removeEventListener("timeupdate",t),u(!1),v("play"),r.innerHTML=CI(i),setTimeout((function(){return e.render()}))};i.duration===1/0?(i.currentTime=1e101,i.addEventListener("timeupdate",t)):t()},[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))}))},I=function(e,t){return function(n){var i=n.context;if(i.beginPath(),t){i.lineWidth=3,i.strokeStyle="#e6e7e9";for(var r=0;r<10;r++)M?(i.moveTo(8*r,4),i.lineTo(8*r,12)):(i.moveTo(4*r,6),i.lineTo(4*r,10));i.stroke()}else{var o=Date.now()-y.current;i.lineWidth=2,i.strokeStyle="#abc7f5";var a=1;for(M&&(a=2),r=0;r<g.current.length;r++){var s="left"===e?40*a-(4*r*a+.03*o)%(40*a):(4*r*a+.03*o)%(40*a),l=(16-4*g.current[r])/2,c=l+4*g.current[r];i.moveTo(s,l),i.lineTo(s,c)}i.stroke()}}},P=e.useMemo((function(){return"play"===m?p?"pause_1vLeQ":"play_1Ca7e":"record"===m?c?"finishRecord_1rWCh":"startRecord_3NeQ0":void 0}),[m,p,c]),N=function(){var e=b.current.frame;w.current&&(E.current&&mr(E.current),h(!1),setTimeout((function(){var t;null===(t=w.current)||void 0===t||t.pause(),e.render()})))},M=e.useContext(xl).upime.phoneMode;return e.createElement("div",{className:j("root_10nC0",i,M&&xI)},e.createElement("span",{className:j("title_23DH1",M&&xI),ref:S},s("media.audio.recorder.startLabel")),e.createElement("div",{className:j("canvasCon_jwQvt",M&&xI),ref:k},e.createElement(Xo,{ref:b,width:M?300:124,height:M?70:30,resolution:2},e.createElement(ko,{x:0,y:M?25:7,drawAny:I("left",!c&&!p)}),e.createElement(ko,{x:M?136:48,y:M?16:0,drawAny:(_=c,function(e){var t=e.context;if(t.beginPath(),t.lineWidth=M?2:1,_){var n=Date.now()-y.current;t.strokeStyle="#2E73E5",M?t.arc(14,15,29,-.5*Math.PI,(1.5-n/o*2)*Math.PI):t.arc(14,15,14,-.5*Math.PI,(1.5-n/o*2)*Math.PI),t.stroke(),t.beginPath(),t.strokeStyle="#E6E7E9",M?t.arc(14,15,29,1.5*Math.PI,(1.5-n/o*2)*Math.PI,!0):t.arc(14,15,14,1.5*Math.PI,(1.5-n/o*2)*Math.PI,!0),t.stroke()}else t.strokeStyle="#2E73E5",M?t.arc(14,15,29,0,2*Math.PI):t.arc(14,15,14,0,2*Math.PI),t.stroke()})}),e.createElement(ko,{x:M?225:86,y:M?25:7,drawAny:I("right",!c&&!p)})),e.createElement("div",{className:j("actionBtn_2duJG",P,M&&xI),onClick:function(){"play"===m?p?N():function(){var e=w.current,t=S.current;e&&(h(!0),setTimeout((function(){e.currentTime>=e.duration&&(e.currentTime=0);var n=0,i=b.current.frame,r=function(){E.current=fr((function(){e.currentTime>=e.duration?N():(Date.now()-n>1e3/60&&(i.render(),t.innerHTML="".concat("0".concat(Math.ceil(e.currentTime)/60|0).slice(-2),":").concat("0".concat(Math.ceil(e.currentTime)%60).slice(-2),"<em>/").concat(CI(e),"</em>")),n=Date.now(),r())}))};r(),e.play()})))}():c?T():function(){E.current&&mr(E.current);var e=0,t=S.current,n=b.current.frame,i=s("media.audio.recorder.timeLeft"),r=function(){E.current=fr((function(){var a=Date.now()-y.current;if(a>=o)T();else{if(a-e>1e3/60){n.render();var s=o-a;t.innerHTML="".concat(i," ").concat("0".concat(s/6e4|0).slice(-2),":").concat("0".concat(s%6e4/1e3|0).slice(-2)),e=a}r()}}))};u(!0),a&&a(!0),setTimeout((function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=x,[4,EI.startRecordAudio()];case 1:return e.current=t.sent(),y.current=Date.now(),r(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))}))}()}})),"play"===m?e.createElement("div",{className:j("actionBar_2ObcF",M&&xI)},e.createElement("div",{className:j(wI,"recordBtn_2BD21"),onClick:function(){var e,t=S.current;h(!1),u(!1),v("record"),E.current&&mr(E.current),!1===(null===(e=w.current)||void 0===e?void 0:e.paused)&&w.current.pause(),C.current=null,w.current=null;var n=b.current.frame;t.innerHTML=s("media.audio.recorder.startLabel"),setTimeout((function(){return n.render()}))}},s("media.audio.recorder.restart")),e.createElement("div",{className:j(wI,"sendBtn_2oiHa"),onClick:function(){n(C.current)}},s("common.send"))):null)},kI=function(t){var n=t.success,i=t.content,r=e.useRef(null),o=i,a=o.targetRect,s=o.closePro,l=e.useState({}),c=l[0],u=l[1],d=e.useContext(Ic).rootContainer;return e.useEffect((function(){s.then((function(){n(null)}))})),e.useEffect((function(){if(r.current){var e=r.current.parentElement.getBoundingClientRect(),t=d.current.getBoundingClientRect(),n=a.left,i=a.right,o=a.top,s=a.bottom,l=a.width;a.height;var c,p=e.left,h=e.right,f=e.top,m=e.bottom,v=o-8-120,g=n-(172-l)/2,y=i+(172-l)/2,b=o-8;v<f&&(v=s+8,b=s+8+120),b>=m&&(v-=c=b-m+8,b-=c),g<=p+8&&(g+=c=p-g+8,y+=c),y>=h-8&&(g-=c=y-h+8,y-=c),u({top:v-t.top,left:g-t.left,visibility:"visible",position:"absolute"})}}),[]),e.createElement("div",{ref:r,style:c},e.createElement("div",{className:"content_3rrrb"},e.createElement(hl,{icon:"guanbi",className:"closeIcon_24gf6",onClick:function(){return n(null)}}),e.createElement(SI,{onFinish:function(e){n(e)}})))};function _I(t){var n=t.onFinishRecord,i=t.showClose,r=void 0!==i&&i,o=t.setRecordModeWorking,a=t.onClickClose;return e.createElement("div",{className:Cx.recorderContainer},r&&e.createElement(e.Fragment,null,e.createElement("div",{className:Cx.coverblock}),e.createElement("div",{className:Cx.closebar},e.createElement(hl,{icon:"guanbi",onClick:a}))),e.createElement(SI,{onFinish:n,setRecordModeWorking:o}))}var TI,II=[".jpg",".jpeg",".png",".gif",".svg"],PI=".pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .mp3, .wav, .mp4, .mov",NI=e.forwardRef((function(t,n){var i=this,r=t.element,o=t.placeholder,a=t.autoFocus,s=void 0===a||a,l=t.upime,c=t.message,u=W().getUpimeTrans,d=e.useRef(null),p=e.useState(!1),h=p[0],f=p[1],m=e.useRef(r.curValue||mI),v=e.useRef(null),g=e.useState(!1),y=g[0],b=g[1],E=yh(!0,{checkSkip:function(e){return"helplink"===e.getAttribute("data-name")}}),x=E.hide,w=E.setHide,C=E.skipRef,S=e.useRef(null),k=!(!l.getMentionCandidate&&!l.getMentionGroupAndCandidate);al(r,["curValue"]),al(l,["mentionListOpenedPhone"]),e.useImperativeHandle(n,(function(){return{insertMention:function(e){var t;null===(t=v.current)||void 0===t||t.insertMention(e)},insertText:function(e){var t;null===(t=v.current)||void 0===t||t.insertText(e)}}})),e.useEffect((function(){return r.curValue&&f(vI(r.curValue)),function(){var e;null===(e=S.current)||void 0===e||e.call(S)}}),[]),e.useEffect((function(){var e;null===r.curValue&&(null===(e=v.current)||void 0===e||e.reset(mI))}),[r.curValue]);var _=e.useCallback((function(e){r.curValue=e,f(vI(e))}),[]);Sx([d]);var T=e.useCallback((function(){r.curValue&&!se(r.curValue,mI)&&(c&&c.id?(r.updateExistingMsg(c.id,r.curValue),l.closePhoneDrawer(),l.addToast(u("common.edit.success"))):r.onFinishDraft(!0,!0))}),[r]),I=function(){"draft"!==r.type&&(r.editingMsgId=null),r.focusing=!0,F&&z(!1)},P=function(e){var t={image:II.join(", "),file:PI},n=R(R([],t.image.split(",").map((function(e){return e.trim().slice(1)})),!0),t.file.split(",").map((function(e){return e.trim().slice(1)})),!0),o=l.userManager.uploadSizeLimit,a="board_temp_comment_file_input",s=document.getElementById(a);s&&s.remove();var c=document.createElement("input");c.style.display="none",c.setAttribute("id",a),c.setAttribute("type","file"),c.setAttribute("multiple","multiple"),c.setAttribute("accept",e?t[e]:PI+", "+II.join(",")),c.addEventListener("change",(function(e){return A(i,void 0,void 0,(function(){var t,i,a,s,d,p;return D(this,(function(h){switch(h.label){case 0:return t=e.target.files,(i=t)?[4,ra(l)]:[3,2];case 1:i=h.sent(),h.label=2;case 2:return i&&(a=!1,s=!1,d=!1,p=Array.from(t).reduce((function(e,t){return t.size?n.includes(Jo(t.name))?t.size>o?(a=!0,e):R(R([],e,!0),[t],!1):(s=!0,e):(d=!0,e)}),[]),d&&l.addToast(u("comment.upload.file.empty.hint"),{}),a&&l.addToast(u("upload.exceedLimitSize",na(o))),s&&l.addToast(u("comment.upload.file.invalid.type"),{}),p.length>9&&l.addToast(u("comment.upload.file.number.limit"),{}),p.length&&(r.appendFiles=Array.from(p).slice(0,9),r.onFinishDraft(!1,!0))),document.body.removeChild(c),[2]}}))}))})),c.click(),document.body.appendChild(c)},N=function(e){return A(i,void 0,void 0,(function(){var t,n,i,o,a,s;return D(this,(function(c){switch(c.label){case 0:c.trys.push([0,6,,7]),t=e.clipboardData,n=0,c.label=1;case 1:return n<t.items.length?(i=null===(s=t.items[n])||void 0===s?void 0:s.getAsFile())?(e.preventDefault(),o=i.name,a=Jo(o),II.includes(".".concat(a))?[4,ra(l,i)]:[3,3]):[3,4]:[3,5];case 2:c.sent()&&(r.appendFiles=[i],r.onFinishDraft(!1,!0)),c.label=3;case 3:return[3,5];case 4:return n++,[3,1];case 5:return[3,7];case 6:return c.sent(),e.preventDefault(),[3,7];case 7:return[2]}}))}))};e.useEffect((function(){var e;c&&(null===(e=v.current)||void 0===e||e.reset(r.formatContent(c.content)))}),[c]);var M=e.useRef(null),B=e.useRef(null);if(l.mentionListOpenedPhone&&B.current&&M.current){B.current.style.display="block";var L=M.current.getBoundingClientRect().height+11;B.current.style.marginBottom=L+"px"}!l.mentionListOpenedPhone&&B.current&&(B.current.style.display="none");var O=e.useState(!1),F=O[0],z=O[1],H=e.useState(!1),U=H[0],V=H[1];return l.phoneMode?e.createElement(e.Fragment,null,e.createElement("div",{className:j(l.mentionListOpenedPhone?Cx.atContainer:""),ref:B,onClick:function(){B.current&&(B.current.style.display="none")}}),!U&&e.createElement("div",{className:j(Cx.draftContainer,Cx.phone,c&&Cx.editmode),ref:M,style:{fontFamily:He}},!c&&e.createElement("div",{className:Cx.mic},e.createElement(hl,{icon:F?"shoujijianpan":"yuyin",className:Cx.micIcon,onClick:function(){return A(i,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return F?(z(!1),null===(e=v.current)||void 0===e||e.focus(),[2]):[4,ra(l)];case 1:return t.sent()?[4,EI.applyMediaPerm({audio:!0})]:[2];case 2:return t.sent()&&z(!0),[2]}}))}))}})),e.createElement("div",{className:j(Cx.textPart,c&&Cx.editTextPart)},e.createElement(bI,{domContainer:B.current,ref:v,editable:!0,initValue:m.current,onChange:_,onFocus:I,onEnter:T,onEscape:function(){return r.escapeHandler()},className:Cx.editor,placeholder:null!=o?o:u(k?"comment.draft.placeholder":"comment.draft.placeholder.no.at"),autoFocus:s,upime:l,onPaste:N,onBlur:function(){return r.focusing=!1}}),e.createElement("div",{className:Cx.fasongContainer},e.createElement(hl,{icon:"fasong",className:j(Cx.send,h?Cx.sendActive:""),onClick:T})),c&&e.createElement(hl,{icon:"guanbi",className:Cx.guanbi,onClick:function(){l.closePhoneDrawer()}})),!c&&e.createElement("div",{className:Cx.upload},e.createElement(hl,{icon:"pizhulishangchuan",className:Cx.uploadIcon,onClick:function(){return P()}}))),F&&e.createElement(_I,{onFinishRecord:function(e){r.appendExt={audioType:"local_record"},r.appendFiles=[new File([e],"".concat(l.genFileName(""),".wav"),{lastModified:Date.now(),type:"audio/wav"})],r.onFinishDraft(!1,!0),z(!1),V(!1)},showClose:U,setRecordModeWorking:V,onClickClose:function(){z(!1),V(!1)}}),x?null:e.createElement(xh,{className:Cx.guideRoot,align:"center"},e.createElement("span",{className:Cx.title},u("media.audio.access.denied.label")),e.createElement("span",{className:Cx.content},u("media.audio.access.denied.content")),l.deviceHelpLink?e.createElement("span",{className:Cx.link,onClick:function(){return window.open(l.deviceHelpLink)},"data-name":"helplink"},u("rtc.device.denied.link")):null)):e.createElement("div",{className:Cx.draftContainer,ref:d,style:{fontFamily:He}},e.createElement(e.Fragment,null,e.createElement("div",{className:Cx.textPart},e.createElement(bI,{domContainer:d.current,ref:v,editable:!0,initValue:m.current,onChange:_,onFocus:I,onEnter:T,onEscape:function(){return r.escapeHandler()},className:Cx.editor,placeholder:null!=o?o:u(k?"comment.draft.placeholder":"comment.draft.placeholder.no.at"),autoFocus:s,upime:l,onPaste:N,onBlur:function(){return r.focusing=!1}}),e.createElement("div",{className:Cx.actionRow},e.createElement(hl,{icon:"fasong",className:j(h&&Cx.active),onClick:T}))),e.createElement("div",{className:Cx.draftActions},e.createElement("div",{className:Cx.micCon,ref:C},e.createElement(hl,{icon:"maikefeng-kai",className:j(y&&Cx.active),onClick:function(e){x?A(i,void 0,void 0,(function(){var e,t,n;return D(this,(function(i){switch(i.label){case 0:return!1===EI.micGranted?(w(!1),[2]):[4,ra(l)];case 1:return i.sent()?[4,EI.applyMediaPerm({audio:!0})]:[2];case 2:return i.sent()?(e=new Promise((function(e){S.current=e})),b(!0),[4,l.showWindow(kI,{targetRect:(null===(n=C.current)||void 0===n?void 0:n.firstElementChild).getBoundingClientRect(),closePro:e})]):[3,4];case 3:t=i.sent(),b(!1),t&&(r.appendExt={audioType:"local_record"},r.appendFiles=[new File([t],"".concat(l.genFileName(""),".wav"),{lastModified:Date.now(),type:"audio/wav"})],r.onFinishDraft(!1,!0)),i.label=4;case 4:return[2]}}))})):(e.stopPropagation(),setTimeout((function(){return w(!0)})))}}),x?null:e.createElement(xh,{className:Cx.guideRoot,align:"left"},e.createElement("span",{className:Cx.title},u("media.audio.access.denied.label")),e.createElement("span",{className:Cx.content},u("media.audio.access.denied.content")),l.deviceHelpLink?e.createElement("span",{className:Cx.link,onClick:function(){return window.open(l.deviceHelpLink)}},u("rtc.device.denied.link")):null)),e.createElement(hl,{icon:"tupian",onClick:function(){return P("image")}}),e.createElement(hl,{icon:"shangchuan",onClick:function(){return P("file")}}))))}));!function(e){e[e.TEXT=0]="TEXT",e[e.AUDIO=1]="AUDIO",e[e.VIDEO=2]="VIDEO",e[e.IMAGE=3]="IMAGE",e[e.FILE=4]="FILE"}(TI||(TI={}));var MI="hiddenTime_2qycJ",AI="pizhuhuifu_vhSEh",DI="button_2pU-4",RI="dialogContainer_Izcfu",BI="dialogItem_2W2LA",LI="dangerColor_2HcTN",OI=function(t){var n=t.success;t.content;var i=W().getUpimeTrans;return e.useContext(xl).upime,e.createElement("div",{className:RI},e.createElement("span",{className:BI,onClick:function(){n(1)}},i("common.edit")),e.createElement("span",{className:j(BI,LI),onClick:function(){n(2)}},i("common.delete")))},FI=function(t){var n=t.message,i=t.upime,r=t.comment,o=t.panelRootDom,a=n.content,s=e.useRef(r.formatContent(a)),l=e.useRef(a),c=e.useRef(null),u=W().getUpimeTrans,d=e.useState(!1),p=d[0],h=d[1],f=e.useState(!1),m=f[0],v=f[1],g=e.useRef(r.formatContent(n.content)),y=e.useRef(null),b=e.useRef(null);al(e.useMemo((function(){return i.getUserInfo(n.commentator)}),[])),al(r,["editingMsgId"]);var E=e.useMemo((function(){return!(i.phoneMode||n.commentator!==i.localUserInfo.loginName||!n.id)}),[n,n.commentator,n.id]),x=e.useCallback((function(){var e;h(!0),r.editingMsgId=n.id;var t=null===(e=y.current)||void 0===e?void 0:e.parentElement;setTimeout((function(){var e=t.parentElement,n=e.parentElement,i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=i.top-r.top;i.bottom-r.top>n.scrollTop+n.clientHeight&&t.scrollIntoView(!1),o<n.scrollTop&&t.scrollIntoView(!0)}),250)}),[n,n.content]);e.useEffect((function(){p&&r.editingMsgId!==n.id&&(g.current?C():w())}),[r.editingMsgId]);var w=e.useCallback((function(){var e;g.current=r.formatContent(n.content),null===(e=c.current)||void 0===e||e.reset(r.formatContent(n.content)),h(!1),r.editingMsgId=null}),[]),C=function(){m?(n.id&&r.updateExistingMsg(n.id,g.current),r.editingMsgId=null,h(!1)):w()};e.useEffect((function(){var e;n.content!==l.current&&c.current&&(null===(e=c.current)||void 0===e||e.reset(r.formatContent(n.content)),g.current=r.formatContent(n.content))}),[n,n.content]);var S=function(){r.deleteMsg(n),r.editingMsgId=null},k=e.useCallback((function(e){g.current=e,v(vI(e,r.formatContent(n.content))&&vI(e))}),[r]);return e.createElement(e.Fragment,null,e.createElement("div",{className:j("content_oxA_u",!p&&E&&"contentHover_qz07b"),onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return i.phoneMode&&n.commentator===i.localUserInfo.loginName&&n.id?[4,i.showWindow(OI,{},!1,!0,{type:"drawer"})]:[3,2];case 1:return 1===(e=t.sent())?i.showPhoneDrawer(NI,{upime:i,element:r,autoFocus:!0,message:n},{coverVisible:!0,markCloseable:!1,supportSwipe:!1,onCloseCB:function(){r.curValue=null}}):2===e&&S(),[3,3];case 2:E&&!p&&x(),t.label=3;case 3:return[2]}}))}))},ref:y},e.createElement(bI,{initValue:s.current,ref:c,domContainer:o,editable:E&&p,onChange:k,onEscape:function(){return p?w():r.escapeHandler()},onEnter:C,className:j("editor_VRdAP",p&&"editing_1V1fB"),onFocus:function(){return r.focusing=!0},onBlur:function(){return r.focusing=!1}}),n.updateTime?e.createElement("span",{className:"updatedLabel_381z_"},"(".concat(u("comment.message.updated"),")")):null),p&&e.createElement("div",{className:j("actions_nqOrM","showActionsDiv_1wia1"),ref:b},e.createElement(ul,{type:"text",size:"small",className:j(DI,!m&&"saveDisabled_240Kr"),onClick:C},u("comment.message.edit.save")),e.createElement(ul,{size:"small",className:j(DI,"cancelBtn_1NbJ0"),onClick:w},u("comment.message.edit.cancel")),e.createElement(ul,{size:"small",className:j(DI,"deleteBtn_3W6tq"),onClick:S},u("comment.message.edit.delete"))))};function zI(e){var t=new Date,n=t.getFullYear(),i=Math.floor(t.getTime()/864e5),r=new Date(e),o=r.getFullYear(),a=r.getMonth()+1,s=r.getDate(),l=r.getHours(),c=r.getMinutes(),u=Math.floor(e/864e5);function d(e){return e>=10?e:"0"+e}var p="".concat(d(l),":").concat(d(c));return i===u?"".concat(O("datetime.today")," ").concat(p):i===u+1?"".concat(O("datetime.yesterday")," ").concat(p):(p="".concat(d(a),"-").concat(d(s)," ").concat(p),o==n?p:"".concat(o,"-").concat(p))}var HI=function(e){var t=new Date,n=new Date(e);return n.getDate()==t.getDate()&&n.getMonth()==t.getMonth()&&n.getFullYear()==t.getFullYear()},UI=["datetime.Sunday","datetime.Monday","datetime.Tuesday","datetime.Wednesday","datetime.Thursday","datetime.Friday","datetime.Saturday"],WI=["datetime.January","datetime.February","datetime.March","datetime.April","datetime.May","datetime.June","datetime.July","datetime.August","datetime.September","datetime.October","datetime.November","datetime.December"],VI=function(e){var t=e?new Date(e):new Date;return O(UI[t.getDay()])},jI=function(e,t){void 0===t&&(t="YYYY-MM-DD HH:MM");var n=new Date(e);return"YYYY-MM-DD HH:MM"===t?"".concat(n.getFullYear(),"-").concat("0".concat(n.getMonth()+1).slice(-2),"-").concat("0".concat(n.getDate()).slice(-2)," ").concat("0".concat(n.getHours()).slice(-2),":").concat("0".concat(n.getMinutes()).slice(-2)):n.toLocaleDateString()};e.createContext({messageDiv:null});var GI=function(t){var n,i=t.children;t.adjacentPost;var r=t.adjacentPre;t.isLast;var o=t.upime,a=t.message,s=e.useState(!1),l=s[0],c=s[1],u=e.useMemo((function(){return o.getUserInfo(a.commentator)}),[]);al(u);var d=W().getUpimeTrans,p=!o.editable&&!o.userManager.commentOnlyMode;return e.createElement("div",{className:"messageItemRoot_3URk_",onPointerEnter:function(){c(!0)},onPointerLeave:function(){c(!1)}},r?e.createElement("div",{className:MI},e.createElement("span",{style:{visibility:l||!_e.desktop?"visible":"hidden"}},zI(a.createTime)),e.createElement("span",{style:{visibility:!l&&_e.desktop||p?"hidden":"visible"}},e.createElement(Dl,{content:d("common.reply"),placement:"top"},e.createElement(hl,{icon:"pizhuhuifu","x-from":u.loginName,className:j(_e.desktop?AI:"")})))):e.createElement(e.Fragment,null,e.createElement("div",{className:"header_1rNMR"},e.createElement("div",{className:"avatar_26U52"},e.createElement(ml,{url:null==u?void 0:u.avatarUrl,className:"icon_2X5cD"}),e.createElement("span",null," ",null!==(n=null==u?void 0:u.userName)&&void 0!==n?n:""))),e.createElement("div",{className:MI},e.createElement("span",null,zI(a.createTime)),e.createElement("span",{style:{visibility:!l&&_e.desktop||p?"hidden":"visible"}},e.createElement(Dl,{content:d("common.reply"),placement:"top"},e.createElement(hl,{icon:"pizhuhuifu","x-from":u.loginName,className:j(_e.desktop?AI:"")}))))),i)},qI="player_2U3ik",KI="header_14Jyv",YI="actions_3YAMp",XI="btn_2p5TQ",QI="cancelBtn_1ydMc",ZI=function(n){var i=n.content,r=n.className,o=n.onConfirm,a=n.targetDom;n.upime;var s=n.closeEvt,l=W().getUpimeTrans,c=e.useContext(Ic).popContainer,u=e.useRef(null),d=yh(!1,{checkSkip:function(e){return V(u.current,e)}}).hide;e.useEffect((function(){d&&setTimeout((function(){return s()}))}),[d]);var p=e.useContext(gs).viewbox;e.useLayoutEffect((function(){h()}),[p.left,p.top,p.bottom,p.right,p.scale]);var h=function(){var e=u.current,t=c.current.getBoundingClientRect(),n=a.getBoundingClientRect(),i=n.top,r=n.left,o=n.width;e.style.visibility="visible",e.style.top="".concat(i-10-98-t.top,"px"),e.style.left="".concat(r-(196-o)/2-t.left,"px")};return t.createPortal(e.createElement("div",{className:j("root_Q3upx",r),ref:u},e.createElement("div",{className:KI},e.createElement(hl,{icon:"qingchu"}),e.createElement("span",null,null!=i?i:l("comment.message.delete.confirm"))),e.createElement("div",{className:YI},e.createElement(ul,{type:"text",className:j(XI,QI),style:{marginRight:"8px"},onClick:s},l("common.cancel")),e.createElement(ul,{type:"danger",className:XI,onClick:o,"data-name":"delete"},l("common.delete")))),c.current)},JI={basic:"basic_14d8F",root:"root_2kiB8",logo:"logo_3-t_C",info:"info_14nWX",progress:"progress_3wx9X",iconCon:"iconCon_WJO51",floatIcon:"floatIcon_20utB",errorCon:"errorCon_2JcvO"},$I=function(e,t,n){void 0===n&&(n=204);var i=document.createElement("canvas").getContext("2d");if(i.font="14px ".concat(He),i.measureText(e).width>n){for(var r=e.length-(t.length+1+4),o=r-2;i.measureText(e.substring(0,o)+"..."+e.substring(r)).width>n;)o--;return e.substring(0,o)+"..."+e.substring(r)}return e},eP=function(e){switch(e){case"jpg":case"png":case"gif":case"svg":case"webp":case"jpeg":return"imgicon";case"wav":case"mp3":return"audioicon";case"pdf":return"pdficon";case"ppt":case"pptx":return"ppticon";case"xls":case"xlsx":case"csv":return"excelicon";case"doc":case"docx":return"wordicon";default:return"file-jinggao"}},tP=function(t,n){e.useEffect((function(){var e=function(){t()};return n&&n.addEventListener("scroll",e),function(){n&&n.removeEventListener("scroll",e)}}),[])},nP=function(t,n){var i=e.useState({}),r=i[0],o=i[1],a=e.useMemo((function(){return!t.pending&&!!t.failed}),[t,t.failed,t.pending,r]),s=e.useCallback((function(){var e,i;a&&(null===(i=null===(e=t.pending)||void 0===e?void 0:e.retry)||void 0===i||i.call(e),o({}),null==n||n())}),[a]);return{uploadErr:a,retryUpload:s}},iP="row_2jCnt",rP="dialogItem_324Gr",oP=function(n){var i=n.comment,r=n.message,o=n.targetDom,a=n.closeEvt,s=n.onPreview,l=n.onDownload,c=n.couldPreview,u=e.useContext(Ic).popContainer,d=e.useRef(null),p=e.useRef(null),h=W().getUpimeTrans,f=e.useState(!1),m=f[0],v=f[1],g=yh(!1,{checkSkip:function(e){var t=V(d.current,e),n=V(o,e),i="delete"===e.getAttribute("data-name");return t||n||i}}).hide;e.useEffect((function(){var e=i.upime.view.subscribe("viewboxChange",y);return y(),function(){e()}}),[]),e.useEffect((function(){g&&setTimeout((function(){return a()}))}),[g]);var y=function(){var e=d.current,t=o.getBoundingClientRect(),n=t.bottom,i=t.left,r=t.width,a=u.current.getBoundingClientRect(),s=a.left,l=a.top;e.style.visibility="visible",e.style.top="".concat(n+4-l,"px"),e.style.left="".concat(i-(90-r)/2-s,"px")},b=e.useContext(xl).upime,E=r.type===TI.IMAGE;return t.createPortal(e.createElement("div",{className:"root_1eYsP",ref:d},s&&c?e.createElement("div",{className:iP,onClick:s},h("common.preview")):null,l&&(b.downloadConfig.enable||E)&&e.createElement("div",{className:iP,onClick:l},h("common.download")),r.commentator===i.upime.localUserInfo.loginName&&e.createElement("div",{className:iP,onClick:function(){return v(!0)},ref:p,style:{color:"#fe5250"}},h("common.delete")),m?e.createElement(ZI,{onConfirm:function(){return i.deleteMsg(r)},targetDom:p.current,closeEvt:function(){return v(!1)},upime:i.upime}):null),u.current)},aP=function(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=i,a=o.element,s=o.msg,l=o.couldPreview,c=o.coundDownload;return e.createElement("div",{className:"dialogContainer_2F7H_"},l&&e.createElement("span",{className:rP,onClick:function(){n(1)}},r("common.preview")),c&&e.createElement("span",{className:rP,onClick:function(){n(2)}},r("common.download")),s.commentator===a.upime.localUserInfo.loginName&&e.createElement("span",{className:j(rP,"dangerColor_2dvXQ"),onClick:function(){n(3)}},r("common.delete")))},sP=function(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans,a=(null==r?void 0:r.content)||o("comment.message.delete.confirm"),s=(null==r?void 0:r.confirmText)||o("common.delete");return e.createElement("div",{className:"phoneContainer_2R0gP"},e.createElement("div",{className:KI},e.createElement("b",null,a)),e.createElement("div",{className:YI},e.createElement("div",{className:j(XI,QI),onClick:function(){return i("cancel")}},o("common.cancel")),e.createElement("div",{className:j(XI,"deleteBtn_1A-QS"),onClick:function(){return n(1)}},s)))},lP=function(t){var n,i,r,o,a,s=t.readonly,l=t.comment,c=t.message,u=t.viewportDom,d=t.className,p=t.couldPreview,h=void 0===p||p,f=e.useRef(null),m=e.useState(!1),v=m[0],g=m[1],y=e.useRef(null),b=e.useMemo((function(){return!!c.pending}),[c,c.pending]),E=e.useRef(null),x=e.useCallback((function(){var e=f.current,t=0,n=function(){var i,r;if(c.failed)return E.current&&mr(E.current),void(e.style.width="0");var o=Date.now();o-t>1e3/60&&(e.style.width="".concat(Math.min(98,null!==(r=null===(i=c.pending)||void 0===i?void 0:i.progress)&&void 0!==r?r:0),"%")),t=o,E.current=fr(n)};n()}),[]),w=nP(c,(function(){return x()})),C=w.uploadErr,S=w.retryUpload,k=W().getUpimeTrans;tP((function(){return g(!1)}),u),e.useEffect((function(){return b&&x(),function(){E.current&&mr(E.current)}}),[b]),e.useEffect((function(){C&&(E.current&&mr(E.current),f.current.style.width="0")}),[C]);var _=e.useCallback((function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return b?(l.deleteMsg(c),[3,8]):[3,1];case 1:return I.phoneMode?[4,I.showWindow(aP,{element:l,msg:c,couldPreview:h,coundDownload:I.downloadConfig.enable},!1,!0,{type:"drawer"})]:[3,7];case 2:return 1!==(e=t.sent())?[3,3]:(T(),[3,6]);case 3:return 2!==e?[3,4]:(P(),[3,6]);case 4:return 3!==e?[3,6]:[4,I.showWindow(sP,{},!1,!1)];case 5:1===t.sent()&&l.deleteMsg(c),t.label=6;case 6:return[3,8];case 7:g(!v),t.label=8;case 8:return[2]}}))}))}),[b,v]),T=e.useCallback((function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:if(g(!1),b||!c.append.fileId||!l.upime.previewExternalFile||!h)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,l.upime.getFileInfo(c.append.fileId)];case 2:return e=t.sent().url,l.upime.previewExternalFile(c.append,e),[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}}))}))}),[b]),I=e.useContext(xl).upime,P=function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){return c.append.fileId&&c.append.name&&I.downloadOssFile(c.append.fileId,c.append.name),g(!1),[2]}))}))},N=l.upime.previewExternalFile&&h||I.downloadConfig.enable&&P||c.commentator===l.upime.localUserInfo.loginName;return e.createElement(e.Fragment,null,e.createElement("div",{className:j(JI.basic,d,C&&JI.error)},e.createElement("div",{onDoubleClick:T,className:JI.root},e.createElement("div",{className:JI.progress,ref:f}),e.createElement(hl,{icon:eP(null!==(n=c.append.ext)&&void 0!==n?n:""),className:JI.logo}),e.createElement("div",{className:JI.info},e.createElement("span",null,null!==(o=$I(null!==(i=c.append.name)&&void 0!==i?i:"",null!==(r=c.append.ext)&&void 0!==r?r:""))&&void 0!==o?o:"unknown"," "),e.createElement("span",null," ",na(null!==(a=c.append.size)&&void 0!==a?a:0)," "))),s?null:e.createElement(e.Fragment,null,e.createElement("div",{className:JI.iconCon,ref:y},b?e.createElement(hl,{icon:"shanchu",className:JI.floatIcon,onClick:function(e){e.stopPropagation(),_()}}):N?e.createElement(hl,{icon:"gengduo",className:JI.floatIcon,onClick:function(e){e.stopPropagation(),_()}}):null),v?e.createElement(oP,{comment:l,message:c,closeEvt:function(){g(!1)},onPreview:l.upime.previewExternalFile?T:void 0,couldPreview:h,onDownload:P,targetDom:y.current}):null)),C&&e.createElement("div",{className:JI.errorCon,onClick:S},e.createElement("span",null,k("comment.file.upload.failed")),e.createElement(hl,{icon:"file-shuaxin"})))},cP=function(t){var n=t.readonly,i=t.comment,r=t.message,o=t.className,a=t.viewportDom,s=e.useRef(new Audio),l=e.useMemo((function(){return!!r.pending}),[r,r.pending]),c=e.useState(!1),u=c[0],d=c[1],p=e.useRef(null),h=e.useRef(null),f=e.useRef(null),m=e.useRef(null),v=e.useRef(null),g=e.useState(!1),y=g[0],b=g[1],E=e.useRef({pointerId:null,oriX:0,x:0,connected:!1,oriTarRect:{x:0,y:0,width:0,height:0},trackRect:{x:0,y:0,width:0,height:0},percentage:0}),x=e.useMemo((function(){return!!r.failed}),[r,r.failed]),w=e.useState(10),C=w[0],S=w[1],k=e.useRef(0);e.useEffect((function(){var e,t=function(e){return A(void 0,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,i.upime.getFileInfo(r.append.fileId)];case 1:return t=n.sent(),s.current.src=t.url+(null!=e?e:""),b(!0),[2]}}))}))};return!l&&r.append.fileId&&(1===r.append.transStatus?t("_t.mp3"):0===r.append.transStatus?t():2===r.append.transStatus&&(S(Math.max(Math.round((r.append.estimateCompleteTime-Date.now())/1e3/60),1)),k.current&&(k.current=window.setInterval((function(){S(Math.max(C-1,1))}),6e4))),e=i.upime.view.subscribe("viewboxChange",(function(){E.current.pointerId&&(P(),s.current.paused&&p.current&&mr(p.current),E.current.pointerId=null,E.current.connected=!1)}))),function(){null==e||e(),k.current&&clearInterval(k.current)}}),[r,r.append,r.append.transStatus]);var _=function(e){e.stopPropagation();var t=E.current.pointerId;null!==t&&t!==e.pointerId||(E.current.pointerId=e.pointerId,E.current.connected=!0,E.current.oriX=e.pageX,E.current.oriTarRect=h.current.getBoundingClientRect(),E.current.trackRect=m.current.getBoundingClientRect(),p.current&&mr(p.current))},T=function(e){var t,n=E.current,i=n.pointerId;if((null===i||i===e.pointerId)&&n.connected){p.current&&mr(p.current);var o=0;if(e.pageX<=n.trackRect.x)o=0;else if(e.pageX>=n.trackRect.x+n.trackRect.width)o=100;else{var a=e.pageX-n.oriX;o=(n.oriTarRect.x+a-n.trackRect.x+n.oriTarRect.width/2)/n.trackRect.width*100|0}var l=h.current,c=f.current,u=v.current,d=(null!==(t=r.append.duration)&&void 0!==t?t:s.current.duration)*o/100;l&&(l.style.left="".concat(o,"%")),c&&(c.style.width="".concat(o,"%")),u&&(u.innerHTML="".concat("0".concat(d/60|0).slice(-2),":").concat("0".concat(d%60|0).slice(-2))),n.percentage=o}},I=function(e){var t,n=E.current.pointerId;if((null===n||n===e.pointerId)&&E.current.connected){var i=s.current;i&&(i.currentTime=E.current.percentage/100*(null!==(t=r.append.duration)&&void 0!==t?t:i.duration),P(),s.current.paused&&p.current&&mr(p.current)),E.current.pointerId=null,E.current.connected=!1}};e.useEffect((function(){var e=function(){P()},t=function(){p.current&&mr(p.current)},n=m.current,i=h.current,o=s.current,a=function(e){var t,i=n.getBoundingClientRect(),o=i.x,a=i.width,l=Math.max(0,Math.min((e.pageX-o)/a,100)),c=s.current;c.currentTime=(null!==(t=r.append.duration)&&void 0!==t?t:c.duration)*l,P(),c.paused&&p.current&&mr(p.current)};return y&&(n.addEventListener("pointerdown",a),i.addEventListener("pointerdown",_),document.addEventListener("pointermove",T),document.addEventListener("pointerup",I),o.addEventListener("play",e),o.addEventListener("pause",t)),function(){y&&(n.removeEventListener("pointerdown",a),i.removeEventListener("pointerdown",_),document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",I),o.removeEventListener("play",e),o.removeEventListener("pause",t)),!s.current.paused&&s.current.pause()}}),[y]);var P=e.useCallback((function(){var e=0,t=h.current,n=f.current,i=v.current,o=s.current,a=function(){var s,l,c=Date.now();if(c-e>100){if(o.currentTime>=(null!==(s=r.append.duration)&&void 0!==s?s:o.duration))return o.currentTime=0,d(!1),P(),void(p.current&&mr(p.current));var u=o.currentTime/(null!==(l=r.append.duration)&&void 0!==l?l:o.duration);t.style.left="".concat(100*u,"%"),n.style.width="".concat(100*u,"%"),i.innerHTML="".concat("0".concat(o.currentTime/60|0).slice(-2),":").concat("0".concat(o.currentTime%60|0).slice(-2)),e=c}p.current=fr(a)};a()}),[]),N=e.useMemo((function(){var e,t;return"".concat("0".concat((null!==(e=r.append.duration)&&void 0!==e?e:0)/60|0).slice(-2),":").concat("0".concat((null!==(t=r.append.duration)&&void 0!==t?t:0)%60|0).slice(-2))}),[r.append]),M=2===r.append.transStatus,R=W().getUpimeTrans;return e.createElement("div",{className:j("root_1Y1F1",o,!x&&"border_2WEx5")},e.createElement(lP,{message:r,comment:i,readonly:n,viewportDom:a,className:x?void 0:"fileInfo_SkkmU",couldPreview:!1}),!l&&M&&e.createElement("div",{className:j(qI,"transing_2N5G7")},R("common.transcoding")," ",C," ",R("common.minutes")),l||M?null:e.createElement("div",{className:qI},y?e.createElement(e.Fragment,null,e.createElement(hl,{icon:u?"zanting":"bofangqi",className:"trigger_PY_UL",onClick:function(){s.current.paused?(d(!0),s.current.play()):(d(!1),s.current.pause())}}),e.createElement("span",{className:"curTime_3WQzu",ref:v},"00:00"),e.createElement("div",{className:"track_3IsAO",ref:m},e.createElement("div",{className:"progress_3Hwrx",ref:f}),e.createElement("div",{className:"controller_FoExa",ref:h})),e.createElement("span",{className:"duration_1zvh7"},N)):null))},uP=function(t){var n=t.readonly,i=t.comment,r=t.message,o=t.extras,a=void 0===o?{}:o,s=t.className,l=t.viewportDom,c=e.useRef(null),u=a.maxWidth,d=void 0===u?308:u,p=i.upime,h=e.useMemo((function(){return!!r.pending}),[r,r.pending]),f=e.useMemo((function(){return{width:Math.min(90+(d-90)*(Math.ceil(r.append.duration)/60),d)}}),[]),m=e.useRef(null),v=e.useState(!1),g=v[0],y=v[1],b=e.useRef(new Audio),E=e.useRef(null),x=e.useRef(0),w=e.useMemo((function(){return r.commentator===p.localUserInfo.loginName&&!n}),[]),C=e.useState(!1),S=C[0],k=C[1],_=e.useRef(null);return tP((function(){return k(!1)}),l),e.useEffect((function(){!h&&r.append.fileId&&A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,i.upime.getFileInfo(r.append.fileId)];case 1:return e=t.sent(),b.current.src=e.url,[2]}}))}))}),[h]),e.useEffect((function(){return function(){!b.current.paused&&b.current.pause()}}),[]),e.useEffect((function(){var e=b.current,t=function(){var t,n=null===(t=c.current)||void 0===t?void 0:t.frame,i=m.current,o=0,a=0,s=function(){var t=Date.now();Date.now()-o>=1e3/60&&(i.style.width="".concat(e.currentTime/r.append.duration*f.width,"px"),o=t),Date.now()-a>=500&&(n.render(),x.current=(x.current+1)%3,a=t),E.current=fr(s)};s()},n=function(){var e=c.current.frame;E.current&&mr(E.current),x.current=0,e.render()},i=function(){var t=c.current.frame,n=m.current;E.current&&mr(E.current),x.current=0,t.render(),n.style.width="0",e.currentTime=0};return e.addEventListener("play",t),e.addEventListener("ended",i),e.addEventListener("pause",n),function(){e.removeEventListener("play",t),e.removeEventListener("ended",i),e.removeEventListener("pause",n)}}),[]),e.createElement(e.Fragment,null,e.createElement("div",{style:f,className:j("root_mmXxA",s),onMouseEnter:function(){w&&!g&&y(!0)},onMouseLeave:function(){g&&y(!1)},onClick:function(){return!h&&void((e=b.current).paused?e.play():e.pause());var e}},e.createElement("div",{className:"bg_3QS7x"}),e.createElement("div",{className:"progress_3ZVuo",ref:m}),h?e.createElement(hl,{icon:"jiazai",className:"loading_12tfu"}):e.createElement(Xo,{ref:c,width:28,height:32,resolution:2},e.createElement(ko,{x:0,y:0,drawAny:function(e){var t=e.context;t.lineWidth=.5,t.strokeStyle="#0c1024",t.clearRect(0,0,24,32),t.beginPath(),t.moveTo(11,16),t.lineTo(14.5,16),t.arc(11,16,3.5,0,Math.PI/2),t.lineTo(11,16),t.fill(),t.stroke(),1!==x.current&&(t.beginPath(),t.moveTo(16.8,16),t.lineTo(18.2,16),t.arc(11,16,7.2,0,Math.PI/2),t.lineTo(11,21.8),t.arc(11,16,5.8,Math.PI/2,0,!0),t.fill(),t.stroke(),2!==x.current&&(t.beginPath(),t.moveTo(20.8,16),t.lineTo(22.2,16),t.arc(11,16,11.2,0,Math.PI/2),t.lineTo(11,25.8),t.arc(11,16,9.8,Math.PI/2,0,!0),t.fill(),t.stroke()))}})),e.createElement("span",null,"".concat(Math.ceil(r.append.duration),'"')),e.createElement("div",{className:"iconCon_3EBbe",ref:_,style:{visibility:w&&(g||p.phoneMode)||S?"visible":"hidden"}},e.createElement(hl,{icon:"shanchu",className:j((S||p.phoneMode)&&"active_1BlTp"),onClick:function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return e.stopPropagation(),p.phoneMode?[4,p.showWindow(sP,{},!1,!1)]:[3,2];case 1:return 1===t.sent()&&i.deleteMsg(r),[3,3];case 2:S||k(!0),t.label=3;case 3:return[2]}}))}))}}))),S&&e.createElement(ZI,{targetDom:_.current,upime:i.upime,onConfirm:function(){i.deleteMsg(r)},closeEvt:function(){k(!1)}}))},dP={root:"root_2YuiZ",transingContainer:"transingContainer_3lDZU",uploadCover:"uploadCover_Pfa1z",progressCon:"progressCon_7IB5m",clickable:"clickable_1qzZz",loading:"loading_jtg6-",deleteIcon:"deleteIcon_3xsve",iconCon:"iconCon_3Prxl",imgLoading:"imgLoading_1KTJY"},pP=function(t){var n=t.comment,i=t.message,r=t.className,o=t.extras,a=void 0===o?{}:o,s=t.viewportDom,l=t.readonly,c=e.useMemo((function(){return!!i.pending}),[i,i.pending]),u=e.useRef(null),d=a.maxWidth,p=void 0===d?308:d,h=a.maxHeight,f=void 0===h?250:h,m=a.minSize,v=void 0===m?148:m,g=e.useState(!1),y=g[0],b=g[1],E=e.useRef(null),x=e.useState(!1),w=x[0],C=x[1],S=W().getUpimeTrans,k=e.useRef(null),_=e.useRef(null),T=e.useRef(!1),I=e.useRef(!1),P=e.useMemo((function(){return i.append.size<=10485760}),[]),N=e.useRef(null),M=e.useRef(null),R=e.useState(!1),B=R[0],L=R[1],O=e.useCallback((function(){var e=E.current,t=0,n=function(){var r,o,a=Date.now();a-t>100&&(e.innerHTML=S("common.upload.progress","".concat(Math.max(null!==(o=null===(r=i.pending)||void 0===r?void 0:r.progress)&&void 0!==o?o:0,99),"%")),t=a),N.current=fr(n)};n()}),[]),F=nP(i,(function(){return O()})),z=F.retryUpload,H=F.uploadErr;e.useEffect((function(){H&&(N.current&&mr(N.current),E.current.innerHTML=S("comment.file.upload.failed"))}),[H]);var U=e.useCallback(ne((function(){if(!T.current&&!I.current&&P){var e=u.current;if(e){var t=s.getBoundingClientRect(),n=t.top,i=t.bottom,r=e.getBoundingClientRect(),o=r.top,a=r.bottom;(o>=n&&o<=i||a>=n&&a<=i)&&V()}}}),200),[]);tP(U,s);var V=e.useCallback((function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return i.append.localEle?[2,i.append.localEle.src]:(I.current=!0,b(!0),[4,n.upime.getFileInfo(i.append.fileId)]);case 1:return e=t.sent(),M.current=e.url,T.current=!0,_.current&&(_.current.src="".concat(e.url).concat("svg"!==i.append.ext&&(i.append.width>250||i.append.height>250)?"?x-oss-process=image/resize,h_".concat(250):"")),[2]}}))}))}),[]);e.useEffect((function(){var e,t,r,o;if(P){var a=u.current,l=null!==(t=null===(e=i.append)||void 0===e?void 0:e.localEle)&&void 0!==t?t:new Image;_.current=l;var d=i.append.width,h=i.append.height,m=d/h,g=0,y=0;d>=h?(y=(g=Math.max(Math.min(p,null!==(r=i.append.width)&&void 0!==r?r:v),v))/m,l.style.width="100%"):(g=(y=Math.max(Math.min(f,null!==(o=i.append.height)&&void 0!==o?o:v),v))*m,l.style.height="100%"),a&&(a.style.width="".concat(g,"px"),a.style.height="".concat(y,"px")),c||(l.onload=function(){b(!1),T.current=!0,I.current=!1},l.onerror=function(){b(!1),T.current=!0,I.current=!1},setTimeout((function(){var e=s.getBoundingClientRect(),t=e.top,n=e.bottom,i=a.getBoundingClientRect(),r=i.top,o=i.bottom;(r>=t&&r<=n||o>=t&&o<=n)&&V()}))),n.upime.previewExternalFile&&l.addEventListener("click",G),l.addEventListener("contextmenu",(function(e){e.stopPropagation()})),a.insertBefore(l,a.children[0])}}),[]);var G=function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){return n.upime.previewExternalFile&&M.current&&n.upime.previewExternalFile(i.append,M.current),[2]}))}))};e.useEffect((function(){return P&&c&&!i.failed&&O(),function(){N.current&&mr(N.current)}}),[c]);var q=e.useContext(xl).upime,K=function(){i.append.fileId&&i.append.name&&q.downloadOssFile(i.append.fileId,i.append.name),L(!1)};tP((function(){return L(!1)}),s);var Y=!l&&(q.downloadConfig.imageEnable||i.commentator===n.upime.localUserInfo.loginName);return P?e.createElement(e.Fragment,null,e.createElement("div",{className:j(dP.root,r),ref:u,onPointerEnter:function(){c||!w&&C(!0)},onPointerLeave:function(){c||w&&C(!1)}},c?e.createElement("div",{className:dP.uploadCover},e.createElement("div",{className:j(dP.progressCon,H&&dP.clickable),onClick:function(){H&&z()}},e.createElement(hl,{icon:H?"file-jinggao":"jiazai",className:j(!H&&dP.loading)}),e.createElement("span",{ref:E})),e.createElement(hl,{icon:"shanchu",className:dP.deleteIcon,onClick:function(){return n.deleteMsg(i)}})):Y&&e.createElement("div",{className:j(dP.iconCon,B&&dP.active),style:{visibility:!c&&(w||!_e.desktop)||B?"visible":"hidden"},ref:k},e.createElement(hl,{icon:"gengduo",className:dP.floatIcon,onClick:function(e){e.stopPropagation(),A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return q.phoneMode?[4,q.showWindow(aP,{element:n,msg:i,couldPreview:!1,coundDownload:!0},!1,!0,{type:"drawer"})]:[3,6];case 1:return 1!==(e=t.sent())?[3,2]:[3,5];case 2:return 2!==e?[3,3]:(K(),[3,5]);case 3:return 3!==e?[3,5]:[4,q.showWindow(sP,{},!1,!1)];case 4:1===t.sent()&&n.deleteMsg(i),t.label=5;case 5:return[3,7];case 6:L(!B),t.label=7;case 7:return[2]}}))}))}})),y&&e.createElement(hl,{icon:"jiazai",className:dP.imgLoading})),B?e.createElement(oP,{comment:n,message:i,closeEvt:function(){L(!1)},couldPreview:!1,onDownload:q.downloadConfig.imageEnable?K:void 0,targetDom:k.current}):null):e.createElement(lP,{comment:n,message:i,readonly:l,viewportDom:s})},hP=function(t){var n=t.comment,i=t.message,r=t.readonly,o=t.className,a=t.viewportDom,s=e.useRef(null),l=e.useRef(null),c=e.useRef(null),u=W().getUpimeTrans,d=e.useState(!1),p=d[0],h=d[1],f=e.useRef(null),m=e.useRef(null),v=e.useMemo((function(){return!!i.pending}),[i,i.pending]);e.useEffect((function(){return function(){f.current&&!f.current.paused&&f.current.pause(),S.current&&clearInterval(S.current)}}),[]);var g=e.useCallback((function(){var e=0,t=l.current,n=function(){var r,o,a=Date.now();a-e>100&&(t.innerHTML=u("common.upload.progress","".concat(Math.min(99,null!==(o=null===(r=i.pending)||void 0===r?void 0:r.progress)&&void 0!==o?o:0),"%")),e=a),m.current=fr(n)};n()}),[]),y=nP(i,(function(){return g()})),b=y.uploadErr,E=y.retryUpload;e.useEffect((function(){b&&(m.current&&mr(m.current),l.current&&(l.current.innerHTML=u("comment.file.upload.failed")))}),[b]),e.useEffect((function(){return v&&!i.failed&&g(),function(){m.current&&mr(m.current)}}),[v]);var x=e.useState(10),w=x[0],C=x[1],S=e.useRef(0);e.useEffect((function(){var e=s.current;if(i.append.localEle){var t=i.append.localEle;e.insertBefore(t,e.children[0])}else if(2===i.append.transStatus&&i.append.coverInfo){var r=i.append.coverInfo.fileId,o=document.createElement("img");o.style.maxHeight="180px",A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,n.upime.getFileInfo(r)];case 1:return e=t.sent(),o.src=e.url,[2]}}))})),C(Math.max(Math.round((i.append.estimateCompleteTime-Date.now())/1e3/60),1)),S.current&&(S.current=window.setInterval((function(){C(Math.max(w-1,1))}),6e4)),e.insertBefore(o,e.children[0])}else if(1===i.append.transStatus||0===i.append.transStatus){var a=document.createElement("video");f.current=a,A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,n.upime.getFileInfo(i.append.fileId)];case 1:return e=t.sent(),a.src=e.url+(0===i.append.transStatus?"":"_t.mp4"),[2]}}))})),a.onloadedmetadata=function(){setTimeout((function(){a.controls=!0,a.setAttribute("controlsList","nodownload")}),300)};var l=e.getElementsByTagName("img")[0];l&&e.removeChild(l);var c=e.getElementsByTagName("video")[0];c&&e.removeChild(c),e.insertBefore(a,e.children[0]);var u=function(){var e;null===(e=a.parentElement)||void 0===e||e.click()};return a.addEventListener("play",u),function(){a.removeEventListener("play",u)}}}),[i,i.append,i.append.transStatus]);var k=e.useState(!1),_=k[0],T=k[1],I=e.useContext(xl).upime,P=function(){i.append.fileId&&i.append.name&&I.downloadOssFile(i.append.fileId,i.append.name),T(!1)};tP((function(){return T(!1)}),a);var N=2===i.append.transStatus,M=3===i.append.transStatus,R=!r&&(I.downloadConfig.enable&&P||i.commentator===n.upime.localUserInfo.loginName);return e.createElement(e.Fragment,null,e.createElement("div",{className:j(dP.root,o),ref:s,onPointerEnter:function(){v||!p&&h(!0)},onPointerLeave:function(){v||p&&h(!1)}},v?e.createElement("div",{className:dP.uploadCover},e.createElement("div",{className:j(dP.progressCon,b&&dP.clickable),onClick:function(){b&&E()}},e.createElement(hl,{icon:b?"file-jinggao":"jiazai",className:j(!b&&dP.loading)}),e.createElement("span",{ref:l})),e.createElement(hl,{icon:"shanchu",className:dP.deleteIcon,onClick:function(){return n.deleteMsg(i)}})):e.createElement(e.Fragment,null,N&&e.createElement("div",{className:dP.transingContainer},e.createElement(hl,{icon:"shipinzhuanma",className:dP.floatIcon}),e.createElement("span",null,u("common.transcoding")," ",w," ",u("common.minutes"))),M&&e.createElement("div",{className:dP.transingContainer},e.createElement(hl,{icon:"jinggao",className:dP.floatIcon}),e.createElement("span",null,u("common.transcoding.fail"))),R&&e.createElement("div",{className:j(dP.iconCon,_&&dP.active),style:{visibility:!v&&(p||!_e.desktop)||_?"visible":"hidden"},ref:c},e.createElement(hl,{icon:"gengduo",className:dP.floatIcon,onClick:function(e){e.stopPropagation(),A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return I.phoneMode?[4,I.showWindow(aP,{element:n,msg:i,couldPreview:!1,coundDownload:I.downloadConfig.enable},!1,!0,{type:"drawer"})]:[3,6];case 1:return 1!==(e=t.sent())?[3,2]:[3,5];case 2:return 2!==e?[3,3]:(P(),[3,5]);case 3:return 3!==e?[3,5]:[4,I.showWindow(sP,{},!1,!1)];case 4:1===t.sent()&&n.deleteMsg(i),t.label=5;case 5:return[3,7];case 6:T(!_),t.label=7;case 7:return[2]}}))}))}})))),_?e.createElement(oP,{comment:n,message:i,closeEvt:function(){T(!1)},couldPreview:!1,onDownload:P,targetDom:c.current}):null)},fP=function(t){var n=t.message,i=t.className,r=t.readonly,o=t.comment,a=t.viewportDom;return e.createElement("div",{className:j("root_1HFC6",i)},e.createElement(lP,{comment:o,message:n,readonly:r,viewportDom:a}))},mP=e.memo((function(t){var n=t.comment,i=t.upime,r=t.onFirstLoad,o=e.useState([]),a=o[0],s=o[1],l=e.useRef(!1),c=e.useRef(0),u=e.useRef(null),d=e.useRef(null);Sx([d]),e.useEffect((function(){var e=function(){var e,t,o,a=(null!==(e=i.commentManager.commentMsgMap[n.id])&&void 0!==e?e:[]).filter((function(e){return!e.deleted})),p=a[0];p&&(p.adjacentPre=!1);for(var h=1;h<a.length;h++)a[h].commentator===a[h-1].commentator?(a[h].adjacentPre=!0,a[h-1].adjacentPost=!0):(a[h].adjacentPre=!1,a[h-1].adjacentPost=!1);s(a);var f=null!==(o=null===(t=a[a.length-1])||void 0===t?void 0:t.createTime)&&void 0!==o?o:0;if(l.current){if(f>c.current&&d.current){var m=d.current.parentElement;setTimeout((function(){m.scrollHeight>m.clientHeight&&(u.current&&u.current(),u.current=Ll([m.scrollTop],[m.scrollHeight],(function(e){var t=e[0];m.scrollTop=t}),200))}),50)}}else setTimeout((function(){var e,t=null===(e=d.current)||void 0===e?void 0:e.parentElement;t&&(t.scrollTop=t.scrollHeight),null==r||r(),l.current=!0}),100);c.current=f};e();var t=i.subscribe("commentMessagesUpdate",(function(){e()}));return setTimeout((function(){!l.current&&(null==r||r()),l.current=!0}),500),function(){t()}}),[]);var p=e.useMemo((function(){var e,t;return null===(t=null===(e=d.current)||void 0===e?void 0:e.parentElement)||void 0===t?void 0:t.parentElement}),[d.current]),h=e.useMemo((function(){var e;return null===(e=d.current)||void 0===e?void 0:e.parentElement}),[d.current]),f=e.useCallback((function(e){switch(e.type){case TI.AUDIO:return"local_record"===e.append.audioType?uP:cP;case TI.FILE:return fP;case TI.IMAGE:return pP;case TI.VIDEO:return hP}}),[]);return e.createElement("div",{ref:d,className:"listRoot_2aTNI",style:{fontFamily:He}},a.map((function(t,r){var o,s,l;if(t.type===TI.TEXT)return e.createElement(GI,{key:null!==(o=t.id)&&void 0!==o?o:t.createTime,message:t,adjacentPre:t.adjacentPre,adjacentPost:t.adjacentPost,upime:i,isLast:r===a.length-1},e.createElement(FI,{key:null!==(s=t.id)&&void 0!==s?s:t.createTime,message:t,upime:i,comment:n,panelRootDom:p}));var c=f(t);return e.createElement(GI,{key:null!==(l=t.id)&&void 0!==l?l:t.createTime,message:t,adjacentPre:t.adjacentPre,adjacentPost:t.adjacentPost,upime:i,isLast:r===a.length-1},e.createElement(c,{readonly:!1,comment:n,message:t,viewportDom:h}))})))})),vP=function(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=i.element;return e.createElement("div",{className:RI},e.createElement("span",{className:BI,onClick:function(){n(1)}},r("comment.submenu.copyLink")),o.couldBeEdit&&e.createElement("span",{className:j(BI,LI),onClick:function(){n(2)}},r("common.delete")))},gP=function(t){var n=t.element,i=t.upime,r=t.onFirstLoad,o=W().getUpimeTrans,a=yh(!0),s=a.hide,l=a.setHide,c=a.skipRef,u=e.useState(!1),d=u[0],p=u[1],h=e.useRef(null),f=e.useRef(null),m=i.userManager.commentOnlyMode,v=!i.editable&&!m,g=e.useState({})[1],y=i.phoneMode?function(){return g({})}:void 0,b=!(!i.getMentionCandidate&&!i.getMentionGroupAndCandidate);Sx([c,h]),e.useEffect((function(){if(i.phoneMode)return i.subscribe("elementsUpdated",(function(e){e.forEach((function(e){e.element===n&&(null==y||y())}))}))}),[]),e.useEffect((function(){p(n.pined)}),[n]);var E=e.useMemo((function(){return{options:rt.map((function(e,t){return{value:t,color:e}})),onChange:function(e){i.setDraftCommentColor(e),n.setThemeColor(e),null==y||y()},value:n.color}}),[n,n.color]),x=e.useCallback((function(){var e,t=null===(e=i.getElementLink)||void 0===e?void 0:e.call(i,n.id);t&&Xd(t,{onCopy:function(e){i.addToast(o("link.copy.success.toast"),{type:"normal"}),e.setData("text/plain",t)}}),l(!0)}),[]);e.useEffect((function(){var e=function(e){e.clientX+4>=e.target.getBoundingClientRect().right&&e.stopPropagation()};return f.current&&f.current.addEventListener("pointerdown",e),function(){var t;null===(t=f.current)||void 0===t||t.removeEventListener("pointerdown",e)}}),[f.current]);var w=e.useRef(null);return e.createElement("div",{className:Cx.panelRoot},v?null:e.createElement("div",{className:Cx.header},e.createElement("div",{className:Cx.toggleRoot,ref:h},e.createElement(Hl,{config:{onChange:function(e){n.setResolved(e),null==y||y()}},value:n.resolved}),e.createElement("span",{className:n.resolved?Cx.resolvedText:void 0},n.resolved?o("comment.resolved.label"):o("comment.unresolved.label"))),e.createElement("div",{className:Cx.actions,ref:c},e.createElement(kl,exports.E({},E,{className:Cx.themeSelector})),e.createElement(hl,{className:j(Ml.moreIcon,!s&&Cx.activeIcon),icon:"gengduo",onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return i.phoneMode?[4,i.showWindow(vP,{element:n},!1,!0,{type:"drawer"})]:[3,2];case 1:return 1===(e=t.sent())?x():2===e&&(n.deleteSelf(),i.closePhoneDrawer()),[3,3];case 2:l(!s),t.label=3;case 3:return[2]}}))}))}}),!s&&e.createElement(xh,{className:Cx.panelSubmenu,align:"right"},!i.phoneMode&&e.createElement("div",{className:Cx.row,onClick:function(){n.setPined(!d),p(!d),l(!0)}},e.createElement("div",{className:Cx.content},e.createElement(hl,{className:Cx.headIcon,icon:"guding"}),e.createElement("span",null,o("comment.submenu.pin"))),d&&e.createElement(hl,{icon:"gou",className:Cx.pin})),i.getElementLink&&e.createElement("div",{className:Cx.row,onClick:x},e.createElement("div",{className:Cx.content},e.createElement(hl,{className:Cx.headIcon,icon:"lianjie"}),e.createElement("span",null,o("comment.submenu.copyLink")))),n.couldBeEdit&&e.createElement("div",{className:Cx.row,onClick:function(){n.deleteSelf(),i.phoneMode&&i.closePhoneDrawer()}},e.createElement("div",{className:Cx.content},e.createElement(hl,{className:Cx.headIcon,icon:"shanchu"}),e.createElement("span",null,o("comment.submenu.delete"))))))),e.createElement("div",{className:Cx.body,style:v?{borderRadius:"8px"}:void 0,ref:f,onClick:function(e){var t=e.target;if("svg"===t.nodeName){var n=t.getAttribute("x-from");n&&i.getAllUsersInMention&&i.getAllUsersInMention().then((function(e){var t,r,o=e.find((function(e){return e.loginName===n}));if(o)null===(t=w.current)||void 0===t||t.insertMention(o);else{var a=i.getUserInfo(n);null===(r=w.current)||void 0===r||r.insertText("@".concat(a.userName," "))}}))}}},e.createElement(mP,{comment:n,upime:i,onFirstLoad:r})),v?null:e.createElement(NI,{ref:w,element:n,placeholder:o(b?"comment.add.reply":"comment.add.reply.no.at"),autoFocus:!1,upime:i}))},yP=function(t){var n,i=t.element,r=t.upime,o=e.useRef(i.getGlobalPosition()),a=e.useRef(i.getScreenPosition()),s=i.getGlobalPosition(),l=i.getScreenPosition(),c=e.useRef(null),u=e.useRef(null),d=e.useRef(null),p=e.useRef(!1),h=e.useRef({pointerId:null,connected:!1,originPos:{x:0,y:0},dragging:!1,rootTransX:0,rootTransY:0,hide:!0,lineWidth:230,lineRotate:180,panelCenter:{x:0,y:0}}),f=e.useCallback((function(){if(d.current&&c.current&&u.current){var e=function(e,t,n){void 0===t&&(t=50),void 0===n&&(n=!1);var i=document.documentElement,r=i.clientWidth,o=i.clientHeight,a=r-(n?340:0),s=180/Math.PI,l=0,c=0,u=0,d=0,p=230,h=0;if(e.x+340+60<a)if(l=e.x+60,u=e.x+60+170,e.y-t/2>=64){if(e.y+t/2<=o-64)return{rootTransX:l,rootTransY:e.y,panelCenterX:u,panelCenterY:e.y,lineWidth:p,lineRotate:180};c=o-64-t/2,d=o-64-t/2,h=230}else c=64+t/2,d=64+t/2,h=230;else if(l=e.x-60-340,u=e.x-230,e.y-t/2>=64){if(e.y+t/2<=o-64)return{rootTransX:l,rootTransY:e.y,panelCenterX:u,panelCenterY:e.y,lineRotate:0,lineWidth:p};c=o-64-t/2,d=o-64-t/2,h=230}else c=64+t/2,d=64+t/2,h=230;var f=d-e.y;return{rootTransX:l,rootTransY:c,panelCenterX:u,panelCenterY:d,lineWidth:p=Math.sqrt(Math.pow(h,2)+Math.pow(f,2)),lineRotate:(s*Math.atan2(d-e.y,u-e.x)+180)%360}}(l,"draft"===i.type?void 0:d.current.clientHeight,null!==r.rightSlidePanelType),t=e.rootTransX,n=e.rootTransY,o=e.panelCenterX,a=e.panelCenterY,s=e.lineWidth,f=e.lineRotate;h.current.rootTransX=l.x+60,h.current.rootTransY=l.y,h.current.panelCenter={x:l.x+230,y:l.y},h.current=exports.E(exports.E({},h.current),{rootTransX:t,rootTransY:n,panelCenter:{x:o,y:a},lineRotate:f,lineWidth:s}),c.current.style.left="".concat(h.current.rootTransX,"px"),c.current.style.top="".concat(h.current.rootTransY,"px"),u.current.style.width="".concat(h.current.lineWidth,"px"),u.current.style.transform="translate(170px, -1px) rotate(".concat(h.current.lineRotate,"deg)"),c.current.style.visibility="visible",p.current=!0}}),[r.rightSlidePanelType]);if(e.useEffect((function(){"draft"===i.type&&d.current&&f()}),[]),e.useEffect((function(){return c.current&&u.current&&"comment"===i.type&&(c.current.addEventListener("pointerdown",v),document.addEventListener("pointermove",g),document.addEventListener("pointerup",y)),function(){c.current&&"comment"===i.type&&(c.current.removeEventListener("pointerdown",v),document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",y))}}),[c.current]),(s.x!==o.current.x||s.y!==o.current.y)&&u.current){h.current.lineWidth=fn(l,h.current.panelCenter),u.current.style.width="".concat(h.current.lineWidth,"px");var m=(180/Math.PI*Math.atan2(h.current.panelCenter.y-l.y,h.current.panelCenter.x-l.x)+180)%360;h.current.lineRotate=m,u.current.style.transform="translate(170px, -1px) rotate(".concat(h.current.lineRotate,"deg)"),o.current=s,a.current=i.getScreenPosition()}var v=function(e){var t=h.current.pointerId;null!==t&&t!==e.pointerId||(h.current.pointerId=e.pointerId,h.current.connected=!0,h.current.originPos={x:e.pageX,y:e.pageY},h.current.dragging=!0)},g=function(e,t){if(void 0===t&&(t=!1),c.current&&u.current&&h.current.dragging){var n=h.current.pointerId;if(null!==n&&n!==e.pointerId)return;if(!h.current.connected)return;var r=h.current.originPos,o={x:e.pageX-r.x,y:e.pageY-r.y},a={x:h.current.rootTransX+o.x,y:h.current.rootTransY+o.y},s={x:h.current.panelCenter.x+o.x,y:h.current.panelCenter.y+o.y},l=i.getScreenPosition();h.current.lineWidth=fn(s,l),u.current.style.width="".concat(h.current.lineWidth,"px"),c.current.style.left="".concat(a.x,"px"),c.current.style.top="".concat(a.y,"px");var d=(180/Math.PI*Math.atan2(s.y-l.y,s.x-l.x)+180)%360;h.current.lineRotate=d,u.current.style.transform="translate(170px, -1px) rotate(".concat(h.current.lineRotate,"deg)"),t&&(h.current.rootTransX=a.x,h.current.rootTransY=a.y,h.current.panelCenter=s)}},y=function(e){if(h.current.dragging){var t=h.current.pointerId;if(null!==t&&t!==e.pointerId)return;if(!h.current.connected)return;g(e,!0),h.current.connected=!1,h.current.pointerId=null,h.current.dragging=!1}},b=function(){if(p.current&&c.current){var e=i.getScreenPosition(),t=e.x-a.current.x,n=e.y-a.current.y;h.current.rootTransX+=t,h.current.rootTransY+=n,h.current.panelCenter.x+=t,h.current.panelCenter.y+=n,c.current.style.left="".concat(h.current.rootTransX,"px"),c.current.style.top="".concat(h.current.rootTransY,"px"),a.current=e}};e.useEffect((function(){var e=r.view.subscribe("viewboxChange",b);return function(){i.focusing=!1,e()}}),[]);var E=null!==(n=rt[i.color])&&void 0!==n?n:rt[0];return i.visible?e.createElement("div",{className:Cx.commentWrapper,ref:c,style:{fontFamily:He},onFocusCapture:function(){r.clearSelect()}},e.createElement("div",{className:Cx.connectionLine,ref:u,style:{borderColor:E,backgroundColor:E}},e.createElement("div",{className:Cx.pivot,style:{backgroundColor:E}})),e.createElement("div",{className:Cx.commentBody,ref:d},"draft"===i.type?e.createElement(NI,{element:i,upime:r}):e.createElement(gP,{element:i,upime:r,onFirstLoad:f}))):null},bP=30,EP=29,xP=11,wP=10.5,CP=function(e){var t=js.value,n=t.viewbox,i=t.addLoadingSource,r=n.scale,o=e.imgSource;if(o){o.loaded||null==i||i(o);var a=e.getGlobalPosition();if(fa({x:a.x*r-26,y:a.y*r-40}),("draft"===e.type||e.expanded)&&Na((function(e){e.clear(),e.lineStyle(2,3044325),e.drawRect(7.8,7.5,36.4,35)})),Oa({src:o,width:bP,height:EP,x:xP,y:wP}),e.unreadCount){var s=e.unreadCount>99?"99+":"".concat(e.unreadCount),l=e.useMemo("drawReadCount",(function(){var e={text:s,fontSize:12,lineHeight:12};e.metrics=Da(e);var t=e.metrics.width;return{draw:function(e){var n=8+t;e.clear(),e.lineStyle(2,16777215),e.beginFill(16667216),1===s.length?e.drawCircle(0,0,8):e.drawRoundedRect(0-n/2,-8,n,16,16),e.closePath(),e.endFill()},textData:e}}),[s]),c=l.draw,u=l.textData;Na(c,{x:39,y:12.5}),Ra(u,{fill:"#ffffff",va:"middle",ha:"center",x:39,y:12.5})}ma()}},SP={normal:function(e){return'<g fill-rule="evenodd" fill="none">\n            <path\n                fill="#FFF"\n                stroke="#ECECEE"\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n            />\n            <path\n                fill="'.concat(e,'"\n                d="M25 3a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h20Zm-5 11H10a1 1 0 0 0 0 2h10a1 1 0 0 0 0-2Zm0-6H10a1 1 0 1 0 0 2h10a1 1 0 0 0 0-2Z"\n            />\n        </g>')},resolved:function(e){return'<g fill-rule="evenodd" fill="none">\n            <path\n                fill="#FFF"\n                stroke="#ECECEE"\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n            />\n            <path\n                fill="'.concat(e,'"\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 3-3-3H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n            />\n            <path d="M4 1h22v22H4z" />\n            <path\n                fill="#FFF"\n                d="M20.513 7.685a.917.917 0 0 1 0 1.297l-6.482 6.481a.913.913 0 0 1-.531.261l-.117.008a.914.914 0 0 1-.649-.269l-3.24-3.24a.917.917 0 1 1 1.296-1.297l2.592 2.593 5.834-5.834a.917.917 0 0 1 1.297 0Z"\n            />\n        </g>')},text:function(e){return'<g fill="none" fill-rule="evenodd">\n            <path\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n                stroke="#ECECEE"\n                fill="#FFF"\n            />\n            <path\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n                fill="'.concat(e,'"\n            />\n            <path d="M7 4h16v16H7z" />\n            <g transform="translate(9 6)" fill="#FFF">\n                <path d="M11.333 0c.369 0 .667.298.667.667l-.001.011L12 2.667a.667.667 0 1 1-1.333 0l-.001-1.334H7V12H5V1.333H1.333v1.334a.667.667 0 0 1-1.333 0v-2C0 .298.298 0 .667 0h10.666Z" />\n                <rect x="2.667" y="10.667" width="6.667" height="1.333" rx=".667" />\n            </g>\n        </g>')},image:function(e){return'<g fill="none" fill-rule="evenodd">\n            <path\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n                stroke="#ECECEE"\n                fill="#FFF"\n            />\n            <path\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n                fill="'.concat(e,'"\n            />\n            <path\n                fill="#FFF"\n                fill-rule="nonzero"\n                d="M19.667 5.333a2 2 0 0 1 2 2v9.334a2 2 0 0 1-2 2h-9.334a2 2 0 0 1-2-2V7.333a2 2 0 0 1 2-2ZM9.668 14.32l-.001 2.348c0 .368.298.666.666.666h1.526a8.87 8.87 0 0 1 .609-2.61c-.523-.625-1.43-.776-2.8-.404Zm3.194 3.015h6.805a.667.667 0 0 0 .666-.667V9.862c-3.885.337-7.134 3.586-7.47 7.472Zm6.805-10.667h-9.334a.667.667 0 0 0-.666.666v5.956c1.393-.326 2.493-.179 3.254.47 1.462-2.709 4.25-4.658 7.413-4.9V7.333a.667.667 0 0 0-.667-.666Zm-7.5.666a1.833 1.833 0 1 1 0 3.667 1.833 1.833 0 0 1 0-3.667Zm0 1a.833.833 0 1 0 0 1.667.833.833 0 0 0 0-1.667Z"\n            />\n        </g>')},doc:function(e){return'<g fill-rule="evenodd" fill="none">\n            <path\n                fill="#FFF"\n                stroke="#ECECEE"\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n            />\n            <path\n                fill="'.concat(e,'"\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n            />\n            <path d="M7 4h16v16H7z" />\n            <path\n                fill-rule="nonzero"\n                fill="#FFF"\n                d="m17.013 4.667.039.002a.668.668 0 0 1 .357.137l.016.014a.67.67 0 0 1 .03.025l.016.017 3.334 3.333.013.014a.67.67 0 0 1 .046.054l-.06-.068a.67.67 0 0 1 .192.394l-.012-.068c.004.02.008.04.01.06l.006.086V18c0 .736-.597 1.333-1.333 1.333h-9.334A1.333 1.333 0 0 1 9 18V6c0-.736.597-1.333 1.333-1.333h6.68ZM16.333 6h-6v12h9.334V9.333H17a.667.667 0 0 1-.662-.589l-.005-.077V6Zm1 8a.667.667 0 0 1 .078 1.329l-.078.004h-4.666a.667.667 0 0 1-.078-1.329l.078-.004h4.666Zm0-2.667a.667.667 0 0 1 .078 1.33l-.078.004h-4.666a.667.667 0 0 1-.078-1.33l.078-.004h4.666Zm.333-4.39V8h1.057l-1.057-1.057Z"\n            />\n        </g>')},record:function(e){return'<g fill-rule="evenodd" fill="none">\n            <path\n                fill="#FFF"\n                stroke="#ECECEE"\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n            />\n            <path\n                fill="'.concat(e,'"\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n            />\n            <path d="M8 5h14v14H8z" />\n            <path\n                fill-rule="nonzero"\n                fill="#FFF"\n                d="M18.989 6.744a.467.467 0 0 1 .164.356l.001 7.562c.033.68-.519 1.358-1.336 1.583-.913.253-1.812-.154-2.008-.909-.196-.755.386-1.572 1.3-1.825a1.97 1.97 0 0 1 .914-.038l-.001-4.017-4.892.8.001 5.513.001.044-.001.072c-.031.64-.565 1.254-1.336 1.468-.913.252-1.812-.155-2.008-.91-.196-.754.386-1.572 1.3-1.825.316-.087.63-.096.915-.038V8.115c0-.23.165-.424.391-.461l6.217-1.015a.467.467 0 0 1 .378.105Z"\n            />\n        </g>')},video:function(e){return'<g fill="none" fill-rule="evenodd">\n            <path\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n                stroke="#ECECEE"\n                fill="#FFF"\n            />\n            <path\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n                fill="'.concat(e,'"\n            />\n            <path\n                fill="#FFF"\n                fill-rule="nonzero"\n                d="M17.667 6.668C18.403 6.668 19 7.265 19 8v2l3.035-1.517A.667.667 0 0 1 23 9.08v5.842a.667.667 0 0 1-.965.597L19 14v2c0 .736-.597 1.333-1.333 1.333H8.333A1.333 1.333 0 0 1 7 16.001v-8c0-.736.597-1.333 1.333-1.333h9.334Zm0 1.333H8.333v8h9.334v-8Zm4 2.157L19 11.49v1.02l2.667 1.334v-3.686Zm-9.334-.825a.667.667 0 0 1 0 1.334h-2a.667.667 0 0 1 0-1.334h2Z"\n            />\n        </g>')},audio:function(e){return'<g fill-rule="evenodd" fill="none">\n            <path\n                fill="#FFF"\n                stroke="#ECECEE"\n                d="M25 .5c1.243 0 2.368.504 3.182 1.318A4.486 4.486 0 0 1 29.5 5v15a4.486 4.486 0 0 1-1.318 3.182A4.486 4.486 0 0 1 25 24.5h-6.793L15 27.707 11.793 24.5H5a4.486 4.486 0 0 1-3.182-1.318A4.486 4.486 0 0 1 .5 20V5c0-1.243.504-2.368 1.318-3.182A4.486 4.486 0 0 1 5 .5Z"\n            />\n            <path\n                fill="'.concat(e,'"\n                d="M5 3h20a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2h-7l-3 2.5-3-2.5H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z"\n            />\n            <path d="M7 4h16v16H7z" />\n            <path\n                fill="#FFF"\n                d="M19 12a8.64 8.64 0 0 1-2.539 6.129l-.942-.944A7.31 7.31 0 0 0 17.667 12a7.31 7.31 0 0 0-2.148-5.185l.943-.943A8.64 8.64 0 0 1 19 12Zm-3 0a5.649 5.649 0 0 1-1.66 4.006l-.943-.942A4.32 4.32 0 0 0 14.667 12a4.32 4.32 0 0 0-1.27-3.064l.944-.942A5.649 5.649 0 0 1 16 12Zm-3 0c0 .736-.298 1.403-.781 1.886L10.333 12l1.886-1.886c.483.483.781 1.15.781 1.886Z"\n            />\n        </g>')}},kP=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.type="comment",i.followed=!1,i._expanded=!1,i.color=0,i.resolved=!1,i.tempName="",i.attached="",i.attachedElement=null,i.subscribed=!1,i.curValue=null,i.appendFiles=null,i.appendExt=null,i.pined=!1,i.canvasPos={x:0,y:0},i.panelRenderer=yP,i.elementType=Za.COMMENT,i.unreadCount=0,i.visible=!0,i.relativePos=null,i.editingMsgId=null,i.empty=!0,i.iconType="normal",i.focusing=!1,i.renderer=CP,i._curOp=null,i._oriPos=null,i._xDiff=0,i._yDiff=0,i._attachCandidate=void 0,i.escapeHandler=function(){i.curValue=null,i.upime.collapseComments()},i.onFinishDraft=function(e,t){return void 0===t&&(t=!1),A(i,void 0,void 0,(function(){var n,i,r,o,a,s,l,c=this;return D(this,(function(u){switch(u.label){case 0:return this.editingMsgId=null,e&&this.curValue&&vI(this.curValue)?(this.upime.phoneMode&&!t||(n={type:TI.TEXT,elmId:this.id,content:JSON.stringify(this.curValue),at:this.extractMentionPeople(null!==(l=this.curValue)&&void 0!==l?l:[])},this.upime.commentManager.updateCommentMsg(n)),this.curValue=null,[3,6]):[3,1];case 1:if(!this.appendFiles||this.upime.phoneMode&&!t)return[3,5];i=function(e){var t,n,i;return D(this,(function(o){switch(o.label){case 0:return[4,r.getMediaInfo(e)];case 1:return t=o.sent(),n=Jo(e.name),i={type:t.type,elmId:r.id,pending:{request:function(t,i){return c.upime.saveFile(1,{file:e,ext:n,fakeName:"".concat(c.upime.genFileName(""),".").concat(n)},i,t)},progress:0},append:t.append},r.upime.commentManager.updateCommentMsg(i),[2]}}))},r=this,o=0,a=this.appendFiles,u.label=2;case 2:return o<a.length?(s=a[o],[5,i(s)]):[3,5];case 3:u.sent(),u.label=4;case 4:return o++,[3,2];case 5:this.appendFiles=null,this.appendExt=null,u.label=6;case 6:return[2]}}))}))},i.checkIconType=function(){if(i.resolved)i.iconType="resolved";else{var e=i.upime.commentManager.commentMsgMap[i.id],t=null==e?void 0:e.find((function(e){return e.id&&!e.deleted}));if(t)switch(t.type){case TI.AUDIO:i.iconType="local_record"===t.append.audioType?"audio":"record";break;case TI.FILE:i.iconType="doc";break;case TI.IMAGE:i.iconType="image";break;case TI.TEXT:i.iconType="text";break;case TI.VIDEO:i.iconType="video";break;default:i.iconType="normal"}}i.upime.updateView(),i.updateImgSource()},i.upime=t,i.upime.subscribe("commentMessagesUpdate",(function(e){e===i.id&&i.checkIconType()})),i.checkIconType(),i}var n;return P(t,e),n=t,Object.defineProperty(t.prototype,"expanded",{get:function(){return this._expanded},set:function(e){if(this._expanded=e,this.upime.phoneMode){var t=this.upime.getPhoneDrawer(),n=(null==t?void 0:t.data.element)===this;e?n||this.upime.showPhoneDrawer(gP,{element:this,upime:this.upime},{supportSwipe:!1,coverVisible:!1,markCloseable:!1}):n&&this.upime.closePhoneDrawer()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"curOp",{get:function(){return this._curOp||(this._curOp=this.upime.createOperation()),this._curOp},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirty",{get:function(){return!!this.editingMsgId||!!this.curValue&&vI(this.curValue)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"couldBeEdit",{get:function(){var e=this.upime;return e.meetingMode?"viewer"!==e.meetingMode:e.phoneMode?!!e.userManager.rawEditPerm||e.getElementInfo(this.id).creator.loginName===e.localUserInfo.loginName:e.userManager.commentOnlyMode?e.getElementInfo(this.id).creator.loginName===e.localUserInfo.loginName:e.editable},enumerable:!1,configurable:!0}),t.prototype.checkMounted=function(){if(this.hideByConnectElement())return!1;var t=this.attached?this.upime.elementManager.getElementById(this.attached):null;return t&&this.relativePos?t.mounted:e.prototype.checkMounted.call(this)},t.prototype.bindRefSystem=function(e){this.parentRefSystem=this.upime.elementManager.getRefSystem(e)},t.prototype.dealUpdate=function(t){e.prototype.dealUpdate.call(this,t),void 0!==t.color&&this.updateImgSource(),void 0!==t.attached&&this.updateAttachedElement(t.attached)},t.prototype.updateAttachedElement=function(e){if(!this.attachedElement||this.attachedElement.id!==e){this.attachedElement&&this.upime.elementManager.removeElementAttachedComment(this.attachedElement,this);var t=this.upime.elementManager.getElementById(e);t&&this.upime.elementManager.addElementAttachedComment(t,this),this.attachedElement=t||null}},t.prototype.updateImgSource=function(){var e,t,i=this.iconType+"_"+this.color,r=n.imgSourceMap.get(i);r||(r=tr("data:image/svg+xml,"+encodeURIComponent((e=this.iconType,t=rt[this.color],'<?xml version="1.0" encoding="UTF-8"?>\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 29">\n      '.concat(SP[e](t),"\n    </svg>")))),n.imgSourceMap.set(i,r),er(r)),this.imgSource=r},t.prototype.handleMoveSelf=function(e){e.isStart&&(this._oriPos=this.getGlobalPosition(),this._xDiff=e.startPosition.x-this._oriPos.x,this._yDiff=e.startPosition.y-this._oriPos.y),this._attachCandidate&&(this._attachCandidate.showAttachComment=!1,this._attachCandidate=void 0);var t={x:e.position.x-this._xDiff,y:e.position.y-this._yDiff},n=this.upime.getCommentDestination(t),i=n.position,r=n.attachElement,o=n.refSystem;if(e.isEnd){if("comment"===this.type?this.curOp.update(this,{position:i}):(this.dealUpdate({position:i}),this.upime.updateView()),r){var a=n.relativePos;"comment"===this.type?this.curOp.update(this,{attached:r.id,relativePos:a}):(this.dealUpdate({attached:r.id,relativePos:a}),this.upime.updateView())}"comment"===this.type&&this.curOp.sync(),this._curOp=null}else e.isStart&&("comment"===this.type?this.curOp.update(this,{attached:"",relativePos:null}):(this.dealUpdate({attached:"",relativePos:null}),this.upime.updateView())),"comment"===this.type?this.curOp.update(this,{position:t}):(this.dealUpdate({position:t}),this.upime.updateView()),o?this._attachCandidate=o.baseElement:r&&(this._attachCandidate=r),this._attachCandidate&&(this._attachCandidate.showAttachComment=!0)},t.prototype.getCandidateRelativePos=function(e,t){var n=t.getGlobalBox(),i=n.left,r=n.right,o=n.bottom,a=n.top,s=r-i,l=o-a,c=null;if(n.rotate){var u={x:(i+r)/2,y:(a+o)/2},d=an(e,-t.rotate,u);c={x:Math.max(d.x-i,0)/s,y:Math.max(d.y-a,0)/l}}else c={x:Math.max(e.x-i,0)/s,y:Math.max(e.y-a,0)/l};return c},t.prototype.getGlobalPosition=function(){var e=this.attached?this.upime.elementManager.getElementById(this.attached):null;if(e&&this.relativePos){var t=e.getGlobalBox(),n=t.left,i=t.right,r=t.top,o=t.bottom,a=t.rotate,s=o-r,l={x:n+(i-n)*this.relativePos.x,y:r+s*this.relativePos.y};return a&&(l=an(l,a,{x:(n+i)/2,y:(r+o)/2})),l}return this.globalTransform.apply(this.position)},t.prototype.getScreenPosition=function(){return this.upime.view.getScreenPosition(this.getGlobalPosition())},t.prototype.setPined=function(e){this.pined=e},t.prototype.setResolved=function(e){this.curOp.update(this,{resolved:e}),this.curOp.sync(),this._curOp=null,this.upime.commentManager.resolvedHided&&(this.visible=!1),this.checkIconType(),this.upime.updateView()},t.prototype.setThemeColor=function(e){this.curOp.update(this,{color:e}),this.curOp.sync(),this._curOp=null,this.upime.updateView()},t.prototype.updateExistingMsg=function(e,t){this.upime.commentManager.updateCommentMsg({type:TI.TEXT,elmId:this.id,content:JSON.stringify(t),messageId:e,at:this.extractMentionPeople(t)})},t.prototype.deleteMsg=function(e){var t,n;1===this.upime.commentManager.commentMsgMap[this.id].reduce((function(e,t){return e+Number(!t.deleted)}),0)?(e.type!==TI.TEXT&&e.pending&&(null===(t=e.abort)||void 0===t||t.call(e),this.upime.addToast(O("comment.pending.deleted.hint"))),this.deleteSelf(),this.upime.phoneMode&&this.upime.closePhoneDrawer()):this.upime.commentManager.updateCommentMsg(exports.E({type:e.type,elmId:this.id,messageId:null!==(n=e.id)&&void 0!==n?n:e.key,deleted:!0},e.type!==TI.TEXT&&{pending:e.pending}))},t.prototype.deleteSelf=function(){this.upime.collapseComments(),this.upime.commentManager.commentMsgMap[this.id].forEach((function(e){var t;e.type!==TI.TEXT&&e.pending&&(e.failed=!0,null===(t=e.abort)||void 0===t||t.call(e))})),this.upime.deleteElement(this)},t.prototype.formatContent=function(e){try{var t=JSON.parse(e);if("object"!=typeof t)throw new Error;return t}catch(t){return[{type:"paragraph",children:[{text:e}]}]}},t.prototype.extractMentionPeople=function(e){var t=this,n=e.reduce((function(e,n){return"mention"===n.type?R(R([],e,!0),n.ids,!0):n.children?R(R([],e,!0),t.extractMentionPeople(n.children),!0):e}),[]);return Array.from(new Set(n))},t.prototype.getMediaInfo=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s=this;return D(this,(function(l){switch(t=Jo(e.name),n=new Ks,t){case"jpg":case"png":case"gif":case"svg":case"webp":case"jpeg":(i=new FileReader).onload=function(){var r=new Image;r.onload=function(){n.done({type:TI.IMAGE,append:exports.E({name:e.name,width:r.width,height:r.height,size:e.size,ext:t,localEle:r},s.appendExt)})},r.src=i.result},i.readAsDataURL(e);break;case"wav":case"mp3":(r=new FileReader).onload=function(){var i=new Audio(r.result);i.onloadedmetadata=function(){var r=function(){i.removeEventListener("timeupdate",r),n.done({type:TI.AUDIO,append:exports.E({name:e.name,duration:i.duration,size:e.size,ext:t},s.appendExt)})};i.duration===1/0?(i.currentTime=1e101,i.addEventListener("timeupdate",r)):r()}},r.readAsDataURL(e);break;case"mov":case"mp4":o=URL.createObjectURL(e),(a=document.createElement("video")).onloadedmetadata=function(){n.done({type:TI.VIDEO,append:exports.E({name:e.name,width:a.videoWidth,height:a.videoHeight,size:e.size,ext:t,duration:a.duration,localEle:a},s.appendExt)})},a.src=o;break;default:n.done({type:TI.FILE,append:exports.E({name:e.name,size:e.size,ext:t},this.appendExt)})}return[2,n.result]}))}))},t.prototype.checkVisible=function(e){if(this.hideByConnectElement())return!1;var t=this.visible;if(!_e.desktop&&this.focusing)return!0;if(!t||this.empty)return!1;if(!this.mounted)return!1;var n=this.getGlobalPosition(),i=n.x,r=n.y;return Kt({left:i-26/e.scale,right:i+26/e.scale,top:r-50/e.scale,bottom:r},e)},t.prototype.dealSelfOpenClose=function(){this.upime.followManager.syncCommentStatus(this)},t.prototype._checkUnAvailable=function(){return this.hideByConnectElement()||e.prototype._checkUnAvailable.call(this)},t.prototype.hideByConnectElement=function(){var e=this.attached?this.upime.elementManager.getElementById(this.attached):null;return!!e&&(Bu(e)?e.isMindmapNodeHideByCollapsed:!!Fu(e)&&e.isHideByFilter)},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.upime.closePhoneDrawer()},t.imgSourceMap=new Map,M([rl],t.prototype,"resolved",void 0),M([rl],t.prototype,"curValue",void 0),M([rl],t.prototype,"unreadCount",void 0),M([rl],t.prototype,"editingMsgId",void 0),n=M([il],t)}(ry);function _P(e,t){var n=e.lineType,i=e.lineWidth,r=e.lineStyle,o=e.lineColor,a=e.lineCap,s=e.lineJoin,l=e.drawPath;switch(t.clear(),4!==n&&t.lineStyle({width:i,color:o,cap:a,join:s,lineDash:3===r?[4+2*i,4+2*i]:2===r?[.01,4+2*i]:[]}),n){case 4:var c=l[0],u=l[1],d=180*nn(c,u)/Math.PI,p=fn(c,u);t.lineStyle({width:Mn(it[0],p/50,it[it.length-1]),color:o,cap:a,join:s}),t.beginFill(o),t.moveTo(c.x,c.y);var h=Math.tan(5*Math.PI/180)*p*.75,f=.75*p/Math.tan(75*Math.PI/180),m=an({x:c.x+.75*p,y:c.y-h},-d,c);t.lineTo(m.x,m.y);var v=an({x:c.x+.7*p,y:c.y-f},-d,c);t.lineTo(v.x,v.y),t.lineTo(u.x,u.y);var g=an({x:c.x+.7*p,y:c.y+f},-d,c);t.lineTo(g.x,g.y);var y=an({x:c.x+.75*p,y:c.y+h},-d,c);t.lineTo(y.x,y.y),t.closePath(),t.endFill();break;case 1:case 2:if(l.length>0){t.moveTo(l[0].x,l[0].y);for(var b=1;b<l.length;b++)t.lineTo(l[b].x,l[b].y)}break;case 3:if(l.length>0)for(t.moveTo(l[0].x,l[0].y),b=1;b<l.length;b+=3){var E=l[b-1],x=exports.E({},l[b]),w=exports.E({},l[b+1]);m=l[b+2],Math.abs(E.x-m.x)<.01?x.x>w.x?(x.x+=.01,w.x-=.01):(x.x-=.01,w.x+=.01):Math.abs(E.y-m.y)<.01&&(x.y>w.y?(x.y+=.01,w.y-=.01):(x.y-=.01,w.y+=.01)),t.bezierCurveTo(x.x,x.y,w.x,w.y,m.x,m.y)}}}function TP(e,t,n){var i=t.path,r=t.filled,o=t.lineWidth;if(e.clear(),r?e.beginFill(n):e.lineStyle({width:o,color:n}),i.length>0){var a=i[0];e.moveTo(a.p0.x,a.p0.y)}for(var s=0;s<i.length;s++)switch((a=i[s]).type){case"move":e.moveTo(a.p0.x,a.p0.y);break;case"line":e.lineTo(a.p1.x,a.p1.y);break;case"arc":e.arcTo(a.p1.x,a.p1.y,a.p2.x,a.p2.y,a.radius),e.moveTo(a.p2.x,a.p2.y);break;case"circle":e.drawCircle(a.p0.x,a.p0.y,a.radius)}e.closePath(),e.endFill()}var IP=function(e){var t=e.startPoint,n=e.lineColor,i=e.lineStyle,r=e.lineType;e.lineCap,e.lineJoin;var o=e.displayLineWidth,a=t.x,s=t.y,l=e.drawPath,c=e.useCallback("drawLine",(function(t){_P(e,t)}),[l,o,n,i,r]),u=TP;vf(e),e.textNodes.size>0&&function(){fa({});var t=Rt(e.getBorderBox()),n=t.x,i=t.y,r=t.width,o=t.height,l=2*e.lineWidth,c=[];Array.from(e.textNodes.values()).forEach((function(e){var t=e.getClipPath();if(t&&0!==t.length){var u=[["M",n-l,i-l],["L",n+r+l,i-l],["L",n+r+l,i+o+l],["L",n-l,i+o+l],["L",n-l,i-l]];t.forEach((function(e,t){0===t?u.push(["M",a+e.x,s+e.y]):u.push(["L",a+e.x,s+e.y])})),c.push(new Sa(u,"evenodd"))}})),za(c)}(),Na(c,{x:a,y:s}),e.textNodes.size>0&&ma(),null!==e.startArrowDrawPath&&Na(e.useCallback("drawStartArrow",(function(t){u(t,e.startArrowDrawPath,n)}),[e.startArrowDrawPath,n]),{x:a,y:s}),null!==e.endArrowDrawPath&&Na(e.useCallback("drawEndArrow",(function(t){u(t,e.endArrowDrawPath,n)}),[e.endArrowDrawPath,n]),{x:a,y:s}),e.textNodes.forEach((function(e){e.render()})),ma()},PP=function(e){var t=e.element,n=e.viewbox,i=t.globalEndpoint,r=t.globalControlPoints,o=i.start,a=i.end,s=n.left,l=n.top,c=n.scale;Na((function(e){e.clear(),e.lineStyle({width:2,color:11119017}),e.beginFill(16316666,1),e.drawCircle((o.x-s)*c,(o.y-l)*c,4),e.drawCircle((a.x-s)*c,(a.y-l)*c,4),r.forEach((function(t,n){0===n&&fn(o,t)<=15/c||n===r.length-1&&fn(a,t)<=15/c||(t.isNew?(e.lineStyle({width:1,color:16777215,alpha:.8}),e.beginFill(6134012,.8),e.drawCircle((t.x-s)*c,(t.y-l)*c,4.5)):(e.lineStyle({width:2,color:11119017}),e.beginFill(16316666,1),e.drawCircle((t.x-s)*c,(t.y-l)*c,4)))}))}))},NP="selected_V9jmu",MP="rotate_2yFV3",AP="tick_slider_61KjG",DP="phoneLinePropColorFcContainer_31qhI",RP="linePropTypeContainer_t_pUc",BP="label_BmBhp",LP="arrow-type-editor_18Czx",OP="sub-win_jOLIb",FP="arrow-item_y28Nc",zP="line-type-editor_2atg4",HP="type-select_-7JyO",UP="color-editor_C1xO6",WP="split-line_1-r4y";function VP(t){var n=t.element,i=t.endpointArrowType,r=t.onChanged,o=t.hint,a=e.useMemo((function(){return new Map([[0,"jiantou-1"],[2,"jiantou-3"],[1,"jiantou-2"],[4,"jiantou-5"],[3,"jiantou-4"]])}),[]),s=yh(!0),l=s.hide,c=s.toggleHide,u=s.setHide,d=s.skipRef,p=n.getKeyValue(i),h=a.get(p),f="startArrow"===i,m=e.useCallback((function(e){u(!0),p!==e&&r(e)}),[p]);return e.createElement("div",{className:j(Ml.cm_item,LP),ref:d},e.createElement(Dl,{content:o,placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:j(Ml.propEditorIconBox,f?MP:""),onClick:c},e.createElement(hl,{icon:h})))),!l&&e.createElement(xh,{align:f?"left":"right",className:OP},Array.from(a.entries()).map((function(t){var n=t[0],i=t[1];return e.createElement("div",{key:n,className:j(Ml.cm_item,FP,f?MP:""),onClick:m.bind(null,n)},e.createElement(hl,{icon:i,className:n===p?NP:""}))}))))}function jP(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useCallback((function(e){n.changeKeyValue("startArrow",e)}),[]),o=e.useCallback((function(){n.switchArrow()}),[]),a=e.useCallback((function(e){n.changeKeyValue("endArrow",e)}),[]);return e.createElement(e.Fragment,null,e.createElement(VP,{element:n,endpointArrowType:"startArrow",onChanged:r,hint:i("connectLine.startPoint")}),e.createElement("div",{className:j(Ml.cm_item,"switch-arrow_2VgUH",n.multipleEles&&"disabled_piJAe"),onClick:o},e.createElement("div",{className:j(Ml.icon_box)},e.createElement(hl,{icon:"qiehuan",className:"switch-icon_3SAIl"}))),e.createElement(VP,{element:n,endpointArrowType:"endArrow",onChanged:a,hint:i("connectLine.endPoint")}))}function GP(t){var n=t.element,i=e.useContext(Ic),r=i.phoneLayout,o=i.phoneElementSubBarContainer,a={};r&&(a.checkSkip=function(e){return!!o.current&&V(o.current,e)});var s=yh(!0,a),l=s.hide,c=s.toggleHide,u=s.skipRef,d=W().getUpimeTrans,p=(it.findIndex((function(e){return e===n.getKeyValue("lineWidth")}))+1)/10,h=e.useCallback((function(e){n.getKeyValue("lineWidth")!==it[10*e-1]&&n.changeKeyValue("lineWidth",it[10*e-1])}),[n.getKeyValue("lineWidth")]),f=e.useMemo((function(){return new Map([[1,{icon:"zhixian"}],[2,{icon:"zhexian"}],[3,{icon:"quxian"}]])}),[]),m=f.get(n.getKeyValue("lineType")).icon,v=function(e){n.changeKeyValue("lineType",e)},g=e.useMemo((function(){return new Map([[1,{icon:"shixian"}],[3,{icon:"xuxian"}],[2,{icon:"dianzhuang"}]])}),[]),y=function(e){n.changeKeyValue("lineStyle",e)},b=r?Xg:xh;return e.createElement("div",{className:j(Ml.cm_item,zP),ref:u},e.createElement(Dl,{placement:"top",content:d("connectLine.lineType")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:c},e.createElement(hl,{icon:m})))),!l&&e.createElement(b,{align:"center",className:OP},r?e.createElement("div",{className:DP},e.createElement("div",{className:RP},e.createElement($b,{className:HP,value:n.getKeyValue("lineType"),data:f,onChanged:v}),e.createElement("div",{className:WP}),e.createElement($b,{className:HP,value:n.getKeyValue("lineStyle"),data:g,onChanged:y})),e.createElement(bc,{className:AP,onChanged:h,defaultValue:p}),e.createElement("label",{className:j(BP)},d("element.borderWidth"))):e.createElement(e.Fragment,null,e.createElement(bc,{className:AP,onChanged:h,defaultValue:p}),e.createElement($b,{className:HP,value:n.getKeyValue("lineType"),data:f,onChanged:v}),e.createElement($b,{className:HP,value:n.getKeyValue("lineStyle"),data:g,onChanged:y}))))}function qP(t){var n=t.element,i=e.useContext(Ic),r=i.phoneLayout,o=i.phoneElementSubBarContainer,a=W().getUpimeTrans,s=function(t,n,i,r){var o=t(),a=!0;return[o,e.useCallback((function(e){null===e||n(e)}),[a]),a]}((function(){return n.getKeyValue("lineColor")}),(function(e){return n.changeKeyValue("lineColor",e)})),l=s[0],c=s[1],u={};r&&(u.checkSkip=function(e){return!!o.current&&V(o.current,e)});var d=yh(!0,u),p=d.hide,h=d.setHide,f=d.toggleHide,m=d.skipRef,v=r?Xg:xh;return e.createElement("div",{className:j(Ml.cm_item,UP),ref:m},e.createElement(Dl,{placement:"top",content:a("element.color")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:f},e.createElement(Vb,{color:l,opacity:1})))),!p&&e.createElement(v,{align:"center",selfAdjust:!0},e.createElement(Yb,{colorPalettes:n.getColorPalettes(),defaultValue:l,onChanged:function(e){c(e),h(!0)},colorPickerConfig:{onColorPickerChange:function(e,t){n.editor.slideUpdateProperty({lineColor:e},t,!0)}}})))}function KP(t){var n=t.propEditor;return e.createElement(e.Fragment,null,4!==n.editor.element.lineType&&e.createElement(GP,{element:n}),e.createElement(qP,{element:n}))}var YP=function(){function e(e){this.editor=e,this.propertyName="arrowType",this.renderer=jP,this.couldAffectGroup=!0,this.renderKey=this.propertyName}return Object.defineProperty(e.prototype,"multipleEles",{get:function(){return this.editor.getElements().length>1},enumerable:!1,configurable:!0}),e.prototype.switchArrow=function(){var e=this.editor.getPropertyValue("startArrow"),t=this.editor.getPropertyValue("endArrow");e!==t&&(this.editor.updateProperty({startArrow:t,endArrow:e}),this.editor.updateConnectionLineConfig())},e.prototype.getKeyValue=function(e){return this.editor.getPropertyValue(e)},e.prototype.changeKeyValue=function(e,t){var n;this.editor.updateProperty(((n={})[e]=t,n)),this.editor.updateConnectionLineConfig()},e}(),XP=function(){function e(e){this.editor=e,this.couldAffectGroup=!0,this.propertyName="connectionLineStyle",this.renderer=KP,this.renderKey=this.propertyName}return e.prototype.getColorPalettes=function(){return this.editor.upime.userManager.userPalette},e.prototype.getKeyValue=function(e){return this.editor.getPropertyValue(e)},e.prototype.changeKeyValue=function(e,t){var n,i=((n={})[e]=t,n);this.editor.updateProperty(i),this.editor.updateConnectionLineConfig()},e}(),QP="fontSizeSelect_mZrQe",ZP="rightOption_MD7Qa",JP="btn_mBY8_",$P="up_hkKvj",eN="down_3R-Xb",tN="icon_2ql7n",nN="fontInputContainer_2wcNK",iN="dropdown_hGFBv",rN="fontSizeViewPhoneContainer_2TUmu",oN="fontSizeViewPhoneContainerText_ic4i9",aN="disabled_1XQzF";function sN(t){var n=t.propEditor,i=e.useContext(Ic).phoneLayout,r=W().getUpimeTrans,o=n.getValue(),a=yh(!0),s=a.hide,l=a.setHide,c=a.skipRef,u=e.useRef(null),d=r("text.fontSize.auto"),p=e.useRef({isAuto:"auto"===o,autoText:d}),h=e.useContext(Zg),f=h.disableAutoHide,m=h.enableAutoHide;e.useEffect((function(){var e=u.current;e&&(e.value="auto"===o?d:o+"",p.current.isAuto="auto"===o,p.current.autoText=d)}),[o,d]),e.useEffect((function(){var e=u.current;if(e){var t=void 0,i=function(i){var r=e.value.trim();if(clearTimeout(t),""!==r){var o=1*r;!isNaN(o)&&o>=n.minSize&&o<=n.maxSize&&(p.current.isAuto=!1,t=window.setTimeout((function(){n.changeValue(o)}),500))}},r=function(){clearTimeout(t);var i=1*e.value.trim();if(!isNaN(i)&&i>=n.minSize&&i<=n.maxSize)i!==n.getValue()&&n.changeValue(i),p.current.isAuto=!1;else{var r=n.getValue();e.value="auto"===r?p.current.autoText:r+"",p.current.isAuto="auto"===r}},o=function(){l(!1)};return e.addEventListener("input",i),e.addEventListener("focus",o),e.addEventListener("blur",r),function(){clearTimeout(t),e.removeEventListener("input",i),e.removeEventListener("focus",o),e.removeEventListener("blur",r)}}}),[]);var v=function(){!s&&l(!0);var e=n.sizeList[0],t=u.current,i=t.value;if(!p.current.isAuto){var r=1*i;if(!isNaN(r)&&r>0&&r<=n.maxSize){var o=n.sizeList.findIndex((function(e){return e>r}));if((e=o>=0?n.sizeList[o]:r+1)>Math.min(n.maxSize,n.sizeList[n.sizeList.length-1])){if(!n.supportAuto)return;return t.value=d,p.current.isAuto=!0,void n.changeValue("auto")}}t.value=e+"",n.changeValue(e)}},g=function(){!s&&l(!0);var e=n.sizeList[0],t=u.current,i=t.value,r=p.current.isAuto?n.maxSize+1:1*i;if(!isNaN(r)&&r>0){var o=n.sizeList[n.sizeList.length-1];if(r>o)e=o;else{var a=n.sizeList.findIndex((function(e){return e>=r}))-1;a>=0&&(e=n.sizeList[a])}}t.value=e+"",n.changeValue(e)},y=n.maxSize,b=n.sizeList,E=n.supportAuto,x=e.useMemo((function(){var e=b.map((function(e){return{name:e,value:e}}));return E?R([{name:d,value:"auto"}],e,!0):e}),[d]);return i?e.createElement(e.Fragment,null,e.createElement(lN,{add:v,minus:g,autoText:p.current.autoText,fontSize:n.getValue(),element:n}),e.createElement("input",{style:{display:"none"},ref:u,type:"text",defaultValue:o,maxLength:3})):e.createElement("div",{className:j(lc,QP),ref:c},e.createElement(Dl,{content:r("text.fontSize"),placement:"top"},e.createElement("div",{className:nN},e.createElement("input",{className:sc,ref:u,type:"text",defaultValue:o,maxLength:3,onFocus:function(){f()},onBlur:function(){m()}}),e.createElement("div",{className:j(cc,ZP),onPointerDown:ie},e.createElement(ul,{className:j(JP,$P),onClick:v},e.createElement(hl,{icon:"up",className:tN})),e.createElement(ul,{className:j(JP,eN),onClick:g},e.createElement(hl,{icon:"down",className:tN}))))),s?null:e.createElement(xh,{align:"left",selfAdjust:!0,className:iN},e.createElement("div",{className:uc,onClickCapture:function(e){var t=e.target.dataset.size;if(t){if(u.current.value=t,"auto"===t)n.supportAuto&&n.changeValue(t),p.current.isAuto=!0;else{var i=parseInt(t);if(i<n.minSize||i>n.maxSize)return;n.changeValue(i),p.current.isAuto=!1}l(!0)}}},x.map((function(t){return e.createElement("div",{key:t.value+"",className:j(dc,"auto"!==t.value&&t.value>y?Xl:""),"data-size":t.value},t.name)})))))}function lN(t){var n=t.fontSize,i=t.autoText,r=t.add,o=t.minus,a=t.element,s=Math.min(a.maxSize,a.sizeList[a.sizeList.length-1]),l="auto"!==n&&(n<s||a.supportAuto),c=a.sizeList[0],u="auto"===n||n>c,d="auto"===n?i:n.toFixed(0);return e.createElement("div",{className:rN,onPointerDown:ie},e.createElement(hl,{icon:"subtract",className:j(tN,!u&&aN),onClick:o}),e.createElement("div",{className:oN},d),e.createElement(hl,{icon:"plus",className:j(tN,!l&&aN),onClick:r}))}function cN(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.getHasTextLine(),o=1===n.editor.element.upime.getSelectedElements().length;return e.createElement(e.Fragment,null,o&&e.createElement(Dl,{content:i("line.text.add"),placement:"top"},e.createElement("div",{className:Ml.cm_item,onClick:function(){n.editor.addText(),_c("cv_line_title",{type:"按钮"})}},e.createElement("div",{className:j(Ml.propEditorIconBox)},e.createElement(hl,{icon:"lianjiexiantianjiawenben"})))),r&&e.createElement(e.Fragment,null,e.createElement(Dl,{content:i("line.text.place"),placement:"top"},e.createElement("div",{className:j(Ml.cm_item),onClick:function(){!function(){if(r){var e=1===r.textDirection?2:1;n.changeKeyValue("textDirection",e)}}()}},e.createElement("div",{className:j(Ml.propEditorIconBox)},1===n.editor.element.textDirection?e.createElement(hl,{icon:"lianjiexianshuipingwenben"}):e.createElement(hl,{icon:"lianjiexiansuixianwenben"})))),e.createElement(sN,{propEditor:n}),e.createElement(hE,{propEditor:n})))}var uN=function(){function e(e){this.editor=e,this.couldAffectGroup=!0,this.propertyName="LineTextEditor",this.renderer=cN,this.sizeList=Ve,this.maxSize=999,this.minSize=10,this.curLock=null,this.renderKey=this.propertyName}return Object.defineProperty(e.prototype,"available",{get:function(){return"single"===this.editor.element.selectStatus||this.editor.getElements().some((function(e){return Ru(e)&&e.texts.length>0}))},enumerable:!1,configurable:!0}),e.prototype.getHasTextLine=function(){return this.editor.getElements().find((function(e){return Ru(e)&&e.texts.length>0}))},e.prototype.getColorPalettes=function(){return this.editor.upime.userManager.userPalette},e.prototype.getKeyValue=function(e){return this.editor.getPropertyValue(e)},e.prototype.changeKeyValue=function(e,t){var n,i=((n={})[e]=t,n);this.editor.updateProperty(i),this.editor.updateConnectionLineConfig()},e.prototype.getValue=function(){var e,t=null===(e=this.getHasTextLine())||void 0===e?void 0:e.texts[0];return(null==t?void 0:t.fontSize)||14},e.prototype.changeValue=function(e){var t=this;this.editor.lockUpdateToolbarPos();var n=this.editor.getElements(),i=this.editor.upime.createLock(n.map((function(e){return e.id}))),r="single"===this.editor.element.selectStatus?void 0:this.editor.upime.createOperation();n.forEach((function(n){var i,o=n.currentEditor,a=null==o?void 0:o.propertyEditors.find((function(e){return e.propertyName===t.propertyName}));null===(i=a)||void 0===i||i.changeSelfValue(e,r)})),r&&r.sync(),this.editor.upime.clearLock(i),this.editor.updateBorderBox(),this.editor.unlockUpdateToolbarPos(),this.editor.upime.lastLineTextFontSize=e},e.prototype.changeSelfValue=function(e,t){var n=t||this.editor.getOp(),i=this.editor.element.texts.map((function(t){return exports.E(exports.E({},t),{fontSize:e})}));n.update(this.editor.element,{texts:i}),t||n.sync()},e.prototype.getColor=function(){var e,t,n,i=null===(e=this.getHasTextLine())||void 0===e?void 0:e.texts[0];return(null===(n=null===(t=null==i?void 0:i.content[0])||void 0===t?void 0:t[1])||void 0===n?void 0:n.color)||1710618},e.prototype.changeColor=function(e){var t=this;this.editor.lockUpdateToolbarPos();var n=this.editor.getElements(),i=this.editor.upime.createLock(n.map((function(e){return e.id}))),r="single"===this.editor.element.selectStatus?void 0:this.editor.upime.createOperation();n.forEach((function(n){var i,o=n.currentEditor,a=null==o?void 0:o.propertyEditors.find((function(e){return e.propertyName===t.propertyName}));null===(i=a)||void 0===i||i.changeSelfColor(e,r)})),r&&r.sync(),this.editor.upime.clearLock(i),this.editor.updateBorderBox(),this.editor.unlockUpdateToolbarPos(),this.editor.lastColor=e},e.prototype.changeSelfColor=function(e,t){var n;null===(n=this.editor.element.getCurrentEditingTextNode())||void 0===n||n.stopEdit();var i=t||this.editor.getOp(),r=dN(this.editor.element,e);i.update(this.editor.element,{texts:r}),t||i.sync()},e.prototype.slideChangeColor=function(e,t){this.slideSetRichStyle(e,t),this.editor.lastColor=e},e.prototype.slideSetRichStyle=function(e,t){var n=this.editor.upime,i=this.editor.getElements().filter((function(e){return e.elementType===Za.CONNECTIONLINE}));if(t.isStart){var r=i.map((function(e){return e.id}));this.curLock=n.createLock(r)}if(i.forEach((function(t){var n=dN(t,e);t.dealUpdate({texts:n})})),n.updateView(),t.isEnd){var o=n.createOperation();i.forEach((function(t){o.update(t,{texts:dN(t,e)})})),o.sync(),this.curLock&&n.clearLock(this.curLock),this.curLock=null}},e}();function dN(e,t){return e.texts.map((function(e){var n=e.content.map((function(e){return[e[0],exports.E(exports.E({},e[1]),{color:t})]}));return exports.E(exports.E({},e),{content:n})}))}function pN(e){for(;;){var t=Math.random().toString(36).substring(2,9);if(!e.includes(t))return t}}var hN=function(e){function t(t,n,i){var r,o=e.call(this,t,n,i)||this;return o.element=n,o.renderer=PP,o.editable&&!o.isHandMode&&((r=o.propertyEditors).push.apply(r,R([new XP(o)],4!==o.element.lineType?[new YP(o)]:[],!0)),4!==o.element.lineType&&o.propertyEditors.push(new uN(o))),o.originEndpoint=o.getEndpoint(),o.multiResizeDirection.push("n","s","e","w"),o}return P(t,e),Object.defineProperty(t.prototype,"couldAddComment",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalControlPoints",{get:function(){var e=this.element.globalTransform;return this.element.controlPoints.map((function(t){return exports.E(exports.E({},t),e.apply(t))}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalEndpoint",{get:function(){var e=this.getEndpoint(),t=e.start,n=e.end,i=this.element.globalTransform;return{start:t=i.apply(t),end:n=i.apply(n)}},enumerable:!1,configurable:!0}),t.prototype.getEndpoint=function(){return{start:this.element.startPoint,end:this.element.endPoint}},t.prototype.updateConnectionLineConfig=function(){var e={startArrow:this.element.startArrow,endArrow:this.element.endArrow,lineWidth:this.element.lineWidth,lineType:this.element.lineType,lineStyle:this.element.lineStyle,lineColor:this.element.lineColor,textDirection:this.element.textDirection};this.upime.updateConnectionLineConfig(e)},t.prototype.bindCursor=function(){},t.prototype.handleEndPointMove=function(e,t){var n,i;this.dealOpStart(e);var r=this.element,o=this.upime;e.isStart&&(this.originGlobalEndpoint=this.globalEndpoint);var a=this.originGlobalEndpoint,s=e.position,l=e.startPosition,c=r.globalTransform,u=s.x-l.x,d=s.y-l.y,p={};function h(e,n,i){"start"===t?(p.startElementId=e,p.startPosition=n,p.startType=i):(p.endElementId=e,p.endPosition=n,p.endType=i)}var f="start"===t?a.start:a.end,m="start"===t?r.endElement:r.startElement,v={x:f.x+u,y:f.y+d},g=c.applyInverse(v),y=fx(v,o,m),b=this.lastRelationElement;if(y?(b&&b.id!==y.element.id&&b.clearAdsorptionData(),this.lastRelationElement=y.element,(null===(n=y.metaData)||void 0===n?void 0:n.adsorptionData)&&y.element.updateAdsorptionData(y.metaData.adsorptionData)):(b&&b.clearAdsorptionData(),this.lastRelationElement=void 0),null===(i=null==y?void 0:y.metaData)||void 0===i?void 0:i.attachedProps){var E=y.metaData.attachedProps,x=E.attachedElementId,w=E.attachedPointType;h(x,E.percentOffset,w),this.alignGuides&&(o.view.removeAssistWidget(this.alignGuides),this.alignGuides=void 0)}else{var C=r.breakPointData.points,S=void 0;if(this.shiftKeyDown){var k;k="start"===t?C.length?C[0]:this.element.endPoint:C.length?C[C.length-1]:this.element.startPoint;var _=_n(g,c.applyInverse(f),k),T=_.finalRotatePosition,I=_.rotateAngle;g=T,S=-I;var P=c.apply(k);void 0===this.alignGuides?(this.alignGuides=new th(P.x,P.y,I),o.view.addAssistWidget(this.alignGuides)):this.alignGuides.data={x:P.x,y:P.y,angle:I}}else this.alignGuides&&(o.view.removeAssistWidget(this.alignGuides),this.alignGuides=void 0);var N;if(N=2===r.lineType?"start"===t?R(R([],C.filter((function(e,t){return t%2==1})),!0),[this.element.endPoint],!1):R([this.element.startPoint],C.filter((function(e,t){return(C.length-1-t)%2==1})),!0):"start"===t?R(R([],C,!0),[this.element.endPoint],!1):R([this.element.startPoint],C,!0),g=this.getPositionAfterAlign(g,N,{direction:yn((null!=S?S:0)%Math.PI,0)?"horiz":"vertical",moveAngle:S}),2===this.element.lineType||1===this.element.lineType){var M="start"===t?this.element.endPoint:this.element.startPoint;g=this.adjustPointToAxis(g,M)}h(null,g,0)}if(this.updateSelf(p),r.startElement&&r.endElement){var A=r.startElement.parentRefSystem;if(A!==r.parentRefSystem){var D=r.calcTransformedUpdate(A);D.zIndex=A.maxChildZindex+1,r.frame&&(D.frameId=null),this.updateSelf(D)}}!e.isEnd||this.element.startElement&&this.element.endElement||this.checkParentAndUpdate(),e.isEnd&&(null==y?void 0:y.element)&&y.element.clearAdsorptionData(),e.isEnd&&this.alignGuides&&(o.view.removeAssistWidget(this.alignGuides),this.alignGuides=void 0),this.updateBorderBox(),this.dealOpEnd(e)},t.prototype.getPositionAfterAlign=function(e,t,n){for(var i=n.direction,r=n.moveAngle,o=void 0,a=5/this.element.globalTransform.currentScale/this.upime.view.scale,s=0,l=t;s<l.length;s++){var c=l[s],u="vertical"===i?Math.abs(e.y-c.y):Math.abs(e.x-c.x);if(u<=a){if(void 0!==r){var d=r/Math.PI*180;if("vertical"===i){if(0===d||360===d)continue;var p=(h=c.y-e.y)/Math.sin(r)*Math.cos(r);o={x:e.x+p,y:c.y}}else{if(90===d||270===d)continue;var h=(p=c.x-e.x)/Math.cos(r)*Math.sin(r);o={x:c.x,y:e.y+h}}}else o="vertical"===i?{x:e.x,y:c.y}:{x:c.x,y:e.y};a=u}}return o||e},t.prototype.handleControlPointMove=function(e,t){this.dealOpStart(e);var n=this.upime,i=this.element,r=i.lineType,o=i.startPoint,a=i.endPoint,s=i.globalTransform,l=e.position;l=s.applyInverse(l);var c=t.controlPoint,u=t.currentIndex,d=t.originPoints,p=t.noBreakPoints,h=t.originControlPoints;if(1===r||3===r){var f=void 0;if(this.shiftKeyDown){var m=c,v=_n(l,c,m),g=v.finalRotatePosition,y=v.rotateAngle;l=g,f=-y;var b=s.apply(m);void 0===this.alignGuides?(this.alignGuides=new th(b.x,b.y,y),n.view.addAssistWidget(this.alignGuides)):this.alignGuides.data={x:b.x,y:b.y,angle:y}}else this.alignGuides&&(n.view.removeAssistWidget(this.alignGuides),this.alignGuides=void 0);var E=R(R([o],h.filter((function(e){return e!==c})),!0),[a],!1);l=this.getPositionAfterAlign(l,E,{direction:"vertical",moveAngle:f});var x={x:(l=this.getPositionAfterAlign(l,E,{direction:"horiz",moveAngle:f})).x,y:l.y};if(c.isNew)if(p)this.updateSelf({breakPointData:{points:[x]}});else{var w=R([],d,!0),C=Math.floor(u/2);w.splice(C,0,x),this.updateSelf({breakPointData:{points:w}})}else(w=R([],d,!0))[C=Math.floor(u/2)]=x,this.updateSelf({breakPointData:{points:w}})}else if(2===r){var S=c.direction||"vertical";if(E=R(R([o],h.filter((function(e){return e.direction==S})),!0),[a],!1),l=this.getPositionAfterAlign(l,E,{direction:S}),p)w=void 0,"vertical"===S?w=yn(l.y,o.y)&&yn(l.y,a.y)?[]:[{x:o.x,y:l.y},{x:a.x,y:l.y}]:(yn(l.x,o.x)&&yn(l.x,a.x)&&(w=[]),w=[{x:l.x,y:o.y},{x:l.x,y:a.y}]),w.length?this.updateSelf({breakPointData:{points:w,startDirection:S}}):this.updateSelf({breakPointData:{points:w}});else if(w=R([],d,!0),0===u){x=void 0;var k=w[0];"vertical"===S?(x={x:o.x,y:l.y},k={x:k.x,y:l.y}):(x={x:l.x,y:o.y},k={x:l.x,y:k.y}),(P=w[1])&&yn(0,fn(k,P))?w.splice(0,2,x):w.splice(0,1,x,k),this.updateSelf({breakPointData:{points:w,startDirection:S}})}else if(u===d.length){x=void 0;var _=w[d.length-1];"vertical"===S?(x={x:a.x,y:l.y},_={x:_.x,y:l.y}):(x={x:l.x,y:a.y},_={x:l.x,y:_.y}),(I=w[d.length-2])&&yn(0,fn(_,I))?w.splice(u-2,2,x):w.splice(u-1,1,_,x),this.updateSelf({breakPointData:{points:w,startDirection:this.element.squareLineDirection}})}else{_=w[u-1],k=w[u],"vertical"===S?(_={x:_.x,y:l.y},k={x:k.x,y:l.y}):(_={x:l.x,y:_.y},k={x:l.x,y:k.y});var T=!1,I=w[u-2]||o,P=w[u+1]||a,N=yn(0,fn(_,I)),M=yn(0,fn(k,P));N&&M?I===o&&P===a?T=!0:I===o?void 0===w[u+2]?w.splice(u-1,3,I,a):w.splice(u-1,3,I):P===a?void 0===w[u-2]?w.splice(u-2,3,o,k):w.splice(u-2,3,k):w.splice(u-2,4):N?I===o?T=!0:w.splice(u-2,3,k):M?P===a?T=!0:w.splice(u-1,3,_):T=!0,T&&w.splice(u-1,2,_,k),this.updateSelf({breakPointData:{points:w,startDirection:this.element.squareLineDirection}})}}e.isEnd&&this.alignGuides&&(n.view.removeAssistWidget(this.alignGuides),this.alignGuides=void 0),!e.isEnd||this.element.startElement&&this.element.endElement&&!this.element.frameId||this.checkParentAndUpdate(),this.updateBorderBox(),this.dealOpEnd(e)},t.prototype.handleSelectCtrlEvt=function(t){var n,i;(null===(n=this.opData)||void 0===n?void 0:n.lineEndpointType)?this.handleEndPointMove(t,this.opData.lineEndpointType):(null===(i=this.opData)||void 0===i?void 0:i.lineControl)?this.handleControlPointMove(t,this.opData.lineControl):e.prototype.handleSelectCtrlEvt.call(this,t)},t.prototype.moveElement=function(e){var t=this.element,n=t.startElementId,i=t.startPoint,r=t.endElementId,o=t.endPoint,a=t.breakPointData;if(!n&&!r){var s={x:e.deltaX,y:e.deltaY},l=this.element.globalTransform.applyVectorInverse(s),c=l.x,u=l.y,d={startPosition:{x:i.x+c,y:i.y+u},endPosition:{x:o.x+c,y:o.y+u}};a.points.length&&(d.breakPointData={points:a.points.map((function(e){return{x:e.x+c,y:e.y+u}})),startDirection:a.startDirection}),this.updateSelf(d)}},t.prototype.checkSelectRelation=function(e,t){var n=this.element;e=n.globalTransform.applyInverse(e);var i=n.checkSelectRelation(e,t);return i?(this.originEndpoint=this.getEndpoint(),i):null},t.prototype.dealBorderResize=function(e,t){var n=this.element;if(!n.startElementId||!n.endElementId||0!==n.breakPointData.points.length){e.isStart&&(this.originEndpoint=this.getEndpoint(),this.originBreakPointData=this.element.breakPointData,this.selfOriginBorder=this.element.getBorderBox());var i=this.originEndpoint,r=this.originBreakPointData,o=this.selfOriginBorder,a=o.right-o.left==0?1:(t.right-t.left)/(o.right-o.left),s=o.bottom-o.top==0?1:(t.bottom-t.top)/(o.bottom-o.top),l=function(e){return{x:(e.x-o.left)*a+t.left,y:(e.y-o.top)*s+t.top}};if(!n.startElementId){var c=l(i.start);this.updateSelf({startPosition:c})}if(!n.endElementId){var u=l(i.end);this.updateSelf({endPosition:u})}if(null==r?void 0:r.points.length){var d=r.points.map((function(e){return l(e)}));this.updateSelf({breakPointData:exports.E(exports.E({},r),{points:d})})}}},Object.defineProperty(t.prototype,"dbclickAddTextPdding",{get:function(){return _e.desktop?6:18},enumerable:!1,configurable:!0}),t.prototype.dealClick=function(t,n){var i,r,o;if((null==n?void 0:n.lineControl)&&2===t.Hits)this.deleteControlPoint(n.lineControl);else{if(null===(i=null==n?void 0:n.clickData)||void 0===i?void 0:i.lineText){var a=(null===(r=null==n?void 0:n.clickData)||void 0===r?void 0:r.lineText).id,s=this.getCurrentTextNode();(null==s?void 0:s.id)!==a&&(null==s||s.stopEdit());var l=this.element.textNodes.get(a);return l?void l.dealClickText(t):void(this.element.selectedTextId=void 0)}if(2===t.Hits&&this.element.supportDBClickAddText){var c=this.element.getNestestPointOffset(t.position),u=c.distance,d=c.offset;if(u<this.dbclickAddTextPdding)return null===(o=this.getCurrentTextNode())||void 0===o||o.stopEdit(),this.addText(d),void _c("cv_line_title",{type:"双击"})}e.prototype.dealClick.call(this,t)}},t.prototype.dealSelectCtrlEvt=function(t){if(t.isStart){var n={x:t.startPosition.x-this.element.startPoint.x,y:t.startPosition.y-this.element.startPoint.y},i=Array.from(this.element.textNodes.values()).find((function(e){return e.checkPointInText(n)}));i&&(this.movingTextNode=i)}var r=this.movingTextNode;if(t.isEnd&&(this.movingTextNode=void 0),!r||!r.dealMoveText(t))return e.prototype.dealSelectCtrlEvt.call(this,t)},t.prototype.deleteControlPoint=function(e){var t=e.controlPoint;if(!t.isNew){var n=this.element,i=n.startPoint,r=n.endPoint,o=e.originPoints,a=e.currentIndex,s=e.originLineDirection;if(2===n.lineType){var l=o[a-1],c=o[a],u=o[a-2]||i,d=o[a+1]||r,p=R([],o,!0),h=s;if(u===i&&d===r)return void this.updateProperty({breakPointData:{points:[]}});if("vertical"===t.direction&&yn(u.y,d.y)||"vertical"!==t.direction&&yn(u.x,d.x)){var f=a-2,m=4;u===i&&(f++,m--,h="vertical"===h?"horiz":"vertical"),d===r&&m--,p.splice(f,m)}else if(u===i){var v="vertical"===t.direction?{x:c.x,y:i.y}:{x:i.x,y:c.y};p.splice(a-1,2,v),h="vertical"===h?"horiz":"vertical"}else if(d===r){var g="vertical"===t.direction?{x:l.x,y:r.y}:{x:r.x,y:l.y};p.splice(a-1,2,g)}else if(fn(u,l)<fn(d,c)){var y="vertical"===t.direction?{x:d.x,y:u.y}:{x:u.x,y:d.y};o[a-3]&&bn(o[a-3],y)?p.splice(a-3,4):p.splice(a-2,3,y)}else y="vertical"===t.direction?{x:u.x,y:d.y}:{x:d.x,y:u.y},o[a+2]&&bn(o[a+2],y)?p.splice(a-1,4):p.splice(a-1,3,y);this.updateProperty({breakPointData:{points:p,startDirection:h}})}else{var b=(a-1)/2;(p=R([],o,!0)).splice(b,1),this.updateProperty({breakPointData:{points:p}})}}},t.prototype.dealMultiEditorMove=function(e){var t=fN(this.element,e);t&&this.updateSelf(t)},t.prototype.addText=function(e){var t=void 0===e?this.getNewTextOffset():e,n=pN(this.element.texts.map((function(e){return e.id}))),i=this.element.texts[0],r={id:n,offset:t,textPlacement:2,content:[],fontSize:(null==i?void 0:i.fontSize)||this.upime.lastLineTextFontSize||14};if(!e){(h=R([],this.element.texts,!0)).sort((function(e,t){return e.offset-t.offset}));var o=h.reduce((function(e,n){return n.offset<t?n:e}),null);o?r.textPlacement=o.textPlacement:h.length&&(r.textPlacement=h[0].textPlacement)}var a=0===this.element.texts.length,s=R(R([],this.element.texts,!0),[r],!1),l=this.upime.createOperation();l.update(this.element,{texts:s});var c=this.element.textNodes.get(n);if(c){if(c.createOp=l,a){var u=c.textRect,d={width:u.width,height:u.height},p=kE({upime:this.element.upime,size:d,id:this.element.id,scale:1,currentScale:this.element.globalTransform.currentScale,position:{x:0,y:0},eleType:Za.TEXT});if(1!==p){var h=this.element.texts.map((function(e){return exports.E(exports.E({},e),{fontSize:Math.round(e.fontSize*p)})}));l.update(this.element,{texts:h})}}this.element.selectedTextId=c.id,c.prepareTextNodeRichEditor(c.richTextClient.contentEditor),c.startEdit()}},t.prototype.getNewTextOffset=function(){var e=R([],this.element.texts,!0);e.sort((function(e,t){return e.offset-t.offset}));var t=0,n=0,i=0;e.forEach((function(e){var r=e.offset-i;r>=t&&(t=r,n=i),i=e.offset}));var r=1-i;return r>=t&&(t=r,n=i),n+t/2},t.prototype.unselect=function(){var e;if(this.element.selectedTextId){var t=this.element.textNodes.get(this.element.selectedTextId);t&&(null===(e=t.richTextClient.contentEditor)||void 0===e||e.destory()),this.element.selectedTextId=void 0}},t.prototype.getCurrentTextNode=function(){var e=this.element.selectedTextId;return e&&this.element.textNodes.get(e)||null},t.prototype.doDelete=function(t){var n=this;if(this.element.selectedTextId){var i=this.element.texts.filter((function(e){return e.id!==n.element.selectedTextId}));t.update(this.element,{texts:i})}else e.prototype.doDelete.call(this,t)},t.prototype.adjustPointToAxis=function(e,t){var n=8/this.upime.view.scale,i=Math.abs(e.x-t.x)<n,r=Math.abs(e.y-t.y)<n;return i&&!r?{x:t.x,y:e.y}:r&&!i?{x:e.x,y:t.y}:e},t}(Lb);function fN(e,t){var n=e.startElementId,i=e.endElementId,r=e.breakPointData;if(n&&i&&!r.points.length)return null;var o={},a=e.globalTransform.applyVectorInverse({x:t.deltaX,y:t.deltaY});return n||(o.startPosition=En(e.startPoint,a)),i||(o.endPosition=En(e.endPoint,a)),r.points.length&&(o.breakPointData={points:r.points.map((function(e){return En(e,a)})),startDirection:r.startDirection}),o}function mN(e){return{isStartPositive:!(1&~e),isEndPositive:!(2&~e),isHorizontal:!(4&~e)}}function vN(e,t,n,i,r){var o,a,s,l,c,u,d,p,h,f,m,v;void 0===r&&(r=5);var g=mN(r),y=g.isStartPositive,b=e,E=t,x=n,w=i,C="x",S="y",k="right",_="left",T="bottom",I="top",P=30;y||(P=-30),g.isHorizontal||(C="y",S="x",k="bottom",_="top",T="right",I="left");var N=b[C],M=x[C],A=b[S],D=x[S],R=E[k],B=w[_],L=E[_],O=w[k],F=E[T],z=w[I],H=E[I],U=w[T],W=M-N,V=D-A,j=B-R,G=z-A,q=U-A,K=D-F,Y=D-H,X=(R+B)/2,Q=(L+O)/2,Z=Math.max(R,O)+P,J=[];if(y||(W=N-M,j=L-O,X=(L+O)/2,Q=(R+B)/2,Z=Math.min(L,B)+P),Ot(b,w)||Ot(x,E)){var $=(N+M)/2,ee=((o={})[C]=$,o[S]=A,o),te=((a={})[C]=$,a[S]=D,a);J.push(ee,te)}else{var ne=Kt(E,w)?0:30;if(W>=0&&(G>=ne||q<=-ne)||W<0&&(K>=ne||Y<=-ne))(s={})[C]=Z,s[S]=A,ee=s,(l={})[C]=Z,l[S]=D,te=l,J.push(ee,te);else if(j>0){var ie=((c={})[C]=M+P,c[S]=D,c),re=z-30;V<0&&(re=U+30),(u={})[C]=X,u[S]=A,(d={})[C]=(ee=u)[C],d[S]=re,te=d;var oe=((p={})[C]=ie[C],p[S]=re,p);J.push(ee,te,oe,ie)}else(h={})[C]=N+P,h[S]=A,re=H-30,V>0&&(re=F+30),(f={})[C]=(ee=h)[C],f[S]=re,te=f,(m={})[C]=Q,m[S]=re,oe=m,(v={})[C]=Q,v[S]=D,ie=v,J.push(ee,te,oe,ie)}return J}function gN(e,t,n,i,r){var o,a,s,l,c,u,d,p;void 0===r&&(r=5);var h=mN(r),f=h.isStartPositive,m=e,v=t,g=n,y=i,b="x",E="y",x="left",w="right",C="top",S="bottom";f||(m=n,v=i,g=e,y=t),h.isHorizontal||(b="y",E="x",x="top",w="bottom",C="left",S="right");var k=m[b],_=g[b],T=m[E],I=g[E],P=y[w],N=v[w],M=y[x],A=v[C],D=y[S],R=v[S],B=y[C],L=I-T,O=M-N,F=D-A,z=B-R,H=[];if(Ot(m,y)||Ot(g,v)){var U=(k+_)/2,W=((o={})[b]=U,o[E]=T,o),V=((a={})[b]=U,a[E]=I,a);H.push(W,V)}else if(O>=0){var j=(k+_)/2;(s={})[b]=j,s[E]=T,W=s,(l={})[b]=j,l[E]=I,V=l,H.push(W,V)}else{var G=0,q=k+30;z>=0||F<=0?(G=(R+B)/2,F<=0&&(G=(A+D)/2)):(q=Math.max(N,P)+30,G=L>0?Math.max(R,D)+30:Math.min(A,B)-30),(c={})[b]=q,c[E]=T,W=c;var K=((u={})[b]=_-30,u[E]=I,u),Y=((d={})[b]=W[b],d[E]=G,V=d,(p={})[b]=K[b],p[E]=G,p);H.push(W,V,Y,K)}return f||H.reverse(),H}function yN(e,t,n,i,r){var o,a,s,l,c,u,d,p,h,f,m,v,g,y;void 0===r&&(r=5);var b=mN(r),E=b.isStartPositive,x=b.isEndPositive,w=e,C=n,S=t,k=i,_=E,T=x,I="left",P="right",N="top",M="bottom",A=30,D=-30,R=!b.isHorizontal;R&&(w=n,C=e,S=i,k=t,_=x,T=E),_||(I="right",P="left",A=-30),T&&(N="bottom",M="top",D=30);var B=w.x,L=C.x,O=w.y,F=C.y,z=S[I],H=k[P],U=S[N],W=S[P],V=k[I],j=S[M],G=k[N],q=L-B,K=F-O,Y=V-W,X=G-j,Q=(W+V)/2,Z=(j+G)/2,J=Math.max(W,H)+A,$=Math.min(U,G)+D;_||(q=B-L,Y=W-V,J=Math.min(W,H)+A),T&&(K=O-F,X=j-G,$=Math.max(U,G)+D);var ee=[],te=Ot(w,k),ne=Ot(C,S);if(te||ne)if(te&&q>=0||ne&&K>=0||te&&ne){var ie=((o={}).x=L,o.y=O,o);ee.push(ie)}else if(te){var re=G-U;T&&(re=U-G);var oe=(U+G)/2;re>0&&(oe=j-D),(a={}).x=B+A,a.y=O;var ae=((s={}).x=(ie=a).x,s.y=oe,s),se=((l={}).x=L,l.y=ae.y,l);ee.push(ie,ae,se)}else{var le=H-W;_||(le=W-H);var ce=(W+H)/2;le>0&&(ce=V-A),(c={}).x=L,c.y=F+D,se=c,(u={}).x=ce,u.y=se.y,(d={}).x=(ae=u).x,d.y=O,ie=d,ee.push(ie,ae,se)}else{var ue=Kt(S,k);if(q>=0&&K>=(ue?0:30)&&(q>=30||X<60))(p={}).x=L,p.y=O,ie=p,ee.push(ie);else{var de=L-z,pe=G-O;if(_||(de=z-L),T&&(pe=O-G),q<30&&X>=0||de<0&&X<0){var he=B+A,fe=Z;de<0&&X<0&&(fe=$,pe<0&&(he=J)),(h={}).x=he,h.y=O,(f={}).x=(ie=h).x,f.y=fe,ae=f,(m={}).x=L,m.y=ae.y,se=m,ee.push(ie,ae,se)}else(v={}).x=L,v.y=F+D,se=v,he=J,K<30&&Y>=0&&(he=Q),(g={}).x=he,g.y=O,ie=g,(y={}).x=he,y.y=se.y,ae=y,ee.push(ie,ae,se)}}return R&&ee.reverse(),ee}var bN=function(){function e(e){this.upime=e,this.localOnly=!1,this.reverseData=[],this.bufferedCreates=[],this._updateSeq=0}return e.prototype.getReverseData=function(){return this.reverseData},Object.defineProperty(e.prototype,"updateSeq",{get:function(){return this._updateSeq},set:function(e){this._updateSeq=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relativeElements",{get:function(){return this.reverseData.map((function(e){return e.element}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateGroup",{get:function(){return this.reverseData},enumerable:!1,configurable:!0}),e.prototype.sendWeakOt=function(e,t,n,i){this.addOtReverseData(e,n,i);var r={localAction:n,property:i};i?this.addUpdateToBuffer(e,{cps:[[i.name,i.type,t]]},r):this.addUpdateToBuffer(e,{weakOt:t},r)},e.prototype.addOtReverseData=function(e,t,n){var i=this.reverseData.find((function(t){return t.element===e}));i&&i.isCreate||(i||(i={element:e,update:{}},this.reverseData.push(i)),EN(i,t,n))},e.prototype.addAsyncUpdates=function(e,t){this.localOnly||this.upime.addAsyncUpdates(e,t)},e.prototype.addUpdateToBuffer=function(e,t,n){var i,r=this.bufferedCreates.find((function(t){return t.element===e}));if(r)i=r.seq,r.update=Ls(r.update,t);else{if(!this.bufferedUpdates){var o=this.upime.genLocalSeq();this.updateSeq=o,this.bufferedUpdates=[],this.addAsyncUpdates(o,this.bufferedUpdates)}i=this.updateSeq,r=this.bufferedUpdates.find((function(t){return t.element===e})),r?r.update=Ls(r.update,t):(r={element:e,update:exports.E({},t)},this.bufferedUpdates.push(r))}return n&&EN(r,n.localAction,n.property),i},e.prototype.addLocalDraftElement=function(e){var t=this.upime.genLocalSeq();this.reverseData.push({element:e,update:{deleted:!0},isCreate:!0,seq:t}),this.upime.elementManager.addElement(e),e.updateBorderBox();var n={element:e,update:zs(e,e.elementType),isCreate:!0,seq:t};this.bufferedCreates.push(n),this.addAsyncUpdates(t,[n]),this.sync()},e.prototype.create=function(e,t,n){var i,r=n||{},o=r.id,a=r.hide,s=void 0!==a&&a,l=r.isRevert,c=void 0!==l&&l;o=o||this.upime.genID(e);var u=null!==(i=this.upime.elementManager.getElementById(o))&&void 0!==i?i:this.upime.elementManager.genElement(e,o);u.eleHided=s;var d=this.upime.genLocalSeq(),p={deleted:!0};void 0===t.deleted&&(t.deleted=!1),void 0!==t.frameId&&(p.frameId=null),void 0!==t.prevFrameId&&(p.prevFrameId=null),this.reverseData.push({element:u,update:p,isCreate:!0,seq:d}),this.upime.elementManager.updateElement(u,t,{localUpdateSeq:d});var h={element:u,update:exports.E({},t),isCreate:!0,seq:d,isRevert:c};return this.bufferedCreates.push(h),this.addAsyncUpdates(d,[h]),u},e.prototype.update=function(e,t){this.addReverseData(e,t);var n=this.addUpdateToBuffer(e,t);this.upime.elementManager.updateElement(e,t,{localUpdateSeq:n,clipUpdate:!0})},e.prototype.mergeReverseUpdate=function(e,t,n,i){if(i)void 0!==n.frameId&&(t.frameId=null),void 0!==n.prevFrameId&&(t.prevFrameId=null);else{var r=n,o=r.prevFrameId;r.drawPoints;var a=r.cps,s=N(r,["prevFrameId","drawPoints","cps"]);if(void 0!==o){var l=this.upime.framesListManager.getPrevFrameId(e.id);t.prevFrameId=l}if(a){var c=t.cps;c||(c=t.cps=[]);for(var u=function(t){var n=t[0],i=t[1];if(t[2],"weakOt"==i||c.find((function(e){return e[0]===n})))return"continue";var r=e.getCustomProperty(n,i);c.push([n,i,r.getInitData()])},d=0,p=a;d<p.length;d++)u(p[d])}for(var h in s)void 0===t[h]&&"weakOt"!=h&&(t[h]=e[h])}},e.prototype.addReverseData=function(e,t){var n=this.reverseData.find((function(t){return t.element===e}));n||(n={element:e,update:{}},this.reverseData.push(n));var i=n.update;n.isCreate&&!0===t.deleted&&(this.reverseData=this.reverseData.filter((function(e){return e!==n}))),this.mergeReverseUpdate(e,i,t,n.isCreate)},e.prototype.createSync=function(e,t){var n=this.create(e,t);return this.sync(),n},e.prototype.updateSync=function(e,t){this.update(e,t),this.sync()},e.prototype.sync=function(){var e=this,t=this.bufferedUpdates,n=this.bufferedCreates;if(t||0!==n.length){if(this.localOnly)return this.bufferedUpdates=void 0,void(this.bufferedCreates=[]);n.length&&n.forEach((function(t){return e.upime.recordAction(xN(t))})),t&&this.upime.recordAction(wN(t,this.updateSeq)),this.bufferedUpdates=void 0,this.bufferedCreates=[]}},e.prototype.getRevertOperation=function(){var t=this,n=this.reverseData,i=new e(this.upime);this.localOnly&&(i.localOnly=!0);for(var r=function(e){var n=e.element,r=e.update,a=e.localOtActions;if(a&&a.forEach((function(e){var r,o=e.localOt,a=e.property,s=a?a.richTextClient:n.richTextClient,l=o.opList,c=o.reverseOpList,u={baseVersion:s.version,version:t.upime.genOtVersion(s.parseVersionNum(s.version)+1),content:c};i.addOtReverseData(n,{opList:c,reverseOpList:l},a),r=a?{cps:[[a.name,a.type,u]]}:{weakOt:u},i.addUpdateToBuffer(n,r),t.upime.elementManager.updateElement(n,r)})),void 0!==r.frameId&&null!==r.frameId){var s=r.frameId,l=N(r,["frameId"]);i.update(n,l);var c=o.upime.elementManager.getElementById(s);c&&(n.isSupportFrame&&c.checkBorderInFrame(n.getBorderBox())||n.group)&&i.update(n,{frameId:s})}else!1===r.deleted?i.create(n.elementType,exports.E(exports.E({},zs(n,n.elementType)),{deleted:!1}),{id:n.id,isRevert:!0}):i.update(n,r)},o=this,a=0,s=n;a<s.length;a++)r(s[a]);return i.sync(),i},e.prototype.cancelCreate=function(){var e=this;this.bufferedUpdates&&this.upime.deleteAsyncUpdates(this.updateSeq),this.bufferedCreates.length&&this.bufferedCreates.forEach((function(t){return e.upime.deleteAsyncUpdates(t.seq)})),this.upime.deleteOperation(this)},e.prototype.checkIsEmpty=function(){0===this.reverseData.length&&this.upime.deleteOperation(this)},e.prototype.addTemplateEles=function(e){var t=this;e.forEach((function(e){t.reverseData.push({element:e,update:{deleted:!0}})}))},e}();function EN(e,t,n){var i=e.localOtActions;i||(i=[],e.localOtActions=i);var r,o,a=i.find((function(e){return e.property===n}));a?a.localOt=(o=t,{opList:Is((r=a.localOt).opList,o.opList),reverseOpList:Is(o.reverseOpList,r.reverseOpList)}):i.push({localOt:t,property:n})}function xN(e){var t=e.seq,n=e.element,i=e.update,r=e.isRevert;return{type:"create",seq:t,id:n.id,elementType:n.elementType,data:i,isRevert:r}}function wN(e,t){return{type:"update",seq:t,updates:e.map((function(e){var t=e.element,n=e.update;return{id:t.id,update:n,elementType:t.elementType}}))}}var CN=function(e){function t(t){var n=e.call(this,t)||this;return n.excludedStyles=["bolder","deleteLine","italic","underLine","link","mention","highLight"],n.lineSelectEditor=new SN(t.element.upime,t.element),n.lineSelectEditor.richContentEditor=n,n}return P(t,e),Object.defineProperty(t.prototype,"editor",{get:function(){return this.lineSelectEditor},enumerable:!1,configurable:!0}),t.prototype.applyAction=function(t,n){var i=e.prototype.applyAction.call(this,t,n);return this.client.element.updateTextRect(),i},t.prototype.destory=function(){this.lineSelectEditor.unselect(),this.client.element.save()},t}(Ly),SN=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startedEdit=!1,t}return P(t,e),t.prototype.startEdit=function(t){this.startedEdit=!0,t&&t.op&&(t.op=void 0),e.prototype.startEdit.call(this,exports.E(exports.E({},t),{checkMobileFocus:!0}))},t.prototype.stopEdit=function(){var t;this.startedEdit&&(null===(t=this.richContentEditor)||void 0===t||t.client.element.save()),e.prototype.stopEdit.call(this),this.startedEdit=!1},t.prototype.getNewOperation=function(){return new kN(this.upime)},t}(Lb),kN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.sync=function(){},t}(bN),_N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.createContentEditor=function(){return new CN(this)},t.prototype.calcRenderData=function(){var t=e.prototype.calcRenderData.call(this),n=Math.max.apply(Math,t.lines.map((function(e){return e.width})));if(t.width=n,0===this.chars.length){var i=Oe.placeholder,r=ji(i,this.element);t.placeholder={width:r,text:i,data:{color:11645361,highLight:null}}}return t},t}(Fy),TN=function(e){function t(t,n,i){var r=e.call(this,t,n.id)||this;return r.text=n,r.line=i,r.supportSwitchToWebpage=!1,r.selectStatus="single",r.textRect={x:0,y:0,width:0,height:0},r.va="top",r.editing=!1,r.ha="left",r.lineHeightRate=1.5,r.fontFamily=He,r.richTextClient=new _N(r),r}return P(t,e),Object.defineProperty(t.prototype,"position",{get:function(){var e=this.textGlobalRect.rect,t=this.line.startPoint;return{x:t.x+e.x,y:t.y+e.y}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return this.richTextClient.contentEditor.editor.editing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentLinePart",{get:function(){var e=this;return this.line.lineLengthInfoList.find((function(t){return t.startOffset<=e.offset&&t.endOffset>=e.offset}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderDataWidth",{get:function(){var e,t=this.richTextClient.renderData;return t.width||(null===(e=t.placeholder)||void 0===e?void 0:e.width)||0},enumerable:!1,configurable:!0}),t.prototype.updateTextRect=function(){var e=this.renderDataWidth,t=this.richTextClient.renderData.height;this.textRect={x:0,y:0,width:e,height:t}},Object.defineProperty(t.prototype,"textGlobalRect",{get:function(){var e=this.getLineOffsetPosition(),t=this.line.lineWidth,n=this.text.textPlacement,i=this.getKLine(),r=function(e,t){var n=-e.y,i=-t.y;return t.x>e.x&&i>=n?1:t.x<=e.x&&i>n?2:t.x<e.x&&i<=n?3:t.x>=e.x&&i<n?4:1}(i.p1,i.p2),o=1===r||4===r,a=1===n&&o||3===n&&!o,s=0;if(2===n&&(s=e.y-this.textRect.height/2),1===n&&(s=o?e.y-this.textRect.height-this.line.lineWidth/2-4:e.y+this.line.lineWidth/2+4),3===n&&(s=o?e.y+t/2+4:e.y-this.textRect.height-this.line.lineWidth/2-4),1===this.line.textDirection){var l=0;if(2===n)l=e.x-this.textRect.width/2;else if(l=e.x-this.textRect.width/2,Math.abs((i.p2.y-i.p1.y)/(i.p2.x-i.p1.x))>0){var c=this.textRect,u={p1:{x:l+c.x,y:s+c.y},p2:{x:l+c.x+c.width,y:s+c.y}},d={p1:{x:l+c.x,y:s+c.y+c.height},p2:{x:l+c.x+c.width,y:s+c.y+c.height}},p=Fn(i,u),h=Fn(i,d);if(p&&h){var f=1===r||2===r;if(1===n?f:!f){var m=u.p2.x-p.x,v=d.p2.x-h.x;l-=Math.max(0,m,v)}else{var g=p.x-u.p1.x,y=h.x-d.p1.x;l+=Math.max(0,g,y)}}}return{rect:{x:l,y:s,width:this.renderDataWidth,height:this.richTextClient.renderData.height},isTop:a}}return{rect:{x:l=e.x-this.textRect.width/2,y:s,width:this.renderDataWidth,height:this.richTextClient.renderData.height},isTop:a}},enumerable:!1,configurable:!0}),t.prototype.getClipPath=function(e){void 0===e&&(e=!0);var t=e?4:0;if(2!==this.textPlacement)return null;var n=this.textGlobalRect.rect,i={x:n.x-t,y:n.y,width:n.width+2*t,height:n.height};if(1===this.line.textDirection)return[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}];var r=Bt(i),o=Lt(r),a=this.rotate;return[an({x:r.left,y:r.top},a,o),an({x:r.right,y:r.top},a,o),an({x:r.right,y:r.bottom},a,o),an({x:r.left,y:r.bottom},a,o)]},t.prototype.getBorderPath=function(){var e=this.textGlobalRect.rect,t={x:e.x,y:e.y,width:e.width,height:e.height};if(1===this.line.textDirection)return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];var n=Bt(t),i=Lt(n),r=this.rotate;return[an({x:n.left,y:n.top},r,i),an({x:n.right,y:n.top},r,i),an({x:n.right,y:n.bottom},r,i),an({x:n.left,y:n.bottom},r,i)]},t.prototype.checkPointInText=function(e){if(1===this.line.textDirection)return Ot(e,Bt(this.textGlobalRect.rect));var t={x:e.x+this.line.startPoint.x,y:e.y+this.line.startPoint.y};return Ot(this.getRotatedPointToRect(t),Bt(this.textRect))},t.prototype.getKLine=function(){var e=this.currentLinePart;return e?this.getKLineByLinePart(e):{p1:{x:0,y:0},p2:{x:1,y:1}}},t.prototype.getKLineByLinePart=function(e){if("straight"===e.type)return{p1:e.start,p2:e.end};var t=e.start,n=e.end,i=e.c1,r=e.c2,o=(this.offset-e.startOffset)/(e.endOffset-e.startOffset),a=o+.1*(1-o);return{p1:un(t,i,r,n,.9*o),p2:un(t,i,r,n,a)}},Object.defineProperty(t.prototype,"rotate",{get:function(){var e=this.getKLine();if(e.p2.y===e.p1.y)return 0;var t=(e.p2.y-e.p1.y)/(e.p2.x-e.p1.x);return Math.atan(t)*(180/Math.PI)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.text.fontSize||14},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return 1.5*this.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this.fontSize/14*300},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this.text.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textPlacement",{get:function(){return this.text.textPlacement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this.richTextClient.content},enumerable:!1,configurable:!0}),t.prototype.updateInfo=function(e){this.text=e,this.updateContent(e.content)},t.prototype.updateContent=function(e){this.isEditing||_t.isEqual(this.content,e)||this.richTextClient.initContent(e),this.updateTextRect()},t.prototype.getLineOffsetPosition=function(){var e=this;return this.useMemo("getLineOffsetPosition",(function(){var t=e.currentLinePart;if(!t)return{x:0,y:0};var n=(e.offset-t.startOffset)/(t.endOffset-t.startOffset),i=t.start,r=t.end;if("straight"===t.type)return{x:Rn(i.x,r.x,n),y:Rn(i.y,r.y,n)};var o=un(i,t.c1,t.c2,r,n);return{x:o.x,y:o.y}}),[this.line.lineLengthInfoList,this.offset,this.textPlacement])},Object.defineProperty(t.prototype,"isSelected",{get:function(){return this.line.selectedTextId===this.text.id},enumerable:!1,configurable:!0}),t.prototype.save=function(){var e=this;if(!this.line.deleted){var t=[],n=!1;if(0===this.richTextClient.chars.length){t=this.line.texts.filter((function(t){return t.id!==e.text.id}));var i=this.text.content.reduce((function(e,t){return e+t[0].length}),0);0===i&&(n=!0)}else{var r=_t.cloneDeep(this.richTextClient.content);t=this.line.texts.map((function(t){return t.id===e.text.id?exports.E(exports.E({},t),{content:r}):exports.E({},t)}))}if(!_t.isEqual(t,this.line.texts)){var o=this.createOp||this.upime.createOperation();o.update(this.line,{texts:t}),o.sync(),n&&this.upime.deleteOperation(o)}this.createOp=void 0}},t.prototype.getGlobalBox=function(){if(!this.richTextClient)return{left:0,top:0,right:0,bottom:0};var e=this.textGlobalRect.rect,t=this.line.startPoint,n=t.x,i=t.y;return{left:n+e.x,top:i+e.y,right:n+e.x+e.width,bottom:i+e.y+e.height}},t.prototype.startEdit=function(){if(!this.isEditing&&(this.richTextClient.contentEditor.editor.startEdit(),0===this.richTextClient.length)){var e=this.line.getDefaulTextColor();1710618!==e&&this.richTextClient.contentEditor.updateStyle({color:e})}},t.prototype.dealClickText=function(e){if(this.isEditing)this.richTextClient.contentEditor.moveCursorToPosition(this.getRotatedPointToRect(e.position));else{if(!this.line.selectedTextId||this.line.selectedTextId&&this.line.selectedTextId!==this.id)return this.line.selectedTextId=this.id,void this.prepareTextNodeRichEditor(this.richTextClient.contentEditor);this.startEdit(),this.richTextClient.contentEditor.moveCursorToPosition(this.getRotatedPointToRect(e.position))}},t.prototype.dealMoveText=function(e){if(!this.isEditing)return this.dealMovePosition(e),!0;var t=this.richTextClient.contentEditor;if(e.isStart){var n=this.getRotatedPointToRect(e.startPosition);t.setSelectionStart(t.getIndexByPosition(n).index)}var i=this.getRotatedPointToRect(e.position);return t.setSelectionEnd(t.getIndexByPosition(i).index),this.upime.updateView(),!0},t.prototype.getRotatedPointToRect=function(e){var t=this.textGlobalRect.rect,n=e.x-this.line.startPoint.x,i=e.y-this.line.startPoint.y,r=1===this.line.textDirection?0:this.rotate,o=this.getRotateInfo(),a=o.x,s=o.y,l=an({x:n,y:i},-r,{x:a-=this.line.startPoint.x,y:s-=this.line.startPoint.y});return{x:l.x-t.x,y:l.y-t.y}},t.prototype.getRotateInfo=function(){var e=this.textGlobalRect,t=e.rect,n=e.isTop,i=this.line.startPoint,r=i.x,o=i.y,a=r+t.x,s=o+t.y;if(1===this.line.textDirection)return{x:a,y:s,pivotX:void 0,pivotY:void 0};var l=a+t.width/2,c=t.width/2,u=0,d=0;return 2===this.textPlacement?(u=s+t.height/2,d=t.height/2):n?(u=s+t.height,d=t.height):(u=s,d=0),{x:l,y:u,pivotX:c,pivotY:d,rotation:this.rotate}},t.prototype.prepareTextNodeRichEditor=function(e){var t;(null===(t=this.line.currentEditor)||void 0===t?void 0:t.frozed)||this.upime.view.setConnectedRichEditor(e)},t.prototype.stopEdit=function(){this.richTextClient.contentEditor.destory()},t.prototype.dealMovePosition=function(e){var t=this,n=this.getOffsetByPosition(e.position),i=n.offset,r=n.place;this.moveOp||(this.moveOp=this.upime.createOperation());var o=this.line.texts.map((function(e){return e.id===t.text.id?exports.E(exports.E({},e),{offset:i,textPlacement:r}):e}));this.moveOp.update(this.line,{texts:o}),this.moveOp.sync(),e.isEnd&&(this.moveOp=void 0)},t.prototype.getOffsetByPosition=function(e){var t=this.line.getNestestPointOffset(e),n=t.offset,i=t.distance,r=t.lineInfo,o=2;if(i>20){var a=this.getKLineByLinePart(r);o="left"===zn({x:e.x-this.line.startPoint.x,y:e.y-this.line.startPoint.y},a.p1,a.p2)?1:3}return{offset:n,place:o}},t.prototype.render=function(){var e=this;fa(this.getRotateInfo()),jy({richClient:this.richTextClient,x:0,y:0,element:this});var t=js.value.exportType;if(!this.isSelected||this.isEditing||t||Na((function(t){var n=e.textRect;t.lineStyle({color:6134012}),t.moveTo(n.x,n.y),t.lineTo(n.x+n.width,n.y),t.lineTo(n.x+n.width,n.y+n.height),t.lineTo(n.x,n.y+n.height),t.closePath()})),ma(),2!==this.textPlacement){var n=this.line.startPoint,i=n.x,r=n.y,o=this.getLineOffsetPosition();fa({x:i+o.x,y:r+o.y}),Na((function(t){t.beginFill(e.line.lineColor),t.drawCircle(0,0,e.line.lineWidth+.5),t.endFill()})),ma()}},t}(oy),IN=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.renderer=IP,i.editorType=hN,i.elementType=Za.CONNECTIONLINE,i.startElementId=null,i.startPosition={x:0,y:0},i.startPoint={x:0,y:0},i.startRadius=0,i.startType=0,i.startArrow=0,i.startArrowPath=null,i.startArrowDrawPath=null,i.endElementId=null,i.endPosition={x:0,y:0},i.endPoint={x:0,y:0},i.endRadius=0,i.endType=0,i.endArrow=0,i.endArrowPath=null,i.endArrowDrawPath=null,i.lineRects=[],i.lineWidth=1,i.displayLineWidth=1,i.arrowSideLength=0,i.lineType=1,i.lineStyle=1,i.lineColor=0,i.breakPoints=[],i.drawPoints=[],i.controlPoints=[],i.drawPath=[],i.textDirection=1,i.texts=[],i.textNodes=new Map,i.lineLengthInfoList=[],i.breakPointData={points:[]},i}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineCap",{get:function(){return 2===this.lineStyle?"round":"butt"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return"round"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportDBClickAddText",{get:function(){return!this.upime.phoneMode},enumerable:!1,configurable:!0}),t.prototype.filterPoints=function(e){for(var t=e[0],n=[t],i=1;i<e.length;i++)i===e.length-1&&t===e[0]?n.push(e[i]):bn(t,e[i])||(n.push(e[i]),t=e[i]);return n},t.prototype.getLineRects=function(){var e=[],t=[];switch(this.lineType){case 4:case 2:case 1:for(var n=this.filterPoints(this.drawPoints),i=0;i<n.length-1;i++){var r=n[i],o=n[i+1],a=nn(r,o),s=rn(a+Math.PI),l=0,c=null,u=0,d=null,p=0===i,h=i===n.length-2;p&&(l=this.startArrow,c=this.startArrowPath),h&&(u=this.endArrow,d=this.endArrowPath);var f=this.getLineRect(r,a,l,c,o,s,u,d);e.push(f.borderBox),t.push(f.lineStart),h&&t.push(f.lineEnd)}}return{lineRects:e,points:t}},t.prototype.updateLineRects=function(){var e=this;if(3!==this.lineType){var t=this.getLineRects(),n=t.lineRects,i=t.points;this.lineRects=n;var r=[];i.forEach((function(t){var n=t.x-e.startPoint.x,i=t.y-e.startPoint.y;r.push({x:n,y:i})})),this.drawPath=r}},t.prototype.checkMounted=function(){return e.prototype.checkMounted.call(this)&&!this.hideByConnectElement()},t.prototype.hideByConnectElement=function(){var e,t;return!((!this.startElement||this.startElement.mounted)&&(!this.endElement||this.endElement.mounted)&&((null===(e=this.startElement)||void 0===e?void 0:e.elementType)!==Za.MINDMAP_NODE||!this.startElement.isMindmapNodeHideByCollapsed)&&((null===(t=this.endElement)||void 0===t?void 0:t.elementType)!==Za.MINDMAP_NODE||!this.endElement.isMindmapNodeHideByCollapsed))},t.prototype._checkUnAvailable=function(){return this.hideByConnectElement()||e.prototype._checkUnAvailable.call(this)},t.prototype.calcTransformedUpdate=function(t){var n=e.prototype.calcTransformedUpdate.call(this,t);if(this.parentRefSystem!==t){for(var i=this.globalTransform,r=t.globalTransform,o=i.append(r.invert()),a=this.lineWidth*o.currentScale,s=it[0],l=Math.abs(s-a),c=1;c<it.length;c++){var u=it[c],d=Math.abs(u-a);d<l&&(l=d,s=u)}n.lineWidth=s,this.startElement||(n.startPosition=o.apply(this.startPosition)),this.endElement||(n.endPosition=o.apply(this.endPosition)),this.breakPointData.points.length&&(n.breakPointData=exports.E(exports.E({},this.breakPointData),{points:this.breakPointData.points.map((function(e){return o.apply(e)}))}))}return n},Object.defineProperty(t.prototype,"minVisibleSize",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.checkVisible=function(t){return!this.hideByConnectElement()&&e.prototype.checkVisible.call(this,t)},t.prototype.calcBorderBox=function(){var e=0===this.drawPoints.length?[this.startPoint,this.endPoint]:this.drawPoints;if(2===this.lineType||1===this.lineType)return Cn(e);if(4===this.lineType){var t=fn(this.startPoint,this.endPoint),n=.75*t/Math.tan(75*Math.PI/180),i=180*nn(this.startPoint,this.endPoint)/Math.PI,r=an({x:this.startPoint.x+.7*t,y:this.startPoint.y-n},-i,this.startPoint),o=an({x:this.startPoint.x+.7*t,y:this.startPoint.y+n},-i,this.startPoint);return Cn([this.startPoint,r,o,this.endPoint])}for(var a=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,u=0;u+3<=this.drawPath.length-1;u+=3){var d=An({x:this.drawPath[u].x,y:this.drawPath[u].y},{x:this.drawPath[u+1].x,y:this.drawPath[u+1].y},{x:this.drawPath[u+2].x,y:this.drawPath[u+2].y},{x:this.drawPath[u+3].x,y:this.drawPath[u+3].y}),p=d.left,h=d.right,f=d.bottom,m=d.top;a=Math.min(p,a),s=Math.min(m,s),c=Math.max(f,c),l=Math.max(h,l)}return{left:this.startPoint.x+a,right:this.startPoint.x+l,bottom:this.startPoint.y+c,top:this.startPoint.y+s}},t.prototype.getPointAndSideLengthByArrowPath=function(e,t){switch(e){case 4:case 3:var n=t.path,i=n[0];return{point:(a=n[1]).p0,sideLength:2*i.radius};case 2:var r=t.path,o=r[1],a=r[3],s=o.p0,l=o.p1;return{point:a.p0,sideLength:fn(s,l)};default:var c=t.path[1],u=c.p0;return{point:c.p1,sideLength:fn(u,c.p2)}}},t.prototype.getLineRect=function(e,t,n,i,r,o,a,s){var l=this.displayLineWidth,c=0,u=e,d=r;if(4===this.lineType)c=fn(u,d)/4;else{var p=l/2,h=0,f=0;if(i){var m=this.getPointAndSideLengthByArrowPath(n,i);u=m.point,h=m.sideLength+8}if(s){var v=this.getPointAndSideLengthByArrowPath(a,s);d=v.point,f=v.sideLength+8}i||s||(h=2*p,f=2*p),c=Math.max(h,f)}var g={x:(u.x+d.x)/2,y:(u.y+d.y)/2},y=an(u,180*t/Math.PI,g),b=an(u,180*o/Math.PI,g),E=jt(y.x,b.x),x=E[0],w=E[1];return{lineStart:u,lineEnd:d,borderBox:{left:x,top:y.y-c/2,right:w,bottom:y.y+c/2,rotate:180*(t<=.5*Math.PI||t>=1.5*Math.PI?t:o)/Math.PI}}},t.prototype.getArrowPath=function(e,t,n){var i=this.lineWidth,r=this.arrowSideLength,o=it[0],a={path:[],filled:!1,lineWidth:i};switch(n){case 1:var s=np*(i-o)+45,l=(tp*(i-o)+30)*Math.PI/180,c=s*Math.PI/180,u={x:e.x,y:e.y},d={x:u.x-r*Math.cos(t-l/2),y:u.y+r*Math.sin(t-l/2)},p={x:u.x-r*Math.cos(t+l/2),y:u.y+r*Math.sin(t+l/2)},h=Math.PI-c,f=fn(d,p),m=f/2/Math.sin(c/2),v=f/2/Math.sin(h/2),g={type:"line",p0:u,p1:d},y={type:"arc",p0:d,p1:{x:d.x+v*Math.cos(h/2-t),y:d.y+v*Math.sin(h/2-t)},p2:p,radius:m},b={type:"line",p0:p,p1:u};a.path=[g,y,b],a.lineWidth=1,a.filled=!0;break;case 2:var E=60*Math.PI/180,x={x:e.x,y:e.y},w={x:x.x-r*Math.cos(t-E/2),y:x.y+r*Math.sin(t-E/2)},C={x:x.x-r*Math.cos(t+E/2),y:x.y+r*Math.sin(t+E/2)},S=vn(w,C),k={type:"line",p0:x,p1:w},_={type:"line",p0:w,p1:C},T={type:"line",p0:C,p1:x},I={type:"move",p0:F={x:Rn(x.x,S.x,.95),y:Rn(x.y,S.y,.95)}};a.path=[k,_,T,I],a.lineWidth=0,a.filled=!0;break;case 4:var P=this.displayLineWidth,N=.8*r/2;N<=this.displayLineWidth&&(P=Math.max(0,2*N-this.displayLineWidth));var M=N-P/2,A={x:e.x-P/2*Math.cos(t),y:e.y+P/2*Math.sin(t)},D={x:A.x-2*M*Math.cos(t),y:A.y+2*M*Math.sin(t)},R=vn(A,D);a.path=[{type:"circle",radius:M,p0:R,lineWidth:P},{type:"move",p0:D}],a.lineWidth=P,a.filled=!1;break;case 3:var B=r/2*.8,L={x:e.x-2*B*Math.cos(t),y:e.y+2*B*Math.sin(t)},O=vn(e,L),F={x:Rn(e.x,L.x,.95),y:Rn(e.y,L.y,.95)};a.path=[{type:"circle",radius:B,p0:O,lineWidth:1},{type:"move",p0:F}],a.lineWidth=1,a.filled=!0}return a},t.prototype.getArrowDrawPath=function(e){var t=this.startPoint;return{path:e.path.map((function(e){switch(e.type){case"arc":return{type:e.type,radius:e.radius,p0:xn(e.p0,t),p1:xn(e.p1,t),p2:xn(e.p2,t)};case"line":return{type:e.type,p0:xn(e.p0,t),p1:xn(e.p1,t)};case"move":return{type:e.type,p0:xn(e.p0,t)};case"circle":return{type:e.type,radius:e.radius,p0:xn(e.p0,t),lineWidth:e.lineWidth}}})),lineWidth:e.lineWidth,filled:e.filled}},t.prototype.isPointInArrowPath=function(e,t,n){var i=!1;switch(t){case 4:var r=n.path[0];i=Zt(e,{center:r.p0,r:r.radius+r.lineWidth/2});break;case 3:var o=n.path[0];i=Zt(e,{center:o.p0,r:o.radius});break;case 1:case 2:var a=n.path,s=a[0],l=a[2];i=Qt(e,s.p0,s.p1,l.p0)}return i},t.prototype.checkArrowSelectRelation=function(e){return this.startArrowPath&&this.isPointInArrowPath(e,this.startArrow,this.startArrowPath)||this.endArrowPath&&this.isPointInArrowPath(e,this.endArrow,this.endArrowPath)?{transparent:!1,metric:-1}:null},t.prototype.checkEndpointRelation=function(e){var t=this.upime.view.scale,n=this.globalTransform.currentScale,i=this.extraSensitivation/n/t,r=fn(e,this.startPoint),o=fn(e,this.endPoint);if(r<=i||o<=i){var a="start";return o<r&&(a="end"),{transparent:!1,metric:-1,metaData:{lineEndpointType:a,notAllowed:!1}}}return null},t.prototype.checkControlPointRelation=function(e){for(var t=this.upime.view.scale,n=this.globalTransform.currentScale,i=this.extraSensitivation/n/t,r=15/n/t,o=this.controlPoints.length,a=0;a<o;a++){var s=this.controlPoints[a];if(!(0===a&&fn(s,this.startPoint)<=r)&&!(a===o-1&&fn(s,this.endPoint)<=r)&&fn(s,e)<=i){var l=0===this.breakPointData.points.length;return 2===this.lineType&&(l||(l=!this.breakPointData.startDirection)),{transparent:!1,metric:-1,metaData:{lineControl:{controlPoint:exports.E({},s),originPoints:R([],this.breakPoints,!0),originLineDirection:this.squareLineDirection,originControlPoints:R([],this.controlPoints,!0),noBreakPoints:l,startPoint:this.startPoint,endPoint:this.endPoint,currentIndex:a}}}}}return null},t.prototype.checkLineRectsRelation=function(e){for(var t=null,n=16/this.upime.view.scale/this.globalTransform.currentScale,i=0;i<this.lineRects.length;i++){var r=this.lineRects[i],o=r.left,a=r.top,s=r.right,l=r.bottom,c=r.rotate,u={x:e.x,y:e.y};if(c&&(u=an(e,c,{x:(o+s)/2,y:(a+l)/2})),Ot(u,r,n)){t={transparent:!1,metric:-1};break}}return t},t.prototype.checkBezierRelation=function(e){var t=this.upime.view.scale,n=this.extraSensitivation/t/this.globalTransform.currentScale,i=this.startPoint,r=this.drawPath;e=xn(e,i);for(var o=!1,a=1;a<r.length;a+=3)if(dn(exports.E({},r[a-1]),exports.E({},r[a]),exports.E({},r[a+1]),exports.E({},r[a+2]),e,n)){o=!0;break}return o?{transparent:!1,metric:-1}:null},t.prototype._checkSelectRelation=function(t,n){if("hover"===(null==n?void 0:n.type))return null;var i=this.checkEndpointRelation(t)||this.checkControlPointRelation(t);if(i)return i;var r=this.checkLineTextRelation(t,n);if(r)return r;if(!(i=this.checkArrowSelectRelation(t)))switch(this.lineType){case 3:i=this.checkBezierRelation(t);break;case 1:case 2:case 4:i=this.checkLineRectsRelation(t);break;default:i=e.prototype._checkSelectRelation.call(this,t,n)}return!i&&r?{transparent:!1,metric:-1}:(i&&(i.metaData={notAllowed:!!this.startElementId||!!this.endElementId}),i)},t.prototype.dealUpdate=function(t){var n,i=t,r=i.startElementId,o=i.startPosition,a=i.endElementId,s=i.endPosition,l=i.startArrow,c=i.endArrow,u=i.lineWidth,d=i.lineType,p=i.breakPointData,h=i.texts,f=N(i,["startElementId","startPosition","endElementId","endPosition","startArrow","endArrow","lineWidth","lineType","breakPointData","texts"]);e.prototype.dealUpdate.call(this,f);var m=!1,v=!1;void 0!==r&&(this._update_startElementId(r),o||(this.startPoint=(null===(n=this.startElement)||void 0===n?void 0:n.getGlobalPointByPercentOffset(this.startPosition,{attachedType:this.startType}))||this.startPosition)),void 0!==a&&this._update_endElementId(a),o&&this._update_startPosition(o),s&&this._update_endPosition(s),void 0!==d&&(this.lineType=d),void 0!==p&&(this.breakPointData=p),(void 0!==r||void 0!==a||o||s||void 0!==d||void 0!==p)&&(m=!0),void 0!==u&&(this.displayLineWidth=u,this.lineWidth=u,v=!0),void 0!==l&&(this.startArrow=l,v=!0),void 0!==c&&(this.endArrow=c,v=!0),void 0===r&&void 0===a||this.handleAttachedElementChanged(),void 0!==h&&this.updateTexts(h),this.updateDrawPath({doUpdateLinePath:m,doUpdateArrowPath:v})},t.prototype.checkUpdateMoved=function(e){return!!(e.startElementId||e.startPosition||e.endElementId||e.endPosition)},t.prototype._update_startElementId=function(e){var t,n;null===(t=this.startElement)||void 0===t||t.detach(this.id),null!==e?(this.startElement=this.upime.elementManager.getElementById(e),null===(n=this.startElement)||void 0===n||n.attach(this.id,this)):this.startElement=void 0,this.startElementId=e},t.prototype._update_endElementId=function(e){var t,n;null===(t=this.endElement)||void 0===t||t.detach(this.id),null!==e?(this.endElement=this.upime.elementManager.getElementById(e),null===(n=this.endElement)||void 0===n||n.attach(this.id,this)):this.endElement=void 0,this.endElementId=e},t.prototype._update_startPosition=function(e){this.startPosition=e,this.updateStartPoint()},t.prototype.updateStartPoint=function(){var e=this.startPosition;this.startPoint=this.startElement?this.calcConnectPoint(this.startElement,e,this.startType):e},t.prototype.updateEndPoint=function(){var e=this.endPosition;this.endPoint=this.endElement?this.calcConnectPoint(this.endElement,e,this.endType):e},t.prototype.calcConnectPoint=function(e,t,n){return this.globalTransform.applyInverse(e.getGlobalPointByPercentOffset(t,{attachedType:n}))},t.prototype._update_endPosition=function(e){this.endPosition=e,this.updateEndPoint()},t.prototype.bindRefSystem=function(t){e.prototype.bindRefSystem.call(this,t),(this.startElement||this.endElement)&&(this.startElement&&this.updateStartPoint(),this.endElement&&this.updateEndPoint(),this.updateDrawPath())},t.prototype.updateTransform=function(){var t=this.startElement&&this.startElement.parentRefSystem!==this.parentRefSystem,n=this.endElement&&this.endElement.parentRefSystem!==this.parentRefSystem;(t||n)&&(t&&this.updateStartPoint(),n&&this.updateEndPoint(),this.updateDrawPath()),this.startElement||this.endElement||e.prototype.updateTransform.call(this)},t.prototype.getOnsidePointByRadialAndBorderBox=function(e,t,n){switch(180*t/Math.PI){case 0:return{x:n.right,y:e.y};case 90:return{x:e.x,y:n.top};case 180:return{x:n.left,y:e.y};default:return{x:e.x,y:n.bottom}}},t.prototype.updateLinePath=function(){var e=this,t=e.startPoint,n=e.endPoint,i=e.breakPointData;if(3===this.lineType){var r={x:O=0,y:F=0},o={x:z=n.x-t.x,y:H=n.y-t.y},a=2===this.startType,s=2===this.endType;if(this.startElement&&a&&(this.startRadius=this.startElement.getConnectionPointAngle(this.startPosition,this.lineType)),this.endElement&&s&&(this.endRadius=this.endElement.getConnectionPointAngle(this.endPosition,this.lineType)),this.breakPointData.points.length){var l=this.breakPointData.points.map((function(e){return{x:e.x-t.x,y:e.y-t.y,radius:0}})),c=l[0],u={x:c.x,y:c.y};c.radius=$t(u);for(var d=1;d<l.length;d++){var p=$t(k=xn(C=l[d],S=l[d-1])),h=S.radius,f=en(h,p)-h;S.radius+=f;var m=En(S,wn(tn(k,S.radius),.4));C.radius=$t(xn(C,m))}var v=l[l.length-1],g=xn({x:z,y:H},v);v.radius=en(v.radius,$t(g));var y=[],b=void 0;if(b=xn(c,wn(tn(u,c.radius),.3)),this.startElement&&a){var E=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2)),x=this.startRadius,w={x:O-E/2*Math.cos(x),y:F+E/2*Math.sin(x)};y.push(r,w,b,c)}else y.push(r,r,b,c);for(d=1;d<l.length;d++){var C,S,k=xn(C=l[d],S=l[d-1]);y.push(En(S,wn(tn(k,S.radius),.4)),xn(C,wn(tn(k,C.radius),.4)),C)}if(b=En(v,wn(tn(g,v.radius),.3)),this.endElement&&s){var _=l[l.length-1],T=(E=Math.sqrt(Math.pow(z-_.x,2)+Math.pow(H-_.y,2)),this.endRadius),I={x:z-E/2*Math.cos(T),y:H+E/2*Math.sin(T)};y.push(b,I,o)}else y.push(b,o,o);this.drawPath=y,this.startElement&&a||(this.startRadius=nn(y[2],y[0])),this.endElement&&s||(this.endRadius=nn(y[y.length-3],y[y.length-1]))}else{if(E=Math.sqrt(Math.pow(z,2)+Math.pow(H,2)),w={x:0,y:0},I={x:0,y:0},a)x=this.startRadius,w={x:O-E/3*Math.cos(x),y:F+E/3*Math.sin(x)},s?(T=this.endRadius,w={x:O-E/2*Math.cos(x),y:F+E/2*Math.sin(x)},I={x:z-E/2*Math.cos(T),y:H+E/2*Math.sin(T)}):(I={x:w.x,y:w.y},this.endRadius=nn({x:w.x,y:w.y},{x:z,y:H}));else if(s)T=this.endRadius,I={x:(w={x:z-E/3*Math.cos(T),y:H+E/3*Math.sin(T)}).x,y:w.y},this.startRadius=nn({x:w.x,y:w.y},{x:O,y:F});else{T=nn(t,n);var P=Math.round(T/(Math.PI/2));this.endRadius=P*(Math.PI/2),this.startRadius=rn(this.endRadius+Math.PI),(0!=z?Math.abs(H/z):1)<=1?(w={x:z/2,y:F},I={x:z/2,y:H}):(w={x:O,y:H/2},I={x:z,y:H/2})}this.drawPath=[{x:O,y:F},w,I,{x:z,y:H}]}this.breakPoints=R([],this.breakPointData.points,!0),this.drawPoints=R(R([this.startPoint],this.breakPoints,!0),[this.endPoint],!1)}else{if(2!==this.lineType||0!==i.points.length&&i.startDirection){if(2===this.lineType){var N=this.breakPointData,M=N.points,A=N.startDirection;(l=R([],M,!0))[0]="vertical"===A?{x:t.x,y:l[0].y}:{x:l[0].x,y:t.y};var D=M.length%2==0?A:"vertical"===A?"horiz":"vertical";l[M.length-1]="vertical"===D?{x:n.x,y:l[M.length-1].y}:{x:l[M.length-1].x,y:n.y},this.drawPoints=R(R([t],l,!0),[n],!1),this.breakPoints=R([],l,!0),this.squareLineDirection=A}else if(1===this.lineType||4===this.lineType){var B=this.breakPointData.points;this.drawPoints=R(R([t],B,!0),[n],!1),this.breakPoints=R([],B,!0)}}else{var L=[],O=0,F=0,z=n.x-t.x,H=n.y-t.y;if(T=nn(t,n),T=rn((P=Math.round(T/(Math.PI/2)))*(Math.PI/2)),x=rn(T+Math.PI),a=2===this.startType,s=2===this.endType,a||(this.startRadius=x),s||(this.endRadius=T),this.startElement||this.endElement){var U=t,W=n,V=null,j=null,G=this.globalTransform;if(this.startElement&&(V=Sn(V=G.applyBorderBoxInverse(this.startElement.getGlobalBox()),V.rotate||0),a?this.startRadius=this.startElement.getConnectionPointAngle(this.startPosition,this.lineType):U=this.getOnsidePointByRadialAndBorderBox(t,rn(this.startRadius+Math.PI),V)),this.endElement&&(j=Sn(j=G.applyBorderBoxInverse(this.endElement.getGlobalBox()),j.rotate||0),s?this.endRadius=this.endElement.getConnectionPointAngle(this.endPosition,this.lineType):W=this.getOnsidePointByRadialAndBorderBox(n,rn(this.endRadius+Math.PI),j)),V&&j){var q=180*this.startRadius/Math.PI,K=180*this.endRadius/Math.PI,Y=Math.abs(q-K),X=Y%360==0,Q=!X&&Y%180==0,Z=vN,J=0;X?180===q&&180===K?J=5:0===q&&0===K?J=4:90===q&&90===K?J=1:270===q&&270===K&&(J=0):Q?(Z=gN,180===q&&0===K?J=5:0===q&&180===K?J=4:90===q&&270===K?J=1:270===q&&90===K&&(J=0)):!X&&!Q&&(Z=yN,180===q&&270===K?J=5:180===q&&90===K?J=7:0===q&&270===K?J=4:0===q&&90===K?J=6:270===q&&0===K?J=0:270===q&&180===K?J=2:90===q&&0===K?J=1:90===q&&180===K&&(J=3)),L=Z(U,V,W,j,J)}else{var $=V||j,ee=null===V,te=ee?W:U,ne=ee?U:W;J=0,180==(q=180*(ee?this.endRadius:this.startRadius)/Math.PI)?J=5:0===q?J=4:90===q?J=1:270===q&&(J=0),L=function(e,t,n,i){var r,o,a,s,l,c,u,d;void 0===i&&(i=5);var p=mN(i),h=p.isStartPositive,f=p.isHorizontal,m=e,v=t,g="x",y="y",b="left",E="bottom",x="top",w=30;f||(g="y",y="x",E="right",b="top",x="left"),h||(w=-30);var C=m[g],S=m[y],k=v[g],_=v[y],T=n[E],I=n[b],P=n[x],N=k-I,M=_-T,A=_-P,D=_-S,R=k-C;h||(R=C-k,N=I-k);var B=[];if(Ot(v,n)){var L=((r={})[g]=k,r[y]=S,r);B.push(L)}else if(R>0&&(R>=30||D>=0&&M<30||A>-30&&D<0)){var O=t.x-e.x,F=t.y-e.y,z=0!=O?Math.abs(F/O):1;if(f&&z<=1||!f&&z>=1){var H=(C+k)/2,U=((o={})[g]=H,o[y]=S,L=o,(a={})[g]=H,a[y]=_,a);B.push(L,U)}else(s={})[g]=k,s[y]=S,L=s,B.push(L)}else if((l={})[g]=C+w,l[y]=S,L=l,(M>0||A<0)&&(M>30||A<-30||N>-30))(c={})[g]=L[g],c[y]=_,U=c,B.push(L,U);else{var W=T+30;_-S<0&&(W=P-30),(u={})[g]=L[g],u[y]=W,U=u;var V=((d={})[g]=k,d[y]=W,d);B.push(L,U,V)}return B}(te,ne,$,J),ee&&L.reverse()}}else 0!==z&&0!==H&&(L=Math.abs(H/z)<=1?[{x:t.x+z/2,y:t.y+F},{x:t.x+z/2,y:t.y+H}]:[{x:t.x+O,y:t.y+H/2},{x:t.x+z,y:t.y+H/2}]);var ie=180*this.startRadius/Math.PI;this.squareLineDirection=0===ie||180===ie?"horiz":"vertical",this.drawPoints=R(R([t],L,!0),[n],!1),this.breakPoints=R([],L,!0)}var re=this.filterPoints(this.drawPoints);this.startRadius=nn(exports.E({},re[1]),exports.E({},re[0])),this.endRadius=nn(exports.E({},re[re.length-2]),exports.E({},re[re.length-1]))}this.updateControlPoints()},t.prototype.updateDrawPath=function(e){var t=this,n=void 0===e?{}:e,i=n.doUpdateLinePath,r=void 0===i||i,o=n.doUpdateArrowPath,a=void 0!==o&&o;r&&this.updateLinePath();var s=this.startArrow,l=this.endArrow;if(r||a){if(0!==s||0!==l){var c=this.lineWidth,u=it[0],d=70/(it[it.length-1]-u)*(c-u)+30,p=function(){for(var e=[],n=1;n<t.drawPoints.length;n++){var i=fn(t.drawPoints[n-1],t.drawPoints[n]);yn(0,i)||e.push(i)}return 0===e.length&&e.push(0),0!==s&&0!==l?1===e.length?e[0]/2:Math.min(e[0],e[e.length-1]):0!==s?e[0]:e[e.length-1]}(),h=p>=d;this.displayLineWidth=h?c:Math.max(.1,c+c/d*(p-d));var f=ip*(c-u)+16;h||(f+=f/d*(p-d),f=Math.max(2,f)),this.arrowSideLength=f}else this.displayLineWidth=this.lineWidth;if(0!==s&&4!==this.lineType){if(this.startArrowPath=this.getArrowPath(this.startPoint,this.startRadius,s),this.startArrowDrawPath=this.getArrowDrawPath(this.startArrowPath),3===this.lineType){var m=this.getPointAndSideLengthByArrowPath(s,this.startArrowDrawPath).point,v=exports.E({},this.drawPath[1]);v.x+=m.x-this.drawPath[0].x,v.y+=m.y-this.drawPath[0].y,this.drawPath=R([m,v],this.drawPath.slice(2),!0)}}else this.startArrowPath=null,this.startArrowDrawPath=null,3===this.lineType&&(this.drawPath=R([{x:0,y:0}],this.drawPath.slice(1),!0));if(0!==l&&4!==this.lineType){if(this.endArrowPath=this.getArrowPath(this.endPoint,this.endRadius,l),this.endArrowDrawPath=this.getArrowDrawPath(this.endArrowPath),3===this.lineType){var g=this.getPointAndSideLengthByArrowPath(l,this.endArrowDrawPath).point,y=this.drawPath.length,b=exports.E({},this.drawPath[y-2]);b.x+=g.x-this.drawPath[y-1].x,b.y+=g.y-this.drawPath[y-1].y,this.drawPath=R(R([],this.drawPath.slice(0,-2),!0),[b,g],!1)}}else this.endArrowPath=null,this.endArrowDrawPath=null,3===this.lineType&&(this.drawPath=R(R([],this.drawPath.slice(0,-1),!0),[xn(this.endPoint,this.startPoint)],!1))}this.updateLineRects(),this.updateBorderBox(),this.updateDrawLengthInfo(),this.updateControlPoints()},t.prototype.handleAttachedElementChanged=function(){this.startElement&&this.updateStartPoint(),this.endElement&&this.updateEndPoint(),this.updateDrawPath()},t.prototype.updateControlPoints=function(){var e=[],t=this,n=t.breakPointData,i=t.breakPoints,r=t.startPoint,o=t.endPoint;if(2===this.lineType){var a=0===n.points.length||!n.startDirection,s="horiz"!==this.squareLineDirection?"horiz":"vertical";if(0===i.length)e.push(exports.E(exports.E({},vn(r,o)),{isNew:!0,direction:s}));else{e.push(exports.E(exports.E({},vn(r,i[0])),{isNew:!0,direction:s}));for(var l=0;l<i.length-1;l++)s="vertical"===s?"horiz":"vertical",e.push(exports.E(exports.E({},vn(i[l],i[l+1])),{isNew:a,direction:s}));s="vertical"===s?"horiz":"vertical",e.push(exports.E(exports.E({},vn(o,i[i.length-1])),{isNew:!0,direction:s}))}}else if(1===this.lineType)if(0===i.length)e.push(exports.E(exports.E({},vn(r,o)),{isNew:!0}));else{for(e.push(exports.E(exports.E({},vn(r,i[0])),{isNew:!0})),l=0;l<i.length-1;l++)e.push({x:i[l].x,y:i[l].y},exports.E(exports.E({},vn(i[l],i[l+1])),{isNew:!0}));e.push({x:i[i.length-1].x,y:i[i.length-1].y},exports.E(exports.E({},vn(o,i[i.length-1])),{isNew:!0}))}else if(3===this.lineType){var c=this.drawPath,u=this.startPoint,d=function(e){var t=un(c[3*e],c[3*e+1],c[3*e+2],c[3*e+3],.5);return En(u,t)};if(0===i.length)e.push(exports.E(exports.E({},d(0)),{isNew:!0}));else for(e.push(exports.E(exports.E({},d(0)),{isNew:!0})),l=0;l<i.length;l++)e.push({x:i[l].x,y:i[l].y},exports.E(exports.E({},d(l+1)),{isNew:!0}))}this.controlPoints=e},Object.defineProperty(t.prototype,"extraSensitivation",{get:function(){return _e.desktop?8:36},enumerable:!1,configurable:!0}),t.prototype.updateTexts=function(e){var t=this;this.texts=e,e.forEach((function(e){var n=t.textNodes.get(e.id)||new TN(t.upime,e,t);n.updateInfo(e),t.textNodes.has(e.id)||t.textNodes.set(e.id,n)}));var n=e.map((function(e){return e.id}));this.textNodes.forEach((function(e,i){n.includes(i)||(e.destroy(),t.textNodes.delete(i))}))},t.prototype.updateDrawLengthInfo=function(){if(4!==this.lineType){var e=3===this.lineType?this.getBezierLengthInfo():this.getStraightLengthInfo(),t=e.reduce((function(e,t){return e+t.lineLength}),0);this.lineLengthInfoList=[];for(var n=0,i=0,r=0;r<e.length;r++){var o=e[r],a=(n+o.lineLength)/t;this.lineLengthInfoList.push(exports.E(exports.E({},o),{startOffset:i,endOffset:a})),n+=o.lineLength,i=a}}},t.prototype.getStraightLengthInfo=function(){for(var e=[],t=this.drawPath[0],n=1;n<this.drawPath.length;n++){var i=t,r=this.drawPath[n],o=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2));e.push({start:i,end:r,lineLength:o,type:"straight"}),t=r}return e},t.prototype.getBezierLengthInfo=function(){for(var e=this.drawPath,t=[],n=1;n<e.length;n+=3){var i=exports.E({},e[n-1]),r=exports.E({},e[n]),o=exports.E({},e[n+1]),a=exports.E({},e[n+2]),s=On(i,r,o,a);t.push({start:i,end:a,c1:r,c2:o,lineLength:s,type:"bezier"})}return t},t.prototype.getCurrentEditingTextNode=function(){var e=this.selectedTextId;if(!e)return null;var t=this.textNodes.get(e);return t&&t.isEditing?t:null},t.prototype.checkLineTextRelation=function(e,t){var n={x:e.x-this.startPoint.x,y:e.y-this.startPoint.y},i=Array.from(this.textNodes.values()).find((function(e){return e.checkPointInText(n)}));return i?{transparent:!1,metric:-1,metaData:{notAllowed:!1,clickData:{lineText:{id:i.id}}}}:null},t.prototype.getNestestPointOffset=function(e){var t={x:e.x-this.startPoint.x,y:e.y-this.startPoint.y},n=this.lineLengthInfoList,i=Number.MAX_SAFE_INTEGER,r=0,o=n[0];return n.forEach((function(e){if("straight"===e.type){var n=Bn(e.start,e.end,t);if((f=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)))<i){i=f;var a=0;e.end.x!==e.start.x?a=(n.x-e.start.x)/(e.end.x-e.start.x):e.end.y!==e.start.y&&(a=(n.y-e.start.y)/(e.end.y-e.start.y)),r=e.startOffset+a*(e.endOffset-e.startOffset),o=e}}else{var s=e.start,l=e.c1,c=e.c2,u=e.end,d=Math.max(20,Math.min(Math.round(2*e.lineLength),200)),p=pn(t,s,l,c,0,1,d,u),h=(n=p.point,p.minT),f=p.distance;n&&f<i&&(i=f,r=e.startOffset+h*(e.endOffset-e.startOffset),o=e)}})),r=Math.max(0,Math.min(1,r)),{distance:i,offset:r,lineInfo:o}},t.prototype.getDefaulTextColor=function(){var e,t;return(null===(t=null===(e=this.texts[0])||void 0===e?void 0:e.content[0])||void 0===t?void 0:t[1].color)||1710618},t.prototype.dealClickStart=function(t){var n,i;if(null===(n=t.metaData)||void 0===n?void 0:n.clickData){var r=t.metaData.clickData.lineText;if(r&&!this.selectedTextId){this.upime.selectElement(this),this.selectedTextId=r.id;var o=this.textNodes.get(r.id);!(null===(i=this.currentEditor)||void 0===i?void 0:i.frozed)&&o&&this.upime.view.setConnectedRichEditor(o.richTextClient.contentEditor)}}e.prototype.dealClickStart.call(this,t)},t.prototype.searchText=function(e){e=e.toLowerCase();for(var t=0,n=this.texts;t<n.length;t++){var i=n[t].content.map((function(e){return e[0].join("")})).join("");if(i.toLocaleLowerCase().includes(e))return i}return""},t}(ry),PN=function(e){var t=e.element,n=e.position,i=t.size.width*t.scale;Ra(t.useMemo("nameText",(function(){return{text:t.name,textWidth:i,lineHeight:20,fontSize:14,fontFamily:He,textOverflow:"ellipse",lineClamp:1}}),[i,t.name]),{x:n.x,y:n.y-20-6,fill:"#0C1024"})},NN=function(e){var t=e.position,n=e.size,i=e.scale,r=e.titleHeight,o=js.value,a=o.exportType,s=o.renderApp,l=o.viewbox,c={width:n.width*i,height:n.height*i},u=n.height*i*l.scale,d=a&&e.exportPageFile?e.exportPageFile:e.currentPageFile,p=d&&pf({imageFile:d,realHeight:u,exportType:a,renderTarget:e}),h=hf(e,1,[i]),f=l.scale,m=c.width,v=c.height+r*i,g=m/480;function y(){if(1!==e.parseStatus){var t=void 0,n=void 0;if(2===e.parseStatus){var i=(e.estimateCompleteTime||0)-e.upime.getCurServerTime(),r=1;i>6e4&&(null==s||s(i%6e4,e),r=Math.floor(i/6e4)+1),t=O("document.parsingPrompt",r),n=Df}else t=O("document.parsingFailedPrompt"),n=Rf;fa({scaleX:g,scaleY:g});var o=c.height/g;Na((function(e){e.clear(),e.beginFill(14408670),e.drawRect(0,0,480,o),e.endFill()}));var l=(o-88)/2;Oa({x:220,y:l,width:40,height:40,src:n}),Ra({text:t,fontSize:14,lineHeight:22,fontFamily:He},{x:240,y:l+60,ha:"center",fill:"#303445"}),ma()}else e.pptPlayer&&!a?Ua({x:0,y:0,width:c.width,height:c.height}):(null==p?void 0:p.loaded)||"svg"===a?Oa({width:c.width,height:c.height,src:p}):!a&&s&&(fa({scaleX:1/f,scaleY:1/f}),gp({width:c.width*f,height:c.height*f,beginTime:e.beginLoadTime,name:e.name,renderTarget:e}),ma())}gf(e,h);var b=[["M",m,0],["L",m,v],["L",0,v],["L",0,0],["Z"]];e.titleHeight?(fa({x:t.x,y:t.y}),za([new Sa(b)]),function(){var t;switch(fa({scaleX:g,scaleY:g}),Na((function(e){e.clear(),e.beginFill(16119542),e.drawRect(0,0,480,26),e.endFill(),e.lineStyle(1,15527150),e.moveTo(0,25.5),e.lineTo(480,25.5)})),e.fileType){case 1:default:t=Cf;break;case 2:case 5:t=Sf;break;case 4:t=kf;break;case 3:t=_f}Oa({src:t,x:8,y:3,width:20,height:20});var n=(e.totalPage>1&&2!==e.mode||5===e.fileType)&&1===e.parseStatus;if(5!==e.fileType||e.pptPlayer||(n=!1),Ra(e.useMemo("nameText",(function(){return{text:e.name,textWidth:n?320:406,lineHeight:18,fontSize:10,lineClamp:1,textOverflow:"ellipse",fontFamily:He}}),[e.name,n]),{x:36,y:4,fill:"#0C1024"}),n){e.prevBtn.disabled=!e.canPrevStep,e.prevBtn.render();var i=e.currentPage+"/"+e.totalPage;Ra(e.useMemo("pageInfo",(function(){return{text:i,textWidth:34,lineHeight:18,fontSize:10,lineClamp:1,textOverflow:"ellipse",fontFamily:He}}),[i]),{x:386,y:4,fill:"#0C1024",ha:"center"}),e.nextBtn.disabled=!e.canNextStep,e.nextBtn.render()}else e.prevBtn.disabled=!0,e.nextBtn.disabled=!0;e.maxBtn.render(),ma()}(),fa({x:0,y:r*i}),y(),ma(),void 0===a&&!1!==e.upime.view.isImmersivePlaying&&e.upime.view.playingElement===e||(fa({stroke:"#D8D8D8",lineWidth:2*g}),Ta(b),ma()),ma()):(2!==e.mode&&PN({element:e,size:c,position:t}),fa(exports.E({},t)),y(),fa({stroke:"#D8D8D8",lineWidth:2*g}),za([new Sa(b)]),Ta(b),ma(),ma()),ma()};function MN(t){var n=t.defaultValue,i=void 0===n?"":n,r=t.onChanged,o=t.readonly,a=void 0!==o&&o,s=t.nameCtrl,l=e.useRef(null),c=e.useRef(null);e.useEffect((function(){l.current&&(l.current.value=i),u()}),[i]),e.useEffect((function(){var e=l.current,t=null==s?void 0:s.bindSimpleText(e);return function(){var n=e.value.trim();""!==n&&r(n),null==t||t()}}),[]);var u=function(){if(c.current&&l.current){c.current.innerHTML=l.current.value.trim();var e=c.current.scrollWidth+10,t=Math.min(Math.max(36,e),155);l.current.style.width=t+"px"}},d=e.useContext(Zg),p=d.disableAutoHide,h=d.enableAutoHide,f=e.useCallback((function(){u()}),[]),m=e.useCallback((function(){var e,t=null===(e=l.current)||void 0===e?void 0:e.value;""!==t.trim()?r(t):l.current&&(l.current.value=i,u()),h()}),[i]);return e.createElement("div",{className:oc},e.createElement("div",{className:ac,ref:c}),e.createElement("input",{ref:l,className:sc,defaultValue:i,readOnly:a,title:i,onChange:f,onBlur:m,onFocus:function(){p()},onKeyUp:function(e){var t;e.stopPropagation(),"Enter"===e.code&&(null===(t=l.current)||void 0===t||t.blur())},spellCheck:"false",draggable:"false"}))}var AN={"page-switcher":"page-switcher_2kbRL",arrow:"arrow_YQx8_",disabled:"disabled_1EiYV",prev:"prev_2jL8B",next:"next_1b54R",page:"page_2b4WP","current-page":"current-page_tr-wQ","page-total":"page-total_BUC8w","pin-start-page":"pin-start-page_3-DLn",pin:"pin_3GJni","pinning-page":"pinning-page_3oZPa","pinning-page-item":"pinning-page-item_3b2Vt","pinning-page-item-hoverable":"pinning-page-item-hoverable_uMwDn",divider:"divider_Q7GM9",currentStartPage:"currentStartPage_38Frz",goToStartPage:"goToStartPage_3RFt3",pageExtractor:"pageExtractor_2hxe0",radioGroup:"radioGroup_ta09k",extractAllLabel:"extractAllLabel_3ufYq",extractBtn:"extractBtn_3LGZF",paginatorRoot:"paginatorRoot_2zLaL",widget:"widget_21_1j",left:"left_1ojXV",right:"right_x3hfc",paginator:"paginator_1NoBo",insertExcelChooseModalBox:"insertExcelChooseModalBox_1ojyh",titleRow:"titleRow_2LXkd",iconRow:"iconRow_1FN7k",item:"item_3VxJ-",bg:"bg_3p6EL",btn:"btn_3isDD",first:"first_3oz8Y",descRow:"descRow_1WJuM",page_switcher:"page-switcher_2kbRL",current_page:"current-page_tr-wQ",page_total:"page-total_BUC8w",pin_start_page:"pin-start-page_3-DLn",pinning_page:"pinning-page_3oZPa",pinning_page_item:"pinning-page-item_3b2Vt",pinning_page_item_hoverable:"pinning-page-item-hoverable_uMwDn"};function DN(t){var n=t.element,i=e.useRef(null),r=e.useContext(Zg),o=r.disableAutoHide,a=r.enableAutoHide,s=n.element,l=s.currentPage,c=s.totalPage;return e.useEffect((function(){i.current.value="".concat(l)}),[l]),e.createElement("div",{className:j(Ml.cm_item,AN.page_switcher)},e.createElement("div",{className:j(Ml.cm_item,AN.arrow,AN.prev,s.canPrevStep?"":AN.disabled),onClick:function(){s.canPrevStep&&s.gotoPrevStep()}},e.createElement("span",null)),e.createElement("div",{className:AN.page},e.createElement("input",{ref:i,type:"text",maxLength:"".concat(c).length,className:AN.current_page,defaultValue:l,onChange:function(){var e=i.current,t=e.value;if(t&&/^\d+$/.test(t)){var n=Mn(1,Number(t),c);s.gotoPage(n),e.value="".concat(n)}},onBlur:function(){var e=i.current;if(e){var t=e.value;if(!t||isNaN(Number(t)))s.gotoPage(1),e.value="1";else{var n=Mn(1,Number(t),c);s.gotoPage(n),e.value="".concat(n)}}a()},onFocus:function(){o()},onKeyPress:function(e){if("Enter"===e.key)return e.preventDefault(),e.stopPropagation(),void e.target.blur()}}),"/",e.createElement("div",{className:AN.page_total},c)),e.createElement("div",{className:j(Ml.cm_item,AN.arrow,AN.next,s.canNextStep?"":AN.disabled),onClick:function(){s.canNextStep&&s.gotoNextStep()}},e.createElement("span",null)))}function RN(t){var n=t.element,i=W().getUpimeTrans,r=n.element,o=r.startPage,a=r.currentPage,s=yh(!0),l=s.hide,c=s.toggleHide,u=s.setHide,d=s.skipRef,p=e.useCallback((function(){u(!0),o!==a&&r.gotoPage(o)}),[o,a]),h=e.useCallback((function(){o!==a&&n.setStartPage(a)}),[o,a]),f=o===a||n.isHandMode;return e.createElement("div",{className:j(Ml.cm_item,AN.pin_start_page),ref:d},e.createElement(Dl,{placement:"top",content:i("document.setStartPage")},e.createElement("div",{className:j(Ml.cm_item,AN.pin)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:c},e.createElement(hl,{icon:"shuqian"})))),!l&&e.createElement(xh,{align:"right",className:AN.pinning_page},e.createElement("div",{className:j(Ml.cm_item,AN.pinning_page_item),onClick:p},e.createElement("div",{className:AN.currentStartPage},"".concat(i("document.startPageIs"),"：").concat(o)),e.createElement("div",{className:AN.goToStartPage},i("document.goToStartPage"))),e.createElement("div",{className:AN.divider}),e.createElement("div",{className:j(Ml.cm_item,AN.pinning_page_item,AN.pinning_page_item_hoverable,f?AN.disabled:""),onClick:h},e.createElement("div",{className:AN.text},i("document.setAsStartPage")))))}var BN=function(t){var n=t.element,i=W().getUpimeTrans,r=n.element,o=yh(!0),a=o.hide,s=o.toggleHide,l=o.skipRef,c=e.useState(!1),u=c[0],d=c[1],p=e.useRef([]),h=e.useState(!1),f=h[0],m=h[1],v=e.useState("all"),g=v[0],y=v[1],b=e.useContext(Zg),E=b.disableAutoHide,x=b.enableAutoHide,w=e.useCallback((function(e){"all"===e?(d(!1),y("all")):(d(!0),y("custom"))}),[]),C=e.useMemo((function(){return{name:"extract_mode",configs:[{label:i("document.extractAllOption"),value:"all",className:AN.extractAllLabel},{value:"custom"}],onChange:w,className:AN.radioGroup,value:g}}),[g]);return e.createElement("div",{className:j(Ml.cm_item,AN.pin_start_page),ref:l},e.createElement(Dl,{placement:"top",content:i("document.extract")},e.createElement("div",{className:j(Ml.cm_item,AN.pin)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:s},e.createElement(hl,{icon:"pingpu"})))),!a&&e.createElement(xh,{align:"center",className:AN.pageExtractor},e.createElement("span",null," ",i("document.extractPanelTitle")," "),e.createElement(zl,{radioGroupConfig:C,value:g}),e.createElement("input",{placeholder:i("document.extractPanelInputHint"),onChange:function(e){return function(e){if(!/^[\d,-]*$/.test(e))return m(!0),void d(!0);var t=new Set,n=!1;if(e.split(",").forEach((function(i){if(/^\d+-\d+$/.test(e)||/\d+$/.test(e)){var o=i.split("-").sort((function(e,t){return+e-+t})).map((function(e){return+e>r.totalPage&&(n=!0),+e}));2===o.length?new Array(o[1]-o[0]+1).fill(null).forEach((function(e,n){t.add(o[0]+n)})):t.add(o[0])}else n=!0})),Array.from(t).some((function(e){return e<=0})))return m(!0),void d(!0);d(n),m(n),p.current=Array.from(t).sort((function(e,t){return e-t}))}(e.target.value)},onFocus:function(){y("custom"),E()},onBlur:function(){x()},className:j(Ml.upimeInput,f&&Ml.invalid)}),e.createElement(ul,{type:"text",className:AN.extractBtn,disabled:u,onClick:function(){return!u&&n.extractPages("all"===g?[]:p.current)}},i("document.extractBtnLabel"))))};function LN(t){var n=t.propEditor,i=e.useCallback((function(e){e!==n.getKeyValue("name")&&n.changeKeyValue("name",e)}),[]);return e.createElement(e.Fragment,null,e.createElement(MN,{defaultValue:n.getKeyValue("name"),onChanged:i,readonly:!n.editable,nameCtrl:n.nameCtrl}),n.canExtract&&e.createElement(e.Fragment,null,e.createElement(DN,{element:n}),e.createElement(RN,{element:n}),n.editable&&e.createElement(BN,{element:n})))}var ON=function(){function e(e){this.editor=e,this.couldAffectGroup=!1,this.startPage=1,this.propertyName="documentInfo",this.renderer=LN,this.isHandMode=!1,this._unsub=null,this.renderKey=this.propertyName;var t=this.editor.element;this.element=t,this.startPage=t.startPage,this.totalPage=t.totalPage}return Object.defineProperty(e.prototype,"editable",{get:function(){return this.editor.editable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.editor.element.currentPage||1},set:function(e){this.editor.element.currentPage=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nameCtrl",{get:function(){return this.editor.nameCtrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canExtract",{get:function(){var e=this.element;return e.totalPage>1&&2!==e.mode&&1===e.parseStatus},enumerable:!1,configurable:!0}),e.prototype.getKeyValue=function(e){return this.editor.getPropertyValue(e)},e.prototype.changeKeyValue=function(e,t){var n;this.editor.updateProperty(((n={})[e]=t,n))},e.prototype.setStartPage=function(e){this.startPage=this.editor.element.startPage=e,this.changeKeyValue("startPage",e)},e.prototype.extractPages=function(e){var t=this,n=this.editor.element,i=this.editor.upime.createOperation(),r=[],o=1+(0|(e.length||n.totalPage/10)),a=(e.length||n.totalPage)>=10?10:e.length||n.totalPage,s=n.fileType;5===s&&(s=2),e.length?e.forEach((function(e,o){r.push(i.create(Za.DOCUMENT,{position:{x:n.position.x+(n.size.width*n.scale+10)*(o%10),y:n.position.y+(n.size.height*n.scale+10)*(1+(o/10|0))},fileId:n.fileId,fileType:s,size:n.size,scale:n.scale,startPage:e,totalPage:n.totalPage,zIndex:t.editor.upime.newMaxZindex(),name:n.name,mode:2}))})):new Array(n.totalPage).fill(null).forEach((function(e,o){r.push(i.create(Za.DOCUMENT,{position:{x:n.position.x+(n.size.width*n.scale+30)*(o%10),y:n.position.y+(n.size.height*n.scale+30)*(1+(o/10|0))},fileId:n.fileId,fileType:s,size:n.size,scale:n.scale,startPage:o+1,totalPage:n.totalPage,zIndex:t.editor.upime.newMaxZindex(),name:n.name,mode:2}))})),i.sync(),this.editor.upime.selectElements(r),this.editor.upime.makeBorderInSight({left:n.position.x,right:n.position.x+(n.size.width*n.scale+10)*a,top:n.position.y,bottom:n.position.y+(n.size.height*n.scale+10)*o},{left:100,right:100,top:50,bottom:50,duration:100})},e.prototype.unselect=function(){var e;null===(e=this._unsub)||void 0===e||e.call(this)},e}(),FN=function(){function e(){}return e.prototype.bindSimpleText=function(e){var t=this;return this._nameInput=e,function(){t._nameInput=void 0}},e.prototype.selectName=function(){this._nameInput&&this._nameInput.select()},e}(),zN=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.infoEditor=null,r.infoEditor=new ON(r),r.infoEditor.isHandMode=r.isHandMode,t.phoneMode&&"phone"===r.phoneToolbarMode||r.propertyEditors.push(r.infoEditor),r.nameCtrl=new FN,r}return P(t,e),Object.defineProperty(t.prototype,"supportDownload",{get:function(){return this.upime.userManager.enableDownloadFile},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return[]},enumerable:!1,configurable:!0}),t.prototype.getMinSize=function(){return 18},t.prototype.dealBorderResize=function(e,t){var n=t.left,i=t.top,r=(t.right-n)/this.element.size.width,o=this.element.position;this.updateSelf({position:exports.E(exports.E({},o),{x:n,y:i}),scale:r})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.supportLinkTo=function(){return!0},t.prototype.unselect=function(){this.infoEditor&&this.infoEditor.unselect(),e.prototype.unselect.call(this)},t.prototype.doRename=function(){var e;null===(e=this.nameCtrl)||void 0===e||e.selectName()},t.prototype.doDelete=function(t){var n=this;e.prototype.doDelete.call(this,t);var i=this.element,r=i.totalPage,o=i.mode,a=i.startPage,s=2===o||1===r?[a]:Array(r).fill(void 0).map((function(e,t){return t+1})),l=s.map((function(e){return n.upime.elementManager.getDocumentPageRS(n.element.id,e)})).map((function(e){return e.children.filter((function(e){return e instanceof ry}))})).flat();l.forEach((function(e){new e.editorType(n.upime,e).doDelete(t)}))},t}(Ob);function HN(e,t,n){void 0===n&&(n=0);var i={lineHeight:20,fontSize:14,fontFamily:He},r=e.position,o=r.x,a=r.y,s=e.size,l=e.name;return!!Ot(t,{left:o,right:o+Math.min(Math.max(ji(l,i),n),s.width*e.scale),top:a-26,bottom:a-6})}var UN=function(){function e(e,t,n,i){this.element=e,this.name=t,this.iconSource=n,this.iconSource2=i,this.show=!0,this.hovering=!1,this.disabled=!1,this.x=0,this.y=0,this.width=22,this.height=22,this.iconSize=12,this.on=!1}return Object.defineProperty(e.prototype,"extraSensitiveDistance",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSource",{get:function(){return this.on&&this.iconSource2||this.iconSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tip",{get:function(){return this._tipStr},set:function(e){this._tipStr=e},enumerable:!1,configurable:!0}),e.prototype.render=function(){var e=this,t=this,n=t.x,i=t.y,r=t.width,o=t.height,a=t.iconSize;if(!this.disabled&&this.hovering&&void 0===this.bgColor&&Na((function(t){t.beginFill(15132649,1),t.drawRoundedRect(n,i,r,o,e.hoverBorderRadius||4)})),this.currentSource){var s=(r-a)/2;fa({alpha:this.disabled?.3:1});var l=this.bgColor;void 0!==l&&Na((function(t){t.beginFill(l,e.bgOpacity||1),t.drawRoundedRect(n,i,r,o,e.bgBorderRadius||2)})),Oa({src:this.currentSource,x:n+s,y:i+s,width:a,height:a}),ma()}},e.prototype.checkRelation=function(e,t){if(this.disabled)return null;var n=this.extraSensitiveDistance;return Ot(e,{left:this.x-n,top:this.y-n,right:this.x+this.width+n,bottom:this.y+this.height+n})?{name:this.name}:null},e.prototype.dealClick=function(e){var t;null===(t=this.onclick)||void 0===t||t.call(this)},e.prototype.dealHoverStart=function(e){this.hovering=!0},e.prototype.dealHoverEnd=function(){this.hovering=!1},e.prototype.getHoverPoint=function(){return{x:this.x+this.width/2,y:this.y}},e}(),WN=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=t,r}return P(t,e),t.prototype.checkRelation=function(t,n){if(!this.element.titleHeight)return null;if(this.disabled)return null;var i=this.element,r=i.scale,o=i.size.width*r/480;return t={x:t.x/o,y:t.y/o},e.prototype.checkRelation.call(this,t,n)},t}(UN),VN="webviewer_border_2EbXP",jN="no_pointer_event_35vfv",GN=function(t){var n=t.viewbox,i=t.element,r=t.zIndex,o=e.useRef(null);e.useEffect((function(){var e=o.current;return i.bindDom(e)}),[]);var a=i.globalTransform,s=i.size.height*i.scale*a.currentScale*n.scale,l=i.size.width*i.scale*a.currentScale*n.scale,c=s/Qe.height,u={x:i.position.x,y:i.position.y+i.titleHeight*i.scale},d={zIndex:r,left:((u=a.apply(u)).x-n.left)*n.scale,top:(u.y-n.top)*n.scale,width:l/c,height:Qe.height,transform:"scale(".concat(c,")"),transformOrigin:"0 0"};return i.mounted||(d.visibility="hidden"),e.createElement("div",{ref:o,className:VN,style:d})},qN=function(){function e(e){this.speed=1,this.canplay=!1,this._src="",this.ended=!1,this.loop=!1,this.__topics={},this.__onceTopics={},this.fakeDuration=0}return Object.defineProperty(e.prototype,"src",{get:function(){return this._src},set:function(e){this.setSrc(e)},enumerable:!1,configurable:!0}),e.prototype.clearM3u8Loader=function(){this.m3u8Loader&&(this.m3u8Loader.detachMedia(),this.m3u8Loader.destroy(),this.m3u8Loader=void 0)},e.prototype._on=function(e,t,n){var i=n?this.__onceTopics:this.__topics;void 0===i[e]&&(i[e]=[]),i[e].indexOf(t)<0&&i[e].push(t)},e.prototype.on=function(e,t){this._on(e,t)},e.prototype.once=function(e,t){this._on(e,t,!0)},e.prototype.off=function(e,t){[this.__topics,this.__onceTopics].forEach((function(n){if(void 0!==n[e]){var i=n[e].indexOf(t);i>=0&&n[e].splice(i,1)}}))},e.prototype.trick=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.__topics,r=this.__onceTopics;[i,r].forEach((function(n){void 0!==n[e]&&n[e].forEach((function(e){e&&e.apply(void 0,t)}))})),void 0!==r[e]&&(r[e].length=0)},e.prototype.createDom=function(){var e=document.createElement("audio");this.attachMedia(e)},e.prototype.attachMedia=function(e){this.dom=e,this.parentNode?(this.parentNode.appendChild(e),e.style.display=""):e.style.display="none"},e.prototype.detachMedia=function(){this.dom&&(this.parentNode&&this.dom.parentNode==this.parentNode&&this.parentNode.removeChild(this.dom),this.dom=void 0),this.canplay=!1,this.clearM3u8Loader(),this.unsub_duration&&this.unsub_duration()},e.prototype.attachParent=function(e){var t=this.dom;this.parentNode=e,t&&(this.parentNode.appendChild(t),t.style.display="")},e.prototype.detachParent=function(e){if(this.parentNode===e){this.parentNode=void 0;var t=this.dom;t&&t.parentNode===e&&e.removeChild(t)}},e.prototype.setSrc=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s=this;return D(this,(function(l){switch(l.label){case 0:return(t=this.dom)?""===e?(this.unsub_duration&&this.unsub_duration(),this._src="",t.src="",this.canplay=!1,this.pause(),[2]):(0!==location.origin.indexOf("http")&&0==e.indexOf("//")&&(e="https:"+e),e===this.src?[2]:(this.canplay=!1,this._src=e,i=function(){(n=t.duration)>0&&n!==1/0&&s.trick("durationchange",n)},this.unsub_duration&&this.unsub_duration(),t.addEventListener("durationchange",i),r=setInterval(i,1e3),this.unsub_duration=function(){t.removeEventListener("durationchange",i),clearInterval(r)},o=function(){t.removeEventListener("canplay",o),t===s.dom&&(s.promiseTime&&(t.currentTime=s.promiseTime),s.canplay=!0,s.trick("canplay"))},t.addEventListener("canplay",o),this.clearM3u8Loader(),_e.isIOS||!/\.m3u8(?!_t)/.exec(e)?[3,2]:[4,sm()])):[2];case 1:(a=l.sent().Hls).isSupported()&&(this.m3u8Loader=new a({maxBufferSize:12e7,maxBufferLength:60}),this.m3u8Loader.loadSource(e),this.m3u8Loader.attachMedia(t)),l.label=2;case 2:return this.m3u8Loader||(t.src=e),t.load(),t.playbackRate=this.speed,[2]}}))}))},e.prototype.play=function(){var e;return A(this,void 0,void 0,(function(){return D(this,(function(t){if(!this.src)throw new DOMException("not src yet");return this.isPlaying||(null===(e=this.dom)||void 0===e||e.play(),this._updateTime()),this.trick("play"),[2]}))}))},e.prototype.pause=function(){var e;this.isPlaying&&(this.clearTimer(),null===(e=this.dom)||void 0===e||e.pause()),this.trick("timeupdate",this.currentTime),this.trick("pause")},e.prototype._updateTime=function(){var e=this;this.clearTimer(),this._timer=fr((function(){e.currentTime>=e.duration?(e.ended=!0,e.pause(),e.trick("timeupdate",e.duration),e.trick("ended"),e.dealPlayEnd()):(e._updateTime(),e.trick("timeupdate",e.currentTime))}))},e.prototype.clearTimer=function(){this._timer&&(mr(this._timer),this._timer=void 0)},Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.speed},set:function(e){this.dom&&(this.dom.playbackRate=e),this.speed=e,this.trick("speedChanged",this.speed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){var e;return(null===(e=this.dom)||void 0===e?void 0:e.currentTime)||0},set:function(e){var t=this.dom,n=this.isPlaying;e>this.duration&&(e=this.duration),this.promiseTime=e,t&&(t.currentTime=e),this.trick("timeupdate",e),this.ended=e==this.duration,this.ended&&(this.trick("ended"),n&&this.dealPlayEnd())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return void 0!==this.dom&&!this.dom.paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){if(!this.dom)return this.fakeDuration;var e=this.dom.duration;return e>0&&e!==1/0?e:this.fakeDuration},set:function(e){this.fakeDuration=e},enumerable:!1,configurable:!0}),e.prototype.dealPlayEnd=function(){this.loop&&(this.currentTime=0,this.play())},e.prototype.destroy=function(){var e=this.dom;if(this.src="",this.clearM3u8Loader(),this.promiseTime=void 0,e){var t=e.parentNode;t&&t.removeChild(e)}},e}(),KN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(qN),YN=function(e){function t(t){return e.call(this,t)||this}return P(t,e),t.prototype.createDom=function(){var e=document.createElement("video");this.attachMedia(e)},t.prototype.attachMedia=function(t){t.setAttribute("playsinline",""),t.setAttribute("webkit-playsinline",""),t.setAttribute("controlsList","nodownload"),e.prototype.attachMedia.call(this,t)},t}(KN),XN="audio_2NVwZ",QN="video_at_K0",ZN="icon_30JMm",JN="active_23rIY",$N="control_3TTsu",eM="label_2dPac",tM="switch_btn_3m_gk",nM="on_2dmvz",iM=function(t){var n=t.playStatus,i=void 0!==n&&n,r=t.onClick,o=t.className;return e.createElement("div",{className:j("play_btn_3TPkC",o),onClick:r},e.createElement(hl,{className:j(ZN),icon:i?"zanting":"bofangqi"}))},rM=function(t){var n=t.isEdit,i=void 0!==n&&n,r=t.onClick,o=t.className,a=W().getUpimeTrans;return e.useContext(xl).upime.phoneMode?null:e.createElement(e.Fragment,null,e.createElement("div",{className:j("mark_btn_3KmrI",o),onClick:r},e.createElement(hl,{className:j(ZN),icon:i?"bianjidadian":"dadian"})),e.createElement("div",{className:"mark_text_1UfBu",onClick:r},a("video.addMarkPoint")))},oM=e.createContext({});function aM(e){var t=100*e;return t<0?t=0:t>100&&(t=100),t}var sM=function(t){var n=t.upime,i=t.percent,r=void 0===i?0:i,o=t.className,a=t.onChanged,s=void 0===a?ce:a,l=t.points,c=void 0===l?[]:l,u=t.currentMarkPoint,d=t.onClickPoint,p=t.onClickMarkPoint,h=t.onDeleteMarkPoint,f=e.useRef(null),m=Ul({ref:f,defaultValue:r,onChanged:s}),v=m.value,g=m.updateSlide,y=function(e,t){var n=t.isStart,i=t.isEnd,r=f.current,o=e.clientX,a=r.getBoundingClientRect(),l=(o-a.left)/(a.right-a.left);l<0&&(l=0),l>1&&(l=1),g(i?void 0:l),s(l,{isStart:n,isEnd:i})},b=c.map((function(t){return e.createElement(lM,{key:t.markPoints[0].mediaTime,point:t,upime:n,currentMarkPoint:u,onClickPoint:d,dealPointMove:y,onClickMarkPoint:p,onDeleteMarkPoint:h})})),E=aM(v);return e.createElement("div",{className:j("progress_bar_SOwfp",o)},e.createElement("div",{className:"bottom_layer_3eWcP",ref:f},e.createElement("div",{className:"background_2LQ-_"})),e.createElement("div",{className:"top_layer_1T3NJ"},e.createElement("div",{className:"content_1JKE5",style:{width:E+"%"}}),b,e.createElement("div",{className:"ball_2xt7a",style:{left:E+"%"}})))},lM=function(t){var n=t.point,i=t.upime,r=t.currentMarkPoint,o=t.dealPointMove,a=t.onClickPoint,s=t.onClickMarkPoint,l=t.onDeleteMarkPoint,c=aM(n.percent),u=yh(!0),d=u.skipRef,p=u.toggleHide,h=u.hide,f=e.useRef();f.current=function(){p(),null==a||a(n)};var m=e.useRef(null);e.useEffect((function(){var e=m.current,t=!1,n=!1,i={x:0,y:0},r=function(e){e.stopPropagation(),t=!0,n=!1,i={x:e.clientX,y:e.clientY},document.addEventListener("pointermove",a),document.addEventListener("pointerup",s)},a=function(e){var t=!1,r=e.clientX,a=e.clientY;!n&&fn(i,{x:r,y:a})>4&&(n=!0,t=!0),n&&o(e,{isStart:t,isEnd:!1})},s=function(e){var i;t=!1,n?o(e,{isStart:!1,isEnd:!0}):null===(i=f.current)||void 0===i||i.call(f),document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",s)};return e.addEventListener("pointerdown",r),function(){e.removeEventListener("pointerdown",r),t&&(document.removeEventListener("pointermove",a),document.removeEventListener("pointerup",s))}}),[]);var v=e.useContext(oM).subWindowOpen;return e.useEffect((function(){if(!h)return v(!0),function(){v(!1)}}),[h]),e.createElement("div",{className:"point_3r1U1",style:{left:c+"%"},ref:d},e.createElement("div",{className:"point_ball_y4q-p",ref:m}),e.createElement("div",{className:j("mark_list_28Hix",h&&"hide_1wZ2I")},n.markPoints.map((function(t){return e.createElement(cM,{upime:i,key:t.mediaTime,markPoint:t,isCurrent:(null==r?void 0:r.mediaTime)===t.mediaTime,onClickMarkPoint:s,onDeleteMarkPoint:l})}))))},cM=function(t){var n=t.upime,i=t.markPoint,r=t.isCurrent,o=t.onClickMarkPoint,a=t.onDeleteMarkPoint,s=W().getUpimeTrans,l=e.useState(!1),c=l[0],u=l[1],d=e.useRef(null),p=n.userManager.getUser(i.creator);al(p);var h=(i.title||function(e){var t=(e=Math.floor(e))%1e3,n=(e=(e-t)/1e3)%60;function i(e,t){void 0===t&&(t=2);for(var n=""+e,i=1;i<t;i++)e<Math.pow(10,i)&&(n="0"+n);return n}return i((e-n)/60)+":"+i(n)+":"+i(t,3)}(i.mediaTime))+" "+p.userName,f=n.editable||n.userManager.commentOnlyMode&&p.loginName===n.localUserInfo.loginName;return e.createElement("div",{className:j("markpoint_item_2QjWH",r&&"isCurrent_2j-Lv")},e.createElement("div",{className:"markpoint_info_1g5mA",onClick:function(){return null==o?void 0:o(i)}},h),f&&e.createElement("div",{className:j("markpoint_delete_1Y232",c&&"focused_3C2yH"),ref:d,onClick:function(){!c&&u(!0)}},e.createElement(hl,{icon:"shanchu"})),c?e.createElement(ZI,{targetDom:d.current,upime:n,onConfirm:function(){u(!1),null==a||a(i)},closeEvt:function(){u(!1)},content:s("video.comfirmDelete")}):null)},uM=function(t){var n=t.speed,i=t.setSpeed,r=t.className,o=W().getUpimeTrans,a=yh(!0),s=a.hide,l=a.toggleHide,c=a.skipRef,u=a.setHide,d=e.useContext(oM).subWindowOpen;return e.useEffect((function(){if(!s)return d(!0),function(){d(!1)}}),[s]),e.createElement("div",{className:j("speed_btn_3MpEV",r),ref:c},e.createElement("div",{className:j("current_speed_2z0MW",!s&&JN),onClick:l},1===n?o("videoplay.speed"):n+"x"),!s&&e.createElement("div",{className:j("options_G6vQo")},[.25,.5,.75,1,1.25,1.75,2].map((function(t){return e.createElement("div",{key:t,className:j("option_1-8hR",t===n&&"selected_145a8"),onClick:function(){return function(e){i(e),u(!0)}(t)}},t+"x")}))))},dM=function(t){var n=t.current,i=void 0===n?"":n,r=t.total,o=void 0===r?"":r,a=t.className;return e.createElement("div",{className:j("time_info_3HKXz",a)},"".concat(i," / ").concat(o))},pM=function(t){var n=t.onClick,i=t.className;return e.createElement("div",{className:j("fullscreen_34wG-",i),onClick:n},e.createElement(hl,{className:j(ZN),icon:"baibanquanping"}))},hM=function(t){var n=t.element,i=t.className,r=W().getUpimeTrans,o=yh(!0),a=o.hide,s=o.toggleHide,l=o.skipRef,c=e.useContext(oM).subWindowOpen;return e.useEffect((function(){if(!a)return c(!0),function(){c(!1)}}),[a]),e.createElement("div",{className:j("more_btn_wrapper_1uhRn",i),ref:l},e.createElement("div",{className:j("more_btn_1Z5gR",!a&&JN),onClick:s},e.createElement(hl,{className:"more_icon_26j55",icon:"gengduo"})),!a&&e.createElement("div",{className:j("controls_39z-S")},e.createElement("div",{className:$N},e.createElement("div",{className:eM},r("videoplay.more.loop")),e.createElement("div",{className:j(tM,n.loop&&nM),onClick:function(){return n.toggleLoopState()}})),e.createElement("div",{className:$N},e.createElement("div",{className:eM},r("videoplay.more.skipMarkPoint")),e.createElement("div",{className:j(tM,n.skipMarkPoint&&nM),onClick:function(){return n.toggleSkipMarkpoint()}}))))};function fM(t){var n=Bg();e.useEffect((function(){var e=["play","pause","timeupdate","durationchange","canplay","speedChanged"];return e.forEach((function(e){return t.on(e,n)})),function(){e.forEach((function(e){return t.off(e,n)}))}}),[])}function mM(e){var t=Math.ceil(e/1e3),n=Math.floor(t/60),i=Math.floor(t%60);return(n<10?"0":"")+n+":"+(i<10?"0":"")+i}var vM={video_ctrl:"video_ctrl_2Awiu",video:"video_RPAE8",audio:"audio_3n2NW",fade:"fade_2n_7J",progress:"progress_ca3-d",time:"time_1GAm4",mark_btn:"mark_btn_2-ocU",fullscreen:"fullscreen_EH_Dy",play_btn:"play_btn_1RUCp",speed:"speed_ZL1_e",simple:"simple_1Y0Zx",top:"top_3dmP5",bottom:"bottom_N6d_k",bottom_left:"bottom_left_2nUj-",bottom_right:"bottom_right_1F59L"},gM=function(t){var n,i=t.upime,r=t.viewbox,o=t.element,a=e.useRef(null),s=o.element,l=s.globalTransform,c=s.size,u=s.titleHeight,d=s.position,p=s.scale;d=l.apply(d),p*=l.currentScale;var h=c.width*p*r.scale,f=(c.height+u)*p*r.scale,m=h>220?"full":h>=32&&f>=32?"simple":"none",v="full"===m?50:32,g=(d.x-r.left)*r.scale,y=(d.y-r.top)*r.scale,b=y+f-v,E=s.elementType===Za.VIDEO,x=e.useRef(0),w=e.useState(!1),C=w[0],S=w[1],k=e.useRef({right:0,bottom:0,left:0,top:0,domHeight:0});k.current={right:h+g,bottom:y+f,left:g,top:y,domHeight:v},e.useEffect((function(){var e=null,t=!1,n=!1;function i(e){x.current&&(e=!1),t=e,S(e)}function r(r){if(!n){var o=r.clientX,a=r.clientY,s=k.current;Ot({x:o,y:a},exports.E(exports.E({},s),{top:s.bottom-k.current.domHeight}))?(i(!1),null!==e&&(window.clearTimeout(e),e=null)):Ot({x:o,y:a},s)?(i(!1),null!==e&&window.clearTimeout(e),e=window.setTimeout((function(){i(!0),e=null}),3e3)):t||null!==e||(e=window.setTimeout((function(){i(!0),e=null}),3e3))}}function o(r){if(1===r.touches.length){var o=r.touches[0];Ot({x:o.clientX,y:o.clientY},k.current)?(n=!0,i(!1),null!==e&&(clearTimeout(e),e=null)):(n=!1,t||null!==e||(e=window.setTimeout((function(){i(!0),e=null}),3e3)))}}function a(r){(n||!t&&null===e)&&(e=window.setTimeout((function(){i(!0),e=null}),3e3)),n=!1}return window.addEventListener("mousemove",r,!0),window.addEventListener("click",r,!0),window.addEventListener("touchstart",o,!0),window.addEventListener("touchend",a,!0),function(){window.removeEventListener("mousemove",r,!0),window.removeEventListener("click",r,!0),window.removeEventListener("touchstart",o,!0),window.removeEventListener("touchend",a,!0)}}),[]);var _=!i.meetingMode&&E,T=0;"full"===m&&(T=h-122);var I={width:h,height:v,left:g,top:b};("none"===m||s.hideControl)&&(I.display="none"),i.followManager.forcedFollowing&&(I.pointerEvents="none"),s.mounted||(I.visibility="hidden");var P=s.mediaPlayer;fM(P);var N=function(){P.isPlaying?s.pause():P.ended?s.replay():s.play()},M=P.currentTime,A=P.duration,D=P.isPlaying;P.ended;var R=A>0?M/A:0,B=mM(1e3*M),L=mM(1e3*A),O=P.playbackRate,F=s,z=F.markPoints||[],H=[];if(T>0&&!s.skipMarkPoint)for(var U=void 0,W=0,V=z;W<V.length;W++){var G=V[W],q=G.mediaTime/1e3/A,K=T*q;if(void 0===U||K-U>5)U=K,H.push({percent:q,markPoints:[G]});else{var Y=H[H.length-1];Y.markPoints.push(G),(null===(n=F.currentPoint)||void 0===n?void 0:n.mediaTime)===G.mediaTime&&(Y.percent=q)}}var X=F.canMark;return e.createElement(oM.Provider,{value:{subWindowOpen:function(e){e?x.current++:x.current--}}},e.createElement("div",{ref:a,className:j(vM.video_ctrl,E?vM.video:vM.audio,"simple"===m?vM.simple:"",C&&vM.fade),style:I},"full"===m&&e.createElement(e.Fragment,null,e.createElement("div",{className:vM.top},e.createElement(sM,{upime:i,className:vM.progress,percent:R,onChanged:function(e,t){t.isEnd&&s.setCurrentTime(e*P.duration)},points:H,currentMarkPoint:F.currentPoint,onClickPoint:function(e){var t=e.markPoints;if(F.currentPoint){var n=F.currentPoint.mediaTime;if(t.some((function(e){return e.mediaTime===n})))return}F.setCurrentTime(t[0].mediaTime/1e3)},onClickMarkPoint:function(e){var t;(null===(t=F.currentPoint)||void 0===t?void 0:t.mediaTime)!==e.mediaTime&&F.setCurrentTime(e.mediaTime/1e3)},onDeleteMarkPoint:function(e){var t=H.find((function(t){return t.markPoints.includes(e)}));if(1===t.markPoints.length)F.play();else{var n=t.markPoints.indexOf(e),i=n===t.markPoints.length-1?n-1:n+1;F.setCurrentTime(t.markPoints[i].mediaTime/1e3)}F.deleteMarkPoint(e.mediaTime)}}),e.createElement(dM,{className:vM.time,current:B,total:L})),e.createElement("div",{className:vM.bottom},e.createElement("div",{className:vM.bottom_left},e.createElement(iM,{playStatus:D,className:vM.play_btn,onClick:N}),X&&e.createElement(rM,{className:vM.mark_btn,onClick:function(){F.enterMarkMode()}})),e.createElement("div",{className:vM.bottom_right},e.createElement(uM,{className:vM.speed,speed:O,setSpeed:function(e){s.setSpeed(e)}}),_&&e.createElement(pM,{className:vM.fullscreen,onClick:function(){E&&s.enterFullscreen()}}),e.createElement(hM,{element:s,className:vM.fullscreen})))),"simple"===m&&e.createElement(iM,{playStatus:D,className:j(vM.play_btn,vM.center),onClick:N})))},yM=function(t){var n=t.upime,i=t.element,r=i.type,o=i.borderRect,a=i.title,s=i.mediaPlayer,l={left:o.x,top:o.y,width:o.width,height:o.height},c=e.useRef(null),u=e.useRef(null);e.useEffect((function(){var e=u.current;return i.bindMove(e)}),[]),e.useEffect((function(){return i.bindDom(c.current)}),[]),al(i),fM(s);var d=s.currentTime,p=s.duration,h=s.isPlaying;s.ended;var f=p>0?d/p:0,m=mM(1e3*d),v=mM(1e3*p),g=s.playbackRate,y=e.useRef(0),b=e.useState(!1),E=b[0],x=b[1];return e.useEffect((function(){if("audio"!==r){var e=null,t=!1,n=!1;return window.addEventListener("mousemove",a,!0),window.addEventListener("click",a,!0),window.addEventListener("touchstart",s,!0),window.addEventListener("touchend",l,!0),function(){window.removeEventListener("mousemove",a,!0),window.removeEventListener("click",a,!0),window.removeEventListener("touchstart",s,!0),window.removeEventListener("touchend",l,!0)}}function o(e){y.current&&(e=!1),t=e,x(e)}function a(r){if(!n){var a=r.clientX,s=r.clientY,l=Bt(i.borderRect);Ot({x:a,y:s},exports.E(exports.E({},l),{top:l.bottom-50}))?(o(!1),null!==e&&(window.clearTimeout(e),e=null)):Ot({x:a,y:s},l)?(o(!1),null!==e&&window.clearTimeout(e),e=window.setTimeout((function(){o(!0),e=null}),3e3)):t||null!==e||(e=window.setTimeout((function(){o(!0),e=null}),3e3))}}function s(r){if(1===r.touches.length){var a=Bt(i.borderRect),s=r.touches[0];Ot({x:s.clientX,y:s.clientY},a)?(n=!0,o(!1),null!==e&&(clearTimeout(e),e=null)):(n=!1,t||null!==e||(e=window.setTimeout((function(){o(!0),e=null}),3e3)))}}function l(i){(n||!t&&null===e)&&(e=window.setTimeout((function(){o(!0),e=null}),3e3)),n=!1}}),[]),e.createElement(oM.Provider,{value:{subWindowOpen:function(e){e?y.current++:y.current--}}},e.createElement("div",{className:"extra_media_2NL2B",style:l,ref:u},e.createElement("div",{className:"moveResizeArea_ViL91"},e.createElement("div",{className:"title_3VFGG",style:{height:27}},e.createElement(hl,{className:"file_icon_35EgE",icon:"audio"===r?"audioicon":"videoicon"}),e.createElement("div",{className:"name_2_K4Z"},a),e.createElement(hl,{className:"close_icon_3s7b0",icon:"guanbi",onClick:function(){return i.close()}})),e.createElement("div",{className:j("content_j7Z8k","audio"===r?XN:QN),style:{height:o.height-28-1},ref:c})),e.createElement("div",{className:j("media_ctrl_QzLfq","audio"===r?XN:QN,E&&"fade_9jy4P")},e.createElement("div",{className:"top_32dIx"},e.createElement(sM,{upime:n,className:"progress_1wktX",percent:f,onChanged:function(e,t){t.isEnd&&i.setCurrentTime(e*s.duration)}}),e.createElement(dM,{className:"time_2XeFt",current:m,total:v})),e.createElement("div",{className:"bottom_2BM-L"},e.createElement("div",{className:"bottom_left_1C2-w"},e.createElement(iM,{playStatus:h,className:"play_btn_25Yr0",onClick:function(){s.isPlaying?i.pause():(s.ended&&(s.currentTime=0),i.play())}})),e.createElement("div",{className:"bottom_right_13CLS"},e.createElement(uM,{className:"speed_1aDQR",speed:g,setSpeed:function(e){i.setSpeed(e)}})))),e.createElement(bM,{direction:"nw",element:i}),e.createElement(bM,{direction:"ne",element:i}),e.createElement(bM,{direction:"sw",element:i}),e.createElement(bM,{direction:"se",element:i})))},bM=function(t){var n=t.element,i=t.direction,r=e.useRef(null);return e.useEffect((function(){var e=r.current;return n.bindResize(e,i)}),[]),e.createElement("div",{className:j("resize_dom_fuoNI",i),ref:r})},EM=0,xM=function(){function e(e,t){var n=this;this.upime=e,this.type=t,this.renderer=yM,this.title="",this.id="",this.shouldPlay=!1,this.loaded=!1,this.loading=!1,this.renderKey="extraMedia_".concat(EM++);var i=e.view,r=i.viewWidth,o=i.viewHeight,a=28+("audio"===t?50:202);this.borderRect={x:(r-360)/2,y:(o-a)/2,width:360,height:a},this.mediaPlayer="audio"===t?new KN:new YN;var s=e.applyMediaDom(t);this.mediaPlayer.attachMedia(s),this.unsub=e.subscribe("boardResized",(function(){var t=e.view,i=t.viewWidth,r=t.viewHeight,o=n.borderRect,a=o.x,s=o.y,l=o.width,c=o.height,u=!1;l>i&&(l=i,u=!0),c>r&&(c=r,u=!0),a+l>i&&(a=i-l,u=!0),s+c>r&&(s=r-c,u=!0),u&&(n.borderRect={x:a,y:s,width:l,height:c})}))}return e.prototype.bindMove=function(e){var t=this,n={x:0,y:0};return wM(e,(function(e){var i=e.startPosition;e.prePosition;var r=e.position,o=e.isStart;e.isEnd,o&&(n={x:t.borderRect.x,y:t.borderRect.y});var a=r.x-i.x+n.x,s=r.y-i.y+n.y;a+t.borderRect.width>t.upime.view.viewWidth&&(a=t.upime.view.viewWidth-t.borderRect.width),a<0&&(a=0),s+t.borderRect.height>t.upime.view.viewHeight&&(s=t.upime.view.viewHeight-t.borderRect.height),s<0&&(s=0),t.borderRect={width:t.borderRect.width,height:t.borderRect.height,x:a,y:s}}))},e.prototype.bindResize=function(e,t){var n=this,i={left:0,top:0,right:0,bottom:0},r="audio"===this.type?50:202;return wM(e,(function(e){var o=e.startPosition,a=e.position;e.isStart&&(i=Bt(n.borderRect));var s=a.x-o.x,l=a.y-o.y,c=n.upime.view,u=c.viewWidth,d=c.viewHeight,p=i.left,h=i.top,f=i.right,m=i.bottom;t.indexOf("w")>=0&&((p+=s)>f-360&&(p=f-360),p<0&&(p=0)),t.indexOf("e")>=0&&((f+=s)>u&&(f=u),f<p+360&&(f=p+360)),t.indexOf("n")>=0&&"audio"!==n.type&&(h+=l)<0&&(h=0),t.indexOf("s")>=0&&"audio"!==n.type&&((m+=l)>d&&(m=d),m<h+r&&(m=h+r)),n.borderRect=Rt({left:p,top:h,right:f,bottom:m})}))},e.prototype.close=function(){var e;null===(e=this.willClose)||void 0===e||e.call(this)},e.prototype.setCurrentTime=function(e){var t;this.nextState=void 0,this.doSetCurrentTime(e),null===(t=this.onStateChange)||void 0===t||t.call(this)},e.prototype.getCurrentState=function(){return{id:this.id,type:this.type,playing:this.mediaPlayer.isPlaying,currentTime:1e3*this.mediaPlayer.currentTime,duration:this.mediaPlayer.duration,timestamp:this.upime.getCurServerTime(),speed:this.mediaPlayer.playbackRate,url:this.mediaPlayer.src}},e.prototype.play=function(){var e,t;this.nextState=void 0,this.doPlay(),null===(e=this.onPlay)||void 0===e||e.call(this),null===(t=this.onStateChange)||void 0===t||t.call(this)},e.prototype.pause=function(){var e,t;this.nextState=void 0,this.doPause(),null===(e=this.onPause)||void 0===e||e.call(this),null===(t=this.onStateChange)||void 0===t||t.call(this)},e.prototype.setSpeed=function(e){var t,n;this.nextState=void 0,this.doSetSpeed(e),null===(t=this.onSetSpeed)||void 0===t||t.call(this,e),null===(n=this.onStateChange)||void 0===n||n.call(this)},e.prototype.setSrc=function(e){var t=this;this.loaded=!1,this.loading=!0,this.mediaPlayer.once("canplay",(function(){t.loading=!1,t.loaded=!0,t.upime.view.update(),t.nextState?(t.doSetState(t.nextState),t.nextState=void 0):t.shouldPlay&&t.mediaPlayer.play()})),this.mediaPlayer.src=e},e.prototype.doPlay=function(){if(this.shouldPlay=!0,this.loaded)this.mediaPlayer.play();else if(this.loading)return void(_e.isIOS&&this.mediaPlayer.play())},e.prototype.doPause=function(){this.shouldPlay=!1,this.mediaPlayer.pause()},e.prototype.doSetCurrentTime=function(e){this.mediaPlayer.currentTime=e},e.prototype.doSetSpeed=function(e){this.mediaPlayer.playbackRate=e},e.prototype.bindDom=function(e){var t=this;return this.mediaPlayer.attachParent(e),function(){t.mediaPlayer.detachParent(e)}},e.prototype.setState=function(e){this.loaded?this.doSetState(e):this.nextState=e},e.prototype.doSetState=function(e){var t=this.mediaPlayer.duration,n=e.playing,i=e.currentTime,r=e.timestamp,o=e.speed,a=i/1e3;if(n&&(a+=(this.upime.getCurServerTime()-r)*o/1e3),a>=t)return this.doPause(),void this.doSetCurrentTime(t);(!n||Math.abs(a-this.mediaPlayer.currentTime)>.5)&&this.doSetCurrentTime(a),this.doSetSpeed(o),n?this.doPlay():this.doPause()},e.prototype.destroy=function(){var e;this.mediaPlayer.pause(),this.mediaPlayer.src="",this.mediaPlayer.detachMedia(),null===(e=this.unsub)||void 0===e||e.call(this)},M([rl],e.prototype,"borderRect",void 0),M([il],e)}();function wM(e,t){var n=!1,i=!1,r=null,o={x:0,y:0},a={x:0,y:0};function s(e){e.stopPropagation(),i||(i=!0,n=!1,r=e.pointerId,o={x:e.pageX,y:e.pageY},a=o,document.addEventListener("pointermove",l),document.addEventListener("pointerup",c))}function l(e){if(e.pointerId===r){var i={x:e.pageX,y:e.pageY},s=!1;if(!n){if(fn(i,o)<4)return;n=!0,s=!0}t({startPosition:o,prePosition:a,position:i,isStart:s,isEnd:!1}),a=i}}function c(e){if(i&&e.pointerId===r){if(i=!1,r=null,n){var s={x:e.pageX,y:e.pageY};t({startPosition:o,prePosition:a,position:s,isStart:!1,isEnd:!0})}document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c)}}return e.addEventListener("pointerdown",s),function(){e.removeEventListener("pointerdown",s),document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c)}}function CM(e){var t=void 0,n=void 0;return function(){var e=this;if(null==n||n(),t)return this.upime.makeBorderCenter(t,{left:0,right:0,top:0,bottom:0,duration:200}),void(t=void 0);t=this.upime.view.getViewbox(),this.upime.maximizeElement(this).then((function(){e.deleted||(n=e.upime.view.once("viewboxChange",(function(){t=void 0,n=void 0})),e.unsubs.push(n))}))}.bind(e)}var SM=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.beginLoadTime=-1,i.renderer=NN,i.elementType=Za.DOCUMENT,i.embeddedRenderer=GN,i.embedRenderKey="",i.mode=1,i.fileType=1,i.parseStatus=1,i.name="",i.fileId="",i.totalPage=1,i.startPage=1,i._currentPage=1,i.titleHeight=0,i.turnPageCbs={},i.dealDoubleClick=CM(i),i.switchPageQueue=[],i.processing=!1,i.switchPageTimerId=0,i.bypassStableInterActCheck=!0,i.editorType=zN,i.gotoPrevStep=function(){var e=i.pptPlayer;e?e.canPrev&&e.prev():i.currentPage<=1||(i.currentPage--,i.upime.view.update(),i.dealDocSync())},i.gotoNextStep=function(){var e=i.pptPlayer;e?e.canNext&&e.next():i.currentPage>=i.totalPage||(i.currentPage++,i.upime.view.update(),i.dealDocSync())},i.gotoPage=function(e){var t=i.pptPlayer;t?t.setPageStep(e-1,0,!0):(i.currentPage=e,i.upime.view.update(),i.dealDocSync())},i.onPptPlayerStateChange=function(e){var t=e.page,n=e.action,r=e.active,o=i.currentPage!==t+1;if(i.currentPage=t+1,i.upime.view.update(),i.refreshInteractData(),o&&(i.lastTrigger=void 0,i.clearExtraMedia(),i.publish("documentPageChanged",i)),r){var a={page:t,step:n};o&&(a.trigger=null,a.media=null),i.upime.followManager.syncIspringPptStatus(i.id,a),i.dealDocSync()}},i.onPptTriggerClick=function(e){i.lastTrigger={id:e,timestamp:i.upime.getCurServerTime()};var t={trigger:i.lastTrigger};i.upime.followManager.syncIspringPptStatus(i.id,t)},i.onMediaClick=function(e,t){var n=i.openExtraMedia(e,t);i.upime.followManager.syncIspringPptStatus(i.id,{media:n.getCurrentState()})};var r=i.prevBtn=new WN(i,"prevBtn",Mf);r.x=364,r.y=2,r.onclick=i.gotoPrevStep,i.addInnerWidget(r);var o=i.nextBtn=new WN(i,"nextBtn",Nf);o.x=420,o.y=2,o.onclick=i.gotoNextStep,i.addInnerWidget(o);var a=i.maxBtn=new WN(i,"maxBtn2",Bf);return a.x=450,a.y=2,a.iconSize=14,a.onclick=function(){t.followManager.forcedFollowing?t.addToast(O("meeting.view.locked.presentation.hint")):i.upime.displayDocument(i)},i.addInnerWidget(a),i}return P(t,e),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return window._support_doc_rotate_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refSystemLevel",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this._currentPage},set:function(e){e!==this._currentPage&&(this._currentPage=e,this.switchPage(e),this.publish("documentPageChanged",this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canPrevStep",{get:function(){return this.pptPlayer?this.pptPlayer.canPrev:this.currentPage>1&&this.totalPage>1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canNextStep",{get:function(){return this.pptPlayer?this.pptPlayer.canNext:this.currentPage<this.totalPage},enumerable:!1,configurable:!0}),t.prototype.checkAttachedMeta=function(){},t.prototype.setCurrentPageRS=function(e){var t,n=this.currentPageRS,i=this.upime.elementManager.getDocumentPageRS(this.id,e);if(n){if(n===i)return;this.unmounRefSystem(n)}this.currentPageRS=i,i.bindBaseElement(this),null===(t=this.parentRefSystem)||void 0===t||t.addChildRS(i);var r=this.turnPageCbs[e];r&&(r.forEach((function(e){return e()})),delete this.turnPageCbs[e])},t.prototype.dealUpdate=function(t){var n=t,i=n.fileId,r=N(n,["fileId"]);e.prototype.dealUpdate.call(this,r),void 0!==i&&(this.fileId=i,!t.deleted&&!this.deleted&&this.createPageFile(this.currentPage)),(r.position||r.size||void 0!==r.scale)&&this.updateBorderBox(),!this.deleted&&this.currentPageRS&&(t.position||void 0!==t.rotate||t.scale)&&this.currentPageRS.updateTransform()},t.prototype.checkClickName=function(e){return 0===this.titleHeight&&1===this.mode&&HN(this,e)},t.prototype._checkSelectRelation=function(t,n){return e.prototype._checkSelectRelation.call(this,t,n)||("click"!==(null==n?void 0:n.type)&&"move"!==(null==n?void 0:n.type)||!this.checkClickName(t)?null:{metric:-1,transparent:!1})},t.prototype.processQueue=function(){var e=this.switchPageQueue,t=this.processing;e.length>0&&!t&&this.createPageFile(e.shift())},t.prototype.switchPage=function(e){var t=this;this.pptPlayer?this.currentPageFile&&this.currentPageFile.pageId===e||this.createPageFile(e):(window.clearTimeout(this.switchPageTimerId),this.currentPageFile||this.processing?this.switchPageTimerId=window.setTimeout((function(){t.switchPageQueue.push(e),t.processQueue()}),300):this.createPageFile(e))},t.prototype.turnPageTo=function(e,t){var n;if(this.currentPage=e,(null===(n=this.currentPageRS)||void 0===n?void 0:n.pageId)===e)t();else{var i=this.turnPageCbs[e];i?i.push(t):this.turnPageCbs[e]=[t]}},t.prototype.createPageFile=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o=this;return D(this,(function(a){switch(a.label){case 0:return this.beginLoadTime=Date.now(),t=new fu(this.upime,this.fileId,this.size,e),n=this.upime.view.getViewbox(),this.pptPlayer?(this.currentPageFile=t,this.setCurrentPageRS(e),this.checkVisible(n)?(i=this.size.height*this.scale*n.scale,[4,t.loadSuitableSource(i)]):[3,2]):[3,5];case 1:return a.sent(),[3,4];case 2:return[4,t.loadSuitableSource(du)];case 3:a.sent(),a.label=4;case 4:return this.checkVisible(this.upime.view.getViewbox())&&this.upime.view.update(),this.frameId&&(this.upime.elementManager.frameCoverChanged(this.frameId),this.upime.elementManager.refreshFrameCover()),[2];case 5:if(!this.checkVisible(n))return[3,10];this.currentPageFile||(this.currentPageFile=t,this.setCurrentPageRS(e)),i=this.size.height*this.scale*n.scale,this.processing=!0,r={pageId:e},this.currentSwitchPageProcess=r,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,t.loadSuitableSource(i)];case 7:case 8:return a.sent(),[3,9];case 9:return r.canceled?[2]:(this.processing=!1,this.currentPageFile=t,this.setCurrentPageRS(e),this.checkVisible(this.upime.view.getViewbox())&&this.upime.view.update(),this.frameId&&(this.upime.elementManager.frameCoverChanged(this.frameId),this.upime.elementManager.refreshFrameCover()),[3,11]);case 10:this.currentPageFile=t,this.setCurrentPageRS(e),t.loadSuitableSource(du).then((function(){o.frameId&&(o.upime.elementManager.frameCoverChanged(o.frameId),o.upime.elementManager.refreshFrameCover())})),a.label=11;case 11:return this.processQueue(),[2]}}))}))},t.prototype.switchExportPage=function(e){var t=new fu(this.upime,this.fileId,this.size,e);this.exportPageFile=t},t.prototype.resetExportPage=function(){this.exportPageFile=void 0},t.prototype._update_startPage=function(e){this.currentPage=this.startPage=e},t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+(e.titleHeight+a)*s,rotate:this.rotate}},t.prototype.onAdd=function(){var t;e.prototype.onAdd.call(this),!this.currentPageFile&&this.fileId&&this.createPageFile(this.currentPage),this.currentPageRS&&(null===(t=this.parentRefSystem)||void 0===t||t.addChildRS(this.currentPageRS))},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.currentPageFile=void 0,clearTimeout(this.switchPageTimerId),this.switchPageQueue.length=0,this.processing=!1,this.currentPageRS&&this.unmounRefSystem(this.currentPageRS),this.stopPreview()},t.prototype.dealDocSync=function(){this.upime.followManager.syncDocStatus(this)},t.prototype.showFileControlDom=function(){this.upime.publish("documentFocused",this),(this.totalPage>1&&2!==this.mode||5===this.fileType)&&1===this.parseStatus&&this.upime.enableFileHelperWidget(this)},t.prototype.dealClickStart=function(t){var n;if(null===(n=t.metaData)||void 0===n?void 0:n.clickData){var i=t.metaData.clickData.customData;if(i){if(this.pptPlayer){var r=i,o=r.triggerId,a=r.clickPpt;o?(this.pptPlayer.clickTrigger(o,!0),this.refreshInteractData()):a&&this.pptPlayer.dispatchClick(a.x,a.y)}return}}e.prototype.dealClickStart.call(this,t)},t.prototype.dealHoverStart=function(t){var n;(null===(n=t.metaData)||void 0===n?void 0:n.clickData)&&t.metaData.clickData.customData?this.upime.view.setCursor("pointer",this):e.prototype.dealHoverStart.call(this,t)},t.prototype.checkInteractRelation=function(t,n){if(this.pptPlayer){if(!n)return null;var i=n.type;if(("click"==i||"hover"===i)&&t.x>this.position.x&&t.x<this.position.x+this.size.width*this.scale&&t.y>this.position.y+this.titleHeight*this.scale&&t.y<this.position.y+(this.titleHeight+this.size.height)*this.scale){if(this.pptPlayer.clickDivs.length)for(var r=this.pptPlayer,o=r.viewSize,a=r.clickDivs,s=o.width/(this.size.width*this.scale),l=(t.x-this.position.x)*s,c=(t.y-this.position.y-this.titleHeight*this.scale)*s,u=a.length-1;u>=0;u--){var d=a[u].rect;if(l>d.x&&l<d.x+d.width&&c>d.y&&c<d.y+d.height)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{triggerId:a[u].id}}}}}if("click"==i&&!this.upime.followManager.followingUser)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{clickPpt:{x:(t.x-this.position.x)/(this.size.width*this.scale),y:(t.y-this.position.y-this.titleHeight*this.scale)/(this.size.height*this.scale)}}}}}}}return e.prototype.checkInteractRelation.call(this,t,n)},t.prototype.bindDom=function(e){var t=this,n=this.pptPlayer;return this.webviewerBorder=e,n&&n.attachParent(e),function(){t.webviewerBorder===e&&(t.webviewerBorder=void 0)}},t.prototype.openExtraMedia=function(e,t){var n=this;if(this.extraMedia){if(this.extraMedia.id===e)return this.extraMedia;this.clearExtraMedia()}var i=e.indexOf("_video")>0?"video":"audio",r=new xM(this.upime,i);return r.id=e,r.title=this.name+"_ "+e,r.setSrc(t),this.extraMedia=r,r.onStateChange=function(){n.upime.followManager.syncIspringPptStatus(n.id,{media:r.getCurrentState()})},r.willClose=function(){n.clearExtraMedia(),n.upime.followManager.syncIspringPptStatus(n.id,{media:null})},this.upime.view.addDomWidget(r),this.extraMedia},t.prototype.clearExtraMedia=function(){this.extraMedia&&(this.upime.view.removeDomWidget(this.extraMedia),this.extraMedia.destroy(),this.extraMedia=void 0)},t.prototype.getPptUrl=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.upime.getFileInfo(this.fileId)];case 1:return[2,e.sent().url+"_s"]}}))}))},t.prototype.startPreview=function(e){if(void 0===e&&(e=!0),this.upime.requestPreviewPpt(this),e){var t=this.pptPlayer;t&&this.upime.followManager.syncIspringPptStatus(this.id,{page:t.pptPage,step:t.pptAction,trigger:null,media:null})}},t.prototype.stopPreview=function(){this.upime.cancelPreviewPpt(this)},t.prototype.doStopPreview=function(){var e;null===(e=this.pptPlayer)||void 0===e||e.destroy(),this.pptPlayer=void 0,this.lastTrigger=void 0,this.upime.view.removeEmbeddedElement(this),clearInterval(this.refreshInteractDataTimer)},t.prototype.doStartPreview=function(e){window.clearTimeout(this.switchPageTimerId),this.switchPageQueue=[],this.processing=!1,this.currentSwitchPageProcess&&(this.currentSwitchPageProcess.canceled=!0),this.pptPlayer&&this.pptPlayer!==e&&this.pptPlayer.destroy(),this.pptPlayer=e,e.onPptStateChange=this.onPptPlayerStateChange,e.onTriggerClick=this.onPptTriggerClick,e.onMediaClick=this.onMediaClick,this.currentPageFile&&this.currentPageFile.pageId===this.currentPage||this.createPageFile(this.currentPage),e.setPageStep(this.currentPage-1,0,!1),this.getPptUrl().then((function(t){return e.openFile(t)})),this.webviewerBorder&&this.pptPlayer.attachParent(this.webviewerBorder),this.embedRenderKey=this.renderKey+Date.now(),this.upime.view.addEmbeddedElement(this),this.refreshInteractData()},t.prototype.refreshInteractData=function(){},t.prototype.useServerPptState=function(e){var t,n;this.pptPlayer||this.startPreview(!1);var i=e.page,r=e.step,o=e.trigger,a=e.media;void 0!==i&&void 0!==r&&(null===(t=this.pptPlayer)||void 0===t||t.setPageStep(i,r,!1)),o&&(this.lastTrigger&&this.lastTrigger.id===o.id&&this.lastTrigger.timestamp===o.timestamp||(null===(n=this.pptPlayer)||void 0===n||n.clickTrigger(o.id,!1),this.lastTrigger=o)),null===a?this.clearExtraMedia():a&&(this.extraMedia&&this.extraMedia.id===a.id||(this.extraMedia=this.openExtraMedia(a.id,a.url)),this.extraMedia.setState(a))},t.prototype.getScreenShot=function(){var e;return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return(t=null===(e=this.currentPageFile)||void 0===e?void 0:e.getSource({height:800}).target)?[4,ir(t)]:[2,""];case 1:return i.sent(),(n=document.createElement("canvas")).width=t.originWidth,n.height=t.originHeight,n.getContext("2d").drawImage(t.content,0,0),[2,n.toDataURL("jpeg")]}}))}))},t}(oy),kM=function(){function e(e){var t=this;this.element=e,this.renderer=_M,this.renderKey="doc_paginator"+e.id,this.upime=e.upime,this._unsub=this.upime.subscribe("elementDeleted",(function(e){e===t.element&&t.upime.clearFileHelperWidget()}))}return e.prototype.onDestroy=function(){this._unsub()},e.prototype.prev=function(){this.element.canPrevStep&&this.element.gotoPrevStep()},e.prototype.next=function(){this.element.canNextStep&&this.element.gotoNextStep()},e.prototype.updatePage=function(e){this.element.gotoPage(e)},e}(),_M=function(t){var n=t.upime,i=t.viewbox,r=t.element,o=r.element,a=o.size,s=o.scale,l=o.currentPage,c=o.locked,u=o.totalPage,d=o.titleHeight,p=o.globalTransform,h=p.apply(o.position),f=a.width*s*p.currentScale*i.scale,m=a.height*s*p.currentScale*i.scale,v=(a.height+d)*s*p.currentScale*i.scale,g=(h.x-i.left)*i.scale,y=(h.y-i.top)*i.scale+v-36-12,b={width:"".concat(f,"px"),transform:"translate3d(".concat(g,"px, ").concat(y,"px, 0)")};o.mounted||(b.visibility="hidden");var E=e.useRef(null),x=f>=140&&m>=48;return e.useEffect((function(){var e=E.current,t=n.userEventManager.subscribe("click",(function(){null==e||e.blur()}));return function(){t()}}),[]),e.useEffect((function(){var e=E.current;e&&(e.value="".concat(l))}),[l]),x&&!c?e.createElement("div",{className:AN.paginatorRoot,style:b},e.createElement("div",{className:j(AN.widget)},e.createElement("div",{className:j(AN.arrow,!o.canPrevStep&&AN.disabled),onClick:function(){r.prev()}},e.createElement("div",{className:j(AN.left)})),e.createElement("div",{className:AN.paginator},e.createElement("input",{defaultValue:l,onChange:function(){var e=E.current,t=e.value;if(t&&/^\d+$/.test(t)){var n=Mn(1,Number(t),u);r.updatePage(n),e.value="".concat(n)}},maxLength:"".concat(u).length,ref:E,onBlur:function(){var e=E.current;if(e){var t=e.value;if(!t||isNaN(Number(t)))r.updatePage(1),e.value="1";else{var n=Mn(1,Number(t),u);r.updatePage(n),e.value="".concat(n)}}},onKeyPress:function(e){if("Enter"===e.key)return e.preventDefault(),e.stopPropagation(),void e.target.blur()}}),e.createElement("span",null,"/  ".concat(o.totalPage))),e.createElement("div",{className:j(AN.arrow,!o.canNextStep&&AN.disabled),onClick:function(){return r.next()}},e.createElement("div",{className:j(AN.right)})))):null};function TM(t){var n=t.element,i=t.upime,r=t.viewScale,o=e.useRef(null);e.useEffect((function(){if(o.current){var e=o.current;return n.bindSimpleText(e)}}),[]);var a=n.element,s=a.name,l=a.position,c=(l.x-i.view.x)*r,u=(l.y-i.view.y)*r,d=e.useMemo((function(){return{fontSize:"14px",textAlign:"left",color:"#616371",lineHeight:"20px",fontFamily:He,left:"".concat(c,"px"),top:"".concat(u-20-6,"px"),height:20}}),[c,u]);return e.createElement("input",{ref:o,className:Wr,defaultValue:s,style:d,spellCheck:"false",draggable:"false",onKeyUp:function(e){return e.stopPropagation()}})}function IM(t){var n=t.element,i=t.upime,r=t.viewbox.scale;return e.createElement(e.Fragment,null,e.createElement(Eb,{element:n,upime:i}),n.editingName?e.createElement(TM,{element:n,upime:i,viewScale:r}):null)}var PM={custom:0,A4:Math.sqrt(2)/2,letter:.77,"16:9":16/9,"4:3":4/3,"1:1":1};function NM(e){switch(e){case"A4":return"A4";case"letter":return"B5";case"16:9":return"16 : 9";case"4:3":return"4 : 3";case"1:1":return"1 : 1"}}var MM=[{id:"custom",icon:"zidingyi"},{id:"A4",icon:"A4"},{id:"letter",icon:"B5"},{id:"16:9",icon:"a-169"},{id:"4:3",icon:"a-43"},{id:"1:1",icon:"a-11"}],AM=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="frameBg",t}return P(t,e),t}(Zb),DM={ratioBlock:"ratioBlock_2jjJB",frameTypeEditor:"frameTypeEditor_20mvL",typeLabelContainer:"typeLabelContainer_2Y419",frameTypeLabel:"frameTypeLabel_Y-GNh",ratiosPanel:"ratiosPanel_3vWk_"},RM=function(t){var n=t.classNames,i=t.onSelectRatio,r=t.onPointerEnter,o=t.onPointerLeave,a=t.onPointerDown,s=t.onTouchStart,l=W().getUpimeTrans;return e.createElement(e.Fragment,null,e.createElement("div",{className:j.apply(void 0,R([DM.ratiosPanel],null!=n?n:[],!1)),onClick:function(e){return e.stopPropagation()}},MM.map((function(t){return e.createElement("div",{key:t.id,className:DM.ratioBlock,onClick:function(e){return i(t.id,e)},onPointerEnter:function(e){e.stopPropagation(),r&&r(t.id,e)},onPointerLeave:function(e){e.stopPropagation(),o&&o(t.id,e)},onPointerDown:function(e){return null==a?void 0:a(e,t.id)},onTouchStart:function(e){return null==s?void 0:s(e,t.id)}},e.createElement(hl,{icon:t.icon}),e.createElement("span",null,"custom"===t.id?l("frame.ratio.custom"):NM(t.id)))}))))},BM=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.element,o=n.editor,a=r.type,s=yh(!0),l=s.hide,c=s.toggleHide,u=s.skipRef,d="custom"===a?i("frame.ratio.custom"):NM(a);return e.createElement("div",{className:DM.frameTypeEditor,ref:u,onClick:c},e.createElement(Dl,{placement:"top",content:i("frame.ratio")},e.createElement("div",{className:DM.typeLabelContainer},e.createElement("span",{className:DM.frameTypeLabel}," ",d," "))),!l&&e.createElement(xh,{align:"left",className:DM.frameSubWin},e.createElement(RM,{onSelectRatio:function(e){e!==a&&(o.updateFrameRatio(e),c())},onPointerEnter:function(e){return o.showRatioPreview(e)},onPointerLeave:function(){return o.hideRatioPreview()}})))},LM=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="frameType",t.renderer=BM,t.couldAffectGroup=!1,t}return P(t,e),t}(ay),OM=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.tempWrappedElements=[],r._renaming=!1,r.supportZindex=!1,r._frameRatioPreviewWidget=null,r.editingName=!1,r.editNameFocusOffset=0,r.domRenderer=IM,r.editable&&!r.isHandMode&&r.propertyEditors.push(new LM(r,n),new AM(r,n)),r}return P(t,e),Object.defineProperty(t.prototype,"couldAddComment",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizable",{get:function(){return!this.element.hide},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frameHided",{get:function(){return!!this.element.hide},enumerable:!1,configurable:!0}),t.prototype.hideFrame=function(e){this.updateProperty(exports.E({hide:e},!e&&{unHideRoles:null})),this.upime.updateView()},t.prototype.select=function(){e.prototype.select.call(this);var t=this.tempInput=document.createElement("input");t.style.fontSize="14px",t.style.lineHeight="20px",t.style.width="0px",t.style.height="20px",t.style.fontFamily=He,t.className=Vr,document.body.appendChild(t),_e.tablet&&this.upime.editable&&(this.editingName=!0,this.element.editingName=!0)},t.prototype.bindSimpleText=function(e){var t=this;if(this._nameInput=e,this._renaming)e.select(),this._renaming=!1;else if(_e.desktop){if(this.editNameFocusOffset){for(var n=this.editNameFocusOffset,i=yi(e.value),r=0,o=0,a=0;a<i.length;a++){var s=ji(i[a],{fontSize:14,fontFamily:He});if(o+s>n){r=n-o<=s/2?a:a+1;break}o+=s}e.setSelectionRange(r,r)}else e.setSelectionRange(0,0);e.focus()}this.newName=void 0;var l=function(){var n=t.tempInput;n.value=e.value;var i=n.scrollWidth;e.style.width=i+8+"px"};l();var c=function(n){l(),t.newName=e.value},u=function(n){n.defaultPrevented||n.isComposing||"Enter"!==n.key&&13!==n.keyCode||(e.blur(),n.preventDefault(),t.editingName=!1,t.element.editingName=!1,t.updateProperty({name:e.value}),t.newName=void 0)};return e.addEventListener("keydown",u),e.addEventListener("input",c),function(){e.removeEventListener("input",c),e.removeEventListener("keydown",u)}},t.prototype.deleteSelf=function(){if(!this.element.frozedGroupId){var e=this.getOp();this.dealDeleteGroup(e),this.doDelete(e,!0),this.upime.clearSelect(),e.sync()}},t.prototype.doDelete=function(t,n){var i,r=this;e.prototype.doDelete.call(this,t);var o=null===(i=this.manager)||void 0===i?void 0:i.getElements().reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t.id]=t,n))}),{});this.element.getMembers().forEach((function(e){if(n)t.update(e,{frameId:null});else{if(null==o?void 0:o[e.id])return;new e.editorType(r.upime,e).doDelete(t)}}))},t.prototype.doRename=function(){this._nameInput?this._nameInput.select():(this.editingName=!0,this.element.editingName=!0,this._renaming=!0,this.upime.updateView())},t.prototype.isKeepRatio=function(){return"custom"!==this.element.type||this.shiftKeyDown},t.prototype.moveMovingElements=function(e){var t=this,n=e.deltaX,i=e.deltaY;this.movingEles.forEach((function(r){if(r.elementType===Za.CONNECTIONLINE){var o=fN(r,e);o&&t.addUpdate(r,o)}else t.addUpdate(r,{position:{x:r.position.x+n,y:r.position.y+i}})}))},t.prototype.handleDirectMove=function(e){this.elementsWillMove(e),this.moveMovingElements(e),this.elementsDidMove(e)},t.prototype.handleSelectCtrlMove=function(e){var t=this.checkBeforeMove(e);this.moveMovingElements(t)},t.prototype.dealBorderResize=function(e,t,n){var i=this,r=t.left,o=t.top,a=t.right,s=t.bottom;if(this.updateSelf({position:{x:r,y:o},size:{width:a-r,height:s-o}}),"multi"!==this.element.selectStatus){for(var l=this.element,c=[],u=this.upime.view.elementsRoot,d=this.upime.elementManager.getAvailableElements((function(e){return!e.frame&&e.parentRefSystem==u||e.frame==l})),p=0,h=d;p<h.length;p++){var f=h[p],m=f.frozedGroup||f.group;if(m){var v=m.members,g=v.filter((function(e){return!e.frame||e.frame==l})).filter((function(e){return e.isSupportFrame}));if(0!==g.indexOf(f))continue;var y=g.map((function(e){return e.getBorderBox()}));y.some((function(e){return l.checkBorderInFrame(e)}))&&c.push.apply(c,v)}else f.isSupportFrame&&l.checkBorderInFrame(f.getBorderBox())&&c.push(f)}if(e.isEnd){this.tempWrappedElements.forEach((function(e){e.showInParentShadow=!1})),this.tempWrappedElements=[];var b=[],E=this.element.getMembers();E.forEach((function(e){c.indexOf(e)<0&&(i.addUpdate(e,{frameId:null}),b.push(e))})),c.forEach((function(e){E.indexOf(e)<0&&(i.addUpdate(e,{frameId:i.element.id}),b.push(e))})),b.length&&this.lockOtherElements(b)}else this.tempWrappedElements.forEach((function(e){c.indexOf(e)<0&&(e.showInParentShadow=!1)})),c.forEach((function(e){i.tempWrappedElements.indexOf(e)<0&&(e.showInParentShadow=!0)})),this.tempWrappedElements=c}},t.prototype.checkKeepRatio=function(t){return this.isKeepRatio()&&e.prototype.checkKeepRatio.call(this,t)},t.prototype.checkPointDirection=function(e,t,n){return this.isKeepRatio()?Ht(e,t,n):zt(e,t,n)},t.prototype.dealClick=function(e){var t=this.element.checkClickName(e.position);null!==t&&(this.editNameFocusOffset=t,this.upime.updateView(),this.editingName=!0,this.element.editingName=!0)},t.prototype.checkSelectRelation=function(t,n){return this.element.checkClickName(t)?{transparent:!1,metric:-1}:!1===Ot(t,this.getBorderBox(),8/this.upime.view.scale)?null:!0===this.element.hide?{transparent:!1,metric:-1}:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.supportLinkTo=function(){return!0},t.prototype.unselect=function(){this.editingName&&(this.editingName=!1,void 0!==this.newName&&(this.updateProperty({name:this.newName}),this.newName=void 0)),this.element.editingName=!1,document.body.removeChild(this.tempInput),this.hideRatioPreview(),e.prototype.unselect.call(this)},t.prototype.updateFrameRatio=function(e){this.hideRatioPreview();var t=this.upime.createLock([this.element.id]);if(this.currentOp=this.getOp(),"custom"!==e){var n=this.element.position,i=n.x,r=n.y,o=In(PM[e],this.element.size.width*this.element.size.height),a=o.width,s=o.height;this.dealBorderResize({isEnd:!0},{left:i,top:r,right:i+a,bottom:r+s},void 0)}this.updateSelf({type:e}),this.updateBorderBox(),this.currentOp.sync(),this.upime.clearLock(t)},t.prototype.showRatioPreview=function(e){if("custom"!==e){var t=this.element.position,n=t.x,i=t.y,r=this.element.size,o=r.width,a=r.height;this._frameRatioPreviewWidget=new ih(this.element.id,n,i,a,o,PM[e]),this.upime.view.addAssistWidget(this._frameRatioPreviewWidget)}},t.prototype.hideRatioPreview=function(){this._frameRatioPreviewWidget&&(this.upime.view.removeAssistWidget(this._frameRatioPreviewWidget),this._frameRatioPreviewWidget=null)},t}(Lb),FM=tr("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAYAAABzwahEAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAPqADAAQAAAABAAAAPgAAAAAlIyr7AAADaklEQVRoBe2a227bMBBEk7av/f8P7Xtcj5pDDMdLyQGslBK0gLKzN2qGa6RAnfe3sb2PS4eq3Cq2KS7jaobcV3qZ2cOXwgYvar1O3nHOVbUql3PfETcx9rIqR3mpQR5PEe/5EaZX3ns8/yo8EuT5EXYOt18eBUbElvcxej33SuyiOFc5vTdro/wyp4GKLDmvg722HDI4g9oe3kWC5Xn0zsQdj2rjLszFOtYhxODu4J2DFKvXIRQPBcXiysyST+FqkCHK/Y9Bnn73wnsY5N0L+/NRvFj1TnwK14yLFUZw+uzTrEz5PQyxOtuFgiWYHvm8AGqaf3PhSdiFSbQ/qnER9Om8PEO5Vxrk5XkQrHcjVh4uzIiHckvswimoyONi/6jhAPbbOPoFKN0uQcIqQzh+1FfN/u9cfhKl4cEqQYjFq6fqezhskgR84Y/v6KUgNbkxlHnvmQ2POHcaEE6zRIDd0zebyIqPuDp3sHobXhNEE756yYw5+OJLjmvCNcCw/FHsKc4j4QxLrOMjiHe+jjvuI+Fd0xmDFJ43pFiG/xfN/ROuePh7/NS/z93A3Jobu03OufE2eXZwCT/7hlPftfG8kbPH18bPvuHUd208b+Ts8bXxs2849V0bzxs5e3xt/OwbTn3XxvNGzh5fGz/7hlPftfG8kbPHz2y8fad8oMvY5JzCNeBDYPwRtMMVL87CHj/1/+pHEPtljrlxDvAbckx9Zu98HXecR8JpYlD+KPYU5zXhfsBRhQ95IxyR2irYPX9GdYSti6tzB7u2h19uanJjKPPeMxsece405N+5SYQPCuffis0mNPmIb7X1ro+Pepe8B5X47Jk13hQt4voeme+S3QvrUvDC/pCX57nDdpbwHsbH1ReDUDbtnk8s/eK0nOEfdSUkAlsa7oG8DpMJ06ccon3OsWZeZfDRefBwLz6K8dTUjym3mAsn14qfCQQqlCjVUzBi8erdw+DmXtifFE6t45PC1YS4rvEecAGIk3ec/XvG4ilzUeDK07sM6YeTb8nPfNbprcSS8zP2xAjXO8AumLzXOj4QxnuR3JavZjz3SowQP5Pclu9mUpQXhamvYZ/xfs+/CiMuz/P8CPvMzYk69ibhqlblcu47YhfK+6pcV/tJ9OlnERO0VsM1kTnYeteErtXywJnjJtZJ/gUsF+yHFNomsgAAAABJRU5ErkJggg==");er(FM);var zM=tr("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMCAwaDI0djI0SDB6Ii8+PHBhdGggZGF0YS1mb2xsb3ctZmlsbD0iIzk3OTc5NyIgZD0ibTEwLjk5OCAxNS44NzQtLjAwMS0uMDAxLTEuNjQxIDEuNjQ0LTEuNTI3IDEuNTI1aC0uMDAxbC0xLjg5OCAxLjlhMSAxIDAgMCAxLTEuNDE1LTEuNDE1bDEuNTQyLTEuNTRjLTEuNjMtMS4xNjktMy4xNjctMi44NDItNC42MTEtNS4wMDdsLS4yOTMtLjQ0OGEuOTk1Ljk5NSAwIDAgMS0uMDcxLS45M2wuMDUtLjA5OC4wMjYtLjA0NEM0LjMyMSA2LjUzMyA3LjkzOCA0IDEyIDRjMi4xMTkgMCA0LjExNy42OSA1Ljk5MyAyLjA0OGwyLjA3OS0yLjA3N2ExIDEgMCAxIDEgMS40MTQgMS40MTRMMTAuOTk4IDE1Ljg3NFptOS45LTcuMDczYTI0LjcxMSAyNC43MTEgMCAwIDEgMS42MyAyLjE3NmwuMzIyLjQ5MS4wMjYuMDQ0LjA0Mi4wODQuMDI4LjA3LjAyMy4wNzQuMDE4LjA4MS4wMTIuMDg3LjAwNC4wOTdhMSAxIDAgMCAxLS4wMS4xNDVsLS4wMjYuMTE2LS4wMzYuMTA3LS4wNC4wODYtLjA0NS4wNzctLjIzNS4zNjJDMTkuNSAxNy41OTMgMTUuOTYgMjAgMTIgMjBhOS40NjQgOS40NjQgMCAwIDEtMi4wNzMtLjIyOGwxLjc3Ny0xLjc3OEwxMiAxOGMzLjE0NSAwIDYuMDc2LTEuOTU5IDguODA1LTUuOTk4YTIyLjg5NyAyMi44OTcgMCAwIDAtMS4zMjYtMS43ODJMMjAuOSA4LjhsLS4wMDIuMDAxWk0xMiA2Yy0zLjE0NSAwLTYuMDc1IDEuOTYtOC44MDIgNiAxLjM4IDIuMDQzIDIuODEgMy41NTUgNC4yOTUgNC41NWwxLjctMS43YTQgNCAwIDEgMSA1LjY1Ny01LjY1N2wxLjcwNi0xLjcxQzE1LjA5IDYuNDkgMTMuNTcyIDYgMTIgNlptMCA0YTIgMiAwIDAgMC0xLjM5MyAzLjQzNWwyLjgyNy0yLjgyOUExLjk5NCAxLjk5NCAwIDAgMCAxMiAxMFoiIGZpbGw9IiM5Nzk3OTciIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvZz48L3N2Zz4=");er(zM);var HM=tr("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAYAAAB91L6VAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnW2a3KiSRjUrs3s5uQr7rqKWY/fKeh7KynJWlpQCXj4iguM/c6cLEDoRcBJEKv9v4x8EIAABCEAAAsMJ/N/wK3JBCEAAAhCAAAQ2BEwSQAACEIAABCYQQMAToHNJCEAAAhCAAAImByAAAQhAAAITCCDgCdC5JAQgAAEIQAABkwMQgAAEIACBCQQQ8AToXBICEIAABCCAgMkBCEAAAhCAwAQCCHgCdC4JAQhAAAIQQMDkAAQgAAEIQGACAQQ8ATqXhAAEIAABCCBgcgACEIAABCAwgQACngCdS0IAAhCAAAQQMDkAAQhAAAIQmEAAAU+AziUhAAEIQAACCJgcgAAEIAABCEwggIAnQOeSEIAABCAAAQRMDkAAAhCAAAQmEEDAE6BzSQhAAAIQgAACJgcgAAEIQAACEwgg4AnQuSQEcgm8vb19fyj7+L+/bdv270k7v+///Xa7ffzv3GtSDgIQGEMAAY/hzFUgcElgl+1dsj8uK+QXuEs4Cfs3Us4HR0kI9CSAgHvSpW0IvCDw9vb2c/9zS9nmMr9L+X+pAlLOxUY5CLQjgIDbsaQlCLwkMFm4V9H5EDIyvkLF3yHQhgACbsORViDwhcCDcNPz2sfntx5oIWQPUaKPrgkgYNfho/OWCDw8w/Uo3CuUScg8Q76ixN8hUEAAARfAoigEHgkEF+5VsJOQeX58RYm/Q+AFAQRMekAgk0DHU8qZPTBdDCGbDg+ds0gAAVuMCn0yQ8D4wSkznJ46wglrq5GhX6YIIGBT4aAzswkg3C4R4EBXF6w06p0AAvYeQfovEUC4Er7aygi5lhz1QhFAwKHCyc1cEXD+1aCr2/P6d05Ye40c/ZYIIGAJH5WtE1j8pLL18Jz1DyF7jRz9LiKAgItwUdg6AYRrPUJV/eOEdRU2KlkngICtR4j+vSTAV4OWTBCEvGTY4900Ao4X0/B3xMGp8CEuuUG+8lRCi7KmCCBgU+GgM0cEEC55UUCAE9YFsCg6lwACnsufqx8Q4KQyadGQAEJuCJOm2hJAwG150loFAYRbAY0qtQQ4YV1LjnrNCSDg5khp8IoAJ5WvCPH3gQQQ8kDYXOozAQRMRnQngHC7I+YC7QhwwrodS1q6IICASZHmBPhqUHOkNDiPAEKexz78lRFw+BCPuUFOKo/hzFWmEuArT1Pxx7s4Ao4X0yF3hHCHYOYitglwwtp2fMz3DgGbD5GNDnJS2UYc6IVpAgjZdHjsdQ4B24uJiR5xcMpEGOiEbwKcsPYdv+69R8DdEfu4AML1ESd66ZoAB7pch6995xFwe6YuWuSksosw0cnYBBBy7Phe3h0CvkQUpwAHp+LEkjsJR4AT1uFCen1DCPiakdsSCNdt6Og4BDjQtUAOIOBAQUa4gYLJrUDgMwGEHDAjELDjoPLVIMfBo+sQ0AhwwlrjZ6I2AjYRhrxOcFI5jxOlILAgAYTsMOgI2HDQEK7h4NA1CNgmwAlr2/F57x0CNhQkvhpkKBh0BQKxCCBkg/FEwJODwsGpyQHg8hBYjwBfeTIScwQ8OBAIdzBwLgcBCFwR4IT1FaFOf0fAncDem0W4nQHTPAQg0JoAQm5N9KQ9BNwYNF8NagyU5iAAgdkEOGHdKQIIWATLSWURINUhAAFvBBByo4gh4EKQCLcQGMVbE/jfQYNpQvy+bdu3/W/pf/MPAqMIcMK6kjQCvgDHV4MqM4tqrQi8C/d2u/0saXDP2x8IuYQaZRsRQMiZIBHwASgOTmVmD8V6EKgS7quO7DJORZKQWR33iBptnhHgK08vcgMBb9uGcJk9JhJoLtyre0HIV4T4e0cCnLB+gLusgHfppmdmrAg6jjaa/kLg/gz39+12u09GUzEh5Kn4V7/4+3a1lbEwOhhLCZiV7uj04nrbtrk7McpBQ/J2EoHlZLyEgHfx3g+kTMotLrsIAXfCvYoLB7quCPH3xgSWEXFoASPexsOC5o4I3IVbfFLZK06E7DVy7vodXsRhBYx83Q02Tx0efnDKKpyn58epm5ypsBosv/1Kz4iLvobn5VbDCXifEH55CQD9dEEA4WaGiQNdmaAoVkogHVr8p7SS9fKhBMyq13q6uemfuZPKbsg9dRQhe42c2X7/E+nEdBgBI1+zA8ZDx8IdnLIKnRPWViPjql9htqRDCBj5uho8FjqLcC1E4c9LcNIz4/t7rHl+bCQuDroRQsLuBYx8HQyV+V1c7qTyfOR1PeCEdR23RWu5l7BrAXPgatFhd33bCPeakYsSCNlFmGZ20rWE3QoY+c7MeZPX5qSyybC06xRfeWrHMlJLt9vNrcfcdvzt7S191YhnRpFGUtm9INwyXuFKc8I6XEhrb8jtV5RcChj51uap63p8Nch1+Pp3HiH3Z2z4Ci63ot0JmK1nw0Ogbdc4qdyW53KtccJ6uZC7k7BHAbP1HHNcIdyYcTVzVxzoMhOKXh1BwL3IpnZZ/fakO7xtTioPR84FHwkg5JD54ErCrlbAPPt1P2A4OOU+hDFvgBPWceLq6VS0GwGz+nU5QBCuy7DRaQ50uc4BN6tgTwLm2a/9MYFw7ceIHlYQQMgV0OZVcfO1JE8C/m9ePLnyCQG+GkRqLEmAE9a2w+5lG9qFgNl+NpPsnFQ2Ewo6YokAQrYUjfe+uNiG9iJgtp/n5DfCncOdqzonwAnr6QFEwK1C8Pb2xvZzK5iv2+GrQWM4c5XFCCDk8QH3sA1tfgXM9nP3xOXgVHfEXAACfwnwladh2fDP7XZLiwqz/xCw2dB06xjC7YaWhiFQToAT1uXMMmuY34b2IGCe/2Zm20kxTipr/KgNgaEEEHIz3AhYRcnbr4oJItxiZFSAgF0CnLCujo357wOzAq6OrZmKnFQ2Ewo6AoH+BDjQlc/Y+kEsBJwfSyslOalsJRL0AwIGCCDk8yAgYDFB+QrShnDFHKI6BFYigJD/RhsBi5m/qIA5qSzmDdUhAIGPn3BNKH5s2/Z9NSYIWIz4IgJGuGKeUB0CELgmsNoJawR8nRMvSwQVMCeVxbygOgQgoBOILmQELOZIEAFzUlnMA6pDAAL9CUT7yhMCFnPGqYARrhh3qkMAAvMJeD/QhYDFHHIiYE4qi3GmOgQgYJ+ANyEjYDGnrAvYeoBF/FSHAAQgcEjAww/lWJ+fPbyIw/RPEVoPMHMHBCAAgV4EWCBpZBGwxm9DwCJAqkMAAm4JIGAtdAhY44eARX5UhwAE/BJAwFrsELDGDwGL/KgOAQj4JYCAtdghYI0fAhb5UR0CEPBLAAFrsUPAGj8ELPKjOgQg4JcAAtZih4A1fghY5Ed1CEDALwEErMUOAWv8ELDIj+oQgIBfAghYix0C1vghYJEf1SEAAb8EELAWOwSs8UPAIj+qQwACfgkgYC12CFjjh4BFflSHAAT8EkDAWuwQsMYPAYv8qA4BCPglgIC12CFgjR8CFvlRHQIQ8EsAAWuxQ8AaPwQs8qM6BCDglwAC1mKHgDV+CFjkR3UIQMAvAQSsxQ4Ba/wQsMiP6hCAgF8CCFiLHQLW+CFgkR/VIQABvwQQsBY7BKzxQ8AiP6pDAAJ+CSBgLXYIWOOHgEV+VIcABPwSQMBa7BCwxg8Bi/yoDgEI+CWAgLXYIWCNHwIW+VEdAhDwSwABa7FDwBo/BCzyozoEIOCXAALWYoeANX4IWORHdQhAwC8BBKzFDgFr/BCwyI/qEICAXwIIWIsdAtb4IWCRH9UhAAG/BBCwFjsErPFDwCI/qkNgFIG3t7fv+7Xu//f3/dq32+3jf4/qT4TrIGAtighY44eARX5Uh0BPArt0k3B/ZFwnSfh/yDiD1F4EAeezOiqJgDV+CFjkR3UI9CDw9vb2c283R7zPXUDEmUFBwJmgToohYI0fAhb5UR0CrQns8q0R7xcR3263f1r3L1J7CFiLJgLW+CFgkR/VIdCSwNvb269t2+7PeFs0zWr4BUUErKUYAtb4IWCRH9Uh0IpAB/k+du0fng1/jRQC1rIXAWv8ELDIj+oQaEGgs3xTF3+zHY2AW+TqYxsIWCR6u93MMxRvkeoQME1ggHzv959OSN8Pd5lmMqpzrIA10ublQYC1AFMbApEJDJQvEj5IJOZnbXQhYI0fW9AiP6pDoJbABPm+d5Vdr78RQ8C12funHgLW+DEYRX5Uh0ANgVny3fvKVvQOAgHXZO/fOghY44eARX5Uh0ApgcnyZRX8EDAEXJq9n8sjYI0fAhb5Uf3Tdt7zu4rTH78dMDr6nuvzu4z/faoX4r3HFuTLKpgt6FbzFgIWSfI8SAS4YPWH9xPfBdvyxRG5RO9CTqJOX7Ex/2MEhuSbGLMNvW0bK+Dc4XZcDgFr/FgBi/yiVzci2xLMScTvUk6VrIjZmHzZht4zCgGXDK2vZRGwxg8Bi/wiVhd/CMAikqmvY7Qo3/3Difn5s3cyIWCNsPkEIsBagKndn8DDKjc9r52xndz/Jv9eYaiMrcoXAf9JCOZnbeghYI0fK2CRn9fqAVe5NaF4l3GvrWrL8t1hLf9+aARcM2z+1kHAGj8ELPLzVr3hT915u/Wr/jaVsQP5MvZZAV+Nicu/I+BLRK8LcApaBOigOqvd4iBJ29Qe5MsWNFvQxaPioAICFikiYBGg4eqsduXgFIvYi3z5dSQELI8OXkWpI0TAOkNrLSDe5hHJErEj+SZA/DwhW9DyQGEFLCJEwCJAQ9UR75BgpENbX1784Uy+CdTyB7ASBA5haWMGAWv8OIgh8ptdnee70yLwsSp2KF/G/Z42CFgbPwhY48dAFPnNrM6KdyZ919fmNZQIuEkCI2ARI1vQIsAJ1RHvBOhxLsmz34dYsgLWEhsBa/xYAYv8RlZHvCNph70Wz34RcLPkRsAiSlbAIsAB1XfxrvCayAE0l74EW89P4WcFrI0HBKzxYwUs8utdnVVvb8LLtI98D0KNgLX8R8AaPwQs8utVHfH2Irtku8j3JOwIWBsPCFjjh4BFfj2qI98eVJdtE/m+CD0C1sYFAtb4IWCRX8vqiLclTdpKv/R0u91+QuKcAALWsgMBa/wQsMivVXXk24ok7ewEkG9GKiDgDEgviiBgjR8CFvmp1RGvSpD6BwSQb2ZaIOBMUCfFELDGDwGL/JTqyFehR90TAsi3IDUQcAGsg6IIWOOHgEV+tdU9vj+49l6pN4wA8i1EjYALgT0VR8AaPwQs8iutzqq3lBjlMwkg30xQj8UQcAW0hyoIWOOHgEV+JdWRbwktyhYQQL4FsBBwJSy2oNuBu7fEqyjbMz1qEfmO4bzgVZCvEHRWwAK8bdtYAWv8WAGL/K6qv729fd+27ce2ben/8g8CLQkgX5EmAtYAImCNHwIW+b2qvsv3V8dL0PS6BJBvg9gjYA0iAtb4IWCR31l1tpw7gaXZRAD5NsoDBKyBRMAaPwQs8juqjnw7QKXJOwHk2zAXELAGEwFr/BCwyO+5OvJtDJTmHgkg38b5gIA1oAhY44eARX6P1ZFvQ5g09UwA+XbICQSsQUXAGj8ELPK7V+fNVo1A0swRgd+32+0f0LQngIA1pghY44eARX6pOvJtAJEmzggg3465gYA1uAhY44eARX7IVwRI9VcEkG/n/EDAGmAErPFDwAI/5CvAo+oVAeR7RajB3xGwBhEBa/wQcAU/XrBRAY0qJQSQbwktoSwCFuDxKkoNXqrNu6DLGCLfMl6ULiaAfIuR1VdAwPXsUk1WwBo/BFzAD/kWwKJoDQHkW0NNqIOABXgIWIPHCjifH/LNZ/VQ8ve2bf8+/f/pQ1/67x//draP/+n+wxXf9v+4wg9ZIN+qFNMqIWCNHytgjR8r4Ex+HLjKAvW//UPdz6zSBYV2SScRJylHEzLyLciFlkURsEYTAWv8EHAGP+R7Cum+wk0C+bSqzcAqFXn4mcfUjmchI18pE7TKCFjjh4A1fgj4gh/yPQTUbaVbk86OY4R8awLesA4C1mAiYI0fAn7Bz/HELmbFaXVz7yN2HKPu8t3fTf6N11ieDwcErE0VCFjjh4BP+PHDCp/AmBNv6h3yfSmW9Bz+x17CZPzEqatJdQSsYUTAGj8EfMAP+X5AMTtxI99s+d4Lmo2lOIVJ1RGwhI/vAWv4eBHHMz/k+07E9GSNfIvli4TPd7r+U+fQnvWtvyiJFbAYfesBFm+vqDryRb5FCVNWeNQz3/u281nvTH+4KkOql2YFrDFEwBo/tqB3frxow/aqN4WJlW/1yve54j+jvzYmTlPdqiNgDS0C1vgh4D8Te/oe6S8Rpefq5ldFjncnrKx8kfDBCEXA2rSFgDV+CNj3ykqMvv0t533l+3iit8U9j2rDqnzT/Xfv2yjIynUQsEKPH2PQ6PFrSJ63NdXYu5iAWfk223Y+ashFDqiJ/qo+AtbosgLW+C29AnY8uYtR97H6cRyf7mJryMb84wc12RFwP4IIWGS76inohhOYGIHh1bvLocUdOY5Pd74d2CwrYVbA2mhFwBq/JVfACx+66i4HMR3fq3cQTItu5bTRnW9HNkuejEbAOWl9XgYBa/yWEzDyFROmc/WOgunc8/7b+r3ZrLgbhoC1YYGANX4rCjh93cjzz9fVRtz8Cqe3YGrBZdTzvPJ9vL3u95HBcmgRBKzhRsAav6UE7HiCF6O8IV+V4Hn97tIanLdLPQ9GwNrAQMAav2UEPHgSE6PStLr5CdVxbKLJ95545nOm1QhBwBpJBKzxW0LAPPcVk0SsvvO/b/t/e2jO86OAqPK9h8f8romYlu/VEbBGEQFr/FYR8IrPfbsL4lXq7avaVOTqxwHEDJ5SvTtbC7sCKxzKQsDa+EHAGr/wArYwkYkhqq0+ZQWzAO8l5LsnXfitaARcO738qYeANX6hBbyADM6i310SzxdehHV3rgYfl4SWMALWBIKANX5hBWxwIhMjVVR92Op3EfEm+CvK9z3pIm9FI+CieeVLYQSs8Qs7uBz/dqwY0TG/67uQeJeW756M3T98qElfWx8B15JjC1ojt9eO+Ol2MTk85sGQiXIxvt2ZOtmtCbkVjYA1jbAC1viFWwE7mczEqJ1W7771jHzbhs5ZvoaTMALW8hkBa/wiCvg/EYnX6iNWait9nWsEz/Q96MTUzb9oO2YIWEs9BKzxCyXghZ/7pizoujpZjC3yPZ9XuuaZOJ0VV0fAxcg+VUDAGr8wAl5sa/RL1HuuTBZji3yv55QwEkbA18F+VQIBa/xCCNjZczQxYofVu0kD+bYNV5Rc7fmBry3x160hYI02Atb4RRHwSs8mjyLe5fBVFFlkDpFuH2Lu1w/GM8QqGAFnjo6TYghY4+dewIut0I6i3UUcwWRxNUq6MHy8aFCe7iWMgK+Gxuu/I2CNn2sBB53USiPaRR4LHbrqwm8B+b7fovetaARcOt18Lo+ANX6uB9BCkngV5ebbzwt9sEG+4vzR+/S93j2eAfdkiIBFul4/wbL1/CfwPeK3yAcb5CvOHQ/V3W5FswLWkgABa/y6TOBily6rL7RCu2LRXCKLsG3O7TlQi3B8vO3mOzFXyd/i7whYo4iANX5eBbz6qed71JtPegusfpGvOGecVO/OtUe3EbBGFQFr/NwJmK3nTwHvIeDIr/LsLokFV76PCeluKxoBawJBwBo/VwJefHL7EunWz38X4Nv8A8tjUBbgdznbtM7JywuKBRCwBhABa/y8CZit57/xbr6aC779jHzFuSKzuqtVMALOjOpJMQSs8XMjYFYXXwLdQ8BRt5+RrzhPFFZ3I2EEXBjZp+IIWOPnScBR5VAbwaaTXOAPOF3lm4LHuYSvKexlKxoB104/f+ohYI2fCwEH3xqtjWBTsQSVSFNGZ4EK/OGlNjdTvaYfEJWOvKqLgDWyCFjjZ17ATG6nAW4ql4ACbsrnYhL/vm1bOp/AvwcCHlbBCFhLWQSs8UPAIr+J1ZsKJtguQ1M2VzHmQ+IpIfOrYAR8ld2v/46ANX4eBMzJ5+MYN5VMIAE35ZI7vKxP5Ln30bhc84OCjfuXnt+bPltifRcBAYsZaT3A1geIiL+6euu4BRHwFPmmIJKnx6ncOk+rB8xJRetxs84PAYsZaT3A1geIiL+6euu4BeA8Tb4I+DyNW+dp9YBBwK3RvbeHgEWsDBAR4KTqrePmXMBT5YuAEXCvaaD1OG/dTwQsErUe4CBbo2KUvlZvGTfnJ6CnyxcBn6Y3z4DFkd9ynItdOayOgEWq1gPsXA5idPqvLJzzNSFfBIyAew106/MzAhYjbz3AzgUhRudldVk+ztnK998yOM638FuieGzLVIyObtJ63KzPzwhYHDrWA8zq4jTA0uSGfMWB81Cd7wH3ydF2ETpvCQFrlBGwxs/894B3Af/ctu2HeKvRqle/5AD5tk0FBHzIszo/20bndWsIWKONgDV+LgTMKrjdBId8xQFzUN050/ZAto15pRFV6zuUCFgMtPUA32+PSe5LoItXGM4ZSlvu4jB5WZ2T+l/wmI3Vc09ZAWsjAwFr/Nx8UmUr+kugi77igXzFgfKiOgL+BKcoL/tFJa9lBJzH6awUAtb4uRIwW9Gfg527e4F8xUFyUd36JN737v2ufj3MJ7ljfHCMPy6HgEXy1gN8sGXEgay/UC63+pCvOECu5ctPEf5lVPxYpG90rlu3/uHJ+vyMgK9z7GUJ6wE+6rxzqYgR+1T95YTnnNPlh4uWIGvb4gT0BzlXW8/3XiPg2sz/Uw8Ba/zcbUF7GThiWHKrnwoY+eYi1Mrx/PeDn4sPTAc7avwcoTAEELAAL1X1uAJO/XYuGDFqf6sfxc85G1cTOQJ+z0V3W89ePshbn58RsDiVWw/wq9tzLhoxcscrD+dMvMmX57/b5nLrGQG3mX4QsMjRs4D3lbDpLSQxPDnVP1YfyDcHV7syPP99Z+nqQxNb0O3yP7WEgEWeAQS8/KnoFEPkKw6EiupsP/vdemYFXJHwB1UQsMjRu4B5HvznGZzjd2W7XEGx+vW99YyARXHs1RGwyDGCgNmKFpNgXnWX8t3z7de2bekZ8Kr/3MbuMWB8DUlLXwSs8XN7CvrgWc7yW9FiKoyu7noCtz5xdw6m21PPPANumxkIWOQZZQXMVrSYCGOre5fvyqefXZ96RsBtBzoCFnlGEjBb0WIyjKnuWr6rbz8zX4wZJPerWOeNgMV8sB7g0ttzfhq49Ha9lY8g35VXv+7jxwq47ZSBgEWe0QTMVrSYEP2qh5i8F/7qUZjnvhzCajfIEbDIMqKAV98mFFOiR/Uo8l31oF+o574IuN0QR8Aiy6gC5nmwmBjtqoeQ7+L5FCaGbEG3G9ipJQQs8gwu4FVXLGJWNKseZuJm67lZTphqyPrXyazPzwhYTGfrARZvj19NUgHW148k31UPXoV87ssWdP2gfq6JgEWW0QXM82AxQeqqh5HvwlvPYZ/7IuC6QX1UCwGLLFcQ8MKTqJgdVdWjyXfVV06GiuNZJrMFXTXGPyohYI1fmFdRXmHg+8FXhJr8PdSkvXDOhN96vmc7AtbGPQLW+C0j4H0VzKEsMV9eVI8mX5779ssVMy0jYC0UCFjjt5SAeR4sJst5deTbDe3Qhpd47ssz4HY5hYBFlqs8A/Y06MSQjq4eSr4rf0hjLhg9dK6vZz0mCPg6hi9LWA+weHuH1fkx9WZUkW8zlNMbChfLHKJsQedQOi+DgDV+y21B33EtfMBGzJiP6uEmbF620So1/LSDgLVYIWCN37IC3rcaOZRVlz/It46bxVrLnHg+go+AtZREwBq/pQWMhKuSJ9SEvfjjiOUOXT1nPAKumgM+KiFgjd/yAt4lvOrLFkqzB/mWErNbfnn57mP/P7sh2szPzwhYzJ4VD2F53IoSw9yiejT5rv74IdxjhJokZwVcQ+1vHQSs8TP/CUu8vezqi29FXnFCvleEfP0d+e7xQsBa4iJgjR8CfuDHyejDZAojX+L7Ht8w8RSnvvfqCFijiIA1fgj4iR+T9CcgYSZr4op8PT56sv6IEAEjYJHA1+pM1nEma2L5kd9hPky1HPCsgDWaCFjjxwr4hN/iE7f7yXrx+D1nNSeez8c5p6AFhyBgAV6qan2LQ7w9qfqik7hr+S4as1d5jnxf0GEFLE2RGwLW+CHgC36LvZ7QpXx36aZI/hCHQ7TqyPd6fLMCFrIeAQvwWAHnwVtEwu7ky2r3Zf4i34zhzQo4A9KLIghY48cKOJNfcAmbl+/+Pe3ve7hY6b7OW+SbP65ZAWeyOiqGgAV4rIDL4AWVcHf57ivV33fat9vt438/R+BJtOnP37Ztu4u3LGBrlka+BXFnBVwA66AoAtb4sQIu5BdMwqPky4q1MM+E4rzlqgAeAi6AhYA1WEe1OQVdxjTQKyuRb1noPZRGvoVRQsCFwJ6KswLW+LECruAXQMLItyLuxqsg34oAIeAKaA9VELDGDwFX8HMuYORbEXPDVXjmKwQHAQvwto3vAWv4eBFHKT/k+5oYXw0qzSipPPKV8PFjDCI+BKwC5BlwPkHki3zzs6V7SeTbADErYA0iW9AaP7agM/khX+SbmSojiiHfRpQRsAYSAWv8EHAGP+SLfDPSZFSR7s/wR92IhesgYC0KCFjjh4Av+CFf5CsOsZbVkW9LmhvPgFWcCFgkyDPgc4DIF/mKw6tldeTbkubeFitgDSoC1vixAj7hh3yRrzi0WlZHvi1pPrSFgDWwCFjjh4AP+CFf5CsOq5bVecFGS5pPbSFgDS4C1vgh4K8DMr34/5eIdVb17islvuc7LLScdB6AGgFrkBGwxg8Bf96OQr4v8gn5ioMtv3r3D1L5XYldEgFr8UXAGj8EvPNj25ltZ3EotaqOfFuRzGgHAWdAelEEAWv8EPCfryKw8mXlK46kJtWRbxOM+Y0g4HxWRyURsMZveQEjX1a+4hBqUR3xtqBY0QYCroD2UAUBa/wQ8NvbfyLCWdW7T9o88x0S2u5xHHIXDi/i4cO39fc0IGA98ZdJYmH+AAASbUlEQVT9msPb21s67Zy2n7396z5pI98hKdE9jkPuwulFPIx/BCwml/Utjm3blpwEHAume7wcsxFH67Dq3WM47E6cXsjD6jehRcBigjkQsPkgiyE4rO4hLgcd7z5xI98e2fapze4x7H4HAS7gYfWLgBskmpOJfqlJwalkusfIKZcGo3RIE93jN+QuAlzEy+oXATdINicCXmoV7OXT70P6dZ+8kW+DwX7eRPf4de19sMY9jX+2oMXk8yLgVZ4Fe/r0u6de98kb+YqDHPF2A9i6YWe5bv51pB5OQf/ctu1H60Tq0F73ib5Dn4ubdDYAu8fEGY/ieE+s0D12E+/N7aUdLYgSYwSsZpqnCc76docai1Tf0fZT9wncU262iP2gNrrHbdB9hLuMw3xHwGoWOtvyDD95OBFw9zg4nIzUodi7fveY9b6B6O07W/2mcJh/R4P5Leh91eXmbUvRV8EOBNx9Ike+TVXTPV5Ne7toYw7G/ZfIeJiLvQjYy3PglAShJxTjA7E7e+TbzED/25/R/W7WIg11IeBsF/LOwPz2c+ooAu6Qsh4+edXetmEBI9/aoI6t1z1OY28n/tUMj/lX8M1vP7sRsLdt6MirYKMrwO6TutH79jT7d4+RJxhe+srqt2+kXKyAdwF72oYO+2IOgyLqPrEbvOe+s0Lb1rvHp213ae2RAKvfvvngRsCsgvsmQknrhk5DDpnc91VA+i66x19+Kgltq7Lp+W76EJo+NPPPKQGnHzxdPPu9p4Q3AbtaBUfdijbyqXiIfJ/nTmT80iZTYuLUb+a7beiDdgkrF89+EXBJSOvLhpyQDHwyns71QcQpO1ZeGXOauX5+MFvTyIfsUj6uVr/p5lytgB1uQ6cuT5dFaRbnlJ8oYXM8F5Nx+trQv3yFKGeU+Czj9OBVgu1q9etVwN62oUMeyJokYHPyPdmiTv/5/v7yCKtjnun6dGlVr1n9VmGrquRxBZwmtF9Vdzuvknlx1KAZLGGXDPfVhCch31e4qc9pS48XZdQMDqd1WP2ODZw7ATvdhmYrWstrl/I9u+UHKacPk9/2cjNWyshWy8twtZ0evHL37PeeOF4F7G4bOgGP+oaszltWoeT7asZ+EvO96F3Qz1WPhH20Wk3Pa+//3v/OqjacN5vcUOdx3KSPJ424e/brWsCsgnvmcl3bnQbvMvKto04tCLQh4Hjr2e3qN0XO5Qp4F7DLVbDHk3q5Q7zxM2HkmwuechAQCXT6AC32Kqu629WvawE7XgW7/sR2NSQavKgC8V5B5u8QaEig8Qfnhj27bMr9XOp2Bex8FRxeMhUiDs/kcjqhAAQGE3C89ZxIuV79ul8BO14Fp64vI5yDU7+fDgZxKGjwrMvlILATcLz17H71G0XAXp8Fhz0VzewGAQjYJ+B46znE6jeEgFkF2x/o9BACELBFwPnWc5jdQ9fPgO8p7fyTXJhksjXF0BsIQOCMgOOt51A7hyEE7HwVvNTzYKZECEBgLgEWLHP5P149koDdPgtOAYn6liw7qU5PIAAB51vPIQ5ehRQwq2AmFwhAAAKvCXjeeo7wtaPn6IRZAe8Cdr0KXumrSUyUEIDAWALOt57DrX5T9EMJOMAqmOfBY+ckrgaBJQg433pOMXL/0o2jRIsoYO+rYCS8xJTITUJgHAHnW88hV78hV8BBtqLDfuIbN+VwJQhAIMJ8GPmAargV8H3IOf1h6ccZI+ynPqZFCEBgDAHnz33D7wZGFjBb0WPGOFeBAAQMEgjw3Df8IiSsgPetl/8MjovSLvGmrFJilIcABDbnz32XeAwXXcARVsHht2GYKyEAgbYE2Hpuy7NXa6EFHOEAwkPgWQn3GgW0C4FABALId5k3A4YXcKCtaFbCgSZJbgUCPQgEeO67xNbzPfarCDjKVjQS7jFr0SYEghDg2x++ArmEgPdV8K9t2777Cs9pb0O+FSZIbLgNCEwhEODQ1VKr33SzKwk40ip4uUSdMqNxUQg4IRDhue+K78JfRsD7KhgJO5lQ6CYEIJBHIIh8w3/n9yiaSwk44Fb0MqcF86YiSkFgLQJBDl0tu6O3nIB3CUd4Qcd9pvm9b92k/8s/CEBgEQKB5LvsVyxXFXC0rehlP0EuMtdymxD4QiDIoaslt57vwVxSwEGfByNhJmkILEIgiHyXn7OWFXDE58H73MNXlBaZhLnNNQkEOXSVgrfs1vPyK+BdwOl7wen7wdH+IeFoEeV+ILBt6QcWojw+W3rrGQHvBAIl9PMEhYSZsiEQiECwuYr5aaUXcbwah8ES+/FWSfJAEzC3si6BYHPU8lvPrICfxnKAd6iezU5IeN15mzsPQCCYfNl6fsjJpQ9hPY7NQN+pO5py+MQZYCLmFtYjEEy+KYAsCBDw8UAOmOyPN4qE15u/uWPHBAIuCpiDnvKRFfDXregopwxZCTuefOn62gQCypet54OURsAHUAJ9yf1oFmMgrD23c/fGCQSUL1vPJzmHgE/AIGHjsxTdg0BAAsg3YFBf3BICPhdw1Jd03O+YH3FYa6xzt8YJBD2DwnNfBFw38oJ+Gn2GwanEuvSgFgSaEQgqXx53XWQIK+ALQEEHxvNd8ym12VRKQxAoIxB4juHDPQIuGwxHpQMPkMfbRcJ6qtACBIoIBJ5bkG9GJrACzoCUigQeKI8E2DLKzAeKQUAlEHhO4cN8ZnIg4ExQu4TTLyelw1mR/3E4K3J0uTcTBALLlw/xBRmGgAtgLSThdKtsIRXmBsUhkEMgsHyZN3IS4KEMAi4EtsjJ6DsVtpIK84PiEDgjsM8dPwLvovGhvTD9EXAhsH0VHP07wo9UkHBFjlAFAo8Egq96060yT1SkPAKugLZLOPI7o5+p8Fy4Mk+oBgHkSw6cEUDAQm4sMLCe6bDFJOQLVdcjsMAcwaErIa0RsABvwZUwW01ivlB9HQLB3yefAol8xXRGwCLARSXMwGuQNzQRk8ACq9574NgRE1MYAYsA79UXGnSPxBiAjfKHZmIQWGgeYOw3SFkE3ADi4hLm9GPDHKIpvwQW2HK+B4cx3yhNEXAjkItLmFPSjfOI5vwQWGjVyxmQxmmJgBsDXfSZMM+EOuQRTdonsJh8OfvROCURcGOgi6+E+YTcKZ9o1haBxcSb4CPfDimIgDtARcIbW9Id84qm5xJAvnP5R7o6Au4czQUH6yNRDmt0zi+aH0dg1bF8u93wRKc0A2wnsI/NrjpwdwZIeECOcYm+BBYew3zdqGNqIeCOcJHwBwG2pAflGZdpS2Bh8SaQyLdtOn1pDQF3Bvwk4ZV+RemILKvhgfnGpeoJ7OL9FvinA6/gIN8rQg3+joAbQCxpYrHfEz5Cw2q4JGEoO5zA4qteVr4DMw4BD4R9v9QCP8ydQ5XVcA4lygwjgHjfUTMuh2XctiHggbCfL7XQq+vOKLManph/XPoPAcT7kQnId/CgQMCDgSPhQ+AM/Ml5uOLl952odC7jx4r3/3TPjMEJSYCAJ0A/kPBPJgFe3mEgFZfpAqveT6FGvpMyHwFPAo+ET8EzGRjJyYjdQLxfosp4m5joCHgifCT8Ej5fgzCUm967gnh59GMxhxGwsagwUXwKCIe0jOWnt+4wnk4jxgdcA8mMgA0EgZXwZRDYJrtERIFHAoiX3SUPIwIBG40SL+w4DAyf2o3mq5VuId7LSDCGLhGNK4CAx7GuuhLfFf6CjW3pqkyKXWkXb7pJvlJ0HGp+z9fgEEDABoPClnRWUNiWzsIUuxDizYov8s3CNL4QAh7PvOqKbK2dYmNLrSqjfFdiPGTHjw+q2ajGF0TA45lXX5Hnwqfo2JauzipfFRFvUbyQbxGu8YUR8Hjm0hX5IYeX+BCxlF12KyPe4tgg32Jk4ysg4PHMm1yRCQkRN0kk442Q51UBQr5V2MZXQsDjmTe7IpPTJUpWxJeI7BXgRxKqY8Jhq2p0cyoi4Dncm12V58JZKFkRZGGaW4gTzRJ/clzCN6cyAp7DvelVeS6cjZNJKhvVuILs5MisyWsZ4ZwGEPAc7l2uyks7srCmbel/b7db+glI/k0iwDZzM/DItxnK8Q0h4PHMu16R1UQRXiavIlx6YbaZdYYPLfAd+KY4xzeGgMcz735FngsXI+awVjGysgp8MCzjdVGaD45Ncc5rDAHPY9/9ymxJFyNGxMXIziuw2m0I829TyLcL1jmNIuA53IddlZVHFWpEXIXtTyVyToB3XhXxdsE6t1EEPJf/kKtzSroaMyLORMdqNxNUXTHkW8fNfC0EbD5E7TrIyqSa5fvJ6W3b0osO0v/m306AnOqeChy06o543gUQ8Dz2U67MhCljX35VzGpXzqGcBlj15lByXgYBOw9gTffZkq6h9qXOUqtivrfbJGdyG0G+uaScl0PAzgOodJ/VsELvU92wq2JypFmO5DSEeHMoBSqDgAMFs+ZW+M5wDbXTOiFWxWwxN82J3MaQby6pQOUQcKBg1t4KW9K15F7We18VpxIeDm4h3S45kNMo4s2hFLQMAg4a2JrbYruxhlpWHZMy5rluVux6FeKd5L3IOmoXATsK1oiushruTnmqjJFu9/jmXIBVbw6lBcog4AWCXHOLrIZrqBXXGSJjpFscl14VEG8vsk7bRcBOAzei26yGR1D+uMb9BR/NnhvzIWpo/K4uhnyvCC34dwS8YNBLb5mJvJRYk/IfQi45xLXH6tu2bd+b9IJGVAKIVyUYuD4CDhzclrfGarglzaq2Dr/i9LC9jHSrsHarlHYyeHVpN7wxGkbAMeI47C5YDQ9DfXWhJGRWuVeU5vydVe8c7u6uioDdhWx+h1kNz48BPTBJAPGaDIvdTiFgu7Ex3zNWw+ZDRAfHEEC8YziHuwoCDhfSsTfEangsb65migDiNRUOf51BwP5iZrLHiNhkWOhUHwIcsOrDdblWEfByIe97w2xL9+VL69MJsOqdHoI4HUDAcWJp5k5YDZsJBR1pRwDxtmNJSzsBBEwqdCOAiLuhpeFxBBDvONbLXQkBLxfy8TfMtvR45lxRJoB4ZYQ0cEUAAV8R4u/NCCDiZihpqB8BxNuPLS0/EUDApMRQAmxLD8XNxfII3H8A42decUpBoA0BBNyGI60UEkDEhcAo3oMA4u1BlTazCSDgbFQU7EGAbekeVGnzggDiJUVMEEDAJsJAJxAxOTCAAOIdAJlL5BNAwPmsKDmAwNvb2y9+5WcA6LUuwcGqteLt5m4RsJtQrdNRng+vE+vOd4p4OwOmeY0AAtb4UbsjAUTcEW7cptPvJP97u9040Rw3xmHuDAGHCWXcG0HEcWPb8M54vtsQJk2NIYCAx3DmKg0IIOIGEOM1wTZzvJguc0cIeJlQx7lRRBwnlsKdIF4BHlVtEEDANuJALyoIIOIKaL6rsM3sO370/okAAiYl3BNAxO5DeHUDrHavCPF3lwQQsMuw0ekzAsg4TG6w2g0TSm7kjAACJjdCEkDEbsPKatdt6Oh4KQEEXEqM8q4IIGIX4WK16yJMdLI1AQTcmijtmSSwi/j7tm0/THZwzU6x2l0z7tz1TgABkwrLEWBVPDXkrHan4ufilgggYEvRoC9DCSDiobhZ7Q7FzcU8EEDAHqJEH7sTQMZdEKfV7u/b7Zbez8w/CEDgiQACJiUg8EBgF3H6L+lZcXpmzL8yAmwxl/Gi9MIEEPDCwefWXxNgVZydIUg3GxUFIfCXAAImGyCQQQAZH0LiuW5G7lAEAmcEEDC5AYFCAovLmOe6hflCcQggYHIAAh0ILCJjtpg75A5NQoAVMDkAgUYEHmScWvR+gAvpNsoLmoEAK2ByAAIDCTg9TY10B+YIl4IAK2ByAAIDCBjeqka6A+LPJSBwRAABkxcQGEzAwOoY6Q6OOZeDAAImByBgkMCTkHs9P0a6BmNPl9YmwAp47fhz90YJNDrQxVeGjMaXbkEgEUDA5AEEHBB4+DnFb0/dvZ+2Tu9b/nf/G+9fdhBTuggBBEwOQAACEIAABCYQQMAToHNJCEAAAhCAAAImByAAAQhAAAITCCDgCdC5JAQgAAEIQAABkwMQgAAEIACBCQQQ8AToXBICEIAABCCAgMkBCEAAAhCAwAQCCHgCdC4JAQhAAAIQQMDkAAQgAAEIQGACAQQ8ATqXhAAEIAABCCBgcgACEIAABCAwgQACngCdS0IAAhCAAAQQMDkAAQhAAAIQmEAAAU+AziUhAAEIQAACCJgcgAAEIAABCEwggIAnQOeSEIAABCAAAQRMDkAAAhCAAAQmEEDAE6BzSQhAAAIQgAACJgcgAAEIQAACEwgg4AnQuSQEIAABCEDg/wHphIYrs1mFCAAAAABJRU5ErkJggg==");er(HM);var UM=function(e){var t,n=e.position,i=e.name,r=e.size,o=e.editingName,a=e.locked,s=js.value,l=s.viewbox,c=s.getElementAlpha,u=s.exportType,d=l.scale,p=n.x*d,h=n.y*d,f=r.width*d,m=r.height*d,v=e.useCallback("border",(function(e){e.clear(),e.lineStyle({width:1,color:12764104}),e.drawRect(-.5,-.5,f+1,m+1)}),[f,m]),g={lineHeight:20,fontSize:14,fontFamily:He},y=e.useMemo("tempName",(function(){if(e.tempName==e.name&&e.nameWidth<f);else{var t=ji(e.name,g);if(t<f)e.tempName=i,e.nameWidth=t;else for(var n=yi(e.name),r=0;r<n.length;r++){var o=n.slice(0,r).join("")+"...",a=Vi(o);if(a>f)break;e.tempName=o,e.nameWidth=a}}return exports.E(exports.E({text:e.tempName},g),{lineHeight:20})}),[f,i]);fa({x:p,y:h,alpha:a?1:null!==(t=null==c?void 0:c(e))&&void 0!==t?t:1}),o||u||Ra(y,{x:0,y:-26,fill:"#616371"}),void 0===u&&!1!==e.upime.view.isImmersivePlaying||Na(v),e.hide&&function(e){var t=e.element;e.scale;var n=e.width,i=e.height,r=t.useCallback("hideCover",(function(e){e.clear(),e.beginFill(15527150),e.drawRect(.5,.5,n-1,i-1),e.endFill()}),[n,i]),o=O("frame.hided"),a=t.useMemo("hideLabelWidth",(function(){return ji(o,{fontSize:16,fontFamily:He})}),[o]),s=n-a>=40&&i>=116,l=t.unHideRoles?HM:zM;if(Na(r),l.loaded){var c=void 0;if(n>=80&&i>=80)c={x:(n-40)/2,y:(i-40-(s?24:0))/2,width:40,height:40};else{var u=40*Math.min(n,i)/80;c={x:(n-u)/2,y:(i-u)/2,width:u,height:u}}Oa(exports.E({src:l},c))}s&&Ra({text:o,fontSize:16,lineHeight:24},{x:(n-a)/2,y:(i-40)/2+40,fill:"#C2C3C8"})}({element:e,scale:d,width:f,height:m}),ma()},WM=function(e){var t,n,i=e.position,r=e.hasBg,o=e.bgColor,a=e.size,s=e.locked,l=js.value,c=l.viewbox,u=l.getElementAlpha,d=l.exportType,p=i.x,h=i.y,f=a.width,m=a.height;if(fa({x:p,y:h,alpha:s?1:null!==(t=null==u?void 0:u(e))&&void 0!==t?t:1}),c.scale>.25&&(n=new La({src:FM,x:-10,y:-10,width:f+20,height:m+20,borderClip:{left:10,top:10,bottom:10,right:10},leftWidth:10,rightWidth:10,topHeight:10,bottomHeight:10}),sa.processElement(n)),r){var v=e.useCallback("drawBg",(function(e){e.clear(),e.beginFill(o,1),e.drawRect(0,0,f,m)}),[r,o,f,m]);Na(v)}ma(),d||xf(e),!d&&e.link&&wf(e)},VM=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameWidth=0,t.tempName="",t.bgRenderer=WM,t.renderer=UM,t.type="custom",t.hasBg=!1,t.bgColor=0,t.bgOpacity=1,t.name="",t.showDB=!1,t.editingName=!1,t.hide=!1,t.members=[],t.elementType=Za.FRAME,t.editorType=OM,t}return P(t,e),t.prototype.contains=function(e){return this.members.indexOf(e)>=0},t.prototype.add=function(e){this.members.indexOf(e)<0&&this.members.push(e)},t.prototype.remove=function(e){this.members=this.members.filter((function(t){return t!==e}))},t.prototype.getMembers=function(){return this.members},t.prototype.checkBorderInFrame=function(e){var t=this.size,n=t.width,i=t.height,r=this.position;return Vt(e,{x:r.x,y:r.y,width:n,height:i})},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y,i=this.size;return{left:t,top:n,right:t+i.width,bottom:n+i.height,rotate:0}},t.prototype.checkClickName=function(e){var t=this.upime.view.scale,n=this.position,i=n.x,r=n.y;return Ot(e,{left:i,right:i+(Math.max(this.nameWidth,20)+4)/t,top:r-24/t,bottom:r})?(e.x-i)*t:null},t.prototype.checkClickBorder=function(e){var t=this.getGlobalBox(),n=8/this.upime.view.scale;return!0===Ot(e,t,n)&&!1===Ot(e,t,-n)},t.prototype.checkSelectRelation=function(e,t){var n,i,r=this.getGlobalBox(),o=8/this.upime.view.scale;if("click"===t.type){if(!1===Ot(e,r,-o))return null;if(!1===t.evt.originEvent.ctrlKey){var a=null!==(i=null===(n=this.upime.selectController.currentEditor)||void 0===n?void 0:n.getElements())&&void 0!==i?i:[];if(0!==a.length&&Kt(Yt(a.map((function(e){return e.getGlobalBox()}))),r))return null}return{transparent:!0,metric:this.getMetric()}}return"hover"===t.type?!1===Ot(e,r)?null:{transparent:!0,metric:this.getMetric()}:null},t.prototype.bindRefSystem=function(){this.parentRefSystem=this.upime.view.elementsRoot},t.prototype.getMetric=function(){var e=this.getBorderBox(),t=e.left,n=e.top;return(e.right-t)*(e.bottom-n)},t.prototype.dealUpdate=function(t){e.prototype.dealUpdate.call(this,t),(t.position||t.size)&&this.updateBorderBox(),void 0!==t.name&&(this.upime.publish("frameNameChanged",this),this.upime.publish("sdkAction",{type:"frameNameChanged",payload:{frameId:this.id,name:this.name}}))},M([rl],t.prototype,"hide",void 0),M([il],t)}(ry),jM=function(){function e(e){this.upime=e,this.serverFramesIds=[],this.localFramesIds=[],this._localActions=[],this.initialized=!1,this.isSyncState=!0,this.increcementalSyncing=!1}return Object.defineProperty(e.prototype,"localActions",{get:function(){return R([],this._localActions,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastFrameInList",{get:function(){var e;return null!==(e=this.sequentialFrames[this.sequentialFrames.length-1])&&void 0!==e?e:null},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.serverFramesIds=R([],e,!0),this.localFramesIds=R([],e,!0),this.increcementalSyncing?this.localFramesIds=this.getMergedLocalFramesIds():this.localFramesIds=R([],e,!0),this.initialized=!0,this.updateFramesList()},e.prototype.destroy=function(){this.serverFramesIds.length=0,this.localFramesIds.length=0,this._localActions.length=0,this.initialized=!1},e.prototype.insertFrame=function(e){this.initialized&&(this.localFramesIds.includes(e)||(this.serverFramesIds.push(e),this.localFramesIds.push(e)),this.updateFramesList())},e.prototype.removeFrame=function(e){this.initialized&&this.updateFramesList()},e.prototype.updateFramesList=function(){this.upime.publish("framesUpdated",this.sequentialFrames)},Object.defineProperty(e.prototype,"sequentialFrames",{get:function(){for(var e=[],t=0;t<this.localFramesIds.length;t++){var n=this.upime.elementManager.getElementById(this.localFramesIds[t]);n&&!n.deleted&&e.push(n)}return e},enumerable:!1,configurable:!0}),e.prototype.getPrevFrameId=function(e){var t=this.localFramesIds.indexOf(e);return 0===t?null:this.localFramesIds[t-1]},e.prototype.moveFrame=function(e,t,n){var i=e.filter((function(e){return e!==t})),r=0;return null!==n&&(r=i.indexOf(n)+1),i.splice(r,0,t),i},e.prototype.getMergedLocalFramesIds=function(){for(var e=R([],this.serverFramesIds,!0),t=0;t<this._localActions.length;t++){var n=this._localActions[t];e=this.moveFrame(e,n.target,n.prevFrameId)}return e},e.prototype.dealServerSequenceChanged=function(e,t){this.initialized&&!this.increcementalSyncing&&(this.serverFramesIds=this.moveFrame(this.serverFramesIds,e,t),this.localFramesIds=this.getMergedLocalFramesIds(),this.updateFramesList())},e.prototype.dealLocalSequenceChangeAck=function(e){var t=e.seq,n=e.target,i=e.prevFrameId;this.initialized&&!this.increcementalSyncing&&(this._localActions=this._localActions.filter((function(e){return e.seq!==t})),0===this._localActions.length&&(this.isSyncState=!0),this.serverFramesIds=this.moveFrame(this.serverFramesIds,n,i))},e.prototype.changeSequence=function(e,t){if(this.initialized&&!this.increcementalSyncing){var n=this.upime.elementManager.getElementById(e);n&&this.upime.createOperation().updateSync(n,{prevFrameId:t})}},e.prototype.changeSequenceInternal=function(e,t,n){this.initialized&&!this.increcementalSyncing&&(this.isSyncState=!1,this._localActions.push({seq:n,target:e,prevFrameId:t}),this.localFramesIds=this.getMergedLocalFramesIds(),this.updateFramesList())},e.prototype.beforeIncrementalUpdate=function(e){this.increcementalSyncing=!0,this.initialized=!1,this._localActions=this._localActions.filter((function(t){return t.seq>e}))},e.prototype.afterIncrementalUpdate=function(){var e=this;if(this._localActions.length){var t=this.upime;this._localActions.forEach((function(n){var i=n.target,r=n.prevFrameId,o=e.upime.elementManager.getElementById(i);if(o){var a=t.genLocalSeq();n.seq=a,t.recordAction({type:"update",seq:a,updates:[{id:i,update:{prevFrameId:r},elementType:o.elementType}]})}}))}this.increcementalSyncing=!1},e}();function GM(e,t){var n=t,i=n.weakOt,r=n.richContent,o=N(n,["weakOt","richContent"]),a=e.richTextClient;return r&&a.initData(r),i&&a.dealWeakOt(i),o}function qM(t){var n=t.element,i=t.upime;return t.viewbox,t.placeholder,e.createElement(Eb,{element:n,upime:i})}function KM(t){var n=W().getUpimeTrans;return e.createElement(qM,exports.E({},t,{placeholder:n("text.placeholder")}))}var YM=function(){function e(e){var t=this;this.editor=e,this.couldAffectGroup=!0,this.sizeList=Ve,this.maxSize=999,this.minSize=10,this.propertyName="textFontSize",this.renderer=sN,this.changeValue=function(e){var n=t.editor.getPropertyValue("fontSize");t.editor.lockUpdateToolbarPos(),t.editor.updateProperty({scale:e/n}),t.editor.updateBorderBox(),t.editor.unlockUpdateToolbarPos()},this.renderKey=this.propertyName}return e.prototype.getValue=function(){var e=this.editor.getPropertyValue("scale"),t=this.editor.getPropertyValue("fontSize");return Math.round(t*e)},e}(),XM={left:"textAlignLeft",center:"textAlignCenter",right:"textAlignRight",top:"textAlignTop",middle:"textAlignMiddle",bottom:"textAlignBottom"},QM=function(t){var n=t.type,i=XM[n];return e.createElement(ul,{className:vc},e.createElement(hl,{icon:i}))},ZM=function(t){var n=t.propEditor,i=n.ha;return e.createElement("div",{className:j("ha_select_group_OwjlV"),onPointerDown:ie},e.createElement(JM,{value:i,onSelect:function(e){n.setHa(e)},list:["left","center","right"]}))};function JM(t){var n=t.value,i=t.onSelect,r=t.list;return e.createElement("div",{className:j(pc)},r.map((function(t){return e.createElement("div",{key:t+"",className:Ml.cm_item,onClick:function(){return i(t)}},e.createElement("div",{className:j(Ml.icon_box,n===t&&Ml.active)},e.createElement(QM,{type:t})))})))}var $M=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.ha,o=n.va,a=yh(!0),s=a.hide,l=a.setHide,c=a.toggleHide,u=a.skipRef,d=e.useMemo((function(){if(o&&n.setVa)return["top","middle","bottom"]}),[]);return e.createElement("div",{className:j(Ml.cm_item,"align_select_2J0lH"),ref:u,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.align"),rootClass:Ml.cm_item},e.createElement("div",{className:Ml.icon_box,onClick:c},e.createElement(QM,{type:r}))),!s&&e.createElement(xh,{align:"center"},e.createElement(JM,{list:["left","center","right"],value:r,onSelect:function(e){n.setHa(e),l(!0)}}),d&&e.createElement(e.Fragment,null,e.createElement("div",{className:"hor_split_2Nqel"}),e.createElement(JM,{list:d,value:o,onSelect:function(e){n.setVa&&n.setVa(e),l(!0)}}))))},eA=function(){function e(e){this.editor=e,this.couldAffectGroup=!0,this.propertyName="textAlign",this.renderer=$M,this.renderKey=this.propertyName}return e.prototype.setHa=function(e){var t=this;if("single"===this.editor.element.selectStatus)this.setSelfHa(e);else{var n=this.editor.upime.createOperation();this.editor.getElements().forEach((function(i){var r,o=i.currentEditor,a=null==o?void 0:o.propertyEditors.find((function(e){return e.propertyName===t.propertyName}));null===(r=a)||void 0===r||r.setSelfHa(e,n)})),n.sync()}},Object.defineProperty(e.prototype,"ha",{get:function(){return this.editor.getPropertyValue("ha")||"center"},enumerable:!1,configurable:!0}),e.prototype.setSelfHa=function(e,t){this.editor.updateProperty({ha:e},t)},e}(),tA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="commonTextAlign",t}return P(t,e),t.prototype.setVa=function(e){var t=this;if("single"===this.editor.element.selectStatus)this.setSelfVa(e);else{var n=this.editor.upime.createOperation();this.editor.getElements().forEach((function(i){var r,o=i.currentEditor,a=null==o?void 0:o.propertyEditors.find((function(e){return e.propertyName===t.propertyName}));null===(r=a)||void 0===r||r.setSelfVa(e,n)})),n.sync()}},Object.defineProperty(t.prototype,"va",{get:function(){return this.editor.getPropertyValue("va")},enumerable:!1,configurable:!0}),t.prototype.setSelfVa=function(e,t){this.editor.updateProperty({va:e},t)},t}(eA),nA=function(t){var n=t.propEditor,i=W().getUpimeTrans;return e.createElement("div",{className:Ar,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.anchor")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:function(){var e;return null===(e=n.addAnchorLink)||void 0===e?void 0:e.call(n)}},e.createElement(hl,{icon:"lianjie"})))))},iA={bolder:"wenzijiacu",italic:"wenziqingxie",underLine:"xiahuaxian",deleteLine:"shanchuxian",style:"wenbenyangshi"},rA=function(t){var n=t.type,i=t.active,r=iA[n];return e.createElement(ul,{className:j(jr,i&&"active_2ld88")},e.createElement(hl,{icon:r}))},oA=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(xl).upime,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u="phone"===n.editor.phoneToolbarMode&&r.phoneMode;return e.createElement("div",{className:Ar,ref:c,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.style"),rootClass:Ml.cm_item},e.createElement("div",{className:Ml.icon_box,onClick:l},e.createElement(rA,{type:"style"}))),!a&&e.createElement(xh,{align:"center",forceTop:u},e.createElement("div",{className:Gr},["bolder","italic","underLine","deleteLine"].map((function(t){return e.createElement("div",{key:t+"",className:Ml.cm_item,onClick:function(){return e=t,n.toggleTextStyleProperty(e),void s(!0);var e}},e.createElement("div",{className:j(Ml.icon_box)},e.createElement(rA,{type:t,active:n.getTextPropertyStatus(t)})))})))))},aA=function(t){var n=t.propEditor,i=n.editor.getElements().length>1,r=e.useContext(Ic).phoneLayout;return e.createElement(e.Fragment,null,e.createElement(oA,{propEditor:n}),!r&&!i&&n.canAddAnchor&&n.addAnchorLink&&e.createElement(nA,{propEditor:n}))},sA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="textStyle",t.renderer=aA,t}return P(t,e),Object.defineProperty(t.prototype,"canAddAnchor",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"curTextEditor",{get:function(){return this.editor.connectedEditor||this.element},enumerable:!1,configurable:!0}),t.prototype.getTextPropertyStatus=function(e){return this.curTextEditor.getTextPropertyStatus(e)},t.prototype.addAnchorLink=function(){this.curTextEditor.addAnchorLink()},t.prototype.toggleTextStyleProperty=function(e){var t=this.element,n=this.editor,i=t.getTextPropertyStatus(e);if(this.editor.editingEditor)this.editor.editingEditor.setTextStyle(e,!i);else{var r=this.editor.upime,o=n.getElements(),a=n.upime.createOperation(),s=o.map((function(e){return e.id})),l=r.createLock(s);o.forEach((function(t){var n,r=t.currentEditor;r&&(r.richContentEditor||(null===(n=r.richContentEditors)||void 0===n?void 0:n.length))&&(r.currentOp=a,r.richContentEditors?r.richContentEditors.forEach((function(t){return t.setTextStyle(e,!i)})):r.richContentEditor&&r.richContentEditor.setTextStyle(e,!i),r.currentOp=void 0)})),a.sync(),r.clearLock(l)}},t}(ay);function lA(e){if(-1===e.search("<table")||-1===e.search("</table>"))return null;var t="";try{var n=e.split("\x3c!--StartFragment--\x3e");t=n[n.length-1].split("\x3c!--EndFragment--\x3e")[0]}catch(n){t=e}return t||null}function cA(e,t){var n=document.createElement("div");n.style.opacity="0",n.innerHTML=e;var i=n.getElementsByTagName("table")[0];i||((i=document.createElement("table")).innerHTML=e,n.innerHTML="",n.appendChild(i)),document.body.append(n);var r=Array.from(i.getElementsByTagName("tr")),o=Array(r.length).fill(null).map((function(){return[]})),a=0;return r.forEach((function(e){var t=Array.from(e.getElementsByTagName("td")),n=0;t.forEach((function(e){n+=e.colSpan})),a=Math.max(a,n)})),o.forEach((function(e,t){return e.push.apply(e,Array(a).fill(null).map((function(e,n){return exports.E(exports.E({},AE()),{rId:"".concat(t),cId:"".concat(n)})})))})),r.forEach((function(e,n){for(var i,r,a=Array.from(e.getElementsByTagName("td")),s=0,l=0;l<a.length;l++){for(;null===(i=o[n][s])||void 0===i?void 0:i.clusterId;)s++;var c=o[n][s],u=a[l],d=null!==(r=u.innerText)&&void 0!==r?r:"",p=t(d,n,s,{rowCluster:u.rowSpan>1,colCluster:u.colSpan>1}).textId;if(p&&(c.textEleId=p),u.rowSpan>1||u.colSpan>1){var h=ia();if(c.clusterRoot=!0,u.rowSpan>1&&u.colSpan>1)for(var f=0;f<u.rowSpan;f++)for(var m=0;m<u.colSpan;m++)o[n+f][s+m].clusterId=h;else if(u.rowSpan>1)for(f=0;f<u.rowSpan;f++)o[n+f][s].clusterId=h;else if(u.colSpan>1)for(f=0;f<u.colSpan;f++)o[n][s+f].clusterId=h}s++}})),document.body.removeChild(n),{grids:o,maxCols:a,maxRows:r.length}}function uA(e,t,n){void 0===n&&(n={});var i=e.fontFamily,r=e.textSize,o=r.width,a=r.height,s=e.lineHeightRate,l=n.maxSize,c=n.minSize;for(l=l||$e[$e.length-1],c=c||$e[0];;){var u=Math.ceil((l+c)/2);if(Wi(t,{fontFamily:i,fontSize:u,lineHeight:ib(u,s)},o).height>a?l=u-1:c=u,c>=l)return c}}var dA=[{type:10,name:"文本",icon:"wenben"},{type:11,name:"便签",icon:"bianqian"},{type:12,name:"长便签",icon:"changbianqian"}],pA=function(t){var n,i=t.propEditor,r=i.element,o=i.editor,a=W().getUpimeTrans,s=yh(!0),l=s.hide,c=s.setHide,u=s.toggleHide,d=s.skipRef,p=e.useState([]),h=p[0],f=p[1];e.useEffect((function(){y.getGraphicLib().then((function(e){f(e)}))}),[]);var m=e.useMemo((function(){var e,t;if(Iu(r))return null===(t=null===(e=h.find((function(e){return e.categoryId===r.categoryId})))||void 0===e?void 0:e.list)||void 0===t?void 0:t.find((function(e){return e.id===r.graphicId}));if(Au(r))for(var n=0;n<h.length;n++){var i=h[n].list.find((function(e){return e.is===r.shape}));if(i)return i}}),[h,r]),v=e.useMemo((function(){if(r.elementType===Za.TEXT||r.elementType===Za.STICKER)return!0;if(r.elementType===Za.GRAPHIC)return"base"===r.categoryId;if(r.elementType===Za.SHAPE){var e=r,t=h.filter((function(e){return"base"!==e.categoryId})).map((function(e){return e.list})).flat();return!t.some((function(t){return t.is===e.shape}))}return!1}),[h,r]),g=e.useMemo((function(){return function(){var e,t,n,i;if(r.elementType===Za.GRAPHIC){var o=r;return(null===(e=h.find((function(e){return e.categoryId===o.categoryId})))||void 0===e?void 0:e.list)||[]}if(r.elementType===Za.SHAPE){var a=r;return(null===(t=h.find((function(e){return e.list.some((function(e){return e.is===a.shape}))})))||void 0===t?void 0:t.list)||(null===(n=h.find((function(e){return"base"===e.categoryId})))||void 0===n?void 0:n.list)||[]}return(null===(i=h.find((function(e){return"base"===e.categoryId})))||void 0===i?void 0:i.list)||[]}().filter((function(e){return e.is!==_E.hor&&e.is!==_E.ver}))}),[h,r,v]),y=r.upime,b=!1,E="";if(Nu(r))E="wenben";else if(Pu(r)){var x=r;x.shape===eb.SQUARE?E="bianqian":x.shape===eb.RECT&&(E="changbianqian"),b=x.isPrivate}else Au(r)&&(E=((n={})[Ka.RECT]="juxing",n[Ka.ROUNDRECT]="yuanjiaojuxing",n[Ka.ELLIPSE]="yuanxing",n[Ka.TRIANGLE]="sanjiaoxing",n[Ka.DIAMOND]="lingxing",n[Ka.PARALLELOGRAM]="pinghangsibianxing",n[Ka.BIG_RIGHT_ARROW]="dajiantou",n[Ka.BIG_LEFT_ARROW]="dajiantou",n[Ka.BARREL]="shujuku",n[Ka.DOCUMENT]="wendang",n)[r.shape]);var w=function(e,t){c(!0);for(var n=o.getElements(),i=y.createOperation(),r=[],a=function(o){var a=n[o],s=function(e,t,n){return Nu(e)?10===t:Pu(e)?t===(e.shape===eb.SQUARE?11:12):Iu(e)?e.graphicId===(null==n?void 0:n.id):e.shape===(null==n?void 0:n.is)}(a,e,t);if(s)return r.push(a),"continue";var l=Iu(a)?function(e){var t,n=e.textNodes[0];return{position:e.position,fontSize:(null==n?void 0:n.fontSize)||14,fontFamily:(null==n?void 0:n.fontFamily)||He,size:e.size,richContent:{version:(null==n?void 0:n.richTextClient.version)||0,content:(null==n?void 0:n.richTextClient.content)||[]},originId:e.originId,id:e.id,ha:(null==n?void 0:n.ha)||"center",va:(null==n?void 0:n.va)||"middle",link:e.link,scale:e.scale,lineHeight:(null==n?void 0:n.lineHeight)||Ue,lineHeightRate:(null==n?void 0:n.lineHeightRate)||We,rotate:e.rotate,bgColor:e.bgColor,hasBg:e.hasBg,bgOpacity:e.bgOpacity,zIndex:e.zIndex,groupId:e.groupId,frameId:e.frameId,hasBorder:e.hasBorder,borderStyle:e.borderStyle,borderColor:e.borderColor,borderThickness:e.borderThickness,borderOpacity:e.borderOpacity,elementType:e.elementType,extralRichContents:null===(t=e.textNodes)||void 0===t?void 0:t.map((function(e){return{id:e.id,style:e.getStyle(),richContent:{version:e.richTextClient.version,content:e.richTextClient.content}}}))}}(a):function(e){return{position:e.position,fontSize:e.fontSize,fontFamily:e.fontFamily,size:e.size,richContent:{version:e.richTextClient.version,content:e.richTextClient.content},originId:e.originId,id:e.id,ha:e.ha,va:e.va||"middle",link:e.link,scale:e.scale,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate,rotate:e.rotate,groupId:e.groupId,frameId:e.frameId,elementType:e.elementType,zIndex:e.zIndex,bgColor:Pu(e)?0:e.bgColor,hasBg:!Pu(e)&&e.hasBg,bgOpacity:Pu(e)?1:e.bgOpacity,hasBorder:!Au(e)||e.hasBorder,borderStyle:Au(e)?e.borderStyle:1,borderColor:Au(e)?e.borderColor:1710618,borderThickness:Au(e)?e.borderThickness:2,borderOpacity:Au(e)?e.borderOpacity:1,stickBgColor:Pu(e)?e.bgColor:void 0}}(a),c=a.attachedComments,u=a.connectionLines;!function(e,t){var n={deleted:!0,groupId:null};e.frameId&&(n.frameId=null),t.update(e,n),e.attachedComments=[]}(a,i);var d=void 0,p=void 0;if(t&&((null==t?void 0:t.is)?(d=function(e,t,n){var i=t.originId,r=t.id,o=t.fontSize*t.scale,a=ib(o,t.lineHeightRate),s={position:exports.E({},t.position),fontSize:o,fontFamily:t.fontFamily,size:{width:t.size.width*t.scale,height:t.size.height*t.scale},originId:i||r,ha:t.ha,va:t.va,link:t.link,scale:1,lineHeight:a,rotate:t.rotate,bgColor:t.bgColor,hasBg:t.hasBg,bgOpacity:t.bgOpacity,lineHeightRate:t.lineHeightRate,hasBorder:t.hasBorder,borderStyle:t.borderStyle,borderColor:t.borderColor,borderThickness:t.borderThickness,borderOpacity:t.borderOpacity,zIndex:t.zIndex,groupId:t.groupId,frameId:t.frameId,richContent:t.richContent,shape:n};if(t.elementType!==Za.SHAPE&&t.elementType!==Za.GRAPHIC){var l=Wi(t.richContent.content.map((function(e){return e[0]})).flat(),{fontSize:s.fontSize,lineHeight:s.lineHeight,fontFamily:s.fontFamily},s.size.width-20);s.size.height=2*l.height+20,n===Ka.RECT||n===Ka.ROUNDRECT||n===Ka.BARREL||n===Ka.DOCUMENT?s.size.height=l.height+1.2*o:s.size.height=2*l.height+20,s.position.y+=(t.size.height*t.scale-s.size.height)/2}return s}(0,l,t.is),p=Za.SHAPE):(d=function(e,t,n){var i,r=t.originId,o=t.id,a=t.fontSize*t.scale,s=ib(a,t.lineHeightRate),l=[];if(null===(i=t.extralRichContents)||void 0===i?void 0:i.length)t.extralRichContents.forEach((function(t,n){var i=t.richContent;l.push(["text".concat(n+1,"_text"),"weakOt",{version:e.genOtVersion(0),content:i.content}]),l.push(["text".concat(n+1,"_style"),"value",t.style])}));else if(t.richContent){l.push(["text1_text","weakOt",{version:e.genOtVersion(0),content:t.richContent.content}]);var c={fontSize:a,lineHeight:s,lineHeightRate:t.lineHeightRate,fontFamily:t.fontFamily,ha:t.ha,va:t.va};l.push(["text1_style","value",c])}var u=t.size.width*t.scale,d=t.size.height*t.scale,p={width:u,height:d},h=exports.E({},t.position);if(t.elementType===Za.GRAPHIC){var f=n.width/n.height*p.height;p.width=f,h.x+=(u-f)/2}if(t.elementType===Za.TEXT||t.elementType===Za.STICKER){var m=n.height/n.width*p.width;p.height=m,h.y+=(d-m)/2}return{position:h,size:p,originId:r||o,link:t.link,scale:1,rotate:t.rotate,bgColor:t.bgColor,hasBg:t.hasBg,bgOpacity:t.bgOpacity,hasBorder:t.hasBorder,borderStyle:t.borderStyle,borderColor:t.borderColor,borderThickness:t.borderThickness,borderOpacity:t.borderOpacity,zIndex:t.zIndex,groupId:t.groupId,frameId:t.frameId,graphicId:n.id,categoryId:n.categoryId,cps:l}}(y,l,t),p=Za.GRAPHIC)),10===e&&(d=function(e,t){var n=t.originId,i=t.id,r=t.fontSize*t.scale/14,o=ib(14,t.lineHeightRate),a=t.richContent.content.map((function(e){return e[0]})).flat().join(""),s=t.size.width*t.scale/r,l=Wi(yi(a),{fontSize:14,lineHeight:o,fontFamily:t.fontFamily},s).height,c={width:s,height:l};return{position:exports.E(exports.E({},t.position),{x:t.position.x+(t.size.width*t.scale-s*r)/2,y:t.position.y+(t.size.height*t.scale-l*r)/2}),fontSize:14,fontFamily:t.fontFamily,size:c,originId:n||i,ha:t.ha,va:t.va,link:t.link,scale:r,lineHeight:o,rotate:t.rotate,bgColor:t.bgColor,hasBg:t.hasBg,bgOpacity:t.bgOpacity,lineHeightRate:t.lineHeightRate,zIndex:t.zIndex,groupId:t.groupId,frameId:t.frameId,richContent:t.richContent,autoWidth:!1}}(0,l),p=Za.TEXT),11!==e&&12!==e||(d=function(e,t,n){var i,r,o=n===eb.SQUARE,a=(null===(i=t.richContent)||void 0===i?void 0:i.content.map((function(e){return e[0]})).flat())||[],s=t.originId,l=t.id,c=t.lineHeightRate,u=t.size.width*t.scale,d=t.size.height*t.scale,p=Ke.width*(o?1:1.8),h=Ke.height,f=t.elementType===Za.STICKER?d/h:u/p,m={width:o?Ze.width:Ze.width+.8*Ke.width,height:Ze.height},v=exports.E(exports.E({},t.position),{x:t.position.x+(u-p*f)/2,y:t.position.y+(d-h*f)/2}),g=uA({fontFamily:t.fontFamily,textSize:m,lineHeightRate:t.lineHeightRate},a),y={position:v,fontSize:g,fontFamily:t.fontFamily,size:{width:p,height:h},originId:s||l,ha:t.ha,va:t.va,link:t.link,scale:f,lineHeight:ib(g,c),rotate:0,lineHeightRate:t.lineHeightRate,zIndex:t.zIndex,groupId:t.groupId,frameId:t.frameId,richContent:{version:t.richContent.version,content:t.richContent.content.map((function(e){var t=exports.E({},e[1]);return t.color=1710618,delete t.highLight,[e[0],t]}))},textSize:m,shape:n,autoFontSize:!0,isPrivate:!1,showAuthor:!1,bgColor:null!==(r=t.stickBgColor)&&void 0!==r?r:qe};return y}(0,l,11===e?eb.SQUARE:eb.RECT),p=Za.STICKER),d&&p){var h=i.create(p,d);h.attachedComments=c,u.forEach((function(e){e.startElement&&e.startElement.id===a.id&&i.update(e,{startElementId:h.id}),e.endElement&&e.endElement.id===a.id&&i.update(e,{endElementId:h.id})})),c.forEach((function(e){e.attachedElement=h,i.update(e,{attached:h.id})})),r.push(h)}},s=0;s<n.length;s++)a(s);if(y.updateBorderBox(),i.sync(),r.length){var l=y.selectElements(r),u=r[0];1===r.length&&Iu(u)&&(u.onGetSchema=function(){_e.desktop&&u.currentEditor===l&&(l.connectedEditor||l.connectTextEditor(),u.onGetSchema=void 0)})}};function C(){var e;return r.elementType===Za.GRAPHIC?r.textNodes.some((function(e){return e.richTextClient.chars.length>0})):Boolean(null===(e=r.richTextClient)||void 0===e?void 0:e.chars.length)}return e.createElement("div",{ref:d,onPointerDown:ie,className:"shape_switch_2j51f"},e.createElement(Dl,{placement:"top",content:a(b?"sticker.open":"shape.switch"),rootClass:Ml.cm_item},e.createElement("div",{className:Ml.icon_box,onClick:function(){b?o.updateProperty({isPrivate:!1}):(_c("cv_menubar_switchtype"),u())},style:{height:"50px"}},e.createElement(fA,{isPrivateSticker:b,iconName:E,graphicInfo:m}))),!l&&e.createElement(xh,{align:"left"},e.createElement("div",{className:"shape_op_container_1Jmml"},e.createElement("div",{className:"shape_op_mid_136kw"},v&&e.createElement(e.Fragment,null,e.createElement("div",{className:Gr},dA.map((function(t){return e.createElement(hA,{key:t.name,icon:t.icon,disabled:10===t.type&&!C(),onClick:function(){w(t.type)}})}))),e.createElement("div",{className:"option_divider_2ZE9k"})),e.createElement("div",{className:Gr},g.map((function(t){return t.deleted?null:e.createElement(hA,{key:t.id,graphicInfo:t,onClick:function(){w(13,t)}})})))))))};function hA(t){var n=t.disabled,i=t.icon,r=t.onClick,o=t.graphicInfo;return e.createElement("div",{className:j("shape_1C_Nn",n?"disabledHover_3wcEy":""),onClick:function(){n||r()}},i&&e.createElement(hl,{icon:i,className:n?"disabledText_1SUdS":""}),o&&e.createElement(FE,{graphicInfo:o}))}function fA(t){var n=t.isPrivateSticker,i=t.iconName,r=t.graphicInfo;return n?e.createElement(hl,{icon:"suo-quanxian"}):r?e.createElement(FE,{graphicInfo:r}):i?e.createElement(hl,{icon:i}):null}var mA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.couldAffectGroup=!0,t.propertyName="shapeSwitch",t.renderer=pA,t}return P(t,e),t}(ay),vA=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.domRenderer=KM,r.richContentEditor=n.richTextClient.contentEditor,r.initialize(),r.rollbackAutoWidth=r.element.autoWidth,r.autoDelete=!0,r}return P(t,e),t.prototype.getMinSize=function(e){return this.checkKeepRatio(e)?1:this.element.lineHeight*this.element.scale},Object.defineProperty(t.prototype,"lastColor",{set:function(e){void 0!==e&&(this.upime.lastTextColor=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(){this.editable&&!this.isHandMode&&(!this.upime.phoneMode&&this.propertyEditors.push(new mA(this,this.element)),this.propertyEditors.push(new YM(this),new eA(this),new sA(this,this.richContentEditor),new vE(this,this.richContentEditor),new Jb(this,this.element))),this.multiResizeDirection.push("w","e")},t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t);var n=t.scale,i=t.hasBg,r=t.bgColor,o=t.ha,a=t.fontFamily;void 0===n&&void 0===i&&void 0===r&&void 0===o&&void 0===a||this.updateTextConfig()},t.prototype.slideUpdateProperty=function(t,n,i){void 0===i&&(i=!1),e.prototype.slideUpdateProperty.call(this,t,n,i),this.updateTextConfig()},t.prototype.updateTextConfig=function(){var e={scale:this.element.scale,hasBg:this.element.hasBg,bgColor:this.element.bgColor,bgOpacity:this.element.bgOpacity,ha:this.element.ha,va:this.element.va,fontSize:this.element.fontSize,lineHeight:this.element.lineHeight,lineHeightRate:this.element.lineHeightRate,fontFamily:this.element.fontFamily};this.upime.updateTextConfig(e)},t.prototype.dealBorderResize=function(e,t,n){var i=this.element.position;switch(n){case"w":case"e":var r=t.left,o=(t.right-r)/this.element.scale,a=this.element,s=a.rawText,l=a.fontSize,c=a.lineHeight,u=a.fontFamily,d=a.boxBorder,p=a.padding,h=a.size,f=0,m=o-p.left-p.right;d&&(f=d.borderWidth,m-=2*d.borderRadius);var v=Wi(yi(s),{fontSize:l,lineHeight:c,fontFamily:u},m).height+p.top+p.bottom+2*f,g={size:{width:o,height:v},position:exports.E(exports.E({},i),{x:r})};this.element.autoWidth&&(g.autoWidth=!1,this.rollbackAutoWidth=!1),this.updateSelf(g),this.dealResized(e,{width:o-h.width,height:v-h.height,deltaX:r-i.x});break;default:r=t.left;var y=t.top,b=(o=t.right-r)/this.element.size.width,E=r,x=y;this.updateSelf({position:exports.E(exports.E({},i),{x:E,y:x}),scale:b}),this.updateTextConfig()}},t.prototype.dealResized=function(e,t,n){e.isStart,e.isEnd,void 0===n&&(n=!1),n&&this.syncUpdate(),this.checkFrameRelation(this.element,{isEnd:!0})},t.prototype.checkPointDirection=function(e,t,n){var i=this.upime.view.scale,r=this.element,o=r.size,a=o.width,s=o.height,l=r.globalTransform.currentScale,c=r.scale;return Math.min(a,s)*i*l*c<=15?"":this.element.rawText?Ut(e,t,n):Ht(e,t,n)},t.prototype.unselect=function(){var t=this.element.rawText.trim();this.autoDelete&&0==t.length&&this.delete(),e.prototype.unselect.call(this)},t.prototype.supportLinkTo=function(){return!0},t.prototype.switchToWebpage=function(){var e=this.element.richTextClient.content;if(e[0]&&e[0][1].link){this.editing&&this.stopEdit();var t=e[0][0].join(""),n=e[0][1].link,i=this.element.globalTransform.apply(this.element.position),r=this.getOp();this.dealDeleteGroup(r),this.doDelete(r),this.upime.insertWebpageAt(i,{customName:t,url:n,verticalPos:"top",horizPos:"left",currentOp:r})}},t}(Ob),gA=function(e){var t=js.value,n=t.exportType,i=t.viewbox,r=e.position,o=e.size,a=e.hasBg,s=e.bgColor,l=e.bgOpacity,c=e.scale,u=r.x,d=r.y,p=o.width*c,h=o.height*c,f=hf(e,1,[o,c]),m=!0;n||e.lineHeight*e.scale*e.globalTransform.currentScale*i.scale<3&&(m=!1),gf(e,f),fa({x:u,y:d}),a&&Na((function(e){e.clear(),e.beginFill(s,l),e.drawRect(0,0,p,h)})),m?jy({x:0,y:0,element:e,richClient:e.richTextClient,isWheeling:e.upime.view.isWheeling}):function(e){var t=e.size,n=e.scale,i=e.lineHeight,r=t.width*n,o=t.height*n,a=i*n;Ma((function(e){var t=e.context,n=e.alpha;t.fillStyle="#1A1A1A",t.globalAlpha=.4*n;for(var i=1.618,s=Math.ceil(o/(a*i)),l=0;l<s;l++){var c=i*l*a,u=Math.min((i*l+1)*a,o),d=l%2==0?r:.618*r;t.fillRect(0,c,d,u-c)}}))}(e),ma(),ma()},yA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.version="0_0",t}return P(t,e),t.prototype.initData=function(e){var t=e.version,n=e.content;this.version=t,this.content=n,this.chars=this.getCharsFromContent(n)},t.prototype.dealWeakOt=function(e){var t=e.baseVersion,n=e.version,i=e.content;if(t===this.version&&!this.bufferedOperation&&!this.contentEditor.isComposing&&!this.contentEditor.isMentioning){this.version=n;var r={opList:i};this.updateContentWidthAction(r),this.contentEditor.dealRemoteAction(r)}},t.prototype.parseVersionNum=function(e){return parseInt(e.split("_")[0])},t.prototype.applyAction=function(t){var n=e.prototype.applyAction.call(this,t);return n||(this.bufferNewAction(t),this.recordTextChange(),n)},t.prototype.handlePaste=function(e){var t;(null===(t=this.currentEditor)||void 0===t?void 0:t.editing)||e.stopPropagation()},t.prototype.bufferNewAction=function(e){var t=this.bufferedOperation;this.bufferedOperation=t?{opList:Is(t.opList,e.opList),reverseOpList:Is(e.reverseOpList,t.reverseOpList)}:e},t.prototype.syncBufferedOperation=function(){if(this.stopUpdateTimer(),void 0!==this.bufferedOperation){var e=this.parseVersionNum(this.version)+1,t=this.element.upime.genOtVersion(e),n=this.bufferedOperation,i={baseVersion:this.version,version:t,content:n.opList},r=exports.E({},n);this.syncWeakOt(i,r),this.version=t,this.bufferedOperation=void 0}},t.prototype.syncWeakOt=function(e,t){this.currentEditor.syncWeakOt(e,t)},t.prototype.recordTextChange=function(){var e,t=this;(null===(e=this.currentEditor)||void 0===e?void 0:e.editing)?this.updateContentTimer||(this.updateContentTimer=window.setTimeout((function(){t.updateContentTimer=void 0,t.syncBufferedOperation()}),500)):this.syncBufferedOperation()},t.prototype.stopUpdateTimer=function(){this.updateContentTimer&&(clearTimeout(this.updateContentTimer),this.updateContentTimer=void 0)},t.prototype.willStopEditing=function(){this.syncBufferedOperation()},t.prototype.handleKeyDown=function(t){var n=t.key;return"Enter"===n?this.handleEnterKeyDown(t):"Escape"===n?this.handleEscapeKeyDown(t):"Tab"===n?this.handleTabKey(t):"f"===n&&(t.ctrlKey||t.metaKey)?this.handleSystemSearch(t):e.prototype.handleKeyDown.call(this,t)},t.prototype.handleEnterKeyDown=function(e){return!(!e.ctrlKey&&!e.metaKey||(this.currentEditor.stopEdit(),0))},t.prototype.handleEscapeKeyDown=function(e){var t;return e.preventDefault(),null===(t=this.currentEditor)||void 0===t||t.stopEdit(),!0},t.prototype.handleTabKey=function(e){var t;e.preventDefault();var n=null===(t=this.currentEditor)||void 0===t?void 0:t.richContentEditor;if(n){var i=exports.E({},n.currentStyle);return n.doAdd("    ",i),!0}return!1},t.prototype.handleSystemSearch=function(e){return e.preventDefault(),this.element.upime.publish("onSearchElement",void 0),!0},t}(Fy),bA=function(e){function t(t,n){void 0===n&&(n=!0);var i=e.call(this,t)||this;return i.element=t,i.withDefaultText=n,i}return P(t,e),t.prototype.applyAction=function(t,n){if(e.prototype.updateContentWidthAction.call(this,t),this.bufferNewAction(t),n)return this.syncBufferedOperation(),0;var i=this.chars,r=this.element,o=r.size,a=o.width,s=o.height,l=r.scale,c=r.textRect,u=r.position,d=r.padding,p=r.boxBorder,h=r.autoWidth,f=r.ha,m=r.fontSize,v=r.fontFamily,g=r.lineHeight,y=c.width,b=c.height,E=this.currentEditor,x=ji(Oe.placeholder,{fontFamily:v,fontSize:m});if(0===i.length&&(h||E.rollbackAutoWidth||c.width<x))y=x,b=g;else{var w=h?600:this.element.wordWrapWidth,C=Wi(i,this.element,w);h&&(y=C.width<28?28:C.width),b=C.height}var S=(null==p?void 0:p.borderWidth)||0,k=(null==p?void 0:p.borderRadius)||0,_=y+d.left+d.right+2*S+2*k,T=b+d.top+d.bottom+2*S;if(_!==a||T!==s){var I={size:{width:_,height:T}};return _!==a&&("center"===f?I.position={x:u.x+(a-_)/2*l,y:u.y}:"right"===f&&(I.position={x:u.x+(a-_)*l,y:u.y})),!h&&0===i.length&&E.rollbackAutoWidth&&(I.autoWidth=!0),E.updateSelf(I),E.dealResized({isStart:!1,isEnd:!0},{width:_-a,height:T-s}),E.updateBorderBox(),this.syncBufferedOperation(),0}return this.recordTextChange(),0},t.prototype.calcRenderData=function(){var t=e.prototype.calcRenderData.call(this);if(this.withDefaultText&&0===this.chars.length){var n=Oe.placeholder,i=ji(n,this.element);t.placeholder={width:i,text:n,data:{color:11645361,highLight:null}}}return t},t.prototype.handleInput=function(t){return"insertLineBreak"===t.inputType?this.handleEnterInput(t):e.prototype.handleInput.call(this,t)},t.prototype.handleEnterInput=function(e){var t,n=this.currentEditor;return(null===(t=n.richContentEditor)||void 0===t?void 0:t.isMentioning)||n.updateSelf({autoWidth:!1}),!1},t}(yA),EA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.va="top",t.renderer=gA,t.elementType=Za.TEXT,t.autoWidth=!0,t.hasBg=!1,t.bgColor=0,t.bgOpacity=1,t.fontFamily=He,t.fontSize=14,t.lineHeight=Ue,t.lineHeightRate=1.36,t.ha="left",t.textType=1,t.textContent="",t.textColor=1710618,t.richTextClient=t.initRichClient(),t._padding={left:0,top:0,right:0,bottom:0},t.editorType=vA,t.editing=!1,t}return P(t,e),Object.defineProperty(t.prototype,"supportSwitchToWebpage",{get:function(){return this.inGlobalRs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return this.richTextClient.chars.join("")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boxBorder",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this.textRect.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textRect",{get:function(){var e=0,t=0,n=this.size.width,i=this.size.height;if(this.boxBorder){var r=this.boxBorder,o=r.borderRadius,a=r.borderWidth;e+=o,t+=a,n-=2*(a+o),i-=2*a}var s=this.padding,l=s.left,c=s.top;return n-=l+s.right,i-=c+s.bottom,{x:e+=l,y:t+=c,width:Dn(Math.ceil,n,2),height:i}},enumerable:!1,configurable:!0}),t.prototype.dealUpdate=function(t){var n=GM(this,t);e.prototype.dealUpdate.call(this,n),(n.position||n.size||void 0!==n.rotate||void 0!==n.scale)&&this.updateBorderBox()},t.prototype.initRichClient=function(){return new bA(this)},t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+a*s,rotate:this.rotate}},t.prototype.getMetric=function(){return-1},t.prototype.switchToWebpage=function(){var e=this.currentEditor;e||(e=new vA(this.upime,this)),e.switchToWebpage()},t}(oy),xA=function(){function e(e){var t=this;this.editor=e,this.propertyName="GridTextFontSize",this.renderer=sN,this.couldAffectGroup=!1,this.sizeList=Ve,this.maxSize=288,this.minSize=10,this.changeValue=function(e){var n=ib(e,t.editor.element.lineHeightRate);t.editor.updateProperty({fontSize:e,lineHeight:n}),t.editor.updateBorderBox()},this.renderKey=this.propertyName}return e.prototype.getValue=function(){return Math.round(this.editor.element.fontSize)},e}(),wA=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.autoDelete=!1,r.multiResizeDirection=[],r}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportMoreCtrl",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportFullCommonOp",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.initialize=function(){this.editable&&!this.isHandMode&&this.propertyEditors.push(new xA(this),new tA(this),new sA(this,this.richContentEditor),new vE(this,this.richContentEditor))},t.prototype.dealResized=function(){},t.prototype.checkSelectRelation=function(e,t){var n;if(this.editing){e=this.element.globalTransform.applyInverse(e);var i=this.element.checkSelectRelation(e,t);return(null===(n=null==i?void 0:i.metaData)||void 0===n?void 0:n.selectingText)?(i.transparent=!0,i):null}return null},t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t)},t.prototype.slideUpdateProperty=function(t,n){e.prototype.slideUpdateProperty.call(this,t,n)},t.prototype.updateTableRowHeight=function(e,t){if(t){var n=this.element.hostCell;if(n){var i=n.table,r=i.id,o=i.rowHeights,a=i.size,s=i.scale,l=n.getBorderBox(),c=this.element.textRect.y,u=(l.bottom-l.top)/s;if(e+2*c>u){var d=R([],o,!0);d[n.rIdx]+=e-u+2*c;var p=this.upime.createLock([r]);t.update(n.table,{rowHeights:d,size:exports.E(exports.E({},a),{height:a.height+e-u+2*c})}),t.sync(),this.upime.clearLock(p)}}}},t.prototype.checkPointDirection=function(){return""},t.prototype.supportLinkTo=function(){return!0},t.prototype.startEdit=function(t){var n,i,r;if(this.element.draft){var o=null!=t?t:{},a=o.op,s=o.lock;a||(a=this.upime.createOperation());var l=this.upime.genID(Za.GRID_TEXT);this.element.id=l,null==a||a.addLocalDraftElement(this.element),null===(n=this.element.hostCell)||void 0===n||n.clearDraftText(),this.element.draft=!1,s||(s=this.upime.createLock([l])),t={op:null!==(i=null==t?void 0:t.op)&&void 0!==i?i:a,lock:null!==(r=null==t?void 0:t.lock)&&void 0!==r?r:s}}e.prototype.startEdit.call(this,t)},t}(vA),CA=function(e){var t=e.position,n=e.textRect,i=t.x,r=t.y,o=i+n.x,a=r+n.y;jy({x:o,y:a,element:e,maxHeight:n.height,richClient:e.richTextClient,isWheeling:e.upime.view.isWheeling})},SA=function(e){function t(t,n){void 0===n&&(n=!0);var i=e.call(this,t)||this;return i.element=t,i.withDefaultText=n,i}return P(t,e),t.prototype.applyAction=function(t,n){if(e.prototype.updateContentWidthAction.call(this,t),this.bufferNewAction(t),n)return this.syncBufferedOperation(),0;var i=this.chars,r=this.element,o=r.textRect,a=r.padding,s=r.boxBorder,l=r.autoWidth;r.ha;var c=r.fontSize,u=r.fontFamily,d=r.lineHeight,p=this.element.eleSize,h=p.width,f=p.height,m=o.width,v=o.height,g=this.currentEditor,y=ji(Oe.placeholder,{fontFamily:u,fontSize:c});if(0===i.length&&(l||g.rollbackAutoWidth||o.width<y))m=y,v=d;else{var b=l?600:this.element.wordWrapWidth,E=Wi(i,this.element,b);l&&(m=E.width<28?28:E.width),v=E.height}var x=(null==s?void 0:s.borderWidth)||0,w=(null==s?void 0:s.borderRadius)||0,C=m+a.left+a.right+2*x+2*w,S=v+a.top+a.bottom+2*x;if(C!==h||S!==f){var k={size:{width:C,height:S}};return!l&&0===i.length&&g.rollbackAutoWidth&&(k.autoWidth=!0),g.updateSelf(k),g.dealResized({isStart:!1,isEnd:!0},{width:C-h,height:S-f}),g.updateTableRowHeight(S,g.currentOp),g.updateBorderBox(),this.syncBufferedOperation(),0}return this.recordTextChange(),0},t.prototype.handleEscapeKeyDown=function(e){return e.preventDefault(),this.backTOSelectTableCell(),!0},t.prototype.backTOSelectTableCell=function(){var e;null===(e=this.currentEditor)||void 0===e||e.stopEdit();var t=this.element.position,n=t.parentId,i=t.rowId,r=t.columnId,o=this.element.upime,a=o.elementManager.getElementById(n);if(a){var s=a.grids.flat().find((function(e){return e.rId===i&&e.cId===r}));if(s)return a.setFocusedCells([s],s),o.selectElement(a)}return null},t.prototype.handleTabKey=function(e){var t=this.backTOSelectTableCell();return t?t.handleTabKey(e):(e.preventDefault(),e.stopPropagation()),!0},t}(bA),kA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementType=Za.GRID_TEXT,t.autoWidth=!1,t.renderer=CA,t.editorType=wA,t.editing=!1,t.draft=!1,t}return P(t,e),Object.defineProperty(t.prototype,"supportSwitchToWebpage",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eleSize",{get:function(){var e=this.getBorderBox();return{width:e.right-e.left,height:e.bottom-e.top}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalTransform",{get:function(){var e;if(this.parentRefSystem)return this.parentRefSystem.globalTransform;var t=this.position,n=t.parentId,i=t.rowId,r=t.columnId;return(null===(e=this.upime.elementManager.getTableRS(n,i,r))||void 0===e?void 0:e.globalTransform)||sr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textRect",{get:function(){if(!this.hostCell)return{x:0,y:0,width:0,height:0};var e=this.getBorderBox(),t=e.right-e.left,n=e.bottom-e.top,i=t>2*this.fontSize?Math.floor(t/this.fontSize)-2:0;i=Math.min(4,i);var r=n>this.lineHeight?2*Math.floor(n/this.lineHeight)-2:0;return{x:i,y:r=Math.min(10,r),width:t-2*i,height:n-2*r}},enumerable:!1,configurable:!0}),t.prototype.checkVisible=function(t){var n=e.prototype.checkVisible.call(this,t);if(n){var i=this.richTextClient,r=this.globalTransform,o=i.renderData,a=o.width,s=o.height;if(a*r.currentScale*t.scale<1||s*r.currentScale*t.scale<1)return!1}return n},t.prototype.initRichClient=function(){return new SA(this,!1)},Object.defineProperty(t.prototype,"hostCell",{get:function(){var e,t=this.position,n=t.parentId,i=t.rowId,r=t.columnId,o=this.upime.elementManager.tableMap.get(n);return o&&(null===(e=o.gridsMap[i])||void 0===e?void 0:e[r])||null},enumerable:!1,configurable:!0}),t.prototype._checkSelectRelation=function(e){return null},t.prototype.calcBorderBox=function(){var e={left:Number.MAX_SAFE_INTEGER,right:Number.MAX_SAFE_INTEGER,bottom:Number.MAX_SAFE_INTEGER,top:Number.MAX_SAFE_INTEGER};if(!this.hostCell)return e;var t=this.hostCell.table,n=this.hostCell.getBorderBox();return{left:0,right:(n.right-n.left)/t.scale,top:0,bottom:(n.bottom-n.top)/t.scale}},t.prototype.getGlobalBox=function(){return this.draft&&this.hostCell?this.hostCell.getBorderBox():e.prototype.getGlobalBox.call(this)},t.prototype.updatePosition=function(e){this.position=e,this.deleted||this.draft||this.bindRefSystem(this.position)},t.prototype.getMetric=function(){return 0},t.prototype.checkPointCanEdit=function(e,t,n){var i=e.x,r=e.y;return!(i<0||i>=t||r<0||r>=n)},t}(EA),_A=function(){function e(e,t){this.id=e,this.members=t,this.lockedByServer=!1}return Object.defineProperty(e.prototype,"locked",{get:function(){return this.lockedByServer},set:function(e){this.lockedByServer=!!e||this.members.some((function(e){return e.locked}))},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){},e}(),TA=function(e){var t=e.element,n=e.viewbox,i=t.borderRect,r=n.left,o=n.top,a=n.scale,s=i.left,l=i.top,c=i.right,u=i.bottom;s=(s-=r)*a-1,l=(l-=o)*a-1,c=(c-=r)*a+1,u=(u-=o)*a+1;var d=Ga(i,n);Na((function(e){function t(t,n){e.drawRect(t-7+1,n-7+1,12,12)}e.clear(),e.lineStyle({width:2,color:6134012,lineDash:[6,2]}),e.drawRect(s,l,c-s,u-l),e.lineStyle({width:2,color:11119017}),e.beginFill(16777215),t(s,l),t(c,l),t(c,u),t(s,u),t(c,(u+l)/2),t(s,(u+l)/2),t((c+s)/2,l),t((c+s)/2,u)}),{x:d.x,y:d.y,rotation:i.rotate,pivotX:d.x,pivotY:d.y})},IA=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.element=n,i.domRenderer=function(){return null},i.renderer=TA,i}return P(t,e),t.prototype.checkKeepRatio=function(){return!1},t.prototype.moveCropper=function(e){var t=e.position,n=e.prePosition,i={x:t.x-n.x,y:t.y-n.y};this.element.rotate&&(i=an(i,-this.element.rotate));var r=this.element.globalTransform.applyVectorInverse(i),o=r.x,a=r.y,s=this.element,l=s.clipRect,c=s.scale,u=this.clampClip({x:l.x+o/c,y:l.y+a/c,width:l.width,height:l.height}),d=u.x-l.x,p=u.y-l.y;if(d||p){var h=an({x:(u.x-l.x)*c,y:(u.y-l.y)*c},this.element.rotate);this.updateSelf({position:exports.E(exports.E({},this.element.position),{x:this.element.position.x+h.x,y:this.element.position.y+h.y}),clipRect:u})}},t.prototype.handleSelectCtrlMove=function(e){this.moveCropper(e)},t.prototype.elementsDidMove=function(){},t.prototype.clampClip=function(e,t){void 0===t&&(t=!0);var n=e.x,i=e.y,r=e.width,o=e.height,a=this.element.size,s=a.width,l=a.height;return n<0&&(t||(r+=n),n=0),i<0&&(t||(o+=i),i=0),n+r>s&&(t?n=s-r:r=s-n),i+o>l&&(t?i=l-o:o=l-i),{x:n,y:i,width:r,height:o}},t.prototype.getMinSize=function(){return 18},Object.defineProperty(t.prototype,"disableAntiResize",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.dealBorderResize=function(e,t){var n=this.element,i=n.clipRect,r=n.scale,o=this.element.getBorderBox(),a=t.left,s=t.top,l=t.right,c=t.bottom,u=an({x:(a+l-o.left-o.right)/2,y:(s+c-o.top-o.bottom)/2},-this.element.rotate),d=(l-a)/r,p=(c-s)/r,h={x:i.x+i.width/2+u.x/r-d/2,y:i.y+i.height/2+u.y/r-p/2,width:d,height:p},f=this.element.position;this.updateSelf({position:exports.E(exports.E({},f),{x:a,y:s}),clipRect:h})},t.prototype.checkPointDirection=function(e,t,n){return function(e,t,n){return void 0===n&&(n=0),Ft(e,t,n,[],!0)}(e,t,7/this.upime.view.scale)},Object.defineProperty(t.prototype,"enableTransparentInBox",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.checkSelectRelation=function(t,n){var i,r=e.prototype.checkSelectRelation.call(this,t,n);if(!r)return null;var o=null===(i=null==r?void 0:r.metaData)||void 0===i?void 0:i.resizeData;if(o){var a=this.element,s=a.position,l=a.clipRect,c=a.size,u=a.scale,d=s.x-l.x*u,p=d+c.width*u,h=s.y-l.y*u,f=h+c.height*u;o.barrier={left:d,top:h,right:p,bottom:f}}return r},t.prototype.select=function(){e.prototype.select.call(this),void 0===this.cropLock&&(this.cropLock=this.upime.createLock([this.element.id]))},t.prototype.unselect=function(){void 0!==this.cropLock&&(this.upime.clearLock(this.cropLock),this.cropLock=void 0),e.prototype.unselect.call(this),this.element.clipping=!1},t}(Lb),PA={"scale-mode":"scale-mode_3uUsR","current-scale":"current-scale_2Wpa3","scale-modes":"scale-modes_27x5K","scale-item":"scale-item_1CS5w",hint:"hint_2-fbp",icon_box:"icon_box_3yIPh",scale_mode:"scale-mode_3uUsR",current_scale:"current-scale_2Wpa3",scale_modes:"scale-modes_27x5K",scale_item:"scale-item_1CS5w"};function NA(t){var n=t.element,i=e.useCallback((function(e){e!==n.getKeyValue("name")&&n.changeKeyValue("name",e)}),[]);return e.createElement(MN,{defaultValue:n.getKeyValue("name"),onChanged:i,readonly:!n.editor.editable,nameCtrl:n.editor.nameCtrl})}function MA(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic).phoneLayout,o=e.useCallback((function(){n.startClip()}),[]);return e.createElement(e.Fragment,null,!r&&e.createElement(NA,{element:n}),n.editor.upime.downloadConfig.imageEnable&&e.createElement(Ih,{editor:n.editor,forceEnabled:!0}),!n.isHandMode&&e.createElement(Dl,{placement:"top",content:i("image.cut")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{onClick:o,className:Ml.propEditorIconBox},e.createElement(hl,{icon:"caiqie"})))))}function AA(t){var n,i=t.propEditor,r=W().getUpimeTrans,o=[{mode:1,text:r("image.originSize"),hint:"100%"},{mode:.5,text:r("image.halfSize"),hint:"50%"}],a=yh(!0),s=a.hide,l=a.toggleHide,c=a.setHide,u=a.skipRef,d=i.getValue(),p=(null===(n=o.find((function(e){return e.mode===d})))||void 0===n?void 0:n.text)||r("image.customSize"),h=e.useCallback((function(e){c(!0),i.getValue()!==e&&i.changeValue(e)}),[i.getValue()]);return e.createElement("div",{className:j(Ml.cm_item,PA.scale_mode),onClick:l,ref:u},e.createElement("div",{className:PA.current_scale},p),!s&&e.createElement(xh,{align:"left",className:PA.scale_modes},o.map((function(t){var n=t.mode,i=t.text,r=t.hint;return e.createElement("div",{key:n,className:j(Ml.cm_item,PA.scale_item),onClick:h.bind(null,n)},e.createElement("div",{className:PA.text},i),e.createElement("div",{className:PA.hint},r))}))))}var DA,RA=function(){function e(e){this.editor=e,this.propertyName="imageStyle",this.renderer=MA,this.couldAffectGroup=!1,this.isHandMode=!1,this.renderKey=this.propertyName}return e.prototype.getKeyValue=function(e){return this.editor.getPropertyValue(e)},e.prototype.changeKeyValue=function(e,t){var n;this.editor.updateProperty(((n={})[e]=t,n))},e.prototype.startClip=function(){this.editor.element.clipping=!0,this.editor.upime.switchEditor(new IA(this.editor.upime,this.editor.element))},e}(),BA=function(){function e(e){var t=this;this.editor=e,this.propertyName="scaleMode",this.renderer=AA,this.couldAffectGroup=!0,this.changeValue=function(e){t.editor.updateProperty({scaleMode:e,scale:e}),t.editor.updateBorderBox()},this.renderKey=this.propertyName}return e.prototype.getValue=function(){return this.editor.getPropertyValue("scaleMode")},e}(),LA=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;if(r.element=n,!t.phoneMode||"phone"!==r.phoneToolbarMode||r.upime.downloadConfig.imageEnable||!r.isHandMode){var o=new RA(r);o.isHandMode=r.isHandMode,r.propertyEditors.push(o)}return!r.editable||r.isHandMode||t.phoneMode||r.propertyEditors.push(new BA(r)),t.phoneMode||(r.nameCtrl=new FN),r}return P(t,e),t.prototype.getMinSize=function(){return 18},t.prototype.dealBorderResize=function(e,t){var n=t.left,i=t.top,r=(t.right-n)/this.element.clipRect.width,o=this.element.position;this.updateSelf({position:exports.E(exports.E({},o),{x:n,y:i}),scale:r,scaleMode:1.5})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.supportLinkTo=function(){return!0},t.prototype.doRename=function(){var e;null===(e=this.nameCtrl)||void 0===e||e.selectName()},t}(Ob);DA=_e.safari?10:20,Ji=DA;var OA=function(e){var t=e.position,n=e.size,i=e.clipRect,r=e.clipping,o=e.scale,a=js.value,s=a.renderApp,l=a.exportType,c=a.viewbox,u={width:n.width*o,height:n.height*o},d={width:i.width*o,height:i.height*o},p={x:t.x-i.x*o,y:t.y-i.y*o},h={x:t.x,y:t.y},f=n.height*o*e.globalTransform.currentScale*c.scale,m=e.imageFile,v=m&&pf({imageFile:m,realHeight:f,exportType:l,renderTarget:e});!l&&v&&v.loaded&&(e.renderingSource=v);var g=c.scale,y=hf(e,1,[i,o]),b={x:i.x/n.width,width:i.width/n.width,y:i.y/n.height,height:i.height/n.height};gf(e,y),r&&(fa({alpha:.2}),Oa({x:p.x,y:p.y,src:v,width:u.width,height:u.height}),ma()),Oa({x:h.x,y:h.y,src:v,clipRect:b,width:d.width,height:d.height}),(null==v?void 0:v.loaded)&&e.fileId||l||!s||(fa({x:h.x,y:h.y,scaleX:1/g,scaleY:1/g}),gp({width:d.width*g,height:d.height*g,beginTime:e.beginLoadTime,name:e.name,renderTarget:e}),ma()),ma()},FA=OA,zA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=FA,t.elementType=Za.IMAGE,t.fileId="",t.size={width:0,height:0},t.scaleMode=1,t.name="",t.clipping=!1,t.clipRect={x:0,y:0,width:0,height:0},t.imgType="",t.beginLoadTime=0,t.editorType=LA,t.dealDoubleClick=CM(t),t}return P(t,e),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportSelected",{get:function(){return void 0===this.localImage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.clipRect,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+a*s,rotate:this.rotate}},t.prototype.updateImageFile=function(){var e=this,t=this,n=t.fileId,i=t.localImage,r=t.originFile,o=t.imgType,a=n||i;if(a&&(!this.imageFile||this.imageFile.id!==a)){this.beginLoadTime=Date.now();var s=this.imageFile;if(n){if("gif"===o){var l=new wu(this.upime,a);l.fallback=function(){l===e.imageFile&&(e.imageFile=new pu(e.upime,a,e.size),e.imageFile.backupFile=s,e.upime.updateView())},this.imageFile=l}else{var c="svg"===o?{width:0,height:0}:this.size;this.imageFile=new pu(this.upime,a,c)}this.imageFile.backupFile=s}else if(i)if("gif"===o&&r){var u=new xu(r,i);u.fallback=function(){u===e.imageFile&&(delete e.originFile,e.imageFile=void 0,e.updateImageFile(),e.upime.updateView())},this.imageFile=u}else this.imageFile=new hu(i)}},t.prototype.dealUpdate=function(t){var n=t,i=n.fileId,r=N(n,["fileId"]);e.prototype.dealUpdate.call(this,r),void 0!==i&&i!==this.fileId&&(this.fileId=i,t.deleted||this.deleted||(delete this.localImage,this.updateImageFile())),(t.position||t.size||void 0!==t.rotate||void 0!==t.scale||t.clipRect)&&this.updateBorderBox()},t.prototype.onAdd=function(){e.prototype.onAdd.call(this),this.updateImageFile()},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.imageFile=void 0},t}(oy),HA=1,UA=[];"production"!==process.env.NODE_ENV&&(window._checkNode=function(){UA.forEach((function(e){return e()}))});var WA=function(){function e(e){this.root=e,this.id=HA++,this.children=[],this.order=1,this.isLeft=void 0,this.batchSortPool=new Set,this.nodeMap=new Map,this.tree=this,this.isInLocalMode=!1,this.localModeTreeNodes=new Set,e.abstractTree=this,this.node=e,this.nodeMap.set(e,this),this._check=this._check.bind(this),this._checkNode=this._checkNode.bind(this),UA.push(this._check)}return e.prototype.appendNodeByLine=function(e){var t=e.startElement;if(this.nodeMap.get(t)){var n=qA(e),i=e.endElement;this.appendNode(t,i,n)}},e.prototype.appendNode=function(e,t,n){var i=this.nodeMap.get(e);if(i){var r=e.isRootNode||void 0===i.isLeft?n:i.isLeft;i.children.some((function(e){return e.node===t}))||this.transferFrom(t,i,r)}},e.prototype.transferFrom=function(e,t,n){var i=this;e.abstractTree.root===e&&(UA=UA.filter((function(t){return t!==e.abstractTree._check})));var r=e.abstractTree,o=r!==t.tree;if(r){var a=r.cut(e,o);if(a){var s=a.tree.root.isRootNode,l=t.tree.root.isRootNode;if(a.parent=t,t.children.push(a),VA(a,(function(e){e.isLeft=t.node.isRootNode||void 0===t.isLeft?n:t.isLeft,e.node.abstractTree=i,e.tree=i,i.nodeMap.set(e.node,e),i.onEnter(e)})),o){var c=jA(a).filter((function(e){return e.node.hasLocalState})).map((function(e){return e.node}));this.addLocalModeNodeList(c)}!s&&l&&this.sortDeep(a),this.isInLocalMode&&!e.positionServer&&e.syncServerPositon(),this.sortClilren(t.children),this.isInLocalMode&&((t.node.isMindmapNodeHideByCollapsed||t.node.leftCollapsedFinally&&a.isLeft||t.node.rightCollapsedFinally&&!a.isLeft)&&(a.node.isMindmapNodeHideByCollapsed=!0),this.alignTreeLocal())}}},e.prototype.cut=function(e,t){void 0===t&&(t=!0);var n=this.nodeMap.get(e);if(n&&t){var i=jA(n).filter((function(e){return e.node.hasLocalState})).map((function(e){return e.node}));this.removeLocalModeNodeList(i)}this.nodeMap.delete(e);var r=null==n?void 0:n.parent;if(r&&(r.children=r.children.filter((function(e){return e!==n})),r.node.hasLocalState))if(r.node.isRootNode){var o=r.children.some((function(e){return e.isLeft})),a=r.children.some((function(e){return!e.isLeft}));o||r.node.setLeftCollapsedLocal(null),a||r.node.setRightCollapsedLocal(null)}else 0===r.children.length&&(r.node.setLeftCollapsedLocal(null),r.node.setRightCollapsedLocal(null));return n},e.prototype.toRoot=function(t,n){var i,r;if(t.abstractTree&&(UA=UA.filter((function(e){return e!==t.abstractTree._check}))),(null===(i=this.findTreeNode(t))||void 0===i?void 0:i.tree.root)!==t){var o=null===(r=t.abstractTree)||void 0===r?void 0:r.cut(t,!0);if(o){t.abstractTree=new e(t),t.abstractTree.children=R([],o.children,!0),t.abstractTree.children.forEach((function(e){e.parent=t.abstractTree})),t.dealUpdate({ha:"center"}),VA(t.abstractTree,(function(e){var i;null===(i=t.abstractTree)||void 0===i||i.nodeMap.set(e.node,e),e.node.abstractTree=t.abstractTree,e.tree=t.abstractTree;var r=e.parent;r&&((null==r?void 0:r.node)===t?e.isLeft=n.includes(e.node.id):e.isLeft=null==r?void 0:r.isLeft)})),t.abstractTree.fixAll();var a=jA(t.abstractTree).filter((function(e){return e.node.hasLocalState})).map((function(e){return e.node}));t.abstractTree.addLocalModeNodeList(a),t.isInLocalModeTree&&t.useServerPosition()}}},e.prototype.sort=function(e){var t,n=null===(t=this.nodeMap.get(e))||void 0===t?void 0:t.parent;if(n&&!this.batchSortPool.has(n.node.id)){this.batchSortPool.add(n.node.id);var i=this.sortClilren(n.children);return this.batchSortPool.delete(n.node.id),i}},e.prototype.fixPositionBySort=function(e){var t,n=null===(t=this.nodeMap.get(e))||void 0===t?void 0:t.parent;if(n){var i=n.children.map((function(e){return e.node.position})),r=this.root.layout===Xa.HORIZONTAL;i.sort((function(e,t){return(r?e.y:e.x)-(r?t.y:t.x)})),n.children.forEach((function(e,t){e.node.dealUpdate({position:i[t]})})),this.alignTreeLocal()}},e.prototype.sortDeep=function(e){var t=this;VA(e,(function(e){t.sortClilren(e.children)}))},e.prototype.updateIsLeft=function(e){var t=this,n=e.endElement,i=this.nodeMap.get(n);if(i){var r=e.startElement,o=this.nodeMap.get(r);if(null==o?void 0:o.node.isRootNode){var a=qA(e);VA(i,(function(n){if(n.isLeft!==a)n.isLeft=a,t.isInLocalMode&&t.exchangeLeftRightCollapsed(n.node),t.fix(n);else{var i=.5===e.startPosition.x,r=t.root.layout===Xa.VERTICAL;if(r!==i){var o=function(e,t){return e&&!t?{startPosition:rp,endPosition:ap}:e&&t?{startPosition:op,endPosition:sp}:e||t?{startPosition:sp,endPosition:op}:{startPosition:ap,endPosition:rp}}(a,r),s=o.startPosition,l=o.endPosition;e.dealUpdate({startPosition:s,endPosition:l}),t.fix(n)}}})),o.node.isRootNode&&this.isInLocalMode&&this.fixPositionBySort(i.node)}else this.fix(i)}},e.prototype.sortClilren=function(e){var t=this;if(!this.root.isRootNode)return!1;var n=function(e){var n;return t.isInLocalMode?(null===(n=e.node.positionServer)||void 0===n?void 0:n.x)||0:e.node.position.x},i=function(e){var n;return t.isInLocalMode?(null===(n=e.node.positionServer)||void 0===n?void 0:n.y)||0:e.node.position.y},r=e.map((function(e){return"".concat(e.node.id,"-").concat(e.order)})).join(",");return e.sort((function(e,r){var o=1,a=1,s=1,l=1;return t.root.layout===Xa.HORIZONTAL?(o=i(e),a=i(r),s=n(e),l=n(r)):(o=n(e),a=n(r),s=i(e),l=i(r)),o===a?s-l:o-a})),e.forEach((function(e,t){e.order=t+1})),r!==e.map((function(e){return"".concat(e.node.id,"-").concat(e.order)})).join(",")},e.prototype.findTreeNode=function(e){return this.nodeMap.get(e)},e.prototype.fincMindmapNodeChildren=function(e){var t;return(null===(t=this.findTreeNode(e))||void 0===t?void 0:t.children.map((function(e){return e.node})))||[]},e.prototype.getDescendants=function(e,t){for(var n=[],i=this.findTreeNode(e),r=R([],(null==i?void 0:i.children)||[],!0);r.length;){var o=r.pop(),a=null==o?void 0:o.node;!a||a.deleted||t&&!t(a)||(n.push(a),r.push.apply(r,o.children))}return n},e.prototype.getDescendantsTreeNode=function(e,t){for(var n=[],i=this.findTreeNode(e),r=R([],(null==i?void 0:i.children)||[],!0);r.length;){var o=r.pop();!o||o.node.deleted||t&&!t(o)||(n.push(o),r.push.apply(r,o.children))}return n},e.prototype.onEnter=function(e){this.fix(e)},e.prototype.fix=function(e){this.fixLayout(e),this.fixLine(e),this.fixNode(e)},e.prototype.fixLayout=function(e){e.node.layout!==this.root.layout&&e.node.dealUpdate({layout:this.root.layout}),e.node.theme!==this.root.theme&&e.node.dealUpdate({theme:this.root.theme})},e.prototype.fixLine=function(e){var t=e.node.precursorLine;t&&(this.root.layout===Xa.VERTICAL&&(e.isLeft?t.dealUpdate({startPosition:op,endPosition:sp}):t.dealUpdate({startPosition:sp,endPosition:op})),this.root.layout===Xa.HORIZONTAL&&(e.isLeft?t.dealUpdate({startPosition:rp,endPosition:ap}):t.dealUpdate({startPosition:ap,endPosition:rp})))},e.prototype.fixNode=function(e){var t,n,i,r="center";e.node.isRootNode||this.root.layout!==Xa.HORIZONTAL||(r=e.isLeft?"right":"left"),r!==e.node.ha&&e.node.dealUpdate({ha:r});var o=(null===(t=e.node.parent)||void 0===t?void 0:t.isMindmapNodeHideByCollapsed)||e.isLeft&&(null===(n=e.node.parent)||void 0===n?void 0:n.leftCollapsedFinally)||!e.isLeft&&(null===(i=e.node.parent)||void 0===i?void 0:i.rightCollapsedFinally);e.node.isMindmapNodeHideByCollapsed=!!o},e.prototype.fixAll=function(){var e=this;VA(this,(function(t){e.fix(t)}))},e.prototype.addLocalModeNode=function(e){var t=this.findTreeNode(e);t&&this.localModeTreeNodes.add(t),this.localModeTreeNodes.size>0&&!this.isInLocalMode&&(this.isInLocalMode=!0,VA(this,(function(e){e.node.syncServerPositon()})),this.alignTreeLocal())},e.prototype.addLocalModeNodeList=function(e){var t=this;0!==e.length&&(e.forEach((function(e){var n=t.findTreeNode(e);n&&t.localModeTreeNodes.add(n)})),this.localModeTreeNodes.size>0&&!this.isInLocalMode&&(this.isInLocalMode=!0,VA(this,(function(e){e.node.syncServerPositon()})),this.alignTreeLocal()))},e.prototype.removeLocalModeNode=function(e){var t=this.findTreeNode(e);t&&this.localModeTreeNodes.delete(t),0===this.localModeTreeNodes.size&&this.isInLocalMode&&(this.isInLocalMode=!1,VA(this,(function(e){e.node.clearServerPosition()})))},e.prototype.removeLocalModeNodeList=function(e){var t=this;0!==e.length&&(e.forEach((function(e){var n=t.findTreeNode(e);n&&t.localModeTreeNodes.delete(n)})),0===this.localModeTreeNodes.size&&this.isInLocalMode&&(this.isInLocalMode=!1,VA(this,(function(e){e.node.clearServerPosition()}))))},e.prototype.alignTreeLocal=function(){var e=this.root.upime.createOperation();this.isInLocalMode&&(e.localOnly=!0),this.root.onAlignTheTree(e),e.sync(),this.root.upime.deleteOperation(e)},e.prototype.exchangeLeftRightCollapsed=function(e){var t=e.rightCollapsed;e.rightCollapsed=e.leftCollapsed,e.leftCollapsed=t;var n=e.rightCollapsedLocal;e.rightCollapsedLocal=e.leftCollapsedLocal,e.leftCollapsedLocal=n},e.prototype.toJson=function(){return GA(this,(function(e){var t,n;return{isLeft:e.isLeft,order:e.order,id:e.node.id,deleted:e.node.deleted,content:null===(n=null===(t=e.node.richTextClient)||void 0===t?void 0:t.chars)||void 0===n?void 0:n.join("")}}))},e.prototype.tell=function(e){},e.prototype._check=function(){this.root.isRootNode&&this._checkNode(this,this.root)},e.prototype._checkNode=function(e,t){var n,i=this;if(e.node!==t)throw this.tell(),new Error("node not match");if((null===(n=t.parent)||void 0===n?void 0:n.isRootNode)&&e.isLeft!==t.isLeftSubtreeNode)throw new Error("node isLeft not match");var r=R([],t.children,!0);r.sort((function(e,t){var n=1,r=1,o=1,a=1;return i.root.layout===Xa.HORIZONTAL?(n=e.position.y,r=t.position.y,o=e.position.x,a=t.position.x):(n=e.position.x,r=t.position.x,o=e.position.y,a=t.position.y),n===r?o-a:n-r}));var o=r.filter((function(e){var t;return(null===(t=e.parent)||void 0===t?void 0:t.isRootNode)&&e.isLeftSubtreeNode})),a=r.filter((function(e){var t;return!((null===(t=e.parent)||void 0===t?void 0:t.isRootNode)&&e.isLeftSubtreeNode)})),s=e.children.filter((function(e){return!e.node.deleted})).filter((function(e){var t;return(null===(t=e.parent)||void 0===t?void 0:t.node.isRootNode)&&e.isLeft})),l=e.children.filter((function(e){return!e.node.deleted})).filter((function(e){var t;return!((null===(t=e.parent)||void 0===t?void 0:t.node.isRootNode)&&e.isLeft)}));if(o.length!==s.length)throw new Error("left node children length not match");var c=o.map((function(e){return"".concat(e.id,":").concat(KA(e).content)})).join(" | "),u=s.map((function(e){return"".concat(e.node.id,":").concat(KA(e.node).content)})).join(" | ");if(c!==u)throw new Error("left sign not match");if(o.forEach((function(e,t){i._checkNode(s[t],e)})),a.length!==l.length)throw new Error("right node children length not match "+a+"  "+l);var d=a.map((function(e){return"".concat(e.id,":").concat(KA(e).content)})).join(" | "),p=l.map((function(e){return"".concat(e.node.id,":").concat(KA(e.node).content)})).join(" | ");if(d!==p)throw new Error("right sign not match");a.forEach((function(e,t){i._checkNode(l[t],e)}))},e}();function VA(e,t){for(var n=[e];n.length;){var i=n.shift();i&&(t(i),n.push.apply(n,i.children))}}function jA(e){for(var t=[],n=[e];n.length;){var i=n.shift();i&&(t.push(i),n.push.apply(n,i.children))}return t}function GA(e,t){var n=exports.E({children:[]},t(e));return n.children=e.children.map((function(e){return GA(e,t)})),n}function qA(e){return bn(e.startPosition,rp)||bn(e.startPosition,op)}function KA(e){var t,n;return{type:"mindmapNode",id:e.id,content:null===(n=null===(t=e.richTextClient)||void 0===t?void 0:t.chars)||void 0===n?void 0:n.join(""),isLeftSubTreeNode:e.isLeftSubtreeNode,x:e.position.x,y:e.position.y}}var YA="divider_RITkG",XA="sub-win_3_P-0",QA="type-select_3paxj";function ZA(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.element,o=yh(!0),a=o.hide,s=o.toggleHide,l=o.skipRef,c=e.useMemo((function(){return new Map([[Xa.HORIZONTAL,{icon:"jiedian-zuoyou"}],[Xa.VERTICAL,{icon:"jiedian-shangxia"}]])}),[]),u=r.layout||Xa.HORIZONTAL,d=c.get(u).icon,p=e.useMemo((function(){return new Map([[Qa.COLORBRANCH,{icon:"siweidaotu-quxian"}],[Qa.LITE,{icon:"siweidaotu-zhexian"}]])}),[]);return e.createElement("div",{className:j(Ml.cm_item,"theme-editor__6GKC"),ref:l},e.createElement(Dl,{placement:"top",content:i("mindmap.changeTheme")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:s},e.createElement(hl,{icon:d})))),!a&&e.createElement(xh,{align:"left",className:XA},e.createElement($b,{className:QA,value:u,data:c,onChanged:function(e){n.changeLayout(e)}}),e.createElement("div",{className:YA}),e.createElement($b,{className:QA,value:r.theme,data:p,onChanged:function(e){n.changeTheme(e)}})))}function JA(t){var n=t.propEditor,i=e.useContext(Ic),r=i.phoneLayout,o=i.phoneElementSubBarContainer,a=W().getUpimeTrans,s=n.element,l=s.nodeColor,c=n.getRandomColorPalette(),u=n.getColorPalette(),d=e.useCallback((function(){n.randomizeColor()}),[]),p=function(e){y(!0),e!==l&&n.changeColor(e)},h={};r&&(h.checkSkip=function(e){return!!o.current&&V(o.current,e)});var f=yh(!0,h),m=f.hide,v=f.toggleHide,g=f.skipRef,y=f.setHide,b=r?Xg:xh;return e.createElement("div",{className:j(Ml.cm_item,"color-editor_1vBvc"),ref:g},e.createElement(Dl,{placement:"top",content:a("mindmap.nodeColor")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:v},e.createElement(Wb,{color:l})))),!m&&e.createElement(b,{align:"center",className:XA,selfAdjust:!0},r?e.createElement(Yb,{colorPalettes:R(R([],c,!0),u,!0),defaultValue:l,onChanged:p}):e.createElement(e.Fragment,null,s.isRootNode&&e.createElement("div",{className:"randomize_3eCtD",onClick:d},a("mindmap.nodeColorRandom")),e.createElement(Yb,{colorPalettes:c,defaultValue:l,onChanged:p}),e.createElement("div",{className:YA}),e.createElement(Yb,{colorPalettes:u,defaultValue:l,onChanged:p,colorPickerConfig:{onColorPickerChange:function(e,t){n.slideChangeColor(e,t,!0)}}}))))}var $A=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.editor=t,i.element=n,i.propertyName="mindMapTheme",i.renderer=ZA,i}return P(t,e),t.prototype.changeLayout=function(e){this.editor.changeLayout(e)},t.prototype.changeTheme=function(e){this.editor.changeTheme(e)},t}(ay),eD=[8005887,12007167,16729572,16711792,16737595,16755456,16769792,12578332,6083632,7661266,640767,2979327],tD=function(e){var t=e.viewbox,n=e.borderBox,i=e.connectableLocations,r=e.currentLocation,o=e.rightCollapsed,a=e.leftCollapsed;e.renderable;var s=i.filter((function(e){switch(e){case"b":case"r":return!o;case"l":case"t":return!a;default:return!0}})),l=t.left,c=t.top,u=t.scale;Na((function(e){var t=n.left,i=n.top,o=n.right,a=n.bottom,d=(t-l)*u,p=(i-c)*u,h=(o-t)*u,f=(a-i)*u;e.clear();for(var m=0;m<s.length;m++)switch(s[m]){case"l":v(d-20,p+f/2,"l");break;case"t":v(d+h/2,p-20,"t");break;case"r":v(d+h+20,p+f/2,"r");break;case"b":v(d+h/2,p+f+20,"b")}function v(t,n,i){e.lineStyle(),i===r?e.beginFill(3691769):e.beginFill(0,.1),e.drawCircle(t,n,12),e.endFill(),e.lineStyle({width:2,color:16777215}),e.moveTo(t,n-5),e.lineTo(t,n+5),e.moveTo(t-5,n),e.lineTo(t+5,n)}}))},nD=function(){function e(e,t,n){this.upime=e,this.controller=t,this.element=n,this.renderer=iD,this.currentLocation=""}return Object.defineProperty(e.prototype,"borderBox",{get:function(){return this.element.getBorderBoxWithCollapse()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectableLocations",{get:function(){var e=this;return this.element.mindMapConnectableLocations.filter((function(t){switch(t){case"b":case"r":return!e.element.rightCollapsed;case"l":case"t":return!e.element.leftCollapsed;default:return!0}}))},enumerable:!1,configurable:!0}),e.prototype.dealHoverStart=function(e){var t,n,i,r=null!==(i=null===(n=null===(t=null==e?void 0:e.metaData)||void 0===t?void 0:t.connectionData)||void 0===n?void 0:n.location)&&void 0!==i?i:"";this.currentLocation=r,r?this.upime.view.setCursor("pointer",this):this.upime.view.setCursor("",this)},e.prototype.dealHoverEnd=function(){this.currentLocation="",this.upime.view.setCursor("",this)},e.prototype.destroy=function(){this.upime.view.setCursor("",this)},e.prototype.checkSelectRelation=function(e,t){return"move"===t.type?null:this.element.checkMindMapConnectionRelation(e)},e.prototype.dealSelectCtrlEvt=function(e){},e.prototype.dealClick=function(e){var t,n,i=this.element.checkMindMapConnectionRelation(e.position);(null===(t=null==i?void 0:i.metaData)||void 0===t?void 0:t.connectionData)&&this.controller.handlePointClick(this.element,null===(n=null==i?void 0:i.metaData)||void 0===n?void 0:n.connectionData)},e}(),iD=function(e){var t=e.element,n=e.viewbox;if(t.element.upime.editable){var i=t.borderBox,r=t.connectableLocations,o=t.currentLocation;tD({viewbox:n,borderBox:i,connectableLocations:r,currentLocation:o,rightCollapsed:Boolean(t.element.rightCollapsed),leftCollapsed:Boolean(t.element.leftCollapsed)})}},rD=function(e){var t=e.element,n=e.viewbox;if(t.visiable){var i=t.borderRect,r=t.connectableLocations,o=t.mindMapConnectableLocations,a=t.currentLocation,s=t.frozed,l=Ga(i,n);fa({x:l.x,y:l.y,pivotX:l.x,pivotY:l.y}),qd({borderRect:i,viewbox:n,connectableLocations:r,currentLocation:a,withResizePoint:!1,frozed:s}),s||tD({borderBox:t.element.getBorderBoxWithCollapse(),viewbox:n,connectableLocations:o,currentLocation:a,rightCollapsed:Boolean(t.element.rightCollapsed),leftCollapsed:Boolean(t.element.leftCollapsed)}),ma()}},oD=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.editor=t,i.element=n,i.propertyName="nodeColor",i.couldAffectGroup=!1,i.renderer=JA,i}return P(t,e),t.prototype.getColorPalette=function(){return this.editor.upime.userManager.userPalette},t.prototype.getRandomColorPalette=function(){return R([],eD,!0)},t.prototype.changeColor=function(e){this.editor.changeColor(e)},t.prototype.slideChangeColor=function(e,t,n){n?this.editor.slideChangeColor(e,t):this.changeColor(e)},t.prototype.randomizeColor=function(){this.editor.randomizeColor()},t}(ay),aD=function(e){function t(t){var n=e.call(this,t)||this;return n.editor=t,n.couldAffectGroup=!1,n.changeValue=function(e){n.editor.lockUpdateToolbarPos(),n.editor.changeFontSize(e),n.editor.unlockUpdateToolbarPos()},n}return P(t,e),t}(YM);function sD(){}var lD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementType=Za.MINDMAP_LINE,t._isShow=!0,t._renderer=sD,t}return P(t,e),Object.defineProperty(t.prototype,"isSupportFrame",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isShow",{get:function(){return this._isShow},set:function(e){!this.isShow&&e&&(this.renderer=this._renderer),this.isShow&&!e&&(this._renderer=this.renderer,this.renderer=sD),this._isShow=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportCopy",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineCap",{get:function(){return"butt"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return"round"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportSelected",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._update_startElementId=function(t){e.prototype._update_startElementId.call(this,t),this.attachMindMapNode()},t.prototype._update_endElementId=function(t){e.prototype._update_endElementId.call(this,t),this.attachMindMapNode()},t.prototype.attachMindMapNode=function(){this.startElement&&this.endElement&&this.endElement.attachPrecursor(this,this.startElement)},t.prototype.checkSelectRelation=function(){return null},t.prototype.getLineRects=function(){var t,n=(null===(t=this.startElement)||void 0===t?void 0:t.scale)||1,i=28*n,r=68*n;if(2===this.lineType){var o=bn(this.startPosition,rp)||bn(this.startPosition,ap),a=[],s=this,l=s.startPoint,c=s.endPoint,u=s.startRadius,d=s.endRadius,p=c.x-l.x,h=c.y-l.y,f=o?p*Math.cos(d):h*Math.sin(u),m=0,v=0,g=[],y=f<2*i;y?(m=i,v=i):(m=f-(v=i),f>i+r&&(v=f-(m=r)));var b=function(e,t,n,i){return{x:e.x+i*Math.cos(n),y:e.y+i*Math.sin(t)}},E=b(l,u,rn(u+Math.PI),m),x=b(c,d,rn(d+Math.PI),v);if(y){var w=(l.x+c.x)/2,C=(l.y+c.y)/2;g=o?[{x:E.x,y:C},{x:x.x,y:C}]:[{x:w,y:E.y},{x:w,y:x.y}]}g=R(R([l,E],g,!0),[x,c],!1);for(var S=0;S<g.length-1;S++){var k=nn(g[S+1],g[S]),_=rn(k+Math.PI);a.push(this.getLineRect(g[S],k,0,null,g[S+1],_,0,null).borderBox)}return{lineRects:a,points:g}}return e.prototype.getLineRects.call(this)},t.prototype.updateLinePath=function(){var t=this.startPoint,n=this.endPoint;if(1===this.lineType)e.prototype.updateLinePath.call(this);else if(this.startElement&&(this.startRadius=this.startElement.getConnectionPointAngle(this.startPosition,this.lineType)),this.endElement&&(this.endRadius=this.endElement.getConnectionPointAngle(this.endPosition,this.lineType)),3===this.lineType){var i,r,o=n.x-t.x,a=n.y-t.y,s=this.startRadius,l=this.endRadius,c=Math.abs(o),u=Math.abs(a);i={x:0-18*Math.cos(s)-c/6*Math.cos(s),y:0+18*Math.sin(s)+u/6*Math.sin(s)},r={x:o-18*Math.cos(l)-c/6*Math.cos(l),y:a+18*Math.sin(l)+u/6*Math.sin(l)},this.drawPath=[{x:0-this.displayLineWidth/2*Math.cos(s),y:0+this.displayLineWidth/2*Math.sin(s)},i,r,{x:o-this.displayLineWidth/2*Math.cos(l),y:a+this.displayLineWidth/2*Math.sin(l)}]}},t.prototype.dealUpdate=function(t){var n,i=t.startPosition,r=t.endPosition,o=_t.isEqual(i,this.startPosition)&&_t.isEqual(r,this.endPosition),a=t.startElementId&&t.startElementId!==this.startElementId,s=(null===(n=this.startElement)||void 0===n?void 0:n.isRootNode)&&!o;e.prototype.dealUpdate.call(this,t),a&&this.startElement&&this.startElement.abstractTree.appendNodeByLine(this);var l=this.endElement;s&&(null==l||l.checkIsHideByPreLine()),!i&&!r||o||null==l||l.abstractTree.updateIsLeft(this)},t}(IN),cD=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.renderer=rD,r._currentOpStart=!1,r.mindMapNodeEditors=[],r.movingNodes=[],r.nodesOnlyRoot=[],r.allNodes=[],r.parentsMap=new Map,r.rootNodePropMap=new Map,r.isFirstEditor=!1,r.savedParent=!1,r._movingElements=[],r._calcdMovingElements=!1,r.autoDelete=!1,r}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getMinSize=function(e){if(this.checkKeepRatio(e))return 1;var t=this.element,n=t.lineHeight;return t.isRootNode&&(n+=68),n*t.scale},Object.defineProperty(t.prototype,"mindMapConnectableLocations",{get:function(){return this.element.mindMapConnectableLocations},enumerable:!1,configurable:!0}),t.prototype.select=function(t){this.element.isSelected=!0,e.prototype.select.call(this),!_e.isHoverSupported&&!t&&this.upime.createMindMapConnectablePoints(this.element)},t.prototype.unselect=function(t){this.element.isSelected=!1,e.prototype.unselect.call(this),!_e.isHoverSupported&&!t&&this.upime.clearPoints()},t.prototype.initialize=function(){this.editable&&!this.isHandMode&&(this.element.isRootNode&&this.propertyEditors.push(new $A(this,this.element)),this.propertyEditors.push(new oD(this,this.element)),this.element.isRootNode&&this.propertyEditors.push(new aD(this)),this.propertyEditors.push(new sA(this,this.richContentEditor)),this.propertyEditors.push(new vE(this,this.richContentEditor))),this.multiResizeDirection.push("w","e")},t.prototype.getCursor=function(t){var n;return(null===(n=t.connectionData)||void 0===n?void 0:n.isMindMapLocation)?"pointer":e.prototype.getCursor.call(this,t)},t.prototype.dealClick=function(t){var n,i;(null===(i=null===(n=this.opData)||void 0===n?void 0:n.connectionData)||void 0===i?void 0:i.isMindMapLocation)&&"left"===t.connectType?this.upime.insertMindMapNode(this.element,this.opData.connectionData):e.prototype.dealClick.call(this,t)},t.prototype.dealTabKey=function(e){e.originEvent.stopPropagation(),this.handleEnterOrTab(e.originEvent)},t.prototype.dealEnterKey=function(e){e.originEvent.stopPropagation(),this.handleEnterOrTab(e.originEvent)},t.prototype.moveElementMembers=function(e){var t=this;this.movingEles=this.getMovingElements();var n=e.deltaX,i=e.deltaY;this.movingEles.forEach((function(r){if(r!==t.element)if(r.elementType===Za.CONNECTIONLINE){var o=fN(r,e);o&&t.addUpdate(r,o)}else t.addUpdate(r,{position:{x:r.position.x+n,y:r.position.y+i}})}))},t.prototype.handleSelectCtrlMove=function(e){var t=this.checkBeforeMove(e);this.handleAnyMove(t),this.moveElementMembers(t),e.isStart&&(this.setPositionInfo(),this.saveOriginParents());var n=e.position;this.nodesOnlyRoot.length>0&&this.checkNodesNeedReverse(n);var i=this.checkReciveNodes(n);if(i?this.setParent(i,e.isEnd,!0,n):this.setParent(this.checkNearlyNodes(n),e.isEnd,!1),e.isEnd){var r=this.currentOp;this.onEndClear(r),r&&this.element.onAlignTheTree(r)}},t.prototype.dealMultiEditorMove=function(t){var n,i,r=this;if(e.prototype.dealMultiEditorMove.call(this,t),this.nodesOnlyRoot.includes(this.element)){var o=this.element.getDescendants((function(e){return!e.isMindmapNodeHideByCollapsed})).filter((function(e){return!r.movingNodes.includes(e)})).filter((function(e){return!r._movingElements.includes(e)}));(n=this._movingElements).push.apply(n,o)}var a=t.deltaX,s=t.deltaY;if(this._movingElements.forEach((function(e){if(e!==r.element)if(e.elementType===Za.CONNECTIONLINE){var n=fN(e,t);n&&r.addUpdate(e,n)}else r.addUpdate(e,{position:{x:e.position.x+a,y:e.position.y+s}})})),(t.isStart||this.isFirstEditor)&&(t.isStart&&(this.isFirstEditor=this.getFirstMindmapEditor()===this),this.isFirstEditor))if(t.isStart)this.setPositionInfo();else{this.savedParent||this.saveOriginParents();var l=null===(i=t.event)||void 0===i?void 0:i.position,c=this.currentOp;if(l){var u=this.checkReciveNodes(l);u?this.setParent(u,t.isEnd,!0,l):(u=this.checkNearlyNodes(l),this.setParent(u,t.isEnd,!1,l))}if(t.isEnd)if(c){var d=new Map(this.movingNodes.map((function(e){return[e.root,e.layout]})));this.onEndClear(c),d.forEach((function(e,t){t.onAlignTheTree(c,e)}))}else this.onEndClear(c)}},t.prototype.checkMovedElementsInFrame=function(e){var t=this;e.forEach((function(e){t.checkFrameRelation(e,{isEnd:!0})}))},t.prototype.checkPointDirection=function(t,n,i){var r=e.prototype.checkPointDirection.call(this,t,n,i);return!this.element.rawText||""!==r&&"w"!==r&&"e"!==r?"":r},t.prototype.checkConnectionRelation=function(t){var n=e.prototype.checkConnectionRelation.call(this,t);return n||(n=this.element.checkMindMapConnectionRelation(t)),n},t.prototype.doDelete=function(t){var n,i,r=this;e.prototype.doDelete.call(this,t),this.element.getDescendants().forEach((function(e){e.frozedGroupId=null;var n=new e.editorType(r.upime,e,r);e.frozedGroupId&&n.unfrozeElement(),n.doDelete(t)}));var o=this.element;if(this.manager instanceof kh){var a=(null===(i=null===(n=this.manager)||void 0===n?void 0:n.elements)||void 0===i?void 0:i.filter((function(e){return e.elementType===Za.MINDMAP_NODE&&e.root===o.root})))||[];o===a.at(-1)&&this.element.onAlignTheTree(t)}else this.manager||this.element.onAlignTheTree(t)},t.prototype._handleElementsChange=function(e,t){void 0===t&&(t=!1);var n=this.getOp();this.currentOp=n;var i=e(n);if(i.length>0){t&&this.checkMovedElementsInFrame(i);var r=this.upime.createLock(i.map((function(e){return e.id})));n.sync(),this.upime.clearLock(r)}else n.cancelCreate()},t.prototype._handleElementsDelayChange=function(e,t){this.currentOp=this.currentOp||this.upime.createOperation();var n=this.currentOp,i=e(n);t.isStart&&(this._currentOpStart=!0),i.length>0&&this._currentOpStart&&(this.currentLock=this.upime.createLock(i.map((function(e){return e.id}))),this._currentOpStart=!1),t.isEnd&&(this.currentLock&&(n.sync(),this.upime.clearLock(this.currentLock),this.currentLock=void 0),this._currentOpStart=!1,this.currentOp=void 0)},t.prototype.alignChildNodes=function(){var e=this;this.element.isLeafNode||(this.stopEdit(),this._handleElementsChange((function(t){return e.element.alignChildNodes(t)}),!0),this.currentOp=void 0)},t.prototype.changeLayout=function(e){var t=this;this.element.isRootNode&&this._handleElementsChange((function(n){return t.element.changeLayout(e,n)}),!0)},t.prototype.changeTheme=function(e){var t=this;this.element.isRootNode&&this._handleElementsChange((function(n){return t.element.changeTheme(e,n)}))},t.prototype.changeColor=function(e){var t=this;this._handleElementsChange((function(n){return t.element.changeColor(e,n)}))},t.prototype.slideChangeColor=function(e,t){var n=this;this._handleElementsDelayChange((function(t){return n.element.changeColor(e,t)}),t)},t.prototype.randomizeColor=function(){var e=this;this.element.isRootNode&&this._handleElementsChange((function(t){return e.element.randomizeColor(t)}))},t.prototype.changeFontSize=function(e){var t=this;this.element.isRootNode&&(this._handleElementsChange((function(n){return t.element.changeFontSize(e,n)})),this.updateBorderBox())},t.prototype.dealResized=function(e,t,n){var i;void 0===n&&(n=!1),n&&this.dealOpStart(e);var r=this.element.dealResized(t,this.currentOp),o=(null===(i=this.currentLock)||void 0===i?void 0:i.ids)||[],a=[];r.forEach((function(e){o.includes(e.id)||a.push(e)})),this.lockOtherElements(a),n&&this.dealOpEnd(e)},t.prototype.handleEnterOrTab=function(e){var t=e.key,n=this.element,i=this.element.mindMapConnectableLocations[0],r=void 0;switch(this.element.isRootNode?i=this.element.layout===Xa.VERTICAL?"b":"r":"Enter"===t&&(n=this.element.parent,r=this.element),i){case"r":case"b":n.rightCollapsed&&n.toggleRightCollapsed();break;case"t":case"l":n.leftCollapsed&&n.toggleLeftCollapsed()}this.upime.insertMindMapNode(n,{location:i,isMindMapLocation:!0},r)},t.prototype.insertNodes=function(e,t){var n=this,i=t||this.getOp(),r=this.element.insertNodes(e,i);return e.forEach((function(e){e.theme!==n.element.theme&&e.changeTheme(n.element.theme,i,!0)})),this.element.onAlignTheTree(i),r},t.prototype.getFirstMindmapEditor=function(){var e,t;return(null===(t=null===(e=this.manager)||void 0===e?void 0:e.getMovingEditors())||void 0===t?void 0:t.find((function(e){return e.element.elementType===Za.MINDMAP_NODE})))||this},t.prototype.getMindMapNodeEditors=function(){var e,t;return(null===(t=null===(e=this.manager)||void 0===e?void 0:e.getMovingEditors())||void 0===t?void 0:t.filter((function(e){return e.element.elementType===Za.MINDMAP_NODE})))||[this]},t.prototype.setPositionInfo=function(){var e=this;this.mindMapNodeEditors=this.getMindMapNodeEditors(),this.movingNodes=this.mindMapNodeEditors.map((function(e){return e.element})),this.nodesOnlyRoot=this.movingNodes.filter((function(t){return!t.parent||!e.movingNodes.includes(t.parent)})).filter((function(e){return!e.getDescendants().some((function(e){return e.locked}))})),this.nodesOnlyRoot.forEach((function(e){return e.isOutofLayout=!0}));var t=new Set(this.movingNodes.map((function(e){return R([e.id],e.getDescendants().map((function(e){return e.id})),!0)})).flat());this.allNodes=this.upime.elementManager.getConnectableElements().filter((function(e){return e.elementType===Za.MINDMAP_NODE&&!e.locked&&!e.isMindmapNodeHideByCollapsed&&!t.has(e.id)})).filter((function(e){return e.isRootNode?!e.leftCollapsed||!e.rightCollapsed:!e.leftCollapsed&&!e.rightCollapsed}))},t.prototype.checkNodesNeedReverse=function(e){var t=this.currentOp,n=this.element.parent;if((null==n?void 0:n.isRootNode)&&t){var i=n.getGlobalBox(),r=(i.left+i.right)/2,o=(i.top+i.bottom)/2,a=this.element.isLeftSubtreeNode,s=!1;n.layout===Xa.VERTICAL?(a&&!n.rightCollapsed&&e.y>o&&(s=!0),!a&&!n.leftCollapsed&&e.y<o&&(s=!0)):(a&&!n.rightCollapsed&&e.x>r&&(s=!0),!a&&!n.leftCollapsed&&e.x<r&&(s=!0)),s&&t&&this.element.reassignParent(n.copy(),t,{needCheckReverse:!0})}},t.prototype.checkReciveNodes=function(e){return this.nodesOnlyRoot.forEach((function(e){e.isWillBeRecived=!1})),this.allNodes.forEach((function(e){e.isWillReciveChildren=!1})),this.allNodes.find((function(t){return Ot(e,t.getGlobalBox())}))},t.prototype.checkNearlyNodes=function(e){var t=this;if(!this.element.isRootNode&&!this.rootNodePropMap.get(this.element.id)){var n=-1,i=1/0,r=150*this.element.scale;return this.allNodes.forEach((function(o,a){var s=o.isLeftSubtreeNode,l=o.getGlobalBox(),c=(l.left+l.right)/2,u=(l.top+l.bottom)/2;if(o.layout===Xa.VERTICAL?u=o.isRootNode?e.y<=u?l.top:l.bottom:s?l.top:l.bottom:c=o.isRootNode?e.x<=c?l.left:l.right:s?l.left:l.right,!o.isRootNode&&!t.element.isRootNode)if(t.element.layout===Xa.VERTICAL){if(s&&e.y>=u)return;if(!s&&e.y<=u)return}else{if(s&&e.x>=c)return;if(!s&&e.x<=c)return}if(o.isRootNode&&(o.leftCollapsed||o.rightCollapsed))if(t.element.layout===Xa.VERTICAL){if(o.leftCollapsed&&e.y<=u)return;if(o.rightCollapsed&&e.y>=u)return}else{if(o.leftCollapsed&&e.x<=c)return;if(o.rightCollapsed&&e.x>=c)return}var d=o.layout===Xa.VERTICAL?Math.abs(e.y-u):Math.abs(e.x-c),p=o.layout!==Xa.VERTICAL?Math.abs(e.y-u):Math.abs(e.x-c);if(!(p>=r/4)){var h=.5*d+2*p;h<=r&&h<i&&(n=a,i=h)}})),-1===n?void 0:this.allNodes[n]}},t.prototype.setParent=function(e,t,n,i){var r=this,o=this.currentOp;if(o)if(e){n&&!t&&(e.isWillReciveChildren=!0);var a=!1;this.nodesOnlyRoot.forEach((function(s){var l,c;if(n&&!t&&(s.isWillBeRecived=!0),e!==s.parent||(null===(l=s.parent)||void 0===l?void 0:l.isRootNode)){if(s.isRootNode&&!n)return;if(s.isRootNode&&(a=!0),s.reassignParent(e.copy(),o,{needCheckReverse:null===(c=s.parent)||void 0===c?void 0:c.isRootNode,basePosition:i}),!r._calcdMovingElements&&r.rootNodePropMap.has(s.id)){var u=s.getDescendants((function(e){return!e.isMindmapNodeHideByCollapsed})).filter((function(e){return!r.movingNodes.includes(e)}));r._movingElements=u}}})),a&&(this.movingEles=this.getMovingElements())}else this.nodesOnlyRoot.forEach((function(e){var t=r.parentsMap.get(e.id);t?e.reassignParent(t.copy(),o,{basePosition:i}):e.isRootNode||e.toRoot(o,r.rootNodePropMap.get(e.id))}))},t.prototype.saveOriginParents=function(){var e=this;this.nodesOnlyRoot.forEach((function(t){var n,i;t.parent?e.parentsMap.set(t.id,t.parent):t.isRootNode&&e.rootNodePropMap.set(t.id,{rootProp:t.copy(),left:null===(n=t.children.filter((function(e){return e.isLeftSubtreeNode})))||void 0===n?void 0:n.map((function(e){return e.copy()})),right:null===(i=t.children.filter((function(e){return!e.isLeftSubtreeNode})))||void 0===i?void 0:i.map((function(e){return e.copy()}))})})),this.savedParent=!0},t.prototype.onEndClear=function(e){var t=this;if(e){this.nodesOnlyRoot.forEach((function(n){var i,r=t.rootNodePropMap.get(n.id);r&&(null===(i=r.rootProp)||void 0===i?void 0:i.isRootNode)!==n.isRootNode&&n.updateRootStyle(!1,e)}));var n=new Map;this.nodesOnlyRoot.forEach((function(t){n.has(t.root)||t.root.layout===Xa.NONE&&(e.update(t.root,{layout:t.layout}),n.set(t.root,t.layout))}));var i=new Set;this.nodesOnlyRoot.forEach((function(e){var n,r=t.parentsMap.get(e.id);r&&(null===(n=e.parent)||void 0===n?void 0:n.id)!==r.id&&i.add(r)})),i.forEach((function(t){t.onAlignTheTree(e)}));var r=new Set(this.nodesOnlyRoot.map((function(e){return R([e],e.getDescendants(),!0)})).flat()),o=!this.nodesOnlyRoot.some((function(e){return e.isRootNode}))&&e.getReverseData().every((function(e){var t,n=Object.keys(e.update);if(e.element instanceof lD){if(1===n.length&&"startElementId"===n[0]){var i=null===(t=e.element.startElement)||void 0===t?void 0:t.id;return e.update.startElementId===i}return!1}return 1===n.length&&"position"===n[0]&&!!r.has(e.element)}));o&&this.upime.deleteOperation(e)}this.nodesOnlyRoot.forEach((function(e){return e.isOutofLayout=!1})),this.mindMapNodeEditors=[],this.movingNodes=[],this.nodesOnlyRoot=[],this.allNodes=[],this.parentsMap.clear(),this.rootNodePropMap.clear(),this._movingElements=[],this._calcdMovingElements=!1},t.prototype.checkSelectRelation=function(t,n){return this.element.nodeCollapsedCtrl.checkPointInArea(t)?{transparent:!0,metric:-1}:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.stopEdit=function(){e.prototype.stopEdit.call(this);var t=this._currentOp||this.upime.createOperation(),n=this.element.onAlignTheTree(t);t.sync(),0===n.length&&this.element.upime.deleteOperation(t)},t.prototype.checkBeforeMove=function(t){var n;if(this.element.isRootNode)return e.prototype.checkBeforeMove.call(this,t);var i=t.isStart,r=t.isEnd,o=t.startPosition,a=t.position,s=a.x-o.x,l=a.y-o.y,c=null===(n=this.opData)||void 0===n?void 0:n.moveData,u=c.originBorder,d={left:u.left+s,top:u.top+l,right:u.right+s,bottom:u.bottom+l},p=c.preBorder||c.originBorder;return c.preBorder=d,{isStart:i,isEnd:r,deltaX:d.left-p.left,deltaY:d.top-p.top,event:t}},t.prototype.handleDirectMoveCtrl=function(t,n){if(this.element.isRootNode){e.prototype.handleDirectMoveCtrl.call(this,t,n);var i=this.currentOp;i&&this.element.onAlignTheTree(i)}},t.prototype.handleDirectMoveKeyUp=function(t){if(this.element.isRootNode){var n=this.currentOp;return n&&this.element.onAlignTheTree(n),e.prototype.handleDirectMoveKeyUp.call(this,t)}},t.prototype.expandAllChildren=function(){var e=this.element.getDescendants(),t=this.upime.createOperation();R([this.element],e,!0).forEach((function(e){if(!e.isLeafNode&&(e.leftCollapsed||e.rightCollapsed)){var n={},i=e.children.some((function(e){return e.isLeftSubtreeNode})),r=e.children.some((function(e){return!e.isLeftSubtreeNode}));i&&(n.leftCollapsed=!1),r&&(n.rightCollapsed=!1),t.update(e,n)}})),this.element.onAlignTheTree(t),t.sync()},t.prototype.collapseAllChildren=function(){var e=this.element.getDescendants(),t=this.upime.createOperation();R([this.element],e,!0).forEach((function(e){if(!(e.isLeafNode||e.leftCollapsed&&e.rightCollapsed)){var n={},i=e.children.some((function(e){return e.isLeftSubtreeNode})),r=e.children.some((function(e){return!e.isLeftSubtreeNode}));i&&(n.leftCollapsed=!0),r&&(n.rightCollapsed=!0),t.update(e,n)}})),this.element.onAlignTheTree(t),t.sync()},t}(vA),uD=function(e){function t(t){var n=e.call(this,t)||this;return n.element=t,n}return P(t,e),t.prototype.handleEnterInput=function(e){return!1},t.prototype.handleEnterKeyDown=function(e){var t=this.contentEditor;return e.ctrlKey||e.metaKey?(e.preventDefault(),t.insertLineBreak(),!0):!e.shiftKey&&(e.preventDefault(),this.currentEditor.handleEnterOrTab(e),!0)},t.prototype.handleKeyDown=function(t){return"Tab"===t.key?(t.preventDefault(),this.currentEditor.handleEnterOrTab(t),!0):e.prototype.handleKeyDown.call(this,t)},t.prototype.handleTabKey=function(){return!1},t}(bA),dD="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAABXCAMAAABRNLmXAAAAq1BMVEUAAADu7u7r6+7r6+7s7O/r6+3t7e3s7O7s7O7s7O7t7e3s7O7s7O/s7O7////t7e7s7O7s7Ozs7O7r6+7t7e/s7O7u7u/y8vP09PX19fbz8/T7+/v////w8PL8/Pzz8/X/7/3/zvj/wvb/wPX/+v7/tvT/guz/l+//7vz/pPH/vfX/0vj/uvX/tPT/1fn/hu3/5vv/j+7/8v3/m/D/+/7/rPL4+Pn/nPDx8fKUcfVcAAAAFXRSTlMALE1mfIA4luOVKrBt+wWa/De/tn5dqhdoAAACEUlEQVRYw+3Z2XKCMBQGYAUV61q1UXCpAor7vrTv/2Q9SUDBomFJOm0n5w4GPyEJZOY/mczPVVZRc/nklVOV7CO6oBVR+iq+FELsUpkDTatcuscrVXy+3dGNNKV32pipVgJ2rY5Pdnv99NXrYqpe8+kYH7xzsHG9DzDvGxY4HHKycQ3Buw5O6ZUvTviqN7WwWgZc8X4fBqfsrnN4Dm/MR6ZlJy/LHHljD2aD6BqsFnpuPHHS1mRMKVg5GtHhDaVLcTxNjTvOlPI9eGvJtwVeIvp/6e+c3D3F4LXC3xwFoQ45nnHBHYeOfQchBXQVIZ0cm5x0k2g6QiroOYQMcmxx0i2iGQjlQM97us1Jtz09L3Wp/y19vnj6yV3M0+hL5jaxTK7PI+xC88T6KoK++qX3LnbcBa+ZRCV1qUv9v+lybwrXVxF0uTfJvUnqUpd6Yl1sCiE2QRGb/ohNrsSmboITQ3/aOQtPO9fflHV42jlznVvaGSWp3WwD9nbDuP6W1GZKVXbKvNv78P2OcbU/ZY6UkB+OV/x4YOPI1z6Iku6fzi5+Pj2/8D7dj9iZoB8i+/lFIZ0JVlflQn8Jc+vN5yVGV4XZETLcuf1w59OI1xFidbOMwOM/wYta41G77EEnrnnHY7wZsxP3uGqtAI/xVi0+E4nnjQd4/riPF4FfeTG4y38Kwl1eFO7yonDCi8OBf4uHfwFO51ThlqFXpwAAAABJRU5ErkJggg==",pD=new Image,hD=!1;pD.src=dD,pD.onload=function(){hD=!0};var fD=function(){},mD=new Map,vD=function(e,t){return function(n){return n<=e[0]?t[0]:n>=e[1]?t[1]:t[0]+(n-e[0])/(e[1]-e[0])*(t[1]-t[0])}}([1,4],[2,1]);function gD(e,t,n){var i=ut({fontSize:t,fontFamily:n}),r="".concat(e,"-").concat(i);if(!mD.has(r)){st.save(),st.font=i;var o=st.measureText(e).width;st.restore(),mD.set(r,o)}return mD.get(r)||24}function yD(e){return e>199?"199+":e.toString()}function bD(e,t,n,i,r){var o=t.x,a=t.y,s=vD(r);e.clear(),i?e.beginFill(Er("rgb(46, 115, 229)")):(e.lineStyle({width:s,color:Er("rgb(46, 115, 229)")}),e.beginFill(Er("rgb(255, 255, 255)")));var l=i?n+s/2:n;e.drawCircle(o,a,l),i&&e.lineStyle({width:s,color:Er("rgb(255, 255, 255)")}),e.moveTo(o-n/2,a),e.lineTo(o+n/2,a),e.endFill()}function ED(e,t,n,i,r,o,a,s,l){var c=n.x,u=n.y,d=yD(t),p=gD(d,e.fontSize,e.fontFamily),h=e.r,f=vD(l),m=e.useCallback("rightNumber",(function(e){if(e.clear(),a?(e.lineStyle({width:f,color:Er("rgb(46, 115, 229)")}),e.beginFill(Er("rgb(46, 115, 229)"))):(e.lineStyle({width:f,color:Er("rgb(46, 115, 229)")}),e.beginFill(Er("rgb(255, 255, 255)"))),p<=2*h)e.drawCircle(c,u,h);else{var t=p+h/2;e.drawRoundedRect(c-t/2,u-h,t,2*h,h)}}),[i,r,e.boxBorder,o,p,a,e.layout,e.isLeftSubtreeNode,l]);Na(m),Ra({text:d,fontFamily:e.fontFamily,fontSize:e.fontSize},{fill:a?"#ffffff":"rgb(46, 115, 229)",va:"middle",ha:"center",x:c,y:u}),s&&hD&&Oa({src:{imgSrc:dD,content:pD,refs:[],errorCount:0,originWidth:93,originHeight:87,loaded:!0,ref:fD,unref:fD,copyImgSource:fD},width:24,height:22,x:c-12,y:u-h-22-2})}var xD=function(){function e(e){this.node=e,this.isHoverd=!1,this.isLeftHoverd=!1,this.isRightHoverd=!1,this.leftWidth=0,this.rightWidth=0}return Object.defineProperty(e.prototype,"parent",{get:function(){return this.node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftCollapsed",{get:function(){return Boolean(this.node.leftCollapsedFinally)},set:function(e){throw Error("leftCollapsed is readonly")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightCollapsed",{get:function(){return Boolean(this.node.rightCollapsedFinally)},set:function(e){throw Error("rightCollapsed is readonly")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLeftSubtreeNode",{get:function(){return this.node.isLeftSubtreeNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.node.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.node.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){return this.node.layout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boxBorder",{get:function(){return this.node.boxBorder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.node.position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.node.fontSize*this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.node.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"phomeMode",{get:function(){return this.node.upime.phoneMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftSubtreeNodes",{get:function(){return this.node.isRootNode?this.node.children.filter((function(e){return e.isLeftSubtreeNode})):this.node.isLeftSubtreeNode?this.node.children:[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightSubtreeNodes",{get:function(){return this.node.isRootNode?this.node.children.filter((function(e){return!e.isLeftSubtreeNode})):this.node.isLeftSubtreeNode?[]:this.node.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowLeft",{get:function(){return!!this.isShowCollapsed&&this.layout===Xa.HORIZONTAL&&this.leftSubtreeNodes.length>0&&!this.leftCollapsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowRight",{get:function(){return!!this.isShowCollapsed&&this.layout===Xa.HORIZONTAL&&this.rightSubtreeNodes.length>0&&!this.rightCollapsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowTop",{get:function(){return!!this.isShowCollapsed&&this.layout===Xa.VERTICAL&&this.leftSubtreeNodes.length>0&&!this.leftCollapsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowBottom",{get:function(){return!!this.isShowCollapsed&&this.layout===Xa.VERTICAL&&this.rightSubtreeNodes.length>0&&!this.rightCollapsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftTreeCount",{get:function(){return this.node.leftSubtreeNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightTreeCount",{get:function(){return this.node.rightSubtreeNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowLeftNumber",{get:function(){return this.layout===Xa.HORIZONTAL&&!this.node.isLeafNode&&!!this.leftCollapsed&&!(!this.node.isRootNode&&!this.node.isLeftSubtreeNode)&&this.leftTreeCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowRightNumber",{get:function(){return this.layout===Xa.HORIZONTAL&&!this.node.isLeafNode&&!!this.rightCollapsed&&!(!this.node.isRootNode&&this.node.isLeftSubtreeNode)&&this.rightTreeCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowTopNumber",{get:function(){return this.layout===Xa.VERTICAL&&!this.node.isLeafNode&&!!this.leftCollapsed&&!(!this.node.isRootNode&&!this.node.isLeftSubtreeNode)&&this.leftTreeCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowBottomNumber",{get:function(){return this.layout===Xa.VERTICAL&&!this.node.isLeafNode&&!!this.rightCollapsed&&!(!this.node.isRootNode&&this.node.isLeftSubtreeNode)&&this.rightTreeCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return 11*this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return 16*this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodeWidth",{get:function(){return this.node.size.width*this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodeHeight",{get:function(){return this.node.size.height*this.scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftTreeCollapsedCenter",{get:function(){return this.layout===Xa.VERTICAL?{x:this.nodeWidth/2,y:-this.gap}:{x:-this.gap,y:this.nodeHeight/2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightTreeCollapsedCenter",{get:function(){return this.layout===Xa.VERTICAL?{x:this.nodeWidth/2,y:this.nodeHeight+this.gap}:{x:this.nodeWidth+this.gap,y:this.nodeHeight/2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isShowCollapsed",{get:function(){return!!this.node.isSelected||this.isHoverd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftTreeShowComment",{get:function(){var e=new Set(this.node.upime.elementManager.getAllComments().map((function(e){return e.attached})).filter(Boolean));return this.node.leftSubtreeNodes.some((function(t){return e.has(t.id)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightTreeShowComment",{get:function(){var e=new Set(this.node.upime.elementManager.getAllComments((function(e){return e.visible})).map((function(e){return e.attached})).filter(Boolean));return this.node.rightSubtreeNodes.some((function(t){return e.has(t.id)}))},enumerable:!1,configurable:!0}),e.prototype.useCallback=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.node).useCallback.apply(e,t)},e.prototype.checkInteractRelation=function(e,t){return this.node.stable?null:"hover"===(null==t?void 0:t.type)?this.checkInteractRelationHover(e):"click"===(null==t?void 0:t.type)?this.checkInteractRelationClick(e):null},e.prototype.checkInteractRelationHover=function(e){if(!this.node.isSelected){if(!this.checkHotareaHover(e))return null;switch(this.checkButtonHover(e)){case"l":case"t":return this.getSelectRelation({mindmapNodeCollapseBtn:!0,mindmapNodeLeftCollapseActive:!0});case"r":case"b":return this.getSelectRelation({mindmapNodeCollapseBtn:!0,mindmapNodeRightCollapseActive:!0})}return this.getSelectRelation({mindmapNodeCollapseBtn:!0})}switch(this.checkButtonHover(e)){case"l":case"t":return this.getSelectRelation({mindmapNodeLeftCollapseActive:!0});case"r":case"b":return this.getSelectRelation({mindmapNodeRightCollapseActive:!0})}return null},e.prototype.checkInteractRelationClick=function(e){switch(this.checkPointInArea(e)){case"l":case"t":return this.getSelectRelation({mindmapNodeleftCollapsed:!0});case"r":case"b":return this.getSelectRelation({mindmapNodeRightCollapsed:!0})}return null},e.prototype.getSelectRelation=function(e){return{transparent:!1,metric:-1,metaData:{clickData:e}}},e.prototype.render=function(){!function(e){var t=e.scale,n=e.size.width*t,i=e.size.height*t,r=e.position,o=r.x,a=r.y,s=js.value.getElementAlpha,l=void 0===s?function(){return 1}:s,c=e.parent,u=c.upime.view.scale;(fa({x:o,y:a,alpha:c?l(c):0}),e.isShowTop)&&Na(e.useCallback("top",(function(t){bD(t,e.leftTreeCollapsedCenter,e.r,e.isLeftHoverd,u)}),[n,i,e.boxBorder,t,e.layout,e.isLeftHoverd,u]));e.isShowBottom&&Na(e.useCallback("bottom",(function(t){bD(t,e.rightTreeCollapsedCenter,e.r,e.isRightHoverd,u)}),[n,i,e.boxBorder,t,e.layout,e.isRightHoverd,u]));e.isShowLeft&&Na(e.useCallback("left",(function(t){bD(t,e.leftTreeCollapsedCenter,e.r,e.isLeftHoverd,u)}),[n,i,e.boxBorder,t,e.layout,e.isLeftHoverd,u]));e.isShowRight&&Na(e.useCallback("right",(function(t){bD(t,e.rightTreeCollapsedCenter,e.r,e.isRightHoverd,u)}),[n,i,e.boxBorder,t,e.layout,e.isRightHoverd,u]));e.isShowTopNumber&&ED(e,e.leftTreeCount,e.leftTreeCollapsedCenter,n,i,t,e.isLeftHoverd,e.leftTreeShowComment,u),e.isShowBottomNumber&&ED(e,e.rightTreeCount,e.rightTreeCollapsedCenter,n,i,t,e.isRightHoverd,e.rightTreeShowComment,u),e.isShowLeftNumber&&ED(e,e.leftTreeCount,e.leftTreeCollapsedCenter,n,i,t,e.isLeftHoverd,e.leftTreeShowComment,u),e.isShowRightNumber&&ED(e,e.rightTreeCount,e.rightTreeCollapsedCenter,n,i,t,e.isRightHoverd,e.rightTreeShowComment,u),ma()}(this)},e.prototype.checkPointInArea=function(e){return this.isShowLeft&&this.isInLeftCircle(e)||this.isShowLeftNumber&&this.isInLeftBox(e)?"l":this.isShowTop&&this.isInTopCircle(e)||this.isShowTopNumber&&this.isInTopBox(e)?"t":this.isShowRight&&this.isInRightCircle(e)||this.isShowRightNumber&&this.isInRightBox(e)?"r":this.isShowBottom&&this.isInBottomCircle(e)||this.isShowBottomNumber&&this.isInBottomBox(e)?"b":""},e.prototype.checkHotareaHover=function(e){var t=exports.E({},this.node.getGlobalBox()),n=this.r,i=this.gap;return this.leftSubtreeNodes.length&&(this.layout===Xa.VERTICAL?t.top-=i+n:t.left-=i+n),this.rightSubtreeNodes.length&&(this.layout===Xa.VERTICAL?t.bottom+=i+n:t.right+=i+n),Ot(e,t)},e.prototype.checkButtonHover=function(e){var t=this.checkCollapsedButtonHover(e);return t||this.checkOpenButtonHover(e)},e.prototype.checkCollapsedButtonHover=function(e){return this.isShowLeft&&this.isInLeftCircle(e)?"l":this.isShowRight&&this.isInRightCircle(e)?"r":this.isShowTop&&this.isInTopCircle(e)?"t":this.isShowBottom&&this.isInBottomCircle(e)?"b":""},e.prototype.checkOpenButtonHover=function(e){return this.isShowLeftNumber&&this.isInLeftBox(e)?"l":this.isShowRightNumber&&this.isInRightBox(e)?"r":this.isShowTopNumber&&this.isInTopBox(e)?"t":this.isShowBottomNumber&&this.isInBottomBox(e)?"b":""},e.prototype.isInTopCircle=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=Math.pow(t,2),o=(i.left+i.right)/2;return Math.pow(e.x-o,2)+Math.pow(e.y-(i.top-n),2)<=r},e.prototype.isInTopBox=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=(i.left+i.right)/2,o=gD(yD(this.leftTreeCount),this.fontSize,this.fontFamily);return o<=t?this.isInTopCircle(e):Ot(e,{left:r-o/2-t/2,right:r+o/2+t/2,top:i.top-n-t,bottom:i.top-n+t})},e.prototype.isInRightCircle=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=Math.pow(t,2),o=(i.top+i.bottom)/2;return Math.pow(e.x-(i.right+n),2)+Math.pow(e.y-o,2)<=r},e.prototype.isInRightBox=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=(i.top+i.bottom)/2,o=gD(yD(this.rightTreeCount),this.fontSize,this.fontFamily);return o<=t?this.isInRightCircle(e):Ot(e,{left:i.right+n-o/2-t/2,right:i.right+n+o/2+t/2,top:r-t,bottom:r+t})},e.prototype.isInBottomCircle=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=Math.pow(t,2),o=(i.left+i.right)/2;return Math.pow(e.x-o,2)+Math.pow(e.y-(i.bottom+n),2)<=r},e.prototype.isInBottomBox=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=(i.left+i.right)/2,o=gD(yD(this.rightTreeCount),this.fontSize,this.fontFamily);return o<=t?this.isInBottomCircle(e):Ot(e,{left:r-o/2-t/2,right:r+o/2+t/2,top:i.bottom+n-t,bottom:i.bottom+n+t})},e.prototype.isInLeftCircle=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=Math.pow(t,2),o=(i.top+i.bottom)/2;return Math.pow(e.x-(i.left-n),2)+Math.pow(e.y-o,2)<=r},e.prototype.isInLeftBox=function(e){var t=this.r,n=this.gap,i=this.node.getGlobalBox(),r=(i.top+i.bottom)/2,o=gD(yD(this.leftTreeCount),this.fontSize,this.fontFamily);return o<=t?this.isInLeftCircle(e):Ot(e,{left:i.left-n-o/2-t/2,right:i.left-n+o/2+t/2,top:r-t,bottom:r+t})},e}(),wD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editorType=cD,t.elementType=Za.MINDMAP_NODE,t.layout=Xa.NONE,t.theme=Qa.COLORBRANCH,t.parent=null,t.precursorLine=null,t.preparePrecursorLine=null,t.isRootNode=!1,t.nodeColor=8005887,t._originParent=null,t.leftCollapsed=null,t.rightCollapsed=null,t.leftCollapsedLocal=null,t.rightCollapsedLocal=null,t.positionServer=void 0,t.isMindmapNodeHideByCollapsed=!1,t.nodeCollapsedCtrl=new xD(t),t.isSelected=!1,t.isWillReciveChildren=!1,t._isWillBeRecived=!1,t.isOutofLayout=!1,t.abstractTree=new WA(t),t.renderer=function(e){if((!e||t.isRootNode)&&!t.isMindmapNodeHideByCollapsed){var n=t.theme===Qa.COLORBRANCH?3:2;t.children.forEach((function(e){e.isMindmapNodeHideByCollapsed||(!e.isRootNode&&e.precursorLine&&(e.precursorLine.lineType!==n&&e.precursorLine.dealUpdate({lineType:n}),e.precursorLine.renderer(e.precursorLine)),e.renderer())})),function(e){var t=e.position,n=e.size,i=e.isRootNode,r=e.textRect,o=e.isWillReciveChildren,a=e.scale,s=r.x*a,l=r.y*a,c=t.x,u=t.y,d=n.width*a,p=n.height*a;if(yf(e),fa({x:c,y:u}),i){var h=e.useCallback("drawBorder",(function(t){var n=e.boxBorder,i=n.borderColor,r=n.borderRadius*a,o=n.borderWidth;o>d/2&&(o=d/2),o>p/2&&(o=p/2),r<2*o&&(r=2*o),t.clear(),t.lineStyle({width:o,color:i,cap:"round",join:"round"}),t.drawRoundedRect(o/2,o/2,d-o,p-o,r-o/2)}),[d,p,e.boxBorder,a]);Na(h)}if(o){var f=e.useCallback("drawActive",(function(e){var t=1;t>d/2&&(t=d/2),t>p/2&&(t=p/2),e.clear(),e.beginFill(Er("rgb(12,16,36)"),.13),e.drawRect(t/2,t/2,d-t,p-t),e.endFill()}),[d,p,e.boxBorder,a]);Na(f)}jy({x:s,y:l,maxHeight:r.height,element:e,richClient:e.richTextClient,isWheeling:e.upime.view.isWheeling}),ma(),ma()}(t),t.nodeCollapsedCtrl.render()}},t}return P(t,e),Object.defineProperty(t.prototype,"supportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.setLeftCollapsedLocal=function(e){e!==this.leftCollapsedLocal&&(this.leftCollapsedLocal=e,null!==e?this.abstractTree.addLocalModeNode(this):this.abstractTree.removeLocalModeNode(this))},Object.defineProperty(t.prototype,"leftCollapsedFinally",{get:function(){return null===this.leftCollapsedLocal?this.leftCollapsed:this.leftCollapsedLocal},enumerable:!1,configurable:!0}),t.prototype.setRightCollapsedLocal=function(e){e!==this.rightCollapsedLocal&&(this.rightCollapsedLocal=e,null!==e?this.abstractTree.addLocalModeNode(this):this.abstractTree.removeLocalModeNode(this))},Object.defineProperty(t.prototype,"rightCollapsedFinally",{get:function(){return null===this.rightCollapsedLocal?this.rightCollapsed:this.rightCollapsedLocal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasLocalState",{get:function(){return null!==this.rightCollapsedLocal||null!==this.leftCollapsedLocal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInLocalModeTree",{get:function(){return this.abstractTree.isInLocalMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWillBeRecived",{get:function(){return this._isWillBeRecived},set:function(e){this._isWillBeRecived=e,this.precursorLine&&(this.precursorLine.isShow=!e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportFrame",{get:function(){return this.isRootNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lockFinally",{get:function(){return!this.isInLocalModeTree&&this.locked},enumerable:!1,configurable:!0}),t.prototype._checkUnAvailable=function(){return!this.isRootNode&&!this.root||e.prototype._checkUnAvailable.call(this)&&!this.isInLocalModeTree},Object.defineProperty(t.prototype,"childrenIncludeDeleted",{get:function(){return this.abstractTree.fincMindmapNodeChildren(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.childrenIncludeDeleted.filter((function(e){return!e.deleted}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childrenCount",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportSwitchToWebpage",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.initRichClient=function(){return new uD(this)},t.prototype.copy=function(){return{id:this.id,layout:this.layout,isRootNode:this.isRootNode,isLeftSubtreeNode:this.isLeftSubtreeNode,borderBox:this.getBorderBox(),theme:this.theme,scale:this.scale,leftCollapsed:this.leftCollapsed,rightCollapsed:this.rightCollapsed}},t.prototype.isInDirtyTree=function(){if(this.isRootNode)return this.lockFinally||e(this.children);function e(t){for(var n=!1,i=0;i<t.length;i++){var r=t[i],o=r.lockFinally;if(o){n=o;break}n=e(r.children)}return n}return this.lockFinally||function t(n){var i;if(n.lockFinally||(null===(i=n.parent)||void 0===i?void 0:i.isRootNode))return n.lockFinally;var r=n.parent;return e(r.getSiblings())||t(r)}(this)||e(this.getSiblings())},Object.defineProperty(t.prototype,"selectSensitivation",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLeafNode",{get:function(){return 0===this.children.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLeftSubtreeNode",{get:function(){var e;return Boolean(null===(e=this.abstractTree.findTreeNode(this))||void 0===e?void 0:e.isLeft)},enumerable:!1,configurable:!0}),t.prototype.getDescendants=function(e){return this.abstractTree.getDescendants(this,e)},t.prototype.getDescendantsTreeNode=function(e){return this.abstractTree.getDescendantsTreeNode(this,e)},t.prototype.isAncestor=function(e){var t=!1,n=e;do{if(n.parent===this){t=!0;break}null!==n.parent&&(n=n.parent)}while(null!==n.parent);return t},t.prototype.getSiblings=function(){var e,t,n=this,i=[];if(this.parent){var r=this.abstractTree.findTreeNode(this);i=(null===(t=null===(e=this.abstractTree.findTreeNode(this.parent))||void 0===e?void 0:e.children)||void 0===t?void 0:t.filter((function(e){return e.isLeft===(null==r?void 0:r.isLeft)})).map((function(e){return e.node})))||[]}return i.filter((function(e){return e!==n}))},Object.defineProperty(t.prototype,"leftSubtreeNodes",{get:function(){return this.getDescendantsTreeNode((function(e){return!!e.isLeft})).map((function(e){return e.node}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeNodes",{get:function(){return this.getDescendantsTreeNode((function(e){return!e.isLeft})).map((function(e){return e.node}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftSubtreeNodesSortByX",{get:function(){return R([],this.leftSubtreeNodes,!0).sort((function(e,t){return e.getBorderBox().right-t.getBorderBox().right}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftSubtreeNodesSortByY",{get:function(){return R([],this.leftSubtreeNodes,!0).sort((function(e,t){return e.getBorderBox().bottom-t.getBorderBox().bottom}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeNodesSortByX",{get:function(){return R([],this.rightSubtreeNodes,!0).sort((function(e,t){return e.position.x-t.position.x}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeNodesSortByY",{get:function(){return R([],this.rightSubtreeNodes,!0).sort((function(e,t){return e.position.y-t.position.y}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftSubtreeMaxXNode",{get:function(){return this.leftSubtreeNodesSortByX[this.leftSubtreeNodesSortByX.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftSubtreeMaxYNode",{get:function(){return this.leftSubtreeNodesSortByY[this.leftSubtreeNodesSortByY.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeMinXNode",{get:function(){return this.rightSubtreeNodesSortByX[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeMaxXNode",{get:function(){return this.rightSubtreeNodesSortByX[this.rightSubtreeNodesSortByX.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeMinYNode",{get:function(){return this.rightSubtreeNodesSortByY[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSubtreeMaxYNode",{get:function(){return this.rightSubtreeNodesSortByY[this.rightSubtreeNodesSortByY.length-1]},enumerable:!1,configurable:!0}),t.prototype.attachPrecursor=function(e,t){this.precursorLine=e,this.parent=t,this.precursorLine.isShow=!this.isWillBeRecived,this.checkIsHideByPosition()},t.prototype.isReversed=function(e){var t,n,i,r;return e.start.x!==(null===(t=this.precursorLine)||void 0===t?void 0:t.startPosition.x)||e.start.y!==(null===(n=this.precursorLine)||void 0===n?void 0:n.startPosition.y)||e.end.x!==(null===(i=this.precursorLine)||void 0===i?void 0:i.endPosition.x)||e.end.y!==(null===(r=this.precursorLine)||void 0===r?void 0:r.endPosition.y)},t.prototype.getPrecursorLinePosition=function(e,t){var n={start:this.precursorLine.startPosition,end:this.precursorLine.endPosition},i=t?{left:t.x,top:t.y,right:t.x,bottom:t.y}:this.getBorderBox();if(this.layout===Xa.VERTICAL)if(e.isRootNode){var r=Lt(e.borderBox);(o=this.isLeftSubtreeNode)&&i.top>r.y?n={start:sp,end:op}:!o&&i.bottom<r.y&&(n={start:op,end:sp})}else n=e.isLeftSubtreeNode?{start:op,end:sp}:{start:sp,end:op};else if(e.isRootNode)if(e.layout===Xa.NONE)r=Lt(e.borderBox),n=Lt(i).x>r.x?{start:ap,end:rp}:{start:rp,end:ap};else{var o;r=Lt(e.borderBox),(o=this.isLeftSubtreeNode)&&i.left>r.x?n={start:ap,end:rp}:!o&&i.right<r.x&&(n={start:rp,end:ap})}else n=e.isLeftSubtreeNode?{start:rp,end:ap}:{start:ap,end:rp};return n},t.prototype.toOpposite=function(e){return{start:e.end,end:e.start}},t.prototype.reassignParent=function(e,n,i){var r,o,a,s=void 0===i?{}:i,l=s.needCheckReverse,c=void 0!==l&&l,u=s.basePosition;if(e.layout===Xa.NONE){var d=this.layout===Xa.NONE?Xa.HORIZONTAL:this.layout,p=this.upime.elementManager.getElementById(e.id);p&&n.update(p,{layout:d})}if(this.isRootNode){!this.leftCollapsed!=!this.rightCollapsed&&(this.leftCollapsed&&this.toggleLeftCollapsed(n),this.rightCollapsed&&this.toggleRightCollapsed(n));var h={isRootNode:!1};this.layout!==e.layout&&(h.layout=e.layout),n.update(this,h),this.theme!==e.theme&&this.changeTheme(e.theme,n,!0);var f=u||Lt(this.getGlobalBox()),m=t.getPointLocationToNode(f,e),v={};switch(m){case"t":v.startPosition=op,v.endPosition=sp;break;case"b":v.startPosition=sp,v.endPosition=op;break;case"l":v.startPosition=rp,v.endPosition=ap;break;case"r":v.startPosition=ap,v.endPosition=rp}this.children.forEach((function(e){var t=e.precursorLine;t&&n.update(t,v)}));var g={startElementId:e.id,startArrow:0,startType:2,endElementId:this.id,endArrow:0,endType:2,lineWidth:2,lineType:this.theme===Qa.COLORBRANCH?3:2,lineStyle:1,lineColor:this.nodeColor,zIndex:this.upime.newMaxZindex(),startPosition:v.startPosition,endPosition:v.endPosition};return this.preparePrecursorLine?(this.precursorLine=this.preparePrecursorLine,this.preparePrecursorLine=null,n.update(this.precursorLine,exports.E(exports.E({},g),{deleted:!1}))):n.create(Za.MINDMAP_LINE,g),void this.alignChildNodes(n,{isFitLayout:!1})}if((null===(r=this.parent)||void 0===r?void 0:r.id)!==e.id){h={startElementId:e.id},(e.theme===Qa.COLORBRANCH&&3!==(null===(o=this.precursorLine)||void 0===o?void 0:o.lineType)||e.theme===Qa.LITE&&2!==(null===(a=this.precursorLine)||void 0===a?void 0:a.lineType))&&(this.changeTheme(e.theme,n,!0),h.lineType=e.theme===Qa.COLORBRANCH?3:2);var y=this.getPrecursorLinePosition(e);e.layout===this.layout&&y&&this.isReversed(y)?this.turnRound(y,n,h):n.update(this.precursorLine,h),this.alignChildNodes(n,{isFitLayout:!1})}else c&&((y=this.getPrecursorLinePosition(e,u))&&this.isReversed(y)&&this.turnRound(y,n,{}),this.abstractTree.fixAll());var b=this.parent;if(b){if(this.isLeftSubtreeNode&&b.leftCollapsed&&!b.rightCollapsed||!this.isLeftSubtreeNode&&b.rightCollapsed&&!b.leftCollapsed){var E=this.toOpposite(this.getPrecursorLinePosition(b.copy()));this.turnRound(E,n,{})}var x=this.isLeftSubtreeNode,w=x?Boolean(b.leftCollapsed):Boolean(b.rightCollapsed);w!==this.isMindmapNodeHideByCollapsed&&(this.isMindmapNodeHideByCollapsed=w,this.childrenIncludeDeleted.forEach((function(e){x?e.syncLeftTreeCollapsedState(w,!1):e.syncRightTreeCollapsedState(w,!1)})))}},t.prototype.turnRound=function(e,t,n){var i=[this];n.startPosition=e.start,n.endPosition=e.end,t.update(this.precursorLine,n);var r=Lt(this.getBorderBox());return this.getDescendants().forEach((function(n){var o=n.getBorderBox(),a=Rt(o),s=Lt(o),l={x:r.x,y:s.y};n.layout===Xa.VERTICAL&&(l={x:s.x,y:r.y});var c=an(s,180,l),u={position:{x:c.x-a.width/2,y:c.y-a.height/2}};t.update(n,u),t.update(n.precursorLine,{startPosition:e.start,endPosition:e.end}),i.push(n)})),i},t.prototype.translate=function(e,t){var n=[];return this.unavailable||this.isOutofLayout?[]:(function i(r){n.push(r),t.update(r,{position:{x:r.position.x+e.x,y:r.position.y+e.y}}),r.children.filter((function(e){return!e.isMindmapNodeHideByCollapsed})).filter((function(e){return!e.lockFinally})).filter((function(e){return!e.isOutofLayout})).forEach((function(e){i(e)}))}(this),n)},t.prototype.fitLayout=function(e){if(this.isRootNode)return[];var t=this.scale,n=[];function i(t,i,r){for(var o=0;o<t.length-1;o++){var a=t[o],s=t[o+1],l=a.getBarrier(),c=s.getBarrier();if(i(l,c))break;var u=s.translate(r(l,c),e);n.push.apply(n,u)}}return function e(n){if(!n.isInDirtyTree()){var r=n.getSiblings();if(r.length>0){var o=R([n],r,!0),a=function(e,n){return e.top-n.bottom>=15*t},s=function(e,n){return{x:0,y:-(15*t-(e.top-n.bottom))}},l=function(e,n){return n.top-e.bottom>=15*t},c=function(e,n){return{x:0,y:15*t-(n.top-e.bottom)}};n.layout===Xa.HORIZONTAL?o.sort((function(e,t){return Lt(e.getBorderBox()).y-Lt(t.getBorderBox()).y})):n.layout===Xa.VERTICAL&&(o.sort((function(e,t){return Lt(e.getBorderBox()).x-Lt(t.getBorderBox()).x})),a=function(e,n){return e.left-n.right>=15*t},s=function(e,n){return{x:-(15*t-(e.left-n.right)),y:0}},l=function(e,n){return n.left-e.right>=15*t},c=function(e,n){return{x:15*t-(n.left-e.right),y:0}});var u=o.findIndex((function(e){return e===n})),d=o.slice(0,u+1).reverse(),p=o.slice(u,o.length);i(d,a,s),i(p,l,c)}null===n.parent||n.parent.isRootNode||e(n.parent)}}(this),n},t.prototype.alignChildNodes=function(e,t){var n=this,i=void 0===t?{}:t,r=i.isFitLayout,o=void 0===r||r,a=i.defaultLayout;if(this.isLeafNode)return[];this.getDescendants((function(e){return!e.lockFinally&&!e.isMindmapNodeHideByCollapsed})).forEach((function(t){t.scale!==n.scale&&e.update(t,{scale:n.scale})}));var s=this.scale,l=[];if(this.isRootNode){var c=[],u=[];this.children.forEach((function(e){e.isLeftSubtreeNode?c.push(e):u.push(e)})),d(this,c,!0),d(this,u,!1)}else d(this,this.children,this.isLeftSubtreeNode);function d(t,n,i){if(n.forEach((function(e){e.isMindmapNodeHideByCollapsed||e.lockFinally||d(e,e.children,i)})),!t.isMindmapNodeHideByCollapsed&&!t.lockFinally&&n.length>0){var r=R([],n,!0),o=function(e,t){return{x:i?m.left-100*s:m.right+100*s,y:e.bottom+t.y}},c=function(e,t){return{x:e.x,y:e.y+t}},u=function(e,t){return yn(i?e.right:e.left,t.x)&&yn(e.top,t.y)},p=function(e,t){return{x:t.x-(i?e.right:e.left),y:t.y-e.top}},h=0,f=0;n.forEach((function(e){var t=Rt(e.getBarrier());h+=t.width,f+=t.height})),h+=15*(n.length-1)*s,f+=15*(n.length-1)*s;var m=t.getBorderBox(),v={x:i?m.left-100*s:m.right+100*s,y:Lt(m).y-f/2},g=t.layout===Xa.NONE&&a?a:t.layout;g===Xa.HORIZONTAL?r.sort((function(e,t){return Lt(e.getBorderBox()).y-Lt(t.getBorderBox()).y})):g===Xa.VERTICAL&&(r.sort((function(e,t){return Lt(e.getBorderBox()).x-Lt(t.getBorderBox()).x})),v={x:Lt(m).x-h/2,y:i?m.top-100*s:m.bottom+100*s},o=function(e,t){return{x:e.right+t.x,y:i?m.top-100*s:m.bottom+100*s}},c=function(e,t){return{x:e.x+t,y:e.y}},u=function(e,t){return yn(e.left,t.x)&&yn(i?e.bottom:e.top,t.y)},p=function(e,t){return{x:t.x-e.left,y:t.y-(i?e.bottom:e.top)}}),r.forEach((function(t,n){var i=t.getBarrier(),r=c(v,n>0?15*s:0),a={x:0,y:0};u(i,r)||(a=p(i,r),t.translate(a,e).forEach((function(e){l.includes(e)||l.push(e)}))),v=o(i,a)}))}}return o&&l.push.apply(l,this.fitLayout(e)),l},t.prototype.changeLayout=function(e,t){var n=[this];return t.update(this,{layout:e}),this.abstractTree.fixAll(),this.alignChildNodes(t),n},t.prototype.overturnChildren=function(e){var t=this.children.filter((function(e){return e.isLeftSubtreeNode})),n=this.children.filter((function(e){return!e.isLeftSubtreeNode}));function i(t){for(var n=R([],t,!0).sort((function(e,t){return e.layout===Xa.VERTICAL?e.position.x-t.position.x:e.position.y-t.position.y})),i=Math.floor(n.length/2),r=0;r<i;r++){var o=n[r],a=n[n.length-1-r],s=o.position,l=a.position;e.update(o,{position:l}),e.update(a,{position:s})}}i(t),i(n),this.children.forEach((function(t){return t.overturnChildren(e)}))},t.prototype.changeTheme=function(e,t,n){if(void 0===n&&(n=!1),!this.isRootNode&&!n)return[];var i=[this];return this.getDescendants().forEach((function(n){var r={lineType:e===Qa.COLORBRANCH?3:2};t.update(n,{theme:e}),t.update(n.precursorLine,r),i.push(n)})),t.update(this,{theme:e}),this.abstractTree.fixAll(),i},t.prototype.changeColor=function(e,t){var n=[];return R([this],this.getDescendants(),!0).forEach((function(i){e!==i.nodeColor&&(t.update(i,{nodeColor:e}),i.precursorLine&&t.update(i.precursorLine,{lineColor:e}),n.push(i))})),n},t.prototype.randomizeColor=function(e){if(!this.isRootNode)return[];var t=[this],n=R([],eD,!0);return this.children.forEach((function(i){var r=Math.floor(Math.random()*n.length),o=n[r];t.push.apply(t,i.changeColor(o,e)),1===n.length?n=R([],eD,!0):n.splice(r,1)})),t},t.prototype.changeFontSize=function(e,t){var n=this;if(!this.isRootNode)return[];var i=e/(this.scale*this.fontSize),r=e/this.fontSize,o=this.getDescendants();return o.forEach((function(e){t.update(e,{scale:r,position:{x:n.position.x+(e.position.x-n.position.x)*i,y:n.position.y+(e.position.y-n.position.y)*i}})})),t.update(this,{scale:r}),R([this],o,!0)},t.prototype.changeScale=function(e,t){var n=this,i=e/this.scale,r=[this];return this.getDescendants().forEach((function(r){t.update(r,{scale:e,position:{x:n.position.x+(r.position.x-n.position.x)*i,y:n.position.y+(r.position.y-n.position.y)*i}})})),t.update(this,{scale:e}),r},t.prototype.dealResized=function(e,t){var n,i,r,o=[this],a=this,s=a.isRootNode,l=a.layout,c=a.scale,u=this.children.filter((function(e){return e.isLeftSubtreeNode})),d=this.children.filter((function(e){return!e.isLeftSubtreeNode}));function p(e){e.forEach((function(e){o.includes(e)||o.push(e)}))}return l===Xa.VERTICAL?(n={x:0,y:-e.height*c},i={x:0,y:e.height*c},r=0!==e.height,s&&(n.y/=2,i.y/=2),(this.isLeftSubtreeNode||s)&&(t.update(this,{position:{x:this.position.x+n.x,y:this.position.y+n.y}}),p([this]))):(void 0!==e.deltaX?(n={x:e.deltaX,y:0},i={x:e.deltaX+e.width*c,y:0}):(n={x:-e.width*c,y:0},i={x:e.width*c,y:0},s&&(n.x/=2,i.x/=2)),r=0!==e.width),r&&(u.forEach((function(e){p(e.translate(n,t))})),d.forEach((function(e){p(e.translate(i,t))}))),(!s&&l===Xa.HORIZONTAL&&e.height>0||l===Xa.VERTICAL&&e.width>0)&&p(this.fitLayout(t)),p(this.onAlignTheTree(t)),o},t.prototype.insertNodes=function(e,n){var i=this;!this.isRootNode&&this.isLeftSubtreeNode||!this.rightCollapsed||this.toggleRightCollapsed(),this.isLeftSubtreeNode&&this.leftCollapsed&&this.toggleLeftCollapsed();var r=[];if(0===e.length)return[];var o=[],a=[];function s(e){e.forEach((function(e){r.includes(e)||r.push(e)}))}return e.forEach((function(e){e.layout===Xa.HORIZONTAL?o.push(e):a.push(e)})),o.sort((function(e,t){return Lt(e.getBorderBox()).y-Lt(t.getBorderBox()).y})),a.sort((function(e,t){return Lt(e.getBorderBox()).x-Lt(t.getBorderBox()).x})),R(R([],o,!0),a,!0).forEach((function(e){var r="";if(e.isRootNode){var o=e.children.filter((function(e){return e.isLeftSubtreeNode})),a=e.children.filter((function(e){return!e.isLeftSubtreeNode})),l=o,c=e.layout===Xa.VERTICAL?"b":"r";!i.isRootNode&&i.isLeftSubtreeNode&&(l=a,c=e.layout===Xa.VERTICAL?"t":"l"),r=c;var u=cp(c);e.layout===Xa.HORIZONTAL?l.sort((function(e,t){return Lt(e.getBorderBox()).y-Lt(t.getBorderBox()).y})):e.layout===Xa.VERTICAL&&l.sort((function(e,t){return Lt(e.getBorderBox()).x-Lt(t.getBorderBox()).x})),l.forEach((function(t){var i=e.getNewChildPosition(c,t.size),r={x:i.x-t.position.x,y:i.y-t.position.y};s(t.translate(r,n)),s(t.turnRound(u,n,{}))})),l.length>0&&s(l[l.length-1].fitLayout(n));var d={isRootNode:!1},p=t.getPadding(e.lineHeight,!0),h=t.getPadding(e.lineHeight);d.size={width:e.size.width+(h.left+h.right-p.left-p.right)-4-64,height:e.size.height+(h.top+h.bottom-p.top-p.bottom)-4},n.update(e,d)}else e.children.length&&(r=e.children[0].mindMapConnectableLocations[0]);var f=i.mindMapConnectableLocations[0];i.isRootNode&&(i.layout===Xa.NONE&&n.update(i,{layout:Xa.HORIZONTAL}),f=i.layout===Xa.VERTICAL?"b":"r");var m=i.getNewChildPosition(f,e.size),v={x:m.x-e.position.x,y:m.y-e.position.y};s(e.translate(v,n));var g=cp(f),y={startElementId:i.id,startPosition:g.start,startArrow:0,startType:2,endElementId:e.id,endPosition:g.end,endArrow:0,endType:2,lineWidth:2,lineType:i.theme===Qa.COLORBRANCH?3:2,lineStyle:1,lineColor:i.nodeColor,zIndex:i.upime.newMaxZindex()};s([n.create(Za.MINDMAP_LINE,y)]),s(e.changeColor(i.nodeColor,n)),e.layout!==i.layout?s(e.changeLayout(i.layout,n)):r!==f&&s(e.turnRound(g,n,{})),n.update(e,{ha:i.layout===Xa.HORIZONTAL?i.isRootNode?"left":i.isLeftSubtreeNode?"right":"left":"center"})})),s(e[e.length-1].fitLayout(n)),r},t.prototype.getNewSiblingPosition=function(e){var t=this.scale,n=82*t,i=40*t,r=0,o=0,a=this.getBorderBox(),s=a.left,l=a.top,c=a.right,u=a.bottom;return this.layout===Xa.VERTICAL?(r=c+(15*t-n)/2,o=l,"t"===e&&(o=u-i)):(r=s,"l"===e&&(r=c-n),o=u+(15*t-i)/2),{x:r,y:o}},t.prototype.getNewChildPosition=function(e,t){var n=this.scale,i=t||{width:82*n,height:40*n},r=0,o=0,a=this.getBorderBox(),s=a.left,l=a.top,c=a.right,u=a.bottom,d=(s+c)/2,p=(l+u)/2;switch(e){case"l":(h=this.leftSubtreeMaxXNode)&&this.leftSubtreeMaxYNode?(r=h.getBorderBox().right-i.width,o=this.leftSubtreeMaxYNode.getBorderBox().bottom+(15*n-i.height)/2):(r=s-100-i.width,o=p-i.height/2);break;case"t":var h;(h=this.leftSubtreeMaxXNode)&&this.leftSubtreeMaxYNode?(r=h.getBorderBox().right+(15*n-i.width)/2,o=this.leftSubtreeMaxYNode.getBorderBox().bottom-i.height):(r=d-i.width/2,o=l-100-i.height);break;case"r":var f=this.rightSubtreeMinXNode;f&&this.rightSubtreeMaxYNode?(r=f.position.x,o=this.rightSubtreeMaxYNode.getBorderBox().bottom+(15*n-i.height)/2):(r=c+100,o=p-i.height/2);break;case"b":var m=this.rightSubtreeMaxXNode;m&&this.rightSubtreeMinYNode?(r=m.getBorderBox().right+(15*n-i.width)/2,o=this.rightSubtreeMinYNode.position.y):(r=d-i.width/2,o=u+100)}return{x:r,y:o}},t.prototype.getBarrier=function(){return Yt(R([this.getBorderBox()],this.getDescendants().filter((function(e){return!e.isMindmapNodeHideByCollapsed})).map((function(e){return e.getBorderBox()})),!0))},Object.defineProperty(t.prototype,"boxBorder",{get:function(){return this.isRootNode?{borderStyle:1,borderColor:this.nodeColor,borderWidth:2,borderRadius:this.size.width-2<68?(this.size.width-2-4)/2:32}:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return t.getPadding(this.lineHeight,this.isRootNode)},enumerable:!1,configurable:!0}),t.getPadding=function(e,t){if(void 0===t&&(t=!1),t){var n=(64-e-4)/2;return{left:0,top:n,right:0,bottom:n}}var i=(40-e)/2;return{left:8,top:i,right:8,bottom:i}},Object.defineProperty(t.prototype,"mindMapConnectableLocations",{get:function(){return this.layout===Xa.HORIZONTAL?this.isRootNode?["r","l"]:this.isLeftSubtreeNode?["l"]:["r"]:this.layout===Xa.VERTICAL?this.isRootNode?["b","t"]:this.isLeftSubtreeNode?["t"]:["b"]:["r","l","t","b"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return this.layout===Xa.HORIZONTAL?["t","b"]:this.layout===Xa.VERTICAL?["l","r"]:[]},enumerable:!1,configurable:!0}),t.prototype.checkMindMapConnectionRelation=function(e,t){var n,i,r,o;void 0===t&&(t=!1);var a=0;if(!this.isLeafNode){var s=(null===(n=this.parentRefSystem)||void 0===n?void 0:n.globalTransform)||sr,l=this.upime.view.scale*s.currentScale;a=(this.nodeCollapsedCtrl.gap+this.nodeCollapsedCtrl.r)*l}var c=this.checkConnectionRelation(e,20+a,12,this.mindMapConnectableLocations,t);(null===(i=null==c?void 0:c.metaData)||void 0===i?void 0:i.connectionData)&&(c.metaData.connectionData.isMindMapLocation=!0,c.metaData.notAllowed="single"===this.selectStatus);var u=[];this.leftCollapsed&&u.push(this.layout===Xa.VERTICAL?"t":"l"),this.rightCollapsed&&u.push(this.layout===Xa.VERTICAL?"b":"r");var d=null===(o=null===(r=null==c?void 0:c.metaData)||void 0===r?void 0:r.connectionData)||void 0===o?void 0:o.location;return d&&u.includes(d)?null:c},Object.defineProperty(t.prototype,"root",{get:function(){var e;return this.isRootNode?this:null===(e=this.parent)||void 0===e?void 0:e.root},enumerable:!1,configurable:!0}),t.prototype.onAlignTheTree=function(e,t){var n,i,r=null===(n=this.root)||void 0===n?void 0:n.getDescendants().filter((function(e){return!e.isRootNode&&e.isOutofLayout}));if(r.length){var o=r.reduce((function(t,n){var i=n.alignChildNodes(e,{isFitLayout:!1});return R(R([],t,!0),i,!0)}),[]);return this.upime.updateBorderBox(),o}var a=null===(i=this.root)||void 0===i?void 0:i.alignChildNodes(e,{defaultLayout:t});return this.upime.updateBorderBox(),a},t.prototype.toRoot=function(e,t){var n=this,i=void 0===t?{}:t,r=i.rootProp,o=i.left,a=void 0===o?[]:o,s=i.right,l=void 0===s?[]:s;this.precursorLine&&(e.update(this.precursorLine,{deleted:!0,startElementId:null}),this.preparePrecursorLine=this.precursorLine,this.precursorLine=null),this.parent&&(this.parent=null,this.isMindmapNodeHideByCollapsed=!1,this.abstractTree.toRoot(this,a.map((function(e){return e.id})))),e.update(this,{isRootNode:!0,ha:"center"}),a.forEach((function(t){var i=n.children.find((function(e){return e.id===t.id}));if(i){var r={};n.layout===Xa.VERTICAL?(r.startPosition=op,r.endPosition=sp):(r.startPosition=rp,r.endPosition=ap),R([i],i.getDescendants(),!0).forEach((function(t){t.precursorLine&&e.update(t.precursorLine,r)}))}})),l.forEach((function(t){var i=n.children.find((function(e){return e.id===t.id}));if(i){var r={};n.layout===Xa.VERTICAL?(r.startPosition=sp,r.endPosition=op):(r.startPosition=ap,r.endPosition=rp),R([i],i.getDescendants(),!0).forEach((function(t){t.precursorLine&&e.update(t.precursorLine,r)}))}})),this.onAlignTheTree(e);var c=this.children.filter((function(e){return e.isLeftSubtreeNode})),u=this.children.filter((function(e){return!e.isLeftSubtreeNode}));this.leftCollapsed&&0===c.length&&this.toggleLeftCollapsed(e),this.rightCollapsed&&0===u.length&&this.toggleRightCollapsed(e),r&&(this.theme!==r.theme&&this.changeTheme(r.theme,e),this.layout!==r.layout&&this.changeLayout(r.layout,e))},t.getPointLocationToNode=function(e,t){var n="",i=Lt(t.borderBox);switch(t.layout){case Xa.VERTICAL:n=t.isRootNode?t.leftCollapsed&&!t.rightCollapsed?"b":!t.leftCollapsed&&t.rightCollapsed||e.y<i.y?"t":"b":t.isLeftSubtreeNode?"t":"b";break;case Xa.NONE:case Xa.HORIZONTAL:n=t.isRootNode?t.leftCollapsed&&!t.rightCollapsed?"r":!t.leftCollapsed&&t.rightCollapsed||e.x<i.x?"l":"r":t.isLeftSubtreeNode?"l":"r";case Xa.NONE:}return n},t.prototype.updateRootStyle=function(e,n){var i=Lt(this.borderBox),r=t.getPadding(this.lineHeight,!0),o=t.getPadding(this.lineHeight),a=0,s=0,l={};e?(a=this.size.width+(r.left+r.right-o.left-o.right)+4+64,s=this.size.height+(r.top+r.bottom-o.top-o.bottom)+4):(a=this.size.width+(o.left+o.right-r.left-r.right)-4-64,s=this.size.height+(o.top+o.bottom-r.top-r.bottom)-4),l.size={width:a,height:s},l.position={x:i.x-a/2,y:i.y-s/2},n.update(this,l)},t.prototype.dealUpdate=function(t){t.isRootNode&&this.parent&&(this.parent=null,this.isMindmapNodeHideByCollapsed=!1);var n=t.rightCollapsed,i=t.leftCollapsed,r=t.rightCollapsedLocal,o=t.leftCollapsedLocal,a=N(t,["rightCollapsed","leftCollapsed","rightCollapsedLocal","leftCollapsedLocal"]);if("left"===a.ha&&"2"===KA(this).content&&window._bug)throw new Error("sad");this.updateRightCollapsed(n),this.updateLeftCollapsed(i),this.updateRightCollapsedLocal(r),this.updateLeftCollapsedLocal(o);var s=t.updateOptions||{},l=s.isServerUpdate,c=s.isServerCreate;if(l&&this.isInLocalModeTree&&a.position)if(this.isRootNode&&!1!==t.isRootNode){this.positionServer=exports.E({},a.position);var u=a.position.x-this.position.x,d=a.position.y-this.position.y;this.getDescendants().forEach((function(e){var t=e.position.x+u,n=e.position.y+d;e.dealUpdate({position:{x:t,y:n}})}))}else this.positionServer=a.position,this.abstractTree.sort(this)&&this.abstractTree.fixPositionBySort(this),a.position=void 0;e.prototype.dealUpdate.call(this,a),t.isRootNode&&this.abstractTree.toRoot(this,[]),t.position&&this.abstractTree.sort(this),t.layout&&this.isRootNode&&this.abstractTree.fixAll(),this.checkLocalCollapsed(),c&&!this.isRootNode&&this.leftCollapsed!==this.rightCollapsed&&(this.isLeftSubtreeNode?this.rightCollapsed=this.leftCollapsed:this.leftCollapsed=this.rightCollapsed),l&&this.isInLocalModeTree&&t.size&&this.abstractTree.alignTreeLocal()},t.prototype.updateRightCollapsed=function(e){void 0!==e&&e!==this.rightCollapsed&&(this.rightCollapsed=e,this.syncRightTreeCollapsedState(Boolean(e),!0))},t.prototype.updateRightCollapsedLocal=function(e){void 0!==e&&e!==this.rightCollapsedLocal&&(this.setRightCollapsedLocal(e),this.syncRightTreeCollapsedState(Boolean(e),!0))},t.prototype.syncRightTreeCollapsedState=function(e,t){t||(this.isMindmapNodeHideByCollapsed=e),!e&&this.rightCollapsedFinally||this.nodeCollapsedCtrl.rightSubtreeNodes.forEach((function(t){t.syncRightTreeCollapsedState(e,!1)}))},t.prototype.updateLeftCollapsed=function(e){void 0!==e&&e!==this.leftCollapsed&&(this.leftCollapsed=e,this.syncLeftTreeCollapsedState(Boolean(e),!0))},t.prototype.updateLeftCollapsedLocal=function(e){void 0!==e&&e!==this.leftCollapsedLocal&&(this.setLeftCollapsedLocal(e),this.syncLeftTreeCollapsedState(Boolean(e),!0))},t.prototype.syncLeftTreeCollapsedState=function(e,t){t||(this.isMindmapNodeHideByCollapsed=e),!e&&this.leftCollapsedFinally||this.nodeCollapsedCtrl.leftSubtreeNodes.forEach((function(t){t.syncLeftTreeCollapsedState(e,!1)}))},t.prototype.checkVisible=function(t){if(this.isMindmapNodeHideByCollapsed){var n=this.seekUnHideParent();return Boolean(null==n?void 0:n.checkVisible(t))}if(!this.isRootNode)return e.prototype.checkVisible.call(this,t);if(this.eleHided)return!1;var i=Yt(R([this],this.getDescendants(),!0).map((function(e){return e.getGlobalBox()}))),r=this.minVisibleSize;return!((i.right-i.left)*t.scale<r||(i.bottom-i.top)*t.scale<r)&&Kt(i,t)},t.prototype.checkInteractRelation=function(t,n){return"view"===this.upime.xmode?this.nodeCollapsedCtrl.checkInteractRelation(t,n):e.prototype.checkInteractRelation.call(this,t,n)||this.nodeCollapsedCtrl.checkInteractRelation(t,n)},t.prototype.toggleLeftCollapsed=function(e){var t;this.upime.followManager.stopFollowCurrent();var n=this.getDescendants().map((function(e){return e.id})),i=this.upime.editable?this.upime.createLock(n):void 0,r=e;r||(r=this.upime.createOperation(),this.upime.editable||(r.localOnly=!0));var o=!this.leftCollapsedFinally,a=((t={})[this.upime.editable?"leftCollapsed":"leftCollapsedLocal"]=o,t);this.isRootNode||(a[this.upime.editable?"rightCollapsed":"rightCollapsedLocal"]=o,a.rightCollapsed=o),r.update(this,a),this.onAlignTheTree(r),e||r.sync(),this.upime.updateMapPicture(),i&&this.upime.clearLock(i),this.upime.view.setCursor("pointer",this),_e.desktop&&(this.nodeCollapsedCtrl.isHoverd=!0,this.nodeCollapsedCtrl.isLeftHoverd=!0,this.nodeCollapsedCtrl.isRightHoverd=!1)},t.prototype.toggleRightCollapsed=function(e){var t;this.upime.followManager.stopFollowCurrent();var n=this.getDescendants().map((function(e){return e.id})),i=this.upime.editable?this.upime.createLock(n):void 0,r=e;r||(r=this.upime.createOperation(),this.upime.editable||(r.localOnly=!0));var o=!this.rightCollapsedFinally,a=((t={})[this.upime.editable?"rightCollapsed":"rightCollapsedLocal"]=o,t);this.isRootNode||(a[this.upime.editable?"leftCollapsed":"leftCollapsedLocal"]=o),r.update(this,a),this.onAlignTheTree(r),e||r.sync(),this.upime.updateMapPicture(),i&&this.upime.clearLock(i),this.upime.view.setCursor("pointer",this),_e.desktop&&(this.nodeCollapsedCtrl.isHoverd=!0,this.nodeCollapsedCtrl.isLeftHoverd=!1,this.nodeCollapsedCtrl.isRightHoverd=!0)},t.prototype.getBorderBoxWithCollapse=function(){var e=exports.E({},this.getBorderBox());if(this.isLeafNode)return e;var t=this.nodeCollapsedCtrl.r,n=this.nodeCollapsedCtrl.gap;return this.layout===Xa.VERTICAL?(e.top-=n+t,e.bottom+=n+t):(e.left-=n+t,e.right+=n+t),e},t.prototype.checkIsHideByPosition=function(){var e=this;if(!this.isMindmapNodeHideByCollapsed){var t=this.parent;if(t){var n=Lt(t.getGlobalBox()),i=Lt(this.getGlobalBox()),r=t.isLeftSubtreeNode;t.isRootNode&&(r=this.layout===Xa.VERTICAL?i.y<=n.y:i.x<=n.x);var o=function(t){if(r?Boolean(t.leftCollapsed):Boolean(t.rightCollapsed))return e.isMindmapNodeHideByCollapsed=!0,void e.upime.updateMapPicture();t.parent&&o(t.parent)};o(t)}}},t.prototype.checkIsHideByPreLine=function(){var e=this;if(!this.isMindmapNodeHideByCollapsed){var t=this.parent,n=this.precursorLine;if(t&&n){var i=t.isLeftSubtreeNode;t.isRootNode&&(i=this.layout===Xa.VERTICAL?_t.isEqual(n.startPosition,op):_t.isEqual(n.startPosition,rp));var r=function(t){if(i?Boolean(t.leftCollapsed):Boolean(t.rightCollapsed))return e.isMindmapNodeHideByCollapsed=!0,void e.upime.updateMapPicture();t.parent&&r(t.parent)};r(t)}}},t.prototype.seekUnHideParent=function(){if(!this.isMindmapNodeHideByCollapsed)return this;var e=this.parent;return e?e.seekUnHideParent():void 0},t.prototype.checkSelectRelation=function(t,n){return this.isMindmapNodeHideByCollapsed||this.hideByFrame?null:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.dealClickStart=function(t){var n;if(null===(n=t.metaData)||void 0===n?void 0:n.clickData){var i=t.metaData.clickData,r=i.mindmapNodeleftCollapsed,o=i.mindmapNodeRightCollapsed;if(r&&this.toggleLeftCollapsed(),o&&this.toggleRightCollapsed(),r||o)return void this.upime.clearSelect()}return e.prototype.dealClickStart.call(this,t)},t.prototype.dealHoverStart=function(t){var n,i=null===(n=t.metaData)||void 0===n?void 0:n.clickData;if(i){var r=i.mindmapNodeLeftCollapseActive,o=i.mindmapNodeRightCollapseActive,a=i.mindmapNodeCollapseBtn;if(r&&(this.nodeCollapsedCtrl.isLeftHoverd=!0),o&&(this.nodeCollapsedCtrl.isRightHoverd=!0),a&&(this.nodeCollapsedCtrl.isHoverd=!0),r||o?this.upime.view.setCursor("pointer",this):this.upime.view.setCursor("",this),r||o||a)return void this.upime.updateView()}return e.prototype.dealHoverStart.call(this,t)},t.prototype.dealHoverEnd=function(){return this.nodeCollapsedCtrl.isLeftHoverd=!1,this.nodeCollapsedCtrl.isRightHoverd=!1,this.nodeCollapsedCtrl.isHoverd=!1,this.upime.view.setCursor("",this),this.upime.updateView(),e.prototype.dealHoverEnd.call(this)},t.prototype.onRemove=function(){this.hasLocalState&&this.abstractTree.removeLocalModeNode(this),this.isInLocalModeTree&&this.abstractTree.alignTreeLocal()},t.prototype.onRestore=function(){var e=this.abstractTree.findTreeNode(this);e&&this.abstractTree.onEnter(e),this.hasLocalState&&this.abstractTree.addLocalModeNode(this)},t.prototype.checkLocalCollapsed=function(){var e=Boolean(this.leftCollapsed)===Boolean(this.leftCollapsedLocal),t=Boolean(this.rightCollapsed)===Boolean(this.rightCollapsedLocal);this.isRootNode?(e&&this.setLeftCollapsedLocal(null),t&&this.setRightCollapsedLocal(null)):(this.isLeftSubtreeNode&&e||!this.isLeftSubtreeNode&&t)&&(this.setLeftCollapsedLocal(null),this.setRightCollapsedLocal(null))},t.prototype.syncServerPositon=function(){this.positionServer=exports.E({},this.position)},t.prototype.clearServerPosition=function(){this.useServerPosition(),this.positionServer=void 0},t.prototype.useServerPosition=function(){this.positionServer&&this.dealUpdate({position:exports.E({},this.positionServer)})},t}(EA),CD=function(){function e(e){var t=this;this.editor=e,this.propertyName="shapeTextFontSize",this.renderer=sN,this.couldAffectGroup=!0,this.sizeList=Ve,this.maxSize=999,this.minSize=10,this.changeValue=function(e){var n="single"===t.editor.element.selectStatus?void 0:t.editor.upime.createOperation(),i=t.editor.getElements(),r=t.editor.upime.createLock(i.map((function(e){return e.id})));i.forEach((function(i){var r,o=i.currentEditor,a=null==o?void 0:o.propertyEditors.find((function(e){return e.propertyName===t.propertyName}));null===(r=a)||void 0===r||r.changeSelfValue(e,n)})),n&&n.sync(),t.editor.upime.clearLock(r),t.editor.updateBorderBox()},this.renderKey=this.propertyName}return e.prototype.getValue=function(){return Math.max(1,Math.round((this.editor.element.fontSize||14)*this.editor.element.scale))},e.prototype.changeSelfValue=function(e,t){var n=Math.max(1,e/this.editor.element.scale),i=ib(n,this.editor.element.lineHeightRate||1.36),r=t||this.editor.getOp();r.update(this.editor.element,{fontSize:n,lineHeight:i}),t||r.sync()},e}(),SD=4/3,kD=new Map;function _D(e,t){var n=e+(t||""),i=kD.get(n);if(i)return i;var r=tr("");return kD.set(n,r),Promise.resolve().then((function(){return require("./icon_map-994586df-6147ed29.js")})).then((function(n){var i=n.icon_map[e].replace("<symbol",'<svg xmlns="http://www.w3.org/2000/svg"').replace("symbol>","svg>");t&&(i=/fill="currentColor"/g.test(i)?i.replace(/fill="currentColor"/g,'fill="'.concat(t,'"')):i.replace(/<svg/,'<svg fill="'.concat(t,'"')));var o="data:image/svg+xml,"+encodeURIComponent(i);r.imgSrc=o,er(r)})),r}var TD=_D("shuangyou","white"),ID=_D("shuangshang","white"),PD=_D("shuangzuo","white"),ND=_D("shuangxia","white"),MD=function(e){var t=e.element,n=e.viewbox;Kd({element:t,viewbox:n,upime:t.upime});var i=t.borderRect,r=t.visiable,o=t.hideSelectRect,a=t.hideConnectableEditorRect,s=t.quickAddShapeIconLocation,l=t.quickAddCircleActive,c=t.quickAddIndicateBorder,u=t.quickAddLineInfo;if(s){var d=Ga(i,n),p=function(e,t,n){var i=e.left,r=e.top,o=e.right,a=e.bottom,s=t.left,l=t.top,c=t.scale,u=((i=(i-s)*c)+(o=(o-s)*c))/2,d=((r=(r-l)*c)+(a=(a-l)*c))/2;switch(n){case"l":default:return{x:i-et,y:d};case"t":return{x:u,y:r-et};case"r":return{x:o+et,y:d};case"b":return{x:u,y:a+et}}}(i,n,s);if(!a&&!o&&r){if(c){var h=n.scale,f=Ga(c,n),m={left:(c.left-n.left)*n.scale,right:(c.right-n.left)*n.scale,top:(c.top-n.top)*n.scale,bottom:(c.bottom-n.top)*n.scale},v=Rt(i),g=Lt(m),y=Rt({left:g.x-v.width*h*.5,right:g.x+v.width*h*.5,top:g.y-v.height*h*.5,bottom:g.y+v.height*h*.5});fa({x:f.x,y:f.y,rotation:i.rotate,pivotX:f.x,pivotY:f.y}),t.drawOutline&&(fa({x:y.x,y:y.y}),t.drawOutline(y),ma()),ma()}if(u){var b=function(e){return{x:(e.x-n.left)*n.scale,y:(e.y-n.top)*n.scale}}(u.startPoint),E=b.x,x=b.y,w=function(e){return{x:e.x*n.scale,y:e.y*n.scale}},C=u.drawPath.map(w);fa({x:E,y:x}),Na((function(e){_P(exports.E(exports.E({},u),{lineType:2,lineWidth:1*n.scale,lineColor:5740786,lineStyle:3,drawPath:C}),e)})),Na((function(e){var t=u.endArrowDrawPath;if(t){var i=exports.E({},t);i.path=i.path.map((function(e){switch(e.type){case"arc":return exports.E(exports.E({},e),{p0:w(e.p0),p1:w(e.p1),p2:w(e.p2),radius:e.radius*n.scale});case"circle":return exports.E(exports.E({},e),{p0:w(e.p0),radius:e.radius*n.scale,lineWidth:e.lineWidth*n.scale});case"line":return exports.E(exports.E({},e),{p0:w(e.p0),p1:w(e.p1)});case"move":return exports.E(exports.E({},e),{p0:w(e.p0)});default:return e}})),TP(e,i,5740786)}})),ma()}fa({x:d.x,y:d.y,rotation:i.rotate,pivotX:d.x,pivotY:d.y}),Na((function(e){e.beginFill(l?3044325:790564,l?1:.16),e.drawCircle(p.x,p.y,12),e.endFill()})),Oa({src:AD(s),x:p.x-8,y:p.y-8,width:16,height:16}),ma()}}};function AD(e){switch(e){case"l":return PD;case"t":return ID;case"r":default:return TD;case"b":return ND}}var DD,RD={startArrow:0,endArrow:1,lineWidth:1,lineType:2},BD=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.renderer=MD,r.quickAddShapeIconLocation="",r.quickAddCircleActive=!1,r.subscribeQuickAddEvents(),r}return P(t,e),Object.defineProperty(t.prototype,"hideDisplayLocations",{get:function(){return this.quickAddShapeIconLocation?[this.quickAddShapeIconLocation]:[]},enumerable:!1,configurable:!0}),t.prototype.subscribeQuickAddEvents=function(){var e=this;this.manager||(this.unsubQuickAddEvents=this.upime.userEventManager.subscribe("mousemove",(function(t){var n=e.element.getGlobalBox(),i=Rt(n),r={x:t.position.x-n.left,y:t.position.y-n.top};n.rotate&&(r=an(r,-n.rotate,{x:i.width/2,y:i.height/2}));var o=e.checkIsInOutQuickAddHotArea(r)||e.checkIsInInsideQuickAddHotArea(r);o!==e.quickAddShapeIconLocation&&(e.quickAddShapeIconLocation=o,e.upime.updateView(Sn(n,n.rotate)));var a=e.currentLocation===o;a!==e.quickAddCircleActive&&(e.quickAddCircleActive=a,e.upime.updateView(Sn(n,n.rotate)))})))},t.prototype.unselect=function(){var t;null===(t=this.unsubQuickAddEvents)||void 0===t||t.call(this),window.clearTimeout(this.delayQuickStartTimer),this.quickAddIndicateBorder=void 0,this.quickAddLineInfo=void 0,e.prototype.unselect.call(this)},t.prototype.checkIsInOutQuickAddHotArea=function(e){var t=48/this.element.upime.view.scale,n=this.element.globalTransform.currentScale,i=this.element.size.height*this.element.scale*n,r=this.element.size.width*this.element.scale*n,o={left:r,top:0,bottom:i,right:r+t},a={left:0,top:-t,bottom:0,right:r},s={left:0,top:i,bottom:i+t,right:r};return Ot(e,{left:-t,top:0,bottom:i,right:0})?"l":Ot(e,o)?"r":Ot(e,a)?"t":Ot(e,s)?"b":""},t.prototype.checkIsInInsideQuickAddHotArea=function(e){var t=this.element.size,n=t.width,i=t.height,r=this.element.globalTransform.currentScale,o=(n*=r*this.element.scale)/4,a=(i*=r*this.element.scale)/4,s={left:3*o,right:n,top:a,bottom:3*a},l={left:o,right:3*o,top:0,bottom:a},c={left:o,right:3*o,top:3*a,bottom:i};if(Ot(e,{left:0,right:o,top:a,bottom:3*a}))return"l";if(Ot(e,s))return"r";if(Ot(e,l))return"t";if(Ot(e,c))return"b";var u={left:3*o,right:n,top:0,bottom:a},d={left:0,right:o,top:3*a,bottom:i},p={left:3*o,right:n,top:3*a,bottom:i};return Ot(e,{left:0,right:o,top:0,bottom:a})?"right"===zn(e,{x:0,y:0},{x:o,y:a})?"l":"t":Ot(e,u)?"right"===zn(e,{x:3*o,y:a},{x:n,y:0})?"r":"t":Ot(e,d)?"right"===zn(e,{x:0,y:i},{x:o,y:3*a})?"b":"l":Ot(e,p)?"right"===zn(e,{x:3*o,y:3*a},{x:n,y:i})?"b":"r":""},t.prototype.checkConnectionRelation=function(e){return this.element.checkConnectionRelation(e,et,12,this.connectableLocations)},t.prototype.setCurrentLocation=function(e){this.currentLocation!==e&&(this.currentLocation=e,e?this.prepareQuickAddShape():(window.clearTimeout(this.delayQuickStartTimer),this.quickAddIndicateBorder=void 0,this.quickAddLineInfo=void 0,this.upime.updateView()))},t.prototype.prepareQuickAddShape=function(){var e=this;this.delayQuickStartTimer=window.setTimeout((function(){e.delayQuickStartTimer=void 0,e.quickAddIndicateBorder=e.findQuickAddPlace(),e.quickAddLineInfo=e.getQuickAddConnectionLine(),e.upime.updateView()}),1e3)},t.prototype.getQuickAddBorder=function(){var e=this.element.getGlobalBox();return exports.E({},Sn(e,e.rotate))},t.prototype.getQuickAddLocation=function(){var e=this.element.getBorderBox().rotate||0;switch(this.currentLocation){case"l":e+=180;break;case"r":e+=0;break;case"t":e+=270;break;case"b":e+=90}return e>=360&&(e-=360),e>45&&e<=135?"b":e>135&&e<=225?"l":e>225&&e<=315?"t":"r"},t.prototype.findQuickAddPlace=function(){var e=this.getQuickAddBorder(),t=Rt(e),n=this.getQuickAddLocation();switch(n){case"l":e.left-=80+t.width,e.right-=80+t.width;break;case"r":e.left+=80+t.width,e.right+=80+t.width;break;case"t":e.top-=80+t.height,e.bottom-=80+t.height;break;case"b":e.top+=80+t.height,e.bottom+=80+t.height}for(var i="l"===n||"r"===n,r=this.upime.elementManager.getAllElements().filter((function(e){return e.elementType!==Za.FRAME&&e.elementType!==Za.TABLE})).map((function(e){return e.getGlobalBox()})).filter((function(t){return i?!(t.right<e.left||t.left>e.right):!(t.top>e.bottom||t.bottom<e.top)})),o=function(e){return r.some((function(t){return Kt(t,e)}))},a=!1,s=0,l=function(){var n=exports.E({},e);return a?i?(n.top-=s*(t.height+20),n.bottom-=s*(t.height+20)):(n.left-=s*(t.width+20),n.right-=s*(t.width+20)):i?(n.top+=s*(t.height+20),n.bottom+=s*(t.height+20)):(n.left+=s*(t.width+20),n.right+=s*(t.width+20)),n},c=function(){if(0!==s)return a?(a=!1,void s++):void(a=!0);s++},u=1,d=l();o(d)&&u<100;)c(),d=l(),u++;return d},t.prototype.getQuickAddConnectionLine=function(){var e,t=this.getStartAndEndPositionByLocation(),n=t[0],i=t[1],r="fake-".concat(this.element.id),o="fake-".concat(this.element.id,"-line"),a=this.getQuickAddClone(r);a.bindRefSystem=function(){};var s=zs(this.element,this.element.elementType);if(s.frameId=null,this.quickAddIndicateBorder){var l=this.element.getGlobalBox(),c=this.getQuickAddBorder(),u=c.left-this.quickAddIndicateBorder.left,d=c.top-this.quickAddIndicateBorder.top;s.position={x:l.left-u,y:l.top-d},s.size={width:(l.right-l.left)/this.element.scale,height:(l.bottom-l.top)/this.element.scale}}a.dealUpdate(s),a.updateBorderBox(),null===(e=a.updateGlobalBorderBox)||void 0===e||e.call(a);var p=new IN(this.upime,o);p.bindRefSystem=function(){},p.startElement=this.element,p.startElementId=this.element.id,p.endElementId=r,p.endElement=a;var h=exports.E({startPosition:n.percentOffset,endPosition:i.percentOffset,startType:n.attachedPointType,endType:i.attachedPointType},RD);p.dealUpdate(h),p.handleAttachedElementChanged();var f=p.startPoint,m=p.lineCap,v=p.lineJoin,g=p.displayLineWidth,y=p.drawPath,b=p.endArrowDrawPath;return p.endElement=void 0,p.startElement=void 0,p.deleted=!0,a.deleted=!0,a.destroy(),p.destroy(),{startPoint:f,lineCap:m,lineJoin:v,displayLineWidth:g,drawPath:y,endArrowDrawPath:b}},t.prototype.getStartAndEndPositionByLocation=function(){var e=this.getLocationPosition(this.currentLocation),t=this.getLocationPosition(this.getOppositeLocation(this.currentLocation));return[this.element.getAttachedProps(e,this.currentLocation),this.element.getAttachedProps(t,this.getOppositeLocation(this.currentLocation))]},t.prototype.getLocationPosition=function(e){var t=this.element.getBorderBox(),n=t.left,i=t.top,r=t.right,o=t.bottom,a=(n+r)/2,s=(i+o)/2,l=et/this.upime.view.scale;switch(e){case"l":return{x:n-l,y:s};case"r":return{x:r+l,y:s};case"t":return{x:a,y:i-l};case"b":return{x:a,y:o+l};default:return{x:a,y:s}}},t.prototype.getOppositeLocation=function(e){switch(e){case"l":return"r";case"r":return"l";case"t":return"b";case"b":return"t";default:return""}},t.prototype.checkSelectRelation=function(t,n){return"click"===(null==n?void 0:n.type)&&this.currentLocation?{transparent:!1,metric:-1,metaData:{clickData:{customData:{quickAdd:{location:this.currentLocation}}}}}:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.dealClick=function(t,n){var i,r,o,a=null===(o=null===(r=null===(i=null==n?void 0:n.clickData)||void 0===i?void 0:i.customData)||void 0===r?void 0:r.quickAdd)||void 0===o?void 0:o.location;a?this.quickAdd(a):e.prototype.dealClick.call(this,t)},t.prototype.quickAdd=function(e){var t=this.currentLocation;this.currentLocation=e;var n=this.quickAddIndicateBorder||this.findQuickAddPlace(),i=this.getStartAndEndPositionByLocation(),r=i[0],o=i[1];this.setCurrentLocation(t);var a=this.upime.createOperation(),s=zs(this.element,this.element.elementType);if(delete s.link,this.element.position.parentType){var l=this.element.calcTransformedUpdate(this.upime.view.elementsRoot);Object.assign(s,l)}s.frameId=null;var c=this.getQuickAddBorder(),u=c.left-n.left,d=c.top-n.top,p=this.element.getGlobalBox();s.position={x:p.left-u,y:p.top-d},s.size={width:(p.right-p.left)/(s.scale||1),height:(p.bottom-p.top)/(s.scale||1)},s=this.transformQuickAddProcesseCreateData(s);var h=a.create(this.element.elementType,exports.E(exports.E({},s),{zIndex:this.element.upime.newMaxZindex()}));this.onQuickAddEnd(h,this.element),this.upime.updateElementParent(a,h);var f=this.element.getConnectLineStyle(r.percentOffset)||this.upime.curConnectionLineConfig;a.create(Za.CONNECTIONLINE,exports.E(exports.E(exports.E({startElementId:this.element.id,endElementId:h.id,startPosition:r.percentOffset,endPosition:o.percentOffset,startType:r.attachedPointType,endType:o.attachedPointType,zIndex:this.element.upime.newMaxZindex()},RD),f),{lineType:2})),f&&this.upime.updateConnectionLineConfig(f),a.sync(),this.upime.selectElement(h)},t.prototype.transformQuickAddProcesseCreateData=function(e){return e},t.prototype.onQuickAddEnd=function(e,t){},t.prototype.drawOutline=function(e){throw new Error("Method not implemented.")},t.prototype.getQuickAddClone=function(e){throw new Error("Method not implemented.")},t}(Ob),LD=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.domRenderer=qM,r.richContentEditor=n.richTextClient.contentEditor,r.editable&&!r.isHandMode&&(!t.phoneMode&&r.propertyEditors.push(new mA(r,r.element)),r.propertyEditors.push(new CD(r),new tA(r),new sA(r,r.richContentEditor),new vE(r,r.richContentEditor),new pE(r,r.element))),r.multiResizeDirection.push("n","w","e","s"),r.upime.getGraphicLib().then((function(e){r.graphicLib=e})),r}return P(t,e),t.prototype.getBaseMinSize=function(){switch(this.element.shape){case Ka.BARREL:return 60+2*this.element.borderThickness;case Ka.DOCUMENT:return 90;default:return 8}},t.prototype.getMinSize=function(e,t){var n=this.getBaseMinSize(),i=this.getIsUpdateScale(e,t),r=this.element.globalTransform.currentScale;return i?n/r:n*Math.max(1/r,this.element.scale)},Object.defineProperty(t.prototype,"lastColor",{set:function(e){if(void 0!==e){this.upime.lastShapeColor=e;var t=this.getGraphicCategory();t&&this.upime.setGraphicLastColorByCategory(t.categoryId,e)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t),this.updateShapeStyle()},t.prototype.slideUpdateProperty=function(t,n,i){void 0===i&&(i=!1),e.prototype.slideUpdateProperty.call(this,t,n,i),this.updateShapeStyle()},t.prototype.updateShapeStyle=function(){var e=this.element.scale*this.element.globalTransform.currentScale,t={size:{width:this.element.size.width*e,height:this.element.size.height*e},hasBorder:this.element.hasBorder,borderStyle:this.element.borderStyle,borderColor:this.element.borderColor,borderThickness:this.formateBorderThickness(this.element.borderThickness*e),borderOpacity:this.element.borderOpacity,hasBg:this.element.hasBg,bgColor:this.element.bgColor,bgOpacity:this.element.bgOpacity,ha:this.element.ha,va:this.element.va,fontSize:this.element.fontSize,lineHeight:this.element.lineHeight,lineHeightRate:this.element.lineHeightRate,fontFamily:this.element.fontFamily};this.upime.updateShapeStyle(t,this.element.shape);var n=this.getGraphicCategory();n&&this.upime.setGraphicStyleByCategory(n.categoryId,t)},t.prototype.checkKeepRatio=function(t){return e.prototype.checkKeepRatio.call(this,t)&&this.shiftKeyDown},t.prototype.dealMultiEditorResize=function(t,n,i){t.isStart&&(this.originFontSize=this.element.fontSize,this.originScale=this.element.scale),e.prototype.dealMultiEditorResize.call(this,t,n,i)},t.prototype.dealBorderResize=function(e,t,n){var i=t.left,r=t.top,o=t.right,a=t.bottom,s=(o-i)/this.element.scale,l=(a-r)/this.element.scale;this.element.size.width;var c=this.element.position,u={position:exports.E(exports.E({},c),{x:i,y:r}),size:{width:s,height:l}},d=["nw","ne","sw","se"].indexOf(n)>=0,p=this.getIsUpdateScale(n,e)&&u.size;if(p&&u.size){var h=u.size.width/this.element.size.width*this.element.scale;delete u.size,u.scale=h}if(!p&&"multi"===this.element.selectStatus&&d){var f=this.originFontSize,m=this.selfOriginBorder,v=this.originScale,g=(t.right-t.left)/this.element.scale,y=(m.right-m.left)/v;u.fontSize=Math.ceil(g/y*f),u.fontSize<1&&(u.fontSize=1),u.lineHeight=ib(u.fontSize,this.element.lineHeightRate)}this.updateSelf(u),this.updateShapeStyle()},t.prototype.supportLinkTo=function(){return!0},t.prototype.getQuickAddClone=function(e){return new eR(this.upime,e)},t.prototype.transformQuickAddProcesseCreateData=function(e){return e.richContent={version:"0_0",content:[]},e},t.prototype.onQuickAddEnd=function(e){var t,n={color:(null===(t=this.element.richTextClient)||void 0===t?void 0:t.contentEditor.currentStyle.color)||1710618};e.richTextClient.contentEditor.updateStyle(n)},t.prototype.drawOutline=function(e){var t=this.upime.view.getViewbox().scale*this.element.globalTransform.currentScale,n={width:e.width/t,height:e.height/t},i=1/t,r={x:0,y:0,lineWidth:i,lineDash:[4*i,4*i],stroke:pr(5740786)},o=this.element.shapeClient,a="common"===o.pathRenderType;fa({scaleX:t,scaleY:t}),a?(va(exports.E({},r)),o.ShapePathRenderFC({client:o,size:n,globalScale:t}),ma()):o.ShapePathRenderFC({client:o,size:n,globalScale:t,pathProps:r}),ma()},t.prototype.getGraphicCategory=function(){var e,t=this;return null===(e=this.graphicLib)||void 0===e?void 0:e.find((function(e){return e.list.some((function(e){return PE[e.id]===t.element.shape}))}))},t.prototype.formateBorderThickness=function(e){if(e<it[0])return it[0];if(e>it[it.length-1])return it[it.length-1];var t=R([],it,!0).sort(),n=t.findIndex((function(t,n){return t<=e&&t+1>=e})),i=t[n],r=t[n+1];return e-i<r-e?i:r},t.prototype.getIsUpdateScale=function(e,t){var n=t.originEvent.shiftKey||t.originEvent.ctrlKey,i=["nw","ne","sw","se"].indexOf(e)>=0;return n&&i},t}(BD),OD=function(e){var t,n=js.value.viewbox,i=e.hasBorder,r=e.borderStyle,o=e.borderColor,a=e.borderOpacity,s=e.hasBg,l=e.bgColor,c=e.bgOpacity,u=e.showAttachedOnsideShadow,d=e.shapeClient,p=e.scale,h=e.borderThickness,f={width:e.size.width*p,height:e.size.height*p},m={x:e.position.x,y:e.position.y},v=hf(e,1,[e.size,e.scale]),g=exports.E(exports.E({},m),{lineWidth:i?h*p:0,lineDash:3===r?[4*h*p,4*h*p]:2===r?[h*p,h*p]:[],stroke:pr(o),strokeAlpha:a});s&&(g.fill=pr(l),g.fillAlpha=c);var y=e.globalTransform.currentScale*n.scale;mf(e,v,!u),"common"===d.pathRenderType?(va(exports.E({},g)),d.ShapePathRenderFC({client:d,size:f,globalScale:y}),ma()):d.ShapePathRenderFC({client:d,size:f,globalScale:y,pathProps:g}),function(e){var t=e.textRect,n=e.position,i=e.scale,r=n.x+t.x*i,o=n.y+t.y*i;jy({x:r,y:o,maxHeight:t.height,element:e,richClient:e.richTextClient,isWheeling:e.upime.view.isWheeling})}(e),(null===(t=e.childElements)||void 0===t?void 0:t.length)&&(fa({x:m.x,y:m.y,scaleX:p,scaleY:p}),e.childElements.forEach((function(e){return e.render()})),ma()),u&&(fa({x:m.x,y:m.y,fill:"#858585",fillAlpha:.2}),d.ShapePathRenderFC({client:d,size:f,pathProps:g,globalScale:y,showAttachBorder:!0}),ma()),bf(e),Ef(e),ma()},FD=function(e){function t(t){var n=e.call(this)||this;return n.shape=t,n.pathRenderType="common",n}return P(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return{width:this.shape.size.width*this.shape.scale,height:this.shape.size.height*this.shape.scale}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realSize",{get:function(){return{width:this.shape.size.width,height:this.shape.size.height}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderBox",{get:function(){return this.shape.getBorderBox()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderWidth",{get:function(){return this.shape.borderWidth*this.shape.scale},enumerable:!1,configurable:!0}),t}(el),zD=function(e){var t=e.client,n=e.size,i=e.globalScale;Ta(t.getIPathData(n,i))},HD=function(e){var t=e.size;ka(exports.E({x:0,y:0},t))},UD=function(e){var t=e.size;_a({cx:t.width/2,cy:t.height/2,rx:t.width/2,ry:t.height/2})},WD=function(e){var t,n=e.client,i=e.size,r=e.pathProps,o=e.showAttachBorder,a=i.width,s=i.height,l=n.shape.scale,c=15*l,u=null!==(t=null==r?void 0:r.lineWidth)&&void 0!==t?t:2,d=n.useMemo("dataPath",(function(){return[["M",0,c],["C",0,c-c*SD,a,c-c*SD,a,c],["L",a,s-c],["C",a,s-c+c*SD,0,s-c+c*SD,0,s-c],["L",0,c]]}),[i,l]);if(o)Ta(d);else{var p=n.useMemo("innerLinePath",(function(){return[["M",0,c],["L",0,c+u/2],["C",0,c+u*SD+c*SD,a,c+u*SD+c*SD,a,c+u/2],["L",a,c]]}),[i,u]);va(exports.E({},r)),Ta(d),ma(),fa(exports.E(exports.E({},r),{lineWidth:2*u,fill:void 0})),za([new Sa(p),new wa({x:0+u-.5,y:c,width:a-2*(u-.5),height:2*(c+u)})]),Ta(p),ma()}},VD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r){var o=n.left,a=n.top,s=e.x,l=e.y,c=t.size,u=c.width/2,d=c.height,p={x:s-(o+u),y:l-(a+d)},h=p.x,f=p.y,m=Qt(p,{x:0,y:-d-i},{x:u+i,y:i},{x:-u-i,y:i}),v=h/u-f/d>=1,g=f>=0-r&&Math.abs(h)<=u;return{onside:m&&(v||g||-h/u-f/d>=1),inside:m}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.shape.getBorderBox(),o=r.left,a=r.top,s=t.size,l=s.width/2,c=s.height,u={x:o+l,y:a+c},d={x:e.x-u.x,y:e.y-u.y},p=d.x,h=d.y,f=p/l-h/c>=1,m=h>=0&&Math.abs(p)<=l,v=-p/l-h/c>=1;f&&(h=c/l*p-c),m&&(h=0),v&&(h=-c/l*p-c),i={x:p+u.x,y:h+u.y}}return i},t.getAdsorptionPoints=function(){var e=[];e.length=0;var n=t.shape.getBorderBox(),i=n.left,r=n.top,o=t.size,a=o.width,s=o.height,l={x:i+a/2,y:r},c={x:i+(a/2+a)/2,y:r+s/2},u={x:i+a,y:r+s},d={x:i+a/2,y:r+s},p={x:i,y:r+s},h={x:i+a/4,y:r+s/2};return e.push(l),e.push(c),e.push(u),e.push(d),e.push(p),e.push(h),e},t.getAttachedProps=function(e,n){var i=t.shape.getBorderBox(),r=i.left,o=i.top,a=i.right,s=i.bottom,l=t.size,c=l.width,u=l.height,d={x:e.x,y:e.y};switch(n){case"l":d={x:r+c/4,y:e.y};break;case"t":d={x:e.x,y:o};break;case"r":d={x:a-c/4,y:e.y};break;case"b":d={x:e.x,y:s}}var p=(d.x-r)/c,h=(d.y-o)/u;return{attachedElementId:t.shape.id,attachedPointType:2,percentOffset:{x:p,y:h}}},t.getConnectionPointAngle=function(e,n){var i=e.x,r=e.y;if(yn(r,1)&&!yn(i,0)&&!yn(i,1))return Math.PI/2;if(yn(r,0))return 1.5*Math.PI;if(2===n)return i>=.5?Math.PI:0;var o=t.size.width/2,a=i*t.size.width-o,s=r*t.size.height-0,l=Math.atan(s/a);return 1.5*Math.PI-l},t}return P(t,e),t.prototype.getIPathData=function(e){var t=e.width,n=e.height;return[["M",t/2,0],["L",t,n],["L",0,n],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height;return{x:t/4,y:n/2,width:t/=2,height:n/=2}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size;return e.width*e.height/2},t}(FD),jD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=HD,t.getIPathData=function(){return[]},t.renderType="custom",t.getInsideOnside=function(e,t,n,i){var r=t.left,o=t.right,a=t.top,s=t.bottom,l=e.x,c=e.y,u=l>=r-n&&c>=a-n&&l<=o+n&&c<=s+n;return{inside:u,onside:u&&(l<=r+i||c<=a+i||l>=o-i||c>=s-i)}},t.getAttachedPoint=null,t.getAdsorptionPoints=null,t.getAttachedProps=null,t.getConnectionPointAngle=null,t}return P(t,e),Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height,i=Math.min(16,Math.floor(t/20),Math.floor(n/20));return{x:i,y:i,width:t-2*i,height:n-2*i}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.shape.size;return e.width*e.height},t}(FD),GD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r){var o=n.left,a=n.top,s=n.right,l=t.size,c=l.width,u=l.height,d=e.x,p=e.y,h=c/2,f=u/2,m=(c+2*i)/2,v=(u+2*i)/2,g={x:o+h,y:a+f},y={x:d-g.x,y:p-g.y},b=y.x,E=y.y,x=.24,w={x:0,y:0},C={x:2*m*x-m,y:-v},S={x:m,y:-v},k={x:m-2*m*x,y:v},_={x:-m,y:v},T=Qt(y,C,S,w)||Qt(y,S,k,w)||Qt(y,k,_,w)||Qt(y,_,C,w),I=E<=-f+r&&b>=2*h*x-h&&b<=h,P=E>=f-r&&b>=-h&&b<=h-.96,N=-(b=(y={x:d-(g={x:o+c*x,y:a+u}).x,y:p-g.y}).x)/(2*h*x)-(E=y.y)/(2*f)>=1&&d<=o+c*x;return b=(y={x:d-(g={x:s-2*h*x,y:a}).x,y:p-g.y}).x,E=y.y,{inside:T,onside:T&&(I||P||b/(2*h*x)+E/(2*f)>=1&&d>=s-c*x||N)}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.borderBox,l=s.left,c=s.top,u=s.right,d=o/2,p=a/2,h={x:l+d,y:c+p},f={x:e.x-h.x,y:e.y-h.y},m=f.x,v=f.y,g=.24,y=v>=p&&m>=-d&&m<=d-.96;v<=-p&&m>=2*d*g-d&&m<=d&&(v=-p),y&&(v=p),i={x:m+h.x,y:v+h.y},h={x:l+o*g,y:c+a},-(m=(f={x:e.x-h.x,y:e.y-h.y}).x)/(2*d*g)-(v=f.y)/(2*p)>=1&&e.x<=l+o*g&&(v=-p/(d*g)*m-2*p,i={x:m+h.x,y:v+h.y}),h={x:u-2*d*g,y:c},(m=(f={x:e.x-h.x,y:e.y-h.y}).x)/(2*d*g)+(v=f.y)/(2*p)>=1&&e.x>=u-o*g&&(v=-p/(d*g)*m+2*p,i={x:m+h.x,y:v+h.y})}return i},t.getAdsorptionPoints=function(){var e=[],n=t.borderBox,i=n.left,r=n.top,o=n.right,a={x:o-.76*t.size.width/2,y:r},s={x:o-.24*t.size.width/2,y:r+t.size.height/2},l={x:i+.76*t.size.width/2,y:r+t.size.height},c={x:i+.24*t.size.width/2,y:r+t.size.height/2};return e.push(a),e.push(s),e.push(l),e.push(c),e},t.getAttachedProps=function(e,n){var i=t.shape.getBorderBox(),r=i.left,o=i.top,a=i.right,s=i.bottom,l=t.size,c=l.width,u=l.height,d={x:e.x,y:e.y};switch(n){case"l":d={x:r+.24*(a-r)/2,y:e.y};break;case"t":d={x:e.x,y:o};break;case"r":d={x:a-.24*(a-r)/2,y:e.y};break;case"b":d={x:e.x,y:s}}var p=(d.x-r)/c,h=(d.y-o)/u;return{attachedElementId:t.shape.id,attachedPointType:2,percentOffset:{x:p,y:h}}},t.getConnectionPointAngle=function(e,n){var i=e.x,r=e.y;if(yn(r,1))return Math.PI/2;if(yn(r,0))return 1.5*Math.PI;var o=i>=.5;if(2===n)return o?Math.PI:0;var a=o?t.size.width:.24*t.size.width,s=i*t.size.width-a,l=r*t.size.height-0,c=Math.atan(l/s);return Math.PI*(o?.5:1.5)-c},t}return P(t,e),t.prototype.getIPathData=function(e){var t=e.width,n=e.height;return[["M",.24*t,0],["L",t,0],["L",.76*t,n],["L",0,n],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize.width;return{x:e/4,y:0,width:e/=2,height:this.realSize.height}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size;return e.width*e.height/2},t}(FD),qD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r){var o=t.size,a=o.width,s=o.height,l=n.left,c=n.right,u=n.bottom,d=n.top,p=e.x,h=e.y,f=p>=l-i&&h>=d-i&&p<=c+i&&h<=u+i,m=a/2,v=s/2,g={x:l+a/2,y:d+s/2},y={x:p-g.x,y:h-g.y},b=.2*Math.min(a,s),E=y.y<=-v+r&&Math.abs(y.x)<=m-b,x=Math.abs(y.y)<=v-b&&y.x>=m-r,w=y.y>=v-r&&Math.abs(y.x)<=m-b,C=Math.abs(y.y)<=v-b&&y.x<=-m+r;g={x:l+b,y:d+b};var S=(y={x:e.x-g.x,y:e.y-g.y}).x<=0&&y.y<=0&&Math.pow(y.x,2)+Math.pow(y.y,2)<=Math.pow(b+i,2)&&Math.pow(y.x,2)+Math.pow(y.y,2)>=Math.pow(b-r,2);g={x:c-b,y:d+b};var k=(y={x:e.x-g.x,y:e.y-g.y}).x>=0&&y.y<=0&&Math.pow(y.x,2)+Math.pow(y.y,2)<=Math.pow(b+i,2)&&Math.pow(y.x,2)+Math.pow(y.y,2)>=Math.pow(b-r,2);g={x:c-b,y:u-b};var _=(y={x:e.x-g.x,y:e.y-g.y}).x>=0&&y.y>=0&&Math.pow(y.x,2)+Math.pow(y.y,2)<=Math.pow(b+i,2)&&Math.pow(y.x,2)+Math.pow(y.y,2)>=Math.pow(b-r,2);g={x:l+b,y:u-b};var T=(y={x:e.x-g.x,y:e.y-g.y}).x<=0&&y.y>=0&&Math.pow(y.x,2)+Math.pow(y.y,2)<=Math.pow(b+i,2)&&Math.pow(y.x,2)+Math.pow(y.y,2)>=Math.pow(b-r,2);return{onside:f&&(E||x||w||C||S||k||_||T),inside:f}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.shape.getBorderBox(),l=s.left,c=s.right,u=s.bottom,d=s.top,p=o/2,h=a/2,f={x:l+o/2,y:d+a/2},m={x:e.x-f.x,y:e.y-f.y},v=.2*Math.min(o,a),g=m.x,y=m.y;if(f={x:l+v,y:d+v},(m={x:e.x-f.x,y:e.y-f.y}).x<=0&&m.y<=0&&Math.pow(m.x,2)+Math.pow(m.y,2)>=Math.pow(v,2)){var b=m.y/m.x;y=(g=-v/Math.sqrt(1+Math.pow(b,2)))*b,i={x:g+f.x,y:y+f.y}}f={x:c-v,y:d+v},(m={x:e.x-f.x,y:e.y-f.y}).x>=0&&m.y<=0&&Math.pow(m.x,2)+Math.pow(m.y,2)>=Math.pow(v,2)&&(b=m.y/m.x,y=(g=v/Math.sqrt(1+Math.pow(b,2)))*b,i={x:g+f.x,y:y+f.y}),f={x:c-v,y:u-v},(m={x:e.x-f.x,y:e.y-f.y}).x>=0&&m.y>=0&&Math.pow(m.x,2)+Math.pow(m.y,2)>=Math.pow(v,2)&&(b=m.y/m.x,y=(g=v/Math.sqrt(1+Math.pow(b,2)))*b,i={x:g+f.x,y:y+f.y}),f={x:l+v,y:u-v},(m={x:e.x-f.x,y:e.y-f.y}).x<=0&&m.y>=0&&Math.pow(m.x,2)+Math.pow(m.y,2)>=Math.pow(v,2)&&(b=m.y/m.x,y=(g=-v/Math.sqrt(1+Math.pow(b,2)))*b,i={x:g+f.x,y:y+f.y}),f={x:l+o/2,y:d+a/2},g=(m={x:e.x-f.x,y:e.y-f.y}).x,y=m.y;var E=m.y<=-h&&Math.abs(m.x)<=p-v,x=Math.abs(m.y)<=h-v&&m.x>=p,w=m.y>=h&&Math.abs(m.x)<=p-v,C=Math.abs(m.y)<=h-v&&m.x<=-p;E&&(y=-h),x&&(g=p),w&&(y=h),C&&(g=-p),(E||x||w||C)&&(i={x:g+f.x,y:y+f.y})}return i},t.getAdsorptionPoints=null,t.getAttachedProps=null,t.getConnectionPointAngle=null,t}return P(t,e),t.prototype.getIPathData=function(e,t){var n=e.width,i=e.height,r=.2*Math.min(n,i);return r*t<2?[["M",n,0],["L",n,i],["L",0,i],["L",0,0],["Z"]]:[["M",n-r,0],["R",n,0,n,r,r],["L",n,i-r],["R",n,i,n-r,i,r],["L",r,i],["R",0,i,0,i-r,r],["L",0,r],["R",0,0,r,0,r],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height,i=.2*Math.min(t,n),r=Math.floor(i/4);return{x:r,y:r,width:t-2*r,height:n-2*r}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.shape.getBorderBox(),t=e.left,n=e.top;return(e.right-t)*(e.bottom-n)/2},t}(FD),KD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i){var r=n.left,o=n.top,a=t.size,s=a.width,l=a.height,c=s+2*i,u=l+2*i,d={x:e.x-(r+s/2),y:e.y-(o+l/2)},p={x:c/2,y:0},h={x:0,y:-u/2},f={x:-c/2,y:0},m=Qt(d,{x:0,y:u/2},p,f)||Qt(d,p,h,f);return{inside:m,onside:m&&(d.x/(s/2)+d.y/(l/2)>=1||-d.x/(s/2)+d.y/(l/2)>=1||-d.x/(s/2)+-d.y/(l/2)>=1||d.x/(s/2)+-d.y/(l/2)>=1)}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.borderBox,l={x:s.left+o/2,y:s.top+a/2},c={x:e.x-l.x,y:e.y-l.y},u=c.x,d=c.y;c.x/(o/2)+c.y/(a/2)>=1&&(d=-a/o*u+a/2),-c.x/(o/2)+c.y/(a/2)>=1&&(d=a/o*u+a/2),-c.x/(o/2)+-c.y/(a/2)>=1&&(d=-a/o*u-a/2),c.x/(o/2)+-c.y/(a/2)>=1&&(d=+a/o*u-a/2),i={x:u+l.x,y:d+l.y}}return i},t.getAdsorptionPoints=function(){var e=t.borderBox,n=e.left,i=e.top,r=e.right,o=e.bottom,a=t.size,s=a.width,l=a.height,c=[{x:n,y:i+l/2},{x:r,y:i+l/2},{x:n+s/2,y:i},{x:n+s/2,y:o}],u={x:n+(s/2+s)/2,y:i+(0+l/2)/2},d={x:n+(s+s/2)/2,y:i+(l/2+l)/2},p={x:n+(s/2+0)/2,y:i+(l+l/2)/2},h={x:n+(0+s/2)/2,y:i+(l/2+0)/2};return c.push(u),c.push(d),c.push(p),c.push(h),c},t.getAttachedProps=null,t.getConnectionPointAngle=function(e){var n=t.borderBox,i=n.left,r=n.top,o=t.size,a=o.width,s=o.height,l=e.x,c=e.y,u=yn(l,.5),d=yn(c,.5),p=yn(l,0),h=yn(c,0),f=yn(l,1),m=yn(c,1),v=a/2,g=s/2,y=i+v,b=r+g,E=0;if(u&&h)E=1.5*Math.PI;else if(f&&d)E=Math.PI;else if(u&&m)E=.5*Math.PI;else if(p&&d)E=0;else{var x=t.shape.getPointByPercentOffset(e,!0),w=x.x-y,C=x.y-b,S=Math.abs(-w*Math.pow(g,2)/(C*Math.pow(v,2)));E=Math.atan(1/S),w<0&&C<0?E=2*Math.PI-E:w>0&&C>0?E=Math.PI-E:w>0&&C<0&&(E+=Math.PI)}return rn(E)},t}return P(t,e),t.prototype.getIPathData=function(e){var t=e.width,n=e.height;return[["M",t/2,0],["L",t,n/2],["L",t/2,n],["L",0,n/2],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height;return{x:t/4,y:n/4,width:t/=2,height:n/=2}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size;return e.width*e.height/2},t}(FD),YD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=UD,t.getInsideOnside=function(e,n,i,r){var o=n.left,a=n.top,s=t.size,l=s.width/2,c=s.height/2,u={x:e.x-(o+l),y:e.y-(a+c)},d=Math.pow(u.x,2)/Math.pow(l+i,2)+Math.pow(u.y,2)/Math.pow(c+i,2)<=1;return{inside:d,onside:d&&Math.pow(u.x,2)/Math.pow(l-r,2)+Math.pow(u.y,2)/Math.pow(c-r,2)>=1}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.borderBox,l=o/2,c=a/2,u={x:s.left+l,y:s.top+c},d={x:e.x-u.x,y:e.y-u.y};if(n){var p=d.x>0?1:-1,h=d.y/d.x,f=l*c/Math.sqrt(Math.pow(l,2)*Math.pow(h,2)+Math.pow(c,2))*p;i={x:f+u.x,y:h*f+u.y}}}return i},t.getAdsorptionPoints=null,t.getAttachedProps=null,t.getConnectionPointAngle=function(e){var n=t.borderBox,i=n.left,r=n.top,o=t.size,a=o.width,s=o.height,l=e.x,c=e.y,u=yn(l,.5),d=yn(c,.5),p=yn(l,0),h=yn(c,0),f=yn(l,1),m=yn(c,1),v=a/2,g=s/2,y=i+v,b=r+g,E=0;if(u&&h)E=1.5*Math.PI;else if(f&&d)E=Math.PI;else if(u&&m)E=.5*Math.PI;else if(p&&d)E=0;else{var x=t.shape.getPointByPercentOffset(e,!0),w=x.x-y,C=x.y-b,S=Math.abs(-w*Math.pow(g,2)/(C*Math.pow(v,2)));E=Math.atan(1/S),w<0&&C<0?E=2*Math.PI-E:w>0&&C>0?E=Math.PI-E:w>0&&C<0&&(E+=Math.PI)}return rn(E)},t}return P(t,e),t.prototype.getIPathData=function(){return[]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height,i=t/7,r=t/2-t/7,o=n/2-Math.sqrt(n*n/4-n*n/(t*t)*r*r);return{x:i,y:o,width:t-=2*i,height:n-=2*o}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size,t=e.width,n=e.height;return Math.PI*(t/2)*(n/2)},t}(FD),XD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r){var o=n.left,a=n.top,s=n.bottom,l=t.size,c=l.width,u=l.height,d=e.x,p=e.y,h=o+.6875*c,f=a+.2125*u,m=s-.2125*u,v=!1,g=!1;if(d<=h&&p>=f-i&&p<=m+i){var y={top:a+.2125*u,right:o+.6875*c,bottom:s-.2125*u,left:o};(g=(v=d>=y.left-i&&p>=y.top-i&&d<=y.right+i&&p<=y.bottom+i)&&(d<=y.left+r||p<=y.top+r||d>=y.right-r||p>=y.bottom-r))&&d>=y.right-t.borderWidth&&p>y.top+t.borderWidth&&p<y.bottom-t.borderWidth&&(g=!1)}else{var b=.3125*c,E=u/2,x={x:o+.6875*c,y:a+E},w={x:d-x.x,y:p-x.y},C=b/E,S=1/Math.sqrt(1+Math.pow(C,2)),k=Math.sqrt((1-S)/(1+S));v=Qt(w,{x:-i,y:-(E+i/k)},{x:b+i/S,y:0},{x:-i,y:E+i/k});var _=Qt(w,{x:r,y:-(E-r/k)},{x:b-r/S,y:0},{x:r,y:E-r/k});(g=v&&!_)&&d<=h+t.borderWidth&&p>f+t.borderWidth&&p<m-t.borderWidth&&(g=!1)}return{inside:v,onside:g}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.borderBox,l=s.left,c=s.top,u=s.bottom,d=e.x,p=e.y;if(d<l+.6875*o-t.shape.selectSensitivation/t.shape.upime.view.scale){var h={top:c+.2125*a,right:l+.6875*o,bottom:u-.2125*a,left:l};e.x<=l?i={x:h.left,y:e.y}:e.y<=h.top?i={x:e.x,y:h.top}:e.x>=h.right?i={x:h.right,y:e.y}:e.y>=h.bottom&&(i={x:e.x,y:h.bottom}),i={x:Math.min(Math.max(i.x,h.left),h.right),y:Math.min(Math.max(i.y,h.top),h.bottom)}}else{var f=l+.6875*o;if(d<=f)i.x=f;else{var m=a/2/(.3125*o);if(p<=c+a/2){var v=(d-f)*m+c;i.y=v}else v=u-(d-f)*m,i.y=v}}}return i},t.getAdsorptionPoints=function(){var e=[],n=t.borderBox,i=n.left,r=n.top,o={x:i,y:r+t.size.height/2},a={x:i+t.size.width,y:r+t.size.height/2};return e.push(o,a),e},t.getAttachedProps=function(e,n){var i=t.borderBox,r=i.left,o=i.top,a=i.right,s=i.bottom,l=t.size,c=l.width,u=l.height,d={x:e.x,y:e.y};switch(n){case"l":d={x:r,y:o+u/2};break;case"t":d={x:e.x,y:o+.2125*u};break;case"r":d={x:a,y:o+u/2};break;case"b":d={x:e.x,y:s-.2125*u}}var p=(d.x-r)/c,h=(d.y-o)/u;return{attachedElementId:t.shape.id,attachedPointType:2,percentOffset:{x:p,y:h}}},t.getConnectionPointAngle=function(e,t){var n=e.x,i=yn(n,0),r=yn(n,1),o=0;if(i||r)o=i?0:Math.PI;else{var a=e.x,s=e.y;o=a<=.6875?yn(s,.2125,3)?1.5*Math.PI:yn(s,.7875,3)?Math.PI/2:0:s>.5?Math.PI/2:1.5*Math.PI}return o},t}return P(t,e),t.prototype.getIPathData=function(e){var t=e.width,n=e.height;return[["M",0,.2125*n],["L",.6875*t,.2125*n],["L",.6875*t,0],["L",t,n/2],["L",.6875*t,n],["L",.6875*t,.7875*n],["L",0,.7875*n],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height;return{x:this.shape.borderWidth,y:.25*n,width:t*=.75,height:n/=2}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size,t=e.width,n=e.height;return.6875*t*n*.575+.3125*t*n/2},t}(FD),QD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r){var o=n.left,a=n.right,s=n.top,l=n.bottom,c=t.size,u=c.width,d=c.height,p=e.x,h=e.y,f=o+.3125*u,m=s+.2125*d,v=l-.2125*d,g=!1,y=!1;if(p>=f&&h>=m-i&&h<=v+i){var b={top:s+.2125*d,right:a,bottom:l-.2125*d,left:o+.3125*u};(y=(g=p>=b.left-i&&h>=b.top-i&&p<=b.right+i&&h<=b.bottom+i)&&(p<=b.left+r||h<=b.top+r||p>=b.right-r||h>=b.bottom-r))&&p<=b.left+t.borderWidth&&h>b.top+t.borderWidth&&h<b.bottom-t.borderWidth&&(y=!1)}else{var E=.3125*u,x=d/2,w={x:o+E,y:s+x},C={x:p-w.x,y:h-w.y},S=E/x,k=1/Math.sqrt(1+Math.pow(S,2)),_=Math.sqrt((1-k)/(1+k));g=Qt(C,{x:i,y:-(x+i/_)},{x:-(E+i/k),y:0},{x:i,y:x+i/_});var T=Qt(C,{x:-r,y:-(x-r/_)},{x:-(E-r/k),y:0},{x:-r,y:x-r/_});(y=g&&!T)&&p>=f-t.borderWidth&&h>m+t.borderWidth&&h<v-t.borderWidth&&(y=!1)}return{inside:g,onside:y}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size,o=r.width,a=r.height,s=t.borderBox,l=s.left,c=s.right,u=s.top,d=s.bottom,p=e.x,h=e.y;if(p>l+.3125*o+t.shape.selectSensitivation/t.shape.upime.view.scale){var f={top:u+.2125*a,right:c,bottom:d-.2125*a,left:l+.3125*o};e.x<=l?i={x:f.left,y:e.y}:e.y<=f.top?i={x:e.x,y:f.top}:e.x>=f.right?i={x:f.right,y:e.y}:e.y>=f.bottom&&(i={x:e.x,y:f.bottom}),i={x:Math.min(Math.max(i.x,f.left),f.right),y:Math.min(Math.max(i.y,f.top),f.bottom)}}else{var m=l+.3125*o;if(p>=m)i.x=m;else{var v=a/2/(.3125*o);if(h<=u+a/2){var g=(m-p)*v+u;i.y=g}else g=d-(m-p)*v,i.y=g}}}return i},t.getAdsorptionPoints=function(){var e=[],n=t.borderBox,i=n.left,r=n.top,o={x:i,y:r+t.size.height/2},a={x:i+t.size.width,y:r+t.size.height/2};return e.push(o,a),e},t.getAttachedProps=function(e,n){var i=t.borderBox,r=i.left,o=i.top,a=i.right,s=i.bottom,l=t.size,c=l.width,u=l.height,d={x:e.x,y:e.y};switch(n){case"l":d={x:r,y:o+u/2};break;case"t":d={x:e.x,y:o+.2125*u};break;case"r":d={x:a,y:o+u/2};break;case"b":d={x:e.x,y:s-.2125*u}}var p=(d.x-r)/c,h=(d.y-o)/u;return{attachedElementId:t.shape.id,attachedPointType:2,percentOffset:{x:p,y:h}}},t.getConnectionPointAngle=function(e,t){var n=e.x,i=yn(n,0),r=yn(n,1),o=0;if(i||r)o=i?0:Math.PI;else{var a=e.x,s=e.y;o=a>=.3125?yn(s,.2125,3)?1.5*Math.PI:yn(s,.7875,3)?Math.PI/2:0:s>.5?Math.PI/2:1.5*Math.PI}return o},t}return P(t,e),t.prototype.getIPathData=function(e){var t=e.width,n=e.height;return[["M",t,.2125*n],["L",.3125*t,.2125*n],["L",.3125*t,0],["L",0,n/2],["L",.3125*t,n],["L",.3125*t,.7875*n],["L",t,.7875*n],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height;return{x:.25*t,y:.25*n,width:t=.75*t-this.shape.borderWidth,height:n/=2}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size,t=e.width,n=e.height;return.6875*t*n*.575+.3125*t*n/2},t}(FD),ZD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=WD,t.pathRenderType="custom",t.getInsideOnside=function(e,n,i,r,o){var a=n.left,s=n.top,l=n.right,c=t.size,u=c.width,d=c.height,p=e.x,h=!1,f=!1,m=p-a,v=e.y-s,g=15*t.shape.scale;if(m>=-i&&m<=u+2*i)if(v>=g+i&&v<=d+i-g)h=!0,f=p<=a+r||p>=l-r;else{var y=v<g+i,b=y?t.topBezierPoints:t.btmBezierPoints,E=b[0],x=b[1],w=b[2],C=b[3],S=E.x-i,k=E.y,_=x.x-i,T=x.y+(y?-1:1)*i,I=w.x+i,P=w.y+(y?-1:1)*i,N=C.x+i,M=C.y;st.save(),st.beginPath(),st.moveTo(S,k),st.bezierCurveTo(_,T,I,P,N,M),st.closePath(),(h=st.isPointInPath(m,v))&&o&&(st.beginPath(),st.moveTo(E.x,E.y),st.bezierCurveTo(x.x,x.y,w.x,w.y,C.x,C.y),st.closePath(),f=dn(E,x,w,C,{x:m,y:v},st.isPointInPath(m,v)?r:8/t.shape.upime.view.scale)),st.restore()}return{inside:h,onside:f}},t.getAttachedPoint=function(e,n){var i={x:e.x,y:e.y};if(n){var r=t.size.width,o=t.borderBox,a=o.left,s=o.top,l=o.bottom,c=o.right,u=e.x,d=e.y,p=15*t.shape.scale;if(d>=p+s&&d<=l-p)u<=a?i.x=a:u>=c&&(i.x=c);else{var h=u-a,f=d-s,m=d<s+p?t.topBezierPoints:t.btmBezierPoints,v=m[0],g=m[1],y=m[2],b=m[3],E=h<=r/2,x=pn({x:h,y:f},v,g,y,E?0:.5,E?.5:1,Math.max(30,Math.round(60*t.shape.upime.view.scale)),b).point;x&&(i.x=x.x+a,i.y=x.y+s)}}return i},t.getAdsorptionPoints=null,t.getAttachedProps=null,t.getConnectionPointAngle=function(e,t){var n=e.x,i=e.y,r=yn(n,0),o=yn(n,1);return r||o?r?0:Math.PI:i<.5?1.5*Math.PI:Math.PI/2},t}return P(t,e),t.prototype.getIPathData=function(){return[]},Object.defineProperty(t.prototype,"textRect",{get:function(){return exports.E({x:0,y:0},this.realSize)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topBezierPoints",{get:function(){var e=this.size.width,t=15*this.shape.scale;return[{x:0,y:t},{x:0,y:t-SD*t},{x:+e.toFixed(2),y:t-SD*t},{x:+e.toFixed(2),y:t}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"btmBezierPoints",{get:function(){var e=this.size,t=e.width,n=e.height,i=15*this.shape.scale;return[{x:0,y:n-i},{x:0,y:n-i+SD*i},{x:+t.toFixed(2),y:+(n-i+SD*i).toFixed(2)},{x:+t.toFixed(2),y:+(n-i).toFixed(2)}]},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size;return e.width*e.height},t}(FD),JD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ShapePathRenderFC=zD,t.getInsideOnside=function(e,n,i,r,o){var a=10*t.shape.scale,s=n.left,l=n.top,c=n.right,u=n.bottom,d=t.size.height,p=e.x,h=e.y,f=!1,m=!1,v=d-d/20-15*t.shape.scale;if(h>l+a&&h<u-(d-v))f=!0,m=p<=s+r||p>=c-r;else if(h<=l+a)if(p>s+a&&p<c-a)f=!0,m=h<=l+i;else{var g=fn({x:p,y:h},{x:p<=s+a?s+a:c-a,y:l+a});m=(f=g<=a+i)&&g>a-r}else if(p>=c)f=!0,m=p>=c-i;else{var y=t.getBezierPoints(t.size,{x:s,y:l}),b=y[0],E=y[1],x=y[2],w=y[3],C=y[4],S=st;S.save(),S.lineWidth=i,S.moveTo(b.x,b.y),S.quadraticCurveTo(E.x,E.y,x.x,x.y),S.quadraticCurveTo(w.x,w.y,C.x,C.y),S.lineTo(c,l+d/2),S.lineTo(s,l+d/2),S.closePath();var k=S.isPointInPath(p,h),_=ln(b,E,x,e),T=ln(x,w,C,e);(f=k||_<i||T<i)&&o&&(m=!k||k&&_<r&&T<r),st.restore()}return{inside:f,onside:m}},t.getAttachedPoint=function(e,n){var i=10*t.shape.scale,r={x:e.x,y:e.y};if(n){var o=t.borderBox,a=o.left,s=o.top,l=o.right,c=o.bottom,u=t.size.height,d=e.x,p=e.y,h=u-(u-u/20-15*t.shape.scale);if(d<=a&&p<c-h)r.x=a;else if(d>=l)r.x=l;else if(p<=s+i)if(d>=a+i&&d<=l-i)r.y=s;else{var f=d<a+i;r.y=s+i-Math.sqrt(Math.pow(i,2)-Math.pow(f?a+i-d:l-i-d,2))}else if(p>c-h){var m=t.getBezierPoints(t.size,{x:a,y:s}),v=m[0],g=m[1],y=m[2],b=m[3],E=m[4],x=pn({x:d,y:p},(f=d<(l+a)/2)?v:y,f?g:b,f?y:E,0,1,Math.max(30,Math.round(60*t.shape.upime.view.scale))).point;x&&(r.x=x.x,r.y=x.y)}}return r},t.getAdsorptionPoints=function(){var e=[],n=t.borderBox,i=n.left,r=n.top,o=n.bottom,a=t.size,s=a.width,l=a.height,c={x:i,y:r+t.size.height/2},u={x:i+t.size.width,y:r+t.size.height/2},d={x:i+s/2,y:r},p={x:i+s/2,y:o-(l/20+15*t.shape.scale)/2};return e.push(c,u,d,p),e},t.getAttachedProps=function(e,n){var i=t.borderBox,r=i.left,o=i.top,a=i.right,s=i.bottom,l=t.size,c=l.width,u=l.height,d={x:e.x,y:e.y};switch(n){case"l":d={x:r,y:e.y};break;case"t":d={x:e.x,y:o};break;case"r":d={x:a,y:e.y};break;case"b":d={x:e.x,y:s-(u/20+15*t.shape.scale)/2}}var p=(d.x-r)/c,h=(d.y-o)/u;return{attachedElementId:t.shape.id,attachedPointType:2,percentOffset:{x:p,y:h}}},t.getConnectionPointAngle=function(e,t){var n=e.x,i=e.y,r=yn(n,0),o=yn(n,1);return r||o?r?0:Math.PI:i<.5?1.5*Math.PI:Math.PI/2},t}return P(t,e),t.prototype.getBezierPoints=function(e,t){void 0===t&&(t={x:0,y:0});var n=e.width,i=e.height,r=i-i/20-15*this.shape.scale,o=i-r;return[{x:0+t.x,y:r+t.y},{x:n/4+t.x,y:r+3*o/2+t.y},{x:n/2+t.x,y:(r+i)/2+t.y},{x:n/4*3+t.x,y:r-o/2+t.y},{x:n+t.x,y:i+t.y}]},t.prototype.getIPathData=function(e){var t=e.width,n=this.getBezierPoints(e),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=10*this.shape.scale;return[["M",l,0],["R",0,0,0,l,l],["L",i.x,i.y],["Q",r.x,r.y,o.x,o.y],["Q",a.x,a.y,s.x,s.y],["L",t,l],["R",t,0,l,0,l],["Z"]]},Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.realSize,t=e.width,n=e.height;return{x:0,y:0,width:t,height:n-n/20-15}},enumerable:!1,configurable:!0}),t.prototype.getMetric=function(){var e=this.size;return e.width*e.height},t}(FD),$D=((DD={})[Ka.RECT]=jD,DD[Ka.TRIANGLE]=VD,DD[Ka.DIAMOND]=KD,DD[Ka.ELLIPSE]=YD,DD[Ka.PARALLELOGRAM]=GD,DD[Ka.ROUNDRECT]=qD,DD[Ka.BIG_RIGHT_ARROW]=XD,DD[Ka.BIG_LEFT_ARROW]=QD,DD[Ka.BARREL]=ZD,DD[Ka.DOCUMENT]=JD,DD),eR=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.renderer=OD,i._shape=Ka.RECT,i.editorType=LD,i.elementType=Za.SHAPE,i.hasBorder=!0,i.borderStyle=1,i.borderColor=1710618,i.borderThickness=2,i.borderOpacity=1,i.hasBg=!1,i.bgColor=0,i.bgOpacity=1,i.fontFamily=He,i.fontSize=14,i.lineHeight=Ue,i.lineHeightRate=1.36,i.ha="center",i.va="middle",i.textContent="",i.textColor=1710618,i.editing=!1,i.richTextClient=new yA(i),i.getAttachedPoint=function(t,n){var r,o,a;return null!==(a=null===(o=(r=i.shapeClient).getAttachedPoint)||void 0===o?void 0:o.call(r,t,n))&&void 0!==a?a:e.prototype.getAttachedPoint.call(i,t,n)},i.getAdsorptionPoints=function(){var t,n,r;return null!==(r=null===(n=(t=i.shapeClient).getAdsorptionPoints)||void 0===n?void 0:n.call(t))&&void 0!==r?r:e.prototype.getAdsorptionPoints.call(i)},i.getAttachedProps=function(t,n){var r,o,a;return null!==(a=null===(o=(r=i.shapeClient).getAttachedProps)||void 0===o?void 0:o.call(r,t,n))&&void 0!==a?a:e.prototype.getAttachedProps.call(i,t,n)},i.getConnectionPointAngle=function(t,n){var r,o,a;return rn((null!==(a=null===(o=(r=i.shapeClient).getConnectionPointAngle)||void 0===o?void 0:o.call(r,t,n))&&void 0!==a?a:e.prototype.getConnectionPointAngle.call(i,t,n))+(2===n?(360-90*((i.rotate+45)/90|0)%360)%360:(360-i.rotate)%360)*Math.PI/180)},i.shapeClient=new $D[i.shape](i),i}return P(t,e),Object.defineProperty(t.prototype,"shape",{get:function(){return this._shape},set:function(e){this._shape=e,this.shapeClient=new $D[this.shape](this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return this.richTextClient.chars.join("")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentHeight",{get:function(){return this.richTextClient.renderData.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this.textRect.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this.shapeClient.textRect,t=e.x,n=e.y,i=e.width,r=e.height,o=i>2*this.fontSize?Math.floor(i/this.fontSize)-2:0;o=Math.min(4,o);var a=r>this.lineHeight?2*Math.floor(r/this.lineHeight)-2:0;return{x:t+o,y:n+(a=Math.min(10,a)),width:Math.max(i-2*o,1),height:Math.max(r-2*a,1)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderWidth",{get:function(){return this.borderThickness},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transparent",{get:function(){return!(this.hasBg&&1===this.bgOpacity)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.dealUpdate=function(t){var n=GM(this,t);e.prototype.dealUpdate.call(this,n),(n.position||n.size||void 0!==n.rotate)&&this.updateBorderBox()},t.prototype.calcBorderBox=function(){return{left:this.position.x,top:this.position.y,right:this.position.x+this.size.width*this.scale,bottom:this.position.y+this.size.height*this.scale,rotate:this.rotate}},t.prototype.checkPointPosition=function(e,t,n,i){var r=!1,o=!1,a=this.getOuterInnerSensitivation(i,t,n),s=a.outerInsideSensitivation,l=a.innerOnsideSensitivation,c=this.getBorderBox();if(!Ot(e,{left:c.left-s,top:c.top-s,right:c.right+s,bottom:c.bottom+s}))return{onside:o,inside:r,onText:!1};var u=this.shapeClient.getInsideOnside(e,c,s,l,i);return{inside:r=u.inside,onside:o=u.onside,onText:!1}},t.prototype.bindRefSystem=function(t){e.prototype.bindRefSystem.call(this,t)},t}(oy),tR=function(){function e(e){var t=this;this.editor=e,this.propertyName="stickerTextFontSize",this.couldAffectGroup=!0,this.supportAuto=!0,this.sizeList=$e,this.minSize=$e[0],this.renderer=sN,this.changeValue=function(e){"auto"===e?t.editor.setAutoFontSize():t.editor.setFontSize(e)},this.renderKey=this.propertyName}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this.editor.maxSize},enumerable:!1,configurable:!0}),e.prototype.getValue=function(){return this.editor.getPropertyValue("autoFontSize")?"auto":this.editor.getPropertyValue("fontSize")},e}(),nR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="stickerBg",t.customizeColor=!1,t}return P(t,e),t.prototype.getBgColors=function(){return Ge.filter((function(e){return 1710618!==e}))},t}(Zb),iR=function(t){var n,i=t.value,r=t.changeValue,o=t.options,a=t.hint,s=t.noValueText,l=void 0===s?"":s,c=yh(!0),u=c.hide,d=c.setHide,p=c.toggleHide,h=c.skipRef,f=i&&(null===(n=o.find((function(e){return e.value==i})))||void 0===n?void 0:n.text)||l;return e.createElement("div",{className:j(Ml.cm_item,"simple_select_WLClr"),ref:h},a?e.createElement(Dl,{placement:"top",content:a},e.createElement("div",{className:Ml.cm_item},e.createElement(ul,{className:j(Ml.icon_box,"select_btn_label_c-nOI",vc),onClick:p,style:{padding:0}},f))):e.createElement(ul,{className:Ml.icon_box,onClick:p,style:{padding:0}},f),!u&&e.createElement(xh,{align:"center"},e.createElement("div",{className:pc,style:{padding:"10px 0"}},o.map((function(t){var n=t.value,i=t.text;return e.createElement("div",{key:n,className:j(Ml.cm_item,"option_item_3_4O5"),onClick:function(){return function(e){r(e),d(!0)}(n)}},e.createElement(ul,{className:Ml.icon_box},i))})))))},rR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="stickerScale",t.renderKey="stickerScale",t.renderer=oR,t}return P(t,e),t}(ay),oR=function(t){var n,i=t.propEditor,r=i.editor,o=i.element,a=W().getUpimeTrans,s=[{value:"S",text:a("sticker.size.s")},{value:"M",text:a("sticker.size.m")},{value:"L",text:a("sticker.size.l")}],l=null===(n=s.find((function(e){return tb[e.value]===o.scale})))||void 0===n?void 0:n.value,c=a("sticker.size.valueText");return e.createElement(iR,{value:l,changeValue:function(e){var t=tb[e];r.updateProperty({scale:t}),r.updateBorderBox()},options:s,noValueText:c,hint:a("sticker.size")})},aR=function(e){e.upime;var t=e.element,n=e.viewbox,i=t.borderRect,r=t.visiable,o=t.forbidTime,a=t.connectableLocations,s=t.currentLocation,l=t.frozed;if(r){var c=Ga(i,n),u=js.value.renderApp;if(fa({x:c.x,y:c.y,rotation:i.rotate,pivotX:c.x,pivotY:c.y}),qd({borderRect:i,viewbox:n,connectableLocations:a,currentLocation:s,frozed:l}),void 0!==o){var d=performance.now();d-o>250?t.forbidTime=void 0:(!function(e){var t=e.borderRect,n=e.viewbox,i=e.leftTime,r=n.left,o=n.top,a=n.scale,s=t.left,l=t.top,c=t.right,u=t.bottom,d=((s=(s-r)*a)+(c=(c-r)*a))/2,p=((l=(l-o)*a)+(u=(u-o)*a))/2,h=(c-s)/3,f=h*Math.SQRT1_2,m=h/3,v=i/250*.3;Ma((function(e){var t=e.context;if(t.lineWidth=m,v>0){t.globalAlpha=v,t.strokeStyle="#000000";var n=new Path2D;n.arc(d,p,h,0,2*Math.PI),n.moveTo(d-f,p-f),n.lineTo(d+f,p+f),t.stroke(n)}}))}({borderRect:i,viewbox:n,leftTime:250-d+o}),null==u||u(0,t.element))}ma(),t.group&&vs({group:t.group,viewbox:n})}},sR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.element,o=n.editor;return e.createElement(Dl,{placement:"top",content:i(r.showAuthor?"sticker.author.hide":"sticker.author.show")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:function(){o.updateProperty({showAuthor:!r.showAuthor})}},e.createElement(hl,{icon:r.showAuthor?"zuozhexianshi":"zuozheyincang"}))))},lR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="stickerAppend",t.renderer=sR,t.couldAffectGroup=!0,t}return P(t,e),t}(ay),cR=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.renderer=aR,r.domRenderer=qM,r.richContentEditor=n.richTextClient.contentEditor,r.editable&&!r.isHandMode&&(!t.phoneMode&&r.propertyEditors.push(new mA(r,n)),t.phoneMode&&r.propertyEditors.push(new nR(r,n)),r.propertyEditors.push(new tR(r),new tA(r),new sA(r,r.richContentEditor),new rR(r,n)),!t.phoneMode&&r.propertyEditors.push(new nR(r,n)),r.propertyEditors.push(new lR(r,n))),r}return P(t,e),Object.defineProperty(t.prototype,"autoDelete",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getMinSize=function(){return 20},t.prototype.forbidInput=function(){this.forbidTime=performance.now(),this.upime.updateView(),this.upime.addToast(O("sticker.forbid.input"),{type:"normal"})},Object.defineProperty(t.prototype,"maxSize",{get:function(){return this.element.richTextClient.maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showAuthor",{get:function(){return this.element.showAuthor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t);var n=t.scale,i=t.autoFontSize,r=t.bgColor,o=t.ha,a=t.va,s=t.fontSize,l=t.fontFamily;void 0===n&&void 0===i&&void 0===r&&void 0===o&&void 0===a&&void 0===s&&void 0===l||this.updateStickerStyle()},t.prototype.updateStickerStyle=function(){var e={scale:this.element.scale*this.element.globalTransform.currentScale,autoFontSize:this.element.autoFontSize,bgColor:this.element.bgColor,ha:this.element.ha,va:this.element.va,fontSize:this.element.fontSize,lineHeight:this.element.lineHeight,lineHeightRate:this.element.lineHeightRate,fontFamily:this.element.fontFamily};this.upime.setStickerStyle(e)},t.prototype.setAutoFontSize=function(){var e=this.element.richTextClient.calcMaxSize(this.element.richTextClient.chars),t=ib(e,this.element.lineHeightRate);this.updateProperty({fontSize:e,lineHeight:t,autoFontSize:!0})},t.prototype.setFontSize=function(e){var t={fontSize:e,lineHeight:ib(e,this.element.lineHeightRate)};this.element.autoFontSize&&(t.autoFontSize=!1),this.updateProperty(t)},t.prototype.checkSelectRelation=function(t,n){var i,r=e.prototype.checkSelectRelation.call(this,t,n),o=null===(i=null==r?void 0:r.metaData)||void 0===i?void 0:i.resizeData;if(o){var a=o.direction;"e"!==a&&"w"!==a||(o.skipAlign=!0)}return r},t.prototype.dealBorderResize=function(e,t,n){var i=t.left,r=t.top,o=t.right,a=o-i,s=i,l=r,c=this.element.position;if("e"===n||"w"===n){var u=this.element.globalTransform.applyInverse(e.position),d=this.element.globalTransform.applyInverse(e.prePosition),p=this.element.getBorderBox();o<=c.x&&i<=c.x?this.updateSelf({position:exports.E(exports.E({},c),{x:c.x-(p.right-p.left),y:c.y})}):i>=c.x+(p.right-p.left)&&o>=c.x+(p.right-p.left)&&this.updateSelf({position:exports.E(exports.E({},c),{x:c.x+(p.right-p.left),y:c.y})});var h=!1,f=u.x-d.x>0,m=u.x-d.x<0;if(f){var v=this.toRectSticker(t,u);h=h||v}if(m&&(v=this.toSquareSticker(t,u,d),h=h||v),h){var g=this.element.richTextClient.calcMaxSize(this.element.richTextClient.chars);if(g<this.element.fontSize||this.element.autoFontSize){var y=ib(g,this.element.lineHeightRate);this.updateSelf({fontSize:g,lineHeight:y,autoFontSize:!0})}}this.updateBorderBox()}else{var b=a/this.element.size.width;this.updateSelf({position:exports.E(exports.E({},c),{x:s,y:l}),scale:b})}this.updateStickerStyle()},t.prototype.toRectSticker=function(e,t){if(this.element.shape===eb.RECT)return!1;var n=this.element.getBorderBox(),i=e.right-n.right,r=this.upime.view.scale;if(this.commRefSystem&&(r*=this.commRefSystem.transformData.scaleX),i<16/r)return!1;var o=this.element.position,a=t.x>n.right?this.element.position:exports.E(exports.E({},o),{x:o.x-Ke.width*this.element.scale*.8,y:o.y});return this.updateSelf({shape:eb.RECT,position:a,size:{width:1.8*Ke.width,height:Ke.height},textSize:{width:Ze.width+.8*Ke.width,height:Ze.height}}),!0},t.prototype.toSquareSticker=function(e,t,n){if(this.element.shape===eb.SQUARE)return!1;var i=this.element.getBorderBox().right-e.right,r=this.upime.view.scale;if(this.commRefSystem&&(r*=this.commRefSystem.transformData.scaleX),i<16/r)return!1;var o=this.element.position,a=t.x<n.x?this.element.position:exports.E(exports.E({},o),{x:o.x+Ke.width*this.element.scale*.8,y:o.y});return this.updateSelf({shape:eb.SQUARE,position:a,size:{width:Ke.width,height:Ke.height},textSize:Ze}),!0},t.prototype.checkPointDirection=function(e,t,n){return Ut(e,t,n)},t.prototype.supportLinkTo=function(){return!0},t}(Ob),uR=tr($o("private_sticker_tag.png"));er(uR);var dR=tr("data:image/svg+xml,"+encodeURIComponent('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="#979797" d="M11.244 1.096a3 3 0 0 1 1.508 0l8.054 2.092c.705.204 1.202.84 1.194 1.563V15.01a1 1 0 0 1-.105.446l-.188.377c-.928 1.808-2.04 3.218-3.345 4.22-1.37 1.055-3.388 1.992-6.063 2.835a1 1 0 0 1-.496.027c-2.048-.407-4.045-1.365-5.987-2.862-1.972-1.52-3.238-3.095-3.768-4.749A1.003 1.003 0 0 1 2 14.998V4.771a1.626 1.626 0 0 1 1.18-1.58l8.064-2.095Zm1.005 1.935a1 1 0 0 0-.502 0L4 5.043v9.79l.028.076c.41 1.08 1.308 2.195 2.72 3.332l.29.228c1.707 1.316 3.424 2.14 5.155 2.484l-.245-.054.18-.057c2.112-.694 3.716-1.438 4.804-2.217l.211-.157c1.054-.81 1.984-1.99 2.78-3.538l.077-.157V5.045l-7.75-2.014Zm.09 3.402c1.578 0 2.496.926 2.496 2.457v1.096h.665a1 1 0 0 1 1 1v3.947a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-3.946a1 1 0 0 1 1-1h.616V8.89c0-1.53.93-2.457 2.51-2.457h.713Zm0 1.386h-.714c-.753 0-1.022.25-1.076.967l-.004.104v1.097h2.862V8.89c0-.73-.222-1.015-.96-1.068l-.108-.003Z" fill="#ffffff" fill-rule="nonzero"/></g></svg>'));er(dR);var pR=function(e){if(!e.hideForPrivate()){var t=e.scale,n=e.globalTransform,i=js.value,r=i.viewbox,o=i.exportType;if(n.currentScale*t*r.scale<.06&&"svg"!==o)return yf(e),function(e){var t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale,l=e.bgColor;Ma((function(e){var t=e.context,r=e.alpha;t.globalAlpha=.98*r,t.fillStyle=pr(l),t.fillRect(n,i,o*s,a*s)}))}(e),void ma();!function(e){var t=e.bgImg,n=js.value.exportType;if((null==t?void 0:t.loaded)||t&&"svg"===n){var i=e.position,r=e.size,o=e.textSize,a=e.userInfo,s=e.showAuthor,l=e.shape,c=e.textRect,u=e.scale,d=i.x,p=i.y,h=r.width*u,f=r.height*u,m=e.getBorderBox(),v=c.x*u,g=c.y*u;if(yf(e),fa({x:d,y:p,alpha:.98}),Oa({src:t,x:0-5*e.scale,y:0-5*e.scale,width:m.right-m.left+10*e.scale,height:(m.bottom-m.top-15*e.scale+10*e.scale)/.95}),e.isPrivate&&(fa({scaleX:e.scale,scaleY:e.scale}),Oa({src:uR,x:0,y:0,width:56,height:24}),Oa({src:dR,x:6,y:4,width:10,height:10}),Ra({text:O("sticker.private.tag"),fontSize:8,lineHeight:18,textWidth:40},{x:16,fill:"#ffffff",ha:"center"}),ma()),jy({x:v,y:g,maxHeight:o.height,element:e,richClient:e.richTextClient,isWheeling:e.upime.view.isWheeling}),s){var y=h-(118+8*(l===eb.RECT?1.8:1))*u,b=.98*f-28*u,E=e.useMemo("authorData",(function(){return{text:a.userName,fontFamily:He,fontSize:12,lineHeight:20,textWidth:118,lineClamp:1,textOverflow:"ellipse"}}),[a.userName]);fa({x:y,y:b,scaleX:u,scaleY:u}),Ra(E,{fill:"#303445",ha:"right"}),ma()}ma(),ma()}}(e)}},hR=function(e){function t(t){var n=e.call(this,t)||this;return n.element=t,n._maxSize=0,n}return P(t,e),Object.defineProperty(t.prototype,"maxSize",{get:function(){return this._maxSize||this.calcMaxSize(this.chars)},set:function(e){this._maxSize=e},enumerable:!1,configurable:!0}),t.prototype.calcMaxSize=function(e,t){return void 0===t&&(t={}),uA(this.element,e,t)},t.prototype.applyAction=function(e){var t=Wi(this.getCharsFromContent(this.content),this.element,this.element.wordWrapWidth).height,n=Is(this.content,e.opList),i=this.getCharsFromContent(n),r=this.element,o=r.fontSize,a=r.textSize,s=r.autoFontSize,l=r.lineHeightRate,c=this.currentEditor,u=Wi(i,this.element,this.element.wordWrapWidth).height,d=u>a.height?{maxSize:o-1}:{minSize:o},p=this.calcMaxSize(i,d);if(t<u&&u>a.height&&p===o)return c.forbidInput(),1;if(this.maxSize=p,this.content=n,this.chars=i,this.bufferNewAction(e),s||u>a.height){var h=this.maxSize;if(h!==o){var f={fontSize:h,lineHeight:ib(h,l)};return s||(f.autoFontSize=!0),c.updateSelf(f),this.syncBufferedOperation(),c.updateStickerStyle(),0}}return this.recordTextChange(),0},t}(yA),fR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=pR,t.elementType=Za.STICKER,t.showAuthor=!1,t.bgColor=qe,t.fontFamily=He,t.autoFontSize=!0,t.fontSize=64,t.lineHeight=87,t.lineHeightRate=1.36,t.ha="center",t.va="middle",t.textType=1,t.textContent="",t.textColor=1710618,t.textSize={width:0,height:0},t.shape=eb.SQUARE,t.isPrivate=!1,t.editorType=cR,t.editing=!1,t.richTextClient=new hR(t),t}return P(t,e),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this.textSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textRect",{get:function(){var e=this,t=e.size,n=e.textSize,i=e.showAuthor;return exports.E({x:(t.width-n.width)/2,y:(t.height-n.height)/2-(i?7:0)},n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportCopy",{get:function(){return!this.hideForPrivate()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userInfo",{get:function(){return this.upime.getElementInfo(this.id).creator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawText",{get:function(){return this.richTextClient.chars.join("")},enumerable:!1,configurable:!0}),t.prototype.dealUpdate=function(t){var n=GM(this,t);e.prototype.dealUpdate.call(this,n),void 0!==t.bgColor&&(this.bgImg=this.getBgSource(this.bgColor)),(n.position||n.size||void 0!==n.scale)&&this.updateBorderBox()},t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+(a+15)*s,rotate:this.rotate}},t.prototype.getBgSource=function(e){var n=this,i=t.bgSourceMap.get(e);return i||(er(i=tr(window.getUpime3StickerBackgroundImage(e)),(function(){n.upime.updateView()})),t.bgSourceMap.set(e,i)),i},t.prototype.hideForPrivate=function(){return this.isPrivate&&this.userInfo.loginName!==this.upime.localUserInfo.loginName},t.prototype.checkVisible=function(t){return!this.hideForPrivate()&&e.prototype.checkVisible.call(this,t)},t.prototype.checkUpdateView=function(t,n){return e.prototype.checkVisible.call(this,t)},t.prototype.checkSelectRelation=function(t,n){return this.hideForPrivate()?null:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.searchText=function(t){return this.hideForPrivate()?"":e.prototype.searchText.call(this,t)},t.bgSourceMap=new Map,t}(oy),mR=function(){function e(e,t,n,i){var r=this;this.table=e,this.cellProps=t,this.rIdx=n,this.cIdx=i,this.selfRefSystem=void 0,this.borderBox=Fe,this.initCellText=function(e,t,n){void 0===n&&(n=!0);var i=r.upime,o=r.table,a=o.rowWidths,s=o.id,l=r.upime.createOperation(),c={x:0,y:0,parentType:Za.TABLE,parentId:s,rowId:r.rId,columnId:r.cId},u={ha:r.ha,va:r.va,fontSize:r.fontSize,lineHeight:r.lineHeight,lineHeightRate:r.lineHeightRate,fontFamily:r.fontFamily},d=[],p=0;if(e){var h=a[r.cIdx];e=e.replace(/\r\n/g,"\n");var f=yi(e);if(r.boundCellText){var m=r.boundCellText,v=m.richTextClient,g=i.selectElement(m),y=r.upime.createLock([m.id]);return g.startEdit({lock:y,op:l}),void v.contentEditor.doOverwriteAll(e)}p=Wi(f,u,h).height;var b={color:r.color,highLight:r.highLight};d=[[yi(e),b]]}var E=exports.E(exports.E(exports.E({hasBg:!1,bgColor:0,bgOpacity:1},u),{position:c,size:{width:0,height:0},autoWidth:!1,zIndex:i.newMaxZindex(),richContent:{version:r.upime.genOtVersion(0),content:d}}),t),x=l.create(Za.GRID_TEXT,E),w=r.upime.createLock([x.id]);r.upime.clearSelect();var C=i.selectElement(x);C.currentOp=l,C.richContentEditor.setRichStyle({color:r.color,highLight:r.highLight}),p&&C.updateTableRowHeight(p,l),["bolder","italic","underLine","deleteLine"].filter((function(e){!1!==r[e]&&C.richContentEditor.setTextStyle(e,!!r[e])})),n?(C.startEdit({lock:w,op:l}),C.richContentEditor.moveCursorToEnd()):(r.upime.clearSelect(),r.upime.clearLock(w),r.table.setFocusedCells([r],r),r.upime.selectElement(r.table))},this.hasBg=t.hasBg,this.bgColor=t.bgColor,this.bgOpacity=t.bgOpacity,this.clusterId=t.clusterId,this.clusterRoot=t.clusterRoot,this.ha=t.ha,this.va=t.va,this.fontSize=t.fontSize,this.fontFamily=t.fontFamily,this.lineHeight=t.lineHeight,this.lineHeightRate=t.lineHeightRate||1.36,this.color=t.color,this.highLight=t.highLight,this.bolder=t.bolder,this.italic=t.italic,this.underLine=t.underLine,this.deleteLine=t.deleteLine,this.rId=t.rId,this.cId=t.cId}return Object.defineProperty(e.prototype,"boundCellText",{get:function(){var e;return null!==(e=this.upime.elementManager.getTableRS(this.table.id,this.rId,this.cId).children.find((function(e){return e instanceof ry&&e.elementType===Za.GRID_TEXT})))&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundCellEles",{get:function(){var e;return null!==(e=this.upime.elementManager.getTableRS(this.table.id,this.rId,this.cId).children.filter((function(e){return e instanceof ry&&e.elementType!==Za.GRID_TEXT})))&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellZIndex",{get:function(){return this.table.zIndex+1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upime",{get:function(){return this.table.upime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){var e=this.table;return{x:e.position.x+e.xOffsetArr[this.cIdx],y:e.position.y+e.yOffsetArr[this.rIdx]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var e=this.getBorderBox();return{width:e.right-e.left,height:e.bottom-e.top}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawTopBorder",{get:function(){var e;return!(0!==this.rIdx&&this.clusterId&&(null===(e=this.table.grids[this.rIdx-1][this.cIdx])||void 0===e?void 0:e.clusterId)===this.clusterId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawBottomBorder",{get:function(){return this.rIdx===this.table.rows-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawLeftBorder",{get:function(){var e;return!(0!==this.cIdx&&this.clusterId&&(null===(e=this.table.grids[this.rIdx][this.cIdx-1])||void 0===e?void 0:e.clusterId)===this.clusterId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawRightBorder",{get:function(){return this.cIdx===this.table.cols-1},enumerable:!1,configurable:!0}),e.prototype.findClusterRoot=function(){var e,t,n,i;if(this.clusterId&&this.clusterRoot)return this;if(!this.clusterId)return null;for(var r=this.cIdx;r>=0;){if(this.table.grids[this.rIdx][r].clusterRoot)return this.table.grids[this.rIdx][r];if((null===(e=this.table.grids[this.rIdx][r-1])||void 0===e?void 0:e.clusterId)!==this.clusterId)break;r--}for(var o=this.rIdx;o>=0;){if(null===(t=this.table.grids[o])||void 0===t?void 0:t[r].clusterRoot)return this.table.grids[o][r];if((null===(i=null===(n=this.table.grids[o-1])||void 0===n?void 0:n[r])||void 0===i?void 0:i.clusterId)!==this.clusterId)break;o--}return null},e.prototype.getBorderBox=function(){return this.borderBox},e.prototype.createDraftText=function(){var e={hasBg:!1,bgColor:0,bgOpacity:1,ha:this.ha,va:this.va,fontSize:this.fontSize,lineHeight:this.lineHeight,lineHeightRate:this.lineHeightRate,fontFamily:this.fontFamily,position:{parentId:this.table.id,parentType:Za.TABLE,rowId:this.rId,columnId:this.cId,x:0,y:0},size:{width:0,height:0},autoWidth:!1,zIndex:this.upime.newMaxZindex(),richContent:{version:this.upime.genOtVersion(0),content:[]}},t=this.upime.elementManager.genElement(Za.GRID_TEXT,"".concat(Date.now()));return t.draft=!0,t.dealUpdate(e),this.draftText=t,t},e.prototype.clearDraftText=function(){this.draftText=void 0},e}(),vR=function(e){var t=e.element,n=e.viewbox;if(!t.hide){var i=n.left,r=n.top,o=n.scale,a=t.borderBox,s=t.currentLocation;t.hide,Na((function(e){var t=a.left,n=a.top,l=a.right,c=a.bottom,u=(t-i)*o,d=(n-r)*o,p=(l-t)*o,h=(c-n)*o;function f(t,n,i){e.lineStyle(),i===s?e.beginFill(3691769):e.beginFill(0,.1),e.drawCircle(t,n,16),e.endFill(),e.lineStyle({width:2,color:16777215}),e.moveTo(t,n-8),e.lineTo(t,n+8),e.moveTo(t-8,n),e.lineTo(t+8,n)}e.clear(),f(u+p+32,d+h/2,"r"),f(u+p/2,d+h+32,"b")}))}},gR=function(){function e(e,t){this.upime=e,this.element=t,this.renderer=vR,this.currentLocation="",this.renderKey="table-bot-right-ctrl-widget-".concat(t.id),this.borderBox=t.getBorderBox()}return Object.defineProperty(e.prototype,"hide",{get:function(){return this.element.editingName},enumerable:!1,configurable:!0}),e.prototype.updateBox=function(){this.borderBox=this.element.getBorderBox(),this.upime.updateView()},e.prototype.setCurrentLocation=function(e){var t=this.currentLocation;this.currentLocation=e,t!==e&&this.upime.updateView()},e}(),yR=function(e){var t=e.element,n=e.viewbox;if(!t.hide){var i=n.left,r=n.top,o=n.scale,a=t.showAll,s=t.row,l=t.col,c=t.table,u=t.borderBox,d=t.curBtn,p=t.dragging,h=t.rowBoxes,f=t.colBoxes,m=t.xOffset,v=t.yOffset,g=t.targetR,y=t.targetC,b=c.rowWidths,E=c.rowHeights,x=c.xOffsetArr,w=c.yOffsetArr,C=c.scale,S=u.left,k=u.top,_=(S-i)*o,T=(k-r)*o,I=t.useMemo("draggingBox",(function(){return null!==s&&h.length?Yt(h):null!==l&&f.length?Yt(f):null}),[t.colBoxes,t.rowBoxes,t.row,t.col,t.dragging]);a&&Na((function(e){if(null!==s||null!==l){e.clear();var t=function(t,n,i){e.lineStyle(),i?e.beginFill(3691769):e.beginFill(0,.1),e.drawCircle(t,n,8),e.endFill(),e.lineStyle({width:1,color:16777215}),e.moveTo(t,n-4),e.lineTo(t,n+4),e.moveTo(t-4,n),e.lineTo(t+4,n)};if(null!==s){var n=_-30+8,i=T+w[s]*o;t(n,i,1===d),t(n,i+E[s]*C*o,2===d)}if(null!==l){var r=T-30+8,a=_+x[l]*o;t(a,r,1===d),t(a+b[l]*C*o,r,2===d)}}})),Na((function(e){if(null!==s||null!==l){if(e.clear(),null!==s){3===d||p?(e.beginFill(3691769),e.lineStyle({color:3691769,width:.1})):(e.beginFill(0,.1),e.lineStyle({color:0,width:.1,alpha:.1}));var t=T+w[s]*o+E[s]*C*o/2+(v||0)*o,n=_-30;e.moveTo(n,t-8),e.arcTo(n,t-16,n+8,t-16,8),e.arcTo(n+16,t-16,n+16,t-8,8),e.lineTo(n+16,t+8),e.arcTo(n+16,t+16,n+8,t+16,8),e.arcTo(n,t+16,n,t+8,8),e.lineTo(n,t-8),e.closePath(),e.endFill(),e.beginFill(16777215),e.drawCircle(n+8,t,2),e.drawCircle(n+8,t-8,2),e.drawCircle(n+8,t+8,2),e.endFill()}if(null!==l){3===d||p?(e.beginFill(3691769),e.lineStyle({color:3691769,width:.1})):(e.beginFill(0,.1),e.lineStyle({color:0,width:.1,alpha:.1}));var i=_+x[l]*o+b[l]*C*o/2+(m||0)*o,r=T-30;e.moveTo(i+8,r),e.arcTo(i+16,r,i+16,r+8,8),e.arcTo(i+16,r+16,i+8,r+16,8),e.lineTo(i-8,r+16),e.arcTo(i-16,r+16,i-16,r+8,8),e.arcTo(i-16,r,i-8,r,8),e.lineTo(i+8,r),e.closePath(),e.endFill(),e.beginFill(16777215),e.drawCircle(i,r+8,2),e.drawCircle(i-8,r+8,2),e.drawCircle(i+8,r+8,2),e.endFill()}}})),(3===d||p)&&Na((function(e){e.clear(),e.lineStyle({width:1.5,color:3044325});var t=null!==s?h:null!==l?f:[],n=null!==l?m:0,a=null!==s?v:0;if(p&&I?(e.beginFill(0,.3),e.drawRect((I.left-i+n)*o,(I.top-r+a)*o,(I.right-I.left)*o,(I.bottom-I.top)*o),e.endFill()):t.forEach((function(t){var s=t.right-t.left,l=t.bottom-t.top;e.drawRect((t.left-i+n)*o,(t.top-r+a)*o,s*o,l*o)})),null!==g&&null!==s){var u=_,d=T+(g===c.rows?c.size.height*c.scale:w[g])*o-1.5;e.drawRect(u,d,c.size.width*c.scale*o,1.5)}null!==y&&null!==l&&(d=T,u=_+(y===c.cols?c.size.width*c.scale:x[y])*o-1.5,e.drawRect(u,d,1.5,c.size.height*c.scale*o))})),p&&Na((function(e){if(e.clear(),e.lineStyle({width:2,color:790564}),null!==s){var t=T+w[s]*o+E[s]*C*o/2+v*o;e.moveTo(_-30,t-24),e.lineTo(_-22,t-32),e.lineTo(_-14,t-24),e.moveTo(_-30,t+24),e.lineTo(_-22,t+32),e.lineTo(_-14,t+24)}else if(null!==l){var n=_+x[l]*o+b[l]*C*o/2+m*o;e.moveTo(n-24,T-30),e.lineTo(n-32,T-22),e.lineTo(n-24,T-14),e.moveTo(n+24,T-30),e.lineTo(n+32,T-22),e.lineTo(n+24,T-14)}}))}},bR=function(e){function t(t,n,i,r,o){var a=e.call(this)||this;return a.upime=t,a.table=n,a.showAll=i,a.renderer=yR,a.row=null,a.col=null,a.draggingRows=[],a.draggingCols=[],a.dragging=!1,a.curBtn=0,a.rowBoxes=[],a.colBoxes=[],a.xOffset=0,a.yOffset=0,a.targetR=null,a.targetC=null,a.renderKey="table-top-left-ctrl-widget-".concat(Date.now()),a.borderBox=n.getBorderBox(),void 0!==r&&(a.row=r,a._updateRowBoxes()),void 0!==o&&(a.col=o,a._updateColBoxes()),a}return P(t,e),Object.defineProperty(t.prototype,"hide",{get:function(){return this.table.editingName},enumerable:!1,configurable:!0}),t.prototype.updateRow=function(e){this.col=null,this.row=e,this._updateRowBoxes(),this.upime.updateView()},t.prototype.updateCol=function(e){this.row=null,this.col=e,this._updateColBoxes(),this.upime.updateView()},t.prototype.updateDragging=function(e){this.dragging=e,this.upime.updateView()},t.prototype.updateShowAll=function(e){this.showAll=e,this.upime.updateView()},t.prototype.updateBox=function(){this.borderBox=this.table.getBorderBox(),this.upime.updateView()},t.prototype.updateHighlightBtn=function(e){this.curBtn=e,this.upime.updateView()},t.prototype._updateRowBoxes=function(){var e=this;if(null!==this.row){var t=[];(this.dragging?this.draggingRows:[this.row]).forEach((function(n){var i=e.table.grids[n],r=[];i.forEach((function(e){e.clusterId&&r.includes(e.clusterId)||(t.push(e.getBorderBox()),e.clusterId&&r.push(e.clusterId))}))})),this.rowBoxes=t}},t.prototype._updateColBoxes=function(){var e=this;if(null!==this.col){var t=[];(this.dragging?this.draggingCols:[this.col]).forEach((function(n){var i=[];e.table.grids.forEach((function(e){var r=e[n];r.clusterId&&i.includes(r.clusterId)||(t.push(r.getBorderBox()),r.clusterId&&i.push(r.clusterId))}))})),this.colBoxes=t}},t.prototype.updateTargetR=function(e){this.targetR=e,this.targetC=null},t.prototype.updateTargetC=function(e){this.targetR=null,this.targetC=e},t.prototype.updateXOffset=function(e){this.xOffset=e},t.prototype.updateYOffset=function(e){this.yOffset=e},t}(el),ER="iconCon_yTWp9",xR="divider_3HmGG",wR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.editor,o=e.useMemo((function(){return!(r.couldMergeCells||r.couldUnMergeCells)}),[r.couldMergeCells,r.couldUnMergeCells]);return e.createElement(Dl,{placement:"top",content:i(r.couldUnMergeCells?"table.unmerge.cell":"table.merge.cell")},e.createElement("div",{className:j(Ml.cm_item,o&&Ml.disabled)},e.createElement("div",{className:ER,onClick:function(){r.couldUnMergeCells?r.unMergeCells():r.mergeCells()}},e.createElement(hl,{icon:r.couldUnMergeCells?"chaifendanyuange":"hebingdanyuange"}))))},CR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=n.editor;return e.createElement(Dl,{placement:"top",content:i(r.couldDeleteRow?"table.delete.row":"table.delete.col")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:ER,onClick:function(){r.couldDeleteRow?r.removeFullRows():r.couldDeleteCol&&r.removeFullCols()}},e.createElement(hl,{icon:"shanchu"}))))},SR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.editor,l=n.element,c=e.useCallback((function(e){if(null!==e){var t={meshColor:e};s.updateProperty(t)}o&&h(!0)}),[]),u={};o&&(u.checkSkip=function(e){return!!a.current&&V(a.current,e)});var d=yh(!0,u),p=d.hide,h=d.setHide,f=d.toggleHide,m=d.skipRef,v=o?Xg:xh;return e.createElement("div",{ref:m,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("element.borderStyle")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:ER,onClick:f},e.createElement(jb,{color:l.meshColor,opacity:1})))),!p&&e.createElement(v,{align:"center",selfAdjust:!0},e.createElement(Yb,{colorPalettes:n.getBorderColors(),defaultValue:l.meshColor,onChanged:c,colorPickerConfig:{onColorPickerChange:function(e,t){s.slideUpdateProperty({borderColor:e},t,!0)}}})))},kR=function(t){var n=t.propEditor,i=n.element,r=n.editor;return e.createElement(e.Fragment,null,!i.focusingCell&&e.createElement(SR,{propEditor:n}),e.createElement(Qb,{propEditor:n}),i.focusedCells.length>1&&e.createElement(e.Fragment,null,e.createElement("div",{className:xR}),e.createElement(wR,{propEditor:n})),(r.couldDeleteRow||r.couldDeleteCol)&&e.createElement(e.Fragment,null,e.createElement("div",{className:xR}),e.createElement(CR,{propEditor:n})," "))},_R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="tableStyle",t.renderer=kR,t.couldAffectGroup=!1,t.customizeColor=!0,t}return P(t,e),Object.defineProperty(t.prototype,"curBgColor",{get:function(){return this.element.focusingCell?this.element.focusedCells[0].bgColor:this.element.bgColor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"curBgOpacity",{get:function(){return this.element.focusingCell?this.element.focusedCells[0].bgOpacity:this.element.bgColor},enumerable:!1,configurable:!0}),t.prototype.getBgColors=function(){return this.editor.upime.userManager.userPalette},t.prototype.getBorderColors=function(){return this.editor.upime.userManager.userPalette},t}(ay),TR=function(t){var n=t.propEditor,i=W().getUpimeTrans;return e.createElement(e.Fragment,null,e.createElement(Dl,{placement:"top",content:i("table.insert.row")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:ER,onClick:function(){n.insertNewRow()}},e.createElement(hl,{icon:"xiafangcharuhang"})))),e.createElement(Dl,{placement:"top",content:i("table.insert.col")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:ER,onClick:function(){n.insertNewCol()}},e.createElement(hl,{icon:"youfangcharulie"})))))},IR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="tableAddRowCol",t.renderer=TR,t.couldAffectGroup=!1,t.customizeColor=!0,t.insertNewRow=function(){if(t.element.focusingCell){var e=0;t.element.focusedCells.forEach((function(t){e=Math.max(t.rIdx,e)})),t.element.insertNewRowAt(e+1)}else t.element.insertNewRowAt(t.element.rows)},t.insertNewCol=function(){if(t.element.focusingCell){var e=0;t.element.focusedCells.forEach((function(t){e=Math.max(t.cIdx,e)})),t.element.insertNewColAt(e+1)}else t.element.insertNewColAt(t.element.cols)},t}return P(t,e),t}(ay),PR={bolder:"wenzijiacu",italic:"wenziqingxie",underLine:"xiahuaxian",deleteLine:"shanchuxian",style:"wenbenyangshi"},NR=function(t){var n=t.type,i=PR[n];return e.createElement(ul,{className:jr},e.createElement(hl,{icon:i}))},MR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(Ic),o=r.phoneLayout,a=r.phoneElementSubBarContainer,s=n.element,l=n.colorPalettes,c=s.color,u={};o&&(u.checkSkip=function(e){return!!a.current&&V(a.current,e)});var d=yh(!0,u),p=d.hide,h=d.toggleHide,f=d.skipRef,m=d.setHide,v=o?Xg:xh;return e.createElement("div",{className:Ar,ref:f,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.color")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:h},e.createElement(Gb,{color:c})))),!p&&e.createElement(v,{align:"center",selfAdjust:!0},e.createElement(Yb,{colorPalettes:l,defaultValue:c,onChanged:function(e){m(!0),n.setRichStyle({color:e})},colorPickerConfig:{onColorPickerChange:function(e,t){n.slideSetRichStyle({color:e},t)}}})))},AR=function(t){var n,i=t.propEditor,r=W().getUpimeTrans,o=e.useContext(Ic),a=o.phoneLayout,s=o.phoneElementSubBarContainer,l=i.element,c=i.colorPalettes,u=null!==(n=l.highLight)&&void 0!==n?n:null,d={};a&&(d.checkSkip=function(e){return!!s.current&&V(s.current,e)});var p=yh(!0,d),h=p.hide,f=p.toggleHide,m=p.skipRef,v=p.setHide,g=a?Xg:xh;return e.createElement("div",{className:Ar,ref:m,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:r("text.highLight")},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Mr,onClick:f},e.createElement(Gb,{color:u,icon:"highLight"})))),!h&&e.createElement(g,{align:"center",selfAdjust:!0},e.createElement(Yb,{enableTransparent:!0,colorPalettes:c,defaultValue:u,onChanged:function(e){v(!0),i.setRichStyle({highLight:e})},colorPickerConfig:{onColorPickerChange:function(e,t){i.slideSetRichStyle({highLight:e},t)}}})))},DR=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=yh(!0),o=r.hide,a=r.setHide,s=r.toggleHide,l=r.skipRef;return e.createElement("div",{className:Ar,ref:l,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.style"),rootClass:Ml.cm_item},e.createElement("div",{className:Ml.icon_box,onClick:s},e.createElement(NR,{type:"style"}))),!o&&e.createElement(xh,{align:"center"},e.createElement("div",{className:Gr},["bolder","italic","underLine","deleteLine"].map((function(t){return e.createElement("div",{key:t+"",className:Ml.cm_item,onClick:function(){return e=t,n.setTextStyle(e),void a(!0);var e}},e.createElement("div",{className:j(Ml.icon_box)},e.createElement(NR,{type:t})))})))))},RR=function(t){var n=t.propEditor;return e.createElement(e.Fragment,null,e.createElement(DR,{propEditor:n}),e.createElement(MR,{propEditor:n}),e.createElement(AR,{propEditor:n}))},BR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="tableTextStyle",t.couldAffectGroup=!1,t.renderer=RR,t.curOp=null,t.curLock=null,t}return P(t,e),Object.defineProperty(t.prototype,"colorPalettes",{get:function(){return this.editor.upime.userManager.userPalette},enumerable:!1,configurable:!0}),t.prototype.setTextStyle=function(e){var t;this.editor.updateProperty(((t={})[e]=!this.element[e],t))},t.prototype.setRichStyle=function(e){this.editor.updateProperty(e)},t.prototype.slideSetRichStyle=function(e,t){this.editor.slideUpdateProperty(e,t)},t}(ay),LR=function(e,t){this.upime=e,this.editor=t,this.renderer=OR,this.renderKey="".concat(t.element.id,"_editing_name")},OR=function(t){var n=t.element,i=t.upime,r=t.viewbox,o=n.editor,a=r.scale,s=e.useRef(null);e.useEffect((function(){if(s.current){var e=s.current,t=e.parentElement;e.style.maxWidth="".concat((t.clientWidth-e.offsetLeft)/a,"px");var n=o.bindSimpleText(e),r=i.view.subscribe("viewboxChange",(function(){e.style.maxWidth="".concat((t.clientWidth-e.offsetLeft)/a,"px")}));return function(){n(),r()}}}),[]);var l=o.element,c=l.name,u=l.position,d=(u.x-i.view.x)*a,p=(u.y-i.view.y)*a,h=e.useMemo((function(){return{fontSize:"14px",textAlign:"left",color:"#0C1024",lineHeight:"20px",fontFamily:He,transform:"scale(".concat(a,")"),top:"".concat(p-26*a,"px"),left:"".concat(d,"px"),height:20}}),[d,p,a]);return e.createElement("input",{ref:s,className:Wr,defaultValue:c,style:h,spellCheck:"false",draggable:"false",onKeyUp:function(e){return e.stopPropagation()}})},FR=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r._lock=null,r._unsubs=[],r._renaming=!1,r.multiResizeDirection=["e","s","n","w","nw","ne","sw","se"],r._editNameWidget=null,r.supportLinkTo=function(){return!0},r._newName="",r._tempInput=null,r.bindSimpleText=function(e){r._nameInput=e;var t=r._tempInput=document.createElement("input");t.style.fontSize="14px",t.style.lineHeight="20px",t.style.width="0px",t.style.height="20px",t.style.fontFamily=He,t.className=Vr,document.body.appendChild(t),_e.desktop&&e.focus(),r._newName=e.value,r._renaming&&(e.select(),r._renaming=!1);var n=function(){var t=r._tempInput;t.value=e.value;var n=t.scrollWidth;e.style.width=n+8+"px"};n();var i=function(){n(),r._newName=e.value},o=function(t){t.defaultPrevented||t.isComposing||"Enter"!==t.key&&13!==t.keyCode||(e.blur(),t.preventDefault(),r.element.editingName=!1,r.updateProperty({name:e.value}),r._newName="",r._editNameWidget&&(r.upime.view.removeDomWidget(r._editNameWidget),r.element.editingName=!1,r._editNameWidget=null,r.visiable=!0,r.upime.updateView()))};return e.addEventListener("keydown",o),e.addEventListener("input",i),function(){e.removeEventListener("input",i),e.removeEventListener("keydown",o)}},r.handleTabKey=function(e){if(r.element.focusingCell){var t=r.element.grids.flat(),n=r.element.tabBaseCell,i=n&&t.includes(n)?n:r.element.topLeftFocusedCell;e.stopPropagation(),e.preventDefault();var o=t.findIndex((function(e){return e===i})),a=t.slice(o+1).find((function(e){return!i.clusterId||e.clusterId!==i.clusterId}))||t[0],s=r.element.getCellsGroup(a);r.element.setFocusedCells(s,s[0]),r.element.tabBaseCell=a,r.connectTextEditor(),r.upime.updateView()}},r.editable&&!r.isHandMode&&r.propertyEditors.push(new IR(r,n),new _R(r,n),new xA(r),new tA(r),new BR(r,n)),r}return P(t,e),Object.defineProperty(t.prototype,"couldAddComment",{get:function(){return this.element.focusingCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dealArrowKeyInternally",{get:function(){return this.element.focusingCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"editingCell",{get:function(){return this.element.focusingCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hideConnectableEditorRect",{get:function(){return this.element.focusingCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportFullCommonOp",{get:function(){return!this.element.focusingCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportMoreCtrl",{get:function(){return!this.element.focusingCell},enumerable:!1,configurable:!0}),t.prototype.doRename=function(){this._nameInput?this._nameInput.select():(this.element.editingName=!0,this._editNameWidget=new LR(this.upime,this),this.upime.view.addDomWidget(this._editNameWidget),this._renaming=!0,this.upime.updateView())},t.prototype.dealInternalArrowKeyDown=function(e,t){if(this.element.focusingCell){var n,i=t.originEvent,r=i.ctrlKey,o=i.metaKey,a=null,s=this.element.grids.flat(),l=this.element.tabBaseCell,c=l&&s.includes(l)?l:this.element.topLeftFocusedCell,u=this.element,d=u.rows,p=u.cols,h=u.grids,f=c.rIdx,m=c.cIdx;if(r||o)switch(e){case"ArrowUp":f=0;break;case"ArrowDown":f=d-1;break;case"ArrowLeft":m=0;break;case"ArrowRight":m=p-1}else switch(e){case"ArrowUp":if(c.clusterId){for(;f>=0&&h[f][m].clusterId===c.clusterId;)f--;f=Math.max(0,f)}else f=Math.max(0,f-1);break;case"ArrowDown":if(c.clusterId){for(;f<=d-1&&h[f][m].clusterId===c.clusterId;)f++;f=Math.min(d-1,f)}else f=Math.min(d-1,f+1);break;case"ArrowLeft":if(c.clusterId){for(;m>=0&&h[f][m].clusterId===c.clusterId;)m--;m=Math.max(0,m)}else m=Math.max(0,m-1);break;case"ArrowRight":if(c.clusterId){for(;m<=p-1&&h[f][m].clusterId===c.clusterId;)m++;m=Math.min(p-1,m)}else m=Math.min(p-1,m+1)}var v=h[f][m];if(a=(n=this.element.getCellsGroup(v))[0]){var g=null==a?void 0:a.getBorderBox(),y=this.upime.view.getViewbox();if(!qt(g,y)){var b=y.right-y.left,E=y.bottom-y.top,x=g.left+(g.right-g.left)/2,w=g.top+(g.bottom-g.top)/2;this.upime.slideViewTo(x-b/2,w-E/2,this.upime.view.scale,300)}}this.element.setFocusedCells(n,n[0]),this.element.tabBaseCell=v,this.connectTextEditor(),this.upime.updateView()}},t.prototype._amplifyUpdate=function(e){var t=exports.E({},e),n=["hasBg","bgColor","bgOpacity","va","ha","fontSize","lineHeight","color","highLight","bolder","italic","underLine","deleteLine"];if(pe(e,n)){var i=this.element.cells.map((function(t){return exports.E(exports.E({},exports.E({},t)),he(e,n))}));t.cells=i,Object.assign(t,this.getCellRelationProp())}return t},t.prototype._makeCellsUpdate=function(e){for(var t=R([],this.element.cells,!0),n=this.element.cols,i=0,r=this.element.focusedCells;i<r.length;i++){var o=r[i],a=o.rIdx*n+o.cIdx;t[a]=exports.E(exports.E({},t[a]),e)}return exports.E({cells:t},this.getCellRelationProp())},t.prototype._addressTextPropUpdate=function(e,t,n,i){var r=this;if(void 0===n&&(n=!0),void 0===i&&(i=!0),t&&pe(e,["color","highLight","bolder","italic","underLine","deleteLine","fontSize","va","ha","lineHeight"])){var o=(this.element.focusingCell?this.element.focusedCells:this.element.grids.flat()).reduce((function(e,t){return t.boundCellText?R(R([],e,!0),[t.boundCellText],!1):e}),[]),a="",s=!1,l=["bolder","italic","underLine","deleteLine"];for(var c in l)void 0!==e[l[c]]&&(a=l[c],s=e[l[c]]);var u=[],d=he(e,["color","highLight"]),p=he(e,["fontSize","va","ha","lineHeight"]);o.forEach((function(e){e.unavailable||(n&&(e.currentEditor=new e.editorType(r.upime,e),e.currentEditor.currentOp=t),u.push(e),Object.keys(d).length&&e.richTextClient.contentEditor.setRichStyle(d),a&&e.richTextClient.contentEditor.setTextStyle(a,s),Object.keys(p).length&&t.update(e,p))})),i&&u.forEach((function(e){return e.currentEditor=void 0}))}},t.prototype.updateProperty=function(e){var t,n=this.getOp(),i=this.element.focusingCell?this._makeCellsUpdate(e):this._amplifyUpdate(e),r=this.upime.createLock([this.element.id]);n.update(this.element,i),this._addressTextPropUpdate(e,n),null===(t=this.manager)||void 0===t||t.updateBorderBox(),n.sync(),this.upime.clearLock(r),this.currentOp=void 0},t.prototype.slideUpdateProperty=function(e,t){var n,i,r=t.isStart,o=t.isEnd;r&&(this._lock=this.upime.createLock([this.element.id]),this.currentOp=this.upime.createOperation());var a=this.element.focusingCell?this._makeCellsUpdate(e):this._amplifyUpdate(e);null===(n=this.currentOp)||void 0===n||n.update(this.element,a),this._addressTextPropUpdate(e,this.currentOp,r,o),o&&(null===(i=this.currentOp)||void 0===i||i.sync(),this._lock&&this.upime.clearLock(this._lock),this._lock=null,this.currentOp=void 0)},t.prototype.checkSelectRelation=function(e,t){if("click"===(null==t?void 0:t.type)&&"right"===t.evt.connectType)return null;if(this.element.focusingCell){var n=this.element.fixedTopLeftWidget;if("click"===(null==t?void 0:t.type)&&n){if(null!==n.row&&this.element.checkOnTLSortBtn(e,n.row,!0))return t.evt.originEvent.ctrlKey||t.evt.originEvent.metaKey?null:{transparent:!1,metric:-1,metaData:{tableCtrlData:{rowAction:{onSortBtn:!0,r:n.row,showAll:!1,onTopAdd:!1,onBotAdd:!1}}}};if(null!==n.col&&this.element.checkOnTLSortBtn(e,n.col,!1))return t.evt.originEvent.ctrlKey||t.evt.originEvent.metaKey?null:{transparent:!1,metric:-1,metaData:{tableCtrlData:{colAction:{onSortBtn:!0,c:n.col,showAll:!1,onLeftAdd:!1,onRightAdd:!1}}}}}if("click"===(null==t?void 0:t.type)&&(t.evt.originEvent.shiftKey||t.evt.originEvent.metaKey||t.evt.originEvent.ctrlKey)||"click"!==(null==t?void 0:t.type))return null;var i=this.element.getCellIdxByPoint(e);if(!i)return null;var r=i.r,o=i.c,a=this.element.getCellsGroup(this.element.grids[r][o]);return this.element.checkCouldEditCell(a)?{transparent:!0,metric:-1}:null}var s=8/this.upime.view.scale,l=this.getBorderBox();if(Ot(e,l,s)){var c=this.checkPointDirection(e,l,s),u={transparent:this.enableTransparentInBox,metric:-1};return c?(u.metaData={resizeData:{direction:c,originBorder:l}},u.transparent=!1,u):null!==this.element.checkResizeColMeta(e)||null!==this.element.checkResizeRowMeta(e)?null:{transparent:!0,metric:-1}}return"click"===(null==t?void 0:t.type)&&this.element.checkClickName(e)?{transparent:!1,metric:-1,metaData:{clickData:{clickEleName:!0}}}:null},t.prototype.getBorderBox=function(){var e=this.element,t=e.focusedCells;if(!e.focusingCell)return this.element.getBorderBox();var n=t.filter((function(e){return!e.clusterId||e.clusterRoot}));return Yt(n.map((function(e){return e.getBorderBox()})))},t.prototype.connectTextEditor=function(){if(this.onRemoveNameInput(),!this.frozed){var e=this.element,t=e.focusingCell,n=e.focusedCells;if(t)if(1===n.length||this.couldUnMergeCells){var i=this.element.topLeftFocusedCell,r=i.boundCellText||i.draftText;if(r)!r.unavailable&&this.upime.view.setConnectedRichEditor(r.richTextClient.contentEditor);else{var o=i.createDraftText();this.upime.view.setConnectedRichEditor(o.richTextClient.contentEditor)}}else this.upime.view.clearConnectedRichEditor();else this.upime.view.clearConnectedRichEditor()}},t.prototype.select=function(){var t=this;e.prototype.select.call(this),this._unsubs=[this.upime.registerHotKey({key:"Tab",connected:!1},(function(e){return t.handleTabKey(e.originEvent)}))],_e.desktop||!this.upime.editable||this.element.focusingCell||(this.element.editingName=!0,this._editNameWidget=new LR(this.upime,this),this.upime.view.addDomWidget(this._editNameWidget))},t.prototype.onRemoveNameInput=function(){this._editNameWidget&&(this.upime.view.removeDomWidget(this._editNameWidget),this._editNameWidget=null,this._newName!==this.element.name&&(e.prototype.updateProperty.call(this,{name:this._newName}),this._newName="")),this._tempInput&&(document.body.removeChild(this._tempInput),this._tempInput=null),this.element.editingName=!1},t.prototype.unselect=function(){this.onRemoveNameInput(),this.element.clearFocusedCells(),this._unsubs.forEach((function(e){return e()})),e.prototype.unselect.call(this),this.upime.updateView()},Object.defineProperty(t.prototype,"couldMergeCells",{get:function(){if(!this.element.focusedCells||1===this.element.focusedCells.length)return!1;for(var e=this.element,t=e.focusedCells,n=e.rows-1,i=0,r=e.cols-1,o=0,a=0,s=t;a<s.length;a++){var l=s[a];n=Math.min(n,l.rIdx),i=Math.max(i,l.rIdx),r=Math.min(r,l.cIdx),o=Math.max(o,l.cIdx)}for(var c=function(e){for(var n=function(n){if(!t.find((function(t){return t.rIdx===e&&t.cIdx===n})))return{value:!1}},i=r;i<=o;i++){var a=n(i);if("object"==typeof a)return a}},u=n;u<=i;u++){var d=c(u);if("object"==typeof d)return d.value}return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"couldUnMergeCells",{get:function(){var e=this.element,t=e.focusedCells,n=e.cells;if(!e.focusingCell||1===t.length)return!1;for(var i="",r=0,o=t;r<o.length;r++){var a=o[r];if(!a.clusterId)return!1;if(""===i&&(i=a.clusterId),i!==a.clusterId)return!1}var s=n.filter((function(e){return e.clusterId===i})).length;return t.length===s},enumerable:!1,configurable:!0}),t.prototype.mergeCells=function(){if(this.element.focusingCell&&1!==this.element.focusedCells.length&&this.couldMergeCells)if(this.element.checkCouldUpdateCells(this.element.focusedCells)){var e=ia(),t=this.element,n=t.focusedCells,i=t.cells,r=t.cols,o=this.element.topLeftFocusedCell,a=R([],i.map((function(e){return exports.E({},e)})),!0),s=[];n.forEach((function(t){var n=t.rIdx,i=t.cIdx;t!==o&&t.boundCellText&&s.push(t.boundCellText.id),a[n*r+i]=exports.E(exports.E({},a[n*r+i]),{clusterRoot:!1,clusterId:e,hasBg:o.hasBg,bgColor:o.bgColor,bgOpacity:o.bgOpacity})})),a[o.rIdx*r+o.cIdx].clusterRoot=!0;var l=this.getOp(),c=this.upime.createLock(R([this.element.id],s,!0)),u=R([],n,!0);u.sort((function(e,t){return e.rIdx===t.rIdx?e.cIdx-t.cIdx:e.rIdx-t.rIdx}));var d=u.find((function(e){var t;return null===(t=e.boundCellText)||void 0===t?void 0:t.rawText})),p=u[0];if(d&&d!==p){var h=d.boundCellText;if(!h)return;p.boundCellText&&l.update(p.boundCellText,{deleted:!0}),l.update(h,{position:{x:0,y:0,parentType:Za.TABLE,parentId:this.element.id,rowId:p.rId,columnId:p.cId}})}n.forEach((function(e){if(e!==o){var t=e.boundCellText;t&&l.update(t,{deleted:!0})}})),l.update(this.element,exports.E({cells:a},this.getCellRelationProp())),l.sync(),this.upime.clearLock(c),this.currentOp=void 0,this.connectTextEditor(),this.upime.view.update()}else this.upime.addToast(O("table.cell.op.forbid"))},t.prototype.unMergeCells=function(){if(this.element.focusingCell&&1!==this.element.focusedCells.length&&this.couldUnMergeCells){var t=this.element,n=t.focusedCells,i=t.cells,r=t.cols,o=R([],i.map((function(e){return exports.E({},e)})),!0);n.forEach((function(e){var t=e.rIdx,n=e.cIdx;o[t*r+n].clusterRoot=!1,o[t*r+n].clusterId=null})),e.prototype.updateProperty.call(this,exports.E({cells:o},this.getCellRelationProp()))}},t.prototype.handleAnyResize=function(e,t,n){this.dealTableBorderResize(e,n,t)},t.prototype.dealTableBorderResize=function(e,t,n){var i=n.direction;if(this.element.checkCouldUpdateCells()){var r=t.left,o=t.top,a=t.right,s=t.bottom,l=this.element,c=l.scale,u=l.rowWidths,d=l.rowHeights,p=l.rows,h=l.cols,f=l.size,m=l.minRowHeights,v=l.minRowWidths,g=this.element.getBorderBox(),y=g.left,b=g.right,E=g.top,x={position:{x:r,y:o}},w=b-y,C=a-r,S=s-o,k=+(S-(g.bottom-E)).toFixed(2),_=+(C-w).toFixed(2);if(["n","s"].includes(i)){if(k>0){var T=d.map((function(e){return e+k/p/c}));this.updateSelf(exports.E(exports.E({},x),{size:{width:f.width,height:S/c},rowHeights:T}))}else if(k<0){var I=m.reduce((function(e,t){return e+t}),0)*c;if(S<=I)return;var P=Math.abs(k)/c,N=d.map((function(e,t){return{height:e,oriIdx:t}})).sort((function(e,t){return e.height-t.height})).filter((function(e){var t=e.height,n=e.oriIdx;return t>m[n]})),M=R([],d,!0);N.forEach((function(e,t){var n=e.height,i=e.oriIdx,r=n-m[i],o=P/(p-t);r-o>=0?(M[i]=M[i]-o,P-=o):(M[i]=m[i],P-=n-m[i])})),this.updateSelf(exports.E(exports.E({},x),{size:{width:f.width,height:M.reduce((function(e,t){return e+t}),0)},rowHeights:M}))}}else if(["e","w"].includes(i)){if(_>0){var A=u.map((function(e){return e+_/h/c}));this.updateSelf(exports.E(exports.E({},x),{size:{width:A.reduce((function(e,t){return e+t}),0),height:f.height},rowWidths:A}))}else if(_<0){var D=v.reduce((function(e,t){return e+t}),0)*c;if(C<=D)return;var B=Math.abs(_)/c,L=u.map((function(e,t){return{width:e,oriIdx:t}})).sort((function(e,t){return e.width-t.width})).filter((function(e){var t=e.width,n=e.oriIdx;return t>v[n]})),F=R([],u,!0);L.forEach((function(e,t){var n=e.width,i=e.oriIdx,r=n-v[i],o=B/(h-t);r-o>=0?(F[i]=F[i]-o,B-=o):(F[i]=v[i],B-=n-v[i])})),this.updateSelf(exports.E(exports.E({},x),{size:{height:f.height,width:F.reduce((function(e,t){return e+t}),0)},rowWidths:F}))}}else if(["nw","ne","sw","se"].includes(i)||"multi"===this.element.selectStatus){var z=this.currentOp;z&&(null==z||z.update(this.element,exports.E(exports.E({},x),{scale:c*C/w})))}}else e.isStart&&this.upime.addToast(O("table.cell.op.forbid"))},Object.defineProperty(t.prototype,"couldDeleteRow",{get:function(){var e=this;if(!this.element.focusingCell)return!1;var t=this.element,n=t.focusedCells,i=t.cols,r=t.rows;if(n.length===r*i)return!1;var o=this.getFocusedCellsRowInfo(),a=o.fullRowIds,s=o.notFullRowIds;if(0===a.length)return!1;var l=s.some((function(t){var i=n.filter((function(e){return e.rIdx===t}));return i.some((function(t){return!t.clusterId||e.element.getCellsGroup(t).every((function(e){return!a.includes(e.rIdx)}))}))}));return!l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"couldDeleteCol",{get:function(){var e=this;if(!this.element.focusingCell)return!1;var t=this.element,n=t.focusedCells,i=t.rows,r=t.cols;if(t.cells,n.length===i*r)return!1;var o=this.getFocusedCellsColInfo(),a=o.fullColIds,s=o.notFullColIds;if(0===a.length)return!1;var l=s.some((function(t){var i=n.filter((function(e){return e.cIdx===t}));return i.some((function(t){return!t.clusterId||e.element.getCellsGroup(t).every((function(e){return!a.includes(e.cIdx)}))}))}));return!l},enumerable:!1,configurable:!0}),t.prototype.removeFullCols=function(){var e=this;if(this.element.focusingCell){var t=this.element,n=t.focusedCells,i=t.rows,r=t.cols,o=t.cells,a=this.getFocusedCellsColInfo(),s=a.fullColIds,l=a.notFullColIds,c=void 0;if(l.length){c=this.upime.createOperation();var u=R([],o.map((function(e){return exports.E({},e)})),!0);l.forEach((function(t){var o=n.filter((function(e){return e.cIdx===t}));o.forEach((function(t){var n=e.element.getCellsGroup(t),o=n.filter((function(e){return!s.includes(e.cIdx)})),a=function(){n[0]!==t&&n[0].boundCellText&&(t.boundCellText&&(null==c||c.update(t.boundCellText,{deleted:!0})),null==c||c.update(n[0].boundCellText,{position:{x:0,y:0,parentType:Za.TABLE,parentId:e.element.id,rowId:t.rId,columnId:t.cId}}))};if(1===o.length){var l=o[0],d=l.rIdx,p=l.cIdx;u[d*i+p].clusterRoot=!1,u[d*i+p].clusterId=null,a()}else{d=t.rIdx;var h=t.cIdx,f=Math.min.apply(Math,o.map((function(e){return e.rIdx}))),m=Math.min.apply(Math,o.map((function(e){return e.cIdx}))),v=o.find((function(e){return e.rIdx===f&&e.cIdx===m}));t===v?(u[d*r+h].clusterRoot=!0,a()):u[d*r+h].clusterRoot=!1}}))})),c.update(this.element,exports.E({cells:u},this.getCellRelationProp()))}this.element.removeByCols(s,c)}},t.prototype.removeFullRows=function(){var e=this;if(this.element.focusingCell){var t=this.element,n=t.focusedCells,i=t.cols,r=t.cells,o=this.getFocusedCellsRowInfo(),a=o.fullRowIds,s=o.notFullRowIds,l=void 0;if(s.length){l=this.upime.createOperation();var c=R([],r.map((function(e){return exports.E({},e)})),!0);s.forEach((function(t){var r=n.filter((function(e){return e.rIdx===t}));r.forEach((function(t){var n=e.element.getCellsGroup(t),r=n.filter((function(e){return!a.includes(e.rIdx)})),o=function(){n[0]!==t&&n[0].boundCellText&&(t.boundCellText&&(null==l||l.update(t.boundCellText,{deleted:!0})),null==l||l.update(n[0].boundCellText,{position:{x:0,y:0,parentType:Za.TABLE,parentId:e.element.id,rowId:t.rId,columnId:t.cId}}))};if(1===r.length){var s=r[0],u=s.rIdx,d=s.cIdx;c[u*i+d].clusterRoot=!1,c[u*i+d].clusterId=null,o()}else{var p=t.rIdx,h=(d=t.cIdx,Math.min.apply(Math,r.map((function(e){return e.rIdx})))),f=Math.min.apply(Math,r.map((function(e){return e.cIdx}))),m=r.find((function(e){return e.rIdx===h&&e.cIdx===f}));t===m?(c[p*i+d].clusterRoot=!0,o()):c[p*i+d].clusterRoot=!1}}))})),l.update(this.element,exports.E({cells:c},this.getCellRelationProp()))}this.element.removeByRows(a,l)}},t.prototype.dealClick=function(e,t){var n,i,r,o=this;if(null===(n=null==t?void 0:t.clickData)||void 0===n?void 0:n.clickEleName)_e.desktop&&(this.element.editingName=!0,this._editNameWidget=new LR(this.upime,this),this.upime.view.addDomWidget(this._editNameWidget));else if(this.element.focusingCell){var a=null===(i=null==t?void 0:t.tableCtrlData)||void 0===i?void 0:i.rowAction,s=null===(r=null==t?void 0:t.tableCtrlData)||void 0===r?void 0:r.colAction;if(null==a?void 0:a.onSortBtn)this.element.selectRow({row:a.r});else if(null==s?void 0:s.onSortBtn)this.element.selectCol({col:s.c});else{var l=this.element.focusedCells,c=function(t,n,i){var r=o.upime.selectElement(t),a=r.richContentEditor.client,s=e.position,l=o.upime.elementManager.getTableRS(o.element.id,n,i).globalTransform.applyInverse(s),c=a.getTextRelation(l).point,u={x:c.x,y:c.y+r.richContentEditor.scrollTop};r.startEdit(),r.richContentEditor.moveCursorToPosition(u)};if(1===l.length){var u=l[0];(d=u.boundCellText||u.draftText)?!d.unavailable&&c(d,u.rId,u.cId):u.initCellText()}else{var d,p=l[0].findClusterRoot();p&&((d=p.boundCellText||p.draftText)?!d.unavailable&&c(d,p.rId,p.cId):p.initCellText())}}}},t.prototype.doDelete=function(t){var n=this,i=this.element,r=i.grids,o=i.focusedCells,a=i.focusingCell,s=a?o:r.flat();if(this.element.checkCouldUpdateCells(s)){if(a){var l=this.element.focusedCells.reduce((function(e,t){return R(R([],e,!0),n.element.getCellBoundedEles(t),!0)}),[]);return this.element.discardEles(l,t),void this.connectTextEditor()}var c=this.element.grids.flat().reduce((function(e,t){return R(R([],e,!0),n.element.getCellBoundedEles(t),!0)}),[]);this.element.discardEles(c,t),e.prototype.doDelete.call(this,t)}else this.upime.addToast(O("table.cell.op.forbid"))},t.prototype.getCellRelationProp=function(){return{rows:this.element.rows,cols:this.element.cols,rowHeights:this.element.rowHeights,rowWidths:this.element.rowWidths,size:this.element.size}},t.prototype.getFocusedCellsRowInfo=function(){var e=this.element,t=e.focusedCells,n=e.cols,i={};return t.forEach((function(e){i[e.rIdx]||(i[e.rIdx]=new Set),i[e.rIdx].add(e)})),{fullRowIds:Object.keys(i).filter((function(e){return i[e].size===n})).map(Number),notFullRowIds:Object.keys(i).filter((function(e){return i[e].size!==n})).map(Number)}},t.prototype.getFocusedCellsColInfo=function(){var e=this.element,t=e.focusedCells,n=e.rows,i={};return t.forEach((function(e){i[e.cIdx]||(i[e.cIdx]=new Set),i[e.cIdx].add(e)})),{fullColIds:Object.keys(i).filter((function(e){return i[e].size===n})).map(Number),notFullColIds:Object.keys(i).filter((function(e){return i[e].size!==n})).map(Number)}},t}(Ob),zR=function(e){var t=js.value,n=t.viewbox,i=t.exportType,r=e.position,o=e.scale,a=r.x,s=r.y,l=a,c=s,u=1/n.scale,d=pr(e.meshColor),p=e.useMemo("meshPath",(function(){for(var t=[],n=[],i=[],r=e.rowWidths,a=e.rowHeights,s=e.xOffsetArr,l=e.yOffsetArr,c=0;c<e.rows;c++){var u=[];n.push(u);for(var d=l[c],p=l[c+1]||l[c]+a[c]*o,h=0;h<e.cols;h++){var f,m=e.grids[c][h],v=s[h],g=s[h+1]||s[h]+r[h]*o,y=void 0;0===c?(y=[],i.push(y)):y=i[h],m.drawLeftBorder&&((f=y[y.length-1])&&d===f.y2?f.y2=p:y.push({x1:v,y1:d,x2:v,y2:p})),m.drawTopBorder&&((f=u[u.length-1])&&v===f.x2?f.x2=g:u.push({x1:v,y1:d,x2:g,y2:d}))}}var b=function(e){for(var n=0,i=e;n<i.length;n++){var r=i[n];t.push(["M",r.x1,r.y1],["L",r.x2,r.y2])}};n.forEach((function(e){return e.length&&b(e)})),i.forEach((function(e){return e.length&&b(e)}));var E=s[e.cols-1]+r[e.cols-1]*o,x=l[e.rows-1]+a[e.rows-1]*o;return t.push(["M",0,x],["L",E,x],["L",E,0]),t}),[e.grids,e.xOffsetArr,e.yOffsetArr]),h=e.getBorderBox(),f=h.right-h.left,m=h.bottom-h.top;yf(e),e.editingName||PN({element:e,size:{width:f,height:m},position:{x:a,y:s}}),fa({x:l,y:c,lineWidth:u,stroke:d}),"svg"===i?Na((function(t){t.clear(),e.cells.forEach((function(n,i){if(n.hasBg&&(!n.clusterId||n.clusterRoot)){var r=i/e.cols|0,a=i%e.cols,s=e.xOffsetArr[a],l=e.yOffsetArr[r],c=e.rowWidths[a]*o,u=e.rowHeights[r]*o;if(n.clusterId){for(var d=1;d+a<e.cols&&e.cells[i+d].clusterId===n.clusterId;d++)c+=e.rowWidths[a+d]*o;for(d=1;d+r<e.rows&&e.cells[i+d*e.cols].clusterId===n.clusterId;d++)u+=e.rowHeights[r+d]*o}t.beginFill(n.bgColor,n.bgOpacity),t.drawRect(s,l,c,u),t.endFill()}}))})):Ma((function(t){var n=t.context,i=t.alpha,r=-1,a="";e.cells.forEach((function(t,s){if(t.hasBg&&(!t.clusterId||t.clusterRoot)){var l,c=s/e.cols|0,u=s%e.cols,d=e.xOffsetArr[u],p=e.yOffsetArr[c],h=e.rowWidths[u]*o,f=e.rowHeights[c]*o;if(t.clusterId){for(var m=1;m+u<e.cols&&e.cells[s+m].clusterId===t.clusterId;m++)h+=e.rowWidths[u+m]*o;for(m=1;m+c<e.rows&&e.cells[s+m*e.cols].clusterId===t.clusterId;m++)f+=e.rowHeights[c+m]*o}t.bgColor===r?l=a:(r=t.bgColor,l=a=pr(t.bgColor)),n.fillStyle=l,n.globalAlpha=i*t.bgOpacity,n.fillRect(d,p,h,f)}}))})),Ta(p),ma(),ma()},HR=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name=O("table.title"),t.rows=0,t.cols=0,t.someV=0,t.rowWidths=[],t.minRowWidths=[],t.rowHeights=[],t.minRowHeights=[],t.cells=[],t.grids=[],t.gridsMap={},t.rsMap={},t.renderer=zR,t.elementType=Za.TABLE,t.editorType=FR,t.meshColor=9540508,t._color=1710618,t._highLight=null,t._bolder=!1,t._italic=!1,t._underLine=!1,t._deleteLine=!1,t._maxRIdx=0,t._maxCIdx=0,t.editingName=!1,t._hasBg=!1,t._bgColor=0,t._bgOpacity=1,t._ha="center",t._va="middle",t.lineHeight=Ue,t.lineHeightRate=1.36,t._fontSize=14,t.fontFamily=He,t.xOffsetArr=[],t.yOffsetArr=[],t._focusedCells=[],t.lastEffectCell=null,t.lastShiftEffectCells=[],t.tabBaseCell=null,t._botRightWidget=null,t._topLeftWidget=null,t._curOp=null,t._lock=null,t.fixedTopLeftWidget=null,t._updateLockedTextBox=te((function(e){(e.position||e.rowWidths||e.rowWidths||e.scale||e.cells)&&t.grids.flat().forEach((function(e){return e.boundCellText&&t.upime.forceUpdateLockBox(e.boundCellText.id)}))}),100),t._checkFixedWidget=function(){var e=t,n=e.focusingCell,i=e.focusedCells;if(n){var r=[],o=[];i.forEach((function(e){r.includes(e.rIdx)||r.push(e.rIdx),o.includes(e.cIdx)||o.push(e.cIdx)})),r.length>1&&o.length>1?t.removeFixedTopLeftWidget():t.fixedTopLeftWidget?(t.fixedTopLeftWidget.row=1===r.length?r[0]:null,t.fixedTopLeftWidget.col=1===o.length?o[0]:null,t.upime.updateView()):(t.fixedTopLeftWidget=new bR(t.upime,t,!1,1===r.length?r[0]:void 0,1===o.length?o[0]:void 0),t.upime.view.addAssistWidget(t.fixedTopLeftWidget))}else t.removeFixedTopLeftWidget()},t.checkFixedWidget=te(t._checkFixedWidget,100),t}return P(t,e),Object.defineProperty(t.prototype,"hasBg",{get:function(){return this.focusingCell?this.focusedCells.every((function(e){return e.hasBg})):this.cells.every((function(e){return e.hasBg}))},set:function(e){this._hasBg=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bgColor",{get:function(){return this.focusingCell?this.focusedCells[0].bgColor:this._bgColor},set:function(e){this._bgColor=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bgOpacity",{get:function(){return this.focusingCell?this.focusedCells[0].bgOpacity:this._bgOpacity},set:function(e){this._bgOpacity=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.focusingCell?this.focusedCells[0].color:this._color},set:function(e){this._color=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highLight",{get:function(){return this.focusingCell?this.focusedCells[0].highLight:this._highLight},set:function(e){this._highLight=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bolder",{get:function(){return this.focusingCell?this.focusedCells[0].bolder:this._bolder},set:function(e){this._bolder=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"italic",{get:function(){return this.focusingCell?this.focusedCells[0].italic:this._italic},set:function(e){this._italic=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underLine",{get:function(){return this.focusingCell?this.focusedCells[0].underLine:this._underLine},set:function(e){this._underLine=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deleteLine",{get:function(){return this.focusingCell?this.focusedCells[0].deleteLine:this._deleteLine},set:function(e){this._deleteLine=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ha",{get:function(){return this.focusingCell?this.focusedCells[0].ha:this._ha},set:function(e){this._ha=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"va",{get:function(){return this.focusingCell?this.focusedCells[0].va:this._va},set:function(e){this._va=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){var e;if(this.focusingCell){var t=this.focusedCells[0];return(null===(e=t.boundCellText)||void 0===e?void 0:e.fontSize)||t.fontSize}return this._fontSize},set:function(e){this._fontSize=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusedCells",{get:function(){return this._focusedCells},set:function(e){this._focusedCells=e,this.checkFixedWidget()},enumerable:!1,configurable:!0}),t.prototype.setFocusedCells=function(e,t,n){void 0===n&&(n=!1),this.focusedCells=e,this.lastEffectCell=t,n||(this.lastShiftEffectCells=[]),this.tabBaseCell=null},t.prototype.removeFixedTopLeftWidget=function(){this.fixedTopLeftWidget&&(this.upime.view.removeAssistWidget(this.fixedTopLeftWidget),this.fixedTopLeftWidget=null)},Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusingCell",{get:function(){return!!this.focusedCells.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disableCellOp",{get:function(){if(!this.upime.editable)return!0;var e=this.upime.view.scale;return this.size.width*this.scale*e<210&&this.size.height*this.scale*e<120},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topLeftFocusedCell",{get:function(){if(!this.focusingCell)return null;for(var e=this.focusedCells[0],t=0,n=this.focusedCells;t<n.length;t++){var i=n[t];i.rIdx<=e.rIdx&&(i.rIdx<e.rIdx||i.cIdx<e.cIdx)&&(e=i)}return e},enumerable:!1,configurable:!0}),t.prototype.checkAttachedMeta=function(){},t.prototype.getNextCIdx=function(){return"".concat(++this._maxCIdx)},t.prototype.getNextRIdx=function(){return"".concat(++this._maxRIdx)},t.prototype.dealUpdate=function(t){var n,i=this;e.prototype.dealUpdate.call(this,t);var r=t.cells,o=t.rows,a=t.cols,s=t.deleted,l=this.getThenSetTableRs();s&&this.unmounRefSystem(l);var c=r||!1===s;c&&this._updateCells(null!=r?r:this.cells,null!=o?o:this.rows,null!=a?a:this.cols),this._updateCellOffsets(t),null===(n=this._botRightWidget)||void 0===n||n.updateBox(),(t.position||t.size||void 0!==t.scale)&&this.updateBorderBox(),this._updateLockedTextBox(t),(t.position||void 0!==t.scale||c||t.rowHeights||t.rowWidths)&&this.updateCellsBorderBox(),r&&Object.values(this.rsMap).forEach((function(e){e.bindBaseElement(i),null==l||l.addChildRS(e)})),(t.position||t.scale||t.size)&&Object.values(this.rsMap).forEach((function(e){e.updateTransform()}))},t.prototype.updateCellsBorderBox=function(){for(var e,t=this,n=t.xOffsetArr,i=t.yOffsetArr,r=t.rowHeights,o=t.rowWidths,a=t.scale,s=t.position,l=t.grids,c=t.rows,u=t.cols,d=0;d<c;d++)for(var p=0;p<u;p++){var h=l[d][p];if(h.clusterId){if(!h.clusterRoot)continue;for(var f={left:s.x+n[p],right:s.x+n[p]+o[p]*a,top:s.y+i[d],bottom:s.y+i[d]+r[d]*a},m=d+1,v=p+1;v<u;){var g=l[d][v];if(g.clusterId!==h.clusterId)break;f.right+=o[v]*a,g.borderBox=f,v++}for(;m<c;){var y=l[m][p];if(y.clusterId!==h.clusterId)break;f.bottom+=r[m]*a,y.borderBox=f,m++}h.borderBox=Object.freeze(f)}else h.borderBox=Object.freeze({left:s.x+n[p],right:s.x+n[p]+o[p]*a,top:s.y+i[d],bottom:s.y+i[d]+r[d]*a});null===(e=h.boundCellText)||void 0===e||e.updateBorderBox()}},t.prototype._updateCellOffsets=function(e){var t,n=this,i=e.scale,r=e.rowHeights,o=e.rowWidths;(null!==(t=null!=i?i:r)&&void 0!==t?t:o)&&(this.xOffsetArr=Array(this.rowWidths.length).fill(0).map((function(e,t){return n.rowWidths.slice(0,t).reduce((function(e,t){return e+t}),0)*n.scale})),this.yOffsetArr=Array(this.rowHeights.length).fill(0).map((function(e,t){return n.rowHeights.slice(0,t).reduce((function(e,t){return e+t}),0)*n.scale})))},t.prototype._updateCells=function(e,t,n){var i=this;if(e.length===t*n){var r=0,o=0,a=[];this.gridsMap={},Object.values(this.rsMap).forEach((function(e){return i.unmounRefSystem(e)})),this.rsMap={};for(var s=0,l=0,c=0;c<e.length;c++){r=Math.max(+e[c].rId,r),o=Math.max(+e[c].cId,o),c%n==0&&(a.push([]),l=0),s=c/n|0;var u=new mR(this,e[c],s,l);a[s].push(u),this.gridsMap[e[c].rId]||(this.gridsMap[e[c].rId]={}),this.gridsMap[e[c].rId][e[c].cId]=u;var d=this.upime.elementManager.getTableRS(this.id,u.rId,u.cId);this.rsMap[d.id]=d,l++}if(this.grids=a,this.focusedCells.length){var p=[];this.focusedCells.forEach((function(e){var t,n;(null===(t=i.gridsMap[e.rId])||void 0===t?void 0:t[e.cId])&&p.push(null===(n=i.gridsMap[e.rId])||void 0===n?void 0:n[e.cId])})),this.setFocusedCells(p,p[0])}this.rows=t,this.cols=n,this._maxRIdx=r,this._maxCIdx=o,this.minRowHeights=new Array(t).fill(30),this.minRowWidths=new Array(n).fill(30)}},t.prototype.checkClickName=function(e){return HN(this,e,40)},t.prototype.checkSelectRelation=function(e,t){var n,i=this;if(this.stable)return null;if(!Ot(e,this.getCtrlSensitiveBox(!0)))return null;if("view"===this.upime.xmode)return this._checkCellRelation(e);var r=this.checkInteractRelation(e,t);if(r){var o=null===(n=r.metaData)||void 0===n?void 0:n.clickData;if(o){var a=o.selectTableCol,s=o.selectTableRow;if(a){var l=a.col,c=a.merge,u=a.crossMerge;if(c&&!u){var d=new Set(this.grids.map((function(e){return i.getCellsGroup(e[l])})).flat());d.size===this.focusedCells.length&&this.focusedCells.forEach((function(e){return d.delete(e)})),0===d.size&&delete r.metaData}}if(s){var p=s.row;if(c=s.merge,u=s.crossMerge,c&&!u){var h=new Set(this.grids[p].map((function(e){return i.getCellsGroup(e)})).flat());h.size===this.focusedCells.length&&this.focusedCells.forEach((function(e){return h.delete(e)})),0===h.size&&delete r.metaData}}}return r}return this._checkSelectRelation(e,t)},t.prototype.checkInteractRelation=function(t,n){var i,r,o=e.prototype.checkInteractRelation.call(this,t,n);if(this.disableCellOp||o||"multi"===this.selectStatus||this.frozedGroupId)return o;if(Ot(t,this.getCtrlSensitiveBox())){var a=this.upime.view.scale,s=3/a,l=exports.E({},this.getBorderBox());if(l.right+=s,l.bottom+=s,!Ot(t,l)){var c={tableCtrlData:{addRowCol:{onAddColBtn:_e.desktop&&Ot(t,this._getRightAddColBtnBox()),onAddRowBtn:_e.desktop&&Ot(t,this._getBotAddRowBtnBox())}}};if(t.x<l.left&&t.y>l.top&&t.y<l.bottom-s){var u=this.checkPointerRowIndex(t);if(null!==u){var d=_e.desktop&&this.rowHeights[u]*this.scale*a>=44,p=this.checkOnTLSortBtn(t,u,!0),h=d&&1===this._checkOnTLAddBtn(t,u,!0),f=d&&2===this._checkOnTLAddBtn(t,u,!0);d&&this._topLeftWidget&&this._topLeftWidget.row&&(h||f)&&(1===this._topLeftWidget.curBtn||2===(null===(i=this._topLeftWidget)||void 0===i?void 0:i.curBtn))?c.tableCtrlData.rowAction={r:this._topLeftWidget.row,showAll:this._topLeftWidget.showAll,onTopAdd:1===this._topLeftWidget.curBtn,onBotAdd:2===this._topLeftWidget.curBtn,onSortBtn:p}:c.tableCtrlData.rowAction={r:u,showAll:d,onTopAdd:h,onBotAdd:f,onSortBtn:p}}}else if(t.x>l.left&&t.y<l.top&&t.x<l.right-s){var m=this.checkPointerColIndex(t);if(null!==m){d=_e.desktop&&this.rowWidths[m]*this.scale*a>=44,p=this.checkOnTLSortBtn(t,m,!1);var v=d&&1===this._checkOnTLAddBtn(t,m,!1),g=d&&2===this._checkOnTLAddBtn(t,m,!1);d&&this._topLeftWidget&&this._topLeftWidget.col&&(v||g)&&(1===this._topLeftWidget.curBtn||2===(null===(r=this._topLeftWidget)||void 0===r?void 0:r.curBtn))?c.tableCtrlData.colAction={c:this._topLeftWidget.col,showAll:this._topLeftWidget.showAll,onLeftAdd:1===this._topLeftWidget.curBtn,onRightAdd:2===this._topLeftWidget.curBtn,onSortBtn:p}:c.tableCtrlData.colAction={c:m,showAll:d,onLeftAdd:v,onRightAdd:g,onSortBtn:p}}}if(("click"===(null==n?void 0:n.type)||"move"===(null==n?void 0:n.type))&&c.tableCtrlData){var y=c.tableCtrlData,b=y.addRowCol,E=y.rowAction,x=y.colAction,w="click"===(null==n?void 0:n.type);if(E)if(w){if(E.onBotAdd||E.onTopAdd||E.onSortBtn){var C=n.evt.originEvent;c.clickData=exports.E(exports.E(exports.E({},E.onSortBtn&&{selectTableRow:{row:E.r,merge:C.shiftKey||C.ctrlKey||C.metaKey,crossMerge:C.shiftKey}}),E.onTopAdd&&{addTableRow:E.r}),E.onBotAdd&&{addTableRow:E.r+1})}}else E.onSortBtn&&(c.tableCtrlData.sortData={r:E.r,c:null});else x?w?(x.onLeftAdd||x.onRightAdd||x.onSortBtn)&&(C=n.evt.originEvent,c.clickData=exports.E(exports.E(exports.E({},x.onSortBtn&&{selectTableCol:{col:x.c,merge:C.shiftKey||C.ctrlKey||C.metaKey,crossMerge:C.shiftKey}}),x.onLeftAdd&&{addTableCol:x.c}),x.onRightAdd&&{addTableCol:x.c+1})):x.onSortBtn&&(c.tableCtrlData.sortData={c:x.c,r:null}):w&&((null==b?void 0:b.onAddColBtn)||(null==b?void 0:b.onAddRowBtn))&&(c.clickData=exports.E(exports.E({},(null==b?void 0:b.onAddColBtn)&&{addTableCol:this.cols}),(null==b?void 0:b.onAddRowBtn)&&{addTableRow:this.rows}))}return{metric:-1,transparent:!1,metaData:c}}}else if(this.checkClickName(t))return{metric:this.size.width*this.size.height*Math.pow(this.scale,2),transparent:!1};return null},t.prototype._checkSelectRelation=function(t,n){var i,r,o,a,s,l=this;if((null==n?void 0:n.forceNormalCheck)||this.disableCellOp||"multi"===this.selectStatus||this.frozedGroupId)return e.prototype._checkSelectRelation.call(this,t,n);var c=this.getCellIdxByPoint(t);if("single"===this.selectStatus&&"click"===(null==n?void 0:n.type)&&this.focusingCell&&c&&!n.evt.originEvent.shiftKey){var u=c.r,d=c.c,p=(D=this.getCellsGroup(this.grids[u][d])).length===this.focusedCells.length&&D.every((function(e){return l.focusedCells.includes(e)}));if(p){var h=this.topLeftFocusedCell.getBorderBox();return{transparent:!1,metric:(h.right-h.left)*(h.bottom-h.top)}}}var f={tableCtrlData:{addRowCol:{onAddColBtn:!1,onAddRowBtn:!1}}},m=this.checkResizeRowMeta(t),v=null;if(null===m){var g=this.checkResizeColMeta(t);v=g,null!==g&&(f.tableCtrlData.resizeData={r:null,c:g,oriValue:this.rowWidths[g]})}else f.tableCtrlData.resizeData={r:m,c:null,oriValue:this.rowHeights[m]};if(c&&(u=c.r,d=c.c,null!==m&&this.grids[m][d].clusterId&&this.grids[m][d].clusterId===(null===(r=null===(i=this.grids[m+1])||void 0===i?void 0:i[d])||void 0===r?void 0:r.clusterId)&&delete f.tableCtrlData.resizeData,null!==v&&this.grids[u][v].clusterId&&this.grids[u][v].clusterId===(null===(o=this.grids[u][v+1])||void 0===o?void 0:o.clusterId)&&delete f.tableCtrlData.resizeData),!(null===(a=f.tableCtrlData)||void 0===a?void 0:a.resizeData)&&"move"===(null==n?void 0:n.type))return null;if("click"===(null==n?void 0:n.type)&&!(null===(s=f.tableCtrlData)||void 0===s?void 0:s.resizeData)&&c){var y=c.r,b=c.c;if(n.evt.originEvent.metaKey||n.evt.originEvent.ctrlKey){var E=this.focusedCells.find((function(e){return e.rIdx===y&&e.cIdx===b})),x=[];if(E){var w=this.getCellsGroup(E);x=this.focusedCells.filter((function(e){return!w.includes(e)}));var C=this.lastEffectCell&&w.includes(this.lastEffectCell)?this.topLeftFocusedCell:this.lastEffectCell;x.sort((function(e){return e===C?-1:1}))}else x=R(R([],this.getCellsGroup(this.grids[y][b]),!0),this.focusedCells,!0);f.clickData={candidateTableCells:x}}else if(n.evt.originEvent.shiftKey){if(x=[],this.focusingCell){var S=new Set(this.focusedCells);this.lastShiftEffectCells.forEach((function(e){return S.delete(e)}));var k=[],_=this.lastEffectCell||this.grids[0][0],T=0,I=0,P=0,N=0;y>=_.rIdx?(T=_.rIdx,I=y):(T=y,I=_.rIdx),b>=_.cIdx?(P=_.cIdx,N=b):(P=b,N=_.cIdx);for(var M=T;M<=I;M++)for(var A=P;A<=N;A++){var D;(D=this.getCellsGroup(this.grids[M][A])).forEach((function(e){S.has(e)||(S.add(e),k.push(e))}))}this.lastShiftEffectCells=k,x=Array.from(S)}else x=this.getCellsGroup(this.grids[y][b]);f.clickData={candidateTableCells:x}}else{var B=this.getCellsGroup(this.grids[y][b]);f.clickData={candidateTableCells:B}}}return{metric:this.size.width*this.size.height*Math.pow(this.scale,2),transparent:!1,metaData:f}},t.prototype._checkCellRelation=function(e){var t=this.getCellIdxByPoint(e);if(t){var n=t.r,i=t.c,r=this.getCellsGroup(this.grids[n][i]),o=1===r.length?r[0]:r.find((function(e){return e.clusterRoot}));if(o){var a=o.getBorderBox();return{transparent:!1,metric:(a.right-a.left)*(a.bottom-a.top)}}}return null},t.prototype.dealHoverStart=function(t){var n;if(_e.desktop){var i=null===(n=t.metaData)||void 0===n?void 0:n.tableCtrlData;if(!i)return this._releaseHoverWidgets(),e.prototype.dealHoverStart.call(this,t);if(i.addRowCol)if(this._botRightWidget){if(i.addRowCol.onAddColBtn)return this._botRightWidget.setCurrentLocation("r"),void this.upime.view.setCursor("pointer",this);if(i.addRowCol.onAddRowBtn)return this._botRightWidget.setCurrentLocation("b"),void this.upime.view.setCursor("pointer",this);this._botRightWidget.setCurrentLocation(""),this.upime.view.setCursor("",this)}else this._botRightWidget=new gR(this.upime,this),this.upime.view.addAssistWidget(this._botRightWidget);if(i.resizeData&&null!==i.resizeData.c?this.upime.view.setCursor("col-resize",this):i.resizeData&&null!==i.resizeData.r?this.upime.view.setCursor("row-resize",this):this.upime.view.setCursor("",this),i.rowAction){var r=i.rowAction;this._topLeftWidget||(this._topLeftWidget=new bR(this.upime,this,r.showAll),this._topLeftWidget.updateRow(r.r),this.upime.view.addAssistWidget(this._topLeftWidget)),this._topLeftWidget&&((r.onBotAdd||r.onTopAdd||r.onSortBtn)&&r.showAll===this._topLeftWidget.showAll?(r.onBotAdd||r.onTopAdd||r.onSortBtn)&&(this.upime.view.setCursor("pointer",this),r.onSortBtn?this._topLeftWidget.updateHighlightBtn(3):r.showAll&&1!==this._topLeftWidget.curBtn&&2!==this._topLeftWidget.curBtn&&(r.onTopAdd&&this._topLeftWidget.updateHighlightBtn(1),r.onBotAdd&&this._topLeftWidget.updateHighlightBtn(2))):(this._topLeftWidget.updateRow(r.r),this._topLeftWidget.updateHighlightBtn(0),this.upime.view.setCursor("",this)),r.showAll!==this._topLeftWidget.showAll&&this._topLeftWidget.updateShowAll(r.showAll))}else i.colAction?(r=i.colAction,this._topLeftWidget||(this._topLeftWidget=new bR(this.upime,this,r.showAll),this._topLeftWidget.updateCol(r.c),this.upime.view.addAssistWidget(this._topLeftWidget)),this._topLeftWidget&&((r.onLeftAdd||r.onRightAdd||r.onSortBtn)&&r.showAll===this._topLeftWidget.showAll?(r.onLeftAdd||r.onRightAdd||r.onSortBtn)&&(this.upime.view.setCursor("pointer",this),r.onSortBtn?this._topLeftWidget.updateHighlightBtn(3):r.showAll&&1!==this._topLeftWidget.curBtn&&2!==this._topLeftWidget.curBtn&&(r.onLeftAdd&&this._topLeftWidget.updateHighlightBtn(1),r.onRightAdd&&this._topLeftWidget.updateHighlightBtn(2))):(this._topLeftWidget.updateCol(r.c),this._topLeftWidget.updateHighlightBtn(0),this.upime.view.setCursor("",this)),r.showAll!==this._topLeftWidget.showAll&&this._topLeftWidget.updateShowAll(r.showAll))):this._topLeftWidget&&(this.upime.view.removeAssistWidget(this._topLeftWidget),this._topLeftWidget=null)}},t.prototype.dealInternalMove=function(e,t){t.resizeData?this._dealResizeRowCol(e,t):t.sortData&&this._dealReorderRowCol(e,t)},t.prototype._dealReorderRowCol=function(e,t){var n,i,r,o,a,s,l,c,u,d,p,h=this,f=t.sortData;if(f){var m=f.r,v=f.c;if(null!==m||null!==v){var g=null!==m;if(g?this._couldReorderingRow(m):this._couldReorderingCol(v)){var y=[],b=null===m?[]:this._getMoveRows(m),E=null===v?[]:this._getMoveCols(v);if(g?b.forEach((function(e){y.push.apply(y,h.grids[e])})):E.forEach((function(e){h.grids.forEach((function(t){y.push(t[e])}))})),this.checkCouldUpdateCells(y)){e.isStart&&(this.removeFixedTopLeftWidget(),this._topLeftWidget||(this._topLeftWidget=new bR(this.upime,this,!1),g?this._topLeftWidget.draggingRows=R([],b,!0):this._topLeftWidget.draggingCols=R([],E,!0),this._topLeftWidget.updateDragging(!0),g?this._topLeftWidget.updateRow(m):this._topLeftWidget.updateCol(v),this.upime.view.addAssistWidget(this._topLeftWidget)),this.setFocusedCells(y,y[0]),this.currentEditor&&(this.currentEditor.visiable=!1),this.upime.view.setCursor("grabbing",this),this._curOp||(this._curOp=this.upime.createOperation()));var x=null,w=null;if(null!==m){var C=Math.min.apply(Math,b),S=Math.max.apply(Math,b);null===(n=this._topLeftWidget)||void 0===n||n.updateYOffset(Mn(-this.yOffsetArr[C],e.position.y-e.startPosition.y,S<this.rows-1?this.size.height*this.scale-this.yOffsetArr[S+1]:0)),null!==(x=this.checkPointerRowIndex(e.position))&&(e.position.y>=this.position.y+(null!==(i=this.yOffsetArr[m+1])&&void 0!==i?i:this.size.height*this.scale)&&(x+=1),x>=C&&x<=S+1&&(x=C),null===(r=this._topLeftWidget)||void 0===r||r.updateTargetR(x))}else if(null!==v){var k=Math.min.apply(Math,E),_=Math.max.apply(Math,E);null===(o=this._topLeftWidget)||void 0===o||o.updateXOffset(Mn(-this.xOffsetArr[k],e.position.x-e.startPosition.x,_<this.cols-1?this.size.width*this.scale-this.xOffsetArr[_+1]:0)),null!==(w=this.checkPointerColIndex(e.position))&&(e.position.x>=this.position.x+(null!==(a=this.xOffsetArr[v+1])&&void 0!==a?a:this.size.width*this.scale)&&(w+=1),w>=k&&w<=_+1&&(w=k),null===(s=this._topLeftWidget)||void 0===s||s.updateTargetC(w))}if(e.isEnd){if(this.upime.view.setCursor("",this),null!==x&&null!==m&&x!==m){var T=!0;if(x>0&&x<this.rows)for(var I=0,P=this.grids[x];I<P.length;I++)if((U=P[I]).clusterId){var N=this.grids[x-1][U.cIdx];if(N.clusterId&&N.clusterId===U.clusterId){T=!1;break}}if(T){var M=R([],this.cells,!0),A=R([],this.rowHeights,!0),D=(C=Math.min.apply(Math,b),S=Math.max.apply(Math,b),M.slice(C*this.cols,S*this.cols+this.cols)),B=S-C+1;if(x>C)M.splice.apply(M,R([x*this.cols,0],D,!1)),M.splice(C*this.cols,this.cols*B),A.splice.apply(A,R([x,0],A.slice(C,S+1),!1)),A.splice(C,B);else{M.splice(C*this.cols,this.cols*B),M.splice.apply(M,R([x*this.cols,0],D,!1));var L=A.slice(C,S+1);A.splice(C,B),A.splice.apply(A,R([x,0],L,!1))}var F=this.upime.createLock([this.id]);null===(l=this._curOp)||void 0===l||l.update(this,{cells:M,rowHeights:A}),null===(c=this._curOp)||void 0===c||c.sync(),this.upime.clearLock(F),this._curOp=null}else this.upime.addToast(O("table.reorder.forbid"))}else if(null!==w&&null!==v&&w!==v){if(T=!0,w>0&&w<this.cols)for(var z=0,H=this.grids;z<H.length;z++){var U;if((U=(Y=H[z])[w]).clusterId){var W=Y[w-1];if(W.clusterId&&W.clusterId===U.clusterId){T=!1;break}}}if(T){k=Math.min.apply(Math,E),_=Math.max.apply(Math,E);for(var V=this.grids.map((function(e){return e.map((function(e){return exports.E({},e.cellProps)}))})),j=R([],this.rowWidths,!0),G=_-k+1,q=0,K=V;q<K.length;q++){var Y;D=(Y=K[q]).slice(k,_+1),w>v?(Y.splice.apply(Y,R([w,0],D,!1)),Y.splice(k,G)):(Y.splice(k,G),Y.splice.apply(Y,R([w,0],D,!1)))}if(M=V.flat(),w>v)j.splice.apply(j,R([w,0],j.slice(k,_+1),!1)),j.splice(k,G);else{var X=j.slice(k,_+1);j.splice(k,G),j.splice.apply(j,R([w,0],X,!1))}F=this.upime.createLock([this.id]),null===(u=this._curOp)||void 0===u||u.update(this,{cells:M,rowWidths:j}),null===(d=this._curOp)||void 0===d||d.sync(),this.upime.clearLock(F),this._curOp=null}else this.upime.addToast(O("table.reorder.forbid"))}this._releaseHoverWidgets(),this.setFocusedCells([],null),null===(p=this.currentEditor)||void 0===p||p.updateBorderBox(),this.currentEditor&&(this.currentEditor.visiable=!0)}this.upime.updateView()}else e.isStart&&this.upime.addToast(O("table.cell.op.forbid"))}else e.isStart&&this.upime.addToast(O("table.reorder.forbid"))}}},t.prototype._dealResizeRowCol=function(e,t){var n,i,r,o,a=t.resizeData;if(a&&(null!==a.c||null!==a.r)){_e.desktop||this.currentEditor||(e.isStart&&(this.showSelected=!0),e.isEnd&&(this.showSelected=!1));var s=e.position,l=e.startPosition;if(this._curOp||(this._curOp=this.upime.createOperation(),this._lock=this.upime.createLock([this.id])),null!==a.c){var c=a.c,u=a.oriValue,d=R([],this.rowWidths,!0);d[c]=Math.max(this.minRowWidths[c],u+(s.x-l.x)/this.scale),(p=exports.E({},this.size)).width=d.reduce((function(e,t){return e+t}),0),null===(n=this._curOp)||void 0===n||n.update(this,{size:p,rowWidths:d})}else if(null!==a.r){var p,h=a.r,f=(u=a.oriValue,R([],this.rowHeights,!0));f[h]=Math.max(this.minRowHeights[h],u+(s.y-l.y)/this.scale),(p=exports.E({},this.size)).height=f.reduce((function(e,t){return e+t}),0),null===(i=this._curOp)||void 0===i||i.update(this,{size:p,rowHeights:f})}e.isEnd&&(null===(r=this._curOp)||void 0===r||r.sync(),this._lock&&this.upime.clearLock(this._lock),this._lock=null,this._curOp=null),null===(o=this.currentEditor)||void 0===o||o.updateBorderBox(),this.upime.updateView()}},t.prototype.dealHoverEnd=function(){this._releaseHoverWidgets(),e.prototype.dealHoverEnd.call(this)},t.prototype.dealClickStart=function(t){var n,i,r,o,a,s,l=null===(n=t.metaData)||void 0===n?void 0:n.clickData;if(l){var c=l.addTableRow,u=l.addTableCol,d=l.candidateTableCells,p=l.selectTableCol,h=l.selectTableRow,f=l.onEditTableCell;if(void 0!==c||void 0!==u||void 0!==d||void 0!==p||void 0!==h||void 0!==f){if(this.currentEditor&&(this.currentEditor.toolbarLeftAligned=!1),void 0!==c&&this.insertNewRowAt(c),void 0!==u&&this.insertNewColAt(u),d){if(!d.length&&l.ctrlKey)return void(null===(i=this.currentEditor)||void 0===i||i.unselect());this.currentEditor||this.upime.selectElement(this);var m=null===(o=null===(r=t.metaData)||void 0===r?void 0:r.clickData)||void 0===o?void 0:o.shiftKey,v=m?this.lastEffectCell:d[0];this.setFocusedCells(d,v,m)}p&&this.selectCol(p),h&&(this.selectRow(h),this.currentEditor&&(this.currentEditor.toolbarLeftAligned=!0)),null===(a=this.currentEditor)||void 0===a||a.updateBorderBox(),null===(s=this.currentEditor)||void 0===s||s.connectTextEditor(),this.upime.updateView()}else e.prototype.dealClickStart.call(this,t)}},t.prototype.removeByRows=function(e,t){var n,i=this,r=[],o=[];if(this.grids.reduce((function(t,n,a){return e.includes(a)?(n.forEach((function(e){r.push.apply(r,i.getCellBoundedEles(e)),o.push.apply(o,i.upime.elementManager.getAllComments((function(t){var n=t.position,r=n.parentId,o=n.rowId,a=n.columnId;return r===i.id&&o===e.rId&&a===e.cId})))})),R(R([],t,!0),n,!0)):t}),[]),r.some((function(e){return e.unavailable})))this.upime.addToast(O("table.cell.op.forbid"));else{var a=this.grids.filter((function(t,n){return!e.includes(n)})).flat().map((function(e){return exports.E({},e.cellProps)})),s=this.rowHeights.filter((function(t,n){return!e.includes(n)})),l=t||this.upime.createOperation(),c=this.upime.createLock([this.id]);this.clearFocusedCells(),l.update(this,{cells:a,rowHeights:s,rows:this.rows-e.length,size:exports.E(exports.E({},this.size),{height:s.reduce((function(e,t){return e+t}),0)}),cols:this.cols,rowWidths:this.rowWidths}),l.sync(),o.forEach((function(e){return l.update(e,{deleted:!0})})),this.discardEles(r,l),l.sync(),this.upime.clearLock(c),null===(n=this.currentEditor)||void 0===n||n.updateBorderBox()}},t.prototype.removeByCols=function(e,t){var n,i=this,r=[],o=[];if(this.grids.forEach((function(t){t.forEach((function(t,n){e.includes(n)&&(r.push.apply(r,i.getCellBoundedEles(t)),o.push.apply(o,i.upime.elementManager.getAllComments((function(e){var n=e.position,r=n.parentId,o=n.rowId,a=n.columnId;return r===i.id&&o===t.rId&&a===t.cId}))))}))})),r.some((function(e){return e.unavailable})))this.upime.addToast(O("table.cell.op.forbid"));else{var a=this.grids.map((function(t){return t.filter((function(t,n){return!e.includes(n)})).map((function(e){return exports.E({},e.cellProps)}))})).flat(),s=this.rowWidths.filter((function(t,n){return!e.includes(n)})),l=t||this.upime.createOperation(),c=this.upime.createLock([this.id]);this.clearFocusedCells(),l.update(this,{cells:a,rowWidths:s,cols:this.cols-e.length,size:exports.E(exports.E({},this.size),{width:s.reduce((function(e,t){return e+t}),0)}),rows:this.rows,rowHeights:this.rowHeights}),l.sync(),o.forEach((function(e){return l.update(e,{deleted:!0})})),this.discardEles(r,l),l.sync(),this.upime.clearLock(c),null===(n=this.currentEditor)||void 0===n||n.updateBorderBox()}},t.prototype.discardEles=function(e,t){var n=this;e.forEach((function(e){new e.editorType(n.upime,e).doDelete(t)}))},t.prototype.getCtrlSensitiveBox=function(e){void 0===e&&(e=!1);var t=this.getBorderBox(),n=t.left,i=t.right,r=t.bottom,o=t.top,a=this.upime.view.scale;return{left:n-33/a,top:o-(e?Math.max(33/a,26):33/a),right:i+48/a,bottom:r+48/a}},t.prototype.insertNewRowAt=function(e){var t=Math.max(0,e-1),n=this.grids[t].map((function(e){return exports.E({},e.cellProps)})),i=this.getNextRIdx(),r=n.map((function(e){return exports.E(exports.E({},AE(e)),{cId:e.cId,rId:i})}));if(this.rows>=2&&0!==e&&e!==this.rows)for(var o=0;o<this.cols;o++){var a=this.grids[e-1][o],s=this.grids[e][o];a.clusterId&&a.clusterId===s.clusterId&&(r[o].clusterId=a.clusterId)}var l=R([],this.cells,!0);l.splice.apply(l,R([e*this.cols,0],r,!1));var c=this.upime.createLock([this.id]),u=this.upime.createOperation(),d=R([],this.rowHeights,!0),p=this.rowHeights[Math.max(e-1,0)];d.splice(e,0,p),u.update(this,{cells:l,size:{height:this.size.height+p,width:this.size.width},rows:this.rows+1,rowHeights:d,cols:this.cols,rowWidths:this.rowWidths}),u.sync(),this.upime.clearLock(c),this.upime.clearSelect(),this.setFocusedCells(this.grids[e],this.grids[e][0]),this.upime.selectElement(this),this.upime.updateView()},t.prototype.insertNewColAt=function(e){var t=this,n=this.getNextCIdx(),i=this.grids.reduce((function(i,r){var o=r.map((function(e){return e.cellProps})),a=exports.E(exports.E({},AE(o[Math.max(e-1,0)])),{rId:o[0].rId,cId:n});if(t.cols>=2&&0!==e&&e!==t.cols){var s=o[e-1],l=o[e];s.clusterId&&s.clusterId===l.clusterId&&(a.clusterId=s.clusterId)}return o.splice(e,0,a),R(R([],i,!0),[o],!1)}),[]).flat(),r=this.upime.createLock([this.id]),o=this.upime.createOperation(),a=R([],this.rowWidths,!0),s=this.rowWidths[Math.max(e-1,0)];a.splice(e,0,s),o.update(this,{cells:i,size:{height:this.size.height,width:this.size.width+s},cols:this.cols+1,rowWidths:a,rows:this.rows,rowHeights:this.rowHeights}),o.sync(),this.upime.clearLock(r),this.upime.clearSelect();var l=this.grids.map((function(t){return t[e]}));this.setFocusedCells(l,l[0]),this.upime.selectElement(this),this.upime.updateView()},t.prototype.calcBorderBox=function(){return{left:this.position.x,top:this.position.y,right:this.position.x+this.size.width*this.scale,bottom:this.position.y+this.size.height*this.scale}},t.prototype._getBotAddRowBtnBox=function(){var e=this.upime.view.scale,t=this.position.x+this.size.width*this.scale/2,n=this.position.y+this.size.height*this.scale;return{left:t-16/e,right:t+16/e,top:n+16/e,bottom:n+48/e}},t.prototype._getRightAddColBtnBox=function(){var e=this.upime.view.scale,t=this.position.y+this.size.height*this.scale/2,n=this.position.x+this.size.width*this.scale;return{left:n+16/e,right:n+48/e,top:t-16/e,bottom:t+16/e}},t.prototype._releaseHoverWidgets=function(){this._botRightWidget&&(this.upime.view.removeAssistWidget(this._botRightWidget),this._botRightWidget=null),this._topLeftWidget&&(this.upime.view.removeAssistWidget(this._topLeftWidget),this._topLeftWidget=null)},t.prototype.allowResize=function(){return!(this.upime.phoneMode&&!this.upime.getSelectedElements().includes(this))},t.prototype.checkResizeRowMeta=function(e){if(!this.allowResize())return null;for(var t=this.upime.view.scale,n=this.position.y,i=0;i<this.rows;i++)if(n+=this.rowHeights[i]*this.scale,Math.abs(e.y-n)<=3/t)return i;return null},t.prototype.checkResizeColMeta=function(e){if(!this.allowResize())return null;for(var t=this.upime.view.scale,n=this.position.x,i=0;i<this.cols;i++)if(n+=this.rowWidths[i]*this.scale,Math.abs(e.x-n)<=3/t)return i;return null},t.prototype.getCellIdxByPoint=function(e){if(!Ot(e,this.getBorderBox()))return null;for(var t=0,n=0;this.position.x+this.xOffsetArr[n+1]<e.x;)n++;for(;this.position.y+this.yOffsetArr[t+1]<e.y;)t++;return{r:t,c:n}},t.prototype.getCellsGroup=function(e){return e.clusterId?this.grids.flat(2).filter((function(t){return t.clusterId===e.clusterId})):[e]},t.prototype.getFocusedCellsBoxes=function(e){if(void 0===e&&(e=!1),this.focusingCell){if(e){for(var t=[],n=[],i=0,r=this.focusedCells;i<r.length;i++){var o=r[i];o.clusterId?t.includes(o.clusterId)||(n.push(o.getBorderBox()),t.push(o.clusterId)):n.push(o.getBorderBox())}return n}return this.focusedCells.map((function(e){return e.getBorderBox()}))}return null},t.prototype.clearFocusedCells=function(){this.setFocusedCells([],null)},t.prototype.dealRectSelectCells=function(e){if(Kt(e,this.getBorderBox())){var t=this.grids.flat(2),n=t.filter((function(e){return!e.clusterId||e.clusterRoot})).filter((function(t){return Kt(t.getBorderBox(),e)})),i=n.map((function(e){return e.clusterId})).filter(Boolean);n.push.apply(n,t.filter((function(e){return!e.clusterRoot&&i.includes(e.clusterId)}))),this.setFocusedCells(n,n[0])}},t.prototype.checkPointerRowIndex=function(e){if(e.y<this.position.y||e.y>this.position.y+this.size.height*this.scale)return null;for(var t=1;this.position.y+this.yOffsetArr[t]<e.y&&t<=this.rows-1;)t++;return t-1},t.prototype.checkPointerColIndex=function(e){if(e.x<this.position.x||e.x>this.position.x+this.size.width*this.scale)return null;for(var t=1;this.position.x+this.xOffsetArr[t]<e.x&&t<=this.cols-1;)t++;return t-1},t.prototype._checkOnTLAddBtn=function(e,t,n){if(!this._topLeftWidget)return 0;var i=this.getBorderBox(),r=i.left,o=i.top,a=this.upime.view.scale;if(n){var s={left:r-30/a,right:r-14/a,top:o+this.yOffsetArr[t]-8/a,bottom:o+this.yOffsetArr[t]+8/a};if(Ot(e,s))return 1;if(Ot(e,{left:s.left,right:s.right,top:s.top+this.rowHeights[t]*this.scale,bottom:s.bottom+this.rowHeights[t]*this.scale}))return 2}else{var l={left:r+this.xOffsetArr[t]-8/a,right:r+this.xOffsetArr[t]+8/a,top:this.position.y-30/a,bottom:this.position.y-14/a};if(Ot(e,l))return 1;if(Ot(e,{left:l.left+this.rowWidths[t]*this.scale,right:l.right+this.rowWidths[t]*this.scale,top:l.top,bottom:l.bottom}))return 2}return 0},t.prototype.checkOnTLSortBtn=function(e,t,n){if(!_e.desktop){if(!this.fixedTopLeftWidget)return!1;if(n){if(this.fixedTopLeftWidget.row!==t)return!1}else if(this.fixedTopLeftWidget.col!==t)return!1}var i=this.getBorderBox(),r=i.left,o=i.top,a=this.upime.view.scale;return Ot(e,n?{left:r-30/a,right:r-14/a,top:o+this.yOffsetArr[t]+this.rowHeights[t]*this.scale/2-16/a,bottom:o+this.yOffsetArr[t]+this.rowHeights[t]*this.scale/2+16/a}:{left:r+this.xOffsetArr[t]+this.rowWidths[t]/2*this.scale-16/a,right:r+this.xOffsetArr[t]+this.rowWidths[t]/2*this.scale+16/a,top:o-30/a,bottom:o-14/a})},t.prototype.selectRow=function(e){var t=this,n=e.row,i=e.merge,r=void 0!==i&&i,o=e.crossMerge,a=void 0!==o&&o;if(!(n>this.rows-1||n<0)){var s=new Set(r?this.focusedCells:void 0),l=null;if(a&&this.lastEffectCell){this.lastShiftEffectCells.forEach((function(e){s.delete(e)}));for(var c=this.lastEffectCell.rIdx,u=c>n?-1:1,d=[],p=c;1===u&&p<=n||-1===u&&p>=n;p+=u)this.grids[p].map((function(e){return t.getCellsGroup(e)})).flat().forEach((function(e){s.has(e)||(s.add(e),d.push(e))}));this.lastShiftEffectCells=d,l=this.lastEffectCell}else{var h=this.grids[n].map((function(e){return t.getCellsGroup(e)})).flat();if(r&&h.every((function(e){return s.has(e)}))){var f=!1;h.forEach((function(e){t.lastEffectCell===e&&(f=!0),s.delete(e)})),l=f?this.topLeftFocusedCell:this.lastEffectCell}else h.forEach((function(e){s.add(e)})),l=this.grids[n][0]}this.setFocusedCells(Array.from(s),l,a),this.currentEditor||this.upime.selectElement(this)}},t.prototype.selectCol=function(e){var t=this,n=e.col,i=e.merge,r=void 0!==i&&i,o=e.crossMerge,a=void 0!==o&&o;if(!(n>this.cols-1||n<0)){var s=new Set(r?this.focusedCells:void 0),l=null;if(a&&this.lastEffectCell){this.lastShiftEffectCells.forEach((function(e){s.delete(e)}));for(var c=this.lastEffectCell.cIdx,u=c>n?-1:1,d=[],p=function(e){h.grids.map((function(n){return t.getCellsGroup(n[e])})).flat().forEach((function(e){s.has(e)||(s.add(e),d.push(e))}))},h=this,f=c;1===u&&f<=n||-1===u&&f>=n;f+=u)p(f);this.lastShiftEffectCells=d,l=this.lastEffectCell}else{var m=this.grids.map((function(e){return t.getCellsGroup(e[n])})).flat();if(r&&m.every((function(e){return s.has(e)}))){var v=!1;m.forEach((function(e){t.lastEffectCell===e&&(v=!0),s.delete(e)})),l=v?this.topLeftFocusedCell:this.lastEffectCell}else m.forEach((function(e){s.add(e)})),l=this.grids[0][n]}this.setFocusedCells(Array.from(s),l,a),this.currentEditor||this.upime.selectElement(this)}},t.prototype._getMoveRows=function(e){var t=this,n=t.focusedCells,i=t.cols,r=t.rows,o=[e],a=n.filter((function(t){return t.rIdx===e}));if(a.length===i||0===a.length){for(var s=e-1;s>=0;){var l=n.filter((function(e){return e.rIdx===s}));if(l.length!==i)break;o.push(s),s--}for(var c=e+1;c<=r;){var u=n.filter((function(e){return e.rIdx===c}));if(u.length!==i)break;o.push(c),c++}}return o},t.prototype._getMoveCols=function(e){var t=this,n=t.focusedCells,i=t.cols,r=t.rows,o=[e],a=n.filter((function(t){return t.cIdx===e}));if(a.length===r||0===a.length){for(var s=e-1;s>=0;){var l=n.filter((function(e){return e.cIdx===s}));if(l.length!==r)break;o.push(s),s--}for(var c=e+1;c<=i;){var u=n.filter((function(e){return e.cIdx===c}));if(u.length!==r)break;o.push(c),c++}}return o},t.prototype._couldReorderingRow=function(e){var t=this,n=this._getMoveRows(e),i=!0;return n.forEach((function(e){t.grids[e].forEach((function(n){var r,o;if(n.clusterId){var a=null===(r=t.grids[e-1])||void 0===r?void 0:r[n.cIdx],s=null===(o=t.grids[e+1])||void 0===o?void 0:o[n.cIdx];n.clusterId!==(null==a?void 0:a.clusterId)&&n.clusterId!==(null==s?void 0:s.clusterId)||(i=!1)}}))})),i},t.prototype._couldReorderingCol=function(e){var t=this,n=this._getMoveCols(e),i=!0;return n.forEach((function(e){t.grids.forEach((function(t){if(t[e].clusterId){var n=t[e-1],r=t[e+1];t[e].clusterId!==(null==n?void 0:n.clusterId)&&t[e].clusterId!==(null==r?void 0:r.clusterId)||(i=!1)}}))})),i},t.prototype.checkCouldEditCell=function(e){if(e.length!==this.focusedCells.length)return!1;for(var t="",n=0,i=e;n<i.length;n++){var r=i[n];if(!this.focusedCells.includes(r))return!1;if(r.clusterId&&!t&&(t=r.clusterId),t&&!r.clusterId)return!1;if(r.clusterId&&t!==r.clusterId)return!1}return!!t||1===e.length&&e[0]===this.focusedCells[0]},t.prototype.checkCouldUpdateCells=function(e){var t=this;return!this.unavailable&&(null!=e?e:this.grids.flat()).reduce((function(e,n){return R(R([],e,!0),t.getCellBoundedEles(n),!0)}),[]).every((function(e){return!e.unavailable}))},t.prototype.getMembers=function(){var e=this;return(this.focusingCell?this.focusedCells:this.grids.flat()).reduce((function(t,n){return R(R([],t,!0),e.getCellBoundedEles(n),!0)}),[])},t.prototype.getFocusedCellsRanges=function(){for(var e=0,t=this.rows-1,n=0,i=this.cols-1,r=0,o=this.focusedCells;r<o.length;r++){var a=o[r];t=Math.min(a.rIdx,t),e=Math.max(a.rIdx,e),i=Math.min(a.cIdx,i),n=Math.max(a.cIdx,n)}return{r:[t,e],c:[i,n]}},t.prototype.onAdd=function(){var t=this;e.prototype.onAdd.call(this);var n=this.getThenSetTableRs();Object.values(this.rsMap).forEach((function(e){e.bindBaseElement(t),null==n||n.addChildRS(e),e.updateTransform()}))},t.prototype.onDelete=function(){var t=this;Object.values(this.rsMap).forEach((function(e){return t.unmounRefSystem(e)}));var n=this.getThenSetTableRs();this.unmounRefSystem(n),this._releaseHoverWidgets(),e.prototype.onDelete.call(this)},t.prototype.useCellsData=function(e){var t,n,i,r,o,a,s,l,c,u,d,p,h=this,f=this.topLeftFocusedCell;if(f){var m=e.find((function(e){return e.elementType===Za.TABLE}));if(m){var v=m.data,g=v.focusedCellsIdx;if(g&&g.length){for(var y=g.map((function(e){return{r:e/v.cols|0,c:e%v.cols}})),b=this.rows,E=this.cols,x=R([],this.rowWidths,!0),w=R([],this.rowHeights,!0),C=y[0].r,S=y[0].c,k=C,_=S,T=0,I=y;T<I.length;T++){var P=I[T];C=Math.min(C,P.r),k=Math.max(k,P.r),S=Math.min(S,P.c),_=Math.max(_,P.c)}for(var N=C;N<=k;N++)for(var M=S;M<=_;M++)if(!g.includes(N*v.cols+M))return;for(var A=f.rIdx,D=f.cIdx,B=y.map((function(e){return{r:A+e.r-C,c:D+e.c-S}})),L=0,F=B;L<F.length;L++){P=F[L];var z=null===(t=this.grids[P.r])||void 0===t?void 0:t[P.c];if(z&&!this.checkCouldUpdateCells(this.getCellsGroup(z)))return void this.upime.addToast(O("table.cell.op.forbid"))}A+k-C>this.rows-1&&(b=A+k-C+1,w.push.apply(w,Array(b-this.rows).fill(this.rowHeights[this.rows-1]))),D+_-S>this.cols-1&&(E=D+_-S+1,x.push.apply(x,Array(E-this.cols).fill(this.rowWidths[this.cols-1])));var H=this.grids.reduce((function(e,t){return R(R([],e,!0),[t.map((function(e){return fe(e.cellProps)}))],!1)}),[]),U=function(e){var t=W.getNextRIdx();H.push(fe(H[W.rows-1].map((function(e){return exports.E(exports.E({},e),{clusterId:null,clusterRoot:!1,rId:t,cId:e.cId})}))))},W=this;for(N=0;N<b-this.rows;N++)U();for(M=0;M<E-this.cols;M++)for(var V=this.getNextCIdx(),j=0;j<b;j++)H[j].push(fe(exports.E(exports.E({},H[j][this.cols-1]),{clusterId:null,clusterRoot:!1,cId:V})));var G=this.upime.createOperation(),q=this.upime.createLock([this.id]),K=e.filter((function(e){return e.elementType!==Za.TABLE})),Y={},X=this.upime.newMaxZindex(),Q=[];K.forEach((function(e){var t=e.data;t.zIndex+=X,e.elementType===Za.GRID_TEXT?t.position={parentId:h.id,parentType:Za.TABLE,x:0,y:0,rowId:"-1",columnId:"-1"}:t.position={x:t.position.x,y:t.position.y,parentId:h.id,parentType:Za.TABLE,rowId:"-1",columnId:"-1"},t.groupId&&(Q[t.groupId]||(Q[t.groupId]=h.upime.genID("g")),t.groupId=Q[t.groupId]);var n=G.create(e.elementType,t);Y[e.id]=n}));var Z=new Map,J=function(e){var t=B[e],d=t.r,p=t.c,h=v.cells[g[e]];if(H[d][p].clusterId){var f=H[d][p].clusterId;H.forEach((function(e){return e.forEach((function(e){e.clusterId===f&&(e.clusterId=null,e.clusterRoot=!1)}))}))}var m,y=null===(i=null===(n=$.grids[d])||void 0===n?void 0:n[p])||void 0===i?void 0:i.boundCellText;if(y&&G.update(y,{deleted:!0}),(null!==(a=null===(o=null===(r=$.grids[d])||void 0===r?void 0:r[p])||void 0===o?void 0:o.boundCellEles)&&void 0!==a?a:[]).forEach((function(e){G.update(e,{deleted:!0})})),H[d][p]=exports.E(exports.E(exports.E({},H[d][p]),h),{rId:H[d][p].rId,cId:H[d][p].cId,clusterId:(m=h.clusterId,m?(Z.has(m)||Z.set(m,ia()),Z.get(m)||null):null)}),h.textEleId){var b=Y[h.textEleId];b&&G.update(b,{position:exports.E(exports.E({},b.position),{rowId:H[d][p].rId,columnId:H[d][p].cId})}),delete H[d][p].textEleId}h.attachEleIds&&(h.attachEleIds.forEach((function(e){var t=Y[e];t&&G.update(t,{position:exports.E(exports.E({},t.position),{rowId:H[d][p].rId,columnId:H[d][p].cId})})})),delete H[d][p].attachEleIds);var E=g[e]/v.cols|0,C=g[e]%v.cols;v.rowWidths[C]*(null!==(s=v.scale)&&void 0!==s?s:1)>x[p]*$.scale&&(x[p]=v.rowWidths[C]*(null!==(l=v.scale)&&void 0!==l?l:1)/$.scale),v.rowHeights[E]*(null!==(c=v.scale)&&void 0!==c?c:1)>w[d]*$.scale&&(w[d]=v.rowHeights[E]*(null!==(u=v.scale)&&void 0!==u?u:1)/$.scale)},$=this;for(N=0;N<B.length;N++)J(N);G.update(this,{cells:H.flat(),rows:b,cols:E,rowWidths:x,rowHeights:w,size:{width:x.reduce((function(e,t){return e+t}),0),height:w.reduce((function(e,t){return e+t}),0)}}),null===(d=this.currentEditor)||void 0===d||d.updateBorderBox(),G.sync(),this.upime.clearLock(q);var ee=B.map((function(e){return h.grids[e.r][e.c]}));this.setFocusedCells(ee,ee[0]),null===(p=this.currentEditor)||void 0===p||p.connectTextEditor(),this.upime.updateView()}}}},t.prototype.pasteElesIntoCell=function(e){var t=this,n=this.topLeftFocusedCell;if(n&&e.length){var i=n.rIdx,r=n.cIdx,o=this.upime.view.scale,a=this.upime.createOperation(),s=[],l=[],c=this.upime.newMaxZindex();e.forEach((function(e){var n=exports.E(exports.E({},e.data),{zIndex:e.data.zIndex+=c});e.data.groupId&&(l[e.data.groupId]||(l[e.data.groupId]=t.upime.genID("g")),n.groupId=l[e.data.groupId]);var i=a.create(e.elementType,n);s.push(i)}));var u=Yt(s.map((function(e){return e.getBorderBox()}))),d=this.rowWidths[r]*this.scale,p=this.rowHeights[i]*this.scale,h=u.right-u.left,f=u.bottom-u.top,m=R([],this.rowWidths,!0),v=R([],this.rowHeights,!0),g=h+20/o,y=f+20/o,b=this.position.x+this.xOffsetArr[r]+this.rowWidths[r]*this.scale/2-h/2,E=this.position.y+this.yOffsetArr[i]+ +this.rowHeights[i]*this.scale/2-f/2;g>d&&(m[r]=g/this.scale,b=this.position.x+this.xOffsetArr[r]+10/o),y>p&&(v[i]=y/this.scale,E=this.position.y+this.yOffsetArr[i]+10/o);var x={x:b-u.left,y:E-u.top};s.forEach((function(e){var o=En(e.position,x),s=(o.x-(t.position.x+t.xOffsetArr[r]))/t.scale,l=(o.y-(t.position.y+t.yOffsetArr[i]))/t.scale,c=e.calcTransformedUpdate(t.upime.elementManager.getTableRS(t.id,n.rId,n.cId));a.update(e,exports.E(exports.E({},c),{position:exports.E(exports.E({},c.position),{x:s,y:l})}))}));var w=fe(this.cells);a.update(this,{rowWidths:m,rowHeights:v,size:{width:m.reduce((function(e,t){return e+t}),0),height:v.reduce((function(e,t){return e+t}),0)},cells:w}),a.sync(),this.upime.clearSelect(),this.upime.selectElements(s)}},t.prototype.getCellBoundedEles=function(e){return this.upime.elementManager.getTableRS(this.id,e.rId,e.cId).children.filter((function(e){return e instanceof ry&&e.elementType!==Za.CONNECTIONLINE}))},t.prototype.getThenSetTableRs=function(){var e,t=this.upime.elementManager.getTableRS(this.id);return t.bindBaseElement(this),null===(e=this.parentRefSystem)||void 0===e||e.addChildRS(t),t},t}(oy),UR=function(t){var n=t.propEditor,i=n.editor,r=n.element,o=n.readonly,a=e.useCallback((function(e){e!==r.name&&i.updateProperty({name:e})}),[]);return e.createElement(MN,{defaultValue:r.name,onChanged:a,readonly:o,nameCtrl:i.nameCtrl})},WR=function(e){function t(t,n,i){void 0===i&&(i=!1);var r=e.call(this,t,n)||this;return r.element=n,r.readonly=i,r.couldAffectGroup=!1,r.propertyName="editName",r.renderer=UR,r}return P(t,e),t}(ay),VR=function(t){var n=t.element,i=t.upime;return t.viewbox,n.element.marking?null:e.createElement(Eb,{element:n,upime:i})},jR=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.domRenderer=VR,t.phoneMode&&"default"!==r.phoneToolbarMode||r.propertyEditors.push(new WR(r,n,!r.editable)),r.nameCtrl=new FN,r}return P(t,e),Object.defineProperty(t.prototype,"supportDownload",{get:function(){return this.upime.userManager.enableDownloadFile},enumerable:!1,configurable:!0}),t.prototype.getMinSize=function(){return 18},t.prototype.dealBorderResize=function(e,t){var n=t.left,i=t.top,r=(t.right-n)/this.element.size.width,o=this.element.position;this.updateSelf({position:exports.E(exports.E({},o),{x:n,y:i}),scale:r})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.supportLinkTo=function(){return!0},t.prototype.doRename=function(){var e;null===(e=this.nameCtrl)||void 0===e||e.selectName()},t.prototype.doDelete=function(t){var n=this;e.prototype.doDelete.call(this,t);var i=this.element.markPoints.map((function(e){return e.mediaTime})),r=i.map((function(e){return n.upime.elementManager.getMediaMarkRS(n.element.elementType,n.element.id,e)})).map((function(e){return e.children.filter((function(e){return e instanceof ry}))})).flat();r.forEach((function(e){new e.editorType(n.upime,e).doDelete(t)}))},t}(Ob),GR=function(t){var n=t.viewbox,i=t.element,r=t.zIndex,o=e.useRef(null);e.useEffect((function(){var e=o.current;return i.mediaPlayer.attachParent(e),function(){i.mediaPlayer.detachParent(e)}}),[]);var a=i.globalTransform,s=i.titleHeight,l=i.size,c=i.position,u=i.scale;c={x:c.x,y:c.y+s*u},c=a.apply(c),u*=a.currentScale;var d={zIndex:r,left:(c.x-n.left)*n.scale,top:(c.y-n.top)*n.scale,width:l.width*u*n.scale,height:l.height*u*n.scale};return i.mounted||(d.visibility="hidden"),e.createElement("div",{ref:o,className:"video_player_1AehI",style:d})};function qR(e,t,n){var i,r,o=js.value.renderApp;if(2===e.transStatus){var a=(e.estimateCompleteTime||0)-e.upime.getCurServerTime(),s=1;a>6e4&&(null==o||o(a%6e4,e),s=Math.floor(a/6e4)+1),i=O("video.transcodingPrompt",s),r=Df}else i=O("video.transcodingFailedPrompt"),r=Rf;fa({scaleX:n,scaleY:n});var l=t.height/n;Na((function(e){e.clear(),e.beginFill(14408670),e.drawRect(0,0,480,l),e.endFill()}));var c=(l-88)/2;Oa({x:220,y:c,width:40,height:40,src:r}),Ra({text:i,fontSize:14,lineHeight:22,fontFamily:He},{x:240,y:c+60,ha:"center",fill:"#303445"}),ma()}var KR,YR,XR=function(e){var t=e.position,n=e.size,i=e.scale,r=e.canRenderVideo,o=e.coverSource,a=e.titleHeight,s=js.value,l=s.exportType,c=s.addLoadingSource;s.viewbox;var u=a*i,d=n.width*i,p=n.height*i,h=d,f=p+u;function m(){var t={x:0,y:0,width:d,height:p};3===e.transStatus||2===e.transStatus?(e.playBtn.disabled=!0,qR(e,t,v)):r&&!l?(e.playBtn.disabled=!0,Ua(t)):(o&&!o.loaded&&(null==c||c(o)),Oa(exports.E({src:o,backgroundColor:"#fff"},t)),l||(e.playBtn.disabled=!1,e.playBtn.render()))}var v=h/480;if(yf(e),a){var g=[["M",h,0],["L",h,f],["L",0,f],["L",0,0],["Z"]];fa({x:t.x,y:t.y}),za([new Sa(g)]),fa({scaleX:v,scaleY:v}),Na((function(e){e.clear(),e.beginFill(16119542),e.drawRect(0,0,480,26),e.endFill(),e.lineStyle(1,15527150),e.moveTo(0,25.5),e.lineTo(480,25.5)})),Oa({src:Tf,x:8,y:3,width:20,height:20}),Ra(e.useMemo("nameText",(function(){return{text:e.name,textWidth:406,lineHeight:18,fontSize:10,lineClamp:1,textOverflow:"ellipse",fontFamily:He}}),[e.name]),{x:36,y:4,fill:"#0C1024"}),e.maxBtn.render(),ma(),fa({x:0,y:a*i}),m(),ma(),void 0===l&&!1!==e.upime.view.isImmersivePlaying&&e.upime.view.playingElement===e||(fa({stroke:"#D8D8D8",lineWidth:2*v}),Ta(g),ma()),ma()}else PN({element:e,size:{width:d,height:p},position:{x:t.x,y:t.y}}),fa(exports.E({},t)),m(),ma();ma()},QR=function(){function e(e){var t=this;this.parent=e,this.dealAck=function(e){var n=t.tempData;if(n){var i=n.localActions.shift();n.localActions.length||(t.tempData=void 0,t.parent.upime.unSyncedMarkPointLists.delete(t)),i&&i.seq===e&&(t.syncedList=t.genList(t.syncedList,[i]))}},this.syncedList=[]}return Object.defineProperty(e.prototype,"currentList",{get:function(){return this.tempData?this.tempData.localList:this.syncedList},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.syncedList=e.sort((function(e,t){return e.mediaTime-t.mediaTime})),this.tempData=void 0},e.prototype.genList=function(e,t){for(var n=R([],e,!0),i=function(e){var t=n.findIndex((function(t){return t.mediaTime===e.mediaTime}));if(t>=0)if(e.deleted)n.splice(t,1);else{var i=n[t];n.splice(t,1,exports.E(exports.E({},i),e))}else!e.deleted&&e.creator&&(n.push(exports.E({},e)),n.sort((function(e,t){return e.mediaTime-t.mediaTime})))},r=0,o=t;r<o.length;r++)i(o[r].update);return n},e.prototype.dealRemoteUpdate=function(e){this.syncedList=this.genList(this.syncedList,[{update:e}]),this.tempData&&(this.tempData.localList=this.genList(this.syncedList,this.tempData.localActions))},e.prototype.recordLocalUpdate=function(e){var t=this.parent,n=t.upime,i=t.id,r=t.elementType,o=n.genLocalSeq(),a=this.tempData;a||(a={localList:[],localActions:[]},this.tempData=a),a.localActions.push({seq:o,update:e}),a.localList=this.genList(this.syncedList,a.localActions),n.recordAction({type:"update",seq:o,updates:[{id:i,update:{markPoint:e},elementType:r}]}),n.waitAck(o,this.dealAck),n.unSyncedMarkPointLists.add(this)},e.prototype.reSendLocalActions=function(){var e=this;if(this.tempData){var t=this.parent,n=t.upime,i=t.id,r=t.elementType;this.tempData.localActions.forEach((function(t){var o=t.seq,a=t.update;n.unWaitAck(o,e.dealAck);var s=n.genLocalSeq();t.seq=s,n.recordAction({type:"update",seq:s,updates:[{id:i,update:{markPoint:a},elementType:r}]}),n.waitAck(s,e.dealAck)}))}},e}(),ZR=function(e){this.media=e,this.renderer=JR,this.renderKey="mark_video_"+e.id},JR=function(t){var n=t.element.media,i=t.viewbox,r=e.useState(!0),o=r[0],a=r[1];e.useEffect((function(){var e=window.setTimeout((function(){a(!1)}),2e3);return function(){clearTimeout(e)}}),[]);var s=W().getUpimeTrans,l=n.globalTransform,c=n.size,u=n.titleHeight,d=n.position,p=n.scale;d=l.apply(d),p*=l.currentScale;var h=c.width*p*i.scale,f=(c.height+u)*p*i.scale,m=(d.x-i.left)*i.scale,v=!0;h<320&&(v=!1);var g={width:h,height:50,left:m,top:(d.y-i.top)*i.scale+f-50};v||(g.display="none");var y=n.mediaPlayer,b=y.currentTime,E=y.duration,x="".concat(mM(1e3*b),"/").concat(mM(1e3*E));return e.createElement(e.Fragment,null,o&&e.createElement("div",{className:"mark_point_toast_3ftQL",style:{left:m+h/2,top:(d.y+n.titleHeight*p-i.top)*i.scale}},s("video.markingModeToast")),e.createElement("div",{className:"mark_point_bar_3Jj1s",style:g},e.createElement("div",{className:"info_1LOEI"},e.createElement(hl,{className:"icon_2gH6T",icon:"dadian"}),e.createElement("div",{className:"desc_1ZsB9"},s("video.markingMode")),e.createElement("div",{className:"time_3S8nE"},x)),e.createElement("div",{className:"btns_21DTP"},e.createElement("div",{className:j("save_1g_Fy","btn_2SVQS"),onClick:function(){return n.saveMark()}},s("common.save")))))},$R=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.embeddedRenderer=GR,i.embedRenderKey="",i.renderer=XR,i.elementType=Za.VIDEO,i.fileId="",i.duration=0,i.name="",i.loading=!1,i.loaded=!1,i.shouldPlay=!1,i.allowedPlay=!1,i.marking=!1,i.titleHeight=0,i.loop=!1,i.skipMarkPoint=!1,i.transStatus=0,i.markPointList=new QR(i),i.editorType=jR,i.dealDoubleClick=CM(i),i.playedTime=-1,i.isSettingTimeToMarkPoint=!1,i.watchTimeUpdate=function(){if(!i.isSettingTimeToMarkPoint){for(var e,t=1e3*i.mediaPlayer.currentTime,n=i.skipMarkPoint?[]:i.markPoints,r=0;r<n.length;r++){var o=n[r];if(!(o.mediaTime<=i.playedTime)&&o.mediaTime<t+50){e=o;break}}e?(i.pauseAtMarkPoint(e),i.playedTime<e.mediaTime&&(i.playedTime=e.mediaTime)):(i.clearCurrentPoint(),i.playedTime<t&&(i.playedTime=t))}},i.mediaPlayer=i.initPlayer(),i.mediaPlayer.on("timeupdate",i.watchTimeUpdate),i.mediaPlayer.on("end",i.watchTimeUpdate);var r=i.maxBtn=new WN(i,"maxBtn2",Bf);return r.x=450,r.y=2,r.iconSize=14,r.onclick=function(){t.followManager.forcedFollowing?t.addToast(O("meeting.view.locked.presentation.hint")):i.upime.displayMedia(i)},i.addInnerWidget(r),i}return P(t,e),Object.defineProperty(t.prototype,"hideControl",{get:function(){return this.marking},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canMark",{get:function(){return this.upime.editable||this.upime.userManager.commentOnlyMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"markPoints",{get:function(){return this.markPointList.currentList},enumerable:!1,configurable:!0}),t.prototype.getUrlById=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return e?[4,this.upime.getFileInfo(e)]:[3,2];case 1:return[2,t.sent().url];case 2:return[2,""]}}))}))},t.prototype.getTranscodedUrl=function(e){return e+"_t.mp4"},t.prototype.getMediaUrl=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.getUrlById(this.fileId)];case 1:return e=t.sent(),1===this.transStatus?[2,this.getTranscodedUrl(e)]:[2,e]}}))}))},t.prototype.checkAttachedMeta=function(){},t.prototype.loadMediaSrc=function(){return A(this,void 0,void 0,(function(){var e,t=this;return D(this,(function(n){switch(n.label){case 0:return this.loading=!0,this.extraUrl?(e=this.extraUrl,[3,3]):[3,1];case 1:return[4,this.getMediaUrl()];case 2:e=n.sent(),n.label=3;case 3:return this.mediaPlayer.once("canplay",(function(){var e;t.loading=!1,t.allowedPlay&&(null===(e=t.onCanplay)||void 0===e||e.call(t),t.loaded=!0,t.upime.view.update(),t.shouldPlay&&t.mediaPlayer.play())})),this.mediaPlayer.src=e,[2]}}))}))},t.prototype.requestPlay=function(){var e;this.prepareMediaElement(),this.allowedPlay=!0,this.embedRenderKey=this.renderKey+Date.now(),null===(e=this.addEmbeddedDom)||void 0===e||e.call(this)},t.prototype.replay=function(){if(!this.upime.followManager.forcedFollowing){this.playedTime=-1;var e=this.searchMarkPoint(0,!0);e?this.pauseAtMarkPoint(e):(this.mediaPlayer.currentTime=0,this.doPlay())}},t.prototype.play=function(){this.upime.followManager.forcedFollowing||(this.doPlay(),this.dealLocalStatusChange())},t.prototype.doPlay=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){if(this.shouldPlay=!0,this.allowedPlay||this.requestPlay(),this.loaded)this.mediaPlayer.play();else{if(this.loading)return _e.isIOS&&this.mediaPlayer.play(),[2];this.loadMediaSrc()}return[2]}))}))},t.prototype.pauseAtMarkPoint=function(e){if(this.isSettingTimeToMarkPoint=!0,this.doSetCurrentTime(e.mediaTime/1e3),this.pauseByMarkPoint(),this.isSettingTimeToMarkPoint=!1,this.playedTime=e.mediaTime,this.currentPoint){if(this.currentPoint.mediaTime===e.mediaTime)return;this.clearCurrentPoint()}this.setCurrentPoint(e.mediaTime)},t.prototype.searchMarkPoint=function(e,t){void 0===t&&(t=!1);var n,i=this.skipMarkPoint?[]:this.markPoints;if(t)return i.find((function(t){return t.mediaTime===e}));for(var r=0;r<i.length;r++){var o=i[r];o.mediaTime>e-50&&o.mediaTime<e+50&&(!n||Math.abs(o.mediaTime-e)<Math.abs(n.mediaTime-e))&&(n=o)}return n},t.prototype.pauseByMarkPoint=function(){this.doPause(),this.upime.followManager.followingUser||this.dealLocalStatusChange()},t.prototype.pause=function(){this.upime.followManager.forcedFollowing||(this.doPause(),this.dealLocalStatusChange())},t.prototype.doPause=function(){this.shouldPlay=!1,this.mediaPlayer.pause()},t.prototype.setCurrentTime=function(e){this.upime.followManager.forcedFollowing||(this.doSetCurrentTime(e,{exact:!1}),this.dealLocalStatusChange())},t.prototype.doSetCurrentTime=function(e,t){if(this.allowedPlay||this.requestPlay(),this.loaded||this.loading||this.loadMediaSrc(),t){var n=this.searchMarkPoint(1e3*e,t.exact);if(n)return void this.pauseAtMarkPoint(n)}this.playedTime=1e3*e,this.mediaPlayer.currentTime=e},t.prototype.setSpeed=function(e){this.upime.followManager.forcedFollowing||(this.doSetSpeed(e),this.allowedPlay&&this.dealLocalStatusChange())},t.prototype.doSetSpeed=function(e){this.mediaPlayer.playbackRate=e},t.prototype.dealLocalStatusChange=function(){var e=this.upime.getCurServerTime(),t=this.loop,n=this.skipMarkPoint,i=this.mediaPlayer,r=i.currentTime,o=i.playbackRate;this.upime.followManager.syncMediaStatus(this,{playing:this.shouldPlay,currentTime:1e3*r,speed:o,timestamp:e,loop:t,skipMarkPoint:n})},t.prototype.useServerMediaStatus=function(e){var t=e.currentTime,n=e.timestamp,i=e.playing,r=e.speed,o=e.loop,a=e.skipMarkPoint,s=t/1e3;this.doSetLoopState(o),this.doSetSkipMarkpoint(a);var l=this.mediaPlayer.duration;if(this.doSetSpeed(r),i){if((s+=(this.upime.getCurServerTime()-n)*r/1e3)>=l){if(!(o&&l>0))return this.doPause(),void this.doSetCurrentTime(this.mediaPlayer.duration,{exact:!0});s-=Math.floor(s/l)*l}Math.abs(s-1*this.mediaPlayer.currentTime)>.5&&this.doSetCurrentTime(s),this.doPlay()}else this.doPause(),s>=l&&(s=l),this.doSetCurrentTime(s,{exact:!0})},t.prototype.finishPlay=function(){var e;this.doPause(),this.mediaPlayer.src="",this.mediaPlayer.promiseTime=void 0,this.allowedPlay=!1,this.loaded=!1,null===(e=this.removeEmbeddedDom)||void 0===e||e.call(this),this.unbindMediaDom(),this.marking&&this.exitMarkMode(),this.checkMarkPointUpdate()},t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+(e.titleHeight+a)*s,rotate:this.rotate}},t.prototype.dealUpdate=function(t){var n=t,i=n.duration,r=n.markPoint,o=n.markPoints,a=N(n,["duration","markPoint","markPoints"]);e.prototype.dealUpdate.call(this,a),o&&this.markPointList.init(o),r&&this.markPointList.dealRemoteUpdate(r),(r||o)&&this.checkMarkPointUpdate(),void 0!==i&&(this.duration=i,this.mediaPlayer.duration=i/1e3),(t.position||void 0!==t.rotate||t.scale)&&this.updateBorderBox(),!this.deleted&&this.currentMarkRefSystem&&(t.position||void 0!==t.rotate||t.scale)&&this.currentMarkRefSystem.updateTransform()},t.prototype.onAdd=function(){e.prototype.onAdd.call(this),this.markPoints.length&&this.checkMarkPointUpdate()},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.clearCurrentPoint(),this.finishPlay()},t.prototype.addMarkPoint=function(e){this.markPointList.recordLocalUpdate({mediaTime:e,creator:this.upime.localUserInfo.loginName}),this.checkMarkPointUpdate(),this.upime.updateView()},t.prototype.editMarkPoint=function(e,t){this.markPointList.recordLocalUpdate({mediaTime:e,title:t}),this.upime.updateView()},t.prototype.deleteMarkPoint=function(e){var t=this,n=this.upime.elementManager.getMediaMarkRS(this.elementType,this.id,e),i=new bN(this.upime);n.children.forEach((function(e){var n=e;new n.editorType(t.upime,n).doDelete(i)})),this.upime.getAllComments((function(e){return e.position.parentType===t.elementType&&e.position.parentId===t.id&&e.position.mediaTime===n.mediaTime})).forEach((function(e){i.update(e,{deleted:!0})})),i.sync(),this.markPointList.recordLocalUpdate({mediaTime:e,deleted:!0}),this.checkMarkPointUpdate(),this.upime.updateView()},t.prototype.addMarkingWidget=function(){this.markingWidget||(this.markingWidget=new ZR(this),this.upime.view.addDomWidget(this.markingWidget))},t.prototype.removeMarkingWidget=function(){this.markingWidget&&(this.upime.view.removeDomWidget(this.markingWidget),this.markingWidget=void 0)},t.prototype.checkMarkPointUpdate=function(){if(!this.mediaPlayer.isPlaying){if(this.deleted)return this.clearCurrentPoint(),void(this.marking&&this.exitMarkMode());var e=Math.floor(1e3*this.mediaPlayer.currentTime);this.markPoints.find((function(t){return t.mediaTime===e}))?this.setCurrentPoint(e):(this.clearCurrentPoint(),this.marking&&this.exitMarkMode())}},t.prototype.clearCurrentPoint=function(){this.currentPoint&&(this.currentPoint=void 0,this.upime.updateView()),this.currentMarkRefSystem&&(this.unmounRefSystem(this.currentMarkRefSystem),this.currentMarkRefSystem=void 0,this.upime.updateView())},t.prototype.setCurrentPoint=function(e){var t;this.currentPoint={mediaTime:e},this.currentMarkRefSystem=this.upime.elementManager.getMediaMarkRS(this.elementType,this.id,e),this.currentMarkRefSystem.bindBaseElement(this),null===(t=this.parentRefSystem)||void 0===t||t.addChildRS(this.currentMarkRefSystem),this.upime.updateView()},t.prototype.enterMarkMode=function(){if(this.marking=!0,this.pause(),!this.currentPoint){var e=Math.floor(1e3*this.mediaPlayer.currentTime);this.addMarkPoint(e)}this.addMarkingWidget(),this.upime.updateView()},t.prototype.saveMark=function(){this.exitMarkMode(),this.upime.selectElement(this),!this.mediaPlayer.ended&&this.play()},t.prototype.exitMarkMode=function(){var e=this;this.marking=!1,this.removeMarkingWidget();var t=this.currentMarkRefSystem;t&&0===t.children.length&&0===this.upime.getAllComments((function(n){return n.position.parentId===e.id&&n.position.mediaTime===t.mediaTime})).length&&this.deleteMarkPoint(t.mediaTime),this.upime.updateView()},t.prototype.showFileControlDom=function(){this.upime.publish("mediaFocused",this),0!==this.transStatus&&1!==this.transStatus||this.upime.enableFileHelperWidget(this)},t.prototype.toggleLoopState=function(){this.doSetLoopState(!this.loop),this.loop&&!this.skipMarkPoint&&this.doSetSkipMarkpoint(!0),this.allowedPlay&&this.dealLocalStatusChange()},t.prototype.doSetLoopState=function(e){this.loop=e,this.mediaPlayer.loop=e,this.upime.updateView()},t.prototype.toggleSkipMarkpoint=function(){this.doSetSkipMarkpoint(!this.skipMarkPoint),this.allowedPlay&&this.dealLocalStatusChange()},t.prototype.doSetSkipMarkpoint=function(e){this.skipMarkPoint=e,this.upime.updateView()},t}(oy),eB=(KR='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="#D8D8D8" d="m8.53 5.456 9.113 5.696a1 1 0 0 1 0 1.696L8.53 18.544A1 1 0 0 1 7 17.696V6.304a1 1 0 0 1 1.53-.848Z" fill="#D8D8D8"/></g></svg>',er(YR=tr(KR="data:image/svg+xml,"+encodeURIComponent(KR))),YR),tB=function(e){function t(t,n){var i=e.call(this,t,n,eB)||this;return i.element=t,i.x=215,i.y=109,i.width=50,i.height=50,i.iconSize=26,i}return P(t,e),t.prototype.render=function(){var e=this,t=this,n=t.x,i=t.width,r=t.iconSize,o=t.element,a=o.size.width*o.scale/480,s=o.size.height*o.scale/a,l=this.y=(s-this.height)/2;if(fa({scaleX:a,scaleY:a}),Na((function(t){t.beginFill(0,e.hovering?.4:.6),t.drawCircle(n+i/2,l+i/2,i/2)})),this.currentSource){var c=(i-r)/2;Oa({src:this.currentSource,x:n+c,y:l+c,width:r,height:r})}ma()},t.prototype.checkRelation=function(t,n){if(this.disabled)return null;var i=this.element,r=i.scale,o=i.size,a=i.titleHeight,s=o.width*r/480;return t={x:t.x/s,y:(t.y-a*r)/s},e.prototype.checkRelation.call(this,t,n)},t}(UN),nB=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.elementType=Za.VIDEO,i.coverFileId="",i.canRenderVideo=!1,i.bypassStableInterActCheck=!0,i.onCanplay=function(){i.canRenderVideo=!0},i.addEmbeddedDom=function(){i.upime.view.addEmbeddedElement(i)},i.removeEmbeddedDom=function(){i.upime.view.removeEmbeddedElement(i)};var r=i.playBtn=new tB(i,"playBtn");return r.onclick=function(){i.play()},i.addInnerWidget(r),i}return P(t,e),Object.defineProperty(t.prototype,"coverSource",{get:function(){return this.canRenderVideo&&this._videoSource||this._coverSource},enumerable:!1,configurable:!0}),t.prototype.checkClickName=function(e){return HN(this,e)},t.prototype._checkSelectRelation=function(t,n){return e.prototype._checkSelectRelation.call(this,t,n)||("click"!==(null==n?void 0:n.type)&&"move"!==(null==n?void 0:n.type)||!this.checkClickName(t)?null:{metric:-1,transparent:!1})},t.prototype.getCoverUrl=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.getUrlById(this.coverFileId)]}))}))},t.prototype.updateCoverSource=function(){var e=this.coverFileId;if((!this._coverSource||this._coverSource.id!==e)&&e){var t=tr("");t.id=e,this._coverSource=t,this.loadCoverSource(this._coverSource)}},t.prototype.loadCoverSource=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return this.coverFileId?[4,this.getCoverUrl()]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t="",n.label=3;case 3:return e.imgSrc=t,er(e),[2]}}))}))},t.prototype.initPlayer=function(){return new YN},t.prototype.prepareMediaElement=function(){var e=this.upime.applyVideoElement(this);this.mediaPlayer.attachMedia(e)},t.prototype.unbindMediaDom=function(){var e=this.mediaPlayer.dom;e&&this.upime.releaseVideoElement(e),this.mediaPlayer.detachMedia()},t.prototype.finishPlay=function(){e.prototype.finishPlay.call(this),this.canRenderVideo=!1},t.prototype.dealUpdate=function(t){var n=t,i=n.coverFileId,r=N(n,["coverFileId"]);e.prototype.dealUpdate.call(this,r),void 0!==i&&i!==this.coverFileId&&(this.coverFileId=i,!t.deleted&&!this.deleted&&this.updateCoverSource())},t.prototype.onAdd=function(){e.prototype.onAdd.call(this),this.updateCoverSource()},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this._coverSource=void 0},t.prototype.enterFullscreen=function(){var e=this;this.upime.screenPlayMode||(this.allowedPlay||this.requestPlay(),this.loaded||this.loading||this.loadMediaSrc(),setTimeout((function(){e.mediaPlayer.dom&&$(e.mediaPlayer.dom)}),50))},t}($R),iB=function(e){function t(n,i){var r=e.call(this)||this;return r.parentId=n,r.pageId=i,r.id=t.genId(r.parentId,r.pageId),r}return P(t,e),Object.defineProperty(t.prototype,"highDimension",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseElePos",{get:function(){if(this.baseElement){var e=this.baseElement,t=e.position,n=e.titleHeight,i=e.scale;return{x:t.x,y:t.y+n*i}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportComment",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.genId=function(){return t.genId(this.parentId,this.pageId)},t.prototype.getRelateInfo=function(){return{parentType:Za.DOCUMENT,parentId:this.parentId,pageId:this.pageId}},t.genId=function(e,t){return"".concat(e,"_rs_").concat(t)},t}(Us),rB=function(t){var n=t.upime,i=t.viewbox,r=t.element,o=t.zIndex,a=e.useRef(null),s=e.useRef(null);e.useEffect((function(){var e=null,t=function(t){if(t===r){var n=s.current;n&&(n.style.transform="rotate(26deg)");var i=Date.now(),o=function(){if(e=fr(o),Date.now()-i>1e3/60){var t=6*r.mediaPlayer.currentTime%60/60*360,n=a.current;n&&(n.style.transform="rotate(".concat(t,"deg)"))}i=Date.now()};o()}};r.isPlaying&&t(r);var i=[n.subscribe("mediaPaused",(function(t){if(t===r){e&&mr(e),e=null;var n=s.current;n&&(n.style.transform="rotate(0deg)")}})),n.subscribe("mediaPlayed",t)];return function(){i.forEach((function(e){return e()})),e&&mr(e)}}),[]);var l=r.globalTransform,c=r.size,u=r.titleHeight,d=r.position,p=r.scale;d={x:d.x,y:d.y+u*p},d=l.apply(d),p*=l.currentScale;var h={position:"absolute",display:"flex",zIndex:o,left:(d.x-i.left)*i.scale,top:(d.y-i.top)*i.scale,width:c.width*p*i.scale,height:c.height*p*i.scale};r.mounted||(h.visibility="hidden");var f={width:156*p*i.scale,height:120*p*i.scale},m={width:80*p*i.scale,height:80*p*i.scale},v={width:17*p*i.scale,height:65*p*i.scale};return e.createElement("div",{style:h},e.createElement("div",{className:"root_3M7WA",style:{backgroundImage:"url(".concat($o("audio_bg.png"),")"),backgroundSize:"cover"}},e.createElement("div",{style:f,dangerouslySetInnerHTML:{__html:'<?xml version="1.0" encoding="UTF-8"?><svg width="100%" height="100%" viewBox="0 0 156 120" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>光盘</title> <g id="12-15" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="切图" transform="translate(-430.000000, -332.000000)"> <g id="光盘" transform="translate(430.000000, 332.000000)"> <g id="编组-7" transform="translate(120.000000, 0.000000)"> <circle id="背景" fill="#EAF3FB" cx="18" cy="18" r="18"></circle> <circle id="椭圆形" fill="#DCE7F1" cx="18" cy="18" r="16"></circle> <path d="M18,2 C26.836556,2 34,9.163444 34,18 C34,26.836556 26.836556,34 18,34 C9.163444,34 2,26.836556 2,18 C2,9.163444 9.163444,2 18,2 Z M18,3 C9.71572875,3 3,9.71572875 3,18 C3,26.2842712 9.71572875,33 18,33 C26.2842712,33 33,26.2842712 33,18 C33,9.71572875 26.2842712,3 18,3 Z" id="形状结合" fill="#D4E1ED"></path> <circle id="椭圆形" fill="#B7C4CF" cx="18" cy="18" r="7"></circle> <g id="编组-6" transform="translate(12.000000, 12.000000)"> <circle id="椭圆形" fill="#DCE7F1" cx="6" cy="6" r="6"></circle> <path d="M10.0337677,1.55823979 C11.2416493,2.65582426 12,4.23935098 12,6 C12,9.3137085 9.3137085,12 6,12 C4.23935098,12 2.65582426,11.2416493 1.55823979,10.0337677 C2.62346094,11.0064939 4.04242008,11.6 5.6,11.6 C8.9137085,11.6 11.6,8.9137085 11.6,5.6 C11.6,4.09376886 11.0449811,2.71716934 10.1283011,1.66355929 Z" id="形状结合" fill="#C8D5E0"></path> <path d="M6,0 C7.75871796,0 9.34070193,0.756688147 10.438147,1.96225951 C9.37182081,0.991534444 7.95499054,0.4 6.4,0.4 C3.0862915,0.4 0.4,3.0862915 0.4,6.4 C0.4,7.95499054 0.991534444,9.37182081 1.96185301,10.4377405 C0.756688147,9.34070193 0,7.75871796 0,6 C0,2.6862915 2.6862915,0 6,0 Z" id="形状结合" fill="#EAF5FF"></path> </g> </g> <g id="编组-3"> <g id="编组"> <circle id="椭圆形" fill="#2D3440" cx="60" cy="60" r="60"></circle> <path d="M58,118 C91.137085,118 118,91.137085 118,58 C118,42.1661553 111.866656,27.7648298 101.846157,17.0422114 L101.413666,16.586 L101.414666,16.585 L101.847116,17.0020391 C113.045196,27.9026266 120,43.1391226 120,60 C120,93.137085 93.137085,120 60,120 C43.1391226,120 27.9026266,113.045196 17.0027481,101.847825 L16.5856661,101.415071 C27.3536557,111.690166 41.9399575,118 58,118 Z" id="形状结合" fill="#212730"></path> <path d="M62,2 C28.862915,2 2,28.862915 2,62 C2,78.0600425 8.30983371,92.6463443 18.5856661,103.415071 C7.13427513,92.4877858 4.54747351e-13,77.0770425 4.54747351e-13,60 C4.54747351e-13,26.862915 26.862915,0 60,0 C77.0770425,0 92.4877858,7.13427513 103.414334,18.5849295 C92.6463443,8.30983371 78.0600425,2 62,2 Z" id="形状结合" fill="#485162"></path> </g> <path d="M60,4.5 C90.6518036,4.5 115.5,29.3481964 115.5,60 C115.5,90.6518036 90.6518036,115.5 60,115.5 C29.3481964,115.5 4.5,90.6518036 4.5,60 C4.5,29.3481964 29.3481964,4.5 60,4.5 Z M60,5.5 C29.9004811,5.5 5.5,29.9004811 5.5,60 C5.5,90.0995189 29.9004811,114.5 60,114.5 C90.0995189,114.5 114.5,90.0995189 114.5,60 C114.5,29.9004811 90.0995189,5.5 60,5.5 Z M60,8.5 C88.4426646,8.5 111.5,31.5573354 111.5,60 C111.5,88.4426646 88.4426646,111.5 60,111.5 C31.5573354,111.5 8.5,88.4426646 8.5,60 C8.5,31.5573354 31.5573354,8.5 60,8.5 Z M60,9.5 C32.1096201,9.5 9.5,32.1096201 9.5,60 C9.5,87.8903799 32.1096201,110.5 60,110.5 C87.8903799,110.5 110.5,87.8903799 110.5,60 C110.5,32.1096201 87.8903799,9.5 60,9.5 Z M60,12.5 C86.2335256,12.5 107.5,33.7664744 107.5,60 C107.5,86.2335256 86.2335256,107.5 60,107.5 C33.7664744,107.5 12.5,86.2335256 12.5,60 C12.5,33.7664744 33.7664744,12.5 60,12.5 Z M60,13.5 C34.3187591,13.5 13.5,34.3187591 13.5,60 C13.5,85.6812409 34.3187591,106.5 60,106.5 C85.6812409,106.5 106.5,85.6812409 106.5,60 C106.5,34.3187591 85.6812409,13.5 60,13.5 Z" id="形状结合" fill="#B4C0CE" fill-rule="nonzero" opacity="0.06"></path> <circle id="椭圆形" fill="#000000" cx="60" cy="60" r="43"></circle> </g> </g> </g> </g></svg>'},className:"pan_1kXsU"}),e.createElement("div",{style:m,dangerouslySetInnerHTML:{__html:'<?xml version="1.0" encoding="UTF-8"?><svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>旋转区域</title> <g id="12-15" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="切图" transform="translate(-626.000000, -332.000000)"> <g id="旋转区域" transform="translate(626.000000, 332.000000)"> <g id="编组-4"> <circle id="椭圆形" fill="#95A3B3" cx="40" cy="40" r="40"></circle> <path d="M67.7720869,11.2125999 C75.3110634,18.487309 80,28.6960746 80,40 C80,62.09139 62.09139,80 40,80 C28.6960746,80 18.487309,75.3110634 11.2125999,67.7720869 C18.4081153,74.7234851 28.2046408,79 39,79 C61.09139,79 79,61.09139 79,39 C79,28.3961328 74.8738563,18.7559781 68.1395358,11.5975029 Z" id="形状结合" fill="#7C8C9F"></path> <path d="M40,0 C51.299945,0 61.5055013,4.68563498 68.7797141,12.2199501 C61.5847806,5.27341427 51.791445,1 41,1 C18.90861,1 1,18.90861 1,41 C1,51.791445 5.27341427,61.5847806 12.2202859,68.7800499 C4.68563498,61.5055013 0,51.299945 0,40 C0,17.90861 17.90861,0 40,0 Z" id="形状结合" fill="#ADBBCC"></path> </g> <circle id="椭圆形" fill="#CEDAE6" transform="translate(40.000000, 40.000000) rotate(90.000000) translate(-40.000000, -40.000000) " cx="40" cy="40" r="35"></circle> <g id="音符" transform="translate(40.000000, 40.000000) rotate(-90.000000) translate(-40.000000, -40.000000) translate(28.000000, 28.000000)"> <rect id="矩形" x="0" y="0" width="24" height="24"></rect> <path d="M5.38461538,23.1923077 C3.68529217,23.1923077 2.30769231,21.8147078 2.30769231,20.1153846 L2.30769231,17.8653846 C2.30769231,16.1979076 3.65944602,14.8461538 5.32692308,14.8461538 C6.99440013,14.8461538 8.34615385,16.1979076 8.34615385,17.8653846 L8.346,21.192 L16.971,21.191 L14.029,8.768 L5.04,8.769 L3.07692308,8.76923077 C1.43828998,8.76923077 0.0988103518,7.48827375 0.00522332873,5.87309885 L-1.11910481e-13,5.69230769 L-1.11910481e-13,4.01923077 C-1.11910481e-13,2.35175371 1.35175371,1 3.01923077,1 C4.68670783,1 6.03846154,2.35175371 6.03846154,4.01923077 L6.038,6.769 L19.461308,6.76900028 C19.9236955,6.76900028 20.3257865,7.08600759 20.4336953,7.53562733 L23.8952337,21.9587043 C24.0461519,22.58753 23.5695289,23.1920772 22.9228464,23.1920772 L5.38461538,23.1923077 Z M18.673308,8.76876951 L16.084,8.768 L19.026,21.191 L21.655308,21.1917695 L18.673308,8.76876951 Z" id="形状结合" fill="#44576F" fill-rule="nonzero"></path> </g> </g> </g> </g></svg>'},className:"disk_2LT12",ref:a}),e.createElement("div",{style:v,dangerouslySetInnerHTML:{__html:'<?xml version="1.0" encoding="UTF-8"?><svg width="100%" height="100%" viewBox="0 0 14 67" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>播放杆</title> <g id="12-15" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="切图" transform="translate(-753.000000, -332.000000)"> <g id="播放杆" transform="translate(753.000000, 332.000000)"> <rect id="矩形" fill-opacity="0" fill="#FFFFFF" x="0" y="0" width="14" height="67"></rect> <g id="编组-15"> <rect id="矩形" fill="#FFFFFF" x="7.01" y="5" width="4" height="42"></rect> <g id="编组-8" transform="translate(6.010000, 0.000000)"> <path d="M3,0 C4.65685425,-3.04359188e-16 6,1.34314575 6,3 L6,6 C6,6.55228475 5.55228475,7 5,7 L1,7 C0.44771525,7 6.76353751e-17,6.55228475 0,6 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z" id="矩形" fill="#ECEEF2"></path> <path d="M3,0 C4.65685425,-3.04359188e-16 6,1.34314575 6,3 L6,6 C6,6.55228475 5.55228475,7 5,7 L4.25,7 C4.80228475,7 5.25,6.55228475 5.25,6 L5.25,3 C5.25,1.47019445 4.10494329,0.207831221 2.6251482,0.0232286416 C2.74833582,0.00786051157 2.87324995,2.32836065e-17 3,0 Z" id="形状结合" fill="#E6E9EE"></path> <path d="M3,0 C4.65685425,-3.04359188e-16 6,1.34314575 6,3 L6,6 C6,6.55228475 5.55228475,7 5,7 L4.5,7 C5.05228475,7 5.5,6.55228475 5.5,6 L5.5,3 C5.5,1.42728822 4.2898121,0.137230979 2.74986537,0.0102573404 C2.83184663,0.00349227777 2.91551548,1.5519554e-17 3,0 Z" id="形状结合" fill="#D4D8DE"></path> <path d="M3,0 C4.65685425,-3.04359188e-16 6,1.34314575 6,3 L6,6 C6,6.55228475 5.55228475,7 5,7 L4.75,7 C5.30228475,7 5.75,6.55228475 5.75,6 L5.75,3 C5.75,1.34314575 4.40685425,-3.04359188e-16 2.75,0 L2.87524791,0.00254679692 C2.91662136,0.000854438036 2.9582109,7.67653319e-18 3,0 Z" id="形状结合" fill="#C3C7CF"></path> <path d="M3,0 C3.08448452,-1.5519554e-17 3.16815337,0.00349227777 3.25087007,0.0103403504 C1.7101879,0.137230979 0.5,1.42728822 0.5,3 L0.5,6 C0.5,6.55228475 0.94771525,7 1.5,7 L1,7 C0.44771525,7 6.76353751e-17,6.55228475 0,6 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z" id="形状结合" fill="#E3E5E8"></path> <path d="M3,0 L3.13617551,0.00211949201 C1.53206522,0.0619571956 0.25,1.38125741 0.25,3 L0.25,6 C0.25,6.55228475 0.69771525,7 1.25,7 L1,7 C0.44771525,7 6.76353751e-17,6.55228475 0,6 L0,3 C-2.02906125e-16,1.34314575 1.34314575,3.04359188e-16 3,0 Z" id="形状结合" fill="#D4D7DC"></path> </g> <g id="编组-13" transform="translate(6.010000, 45.000000)"> <path d="M1,0 L5,0 C5.55228475,-1.01453063e-16 6,0.44771525 6,1 L6,10 L6,10 L0,10 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 Z" id="矩形" fill="#ECEEF2"></path> <path d="M5,0 C5.55228475,-1.01453063e-16 6,0.44771525 6,1 L6,10 L5.25,10 L5.25,1 C5.25,0.44771525 4.80228475,-1.01453063e-16 4.25,0 L5,0 Z" id="形状结合" fill="#E6E9EE"></path> <path d="M5,0 C5.55228475,-1.01453063e-16 6,0.44771525 6,1 L6,10 L5.5,10 L5.5,1 C5.5,0.44771525 5.05228475,-1.01453063e-16 4.5,0 L5,0 Z" id="形状结合" fill="#D4D8DE"></path> <path d="M5,0 C5.55228475,-1.01453063e-16 6,0.44771525 6,1 L6,10 L5.75,10 L5.75,1 C5.75,0.44771525 5.30228475,-1.01453063e-16 4.75,0 L5,0 Z" id="形状结合" fill="#C3C7CF"></path> <path d="M1.5,0 C0.94771525,1.01453063e-16 0.5,0.44771525 0.5,1 L0.5,10 L0,10 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 Z" id="形状结合" fill="#E3E5E8"></path> <path d="M1.25,0 C0.69771525,1.01453063e-16 0.25,0.44771525 0.25,1 L0.25,10 L0,10 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 Z" id="形状结合" fill="#D4D7DC"></path> </g> <g id="编组-14" transform="translate(0.000000, 50.000000)"> <path d="M3.96410162,1.06217783 L9.96410162,1.06217783 C10.5163864,1.06217783 10.9641016,1.50989308 10.9641016,2.06217783 L10.9641016,11.0621778 C10.9641016,13.2713168 9.17324061,15.0621778 6.96410162,15.0621778 C4.75496262,15.0621778 2.96410162,13.2713168 2.96410162,11.0621778 L2.96410162,2.06217783 C2.96410162,1.50989308 3.41181687,1.06217783 3.96410162,1.06217783 Z" id="矩形" fill="#F8F8F8" transform="translate(6.964102, 8.062178) rotate(30.000000) translate(-6.964102, -8.062178) "></path> <path d="M7.8660254,0.5 L13.0621778,3.5 C13.5404704,3.77614237 13.7043456,4.38773278 13.4282032,4.8660254 C13.3436672,4.71884243 13.2200504,4.59114775 13.0621778,4.5 L7.8660254,1.5 C7.38773278,1.22385763 6.77614237,1.38773278 6.5,1.8660254 L2,9.66025404 C1.7253348,10.1359881 1.55950023,10.6446911 1.4947716,11.1575339 C1.38960366,10.3215668 1.54637951,9.44594777 2,8.66025404 L6.5,0.866025404 C6.77614237,0.38773278 7.38773278,0.223857625 7.8660254,0.5 Z" id="形状结合" fill="#FFFFFF"></path> <path d="M13.4282032,4.8660254 L8.92820323,12.660254 C7.82363373,14.5734245 5.37727211,15.2289252 3.46410162,14.1243557 C2.0266652,13.2944514 1.29919322,11.707095 1.4947716,10.1575339 C1.64593992,11.3564499 2.33662485,12.4734066 3.46410162,13.1243557 C5.37727211,14.2289252 7.82363373,13.5734245 8.92820323,11.660254 L13.4288753,3.86685951 C13.6007304,4.16589696 13.6130675,4.54583103 13.4282032,4.8660254 Z" id="形状结合" fill="#ECECEC"></path> </g> </g> </g> </g> </g></svg>'},className:"bar_3ktUH",ref:s})))},oB=function(e){var t=e.position,n=e.size,i=e.scale,r=e.titleHeight,o=js.value.exportType,a=r*i,s=n.width*i,l=n.height*i,c=s,u=l+a,d=c/480;function p(){var t={x:0,y:0,width:s,height:l};3===e.transStatus||2===e.transStatus?qR(e,t,d):Ua(t)}if(yf(e),r){var h=[["M",c,0],["L",c,u],["L",0,u],["L",0,0],["Z"]];fa({x:t.x,y:t.y}),za([new Sa(h)]),fa({scaleX:d,scaleY:d}),Na((function(e){e.clear(),e.beginFill(16119542),e.drawRect(0,0,480,26),e.endFill(),e.lineStyle(1,15527150),e.moveTo(0,25.5),e.lineTo(480,25.5)})),Oa({src:If,x:8,y:3,width:20,height:20}),Ra(e.useMemo("nameText",(function(){return{text:e.name,textWidth:406,lineHeight:18,fontSize:10,lineClamp:1,textOverflow:"ellipse",fontFamily:He}}),[e.name]),{x:36,y:4,fill:"#0C1024"}),e.maxBtn.render(),ma(),fa({x:0,y:r*i}),p(),ma(),void 0===o&&!1!==e.upime.view.isImmersivePlaying&&e.upime.view.playingElement===e||(fa({stroke:"#D8D8D8",lineWidth:2*d}),Ta(h),ma()),ma()}else PN({element:e,size:{width:s,height:l},position:t}),fa(exports.E({},t)),p(),ma();ma()},aB=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.embeddedRenderer=rB,i.embedRenderKey="",i.renderer=oB,i.elementType=Za.AUDIO,i.bypassStableInterActCheck=!0,i.isPlaying=!1,i._onAudioPlayed=function(){i.isPlaying=!0,i.upime.publish("mediaPlayed",i)},i._onAudioPaused=function(){i.isPlaying=!1,i.upime.publish("mediaPaused",i)},i.mediaPlayer.on("play",i._onAudioPlayed),i.mediaPlayer.on("pause",i._onAudioPaused),i.embedRenderKey=i.renderKey,i.mediaPlayer.attachParent(document.getElementById("upime-audio-container")),i}return P(t,e),t.prototype.initPlayer=function(){return new KN},t.prototype.prepareMediaElement=function(){var e=this.upime.applyAudioElement(this);this.mediaPlayer.attachMedia(e)},t.prototype.unbindMediaDom=function(){var e=this.mediaPlayer.dom;e&&this.upime.releaseAudioElement(e),this.mediaPlayer.detachMedia()},t.prototype.checkClickName=function(e){return HN(this,e)},t.prototype._checkSelectRelation=function(t,n){return e.prototype._checkSelectRelation.call(this,t,n)||("click"!==(null==n?void 0:n.type)&&"move"!==(null==n?void 0:n.type)||!this.checkClickName(t)?null:{metric:-1,transparent:!1})},t.prototype.onDelete=function(){this.mediaPlayer.off("play",this._onAudioPlayed),this.mediaPlayer.off("pause",this._onAudioPaused),e.prototype.onDelete.call(this)},t.prototype.getTranscodedUrl=function(e){return e+"_t.mp3"},t}($R),sB=function(e){function t(t,n,i){var r=e.call(this)||this;return r.parentType=t,r.parentId=n,r.mediaTime=i,r.id=r.genId(),r}return P(t,e),Object.defineProperty(t.prototype,"baseElePos",{get:function(){if(this.baseElement){var e=this.baseElement,t=e.position,n=e.titleHeight,i=e.scale;return{x:t.x,y:t.y+n*i}}},enumerable:!1,configurable:!0}),t.prototype.getRelateInfo=function(){var e=this,t=e.parentId,n=e.mediaTime;return{parentType:e.parentType,parentId:t,mediaTime:n}},t.prototype.genId=function(){return t.genId(this.parentId,this.mediaTime)},Object.defineProperty(t.prototype,"level",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unavailable",{get:function(){var e;return!(null===(e=this.baseElement)||void 0===e?void 0:e.marking)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportComment",{get:function(){return!0},enumerable:!1,configurable:!0}),t.genId=function(e,t){return"".concat(e,"_rs_").concat(t)},t}(Us),lB=function(e){function t(n,i,r){var o=e.call(this)||this;return o.parentId=n,o.rowId=i,o.columnId=r,o.isTable=void 0===i||void 0===r,o.id=t.genId(o.parentId,o.rowId,o.columnId),o}return P(t,e),Object.defineProperty(t.prototype,"highDimension",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseElePos",{get:function(){var e,t,n;if(void 0===this.rowId||void 0===this.columnId)return null===(e=this.baseElement)||void 0===e?void 0:e.position;var i=null===(n=null===(t=this.baseElement)||void 0===t?void 0:t.gridsMap[this.rowId])||void 0===n?void 0:n[this.columnId];return i?i.position:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseEleSize",{get:function(){var e,t,n;if(void 0===this.rowId||void 0===this.columnId)return null===(e=this.baseElement)||void 0===e?void 0:e.size;var i=null===(n=null===(t=this.baseElement)||void 0===t?void 0:t.gridsMap[this.rowId])||void 0===n?void 0:n[this.columnId];if(i){var r=this.baseElement.scale,o=i.size;return{width:o.width/r,height:o.height/r}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportComment",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.compareElement=function(e,t){return"elementType"in e&&e.elementType===Za.GRID_TEXT?-1:"elementType"in t&&t.elementType===Za.GRID_TEXT?1:e.zIndex!==t.zIndex?e.zIndex-t.zIndex:e.id>t.id?1:-1},t.prototype.genId=function(){return t.genId(this.parentId,this.rowId,this.columnId)},t.prototype.getRelateInfo=function(){return{parentType:Za.TABLE,parentId:this.parentId,rowId:this.rowId,columnId:this.columnId}},t.genId=function(e,t,n){return void 0===t||void 0===n?"".concat(e,"_rs_table"):"".concat(e,"_rs_").concat(t,"_").concat(n)},t.prototype.getRefSystemListIfBorderCross=function(t,n){var i=this;if(!this.isTable)return e.prototype.getRefSystemListIfBorderCross.call(this,t,n);var r=this.baseElement,o=this.baseEleSize;if(!r||!o)return[];var a=r.xOffsetArr.map((function(e){return e/i.globalTransform.currentScale})),s=r.yOffsetArr.map((function(e){return e/i.globalTransform.currentScale})),l=this.globalTransform.applyInverse({x:t.left,y:t.top}),c=o.width,u=o.height;if(l.x>c||l.y>u)return[];var d=this.globalTransform.applyInverse({x:t.right,y:t.bottom});if(d.x<0||d.y<0)return[];for(var p=a.findIndex((function(e,t){return 0===t&&l.x<e||t===a.length-1||e<=l.x&&a[t+1]>l.x})),h=s.findIndex((function(e,t){return 0===t&&l.y<e||t===s.length-1||e<=l.y&&s[t+1]>l.y})),f=a.findIndex((function(e,t){return t===a.length-1||e<=d.x&&a[t+1]>d.x})),m=s.findIndex((function(e,t){return t===s.length-1||e<=d.y&&s[t+1]>d.y})),v=[],g=h;g<=m;g++)v.push.apply(v,r.grids[g].slice(p,f+1));var y=Array.from(new Set(v.map((function(e){return r.getCellsGroup(e)[0]})))).map((function(e){return e.selfRefSystem})).filter(Boolean);return n&&(y=y.filter(n)),y},t.prototype.getRefSystemIfBorderIn=function(t,n){if(!this.isTable)return e.prototype.getRefSystemIfBorderIn.call(this,t,n);var i=this.getRefSystemListIfBorderCross(t,n);if(0!==i.length)for(var r=Math.floor((i.length-1)/2),o=r;o>=0&&o<=i.length-1;){var a=i[o];if(a.checkBorderIn(t))return a;o=o>r?r-(o-r):r+(r-o)+1}},t.prototype.getRefSystemIfPointIn=function(t,n){var i=this;if(!this.isTable)return e.prototype.getRefSystemIfPointIn.call(this,t,n);if(this.checkPointIn(t)){var r=this.baseElement;if(r){var o=this.globalTransform.applyInverse(t),a=r.xOffsetArr.map((function(e){return e/i.globalTransform.currentScale})),s=r.yOffsetArr.map((function(e){return e/i.globalTransform.currentScale})),l=a.findIndex((function(e,t){return t===a.length-1||e<=o.x&&a[t+1]>o.x})),c=s.findIndex((function(e,t){return t===s.length-1||e<=o.y&&s[t+1]>o.y})),u=r.grids[c][l],d=r.getCellsGroup(u)[0].selfRefSystem;if(!d||!n||n(d))return d}}},t.prototype.getSelfTransform=function(){var t,n;if(!(this.rowId&&this.columnId&&this.baseElement&&this.parentRefSystem))return e.prototype.getSelfTransform.call(this);var i=this.baseElement.scale,r=null===(n=null===(t=this.baseElement)||void 0===t?void 0:t.gridsMap[this.rowId])||void 0===n?void 0:n[this.columnId],o=this.baseElement.xOffsetArr[r.cIdx]/i,a=this.baseElement.yOffsetArr[r.rIdx]/i;return new ar({x:o,y:a})},t.prototype.bindBaseElement=function(e){this.baseElement=e,this.updateTransform(),this.isTable?e.selfRefSystem=this:this.rowId&&this.columnId&&(e.gridsMap[this.rowId][this.columnId].selfRefSystem=this)},t}(Us),cB=function(t){var n=t.propEditor,i=n.editor,r=n.element,o=W().getUpimeTrans;return e.createElement(Dl,{placement:"top",content:o("webpage.openLink")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:function(){i.upime.gotoLink(r.url)}},e.createElement(hl,{icon:"dakailianjie"}))))},uB=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.element=n,i.couldAffectGroup=!1,i.propertyName="openLink",i.renderer=cB,i}return P(t,e),t}(ay);function dB(t){var n=t.element,i=t.upime;return t.viewbox,t.placeholder,n.element.preview?null:e.createElement(Eb,{element:n,upime:i})}var pB=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.domRenderer=dB,t.phoneMode&&"default"!==r.phoneToolbarMode||r.propertyEditors.push(new WR(r,n,!r.editable)),r.editable&&r.propertyEditors.push(new cy(r,n)),r.propertyEditors.push(new uB(r,n)),r.nameCtrl=new FN,r}return P(t,e),t.prototype.getMinSize=function(){return 18},t.prototype.dealBorderResize=function(e,t,n){var i=t.left,r=t.top,o=t.right-i,a=Xe.width,s=Xe.height,l=this.element.position,c={position:exports.E(exports.E({},l),{x:i,y:r}),scale:o/a},u=this.element.size;u.width===a&&u.height===s||(c.size={width:a,height:s}),this.updateSelf(c)},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.supportLinkTo=function(){return!1},t.prototype.doRename=function(){var e;null===(e=this.nameCtrl)||void 0===e||e.selectName()},t.prototype.select=function(){e.prototype.select.call(this),this.element.activeWebviewer()},t.prototype.unselect=function(){e.prototype.unselect.call(this),this.element.inactiveWebviewer()},t.prototype.switchToText=function(){var e=this.element,t=e.url,n=e.name,i=e.position,r=this.getOp();this.dealDeleteGroup(r),this.doDelete(r),this.upime.insertTextAt(i,{text:n,link:t,verticalPos:"top",currentOp:r,autoStartEdit:!1})},t}(Ob),hB=function(t){var n=t.viewbox,i=t.element,r=t.zIndex,o=e.useRef(null);e.useEffect((function(){var e=o.current;return i.bindDom(e)}),[]);var a=i.size.width*i.scale*n.scale/Qe.width,s={zIndex:r,left:(i.position.x-n.left)*n.scale,top:(i.position.y+26*i.scale-n.top)*n.scale,width:Qe.width,height:Qe.height,transform:"scale(".concat(a,")"),transformOrigin:"0 0"};return i.mounted||(s.visibility="hidden"),e.createElement("div",{ref:o,className:VN,style:s})},fB=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.embeddedRenderer=hB,i.embedRenderKey="",i.elementType=Za.WEBPAGE,i.beginLoadTime=Date.now(),i.preview=!1,i.name="",i.url="",i.title="",i.coverFileId="",i.coverSize={width:0,height:0},i.description="",i.status=1,i.renderer=Uf,i.editorType=pB,i.titleHeight=26,i.iframeHtmlTags=null,i.dealDoubleClick=CM(i),i.size=Xe;var r=i.previewBtn=new WN(i,"previewBtn");r.x=368,r.y=2,r.width=74,r.height=22,r.onclick=function(){i.togglePreview(),i.upime.updateView()},i.addInnerWidget(r);var o=i.maxBtn=new WN(i,"maxBtn",Af);return o.x=450,o.y=2,o.iconSize=18,o.onclick=function(){i.upime.maximizeElement(i)},i.addInnerWidget(o),i}return P(t,e),Object.defineProperty(t.prototype,"showPreviewInfo",{get:function(){return!this.upime.curMeetingChannel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPreviewBtn",{get:function(){return!this.upime.curMeetingChannel||this.upime.curMeetingChannel.isVncHost},enumerable:!1,configurable:!0}),t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+a*s,rotate:this.rotate}},t.prototype.updateImageFile=function(){var e=this.coverFileId;e&&(this.imageFile&&this.imageFile.id===e||(this.imageFile=new pu(this.upime,e,this.coverSize)))},t.prototype.dealUpdate=function(t){var n=t,i=n.coverFileId;n.size;var r=N(n,["coverFileId","size"]);e.prototype.dealUpdate.call(this,r),void 0!==i&&i!==this.coverFileId&&(this.coverFileId=i,t.deleted||this.deleted||this.updateImageFile()),(t.position||t.size||void 0!==t.scale)&&this.updateBorderBox()},t.prototype.onAdd=function(){e.prototype.onAdd.call(this),this.updateImageFile()},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.imageFile=void 0,this.stopPreview()},t.prototype.togglePreview=function(){this.preview?this.stopPreview():this.startPreview()},t.prototype.startPreview=function(){this.upime.requestPreviewWebpage(this)},t.prototype.stopPreview=function(){this.upime.cancelPreviewWebpage(this)},t.prototype.activeWebviewer=function(){var e=this.webviewer;e&&e.focus()},t.prototype.inactiveWebviewer=function(){var e=this.webviewer;e&&e.blur()},t.prototype.bindDom=function(e){var t=this,n=this.webviewer;return this.webviewerBorder=e,n&&n.attachParent(e),function(){t.webviewerBorder===e&&(t.webviewerBorder=void 0)}},t.prototype.doStopPreview=function(){var e;this.tempVncView&&(this.upime.closeLocalVnc(this),this.tempVncView=void 0),null===(e=this.webviewer)||void 0===e||e.destroy(),this.webviewer=void 0,this.upime.view.removeEmbeddedElement(this),this.preview=!1},t.prototype.doStartPreview=function(e,t){void 0===t&&(t=!0),this.webviewer&&this.webviewer!==e&&this.webviewer.destroy(),this.webviewer=e,this.webviewerBorder&&this.webviewer.attachParent(this.webviewerBorder),this.embedRenderKey=this.renderKey+Date.now(),this.upime.view.addEmbeddedElement(this),this.preview=!0,t&&this.upime.selectElement(this)},t}(oy),mB={default:'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h48v48H0z"/><path d="M3 3h42v42H3z"/><path data-follow-fill="#0C1024" d="M30.876 4.75a1.925 1.925 0 0 1 0 3.85h-4.921v2.037c8.26.953 14.67 7.865 14.67 16.25 0 9.037-7.443 16.363-16.625 16.363S7.375 35.924 7.375 26.887c0-8.385 6.41-15.297 14.67-16.25L22.043 8.6h-4.92a1.925 1.925 0 0 1 0-3.85h13.752ZM24 14.161c-7.141 0-12.93 5.698-12.93 12.726 0 7.03 5.789 12.727 12.93 12.727s12.93-5.698 12.93-12.726c0-7.03-5.789-12.727-12.93-12.727Zm.002 3.355c1.08 0 1.954.875 1.954 1.954l-.001 6.455h3.213a1.925 1.925 0 0 1 0 3.85H23.97a1.925 1.925 0 0 1-1.925-1.925v-8.38c0-1.08.875-1.954 1.954-1.954Z" fill="#0C1024" fill-rule="nonzero"/></g></svg>',timeout:'<svg width="48px" height="48px" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <title>计时器超时</title>\n    <g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="icon" transform="translate(-77.000000, -7.000000)">\n            <g id="计时器超时" transform="translate(77.000000, 7.000000)">\n                <g id="结束倒计时备份">\n                    <rect id="矩形" x="0" y="0" width="48" height="48"></rect>\n                </g>\n                <g id="计时器备份" transform="translate(3.000000, 3.000000)">\n                    <rect id="矩形" x="0" y="0" width="42" height="42"></rect>\n                    <path d="M27.8764706,1.75 C28.9396187,1.75 29.8014706,2.61185186 29.8014706,3.675 C29.8014706,4.73814814 28.9396187,5.6 27.8764706,5.6 L22.955,5.6 L22.955534,7.63700086 C31.2157261,8.58958295 37.625,15.5018766 37.625,23.8875 C37.625,32.9242592 30.181734,40.25 21,40.25 C11.818266,40.25 4.375,32.9242592 4.375,23.8875 C4.375,15.5018766 10.7842739,8.58958295 19.044466,7.63700086 L19.044,5.6 L14.1235294,5.6 C13.0603813,5.6 12.1985294,4.73814814 12.1985294,3.675 C12.1985294,2.61185186 13.0603813,1.75 14.1235294,1.75 L27.8764706,1.75 Z M21,11.1611111 C13.8586514,11.1611111 8.06944444,16.8589095 8.06944444,23.8875 C8.06944444,30.9160905 13.8586514,36.6138889 21,36.6138889 C28.1413486,36.6138889 33.9305556,30.9160905 33.9305556,23.8875 C33.9305556,16.8589095 28.1413486,11.1611111 21,11.1611111 Z M21.0021145,14.515807 C22.0811507,14.515807 22.9558824,15.3905387 22.9558824,16.4695749 L22.955,22.925 L26.1683399,22.925 C27.231488,22.925 28.0933399,23.7868519 28.0933399,24.85 C28.0933399,25.9131481 27.231488,26.775 26.1683399,26.775 L20.9691176,26.775 C19.9059695,26.775 19.0441176,25.9131481 19.0441176,24.85 L19.0441176,16.4695749 C19.0441176,15.3905387 19.9188493,14.515807 20.9978855,14.515807 Z" id="形状结合" fill="#FE5250" fill-rule="nonzero"></path>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>',last10:'<svg width="48px" height="48px" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n<title>计时器即将超时</title>\n<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n    <g id="icon" transform="translate(-12.000000, -7.000000)">\n        <g id="计时器即将超时" transform="translate(12.000000, 7.000000)">\n            <g id="结束倒计时备份">\n                <rect id="矩形" x="0" y="0" width="48" height="48"></rect>\n            </g>\n            <g id="计时器备份" transform="translate(3.000000, 3.000000)">\n                <rect id="矩形" x="0" y="0" width="42" height="42"></rect>\n                <path d="M27.8764706,1.75 C28.9396187,1.75 29.8014706,2.61185186 29.8014706,3.675 C29.8014706,4.73814814 28.9396187,5.6 27.8764706,5.6 L22.955,5.6 L22.955534,7.63700086 C31.2157261,8.58958295 37.625,15.5018766 37.625,23.8875 C37.625,32.9242592 30.181734,40.25 21,40.25 C11.818266,40.25 4.375,32.9242592 4.375,23.8875 C4.375,15.5018766 10.7842739,8.58958295 19.044466,7.63700086 L19.044,5.6 L14.1235294,5.6 C13.0603813,5.6 12.1985294,4.73814814 12.1985294,3.675 C12.1985294,2.61185186 13.0603813,1.75 14.1235294,1.75 L27.8764706,1.75 Z M21,11.1611111 C13.8586514,11.1611111 8.06944444,16.8589095 8.06944444,23.8875 C8.06944444,30.9160905 13.8586514,36.6138889 21,36.6138889 C28.1413486,36.6138889 33.9305556,30.9160905 33.9305556,23.8875 C33.9305556,16.8589095 28.1413486,11.1611111 21,11.1611111 Z M21.0021145,14.515807 C22.0811507,14.515807 22.9558824,15.3905387 22.9558824,16.4695749 L22.955,22.925 L26.1683399,22.925 C27.231488,22.925 28.0933399,23.7868519 28.0933399,24.85 C28.0933399,25.9131481 27.231488,26.775 26.1683399,26.775 L20.9691176,26.775 C19.9059695,26.775 19.0441176,25.9131481 19.0441176,24.85 L19.0441176,16.4695749 C19.0441176,15.3905387 19.9188493,14.515807 20.9978855,14.515807 Z" id="形状结合" fill="#FFA519" fill-rule="nonzero"></path>\n            </g>\n        </g>\n    </g>\n</g>\n</svg>'},vB=new Map;["default","last10","timeout"].forEach((function(e){return function(e){var t=vB.get(e);t||(t=tr("data:image/svg+xml,"+encodeURIComponent(function(e){return'<?xml version="1.0" encoding="UTF-8"?>'.concat(mB[e])}(e))),vB.set(e,t),er(t))}(e)}));var gB,yB=function(e,t,n,i){var r=t.selectionStart,o=t.selectionEnd,a=Math.min(r,o),s=Math.max(r,o),l="mi"===t.name?.2:.4;a!==s&&Na((function(t){t.clear(),t.beginFill(11257845),t.drawRect(e*a,0,e*(s-a),.38*i)}),{x:n*l,y:.3*i})},bB=function(e,t,n,i,r,o){var a=r.cursorPosition,s=(performance.now()-t.useMemo("cursorShowTime",(function(){return performance.now()}),[a]))%1e3,l=s<500,c=js.value.renderApp;null==c||c(s<500?500-s:1e3-s,t),l&&Na((function(t){t.clear(),t.beginFill(0),t.drawRect(e*a.x,a.y,.006*n,.38*i)}),{x:n*o,y:.3*i})},EB=function(e){var t=e.position,n=e.size,i=e.scale,r=e.minutes,o=e.seconds,a=e.status,s=e.currentTime,l=e.duration,c=e.onTimerPlay,u=e.onTimerPause,d=e.onTimerStop,p=e.onPlusOne,h=e.onPlusFive,f=e.upime,m=e.miTextWidget,v=e.seTextWidget,g=n.width,y=n.height;g*=i,y*=i;var b=!!f.followManager.followingUser||!f.editable,E=function(){var e=.028*g;return[["M",g-e,0],["R",g,0,g,e,e],["L",g,y-e],["R",g,y,g-e,y,e],["L",e,y],["R",0,y,0,y-e,e],["L",0,e],["R",0,0,e,0,e],["Z"]]}();yf(e),fa({x:t.x,y:t.y}),Na((function(e){e.clear(),e.beginFill(16777215),e.drawRoundedRect(0,0,g,y,.028*g)})),fa({stroke:"#DBDBDE",lineWidth:.002*g}),Ta(E),ma(),function(e){var t=e.width,n=e.height,i=e.status,r=e.currentTime,o=e.readOnly?.27:.06,a="default";"timing"===i&&r<=10?a="last10":"timeout"===i&&(a="timeout"),Oa({src:vB.get(a),x:t*o,y:.36*n,width:.28*n,height:.28*n})}({width:g,height:y,status:a,currentTime:s,readOnly:b}),"ready"!==a||b?function(e){var t=e.status,n=e.width,i=e.height,r=e.minutes,o=e.seconds,a=e.currentTime,s=e.fontSize,l="#303445",c={v:.4,h:.2},u={v:.375,h:.345},d={v:.4,h:.4};e.readOnly&&(c={v:.5,h:.4},u={v:.47,h:.545},d={v:.5,h:.6},"timeout"===t&&(c.v=.4,u.v=.375,d.v=.4)),"ready"===t?l="#303445":"timeout"===t?l="#fe5250":"timing"==t?(l="#303445",a<=10&&(l="#ffa519")):"pause"===t&&(l="#91939c"),Ra({fontSize:s,text:r},{x:n*c.h,y:i*c.v,fill:l,va:"middle"}),Ra({fontSize:s,text:":"},{x:n*u.h,y:i*u.v,fill:l,va:"middle"}),Ra({fontSize:s,text:o},{x:n*d.h,y:i*d.v,fill:l,va:"middle"})}({status:a,width:g,height:y,minutes:r,seconds:o,currentTime:s,fontSize:30*i,readOnly:b}):function(e){var t=e.fontSize,n=e.width,i=e.height,r=e.miTextWidget,o=e.seTextWidget,a=e.element;e.scale;var s=r.text,l=r.cursorPosition,c=o.text,u=o.cursorPosition,d=Wi(["00"],{fontSize:t,fontFamily:He,lineHeight:87}).width;yB(d,r,n,i),yB(d,o,n,i),Ra({fontSize:t,text:s},{x:.2*n,y:.5*i,fill:"#303445",va:"middle"}),Ra({fontSize:t,text:":"},{x:.345*n,y:.47*i,fill:"#303445",va:"middle"}),Ra({fontSize:t,text:c},{x:.4*n,y:.5*i,fill:"#303445",va:"middle"}),l&&bB(d,a,n,i,r,.2),u&&bB(d,a,n,i,o,.4)}({fontSize:30*i,width:g,height:y,miTextWidget:m,seTextWidget:v,element:e,scale:i}),!b&&function(e){var t,n=e.width,i=e.height,r=e.status;Na((t="ready"===r?.4:.6,function(e){var r=i*t;e.clear(),e.lineStyle({color:14408670,width:.005*n}),e.moveTo(0,0-.5*r),e.lineTo(0,0+.5*r)}),{x:.6*n,y:.5*i})}({width:g,height:y,status:a}),"ready"!==a&&"pause"!==a||b||function(e){var t=e.width,n=e.height,i=e.onTimerPlay,r=e.status,o=e.duration,a="ready"===r?.8:.88,s="ready"===r&&0===o;Na((function(e){var t=.2*n;e.clear(),e.beginFill(s?11257845:i?5740786:3044325),e.lineStyle({color:s?11257845:i?5740786:3044325,width:2}),e.drawCircle(0,0,t),e.endFill()}),{x:t*a,y:.5*n}),Na((function(e){var t=.25*n;e.clear(),e.beginFill(16777215),e.lineStyle({join:"round",color:16777215}),e.moveTo(0-.16*t,0-.3*t),e.lineTo(0-.16*t,0+.3*t),e.lineTo(0+.26*t,0),e.closePath(),e.endFill()}),{x:t*a,y:.5*n})}({width:g,height:y,onTimerPlay:c,status:a,duration:l}),"timing"!==a&&"pause"!==a&&"timeout"!==a||b||function(e){var t=e.width,n=e.height,i=e.onTimerStop,r="timeout"===e.status?.8:.71;Na((function(e){var r=.2*n;e.clear(),e.beginFill(16777215),e.lineStyle({color:i?5740786:3044325,width:.007*t}),e.drawCircle(0,0,r),e.endFill()}),{x:t*r,y:.5*n}),Na((function(e){var n=.04*t;e.clear(),e.beginFill(i?5740786:3044325),e.drawRoundedRect(0-.5*n,0-.5*n,n,n,.007*t)}),{x:t*r,y:.5*n})}({width:g,height:y,onTimerStop:d,status:a}),"timeout"===a&&function(e){var t=e.width,n=e.height,i=e.readOnly,r=e.fontSize,o=i?.56:.355,a=.1*t;Na((function(e){e.clear(),e.beginFill(16667216,.05),e.drawRoundedRect(0-.52*a,0-.3*a,a,.5*a,8)}),{x:t*o,y:.67*n}),Ra({fontSize:r,text:O("timer.overtime")},{x:t*o,y:.655*n,fill:"#fe5250",va:"middle",ha:"center"})}({width:g,height:y,readOnly:b,fontSize:7*i}),"timing"!==a||b||function(e){var t=e.width,n=e.height,i=e.onTimerPause;Na((function(e){var r=.2*n;e.clear(),e.beginFill(i?5740786:3044325),e.lineStyle({color:i?5740786:3044325,width:.007*t}),e.drawCircle(0,0,r),e.endFill()}),{x:.88*t,y:.5*n}),Na((function(e){var i=.3*n;e.clear(),e.lineStyle({color:16777215,width:.007*t}),e.moveTo(0-.1*i,0-.2*i),e.lineTo(0-.1*i,0+.2*i),e.moveTo(0+.1*i,0-.2*i),e.lineTo(0+.1*i,0+.2*i),e.endFill()}),{x:.88*t,y:.5*n})}({width:g,height:y,onTimerPause:u}),"timing"!==a&&"pause"!==a||b||(function(e){var t=e.fontSize,n=e.width,i=e.height,r=e.onPlusOne,o=.1*n;Na((function(e){e.clear(),e.beginFill(r&&_e.desktop?5740786:15397372),e.drawRoundedRect(0-.5*o,0-.2*o,o,.5*o,.028*n)}),{x:.28*n,y:.65*i}),Ra({fontSize:t,text:"+1m"},{x:.28*n,y:.665*i,fill:r&&_e.desktop?"#ffffff":"#2e73e5",va:"middle",ha:"center"})}({fontSize:10*i,width:g,height:y,onPlusOne:p}),function(e){var t=e.fontSize,n=e.width,i=e.height,r=e.onPlusFive,o=.1*n;Na((function(e){e.clear(),e.beginFill(r&&_e.desktop?5740786:15397372),e.drawRoundedRect(0-.5*o,0-.2*o,o,.5*o,.028*n)}),{x:.43*n,y:.65*i}),Ra({fontSize:t,text:"+5m"},{x:.43*n,y:.665*i,fill:r&&_e.desktop?"#ffffff":"#2e73e5",va:"middle",ha:"center"})}({fontSize:10*i,width:g,height:y,onPlusFive:h})),ma(),ma()},xB=function(t){var n,i=t.propEditor,r=W().getUpimeTrans,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u=i.element,d=i.editor,p=[r("timer.5m"),r("timer.15m"),r("timer.30m"),r("timer.custom")],h={300:r("timer.5m"),900:r("timer.15m"),1800:r("timer.30m")},f="ready"===u.status?null!==(n=h[u.duration])&&void 0!==n?n:r("timer.custom"):r("timer.label"),m="ready"===u.status&&u.upime.editable;return e.createElement("div",{ref:c,onPointerDown:ie,className:"time_duration_3hmZ8"},e.createElement("div",{className:Ml.icon_box,onClick:l,style:{height:"50px"}},e.createElement(ul,{className:jr},f)),!a&&m&&e.createElement(xh,{align:"center"},e.createElement("div",{className:Gr},p.map((function(t,n){return e.createElement("div",{key:t,onClick:function(){return function(e){3!==e?d.updateProperty({duration:300*(Math.pow(2,e)+e)}):u.miTextWidget.autoStartEdit(),s(!0)}(n)}},t)})))))},wB=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.couldAffectGroup=!1,t.propertyName="duration",t.renderer=xB,t}return P(t,e),t}(ay),CB=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.propertyEditors.push(new wB(r,n)),r}return P(t,e),t.prototype.getMinSize=function(){return 45},t.prototype.supportLinkTo=function(){return!0},t.prototype.setDuration=function(e){this.element.setDuration(e)},t.prototype.dealBorderResize=function(e,t){var n=t.left,i=t.top,r=(t.right-n)/this.element.size.width,o=this.element.position;this.updateSelf({position:exports.E(exports.E({},o),{x:n,y:i}),scale:r})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.select=function(){e.prototype.select.call(this),this.element.upime.view.setConnectedTextWidget([this.element.miTextWidget,this.element.seTextWidget])},t.prototype.unselect=function(){this.element.miTextWidget.unselect(),this.element.seTextWidget.unselect(),this.element.upime.view.clearConnectedTextWidget(),this.currentLock&&this.upime.clearLock(this.currentLock)},t.prototype.dealTextSelect=function(e){var t=e.position,n=e.startPosition,i=this.element,r=i.globalTransform,o=i.miTextWidget,a=i.seTextWidget;t=r.applyInverse(t),n=r.applyInverse(n);var s=o.editing?o:a;if(e.isStart){var l=s.getTextRelation(n).point;s.setSelectionStart(l.x)}var c=s.getTextRelation(t);if(c){var u=c.point;s.updateSelection(u.x)}},t.prototype.checkSelectRelation=function(t,n){var i=this;return function(e){var t=i.element,n=t.miTextWidget,r=t.seTextWidget;return!(!n.editing||!n.getTextRelation(e))||!(!r.editing||!r.getTextRelation(e))}(t=this.commRefSystem.globalTransform.applyInverse(t))?{transparent:!1,metric:-1,metaData:{selectingText:!0}}:e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.dealClick=function(e){var t,n=this.element.disableTimerOp||"ready"!==this.element.status;if("right"!==e.connectType&&!n){var i=this.element.globalTransform.applyInverse(e.position),r=this.element.miTextWidget.dealClick(e,i),o=this.element.seTextWidget.dealClick(e,i);this.editing=r||o,this.editing?(this.currentLock&&this.upime.clearLock(this.currentLock),this.currentLock=this.upime.createLock([this.element.id]),this.currentOp=this.upime.createOperation()):(null===(t=this.currentOp)||void 0===t||t.checkIsEmpty(),this.currentOp=void 0,this.currentLock&&this.upime.clearLock(this.currentLock),this.currentLock=void 0)}},t}(Ob),SB={wrapper:"wrapper_2m78x",action:"action_yVhGM",closeIcon:"closeIcon_31TLx"},kB=function(t){var n=t.element,i=t.upime,r=t.id,o=W().getUpimeTrans,a=_e.isPhone?o("timer.overtime.text.short"):o("timer.overtime.text"),s=_e.isPhone?o("timer.check.short"):o("timer.check");return e.createElement("div",{className:SB.wrapper},e.createElement("div",{className:SB.text},a),e.createElement(ul,{type:"primary",className:SB.action,onClick:function(){return e=i.getElementLink,t=i.gotoLink,void(e&&t(e(n.id)));var e,t}},s),e.createElement(hl,{icon:"guanbi",className:SB.closeIcon,onClick:function(){i.removeToast(n.toastIds[r])}}))},_B=function(){function e(e,t){this.element=e,this.name=t,this.text="",this.editing=!1,this.cursorPosition=null,this.caret=0,this.selectionStart=0,this.selectionEnd=0,this.inputDOM=null}return Object.defineProperty(e.prototype,"textRect",{get:function(){var e="mi"===this.name?.2:.4,t=this.element,n=t.position,i=t.size,r=t.scale;return{x:n.x+i.width*r*e,y:n.y+i.height*r*.4,width:i.width*r*.115,height:i.height*r*.2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelecting",{get:function(){return this.selectionStart!==this.selectionEnd},enumerable:!1,configurable:!0}),e.prototype.setCursorPosition=function(){this.cursorPosition={x:this.caret,y:0}},e.prototype.eraseCursorPosition=function(){this.cursorPosition=null},e.prototype.setCaret=function(e){this.caret=e},e.prototype.updateDuration=function(){if("mi"===this.name){var e=Math.min(59,parseInt(this.text||"0")),t=parseInt(this.element.seconds);this.element.upime.updateElement(this.element,{duration:60*e+t})}else"se"===this.name&&(e=parseInt(this.element.minutes),t=Math.min(59,parseInt(this.text||"0")),this.element.upime.updateElement(this.element,{duration:60*e+t}))},e.prototype.getTextRelation=function(e){var t=this.textRect,n=t.x,i=t.y,r=t.width,o=t.height;return n<e.x&&e.x<n+r&&i<e.y&&e.y<i+o?(e.x<n+r/4?this.caret=0:n+.25*r<e.x&&e.x<n+.75*r?this.caret=.5:this.caret=1,{point:{x:this.caret,y:0}}):null},e.prototype.dealClick=function(e,t){var n=this.getTextRelation(t);if(n){var i=n.point;return!(""===this.text&&i.x>0||1===this.text.length&&i.x>.5||(2===e.Hits?(0===i.x?this.setSelection(0,.5):.5===i.x?this.setSelection(0,1):1===i.x&&this.setSelection(.5,1),this.updateInputSelection(),this.eraseCursorPosition()):(this.setCaret(i.x),this.setCursorPosition(),this.setSelection(0,0)),this.startEdit(),0))}return this.setSelection(0,0),this.stopEdit(),!1},e.prototype.updateView=function(){this.element.upime.updateView()},e.prototype.setSelection=function(e,t){this.selectionStart=e,this.selectionEnd=t},e.prototype.setSelectionStart=function(e){this.selectionStart=e},e.prototype.updateSelection=function(e){this.selectionEnd=e,this.caret=e,e!==this.selectionStart?this.cursorPosition=null:this.setCursorPosition(),this.updateView(),this.updateInputSelection()},e.prototype.updateInputSelection=function(){var e=this.inputDOM;if(e){var t=this.selectionStart,n=this.selectionEnd;e.setSelectionRange(2*t,2*n)}},e.prototype.startEdit=function(){var e,t=this.element.upime,n=t.view;if(!_e.desktop){var i=Lt(this.element.getGlobalBox()),r=n.getViewbox(),o=r.bottom,a=r.top,s=r.left,l=o-a;if(i.y>=a+l/2){var c=i.y-(a+l/4);t.slideViewTo(s,a+c,n.scale,100)}}null===(e=this.inputDOM)||void 0===e||e.focus(),this.editing=!0,this.updateView(),n.setCursor("text",this)},e.prototype.autoStartEdit=function(){this.setCaret(1),this.setCursorPosition(),this.startEdit()},e.prototype.stopEdit=function(){var e;!_e.desktop&&(null===(e=this.inputDOM)||void 0===e||e.blur()),this.editing&&this.updateDuration(),this.eraseCursorPosition(),this.editing=!1,this.element.upime.view.setCursor("",this)},e.prototype.unselect=function(){this.eraseCursorPosition(),this.setSelection(0,0),this.editing&&this.updateDuration(),this.editing=!1,this.element.upime.view.setCursor("",this)},e.prototype.updateTextInputValue=function(){var e=this.inputDOM;e&&(e.value=this.text)},e.prototype.bindDOM=function(e){var t=this;this.inputDOM=e,_e.desktop&&e.focus(),this.updateTextInputValue();var n=function(e){t.handleKeydown(e)},i=function(){t.eraseCursorPosition()},r=function(e){e.preventDefault(),e.stopPropagation(),t.element.upime.userEventManager.publish("copy",void 0)},o=function(e){e.preventDefault()},a=function(e){return t.handleInput(e),!0};return e.addEventListener("keydown",n),e.addEventListener("beforeinput",a),e.addEventListener("blur",i),e.addEventListener("copy",r),e.addEventListener("paste",o),function(){e.removeEventListener("keydown",n),e.removeEventListener("beforeinput",a),e.addEventListener("blur",i),e.removeEventListener("copy",r),e.removeEventListener("paste",o),t.inputDOM=null}},e.prototype.deleteSelected=function(){var e=Math.min(this.selectionStart,this.selectionEnd),t=Math.max(this.selectionStart,this.selectionEnd);0===e?this.text=this.text.slice(2*t):.5===e&&(this.text=this.text.slice(0,2*e)),this.caret=Math.min(e,.5*this.text.length),this.setSelection(0,0),this.setCursorPosition()},e.prototype.updateSelected=function(e){var t=Math.min(this.selectionStart,this.selectionEnd),n=Math.max(this.selectionStart,this.selectionEnd);0===t?(.5===n?this.text=e+this.text.slice(1):1===n&&(this.text=e),this.caret=.5):.5===t&&(this.text=this.text.slice(0,1)+e,this.caret=1),this.setSelection(0,0),this.setCursorPosition()},e.prototype.handleInput=function(e){switch(e.inputType){case"deleteContentBackward":this.isSelecting?this.deleteSelected():(1===this.caret?this.text=this.text.slice(0,1):.5===this.caret&&(this.text=this.text.slice(1)),this.caret-=.5,this.caret=Math.max(this.caret,0),this.setCursorPosition()),this.updateView();break;case"insertText":var t=e.data;if("0"<=t&&t<="9"){if(this.isSelecting)this.updateSelected(t);else{if(2===this.text.length)return;0===this.caret?this.text=t+this.text:.5===this.caret&&(this.text+=t),this.caret+=.5,this.caret=Math.min(this.caret,1),this.updateTextInputValue(),this.setCursorPosition()}this.updateView()}}return!0},e.prototype.handleKeydown=function(e){"ArrowRight"===e.key?(this.caret+=.5,this.caret=Math.min(this.caret,.5*this.text.length),this.setCursorPosition(),this.updateView()):"ArrowLeft"===e.key&&(this.caret-=.5,this.caret=Math.max(this.caret,0),this.setCursorPosition(),this.updateView())},e}(),TB=0,IB=function(t){function n(e,n){var i=t.call(this,e,n)||this;return i.duration=300,i._currentTime=300,i._status="ready",i.elementType=Za.TIMER,i.renderer=EB,i.editorType=CB,i.onTimerPlay=!1,i.onTimerPause=!1,i.onTimerStop=!1,i.onPlusOne=!1,i.onPlusFive=!1,i.shouldPlay=!1,i.allowedPlay=!1,i.loaded=!1,i.audioPlayer=new KN,i.anim=0,i.decTimer=0,i.incTimer=0,i.toastIds=[],i.toastKey=0,i.timePast=0,i.editing=!1,i.onAudioEnded=function(){i.finishPlay()},i.unsubs=[i.upime.subscribe("stopFollowInMeeting",(function(){i.endFollowOther()})),i.upime.subscribe("sdkAction",(function(e){if("usersEvent"===e.type){var t=e.payload,n=i.upime.followManager.followingUser,r=t.changedUsers;n&&r&&r.find((function(e){return e.loginName===n.loginName}))&&i.endFollowOther()}}))],i.timingFlag=!0,i.timeoutFlag=!0,i.millTime=0,i.startTimestamp=0,i.startTime=0,i.handleTiming=function(){var e=Math.floor((performance.now()-i.startTimestamp)/1e3);i.currentTime=i.startTime-e,i.upime.updateView()},i.handleTimeout=function(){var e=Math.floor((performance.now()-i.startTimestamp)/1e3);i.currentTime=i.startTime+e,i.upime.updateView()},i.getScreenPosition=function(){return i.upime.view.getScreenPosition(i.position)},i.audioPlayer.on("ended",i.onAudioEnded),i.audioPlayer.attachParent(document.getElementById("upime-audio-container")),i.miTextWidget=new _B(i,"mi"),i.seTextWidget=new _B(i,"se"),i}return P(n,t),Object.defineProperty(n.prototype,"minutes",{get:function(){var e="ready"===this.status?this.duration:this.currentTime,t=Math.floor(e/60);return t<10?"0"+t:t>59?"59":String(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"seconds",{get:function(){var e=("ready"===this.status?this.duration:this.currentTime)%60;return e<10?"0"+e:e>59?"59":String(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._currentTime},set:function(e){this.millTime=Date.now(),this._currentTime=Math.min(3599,e),this.upime.timerManager.update({currentTime:e,id:this.id}),"timing"===this.status?0===e&&this.enterTimeout():"timeout"===this.status&&3599===e&&this.stop()},enumerable:!1,configurable:!0}),n.prototype.enterTimeout=function(){this.status="timeout",this.currentTime=0,window.clearInterval(this.anim),this.anim=window.setInterval(this.handleTimeout,1e3);var t=Date.now();t-TB>1e3&&(TB=t,this.playAudio(),this.upime.localUserInfo.role!==Pt.RECORD_ASSISTANT&&this.toastIds.push(this.upime.addToast(e.createElement(kB,{upime:this.upime,element:this,id:this.toastKey++}),{autoHide:!1})))},Object.defineProperty(n.prototype,"status",{get:function(){return this._status},set:function(e){this._status=e,this.upime.timerManager.update({status:this.status,id:this.id}),window.clearInterval(this.anim),"timing"===e&&this.timingFlag&&(this.startTimestamp=performance.now(),this.startTime=this.currentTime,this.anim=window.setInterval(this.handleTiming,1e3)),"timeout"===e&&this.timeoutFlag&&(this.startTimestamp=performance.now(),this.startTime=this.currentTime,this.anim=window.setInterval(this.handleTimeout,1e3)),this.dealLocalStatusChange(),this.upime.view.update()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disableTimerOp",{get:function(){if(!this.upime.editable)return!0;var e=this.upime.view.scale;return this.size.width*this.scale*e<100&&this.size.height*this.scale*e<40},enumerable:!1,configurable:!0}),n.prototype.loadAudioSrc=function(){var e=this;this.audioPlayer.once("canplay",(function(){e.allowedPlay&&(e.loaded=!0,e.shouldPlay&&e.audioPlayer.play())})),this.audioPlayer.src=$o("timer_end.mp3")},n.prototype.requestPlay=function(){var e=this.upime.applyTimerElement();this.bindDom(e),this.allowedPlay=!0},n.prototype.finishPlay=function(){this.audioPlayer.src="",this.allowedPlay=!1,this.loaded=!1,this.unbindDom()},n.prototype.playAudio=function(){this.shouldPlay=!0,this.allowedPlay||this.requestPlay(),this.loaded?this.audioPlayer.play():this.loadAudioSrc()},n.prototype.bindDom=function(e){this.audioPlayer.attachMedia(e)},n.prototype.unbindDom=function(){var e=this.audioPlayer.dom;e&&this.upime.releaseTimerElement(e),this.audioPlayer.detachMedia()},n.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+a*s}},n.prototype.dealLocalStatusChange=function(){var e=this.upime.getCurServerTime();this.upime.followManager.syncTimerStatus(this,{currentTime:1e3*this.currentTime,status:this.status,timestamp:e})},n.prototype.dealUpdate=function(e){t.prototype.dealUpdate.call(this,e),e.duration&&(this.duration=e.duration),e.currentTime&&(this.currentTime=e.currentTime),e.status&&(this.status,e.status),(e.position||e.size||void 0!==e.scale)&&this.updateBorderBox(),e.selected&&this.upime.selectElement(this),e.editing&&this.startEdit(),this.updateTextWidget()},n.prototype.startEdit=function(){var e=this;this.upime.nextTick((function(){e.miTextWidget.autoStartEdit()}))},n.prototype.updateTextWidget=function(){this.miTextWidget.text=this.minutes,this.seTextWidget.text=this.seconds},n.prototype.endFollowOther=function(){window.clearTimeout(this.decTimer),window.clearTimeout(this.incTimer),"timing"===this.status?this.pause():"timeout"===this.status&&this.stop(),this.upime.updateView()},n.prototype.useServerTimerStatus=function(e){var t=this,n=e.currentTime,i=e.timestamp,r=e.status;window.clearTimeout(this.decTimer),window.clearTimeout(this.incTimer);var o=this.upime.getCurServerTime()-i;if("timing"===r){if(0===n)return void this.enterTimeout();if(o<=0)return this.currentTime=Math.ceil((n-o)/1e3),void this.start();o>0&&(this.timingFlag=!1,this.currentTime=Math.ceil((n-o)/1e3),this.decTimer=window.setTimeout((function(){t.timingFlag=!0,t.start()}),1e3-o%1e3))}else if("timeout"===r){if(o<=50)return void this.enterTimeout();this.timeoutFlag=!1,this.currentTime=Math.ceil((n+o)/1e3),this.incTimer=window.setTimeout((function(){t.timeoutFlag=!0,t.timeout()}),1e3-o%1e3)}else{if(this.status===r)return;this.currentTime=n/1e3}this.status=r},n.prototype.dealClickStart=function(e){var n;if(null===(n=e.metaData)||void 0===n?void 0:n.clickData){this.upime.view.setCursor("pointer",this);var i=e.metaData.clickData,r=i.onTimerPlay,o=i.onTimerPause,a=i.onTimerStop,s=i.onPlusOne,l=i.onPlusFive;this.setOnButton({onPlusOne:s,onPlusFive:l}),r?("ready"===this.status&&(this.currentTime=this.duration),this.start()):o?this.pause():a?this.stop():s?(this.currentTime=Math.min(3599,this.currentTime+60),this.startTime+=60,3599===this.currentTime&&(this.startTimestamp=performance.now(),this.startTime=3599),this.dealLocalStatusChange()):l?(this.currentTime=Math.min(3599,this.currentTime+300),this.startTime+=300,3599===this.currentTime&&(this.startTimestamp=performance.now(),this.startTime=3599),this.dealLocalStatusChange()):t.prototype.dealClickStart.call(this,e)}},n.prototype.dealHoverStart=function(e){var n;if(null===(n=e.metaData)||void 0===n?void 0:n.clickData){var i=e.metaData.clickData,r=i.onTimerPlay,o=i.onTimerPause,a=i.onTimerStop,s=i.onPlusOne,l=i.onPlusFive;this.setOnButton({onTimerPlay:r,onTimerPause:o,onTimerStop:a,onPlusOne:s,onPlusFive:l}),r||o||a||s||l?this.upime.view.setCursor("pointer",this):t.prototype.dealHoverStart.call(this,e)}},n.prototype.dealHoverEnd=function(){t.prototype.dealHoverEnd.call(this),this.onTimerPlay=!1,this.onTimerPause=!1,this.onTimerStop=!1,this.onPlusOne=!1,this.onPlusFive=!1},n.prototype.setOnButton=function(e){var t=e.onTimerPlay,n=e.onTimerPause,i=e.onTimerStop,r=e.onPlusOne,o=e.onPlusFive;t&&(this.onTimerPlay=t),n&&(this.onTimerPause=n),i&&(this.onTimerStop=i),r&&(this.onPlusOne=r),o&&(this.onPlusFive=o)},n.prototype._isPointInCircle=function(e,t){var n=this,i=n.position,r=n.size,o=n.scale,a=r.width,s=r.height;return Zt(e,{center:{x:i.x+a*o*t,y:i.y+s*o*.5},r:s*o*.2})},n.prototype._isPointInBox=function(e,t,n){var i=this,r=i.position,o=i.size,a=i.scale,s=o.width,l=o.height;return Ot(e,{left:r.x+s*a*t,right:r.x+s*a*n,top:r.y+l*a*.6,bottom:r.y+l*a*.73})},n.prototype.checkInteractRelation=function(e,n){if(this.upime.followManager.followingUser||!this.upime.editable||!n||this.disableTimerOp)return null;if("ready"===this.status&&0===this.duration)return null;var i=n.type;if("click"===i||"hover"===i){if("ready"===this.status&&this._isPointInCircle(e,.8))return{transparent:!1,metric:-1,metaData:{clickData:{onTimerPlay:!0}}};if("timing"===this.status||"pause"===this.status){if("timing"===this.status&&this._isPointInCircle(e,.88))return{transparent:!1,metric:-1,metaData:{clickData:{onTimerPause:!0}}};if("pause"===this.status&&this._isPointInCircle(e,.88))return{transparent:!1,metric:-1,metaData:{clickData:{onTimerPlay:!0}}};if(this._isPointInCircle(e,.71))return{transparent:!1,metric:-1,metaData:{clickData:{onTimerStop:!0}}};if(this._isPointInBox(e,.23,.33))return{transparent:!1,metric:-1,metaData:{clickData:{onPlusOne:!0}}};if(this._isPointInBox(e,.38,.48))return{transparent:!1,metric:-1,metaData:{clickData:{onPlusFive:!0}}}}else if("timeout"===this.status&&this._isPointInCircle(e,.8))return{transparent:!1,metric:-1,metaData:{clickData:{onTimerStop:!0}}}}return t.prototype.checkInteractRelation.call(this,e,n)},n.prototype.setDuration=function(e){this.duration=e,this.upime.view.update()},n.prototype.start=function(){this._currentTime--,this.status="timing",0!==this.currentTime||this.enterTimeout()},n.prototype.pause=function(){this.status="pause"},n.prototype.stop=function(){this.status="ready",this.updateTextWidget()},n.prototype.timeout=function(){this.status="timeout"},n.prototype.onDelete=function(){this._currentTime=0,this._status="ready",this.upime.timerManager.update({status:"ready",currentTime:0,id:this.id}),window.clearInterval(this.anim),this.unsubs.forEach((function(e){return e()})),t.prototype.onDelete.call(this),this.finishPlay()},n.prototype.checkRelationInText=function(e){var t=this.globalTransform.applyInverse(e),n=this.miTextWidget.getTextRelation(t)||this.seTextWidget.getTextRelation(t);return Boolean(n)},n}(oy),PB={};!function(e){e.text="text",e.richText="richText",e.radio="radio",e.checkbox="checkbox",e.fileList="fileList",e.timeRange="timeRange",e.userList="userList"}(gB||(gB={}));var NB=function(e){var t=e.x,n=e.y,i=e.simpleTextProxy,r=e.hideCursor,o=void 0!==r&&r,a=i.editor,s=a.proxy.renderData;s&&(fa({x:t,y:n}),a.editing&&za([new wa({x:0,y:0,width:s.width+2,height:s.height})]),MB(a),o||AB(a),DB(a),ma())},MB=function(e){var t=e.proxy.renderData;if(t){var n=e.proxy.option.style,i=e.proxy.option.lineHeight,r=e.proxy.option.color,o=e.proxy.scrollX,a=0;t.lines.forEach((function(e){Ra(exports.E(exports.E({text:e.join("")},n),{lineHeight:i}),{x:-o,y:a,fill:r,fontWeight:n.fontWeight||void 0}),a+=i}))}},AB=function(e){if(e.editing&&e.showCursor){var t=e.selectionCursor;if(t){var n=e.proxy.scrollX,i=e.proxy.option.lineHeight;fa({fill:e.proxy.option.color}),ka({x:t.x-n,y:t.y,width:i/15,height:i}),ma()}}},DB=function(e){if(e.editing){var t=e.selectionArea;if(t){var n=e.proxy.option.lineHeight,i=e.proxy.scrollX;Na((function(e){e.beginFill(6134012,.5),t.forEach((function(t){var r=t.x,o=t.y,a=t.width;0==a&&(a=n/4),e.drawRect(r-i,o,a,n)})),e.endFill()}))}}};function RB(e,t,n){var i;void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.displayRows,o=js.value.getElementAlpha,a=(null==o?void 0:o(e))||1,s=js.value,l=s.addLoadingSource,c=s.viewbox,u=function(t,n){var i=e.displayUIRows[n];if(i&&"custom"===i.source){fa({x:8}),Ra({text:i.displayLabel,fontSize:12,fontFamily:He,lineHeight:20},{fill:"#616371"}),fa({x:i.labelWidth+8});var r=0;i.cells.forEach((function(e){fa({x:r}),function(e){var t=e.bgColor;void 0!==t&&Na((function(n){n.beginFill(t,.25),n.drawRoundedRect(0,0,e.width,20,4),n.endFill()})),Ra({text:e.label,fontSize:12,fontFamily:He,lineHeight:20},{x:void 0===t?0:8,y:0,fill:"#0c1024"})}(e),ma(),r+=e.width+4})),ma(),ma()}};Ma((function(t){var n=t.context;n.globalAlpha<.9||(n.save(),n.shadowColor="rgba(0,0,0,0.2)",n.shadowBlur=8*c.scale,n.shadowOffsetX=0,n.shadowOffsetY=2,n.fillStyle="white",n.beginPath(),n.moveTo(236,0),n.arcTo(240,0,240,4,4),n.lineTo(240,e.viewHeight-4),n.arcTo(240,e.viewHeight,236,e.viewHeight,4),n.lineTo(4,e.viewHeight),n.arcTo(0,e.viewHeight,0,e.viewHeight-4,4),n.lineTo(0,4),n.arcTo(0,0,4,0,4),n.closePath(),n.fill(),n.restore())})),Na((function(t){1===a&&t.lineStyle(1,e.color,1),t.beginFill(e.color),t.drawRoundedRect(0,0,240,e.viewHeight,4),1===a&&t.lineStyle(),t.endFill(),1===a&&t.lineStyle(1,16777215,1),t.beginFill(16777215);var n=.5/c.scale/e.scale;t.drawRoundedRect(-n,-n,240+2*n,e.viewHeight-4,4+2*n),1===a&&t.lineStyle(),t.endFill()})),fa({x:16,y:16}),e.textProxy.getRendeingContent()||Ra({text:O("kanban.no.name.placeholder"),fontSize:14,fontFamily:He,lineHeight:22},{x:0,y:0,fill:"#C2C3C8"}),NB({x:0,y:0,simpleTextProxy:e.textProxy,hideCursor:t});var d=e.getTitleHeight(),p=r.filter((function(e){return"defalut"===e.source})),h=r.filter((function(e){return"custom"===e.source}));if(p.length>0&&(d+=16,p.forEach((function(t,n){var i=r.indexOf(t);fa({y:d}),function(t,n){var i;fa({alpha:.6});var r=function(e){return _D(e.icon||"zhujiangjiaoshi")}(t);!r.loaded&&l&&l(r),Oa({src:r,x:0,y:((t.type===gB.userList?20:24)-14)/2,width:14,height:14}),ma();var o=e.displayUIRows[n];if(o){fa({x:22});var a=0;o.cells.forEach((function(e){fa({x:a}),function(e){var t=e.bgColor;void 0!==t&&Na((function(n){n.beginFill(t,.25),n.drawRoundedRect(0,0,e.width,24,4),n.endFill()})),Ra({text:e.label,fontSize:12,fontFamily:He,lineHeight:24},{x:void 0===t?0:8,y:0,fill:"#0c1024"})}(e),ma(),a+=e.width+4})),null===(i=o.users)||void 0===i||i.forEach((function(e,t){fa({y:24*t}),a=0,e.forEach((function(e){fa({x:a}),function(e){if(e.restCount)Na((function(t){t.beginFill(15132649),t.drawRoundedRect(0,0,e.width,20,10),t.endFill()})),Ra({text:e.label,fontSize:12,fontFamily:He,lineHeight:20},{fill:"#0c1024",x:4});else{var t=10;e.ava&&!e.ava.loaded&&l&&l(e.ava),e.ava&&e.ava.loaded?(fa({}),za([new Ca({cx:t,cy:t,rx:t,ry:t})]),Oa({src:e.ava,x:0,y:0,width:20,height:20}),ma()):Na((function(e){e.beginFill(14671839),e.drawCircle(t,t,t),e.endFill()})),e.noName?(fa({fill:"#dfdfdf"}),ka({x:24,y:4,width:36,height:12}),ma()):Ra({text:e.label,fontSize:12,fontFamily:He,lineHeight:20},{fill:"#0c1024",x:24})}}(e),ma(),a+=e.width+8})),ma()})),ma()}}(t,i),d+=e.getOptionHeight(t),n<p.length-1&&(d+=4),ma()}))),h.length>0){fa({y:d+=8}),function(e){var t=8+20*e+4*(e-1);Na((function(e){e.beginFill(16119542),e.drawRoundedRect(0,0,208,t,2),e.endFill()}))}(h.length);var f=4;h.forEach((function(e){var t=r.indexOf(e);fa({y:f}),u(0,t),f+=24,ma()})),ma()}ma();var m=js.value.exportType;n||m||null===(i=e.startEditWidget)||void 0===i||i.render()}var BB,LB=function(e){if(!e.isHideByFilter&&!0!==e.isGhost){var t=e.position,n=e.scale;fa({x:t.x,y:t.y,scaleX:n,scaleY:n}),RB(e),ma()}},OB=_D("jiantou-xia"),FB=_D("jiantou-shang"),zB=_D("settings"),HB=function(e){var t,n=e.position,i=e.viewHeight,r=e.viewWidth,o=e.scale,a=e.grids,s=e.colHeight,l=e.gridsUIInfo,c=e.hoverInfo,u=e.adsorptionLine,d=e.disPlayColGroupBy,p=e.disPlayConfigLabel,h=e.selectedState,f=e.editingNameCardIndex,m=e.wigetCardCol,v=js.value,g=v.exportType,y=v.viewbox,b=v.getElementAlpha,E=function(e){e.beginFill(16119542,1),e.drawRoundedRect(0,0,272,s,4),e.endFill()},x=e.isRadio,w=e.getBorderBox(),C=Ln(y,w)||w,S=(C.left-n.x)/o,k=(C.top-n.y)/o,_=(C.right-n.x)/o,T=(C.bottom-n.y)/o;yf(e),fa({x:n.x,y:n.y,scaleX:o,scaleY:o}),Ma((function(e){var t=e.context;t.globalAlpha<.9||(t.save(),t.shadowColor="rgba(0,0,0,0.2)",t.shadowBlur=Math.max(6,15*y.scale),t.shadowOffsetX=0,t.shadowOffsetY=2,t.fillStyle="white",t.beginPath(),t.moveTo(r-4,0),t.arcTo(r,0,r,4,4),t.lineTo(r,i-4),t.arcTo(r,i,r-4,i,4),t.lineTo(4,i),t.arcTo(0,i,0,i-4,4),t.lineTo(0,4),t.arcTo(0,0,4,0,4),t.closePath(),t.fill(),t.restore())})),Na((function(e){e.beginFill(16777215,1),e.drawRoundedRect(0,0,r,i,4),e.endFill()})),fa({x:16,y:46}),Na((function(e){e.lineStyle({color:15132649}),"setting"===c.config&&e.beginFill(16119542),e.drawRoundedRect(0,0,94,30,4),e.moveTo(110,5),e.lineTo(110,25),e.lineStyle(),"setting"===c.config&&e.endFill()})),Oa({src:zB,x:8,y:7,width:16,height:16}),Ra({text:p,fontSize:14,fontFamily:He,lineHeight:30},{x:28,y:0,fill:"#0C1024"}),fa({x:127}),Na((function(e){e.lineStyle({color:15132649}),"group"===c.config&&e.beginFill(16119542),e.drawRoundedRect(0,0,150,30,4),e.lineStyle(),"group"===c.config&&e.endFill()})),Ra({text:d,fontSize:14,fontFamily:He,lineHeight:30},{x:8,y:0,fill:"#0C1024"}),fa({alpha:.65}),Oa({src:"group"===h?FB:OB,x:126,y:7,width:16,height:16}),ma(),ma(),fa({y:46}),a.forEach((function(t,n){var i,r=280*n,o=u&&u.col===n?u:null;if(fa({x:r}),r+272+8>=S&&r<=_){Na(E),fa({x:16,y:16}),i=l[n],Na((function(e){e.beginFill(790564,1),e.lineStyle({color:15132649}),e.moveTo(i.titleWidth+8,4),e.lineTo(i.titleWidth+8,20),e.lineStyle(),e.endFill()})),Ra({text:i.countNumber.toString(),fontSize:16,fontFamily:He,lineHeight:24},{x:i.titleWidth+16+1,y:0,fill:"#0C1024"}),fa({y:36});var a=R([],t.cards,!0);a.reverse();var s=e.animateCtrl.percent,d=a.map((function(t){return e.animateCtrl.animateIndexList.some((function(e){return t.id===e.cardId&&(x||e.col===n)}))?t.viewHeight*s:t.viewHeight})),p=d.reduce((function(e,t){return e+t}),0)+(a.length?12*(a.length-1):0),h=p;e.upime.editable&&(fa({y:h+(0===t.cards.length?0:12)}),function(e){Na((function(t){e===c.addBt&&(t.beginFill(15527150),t.drawRect(0,0,24,24),t.endFill()),t.lineStyle({cap:"round",color:9540508,width:2}),t.moveTo(5,12),t.lineTo(19,12),t.moveTo(12,5),t.lineTo(12,19),t.lineStyle()}))}(n),ma()),a.forEach((function(t,i){var r,o=d[i];h-=o;var s=null===(r=e.movingCards)||void 0===r?void 0:r.some((function(e){return e.cardId===t.id&&(x||e.col===n)})),l=null==b?void 0:b(t);fa({y:h,globalAlpha:l});var c=142+h;if(c+o+12>=k&&c<=T){s&&fa({alpha:.3});var p=(null==f?void 0:f.cardId)===t.id&&(x||f.col===n);RB(t,!p,!(x||m===n)),s&&ma(),"base64"!==g&&t.link&&wf(t),!g&&t.showAttachComment&&Na((function(e){e.beginFill(8750469,.4),e.drawRect(0,0,240,t.viewHeight)}))}u&&u.col===n&&u.row===a.length-1-i&&(fa({y:-6,fill:"#0354DA"}),ka({x:0,y:0,width:240,height:2}),ma()),h-=12,ma()})),h=p,o&&o.row===t.cards.length&&(fa({y:0===t.cards.length?-6:h+6,fill:"#0354DA"}),ka({x:0,y:0,width:240,height:2}),ma()),ma(),ma()}ma()})),ma(),ma(),e.nameWidget.render(),e.filterWidget.render(),e.orderWidget.render(),null===(t=e.addColWidget)||void 0===t||t.render(),e.colActionWidgetList.forEach((function(e){return e.render()})),e.groupNameWidgetList.forEach((function(e){return e.render()})),ma(),ma();var I=e.movingFromOriginKanban||(e.movingToTargetKanban?null:e);I&&I.movingCards.forEach((function(e){var t=I.cardsMap.get(e.cardId);t&&(fa({x:e.x,y:e.y,scaleX:I.scale,scaleY:I.scale}),RB(t),ma())}))};function UB(t){var n=t.element,i=t.upime;return e.createElement(e.Fragment,null,e.createElement(Eb,{element:n,upime:i}))}!function(e){e[e.EQUAL=0]="EQUAL",e[e.CONTAIN=1]="CONTAIN"}(BB||(BB={}));var WB=function(e){this.cb=e,this.propertyName="cardStartEdit",this.couldAffectGroup=!1,this.renderer=VB},VB=function(t){var n=t.propEditor,i=W().getUpimeTrans;return e.createElement(Dl,{placement:"top",content:i("card.edit.tooltip")},e.createElement("div",{className:j(Ml.cm_item)},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:function(){n.cb()}},e.createElement(hl,{icon:"baibanquanping"}))))},jB="card_prop_container_3LvD7",GB="timeRangeLabel_1d37p",qB="timeRangeInputContainer_2hX7B",KB="placeholder_1VyK2",YB="clearIcon_r2FwP",XB="divider_3FDUF",QB="avatar_2-HlM",ZB="userName_JJlEs",JB="selectedContainer_1wECY",$B="displayItem_1CEOC",eL="close_2SSw1",tL="tiny_2mtcb",nL=function(t){var n=t.users,i=t.onChange,r=t.showUsers,o=void 0===r||r,a=t.maxHeight,s=void 0===a?300:a,l=t.showSend,c=void 0===l||l,u=W().getUpimeTrans,d=e.useContext(xl).upime,p=e.useState(Boolean(d.kanbanConfig.silentAddUser)),h=p[0],f=p[1];function m(e){var t,n;f(e),d.kanbanConfig.silentAddUser=e,null===(n=(t=d.kanbanConfig).saveKanbanSilentAddUser)||void 0===n||n.call(t,e)}var v=e.useState(""),g=v[0],y=v[1],b=rL(),E=b.userList,x=b.ready,w=e.useMemo((function(){return E.filter((function(e){return!g||e.userName.includes(g)}))}),[E,g]),C=e.useRef(null);return e.useEffect((function(){C.current&&C.current.focus()}),[C.current]),e.createElement("div",{className:j("userSelectContainer_QvMKC")},e.createElement("div",{className:"inputContainer_2v9CT"},e.createElement("input",{ref:C,value:g,onChange:function(e){return y(e.target.value)},type:"text",className:"input_s7rot",placeholder:u("common.placeholder.enter")})),e.createElement("div",{className:XB}),e.createElement("div",{className:"userContainer_1U_1t",style:{maxHeight:"".concat(s,"px")}},o&&e.createElement(oL,{users:n,onChange:i}),e.createElement("div",{className:"userList_mnCKl"},w.map((function(t){var r=n.includes(t.loginName);return e.createElement("div",{key:t.loginName,className:j("userItem_2OhRz",r&&"selected_2mewv"),onClick:function(){return function(e){n.includes(e.loginName)?i(n.filter((function(t){return t!==e.loginName}))):i(R(R([],n,!0),[e.loginName],!1)),y("")}(t)}},e.createElement(ml,{url:t.avatarUrl,className:QB}),e.createElement("div",{className:j(ZB)},t.userName),r&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",className:"dagou_2rBvy"}))})),x&&0===w.length&&e.createElement("div",{className:"noResult_3-dxj"},u("common.search.none")))),c&&e.createElement(e.Fragment,null,e.createElement("div",{className:XB}),e.createElement("div",{className:"sendContainer_3P_Zt"},e.createElement("div",{className:"sendRow_dNK7U"},e.createElement(of,{state:h?Zh.SelectNone:Zh.SelectAll,onSelectAll:function(){return m(!1)},onSelectNone:function(){return m(!0)}}),e.createElement("div",null,u("kaban.userlist.send"))))))};function iL(e){return null==e?[]:Array.isArray(e)?e:e.users}function rL(){var t=e.useContext(xl).upime,n=e.useState(iL(t.candidateListCache)),i=n[0],r=n[1],o=e.useState(!1),a=o[0],s=o[1];return e.useEffect((function(){var e=t.getMentionCandidate||t.getMentionGroupAndCandidate;null==e||e().then((function(e){t.candidateListCache=e;var n=iL(e);r(n),t.userManager.setUsers(n),t.updateView()})).finally((function(){return s(!0)}))}),[]),{userList:i,ready:a}}function oL(t){var n=t.users,i=t.onChange,r=t.tiny,o=e.useContext(xl).upime,a=e.useReducer((function(e){return e+1}),0),s=a[0],l=a[1];e.useEffect((function(){return o.subscribe("updatedUserInfo",l)}),[]);var c=e.useMemo((function(){return n.map((function(e){return o.userManager.getUser(e)}))}),[n,s]);return 0===n.length?null:e.createElement("div",{className:j(JB,r&&tL)},c.map((function(t){return e.createElement("div",{className:$B,key:t.loginName},e.createElement(ml,{url:t.avatarUrl,className:QB}),e.createElement("div",{className:j(ZB)},t.userName),e.createElement(hl,{icon:"guanbi",className:eL,size:14,onClick:function(e){e.stopPropagation(),e.preventDefault(),i(n.filter((function(e){return e!==t.loginName})))}}))})))}var aL="active_gVmSQ",sL="dateSelectorContainer_7OPhd",lL="phone_1imQn",cL="actionRow_32BLD",uL="cancel_290iU",dL="note_3sNXN",pL="queding_1xQeb",hL="dateSelectorHead_3eUQz",fL="iconArrow_2KtBy",mL="dateTitle_1mgFE",vL="useHover_2r_9X",gL="dateListContainer_3zcVm",yL="dateCell_23lOw",bL="notCurrentMon_-J_l9",EL="today_30ts6",xL="monthListContainer_1feVK",wL="monCell_2kpcK",CL="monCellActive_248eX";function SL(t){var n=t.value,i=t.onChange,r=W().getUpimeTrans,o=IL(n),a=o.trans,s=o.nextMonth,l=o.preMonth,c=o.dateList,u=o.year,d=o.transYear,p=o.preYear,h=o.nextYear,f=o.toTargetYearMonth,m=e.useState(!0),v=m[0],g=m[1],y=e.useMemo((function(){if(!n)return{valueYear:-1,valueMon:-1,valueDate:-1};var e=new Date(n);return{valueYear:e.getFullYear(),valueMon:e.getMonth(),valueDate:e.getDate()}}),[n]),b=y.valueYear,E=y.valueDate,x=y.valueMon;return e.createElement("div",{className:sL},e.createElement("div",{className:hL},e.createElement(hl,{icon:"jiantou-zuo",size:24,className:fL,onClick:function(){return v?l():p()}}),e.createElement("b",{onClick:function(){return g(!1)},className:j(mL,_e.desktop&&v&&vL)},v?a:d),e.createElement(hl,{icon:"jiantou-you",size:24,className:fL,onClick:function(){return v?s():h()}})),v&&e.createElement("div",{className:gL},_L.map((function(t,n){return e.createElement("div",{className:j(yL),key:n},r(t))})),c.map((function(t,n){return e.createElement("div",{className:j(yL,!t.isInCurrentMonth&&bL,t.isToday&&EL,t.year===b&&t.month===x&&t.date===E&&aL),key:100+n,onClick:function(){return i(t.dateObj.valueOf())}},t.date)}))),!v&&e.createElement("div",{className:xL},Array(12).fill(void 0).map((function(t,n){return e.createElement("div",{key:n,className:j(wL,u===b&&x===n&&CL),onClick:function(){f(u,n),g(!0)}},r(TL[n]))}))))}function kL(t){var n=t.value,i=t.label,r=t.onChange,o=W().getUpimeTrans,a=IL(n),s=a.trans,l=a.nextMonth,c=a.preMonth,u=a.dateList,d=a.year,p=a.transYear,h=a.preYear,f=a.nextYear,m=a.toTargetYearMonth,v=e.useState(!0),g=v[0],y=v[1],b=e.useState(n),E=b[0],x=b[1],w=e.useMemo((function(){if(!E)return{valueYear:-1,valueMon:-1,valueDate:-1};var e=new Date(E);return{valueYear:e.getFullYear(),valueMon:e.getMonth(),valueDate:e.getDate()}}),[E]),C=w.valueYear,S=w.valueDate,k=w.valueMon;return e.createElement("div",{className:j(sL,lL)},e.createElement("div",{className:cL},e.createElement("span",{className:uL,onClick:function(){r(n)}},o("common.cancel")),e.createElement("span",{className:dL},i),e.createElement("span",{className:pL,onClick:function(){r(E)}},o("common.queding"))),e.createElement("div",{className:j(hL,lL)},e.createElement(hl,{icon:"jiantou-zuo",size:24,className:fL,onClick:function(){return g?c():h()}}),e.createElement("b",{onClick:function(){return y(!1)},className:j(mL,_e.desktop&&g&&vL)},g?s:p),e.createElement(hl,{icon:"jiantou-you",size:24,className:fL,onClick:function(){return g?l():f()}})),g&&e.createElement("div",{className:gL},_L.map((function(t,n){return e.createElement("div",{className:j(yL),key:n},o(t))})),u.map((function(t,n){var i=t.year===C&&t.month===k&&t.date===S;return e.createElement("div",{className:j(yL,!t.isInCurrentMonth&&bL,t.isToday&&!i&&EL,i&&aL,lL),key:100+n,onClick:function(){x(t.dateObj.valueOf())}},t.date)}))),!g&&e.createElement("div",{className:j(xL,lL)},Array(12).fill(void 0).map((function(t,n){return e.createElement("div",{key:n,className:j(wL,d===C&&k===n&&CL),onClick:function(){m(d,n),y(!0)}},o(TL[n]))}))))}var _L=["datetime.Sunday.short","datetime.Monday.short","datetime.Tuesday.short","datetime.Wednesday.short","datetime.Thursday.short","datetime.Friday.short","datetime.Saturday.short"],TL=["datetime.January","datetime.February","datetime.March","datetime.April","datetime.May","datetime.June","datetime.July","datetime.August","datetime.September","datetime.October","datetime.November","datetime.December"];function IL(t){var n=W().getUpimeTrans,i=e.useState((t?new Date(t):new Date).getFullYear()),r=i[0],o=i[1],a=e.useState((t?new Date(t):new Date).getMonth()),s=a[0],l=a[1],c=e.useMemo((function(){return"".concat(r).concat(n("common.year")," ").concat(n(TL[s]))}),[r,s]),u=e.useMemo((function(){return"".concat(r).concat(n("common.year"))}),[r]),d=e.useMemo((function(){var e=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),i=e.getDate();return new Date(t,n,i)}();e.setMilliseconds(0);for(var t=[],n=function(e,t){return new Date(e,t+1,0).getDate()}(r,s),i=1;i<=n;i++){var o=new Date(r,s,i),a={date:i,day:o.getDay(),month:s,year:r,isToday:e.valueOf()===o.valueOf(),isInCurrentMonth:!0,dateObj:o};t.push(a)}for(;0!==t[0].day;){var l=new Date(t[0].dateObj.valueOf()-864e5);t.unshift({date:l.getDate(),day:l.getDay(),month:l.getMonth(),year:l.getFullYear(),isToday:l.valueOf()===e.valueOf(),isInCurrentMonth:!1,dateObj:l})}for(;6!==t[t.length-1].day;){var c=new Date(t[t.length-1].dateObj.valueOf()+864e5);t.push({date:c.getDate(),day:c.getDay(),month:c.getMonth(),year:c.getFullYear(),isToday:c.valueOf()===e.valueOf(),isInCurrentMonth:!1,dateObj:c})}return t}),[r,s]);return{year:r,month:s,trans:c,nextMonth:function(){s<11?l(s+1):(l(0),o(r+1))},preMonth:function(){s>0?l(s-1):(l(11),o(r-1))},dateList:d,transYear:u,preYear:function(){r>1970&&o(r-1)},nextYear:function(){o(r+1)},toTargetYearMonth:function(e,t){o(e),l(t)}}}var PL=function(){function e(e,t){this.card=e,this.cb=t,this.propertyName="CardValueEditor",this.couldAffectGroup=!1,this.renderer=ML,this.updateProperty=this.updateProperty.bind(this)}return e.prototype.getBorderColors=function(){return this.card.upime.userManager.userPalette},e.prototype.updateProperty=function(e){this.cb(e)},e}(),NL=[gB.radio,gB.checkbox,gB.userList,gB.timeRange],ML=function(t){var n,i=t.propEditor,r=i.card,o=((null===(n=r.pareantKanban)||void 0===n?void 0:n.attributes)||[]).filter((function(e){return("defalut"===e.source||e.showInToolbar)&&e.icon})).filter((function(e){return NL.includes(e.type)}));return e.createElement("div",{className:j("card_value_container_30DWN")},e.createElement(AL,{card:r,updateProperty:i.updateProperty}),o.map((function(t,n){var o=function(e){switch(e.type){case gB.radio:return DL;case gB.userList:return RL;case gB.timeRange:return BL;default:return null}}(t);if(o)return e.createElement(o,{key:n,card:r,updateProperty:i.updateProperty,attr:t})})))},AL=function(t){var n=t.card,i=t.updateProperty,r=W().getUpimeTrans,o=e.useContext(Ic),a=o.phoneLayout,s=o.phoneElementSubBarContainer,l={};a&&(l.checkSkip=function(e){return!!s.current&&V(s.current,e)});var c=yh(!0,l),u=c.hide,d=c.setHide,p=c.toggleHide,h=c.skipRef;function f(e){e&&(i({color:e}),d(!0))}var m=a?Xg:xh;return e.createElement("div",{className:j(jB),ref:h},e.createElement(Dl,{content:r("card.attr.color"),placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:p},e.createElement(Vb,{color:n.color,opacity:1})))),!u&&e.createElement(m,{align:"center",selfAdjust:!0},e.createElement(Yb,{colorPalettes:n.upime.userManager.userPalette,defaultValue:n.color,onChanged:f,colorPickerConfig:{onColorPickerChange:function(e,t){t.isEnd&&f(e)}}})))},DL=function(t){var n=t.card,i=t.attr,r=t.updateProperty,o=W().getUpimeTrans,a=yh(!0),s=a.hide,l=a.setHide,c=a.toggleHide,u=a.skipRef;if(i.type!==gB.radio)throw new Error("error type");var d=R([],i.typeExtraInfo.options,!0);function p(){var e;return(null===(e=n.values.find((function(e){return e.attribute===i.id})))||void 0===e?void 0:e.value)||""}d.push({id:"",label:o("card.edit.none"),icon:"wu",color:9934743,source:"custom"});var h=e.useState(p()),f=h[0],m=h[1];return e.useEffect((function(){s||m(p())}),[s]),e.createElement("div",{className:j(jB),ref:u},e.createElement(Dl,{content:i.label,placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:c},i.icon&&e.createElement(hl,{icon:i.icon})))),!s&&e.createElement(xh,{align:"center",selfAdjust:!0,className:"cardOptionContainer_2RMVH"},d.map((function(t,n){var o=f===t.id;return e.createElement("div",{key:n,className:j("cardItem_1dDNK",o&&"optionItemSelected_OW-rF"),onClick:function(){return function(e){var t=e||"";r({values:[{attribute:i.id,type:gB.radio,value:t}]}),m(t),l(!0)}(t.id)}},t.icon&&e.createElement(hl,{icon:t.icon,className:"icon_1V0Xs",style:{color:pr(t.color)}}),e.createElement("span",{className:"label_2JpRV"},t.label))}))))},RL=function(t){var n=t.card,i=t.attr,r=t.updateProperty;if(i.type!==gB.userList)throw new Error("error type");var o=e.useContext(Zg),a=o.disableAutoHide,s=o.enableAutoHide,l=yh(!0),c=l.hide,u=l.toggleHide,d=l.skipRef;function p(){var e;return(null===(e=n.values.find((function(e){return e.attribute===i.id})))||void 0===e?void 0:e.value)||[]}e.useEffect((function(){if(!c)return a(),function(){return s()}}),[c]);var h=e.useState(p()),f=h[0],m=h[1];return e.useEffect((function(){if(c){var e,t,o=p(),a=n.values.filter((function(e){return e.attribute!==i.id}));t=f,(e=o).length===t.length&&e.every((function(e,n){return e===t[n]}))||(a.push({attribute:i.id,type:gB.userList,value:f}),r({values:a}))}else m(p())}),[c]),e.createElement("div",{className:j(jB),ref:d},e.createElement(Dl,{content:i.label,placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:u},i.icon&&e.createElement(hl,{icon:i.icon})))),!c&&e.createElement(xh,{align:"center",selfAdjust:!0,className:"cardUserContainer_1UFqf"},e.createElement(nL,{users:f,onChange:function(e){m(e)}})))},BL=function(t){var n=t.card,i=t.attr,r=t.updateProperty;if(i.type!==gB.timeRange)throw new Error("error type");var o=W().getUpimeTrans,a=e.useContext(Zg),s=a.disableAutoHide,l=a.enableAutoHide,c=yh(!0),u=c.hide,d=c.toggleHide,p=c.skipRef;function h(){var e;return(null===(e=n.values.find((function(e){return e.attribute===i.id})))||void 0===e?void 0:e.value)||[void 0,void 0]}e.useEffect((function(){if(!u)return s(),function(){return l()}}),[u]);var f=e.useState(h()),m=f[0],v=f[1];e.useEffect((function(){if(u){if(!(m[1]&&m[0]&&m[1]<m[0])){var e=h();if(e[0]!==m[0]||e[1]!==m[1]){var t=n.values.filter((function(e){return e.attribute!==i.id}));t.push({attribute:i.id,type:gB.timeRange,value:m}),r({values:t})}}}else v(h())}),[u]);var g=e.useState(!1),y=g[0],b=g[1],E=e.useMemo((function(){return m.map(LL)}),[m[0],m[1]]),x=i.typeExtraInfo.timeRangeLabels,w=x[0],C=x[1],S=m[1]&&m[0]&&m[1]<m[0];return e.createElement("div",{className:j(jB),ref:p},e.createElement(Dl,{content:i.label,placement:"top"},e.createElement("div",{className:Ml.cm_item},e.createElement("div",{className:Ml.propEditorIconBox,onClick:d},i.icon&&e.createElement(hl,{icon:i.icon})))),!u&&e.createElement(xh,{align:"center",selfAdjust:!0,className:"cardTimeRangeContainer_1iwBD"},e.createElement("div",{className:"timeRangeInner_cHYkB"},e.createElement("div",{className:GB},w),e.createElement("div",{className:j(qB),onClick:function(){b("start"!==y&&"start")}},E[0]?e.createElement(e.Fragment,null,e.createElement("span",null,E[0]),e.createElement(hl,{icon:"qingchu",size:14,className:YB,onClick:function(e){e.stopPropagation(),v([void 0,m[1]])}})):e.createElement("span",{className:KB},o("card.attr.startendtime.placeholder"))),"start"===y&&e.createElement(SL,{value:m[0],onChange:function(e){v([e,m[1]]),b(!1)}}),e.createElement("div",{className:GB,style:{marginTop:"20px"}},C),e.createElement("div",{className:j(qB,S&&"error_1XCYp"),onClick:function(){b("end"!==y&&"end")}},E[1]?e.createElement(e.Fragment,null,e.createElement("span",null,E[1]),e.createElement(hl,{icon:"qingchu",size:14,className:YB,onClick:function(e){e.stopPropagation(),v([m[0],void 0])}})):e.createElement("span",{className:KB},o("card.attr.startendtime.placeholder"))),S&&e.createElement("div",{className:"errorText_3gG3G"},o("card.attr.startendtime.errortext")),"end"===y&&e.createElement(SL,{value:m[1],onChange:function(e){v([m[0],e]),b(!1)}}))))};function LL(e){if(!e)return"";var t=new Date(e);return"".concat(t.getFullYear(),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getDate().toString().padStart(2,"0"))}var OL=function(e){function t(t){var n=e.call(this,t)||this;return n.attrbiutes=[],n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"kanban"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),"kanban"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.insertKanban(e)}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}}},t.prototype.insertKanban=function(e){var t,n,i=1/this.upime.view.scale,r={x:e.position.x,y:e.position.y},o={zIndex:this.upime.newMaxZindex(),size:{width:0,height:0},position:r,name:O("kanban.default.name"),colGroupBy:null,rowGrouyBy:null,cards:[],attributes:[{id:"status",label:O("card.attr.status"),source:"defalut",type:gB.radio,visiable:!0,showInToolbar:!0,icon:"zhuangtaixianxing",typeExtraInfo:{options:[{id:"status-todo",label:O("card.attr.status.todo"),icon:"zhuangtaimianxing",color:8421504,editable:!1,source:"defalut"},{id:"status-doing",label:O("card.attr.status.doing"),icon:"zhuangtaimianxing",color:16434961,editable:!1,source:"defalut"},{id:"status-done",label:O("card.attr.status.done"),icon:"zhuangtaimianxing",color:9425231,editable:!1,source:"defalut"}]}},{id:"priority",label:O("card.attr.priority"),source:"defalut",type:gB.radio,visiable:!0,showInToolbar:!0,icon:"xianxingyouxianji",typeExtraInfo:{options:[{id:"priority-high",label:O("card.attr.priority.high"),icon:"youxianjimianxing",color:15812389,editable:!1,source:"defalut"},{id:"priority-middle",label:O("card.attr.priority.middle"),icon:"youxianjimianxing",color:16434961,editable:!1,source:"defalut"},{id:"priority-low",label:O("card.attr.priority.low"),icon:"youxianjimianxing",color:2989040,editable:!1,source:"defalut"}]}},{id:"participants",label:O("card.attr.participant"),source:"defalut",type:gB.userList,visiable:!0,showInToolbar:!0,icon:"tuandui",typeExtraInfo:{displayUsers:[]}},{id:"start-end-time",label:O("card.attr.startendtime"),source:"defalut",type:gB.timeRange,visiable:!0,showInToolbar:!0,icon:"rili",typeExtraInfo:{timeRangeLabels:[O("card.attr.startendtime.start"),O("card.attr.startendtime.end")]}},{id:"attachment",label:O("card.attr.attachment"),source:"defalut",type:gB.fileList,visiable:!0,showInToolbar:!1,icon:"lianjie"},{id:"description",label:O("card.attr.description"),source:"defalut",type:gB.richText,visiable:!0,icon:"miaoshu"}],scale:i,id:this.upime.genID(Za.KANBAN)},a=this.upime.kanbanManager.createKanban(o);this.upime.switchMode("select");var s=a.groupByAttr;(s&&s.type===gB.radio||(null==s?void 0:s.type)===gB.checkbox)&&(null===(n=null===(t=s.typeExtraInfo)||void 0===t?void 0:t.options)||void 0===n||n.forEach((function(e,t){a.createCard(t)}))),this.upime.selectElement(a)},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd);function FL(e,t){var n=t.elementManager.getAvailableElements((function(e){return e.elementType===Za.KANBAN&&!e.hideByFrame}));n.sort((function(e,t){return t.zIndex-e.zIndex}));var i=n.find((function(t){var n=t.getGlobalBox();return Ot(e,n)}));if(!i)return{};var r=i.checkCard(e);if(r){var o=i.grids[r.col].cards.findIndex((function(e){return e.id===r.cardId}));return{targetKanban:i,adsorptionLine:{col:r.col,row:o}}}var a=(e.x-i.position.x)/i.scale,s=(e.y-i.position.y)/i.scale,l=196+Math.max.apply(Math,i.gridsUIInfo.map((function(e){return e.cardListHeight}))),c=16,u=288,d=i.grids.findIndex((function(e,t){var n=i.gridsUIInfo[t].cardListHeight;return a>=c&&a<=u&&s>=144+n&&s<=l||(c+=280,u+=280,!1)}));return-1!==d?{targetKanban:i,adsorptionLine:{col:d,row:i.grids[d].cards.length}}:{targetKanban:i}}function zL(e,t){var n=t.groupByAttr;if(!n)return"";var i="",r=t.grids[0].id===Qz;if(0===e.col&&r)i="";else{var o=e.col-(r?1:0);if(n.type!==gB.radio&&n.type!==gB.checkbox||(i=n.typeExtraInfo.options[o].id),n.type===gB.userList){var a=t.grids[e.col].id;i=a===Qz?"":a}}return i}function HL(e,t){for(var n=void 0,i=void 0,r=e.col;r<t.grids.length;r++){var o=t.grids[r];if(r===e.col&&e.row===o.cards.length&&o.cards.length>0){i=o.cards[e.row-1];break}var a=r===e.col?o.cards[e.row]:o.cards[0];if(a){n=a;break}}return{preCard:i,afterCard:n}}function UL(e){var t=e.targetKanban,n=e.originKanban,i=e.preCard,r=e.afterCard,o=e.id,a=n?n.cards.findIndex((function(e){return e===o})):null,s=0;return i?s=t.cards.indexOf(i.id)+1:r?s=t.cards.indexOf(r.id):t.cards.length>0&&(s=t.cards.length-1),n&&!_t.isNil(a)&&t===n&&a<s&&(r||i)&&s--,{nowIndex:a,targetIndex:s}}function WL(e){var t=e.values,n=e.targetKanban,i=e.originKanban,r=e.originAttributes,o=e.targetValue,a=e.originColIndex,s={},l=!1,c=n!==i,u=[];t.forEach((function(e){var t;if(c){var o=null===(t=r||(null==i?void 0:i.attributes))||void 0===t?void 0:t.find((function(t){return t.id===e.attribute})),a=n.attributes.find((function(t){return"defalut"===t.source&&t.id===e.attribute})),s=n.attributes.find((function(e){return"custom"===e.source&&e.label===(null==o?void 0:o.label)&&e.type===o.type})),d=a||s;if(d)if((null==o?void 0:o.type)===gB.radio&&d.type===gB.radio){var p=o.typeExtraInfo.options.find((function(t){return t.id===e.value}));if("defalut"===(null==p?void 0:p.source)){var h=d.typeExtraInfo.options.find((function(t){return"defalut"===t.source&&t.id===e.value}));h&&u.push(e)}"custom"===(null==p?void 0:p.source)&&(h=d.typeExtraInfo.options.find((function(e){return"custom"===e.source&&e.label===p.label})),h&&(l=!0,u.push({value:h.id,attribute:d.id,type:d.type})))}else(null==o?void 0:o.type)===gB.checkbox&&d.type===gB.checkbox||u.push(e)}else u.push(e)}));var d=n.groupByAttr,p=u.map((function(e){if(e.attribute!==(null==d?void 0:d.id))return e;if(e.type===gB.radio)return e.value===o?e:(l=!0,exports.E(exports.E({},e),{value:o}));if(e.type===gB.checkbox)return e;if(e.type===gB.userList){if(o){if(i&&a){var t=i.grids[a].id;if((t=t===Qz?"":t)===o)return e;l=!0;var n=e.value.filter((function(e){return e!==t}));return n.includes(o)||n.push(o),exports.E(exports.E({},e),{value:n})}return e.value.includes(o)?e:(l=!0,exports.E(exports.E({},e),{value:R(R([],e.value,!0),[o],!1)}))}return l=!0,exports.E(exports.E({},e),{value:[]})}return e}));return d&&!p.find((function(e){return e.attribute===(null==d?void 0:d.id)}))&&(l=!0,d.type===gB.radio&&p.push({attribute:d.id,type:d.type,value:o}),d.type,gB.checkbox,d.type===gB.userList&&p.push({attribute:d.id,type:d.type,value:o?[o]:[]})),l&&(s.values=p),(i&&c||!i)&&(s.kanbanId=n.id),{update:s}}var VL=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.supportZindex=0===r.element.selectedCards.length,r.domRenderer=UB,r.createCommentOnElement=function(e){var t=r.element.getLinkToElement();r.couldAddComment&&t&&r.upime.createCommentOnElement(t,e)},r.updateProertyEditors(),r}return P(t,e),Object.defineProperty(t.prototype,"couldCreateFrame",{get:function(){return 0===this.element.selectedCards.length},enumerable:!1,configurable:!0}),t.prototype.getMinSize=function(){var e=this.element.grids.length,t=32+64*e+(0===e?0:8*(e-1));return[t,this.element.viewHeight/this.element.viewWidth*t]},t.prototype.updateProertyEditors=function(){var e=this;this.updateCopyLink(),this.propertyEditors=[];var t=this.element.selectedCards.length;if(this.editable&&0!==this.element.selectedCards.length){var n=this.element.selectedCards[0],i=n?this.element.cardsMap.get(n.cardId):void 0,r=new Set(this.element.selectedCards.map((function(t){return e.element.cardsMap.get(t.cardId)})));i&&(1===t&&this.propertyEditors.push(new WB((function(){e.element.openCardEditor(i)}))),this.element.upime.phoneMode||this.propertyEditors.push(new PL(i,(function(t){t.color&&t.color!==i.color&&e.upime.setInitCardColor(t.color);var n=t.values;function o(e){var t=e.values.map((function(e){return(null==n?void 0:n.find((function(t){return t.attribute===e.attribute})))||e}));return null==n||n.forEach((function(n){e.values.find((function(e){return e.attribute===n.attribute}))||t.push(n)})),t}r.forEach((function(n){e.upime.kanbanManager.updateCard(n.id,exports.E(exports.E({},t),{values:o(n)}),{kanbanId:e.element.id,index:e.element.cards.indexOf(n.id)})})),r.forEach((function(e){e.stopEditName()})),e.element.onCardAddUser(t),e.upime.updateView()}))))}},t.prototype.select=function(){e.prototype.select.call(this),this.updateCopyLink()},t.prototype.updateCopyLink=function(){var e=this,t=this.upime.getElementLink;t&&(this.element.selectedCards.length<=1?this.copyLink=function(){var n,i=(null===(n=e.element.selectedCards[0])||void 0===n?void 0:n.cardId)||e.element.id,r=t(i);Xd(r,{onCopy:function(t){e.upime.addToast(O("link.copy.success.toast"),{type:"normal"}),t.setData("text/plain",r)}})}:this.copyLink=void 0)},t.prototype.unselect=function(){this.element.setSelectedCards([]),this.element.movingCards=[],this.element.setMovingToTargetKanban(void 0),this.element.nameWidget.textProxy.stopEdit(),this.element.stopEditCardName(),this.element.stopEditColName(),e.prototype.unselect.call(this)},t.prototype.dealBorderResize=function(e,t){var n=t.left,i=t.top,r=(t.bottom-i)/this.element.viewHeight,o=this.element.position;this.updateSelf({position:exports.E(exports.E({},o),{x:n,y:i}),scale:r})},t.prototype.checkPointDirection=function(e,t,n){return Ht(e,t,n)},t.prototype.updateProperty=function(e){this.upime.kanbanManager.updateKanban(this.element,e)},t.prototype.unfrozeElement=function(){this.frozed=!1,e.prototype.updateProperty.call(this,{frozedGroupId:null,unFrozenRoles:null}),this.updateToolbarPos()},t.prototype.doDelete=function(e){this.element.removeActiveDomWidget(),0===this.element.selectedCards.length?this.deleteKanban(e):this.deleteSelectedCards(e),this.manager||0!==e.relativeElements.length||this.upime.deleteOperation(e)},t.prototype.deleteKanban=function(e){if(!this.element.frozedGroupId){var t={deleted:!0};this.element.frameId&&(t.frameId=null),this.upime.kanbanManager.updateKanban(this.element,t),this.deleteComments(this.element.id,e)}},t.prototype.deleteSelectedCards=function(e){var t=this,n=new Set(this.element.selectedCards.map((function(e){return e.cardId})));n.forEach((function(n){var i=t.element.cards.indexOf(n);i>=0&&t.upime.kanbanManager.deleteCard(n,{kanbanId:t.element.id,index:i}),t.deleteComments(n,e)}))},t.prototype.deleteComments=function(e,t){this.upime.getAllComments((function(t){return t.attached===e})).forEach((function(e){t.update(e,{deleted:!0})}))},t.prototype.supportLinkTo=function(){return!(this.element.selectedCards.length>1)},Object.defineProperty(t.prototype,"hideConnectableEditorRect",{get:function(){return this.element.selectedCards.length>0},enumerable:!1,configurable:!0}),t.prototype.getBorderBox=function(){return 0===this.element.selectedCards.length?this.element.getBorderBox():Yt(this.element.getSelectedCardBoxes())},Object.defineProperty(t.prototype,"clone",{get:function(){var e=this;if(0!==this.element.selectedCards.length)return function(){var t=new Set(e.element.selectedCards.map((function(e){return e.cardId}))),n=new Map;t.forEach((function(t){var i=e.element.cards.indexOf(t),r=e.element.cardsMap.get(t);if(-1!==i&&r){var o=zs(r,Za.CARD),a=e.upime.genID(Za.CARD),s=e.upime.kanbanManager.createCard(exports.E(exports.E({},o),{id:a}),{kanbanId:e.element.id,index:i+1});n.set(t,s.id)}}));var i=[],r=e.element.isRadio;e.element.selectedCards.forEach((function(t){var o=n.get(t.cardId),a=o&&e.element.cardsMap.get(o);if(a)if(r){var s=e.element.grids.findIndex((function(e){return e.cards.includes(a)}));i.push({cardId:o,col:s})}else e.element.grids[t.col].cards.includes(a)&&i.push({cardId:o,col:t.col})})),e.element.setSelectedCards(i)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportFrozeLock",{get:function(){return 0===this.element.selectedCards.length},enumerable:!1,configurable:!0}),t.prototype.handleSelectCtrlEvt=function(t){if(!this.element.nameWidget.handleSelectCtrlEvt(t)&&!this.element.handleCardEdtingNameCtrlEvt(t)){var n=this.element.groupNameWidgetList.find((function(e){return e.textProxy.editor.editing}));if(!(null==n?void 0:n.handleSelectCtrlEvt(t))){if(this.opData){var i=this.opData,r=i.resizeData,o=i.rotateData;if(r||o)return void e.prototype.handleSelectCtrlEvt.call(this,t)}if(t.isStart){var a=this.getMovingCards(t.startPosition);if(a&&!this.element.onlyCheckKanban){if(_e.desktop||t.longPress||1!==(null==a?void 0:a.length))return void this.startMovingCards(a);var s=a[0],l=this.element.isRadio,c=this.element.selectedCards.some((function(e){return e.cardId===s.cardId&&(l||e.col===s.col)}));if(c)return void this.startMovingCards(a)}return e.prototype.handleSelectCtrlEvt.call(this,t)}t.isEnd?this.element.movingCards.length?this.endMovingCards():e.prototype.handleSelectCtrlEvt.call(this,t):this.element.movingCards.length?this.moveCards(t):e.prototype.handleSelectCtrlEvt.call(this,t)}}},t.prototype.startMovingCards=function(e){var t=this;this.element.movingCards=e.map((function(e){var n=t.element.getCardBorder(e);return exports.E(exports.E({},e),{x:n.left,y:n.top,startX:n.left,startY:n.top})}));var n=this.element.isRadio;this.element.setSelectedCards(this.element.selectedCards.filter((function(e){return t.element.movingCards.some((function(t){return e.cardId===t.cardId&&(n||e.col===t.col)}))})))},t.prototype.endMovingCards=function(){this.saveMoveCard(),this.element.movingCards=[],this.element.setMovingToTargetKanban(void 0),this.updateBorderBox(),this.upime.updateView()},t.prototype.moveCards=function(e){var t=e.position.x-e.startPosition.x,n=e.position.y-e.startPosition.y;this.element.movingCards.forEach((function(e){e.x=e.startX+t,e.y=e.startY+n})),this.upime.updateView(),this.updateAdsorptionLine(e.position)},t.prototype.saveMoveCard=function(){var e=this,t=this.element.movingToTargetKanban;if(t){var n=t.activeOrders.length>0,i=t.adsorptionLine,r=this.element.movingCards;if(i&&0!==r.length){t!==this.element&&(this.element.setSelectedCards([]),this.upime.clearSelect());var o=zL(i,t),a=HL(i,t),s=a.afterCard,l=a.preCard;l&&r.reverse(),r.forEach((function(i){var r=function(n){return UL({targetKanban:t,originKanban:e.element,preCard:l,afterCard:s,id:n})}(i.cardId),a=r.nowIndex,c=r.targetIndex;if(null!==a){var u=e.element.cardsMap.get(i.cardId);if(u){var d=WL({values:u.values,targetKanban:t,originKanban:e.element,targetValue:o,originColIndex:i.col}).update,p=0===Object.keys(d).length;t.id===u.kanbanId&&n&&p||e.upime.kanbanManager.updateCard(u.id,d,{kanbanId:u.kanbanId,index:a},{kanbanId:t.id,index:c})}}}))}}},t.prototype.updateAdsorptionLine=function(e){var t=FL(e,this.upime),n=t.targetKanban,i=t.adsorptionLine;if(n)return i?(this.element.setMovingToTargetKanban(n),void(n.adsorptionLine=i)):void(n===this.element.movingToTargetKanban||this.element.setMovingToTargetKanban(void 0));this.element.setMovingToTargetKanban(void 0)},t.prototype.getMovingCards=function(e){var t=this;if(this.element.selectedCards.length>1){var n=this.element.selectedCards.map((function(e){return t.element.getCardBorder(e)}));return Ot(e,Yt(n))?R([],this.element.selectedCards,!0):null}var i=this.element.checkCard(e);return i?[i]:null},t.prototype.addLinkTo=function(){var e;return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:if(!(t=this.element.getLinkToElement()))return[2];this.upime.clearSelect(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upime.showWindow(Jd,null!==(e=t.link)&&void 0!==e?e:void 0,!0)];case 2:return null!==(n=r.sent())&&(n=oe(n)),(i=this.getOp()).update(t,{link:n}),i.sync(),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))}))},Object.defineProperty(t.prototype,"couldAddComment",{get:function(){return!(this.element.selectedCards.length>1)},enumerable:!1,configurable:!0}),t}(Ob);function jL(e,t,n){var i=yi(e),r=ut(exports.E(exports.E({},n),{fontSize:14}));st.font=r;var o=Hi(i,n.fontSize,t,st,n.fontFamily);return-1===o?{content:e,width:ji(e,n)}:function(e,t,n){var i=e,r=ji("".concat(i.join(""),"..."),n);if(r>t)for(;i.length>0;){i.pop();var o=Vi("".concat(i.join(""),"..."));if(o<=t||0===i.length){r=o;break}}return{content:"".concat(i.join(""),"..."),width:r}}(i.slice(0,o+1),t,n)}var GL={cm_item:"cm_item_3C_mO",disabled:"disabled_2JtvB",icon_box:"icon_box_3QEzM",active:"active_2pgLf",bling_item:"bling_item_18xTA",hidden:"hidden_1vMUO",hidden_all:"hidden_all_2DuIO",show_all:"show_all_flirR",pane:"pane_2unlU",show_a:"show_a_MOS-U",show:"show_3DJ1R",show_scale:"show_scale_2jUM2",right:"right_Ux8bt",left:"left_1DjSO",bottom:"bottom_3Tpkg",top:"top_3G8cS",left_top:"left_top_208gz",top_left:"top_left_2sitB",bottom_left:"bottom_left_1eptB",right_top:"right_top_2x7Fu",right_bottom:"right_bottom_xMXFs",left_bottom:"left_bottom_12Zzk",btn_style:"btn_style_mZARe",on:"on_3EYyi",propEditorIconBox:"propEditorIconBox_2lvcG",titleIcon:"titleIcon_36CwP",moreIcon:"moreIcon_1AEe9",rotateY180:"rotateY180_3S92W",upimeInput:"upimeInput_19wnj",invalid:"invalid_2uwCK",loadingIcon:"loadingIcon_1-6wn",loading:"loading_3w-Ay",AIButtonContainer:"AIButtonContainer_2xPZ4",transparent:"transparent_1twPS",AIButtonWrapper:"AIButtonWrapper_2OJ7r",AIButtonImageContainer:"AIButtonImageContainer_1TYZz",AIShow:"AIShow_1-4-4",AIHide:"AIHide_2nRjm",AIButtonHover:"AIButtonHover_Y-bKm",AIButtonDisabled:"AIButtonDisabled_p8D-3",AIButtonImage:"AIButtonImage_1PUbX",phoneBgColorFcContainer:"phoneBgColorFcContainer_1ogv_",cardEditModalWrapper:"cardEditModalWrapper_2VhDI",cardEditModalContainer:"cardEditModalContainer_3CGgB",cardEditPropContainer:"cardEditPropContainer_2PkHQ",guanbiButton:"guanbiButton_qncY9",textTitle:"textTitle_2ByIg",divider:"divider_2rOZa",colorContainer:"colorContainer_2mJ_2",propertyNameBox:"propertyNameBox_1q9Hx",propertyValueBox:"propertyValueBox_3uuUA",noHide:"noHide_L-NWy",priorityContainer:"priorityContainer_p7rIU",statusContainer:"statusContainer_YcDQ8",descContainer:"descContainer_3mYME",descNameBox:"descNameBox_29iit",textDescContainer:"textDescContainer_1m0SK",textDesc:"textDesc_bExXH",supportInput:"supportInput_1XJFb",actionContainer:"actionContainer_21IKL",cancel:"cancel_1ntj6",confirm:"confirm_dv5YT",colorSelectContainer:"colorSelectContainer_1BvyB",colorSelectSubWindow:"colorSelectSubWindow_2XItv",selectContainer:"selectContainer_YVQ79",noName:"noName_2Hozb",withContainer:"withContainer_3cK3L",box:"box_3MeK9",withName:"withName_1X6h4",userListContainer:"userListContainer_2aR8_",fileListOutter:"fileListOutter_2CtmN",userSelectWrapper:"userSelectWrapper_3-hlr",userSelectContainer:"userSelectContainer_3IRP4",displayItem:"displayItem_fcSsR",avatar:"avatar_1OG7B",userName:"userName_kU155",close:"close_3LGHT",noUser:"noUser_2f5A6",userListOptionContainer:"userListOptionContainer_JPnvI",radioOptionContainer:"radioOptionContainer_2lNSP",optionItem:"optionItem_31N1t",icon:"icon_1OLmf",bigIcon:"bigIcon_7T_FK",label:"label_2B8sB",optionItemSelected:"optionItemSelected_10MGa",timeRangeWrapper:"timeRangeWrapper_3FlUR",timeRangeContainer:"timeRangeContainer_3_bwB",timeRangeSelectContainer:"timeRangeSelectContainer_2iffa",timeViewContainer:"timeViewContainer_3ro-J",dateSelectContainer:"dateSelectContainer_2fyU9",deleteCard:"deleteCard_RLm5Q",fileListWrapper:"fileListWrapper_1obPo",addBtContainer:"addBtContainer_37NNN",padStyle:"padStyle_3XR7z",addBt:"addBt_1CTM4",uploadTip:"uploadTip_3lqgc",hiddenInput:"hiddenInput_3Sct_",outScreenInput:"outScreenInput_1Kuqv",fileListContainer:"fileListContainer_2nxU7",viewerContainer:"viewerContainer_3f1Ay",imgContainer:"imgContainer_2svvI",uploadCover:"uploadCover_1xurO",progressCon:"progressCon_3CQ5a",deleteIcon:"deleteIcon_GlAgJ",officeContainer:"officeContainer_1mf6v",logo:"logo_3mbWH",info:"info_2Oszd",audioContainer:"audioContainer_2qJkE",playerContainer:"playerContainer_1o7WL",hidePlayer:"hidePlayer_2_ony",trigger:"trigger_3xAue",curTime:"curTime_36-iR",duration:"duration_lk88R",track:"track_2YtsG",progress:"progress_9WVPJ",controller:"controller_vXeyk",transing:"transing_2qRew",videoContainer:"videoContainer_qXhrY",videoDom:"videoDom_1jG0t",mask:"mask_1m9yl",videoEmpty:"videoEmpty_1h8vV",iconCon:"iconCon_3t7-a",noDesktop:"noDesktop_M0l6Z",showaction:"showaction_1fGUv",fileLook:"fileLook_1VyOg",actionList:"actionList_39NIh",row:"row_2tCJb",dialogContainer:"dialogContainer_2lWX5",dialogItem:"dialogItem_3gMh-",imgLoading:"imgLoading_3pvhi",phoneViewContainer:"phoneViewContainer_2q1mj",head:"head_3XVQw",scrollContainer:"scrollContainer_2RECx",partContainer:"partContainer_3-nRO",fileRow:"fileRow_3s5Sg",content:"content_ZlyKc",descRow:"descRow_xXIxo",descTextarea:"descTextarea_1jMC0",descBox:"descBox__smnE",titleInput:"titleInput_hwfMP",clearBox:"clearBox_3UlPC",clearInput:"clearInput_1SaWL",tagContainer:"tagContainer_38g2U",avaImage:"avaImage_3NGSS",fakeAva:"fakeAva_3yRWU",userListUser:"userListUser_2qKck",timerangeContent:"timerangeContent_3iTF8",jiantou:"jiantou_2aSSs",colorRow:"colorRow_uF5t1",colorCircle:"colorCircle_2oE9M",confirmBtn:"confirmBtn_p-3Wu",fileListSelectPhoneBox:"fileListSelectPhoneBox_27K3v",timeRangeErrorToast:"timeRangeErrorToast_3kqgW",colorPalettePhone:"colorPalettePhone_BsBTv",cardColorPickDrawer:"cardColorPickDrawer_SuQLa",radioSelectDrawerBox:"radioSelectDrawerBox_2Hw1j",userSelectDrawerBox:"userSelectDrawerBox_2iZMV",userDrawerBox:"userDrawerBox_1Jn5z",actionRow:"actionRow_3pNf5",searchRow:"searchRow_34A87",inputBox:"inputBox_2PIFc",listBox:"listBox_1twLk",userRow:"userRow_KKhgi",nameBox:"nameBox_3J5To",noUsersBox:"noUsersBox_3EMhb",reportRow:"reportRow_1cYbS",checkbox:"checkbox_2UkFY",checkContainer:"checkContainer_3J55K",phoneFileListContainer:"phoneFileListContainer_3_IqJ",hasFiles:"hasFiles_263Gr",kanbanConfigWrapper:"kanbanConfigWrapper_zrjFR",kanbanConfigContainer:"kanbanConfigContainer_2ZExP",kanbanHead:"kanbanHead_1yzm_",kanbanTitleTip:"kanbanTitleTip_2Hlqz",kanbanMainContainer:"kanbanMainContainer_fdqg-",kanbanOptionsList:"kanbanOptionsList_1G7t2",kanbanOptionScroll:"kanbanOptionScroll_1Lp_7",kanbanOptionTitle:"kanbanOptionTitle_2a1VZ",addBox:"addBox_eVNR3",noAdd:"noAdd_2Y1Np",kanbanOptionRow:"kanbanOptionRow_5gYV4",kanbanMainContent:"kanbanMainContent_3PO_L",kanbanMainContentScroll:"kanbanMainContentScroll_2knc1",kanbanMainContentProp:"kanbanMainContentProp_1Vcq9",propTitle:"propTitle_1_-Nw",titleOptionContainer:"titleOptionContainer_uu-9F",inError:"inError_6pCV_",star:"star_2ZewQ",addOptionContainer:"addOptionContainer_2Pb8Q",propError:"propError_2M8zy",inputContainer:"inputContainer_zn0oa",inputDisabled:"inputDisabled_1adbJ",input:"input_129hJ",inputControl:"inputControl_2J0Ui",clearIcon:"clearIcon_3vHa8",focus:"focus_1S-EU",inputErrmsg:"inputErrmsg__KDpJ",selectorContainer:"selectorContainer_u8YJC",selectorDisabled:"selectorDisabled_24GQj",open:"open_3B38O",okIcon:"okIcon_K1eLd",selectOptionContainer:"selectOptionContainer_8Ikhs",selectOptionRow:"selectOptionRow_1g45H",optionListContainer:"optionListContainer_3gQwd",opRow:"opRow_8piVY",opRowInner:"opRowInner_2ztq9",colorSelector:"colorSelector_3FyqL",opInputContainer:"opInputContainer_3F-t_",opInputContainerDisabled:"opInputContainerDisabled_1eVB8",closeIcon:"closeIcon_1TMcU",closeDisabled:"closeDisabled_HdRTM",hasErrmsg:"hasErrmsg_2C-AI",errmsgContainer:"errmsgContainer_26YdQ",actionsList:"actionsList_DWeMJ",attrSaveBt:"attrSaveBt_2XK0F",attrCancelBt:"attrCancelBt_2hQd1",actionTipContainer:"actionTipContainer_1FcJN",deleteContent:"deleteContent_3DSR9",emptyContainer:"emptyContainer_3V0Q-",colorPaletteContainer:"colorPaletteContainer_UFYs8",colorItem:"colorItem_1tyy8"},qL=e.createContext({}),KL=e.createContext({});function YL(n){var i=n.options,r=n.card,o=n.onChange,a=W().getUpimeTrans,s=e.useContext(xl).upime,l=e.useRef(null),c=e.useContext(qL).scrollRef,u=yh(!0,{checkSkip:function(e){return!!l.current&&V(l.current,e)}}),d=u.hide,p=u.setHide,h=u.toggleHide,f=u.skipRef;function m(e){s.editable&&(P(),p(e))}var v=i.typeExtraInfo,g=i.id,y=e.useState((function(){return r.values.find((function(e){return e.attribute===g}))})),b=y[0],E=y[1],x=e.useMemo((function(){if(XL(b)){var e=v.options.find((function(e){return e.id===b.value}));if(e)return e.label}return s.editable?a("card.radio.placeholder"):"-"}),[b]),w=e.useRef(null),C=e.useContext(Ic),S=C.popContainer,k=C.rootContainer,_=e.useState({x:0,y:0}),T=_[0],I=_[1];function P(){var e,t,n=null===(e=f.current)||void 0===e?void 0:e.getBoundingClientRect(),i=null===(t=k.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i){var r=i.bottom-n.bottom,o=Math.max(0,196-r),a=n.left,s=n.bottom-o;T.x===a&&T.y===s||I({x:n.left,y:n.bottom-o})}}e.useEffect((function(){return s.subscribe("boardResized",P)}),[]),e.useEffect((function(){if(XL(b)){var e=v.options.find((function(e){return e.id===b.value}));e&&(w.current.style.backgroundColor=hr(e.color,.25))}}),[]),e.useEffect((function(){return P()}),[v.options.length]),e.useEffect((function(){if((null==c?void 0:c.current)&&!d){var e=function(){m(!0)};return c.current.addEventListener("scroll",e),function(){var t;null===(t=c.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[null==c?void 0:c.current,d]);var N=function(e,t){var n={attribute:g,type:gB.radio,value:e};E(n),m(!0),o(n),t&&(w.current.style.backgroundColor=hr(t,.25))};return e.createElement("div",{className:j(GL.selectContainer,!d&&GL.withContainer),ref:f,onClick:function(){s.editable&&(P(),h())}},e.createElement("div",{className:j(GL.box,b&&b.value&&GL.withName),ref:w},e.createElement("span",{className:j((!b||!b.value)&&GL.noName)},x),s.editable&&b&&b.value&&e.createElement(hl,{icon:"guanbi",className:GL.icon,onClick:function(e){e.stopPropagation(),N(void 0),w.current.style.backgroundColor="unset"}})),!d&&t.createPortal(e.createElement("div",{ref:l,className:GL.radioOptionContainer,style:{left:"".concat(T.x,"px"),top:"".concat(T.y+1,"px")}},v.options.map((function(t){var n=t.label,i=t.id,r=t.color,o=t.icon,a=XL(b)&&b.value===i;return e.createElement("div",{key:i,className:j(GL.optionItem,a&&GL.optionItemSelected),onClick:function(){return N(i,r)}},o&&e.createElement(hl,{icon:o,className:GL.icon,style:{color:pr(r)}}),e.createElement("span",{className:GL.label},n))}))),S.current))}function XL(e){return"object"==typeof e&&null!==e&&"attribute"in e&&"type"in e}function QL(t){var n=t.card,i=t.color,r=t.onChange,o=e.useContext(xl).upime,a=yh(!0,{checkSkip:function(e){return V(document.getElementById("upime-color-picker"),e)||e===c.current}}),s=a.hide,l=a.toggleHide,c=a.skipRef;return e.createElement("div",{className:GL.colorSelectContainer,ref:c},e.createElement(Vb,{size:18,color:i,opacity:1,onClick:function(){o.editable&&l()}}),!s&&e.createElement(xh,{align:"left",selfAdjust:!0,className:GL.colorSelectSubWindow},e.createElement(Yb,{colorPalettes:n.upime.userManager.userPalette,defaultValue:i,onChanged:function(e){e&&r(e)},colorPickerConfig:{onColorPickerChange:function(e,t){t.isEnd&&r(e)}}})))}function ZL(t){var n=t.options,i=t.card,r=t.onChange,o=e.useContext(xl).upime,a=e.useState((function(){var e=i.values.find((function(e){return e.attribute===n.id}));return e?e.value:""})),s=a[0],l=a[1],c=W().getUpimeTrans,u=e.useRef(null),d=e.useRef(null),p=e.useMemo((function(){return _t.throttle((function(){var e=u.current,t=d.current;if(e&&t){t.style.height="".concat(82,"px");var n=t.scrollHeight,i=Math.max(Math.min(n,244),82);e.style.height="".concat(i,"px");var r=244===i?"scroll":"hidden";e.style.overflow=r,t.style.overflow=r}}),200)}),[]);return e.useEffect((function(){setTimeout((function(){p()}),20)}),[s]),e.createElement("div",{className:GL.textDescContainer},e.createElement("textarea",{className:GL.textDesc,value:s,ref:u,onChange:function(e){var t={attribute:n.id,type:gB.richText,value:e.target.value};l(e.target.value),r(t)},placeholder:o.editable?c("card.desc.placeholder"):"-",onFocus:function(){u.current.style.borderColor="#2e73e5"},onBlur:function(){u.current.style.borderColor="rgba(230, 231, 233, 1)"},disabled:!o.editable}),e.createElement("textarea",{className:j(GL.textDesc,GL.supportInput),value:s,ref:d,placeholder:o.editable?c("card.desc.placeholder"):"-",onChange:function(){}}))}function JL(n){var i,r=n.values,o=n.attr,a=n.onChange,s=W().getUpimeTrans,l=e.useContext(Ic),c=l.popContainer,u=l.rootContainer,d=e.useContext(xl).upime,p=e.useRef(null),h=e.useReducer((function(e){return e+1}),0),f=h[0],m=h[1],v=e.useContext(qL).scrollRef,g=yh(!0,{checkSkip:function(e){return!!p.current&&V(p.current,e)}}),y=g.hide,b=g.toggleHide,E=g.setHide,x=g.skipRef,w=e.useState({x:0,y:0}),C=w[0],S=w[1];function k(){var e,t,n=null===(e=x.current)||void 0===e?void 0:e.getBoundingClientRect(),i=null===(t=u.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i){var r=i.bottom-n.bottom,o=Math.max(0,374-r),a=n.left,s=n.bottom-o;C.x===a&&C.y===s||S({x:n.left,y:n.bottom-o})}}e.useEffect((function(){return d.subscribe("boardResized",k)}),[]);var _=(null===(i=r.find((function(e){return e.attribute===o.id&&e.type===gB.userList})))||void 0===i?void 0:i.value)||[];e.useEffect((function(){return k()}),[_]),e.useEffect((function(){return d.subscribe("updatedUserInfo",m)}),[]);var T=e.useMemo((function(){return _.map((function(e){return d.userManager.getUser(e)}))}),[_,f]);function I(e){a({attribute:o.id,type:gB.userList,value:e})}return e.useEffect((function(){if((null==v?void 0:v.current)&&!y){var e=function(){E(!0)};return v.current.addEventListener("scroll",e),function(){var t;null===(t=v.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[null==v?void 0:v.current,y]),e.createElement("div",{className:j(GL.userSelectWrapper),ref:x},e.createElement("div",{className:j(GL.userSelectContainer,!y&&GL.withContainer),onClick:function(){k(),d.editable&&b()}},T.map((function(t){return e.createElement("div",{className:GL.displayItem,key:t.loginName},e.createElement(ml,{url:t.avatarUrl,className:GL.avatar}),e.createElement("div",{className:j(GL.userName)},t.userName||"--"),d.editable&&e.createElement(hl,{icon:"guanbi",className:GL.close,size:14,onClick:function(e){e.stopPropagation(),I(_.filter((function(e){return e!==t.loginName})))}}))})),0===T.length&&e.createElement("span",{className:GL.noUser},d.editable?s("card.radio.placeholder"):"-")),!y&&t.createPortal(e.createElement("div",{ref:p,className:GL.userListOptionContainer,style:{left:"".concat(C.x,"px"),top:"".concat(C.y+1,"px")}},e.createElement(nL,{users:_,onChange:I,showUsers:!1})),c.current))}function $L(t){var n,i=t.values,r=t.attr,o=t.onChange;if(r.type!==gB.timeRange)throw new Error("error type");var a=W().getUpimeTrans;function s(e){o({attribute:r.id,type:gB.timeRange,value:e})}var l=(null===(n=i.find((function(e){return e.attribute===r.id&&e.type===gB.timeRange})))||void 0===n?void 0:n.value)||[void 0,void 0],c=r.typeExtraInfo.timeRangeLabels,u=c[0],d=c[1],p="".concat(tO(l[0])," ").concat(a("card.attr.startendtime.start.short")),h="".concat(tO(l[1])," ").concat(a("card.attr.startendtime.end.short"));return e.createElement(e.Fragment,null,e.createElement("div",{className:GL.timeRangeContainer},e.createElement("div",{className:GL.propertyNameBox},r.icon&&e.createElement(hl,{icon:r.icon}),e.createElement("span",null,u)),e.createElement(eO,{time:l[0],viewStr:p,onChange:function(e){return s([e,l[1]])}})),e.createElement("div",{className:GL.timeRangeContainer},e.createElement("div",{className:GL.propertyNameBox},r.icon&&e.createElement(hl,{icon:r.icon}),e.createElement("span",null,d)),e.createElement(eO,{time:l[1],viewStr:h,onChange:function(e){return s([l[0],e])}})))}function eO(n){var i=n.time,r=n.viewStr,o=n.onChange,a=W().getUpimeTrans,s=e.useContext(Ic),l=s.popContainer,c=s.rootContainer,u=e.useContext(xl).upime,d=e.useRef(null),p=e.useContext(qL).scrollRef,h=yh(!0,{checkSkip:function(e){return!!d.current&&V(d.current,e)}}),f=h.hide,m=h.setHide,v=h.toggleHide,g=h.skipRef;function y(e){u.editable&&m(e)}var b=e.useState({x:0,y:0}),E=b[0],x=b[1];function w(){var e,t,n=null===(e=g.current)||void 0===e?void 0:e.getBoundingClientRect(),i=null===(t=c.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i){var r=i.bottom-n.bottom,o=Math.max(0,368-r),a=n.left,s=n.bottom-o;E.x===a&&E.y===s||x({x:n.left,y:n.bottom-o})}}return e.useEffect((function(){return u.subscribe("boardResized",w)}),[]),e.useEffect((function(){if((null==p?void 0:p.current)&&!f){var e=function(){y(!0)};return p.current.addEventListener("scroll",e),function(){var t;null===(t=p.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[null==p?void 0:p.current,f]),e.createElement("div",{className:j(GL.timeRangeWrapper,!f&&GL.withContainer),ref:g},e.createElement("div",{className:j(GL.timeRangeSelectContainer),onClick:function(){w(),u.editable&&v()}},i?e.createElement("div",{className:GL.timeViewContainer},e.createElement("span",{className:j(GL.timeView)},r),u.editable&&e.createElement(hl,{icon:"guanbi",className:GL.close,size:14,onClick:function(e){e.stopPropagation(),o(void 0)}})):e.createElement("span",{className:GL.noUser},u.editable?a("card.radio.placeholder"):"-")),!f&&t.createPortal(e.createElement("div",{ref:d,className:GL.dateSelectContainer,style:{left:"".concat(E.x,"px"),top:"".concat(E.y+1,"px")}},e.createElement(SL,{value:i,onChange:function(e){o(e),y(!0)}})),l.current))}function tO(e){if(!e)return"";var t=new Date(e),n=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return"".concat(n,"-").concat(i,"-").concat(r)}var nO=R(R([],II,!0),PI.split(",").map((function(e){return e.trim()})),!0).join(","),iO=function(e){var t=Jo(e.name),n=new Ks;switch(t){case"jpg":case"png":case"gif":case"svg":case"webp":case"jpeg":var i=new FileReader;i.onload=function(){var r=new Image;r.onload=function(){n.done({type:TI.IMAGE,append:{name:e.name,width:r.width,height:r.height,size:e.size,ext:t,localEle:r}})},r.src=i.result},i.readAsDataURL(e);break;case"wav":case"mp3":var r=new FileReader;r.onload=function(){var i=new Audio(r.result);i.onloadedmetadata=function(){var r=function(){i.removeEventListener("timeupdate",r),n.done({type:TI.AUDIO,append:{name:e.name,duration:i.duration,size:e.size,ext:t,localEle:i}})};i.duration===1/0?(i.currentTime=1e101,i.addEventListener("timeupdate",r)):r()}},r.readAsDataURL(e);break;case"mov":case"mp4":var o=URL.createObjectURL(e),a=document.createElement("video");a.onloadedmetadata=function(){n.done({type:TI.VIDEO,append:{name:e.name,width:a.videoWidth,height:a.videoHeight,size:e.size,ext:t,duration:a.duration,localEle:a}})},a.src=o;break;default:n.done({type:TI.FILE,append:{name:e.name,size:e.size,ext:t}})}return n.result};function rO(e,t){return A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){switch(r.label){case 0:return[4,iO(e)];case 1:return n=r.sent(),i=Jo(e.name),[2,{type:n.type,elmId:Math.random().toString(),pending:{request:function(n,r){return t.saveFile(1,{file:e,ext:i,fakeName:"".concat(t.genFileName(""),".").concat(i)},r,n)},progress:0},append:n.append}]}}))}))}function oO(e,t){var n=t.userManager.uploadSizeLimit,i=!1,r=!1,o=Array.from(e).reduce((function(e,n){return n.size?n.size>t.userManager.uploadSizeLimit?(i=!0,e):R(R([],e,!0),[n],!1):(r=!0,e)}),[]),a={zIndex:200};return r&&t.addToast(O("comment.upload.file.empty.hint"),{style:a}),i&&t.addToast(O("upload.exceedLimitSize",na(n)),{style:a}),o.length>9&&t.addToast(O("comment.upload.file.number.limit"),{style:a}),o.slice(0,9)}function aO(t){var n=t.file;if(n.type!==TI.IMAGE)throw new Error("error type on Render");var i=e.useContext(xl).upime,r=n.append?n:void 0,o=e.useState((function(){if(r){var e=r.append.localEle;return e?e.src:""}return""})),a=o[0],s=o[1];e.useEffect((function(){if(!r){var e=!1;return i.getFileInfo(n.fileId).then((function(t){e||s(t.url)})),function(){e=!0}}}),[]);var l=0,c="100%",u=(null==r?void 0:r.append.height)||n.height,d=((null==r?void 0:r.append.width)||n.width)/u,p=(l=d<1.288?250:Math.max(322/d,64))*d;if(p>322){var h=322/p;c="".concat(322,"px"),l*=h}return c="".concat(l*d,"px"),e.createElement("div",{className:GL.imgContainer,style:{height:"".concat(l,"px"),width:c}},e.createElement("img",{onClick:function(){a&&i.previewExternalFile&&i.previewExternalFile((null==r?void 0:r.append)||n,a)},src:a,alt:"",style:{opacity:a?1:0}}),!a&&e.createElement(hl,{icon:"jiazai",className:GL.imgLoading}))}function sO(t){var n,i=t.file,r=e.useContext(xl).upime,o=i.append?i:void 0,a=(null==o?void 0:o.append.ext)||i.ext,s=(null==o?void 0:o.append.name)||i.name,l=(null==o?void 0:o.append.size)||i.fileSize;return e.createElement("div",{className:GL.officeContainer,onDoubleClick:function(){var e=(null==o?void 0:o.append.fileId)||i.fileId,t=r.previewExternalFile;e&&t&&r.getFileInfo(e).then((function(e){var n=e.url;t((null==o?void 0:o.append)||i,n)}))}},e.createElement(hl,{icon:eP(a),className:GL.logo,size:40}),e.createElement("div",{className:GL.info},e.createElement("span",null,null!==(n=$I(s,a))&&void 0!==n?n:"unknown"," "),e.createElement("span",null," ",na(l)," ")))}function lO(t){var n,i=t.file,r=e.useContext(xl).upime,o=W().getUpimeTrans,a=e.useState(""),s=a[0],l=a[1];e.useEffect((function(){var e=i.fileId;e&&r.getFileInfo(e).then((function(e){l(e.url)}))}),[i.fileId]);var c=i.append?i:void 0,u=(null==c?void 0:c.append.name)||i.name,d=(null==c?void 0:c.append.ext)||i.ext,p=(null==c?void 0:c.append.size)||i.fileSize,h=2===i.transStatus,f=e.useState((function(){var e=Math.round((i.estimateCompleteTime-Date.now())/1e3/60);return Math.max(e,1)})),m=f[0],v=f[1];e.useEffect((function(){if(h){var e=window.setInterval((function(){v(Math.max(m-1,1))}),6e4);return function(){clearInterval(e)}}}),[]);var g=1===i.transStatus?s+"_t.mp3":s;return e.createElement("div",{className:GL.audioContainer},e.createElement("div",{className:GL.officeContainer},e.createElement(hl,{icon:eP(d),className:GL.logo,size:40}),e.createElement("div",{className:GL.info},e.createElement("span",null,null!==(n=$I(u,d))&&void 0!==n?n:"unknown"," "),e.createElement("span",null," ",na(p)," "))),!h&&s&&e.createElement(uO,{src:g,duration:(null==c?void 0:c.append.duration)||i.duration}),h&&e.createElement("div",{className:j(GL.playerContainer,GL.transing)},o("common.transcoding")," ",m," ",o("common.minutes")))}function cO(t){var n=t.file,i=e.useContext(xl).upime,r=W().getUpimeTrans,o=e.useState(""),a=o[0],s=o[1];e.useEffect((function(){var e=n.fileId;e&&i.getFileInfo(e).then((function(e){s(e.url)}))}),[n.fileId]);var l=2===n.transStatus,c=3===n.transStatus,u=e.useState((function(){var e=Math.round((n.estimateCompleteTime-Date.now())/1e3/60);return Math.max(e,1)})),d=u[0],p=u[1],h=e.useState(""),f=h[0],m=h[1];e.useEffect((function(){var e=n.coverFileId;e&&i.getFileInfo(e).then((function(e){m(e.url)}))}),[n.coverFileId]),e.useEffect((function(){if(l){var e=window.setInterval((function(){p(Math.max(d-1,1))}),6e4);return function(){clearInterval(e)}}}),[]);var v=1===n.transStatus?a+"_t.mp4":a;return e.createElement("div",{className:GL.videoContainer},a?e.createElement("video",{className:GL.videoDom,poster:f,src:v,controls:!l&&!c,controlsList:"nodownload"}):e.createElement("div",{className:GL.videoEmpty}),c&&e.createElement("div",{className:GL.mask},e.createElement(hl,{icon:"jinggao"}),e.createElement("span",null,r("common.transcoding.fail"))),l&&e.createElement("div",{className:GL.mask},e.createElement(hl,{icon:"shipinzhuanma"}),e.createElement("span",null,r("common.transcoding")," ",d," ",r("common.minutes"))))}function uO(t){var n=t.duration,i=t.src,r=e.useRef(new Audio);e.useEffect((function(){i&&(r.current.src=i)}),[i]);var o=e.useRef(null),a=e.useRef(null),s=e.useRef(null),l=e.useRef(null),c=e.useState(!1),u=c[0],d=c[1],p=e.useRef(null),h=e.useRef({pointerId:null,oriX:0,x:0,connected:!1,oriTarRect:{x:0,y:0,width:0,height:0},trackRect:{x:0,y:0,width:0,height:0},percentage:0}),f=function(e){e.stopPropagation();var t=h.current.pointerId;null!==t&&t!==e.pointerId||(h.current.pointerId=e.pointerId,h.current.connected=!0,h.current.oriX=e.pageX,h.current.oriTarRect=o.current.getBoundingClientRect(),h.current.trackRect=s.current.getBoundingClientRect(),p.current&&mr(p.current))},m=function(e){var t=h.current,n=t.pointerId;if((null===n||n===e.pointerId)&&t.connected){p.current&&mr(p.current);var i=0;if(e.pageX<=t.trackRect.x)i=0;else if(e.pageX>=t.trackRect.x+t.trackRect.width)i=100;else{var s=e.pageX-t.oriX;i=(t.oriTarRect.x+s-t.trackRect.x+t.oriTarRect.width/2)/t.trackRect.width*100|0}var c=o.current,u=a.current,d=l.current,f=r.current.duration*i/100;c&&(c.style.left="".concat(i,"%")),u&&(u.style.width="".concat(i,"%")),d&&(d.innerHTML="".concat("0".concat(f/60|0).slice(-2),":").concat("0".concat(f%60|0).slice(-2))),t.percentage=i}},v=function(e){var t=h.current.pointerId;if((null===t||t===e.pointerId)&&h.current.connected){var n=r.current;n&&(n.currentTime=h.current.percentage/100*n.duration,E(),r.current.paused&&p.current&&mr(p.current)),h.current.pointerId=null,h.current.connected=!1}};e.useEffect((function(){var e=function(){E()},t=function(){if(p.current&&mr(p.current),c.currentTime>=c.duration)return c.currentTime=0,i.style.left="0%",a.current&&(a.current.style.width="0%"),l.current&&(l.current.innerHTML="00:00"),void d(!1)},n=s.current,i=o.current,c=r.current,u=function(e){var t=n.getBoundingClientRect(),i=t.x,o=t.width,a=Math.max(0,Math.min((e.pageX-i)/o,100)),s=r.current;s.currentTime=s.duration*a,E(),s.paused&&p.current&&mr(p.current)};return n.addEventListener("pointerdown",u),i.addEventListener("pointerdown",f),document.addEventListener("pointermove",m),document.addEventListener("pointerup",v),c.addEventListener("play",e),c.addEventListener("pause",t),function(){n.removeEventListener("pointerdown",u),i.removeEventListener("pointerdown",f),document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",v),c.removeEventListener("play",e),c.removeEventListener("pause",t),!r.current.paused&&r.current.pause()}}),[]);var g,y,b,E=e.useCallback((function(){var e=0,t=o.current,n=a.current,i=l.current,s=r.current,c=function(){var r=Date.now();if(r-e>100){if(s.currentTime>=s.duration)return s.currentTime=0,t.style.left="0%",n.style.width="0%",i.innerHTML="00:00",d(!1),E(),void(p.current&&mr(p.current));var o=s.currentTime/s.duration;t.style.left="".concat(100*o,"%"),n.style.width="".concat(100*o,"%"),i.innerHTML="".concat("0".concat(s.currentTime/60|0).slice(-2),":").concat("0".concat(s.currentTime%60|0).slice(-2)),e=r}p.current=fr(c)};c()}),[]);return e.createElement("div",{className:j(GL.playerContainer,!i&&GL.hidePlayer)},e.createElement(hl,{icon:u?"zanting":"bofangqi",className:GL.trigger,onClick:function(){r.current.paused?(d(!0),r.current.play()):(d(!1),r.current.pause())}}),e.createElement("span",{className:GL.curTime,ref:l},"00:00"),e.createElement("div",{className:GL.track,ref:s},e.createElement("div",{className:GL.progress,ref:a}),e.createElement("div",{className:GL.controller,ref:o})),e.createElement("span",{className:GL.duration},(g=n/1e3,y=Math.floor(g/60),b=Math.floor(g-60*y),"".concat(y.toString().padStart(2,"0"),":").concat(b.toString().padStart(2,"0")))))}var dO=function(t){var n,i,r=t.children,o=t.file,a=t.onRemove,s=W().getUpimeTrans,l=e.useContext(xl).upime,c=o.append?o:void 0,u=Boolean(null==c?void 0:c.pending),d=e.useState(!1),p=d[0],h=d[1];function f(){c&&c.append.fileId&&c.append.name?l.downloadOssFile(c.append.fileId,c.append.name):l.downloadOssFile(o.fileId,o.name),h(!1)}e.useEffect((function(){var e=function(){h(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]);var m=null==o?void 0:o.type,v=m===TI.FILE||m!==TI.IMAGE&&l.downloadConfig.enable||m===TI.IMAGE&&l.downloadConfig.imageEnable||l.editable&&a;function g(){var e=(null==c?void 0:c.append.fileId)||o.fileId,t=l.previewExternalFile;e&&t&&(l.getFileInfo(e).then((function(e){var n=e.url;t((null==c?void 0:c.append)||o,n)})),h(!1))}return e.createElement("div",{className:j(GL.viewerContainer,m===TI.FILE&&GL.fileLook,p&&GL.showaction,m===TI.IMAGE&&GL.imgContainer)},r,c&&u&&e.createElement("div",{className:GL.uploadCover},e.createElement("div",{className:j(GL.progressCon)},e.createElement(hl,{icon:"jiazai",className:j(GL.loading)}),e.createElement("span",null,s("common.upload.progress","".concat(Math.min(null!==(i=null===(n=c.pending)||void 0===n?void 0:n.progress)&&void 0!==i?i:0,99),"%")))),a&&e.createElement(hl,{icon:"shanchu",className:GL.deleteIcon,onClick:a})),v&&e.createElement("div",{className:j(GL.iconCon,!_e.desktop&&GL.noDesktop),onClick:function(){l.phoneMode?l.showWindow(pO,{canPreview:m===TI.FILE,canDownload:l.downloadConfig.enable||m===TI.IMAGE,canRemove:!0},!1,!0,{type:"drawer"}).then((function(e){"preview"===e&&g(),"download"===e&&f(),"remove"===e&&a&&a()})):p?h(!1):setTimeout((function(){h(!0)}))}},e.createElement(hl,{icon:"gengduo",className:GL.floatIcon})),p&&e.createElement("div",{className:GL.actionList,onClick:function(e){return e.stopPropagation()}},m===TI.FILE&&e.createElement("div",{className:GL.row,onClick:g},s("common.preview")),(m!==TI.IMAGE&&l.downloadConfig.enable||m===TI.IMAGE&&l.downloadConfig.imageEnable)&&e.createElement("div",{className:GL.row,onClick:f},s("common.download")),l.editable&&a&&e.createElement("div",{className:GL.row,style:{color:"#fe5250"},onClick:a},s("common.delete"))))},pO=function(t){var n=t.success,i=t.content,r=W().getUpimeTrans;return e.createElement("div",{className:GL.dialogContainer,onClick:function(e){return e.stopPropagation()}},(null==i?void 0:i.canPreview)&&e.createElement("div",{onClick:function(){return n("preview")},className:GL.dialogItem},r("common.preview")),(null==i?void 0:i.canDownload)&&e.createElement("div",{onClick:function(){return n("download")},className:GL.dialogItem},r("common.download")),(null==i?void 0:i.canRemove)&&e.createElement("div",{onClick:function(){return n("remove")},style:{color:"rgb(254, 82, 80)"},className:GL.dialogItem},r("common.delete")))};function hO(t){var n=t.values,i=t.attr,r=t.onChange,o=W().getUpimeTrans,a=e.useContext(xl).upime,s=e.useRef(null),l=e.useRef(null),c={};e.useEffect((function(){Object.values(c).forEach((function(e){return null==e?void 0:e()}))}),[]);var u=e.useReducer((function(e){return e+1}),0);u[0];var d=u[1],p=e.useState(!1),h=p[0],f=p[1],m=e.useState(!1),v=m[0],g=m[1],y=e.useRef();function b(){var e;return(null===(e=n.find((function(e){return e.attribute===i.id&&e.type===i.type})))||void 0===e?void 0:e.value)||[]}e.useEffect((function(){var e=new Yp(a,13,(function(e){var t=e[1],n=R([],b(),!0),o=n.findIndex((function(e){return e.fileId===t.fileId}));o>-1&&(Object.assign(n[o],{transStatus:t.status,duration:t.duration}),r({attribute:i.id,type:gB.fileList,value:n}))}));return e.open(),y.current=e,function(){return e.close()}}),[]);var E=b();function x(e){var t;return A(this,void 0,void 0,(function(){var n,l,u,p,h,f,m,v=this;return D(this,(function(g){switch(g.label){case 0:return e?(n=nO.split(","),Array.from(e).some((function(e){var t=Jo(e.name);return!n.includes(".".concat(t))}))?(a.addToast(o("upload.notSupportFiles"),{style:{zIndex:9999}}),[2]):[4,ra(a)]):[2];case 1:if(!g.sent())return[2];if(0===(l=oO(e,a)).length)return[2];u=[],p=function(e){var n,o,s,l,p;return D(this,(function(h){switch(h.label){case 0:return[4,rO(e,a)];case 1:return n=h.sent(),u.push(n),o=Math.random().toString(),s=function(e,t){return function(){var s;return n.failed=!1,n.abort=t,c[o]=t,null===(s=n.pending)||void 0===s?void 0:s.request(e,(function(e){n.pending&&(n.pending.progress=e,d())})).then((function(e){return A(v,void 0,void 0,(function(){var t,s,l,u,p,h;return D(this,(function(f){return t={fileId:e,name:n.append.name||"",ext:n.append.ext||"",fileSize:n.append.size||0},n.type===TI.VIDEO||n.type===TI.AUDIO?a.transcodeMedia(e).then((function(a){var s,l,u,p;if(a){null===(s=y.current)||void 0===s||s.sendSCmd(Lp.send,e);var h=null;n.type===TI.VIDEO&&(h=exports.E(exports.E({},t),{type:TI.VIDEO,duration:a.duration,transStatus:a.status,estimateCompleteTime:a.estimateCompleteTime,coverFileId:(null===(l=a.coverInfo)||void 0===l?void 0:l.fileId)||"",width:(null===(u=a.coverInfo)||void 0===u?void 0:u.width)||0,height:(null===(p=a.coverInfo)||void 0===p?void 0:p.height)||0})),n.type===TI.AUDIO&&(h=exports.E(exports.E({},t),{type:TI.AUDIO,duration:a.duration,transStatus:a.status,estimateCompleteTime:a.estimateCompleteTime}));var f=R([],b(),!0),m=f.findIndex((function(e){return e===n}));h&&m>-1&&(f[m]=h,r({attribute:i.id,type:gB.fileList,value:f})),n.append.fileId=e,n.finished=!0,n.failed=!1,delete n.pending,delete c[o],d()}})):(s=null,n.type===TI.IMAGE&&(l=exports.E(exports.E({},t),{type:TI.IMAGE,width:n.append.width||0,height:n.append.height||0}),s=l),n.type===TI.FILE&&(u=exports.E(exports.E({},t),{type:TI.FILE}),s=u),p=R([],b(),!0),h=p.findIndex((function(e){return e===n})),s&&h>-1&&(p[h]=s,r({attribute:i.id,type:gB.fileList,value:p})),n.append.fileId=e,n.finished=!0,n.failed=!1,delete n.pending,delete c[o],d()),[2]}))}))}))}},p=new Promise((function(e){l=e})),null===(t=s(p,l))||void 0===t||t(),[2]}}))},h=0,f=l,g.label=2;case 2:return h<f.length?(m=f[h],[5,p(m)]):[3,5];case 3:g.sent(),g.label=4;case 4:return h++,[3,2];case 5:return r({attribute:i.id,type:gB.fileList,value:R(R([],u,!0),E,!0)}),s.current&&(s.current.value=""),[2]}}))}))}var w=_e.desktop;return e.createElement("div",{className:GL.fileListWrapper},a.editable&&e.createElement("div",{className:j(GL.addBtContainer,(h||v)&&GL.active,!w&&GL.padStyle),onDragEnter:function(){w&&(v||g(!0))},onDragLeave:function(e){if(w){var t=e.currentTarget,n=e.relatedTarget;v&&t.contains&&!t.contains(n)&&g(!1)}},onDragOver:function(e){w&&(e.stopPropagation(),e.preventDefault())},onDrop:function(e){var t;w&&(e.stopPropagation(),e.preventDefault(),g(!1),(t=e.dataTransfer.files)&&0!==t.length&&(x(t),_c("cv_cardfiles_upload",{type:"拖拽"})))},onClick:function(){var e,t;w?null===(t=l.current)||void 0===t||t.focus():null===(e=s.current)||void 0===e||e.click()}},e.createElement("div",{className:GL.addBt,onClick:function(e){var t;w&&(e.stopPropagation(),null===(t=s.current)||void 0===t||t.click())}},e.createElement(hl,{icon:"jia",size:20}),e.createElement("div",null,o("card.attr.attachment.upload")),e.createElement("input",{onChange:function(e){_c("cv_cardfiles_upload",{type:"本地上传"}),x(e.target.files)},ref:s,type:"file",multiple:!0,accept:nO,className:GL.hiddenInput})),w&&e.createElement(e.Fragment,null,e.createElement("div",{className:GL.uploadTip},o("kanban.upload.tip")),e.createElement("input",{type:"text",ref:l,className:GL.outScreenInput,onFocus:function(){f(!0)},onBlur:function(){f(!1)},onPaste:function(e){var t;(t=e.clipboardData.files)&&0!==t.length&&(x(t),_c("cv_cardfiles_upload",{type:"粘贴"}))},readOnly:!0}))),0!==E.length&&e.createElement("div",{className:GL.fileListContainer},E.map((function(t,n){var o=function(e){switch(e.type){case TI.IMAGE:return aO;case TI.FILE:return sO;case TI.AUDIO:return lO;case TI.VIDEO:return cO}}(t),a=function(e){return e.fileId?e.fileId:e.elmId}(t);return o&&e.createElement(dO,{key:a,onRemove:function(){return function(e){var t,n;null===(n=null===(t=E[e])||void 0===t?void 0:t.abort)||void 0===n||n.call(t);var o=R([],E,!0);o.splice(e,1),r({attribute:i.id,type:gB.fileList,value:o})}(n)},file:t},e.createElement(o,{file:t}))}))),0===E.length&&!a.editable&&e.createElement("div",{className:GL.noUser},"-"))}var fO="row_1jr8Z",mO="active_3P7nJ",vO="addNewColContainer_2U3es",gO="attrInputContainer_hhG9O",yO="attrInput_9uRCq",bO="error_1F0s4",EO="clearIcon_yb28o",xO="attrUserListContainer_GHEwF",wO="fakeSelectorContainer_3VVxk",CO="focus_3F7iP",SO="userList_238BL",kO="arrow_RO13-",_O="pleaseSelect_38Ldw",TO="userListSelectContainer_3eTVW",IO="errorText_8JAdC",PO="errorTipContainer_3f5Wz",NO="colorPalette_2hfVE",MO="colorItem_3fT64",AO="addColActionList_2VRy5",DO="cancelBt_1lDej",RO="submitBt_2Jgm9",BO="activeState_1nRyx",LO="filterTitle_2EnRr",OO="iconContainer_1isCj",FO="clearContainer_1xv3p",zO="clearDisabled_2yNHo",HO="filterContentConainer_2L-x3",UO="filterOptionLabel_LlCjN",WO="noSelect_Iwxrr",VO="filterLabel_2G6pu",jO="targetIcon_344qo",GO="placeholder_1vU09",qO="filterOptionsContainer_1Uk6o",KO="filterOption_2ZFFe",YO="filterOptionActive_edODt",XO="filterOptionName_3h3RH",QO="filterTargetContainer_3q_7O",ZO="deleteIconDisabled_3sodA",JO="addBtContainer_2Ksez",$O="orderTitle_37s5g",eF="orderContentContainer_27oKf",tF="orderOptionsContainer_2a2T4",nF="contentPlaceHolder_xxbdw",iF="hoverContainer_2sxvT",rF=function(){function e(e){this.element=e,this.renderer=oF,this.renderKey="kanban-group-editor-".concat(e.id)}return e.prototype.remove=function(){this.element.removeActiveDomWidget()},e}();function oF(t){var n=t.element,i=t.upime,r=e.useRef(null),o=W().getUpimeTrans;e.useEffect((function(){return i.userEventManager.subscribe("click",(function(){n.element.clearSelectedState()}))}),[]),e.useEffect((function(){return gh((function(){_e.isTouchSupported?fr((function(){n.remove()})):n.remove()}),{skipElements:r.current?[r.current]:void 0})}),[]);var a=function(){var e=n.element.getGroupBorderBoxInKanban(),t=n.element.position,r=n.element.scale,o=t.x+e.left*r,a=t.y+e.bottom*r;return i.view.getScreenPosition({x:o,y:a})}(),s=n.element.attributes.filter((function(e){return[gB.radio,gB.checkbox,gB.userList].includes(e.type)})),l=n.element.groupByAttr;return e.createElement("div",{ref:r,className:"kanbanGroupContainer_1cTo0",style:{left:"".concat(a.x,"px"),top:"".concat(a.y+2,"px")}},e.createElement("div",{className:j(fO,"tip_2FQgb","noHover_27MKF")},o("kanban.group.tip")),e.createElement("div",{className:"scrollContainer_3pyGv"},s.map((function(t){var r=(null==l?void 0:l.id)===t.id,o=aF(t);return e.createElement("div",{onClick:function(){return function(e){if(_c("cv_kanban_groupby"),n.remove(),n.element.clearSelectedState(),e.id!==(null==l?void 0:l.id))if(e.type===gB.userList){var t=n.element.getAllCardsUserIds(),r=n.element.attributes.map((function(n){return n.id!==e.id?n:exports.E(exports.E({},n),{typeExtraInfo:{displayUsers:t}})}));i.kanbanManager.updateKanban(n.element,{colGroupBy:e.id,attributes:r})}else i.kanbanManager.updateKanban(n.element,{colGroupBy:e.id})}(t)},className:j(fO,r&&mO),key:t.id},o&&e.createElement(hl,{icon:o,size:16}),e.createElement("div",{className:"label_1FM2Q"},t.label),r&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",className:"okIcon_3iw5h",size:16}))}))))}function aF(e){if(e.icon)return e.icon;switch(e.type){case gB.radio:return"zhuangtaixianxing";case gB.checkbox:return"shengchengdaiban";case gB.userList:return"tuandui"}return null}function sF(t){var n,i=t.card,r=t.onClose,o=W().getUpimeTrans,a=e.useReducer((function(e){return e+1}),0)[1];e.useEffect((function(){if(i){var e=function(){return a()};return i.onValueUpdateCBList.push(e),function(){i.onValueUpdateCBList=i.onValueUpdateCBList.filter((function(t){return t!==e}))}}}),[i]);var s=(null===(n=null==i?void 0:i.pareantKanban)||void 0===n?void 0:n.attributes)||[],l=s.filter((function(e){return e.type===gB.radio})),c=s.filter((function(e){return e.type===gB.userList})),u=s.filter((function(e){return e.type===gB.timeRange})),d=s.filter((function(e){return e.type===gB.fileList})),p=s.filter((function(e){return e.type===gB.richText}));return i?e.createElement("div",{className:GL.phoneViewContainer},e.createElement("div",{className:j(GL.partContainer,GL.head)},e.createElement("div",{className:GL.row},e.createElement(hl,{icon:"guanbi",size:20,onClick:r}))),e.createElement("div",{className:GL.scrollContainer},e.createElement("div",{className:GL.partContainer},e.createElement("div",{className:GL.row},i.name||"-")),e.createElement("div",{className:GL.partContainer},e.createElement("div",{className:GL.row},e.createElement("div",null,o("card.attr.color")),e.createElement(Vb,{color:i.color,opacity:1})),l.map((function(t,n){var r=function(e,t){var n,i=null===(n=e.values.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value;if(t.type===gB.radio)return t.typeExtraInfo.options.find((function(e){return e.id===i}))}(i,t);return e.createElement("div",{className:GL.row,key:"radio-".concat(n)},e.createElement("div",null,t.label),r?e.createElement("div",{className:GL.tagContainer,style:{background:hr(r.color,.25)}},r.label):"")})),c.map((function(t,n){var r=function(e,t){var n,i=(null===(n=e.values.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value)||[];if(t.type===gB.userList)return i.map((function(t){return e.upime.userManager.getUser(t)}))}(i,t)||[],a=r.slice(0,3);return e.createElement("div",{className:GL.row,key:"user-".concat(n)},e.createElement("div",null,t.label),e.createElement("div",{className:GL.userListUser},0===r.length&&"-",a.map((function(t,n){return t.avatarUrl?e.createElement("img",{src:t.avatarUrl,alt:"",className:GL.avaImage,key:"user-".concat(n)}):e.createElement("div",{className:GL.fakeAva,key:"user-".concat(n)})})),r.length>3&&o("card.total.user",r.length)))}))),u.map((function(t,n){var r=function(e,t){var n,i=(null===(n=e.values.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value)||[void 0,void 0];if(t.type===gB.timeRange){var r=t.typeExtraInfo.timeRangeLabels,o=r[0],a=r[1],s=i,l=s[0],c=s[1];return[{label:o,value:tO(l),time:l,ext:O("card.attr.startendtime.start.short")},{label:a,value:tO(c),time:c,ext:O("card.attr.startendtime.end.short")}]}}(i,t)||[];return e.createElement("div",{className:GL.partContainer,key:"timeRange-".concat(n)},r.map((function(t,n){return e.createElement("div",{className:GL.row,key:n},e.createElement("div",null,t.label),e.createElement("div",null,t.value||"-",t.value&&e.createElement("span",{style:{marginLeft:"8px"}},t.ext)))})))})),d.map((function(t,n){var r=function(e,t){var n;if(t.type===gB.fileList){var i=(null===(n=e.values.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value)||[];if(!i)return;return i}}(i,t)||[];return e.createElement("div",{className:GL.partContainer,key:"file-".concat(n)},e.createElement("div",{className:j(GL.row,0!==r.length&&GL.fileRow)},e.createElement("div",null,o("card.attr.attachment")),0===r.length&&e.createElement("div",null,"-")),e.createElement("div",{className:GL.phoneFileListContainer},r.map((function(t){var n=function(e){switch(e.type){case TI.IMAGE:return aO;case TI.FILE:return sO;case TI.AUDIO:return lO;case TI.VIDEO:return cO}}(t),i=function(e){return e.fileId?e.fileId:e.elmId}(t);return n&&e.createElement(dO,{key:i,file:t},e.createElement(n,{file:t}))}))))})),p.map((function(t,n){var r,o=null===(r=i.values.find((function(e){return e.attribute===t.id})))||void 0===r?void 0:r.value;return o?e.createElement("div",{className:GL.partContainer,key:"rich-".concat(n)},e.createElement("div",{className:GL.row},o)):null})))):null}function lF(t){var n=t.attr,i=t.defaultId,r=t.onChange,o=n.typeExtraInfo.options,a=W().getUpimeTrans;return e.createElement("div",{className:GL.radioSelectDrawerBox},o.map((function(t){var n=t.id,o=t.label;return e.createElement("div",{key:n,onClick:function(){r(n)},className:GL.row},e.createElement("span",null,o),i===n&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",style:{color:"#2d9bf0"}}))})),e.createElement("div",{onClick:function(){r("")},className:GL.row},e.createElement("span",null,a("common.wu"))))}function cF(t){var n=t.onChange,i=t.defaultIds,r=e.useContext(xl).upime,o=W().getUpimeTrans,a=e.useState(""),s=a[0],l=a[1],c=e.useRef(null),u=rL().userList,d=e.useState(i),p=d[0],h=d[1],f=e.useState(Boolean(r.kanbanConfig.silentAddUser)),m=f[0],v=f[1],g=e.useMemo((function(){return u.filter((function(e){return!s||e.userName.includes(s)}))}),[u,s]);return e.createElement("div",{className:j(GL.userSelectDrawerBox,GL.userDrawerBox)},e.createElement("div",{className:GL.actionRow},e.createElement("span",{onClick:function(){n()}},o("common.cancel")),e.createElement("span",{style:{color:"#2e73e5"},onClick:function(){n(p)}},o("common.queding")+"("+p.length+")")),e.createElement("div",{className:GL.searchRow},e.createElement("div",{className:GL.inputBox},e.createElement(hl,{icon:"sousuo"}),e.createElement("input",{type:"text",placeholder:o("search.icon.hint"),onChange:function(e){l(e.target.value)},ref:c,value:s}),s.length>0&&e.createElement("div",{className:GL.clearInput,onClick:function(){var e;l(""),null===(e=c.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"})))),e.createElement("div",{className:GL.listBox},g.length>0?g.map((function(t){var n=t.loginName,i=t.userName,r=t.avatarUrl,o=p.includes(n);return e.createElement("div",{className:GL.userRow,key:n,onClick:function(){o?h(p.filter((function(e){return e!==n}))):(h(R(R([],p,!0),[n],!1)),l(""))}},e.createElement("div",{className:GL.nameBox},e.createElement(ml,{url:r,className:GL.avatar}),e.createElement("div",{className:GL.userName},i)),o&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",style:{color:"#2d9bf0"}}))})):e.createElement("div",{className:GL.noUsersBox},o("common.search.none"))),e.createElement("div",{className:GL.reportRow,onClick:function(){return function(e){var t,n;v(e),r.kanbanConfig.silentAddUser=e,null===(n=(t=r.kanbanConfig).saveKanbanSilentAddUser)||void 0===n||n.call(t,e)}(!m)}},e.createElement(of,{state:m?Zh.SelectNone:Zh.SelectAll}),e.createElement("div",null,o("kaban.userlist.send"))))}function uF(t){var n=t.values,i=t.attr,r=t.onChange,o=W().getUpimeTrans,a=e.useContext(xl).upime,s=e.useRef(null),l={};e.useEffect((function(){Object.values(l).forEach((function(e){return null==e?void 0:e()}))}),[]);var c=e.useReducer((function(e){return e+1}),0);c[0];var u=c[1],d=e.useRef();function p(){var e;return(null===(e=n.find((function(e){return e.attribute===i.id&&e.type===i.type})))||void 0===e?void 0:e.value)||[]}e.useEffect((function(){var e=new Yp(a,13,(function(e){var t=e[1],n=R([],p(),!0),o=n.findIndex((function(e){return e.fileId===t.fileId}));o>-1&&(Object.assign(n[o],{transStatus:t.status,duration:t.duration}),r({attribute:i.id,type:gB.fileList,value:n}))}));return e.open(),d.current=e,function(){return e.close()}}),[]);var h=p();return e.createElement("div",{className:j(GL.row,GL.fileRow),onClick:function(){var e;null===(e=s.current)||void 0===e||e.click()}},e.createElement("div",null,o("card.attr.attachment")),e.createElement("div",{className:j(GL.fileListSelectPhoneBox,GL.content)},e.createElement("span",null,o("card.file.upload.placeholder")),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou}),e.createElement("input",{onChange:function(e){_c("cv_cardfiles_upload",{type:"本地上传"}),function(e){var t;A(this,void 0,void 0,(function(){var n,c,f,m,v,g,y,b=this;return D(this,(function(E){switch(E.label){case 0:return e?(n=nO.split(","),Array.from(e).some((function(e){var t=Jo(e.name);return!n.includes(".".concat(t))}))?(a.addToast(o("upload.notSupportFiles"),{style:{zIndex:9999}}),[2]):[4,ra(a)]):[2];case 1:if(!E.sent())return[2];if(0===(c=oO(e,a)).length)return[2];f=[],m=function(e){var n,o,s,c,h;return D(this,(function(m){switch(m.label){case 0:return[4,rO(e,a)];case 1:return n=m.sent(),f.push(n),o=Math.random().toString(),s=function(e,t){return function(){var s;return n.failed=!1,n.abort=t,l[o]=t,null===(s=n.pending)||void 0===s?void 0:s.request(e,(function(e){n.pending&&(n.pending.progress=e,u())})).then((function(e){return A(b,void 0,void 0,(function(){var t,s,c,h,f,m;return D(this,(function(v){return t={fileId:e,name:n.append.name||"",ext:n.append.ext||"",fileSize:n.append.size||0},n.type===TI.VIDEO||n.type===TI.AUDIO?a.transcodeMedia(e).then((function(a){var s,c,h,f;if(a){null===(s=d.current)||void 0===s||s.sendSCmd(Lp.send,e);var m=null;n.type===TI.VIDEO&&(m=exports.E(exports.E({},t),{type:TI.VIDEO,duration:a.duration,transStatus:a.status,estimateCompleteTime:a.estimateCompleteTime,coverFileId:(null===(c=a.coverInfo)||void 0===c?void 0:c.fileId)||"",width:(null===(h=a.coverInfo)||void 0===h?void 0:h.width)||0,height:(null===(f=a.coverInfo)||void 0===f?void 0:f.height)||0})),n.type===TI.AUDIO&&(m=exports.E(exports.E({},t),{type:TI.AUDIO,duration:a.duration,transStatus:a.status,estimateCompleteTime:a.estimateCompleteTime}));var v=R([],p(),!0),g=v.findIndex((function(e){return e===n}));m&&g>-1&&(v[g]=m,r({attribute:i.id,type:gB.fileList,value:v})),n.append.fileId=e,n.finished=!0,n.failed=!1,delete n.pending,delete l[o],u()}})):(s=null,n.type===TI.IMAGE&&(c=exports.E(exports.E({},t),{type:TI.IMAGE,width:n.append.width||0,height:n.append.height||0}),s=c),n.type===TI.FILE&&(h=exports.E(exports.E({},t),{type:TI.FILE}),s=h),f=R([],p(),!0),m=f.findIndex((function(e){return e===n})),s&&m>-1&&(f[m]=s,r({attribute:i.id,type:gB.fileList,value:f})),n.append.fileId=e,n.finished=!0,n.failed=!1,delete n.pending,delete l[o],u()),[2]}))}))}))}},h=new Promise((function(e){c=e})),null===(t=s(h,c))||void 0===t||t(),[2]}}))},v=0,g=c,E.label=2;case 2:return v<g.length?(y=g[v],[5,m(y)]):[3,5];case 3:E.sent(),E.label=4;case 4:return v++,[3,2];case 5:return r({attribute:i.id,type:gB.fileList,value:R(R([],f,!0),h,!0)}),s.current&&(s.current.value=""),[2]}}))}))}(e.target.files)},ref:s,type:"file",multiple:!0,accept:nO,className:GL.hiddenInput})))}function dF(n){var i,r=n.card,o=n.onClose,a=n.onSubmit,s=W().getUpimeTrans,l=e.useContext(xl).upime,c=e.useReducer((function(e){return e+1}),0)[1];e.useEffect((function(){if(r){var e=function(){return c()};return r.onValueUpdateCBList.push(e),function(){r.onValueUpdateCBList=r.onValueUpdateCBList.filter((function(t){return t!==e}))}}}),[r]);var u=(null===(i=null==r?void 0:r.pareantKanban)||void 0===i?void 0:i.attributes)||[],d=u.filter((function(e){return e.type===gB.radio&&"defalut"===e.source})),p=u.filter((function(e){return e.type===gB.radio&&"custom"===e.source})),h=u.filter((function(e){return e.type===gB.userList})),f=u.filter((function(e){return e.type===gB.timeRange})),m=u.filter((function(e){return e.type===gB.fileList})),v=u.filter((function(e){return e.type===gB.richText})),g=e.useState(r.name),y=g[0],b=g[1],E=e.useState(r.color),x=E[0],w=E[1],C=e.useState(_t.cloneDeep(r.values)),S=C[0],k=C[1],_=e.useRef(null),T=e.useRef(null),I=e.useRef(!1),P=e.useRef(),N=e.useState(!1),M=N[0],A=N[1],D=function(e){if(e.type===gB.radio){var t=S.find((function(t){return t.attribute===e.id}));l.showPhoneDrawer(lF,{attr:e,defaultId:t?t.value:"",onChange:function(n){t?t.value=n:S.push({attribute:e.id,type:gB.radio,value:n}),l.closePhoneDrawer(),k(R([],S,!0))}},{coverVisible:!0,markCloseable:!0,supportSwipe:!1,classNames:"cardEditDrawer",coverClassNames:"coverCardEditDrawer"})}else if(e.type===gB.userList){var n=S.find((function(t){return t.attribute===e.id}));l.showPhoneDrawer(cF,{defaultIds:n?n.value:[],onChange:function(t){t&&(n?t.length>0?n.value=t:n.value=[]:S.push({attribute:e.id,type:gB.userList,value:t})),l.closePhoneDrawer(),k(R([],S,!0))}},{coverVisible:!0,markCloseable:!1,supportSwipe:!1,classNames:"cardEditDrawer",coverClassNames:"coverCardEditDrawer"})}};return e.useEffect((function(){return function(){P.current&&clearTimeout(P.current)}}),[]),e.createElement("div",{className:GL.phoneViewContainer},e.createElement("div",{className:j(GL.partContainer,GL.head)},e.createElement("div",{className:GL.row},e.createElement(hl,{icon:"guanbi",size:20,onClick:o}))),e.createElement("div",{className:GL.scrollContainer},e.createElement("div",{className:GL.partContainer},e.createElement("div",{className:GL.row},e.createElement("input",{type:"text",placeholder:s("kanban.no.name.placeholder"),value:y,className:GL.titleInput,onChange:function(e){b(e.target.value)},ref:_,onBlur:function(){var e;I.current&&(null===(e=_.current)||void 0===e||e.focus(),b(""),I.current=!1)}}),y.length>0&&e.createElement("div",{className:GL.clearBox,onTouchStart:function(e){I.current=!0},ref:T},e.createElement("div",{className:GL.clearInput},e.createElement(hl,{icon:"guanbi"}))))),e.createElement("div",{className:GL.partContainer},e.createElement("div",{className:j(GL.row,GL.colorRow),onClick:function(){l.showPhoneDrawer(Yb,{className:GL.cardColorPickDrawer,defaultValue:x,onChanged:function(e){w(e),l.closePhoneDrawer()}},{coverVisible:!0,markCloseable:!0,supportSwipe:!1,classNames:"cardEditDrawer",coverClassNames:"coverCardEditDrawer"})}},e.createElement("div",null,s("card.attr.color")),e.createElement("div",{className:GL.content},e.createElement(Vb,{color:x,opacity:1,className:GL.colorCircle}),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou}))),d.map((function(t,n){var i=pF(S,t);return e.createElement("div",{className:GL.row,key:"radio-".concat(n),onClick:function(){D(t)}},e.createElement("div",null,t.label),e.createElement("div",{className:GL.content},i?e.createElement("div",{className:GL.tagContainer,style:{background:hr(i.color,.25)}},i.label):e.createElement("span",{style:{color:"#91939c"}},s("card.radio.placeholder")),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou})))})),h.map((function(t,n){var i=function(e,t,n){var i,r=(null===(i=e.find((function(e){return e.attribute===t.id})))||void 0===i?void 0:i.value)||[];if(t.type===gB.userList)return r.map((function(e){return n.userManager.getUser(e)}))}(S,t,l)||[],r=i.slice(0,3);return e.createElement("div",{className:GL.row,key:"user-".concat(n),onClick:function(){D(t)}},e.createElement("div",null,t.label),e.createElement("div",{className:GL.content},e.createElement("div",{className:GL.userListUser},0===i.length&&e.createElement("span",{style:{color:"#91939c"}},s("card.radio.placeholder")),r.map((function(t,n){return t.avatarUrl?e.createElement("img",{src:t.avatarUrl,alt:"",className:GL.avaImage,key:"user-".concat(n)}):e.createElement("div",{className:GL.fakeAva,key:"user-".concat(n)})})),i.length>3&&s("card.total.user",i.length)),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou})))}))),f.map((function(t,n){var i=hF(S,t)||[];return e.createElement("div",{className:GL.partContainer,key:"timeRange-".concat(n)},i.map((function(n,i){return e.createElement("div",{className:GL.row,key:i,onClick:function(){l.showPhoneDrawer(kL,{value:n.time,label:n.label,onChange:function(e){var n=S.find((function(e){return e.attribute===t.id}));if(n)n.value[i]=e;else{var r=[void 0,void 0];r[i]=e,S.push({attribute:t.id,type:gB.timeRange,value:r})}var o=n.value,a=o[0],s=o[1];if(a&&s&&a>s)return P.current&&clearTimeout(P.current),A(!0),void(P.current=setTimeout((function(){A(!1)}),3e3));k(R([],S,!0)),l.closePhoneDrawer()}},{coverVisible:!0,markCloseable:!1,supportSwipe:!1,classNames:"cardEditDrawer",coverClassNames:"coverCardEditDrawer"})}},e.createElement("div",null,n.label),e.createElement("div",{className:GL.content},e.createElement("div",null,n.value?e.createElement("span",{className:GL.timerangeContent},e.createElement("span",null,n.value),e.createElement("span",{style:{marginLeft:"8px"}},n.ext),e.createElement(hl,{icon:"guanbi",onClick:function(e){var n=S.find((function(e){return e.attribute===t.id}));n&&(n.value[i]=void 0),k(R([],S,!0)),e.stopPropagation()}})):e.createElement("span",{style:{color:"#91939c"}},s("card.radio.placeholder"))),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou})))})))})),m.map((function(t,n){var i=function(e,t){var n;if(t.type===gB.fileList){var i=(null===(n=e.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value)||[];if(!i)return;return i}}(S,t)||[];return e.createElement("div",{className:GL.partContainer,key:"file-".concat(n)},e.createElement(uF,{values:S,attr:t,onChange:function(e){var n=S.find((function(e){return e.attribute===t.id}));n?n.value=e.value:S.push({attribute:t.id,type:gB.fileList,value:e.value}),k(R([],S,!0))}}),e.createElement("div",{className:j(GL.phoneFileListContainer,i.length>0&&GL.hasFiles)},i.length>0&&i.map((function(i){var r=function(e){switch(e.type){case TI.IMAGE:return aO;case TI.FILE:return sO;case TI.AUDIO:return lO;case TI.VIDEO:return cO}}(i),o=function(e){return e.fileId?e.fileId:e.elmId}(i);return r&&e.createElement(dO,{key:o,file:i,onRemove:function(){return function(e,t){var n,i,r=S.find((function(e){return e.attribute===t.id&&e.type===t.type}));if(r){var o=r.value;null===(i=null===(n=o[e])||void 0===n?void 0:n.abort)||void 0===i||i.call(n),r.value=o.filter((function(t,n){return n!==e})),k(R([],S,!0))}}(n,t)}},e.createElement(r,{file:i}))}))))})),v.map((function(t,n){var i,r=null===(i=S.find((function(e){return e.attribute===t.id})))||void 0===i?void 0:i.value;return e.createElement("div",{className:GL.partContainer,key:"rich-".concat(n)},e.createElement("div",{className:GL.row},t.label),e.createElement("div",{className:j(GL.row,GL.descRow)},e.createElement("div",{contentEditable:!0,suppressContentEditableWarning:!0,className:GL.descBox,dangerouslySetInnerHTML:{__html:r},onInput:function(e){var n=S.find((function(e){return e.attribute===t.id}));n?n.value=e.currentTarget.textContent||"":S.push({attribute:t.id,type:gB.richText,value:e.currentTarget.textContent||""})},placeholder:s("card.desc.placeholder")})))})),e.createElement("div",{className:GL.partContainer},p.length>0&&p.map((function(t,n){var i=pF(S,t);return e.createElement("div",{className:GL.row,key:"radio-".concat(n),onClick:function(){D(t)}},e.createElement("div",null,t.label),e.createElement("div",{className:GL.content},i?e.createElement("div",{className:GL.tagContainer,style:{background:hr(i.color,.25)}},i.label):e.createElement("span",{style:{color:"#91939c"}},s("card.radio.placeholder")),e.createElement(hl,{icon:"youjiantou",className:GL.jiantou})))})))),e.createElement("div",{className:j(GL.partContainer,GL.actionContainer)},e.createElement("div",{className:GL.row},e.createElement("div",{className:GL.confirmBtn,onClick:function(){var e={values:S};e.name=y,e.color=x,a(e)}},s("common.queding")))),M&&t.createPortal(e.createElement("div",{className:GL.timeRangeErrorToast},s("card.attr.startendtime.errortext")),document.body))}function pF(e,t){var n,i=null===(n=e.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value;if(t.type===gB.radio)return t.typeExtraInfo.options.find((function(e){return e.id===i}))}function hF(e,t){var n,i=(null===(n=e.find((function(e){return e.attribute===t.id})))||void 0===n?void 0:n.value)||[void 0,void 0];if(t.type===gB.timeRange){var r=t.typeExtraInfo.timeRangeLabels,o=r[0],a=r[1],s=i,l=s[0],c=s[1];return[{label:o,value:tO(l),time:l,ext:O("card.attr.startendtime.start.short")},{label:a,value:tO(c),time:c,ext:O("card.attr.startendtime.end.short")}]}}function fF(t){var n=this,i=t.success,r=t.fail,o=t.content,a=o.card,s=o.kanban,l=e.useState(a.name),c=l[0],u=l[1],d=e.useState(a.color),p=d[0],h=d[1],f=e.useState(_t.cloneDeep(a.values)),m=f[0],v=f[1],g=e.useState(_t.cloneDeep(a.values))[0],y=e.useState(a.name)[0],b=e.useState(a.color)[0],E=e.useContext(xl).upime,x=W().getUpimeTrans;e.useEffect((function(){var e=function(){var e=a.values.filter((function(e){return e.type===gB.fileList})).map((function(e){return e.value})).flat().filter((function(e){return e.type===TI.AUDIO||e.type===TI.VIDEO})).filter((function(e){return 1===e.transStatus}));if(0!==e.length){var t=!1,n=m.map((function(n){if(n.type!==gB.fileList)return n;var i=n.value;return i.forEach((function(n){if(n.type===TI.AUDIO||n.type===TI.VIDEO){var i=e.find((function(e){return e.fileId===n.fileId}));i&&i.transStatus!==n.transStatus&&(t=!0,Object.assign(n,i))}})),exports.E(exports.E({},n),{value:i})}));t&&v(n)}};return a.onValueUpdateCBList.push(e),function(){a.onValueUpdateCBList=a.onValueUpdateCBList.filter((function(t){return t!==e}))}}),[]);var w=function(e){var t=m.find((function(t){return t.attribute===e.attribute}));t?t.value=e.value:m.push(e),v(R([],m,!0))},C=e.useRef(!1),S=e.useRef(null),k=e.useRef(null),_=e.useRef(null);return e.createElement(qL.Provider,{value:{scrollRef:_}},e.createElement("div",{className:j(GL.cardEditModalWrapper,!E.editable&&GL.disabled,!_e.desktop&&GL.noDesktop),onMouseMove:function(e){e.stopPropagation()}},e.createElement("div",{className:GL.cardEditModalContainer},e.createElement(hl,{icon:"guanbi",className:GL.guanbiButton,onClick:function(){return r("close")}}),e.createElement("input",{type:"text",className:GL.textTitle,placeholder:x("card.title.placeholder"),value:c,ref:k,onChange:function(e){u(e.target.value)},onFocus:function(){S.current.style.backgroundColor="#2e73e5",k.current.style.caretColor="#2e73e5"},onBlur:function(){S.current.style.backgroundColor="#E6E7E9",k.current.style.caretColor="#979797"},disabled:!E.editable}),e.createElement("div",{ref:S,className:GL.divider}),e.createElement("div",{className:GL.cardEditPropContainer,ref:_,style:{maxHeight:"calc(min(390px, 50vh))"}},e.createElement("div",{className:GL.colorContainer},e.createElement("div",{className:GL.propertyNameBox},e.createElement(hl,{icon:"yansetianchong",size:16}),e.createElement("span",null,x("card.attr.color"))),e.createElement("div",{className:j(GL.propertyValueBox,GL.noHide)},e.createElement(QL,{card:a,color:p,onChange:function(e){return h(e)}}))),s.attributes.length>0&&s.attributes.map((function(t){var n=t.type,i=t.label,r=t.id,o=aF(t);switch(n){case gB.radio:return e.createElement("div",{className:GL.priorityContainer,key:r},e.createElement("div",{className:GL.propertyNameBox},e.createElement(hl,{icon:o,size:16}),e.createElement("span",null,i)),e.createElement("div",{className:GL.propertyValueBox},e.createElement(YL,{options:t,card:a,onChange:w})));case gB.userList:return e.createElement("div",{className:GL.userListContainer,key:r},e.createElement("div",{className:GL.propertyNameBox},e.createElement(hl,{icon:o}),e.createElement("span",null,i)),e.createElement("div",{className:GL.propertyValueBox},e.createElement(JL,{attr:t,values:m,onChange:w})));case gB.timeRange:return e.createElement("div",{key:r},e.createElement($L,{attr:t,values:m,onChange:w}));case gB.richText:return e.createElement("div",{className:GL.descContainer,key:r},e.createElement("div",{className:GL.descNameBox},e.createElement(hl,{icon:o}),e.createElement("span",null,i)),e.createElement("div",{className:GL.propertyValueBox},e.createElement(ZL,{options:t,card:a,onChange:w})));case gB.fileList:return e.createElement("div",{className:GL.fileListOutter,key:r},e.createElement("div",{className:GL.propertyNameBox},e.createElement(hl,{icon:o}),e.createElement("span",null,i)),e.createElement("div",{className:j(GL.propertyValueBox,GL.noHide)},e.createElement(hO,{attr:t,values:m,onChange:w})));default:return null}}))),E.editable&&e.createElement("div",{className:GL.actionContainer},e.createElement("div",{className:GL.cancel,onClick:function(){return r("cancel")}},x("common.cancel")),E.editable&&e.createElement("div",{className:GL.confirm,onClick:function(){return A(n,void 0,void 0,(function(){var e,t,n,r,o,s,l;return D(this,(function(u){if(C.current)return[2];for(e="",t=0;t<m.length;t++){if((n=m[t]).type===gB.timeRange&&(r=n.value,o=r[0],s=r[1],o&&s&&o>s)){e=x("card.attr.startendtime.errortext");break}if(n.type===gB.fileList&&n.value.some((function(e){var t;return null===(t=e)||void 0===t?void 0:t.pending}))){e=x("card.attr.filelist.uploading");break}}return e?(E.addToast(e,{type:"warning",style:{zIndex:3e3}}),[2]):(l={values:vF(m,g,a.values)},c!==y&&(l.name=c),p!==b&&(l.color=p),i(l),[2])}))}))}},x("modal.ok"))))))}function mF(e,t){return"string"==typeof e?e===t:(null==e?void 0:e.fileId)===(null==t?void 0:t.fileId)}function vF(e,t,n){var i=e.map((function(e){var i,r,o,a;if(e.type===gB.fileList||e.type===gB.userList||e.type===gB.checkbox){var s=e.value,l=(null===(i=t.find((function(t){return t.attribute===e.attribute})))||void 0===i?void 0:i.value)||[],c=(null===(r=n.find((function(t){return t.attribute===e.attribute})))||void 0===r?void 0:r.value)||[],u=s.filter((function(e){return!l.some((function(t){return mF(t,e)}))})),d=l.filter((function(e){return!s.some((function(t){return mF(t,e)}))})),p=R([],c,!0);return u.forEach((function(t){p.some((function(e){return mF(e,t)}))||(e.type===gB.fileList?p.unshift(t):p.push(t))})),d.forEach((function(e){p.some((function(t){return mF(t,e)}))&&(p=p.filter((function(t){return!mF(t,e)})))})),p.sort((function(e,t){return s.indexOf(e)-s.indexOf(t)})),exports.E(exports.E({},e),{value:p})}if(e.type===gB.radio||e.type===gB.richText){var h=e.value,f=(null===(o=t.find((function(t){return t.attribute===e.attribute})))||void 0===o?void 0:o.value)||"";if(c=(null===(a=n.find((function(t){return t.attribute===e.attribute})))||void 0===a?void 0:a.value)||"",h===f&&f!==c)return exports.E(exports.E({},e),{value:c})}return e}));return n.forEach((function(e){i.find((function(t){return t.attribute===e.attribute}))||i.push(_t.cloneDeep(e))})),i}function gF(t){var n=e.useContext(xl).upime;return n.phoneMode?t.content?n.editable?e.createElement(dF,{onClose:function(){return t.fail("cancel")},onSubmit:function(e){return t.success(e)},card:t.content.card}):e.createElement(sF,{card:t.content.card,onClose:function(){return t.fail("cancel")}}):null:e.createElement(fF,exports.E({},t))}function yF(){var t=W().getUpimeTrans;return e.createElement("div",{className:Pc.elementDeleteToastContainer},e.createElement(hl,{icon:"jinggao"}),e.createElement("span",null,t("element.delete.already")))}function bF(t){t.addToast(e.createElement(yF,null))}function EF(){var t=W().getUpimeTrans;return e.createElement("div",{className:Pc.noclipboard},e.createElement("div",{className:Pc.text},t("common.noclipboard.tip")),e.createElement(ul,{type:"primary",className:Pc.ruhecaozuo,onClick:function(){window.open("https://help.infi.cn/FAQ/b37c/8b52")}},t("common.ruhecaozuo")))}var xF="hideAll_BSu23",wF="headTitle_t5CkO",CF="headIconContainer_1gt_Q",SF="tiny_3xiQ6",kF="translateSelectorContainer_egKyN",_F="translateSelectorContent_32Uwe",TF="input_3AwAe",IF="hideOverflow_3vS9o",PF="actionBt_2Hy0s",NF="modalContent_169VU",MF=function(n){var i=n.config,r=n.upime,o=n.hide,a=e.useContext(Ic).toastContainer,s=r.userManager.enableAIChat?420:352;al(r,["online"]);var l=e.useState(!1),c=l[0],u=l[1];e.useEffect((function(){c&&!r.online&&u(!1)}),[r.online,c]);var d=e.useState(!0),p=d[0],h=d[1],f=e.useRef(null),m=e.useRef(null),v=e.useState(!1),g=v[0],y=v[1];return e.useEffect((function(){c&&!g&&y(!0)}),[c]),e.useEffect((function(){c&&_c("cv_ai_assistant")}),[c]),e.createElement(e.Fragment,null,e.createElement("div",{className:j("iconRoot_3JGj3",o&&xF),onClick:function(){u(!c)}},e.createElement("div",{className:j("iconWrap_2MBnC")},e.createElement("div",{style:{width:"28px",height:"28px",background:"url(".concat($o("ai_button.png"),")"),backgroundSize:"100% 100%"}}))),a.current&&g&&t.createPortal(e.createElement(Hc,{initSize:{width:500,height:s},className:j("draggableRoot_2qSTc","round_2XZUY",o&&xF,!c&&"notShow_3rotu"),initOffset:function(){var e=document.getElementById("BottomUI");if(e){var t=e.getBoundingClientRect();return{x:t.right-500,y:t.bottom-48-s}}}(),supportResize:p,supportFourCornersResize:!0,freeMode:!0,minScale:1,resizeBtnClzName:"resizeBtn_1klgP",skip:function(e){var t=e.target;return!(!m.current||!V(m.current,t))},noTransform:!0,safeDistance:8},e.createElement(HF,{setSupportResize:h,config:i,onClose:function(){return u(!1)},upime:r,hide:!c,headRef:f,bodyRef:m})),a.current))};function AF(e){return{isRootNode:!0,nodeColor:8005887,layout:Xa.HORIZONTAL,theme:Qa.COLORBRANCH,position:{x:0,y:0},size:{width:134,height:64},ha:"center",fontFamily:He,fontSize:14,lineHeight:Ue,lineHeightRate:We,hasBg:!1,bgColor:0,bgOpacity:1,zIndex:(null==e?void 0:e.newMaxZindex())||0}}var DF=function(e){function t(t){var n=e.call(this,t)||this;return n.defalutLayout=Xa.NONE,n.defalutTheme=Qa.COLORBRANCH,n.defalutChildrenCount=0,n._branchColorMap=new Map,n.addListener=function(e){n.unsub_userEvent&&n.unsub_userEvent();var t=[];"select"===e?(t.push(n.upime.userEventManager.subscribe("mousemove",(function(e){return _e.isHoverSupported&&n.checkMindMapConnectionRelation(e)}))),t.push(n.upime.userEventManager.subscribe("moveto",n.clearMindMapConnectablePoints)),t.push(n.upime.subscribe("elementsLocked",(function(e){n.currentNode&&e.includes(n.currentNode.id)&&(n.currentPoints=void 0)})),n.upime.subscribe("elementDeleted",(function(e){n.currentNode===e&&(n.currentPoints=void 0)})),n.upime.subscribe("elementSelected",(function(e){n.currentNode&&e.includes(n.currentNode)&&(n.currentPoints=void 0)}))),n.unsub_userEvent=function(){t.forEach((function(e){return e()})),n.currentPoints=void 0}):"mind-map"===e&&(n.unsub_userEvent=n.upime.userEventManager.subscribe("click",n.insertMindMap))},n.clearMindMapConnectablePoints=function(e){"touch"===e.connectType?(n._prePoints||(n._prePoints=n.currentPoints),n.currentPoints=void 0,e.isEnd&&(n.currentPoints=n._prePoints,n._prePoints=void 0)):(n.currentPoints=void 0,e.isEnd&&n.checkMindMapConnectionRelation(e,e.isEnd))},n.checkMindMapConnectionRelation=function(e,t){if(!e.connected||t){var i=n.upime.view.viewClip;if(!i||Ot(e.position,Bt(i.rect))){var r=n.currentNode;if(!r||!r.checkMindMapConnectionRelation(e.position,!0)){var o=n.upime.elementManager.getVisibleElements().sort((function(e,t){return t.zIndex-e.zIndex}));if(o.some((function(e){return e.elementType===Za.MINDMAP_NODE}))){for(var a=[],s=0;s<o.length;s++){var l=o[s];if("single"!==l.selectStatus&&!l.frozedGroup&&(c=l.checkSelectRelation(e.position,{type:"move"}))){if(l.elementType!==Za.MINDMAP_NODE||l.stable||a.push(exports.E(exports.E({},c),{element:l})),c.transparent)continue;break}}if(a.length>0){a.sort((function(e,t){return e.metric-t.metric}));var c,u=(c=a[0]).element;u===r||u.isMindmapNodeHideByCollapsed||(n.currentPoints=new nD(n.upime,n,u))}else n.currentPoints=void 0}}}else n.currentPoints=void 0}},n.insertMindMap=function(e,t){void 0===t&&(t=!0);var i=n.upime,r=i.createOperation(),o=r.create(Za.MINDMAP_NODE,exports.E(exports.E({},AF(i)),{layout:n.defalutLayout,theme:n.defalutTheme,position:{x:e.position.x-67,y:e.position.y-32}}));n.findAndSetParent(r,o);for(var a=o.layout===Xa.VERTICAL?"b":"r",s=0;s<n.defalutChildrenCount;s++)n.createChildNode(o,{location:a},void 0,{op:r,noEdit:!0});var l=n.upime.createLock([o.id]);r.sync(),i.switchMode("select");var c=i.selectElement(o);return t?c.startEdit({lock:l,op:r}):i.clearLock(l),n._branchColorMap.set(o.id,0),n.resetDefaultInsertState(),o},n.addListener(n.upime.xmode),n.unsub_xmode=n.upime.subscribe("xmodechange",n.addListener),n}return P(t,e),Object.defineProperty(t.prototype,"currentPoints",{get:function(){return this._currentPoints},set:function(e){this._currentPoints&&e!==this._currentPoints&&(this.upime.removeCtrlWidget(this._currentPoints),this._currentPoints.destroy(),this._currentPoints=void 0),e&&"view"!==this.upime.xmode&&(this._currentPoints=e,this.upime.addCtrlWidget(e))},enumerable:!1,configurable:!0}),t.prototype.clearPoints=function(){this.currentPoints=void 0,this._prePoints=void 0},Object.defineProperty(t.prototype,"currentNode",{get:function(){var e;return(null===(e=this.currentPoints)||void 0===e?void 0:e.element)||null},enumerable:!1,configurable:!0}),t.prototype.createMindMapConnectablePoints=function(e){this.currentPoints=new nD(this.upime,this,e)},t.prototype.handlePointClick=function(e,t){this.createChildNode(e,t),_e.isHoverSupported&&(this.currentPoints=void 0)},t.prototype.createChildNode=function(e,t,n,i){var r,o,a=void 0===i?{}:i,s=a.op,l=a.noEdit,c=void 0!==l&&l,u=a.noSelect,d=void 0!==u&&u,p=a.content,h=void 0===p?[]:p,f=this.upime,m=s||f.createOperation();if(e.isRootNode&&e.layout===Xa.NONE){var v="l"===t.location||"r"===t.location?Xa.HORIZONTAL:Xa.VERTICAL;f.createOperation().updateSync(e,{layout:v})}for(var g=t.location,y=e;y;)!y.leftCollapsed||"l"!==g&&"t"!==g||y.toggleLeftCollapsed(m),!y.rightCollapsed||"r"!==g&&"b"!==g||y.toggleRightCollapsed(m),y=y.parent;var b=e.nodeColor;if(e.isRootNode){var E=null!==(r=this._branchColorMap.get(e.id))&&void 0!==r?r:0;e.theme===Qa.COLORBRANCH&&(b=eD[E]),this._branchColorMap.set(e.id,(E+1)%(eD.length-1))}var x={layout:e.layout,theme:e.theme,isRootNode:!1,nodeColor:b,size:{width:82,height:40},scale:e.scale,position:n?n.getNewSiblingPosition(t.location):e.getNewChildPosition(t.location),zIndex:f.newMaxZindex(),fontFamily:e.fontFamily,ha:"t"===t.location||"b"===t.location?"center":"l"===t.location?"right":"left",fontSize:e.fontSize,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate,hasBg:!1,bgColor:0,bgOpacity:1,va:"top",autoWidth:!0,richContent:{version:this.upime.genOtVersion(0),content:h},leftCollapsed:null,rightCollapsed:null},w=(h||[]).map((function(e){return e[0].join("")})).join("").split("");if(w.length>0){var C=Wi(w,{lineHeight:x.lineHeight,fontSize:x.fontSize,fontFamily:x.fontFamily},{wordWrapWidth:600}),S=wD.getPadding(x.lineHeight,!1),k=C.width+S.left+S.right,_=C.height+S.top+S.bottom;x.size.width=k,x.size.height=_}var T=m.create(Za.MINDMAP_NODE,x),I=null===(o=this.findFrame(T))||void 0===o?void 0:o.id;I&&m.update(T,{frameId:I}),d||f.selectElement(T);var P={startElementId:e.id,startArrow:0,startType:2,endElementId:T.id,endArrow:0,endType:2,lineWidth:2,lineType:e.theme===Qa.COLORBRANCH?3:2,lineStyle:1,lineColor:b,zIndex:f.newMaxZindex()},N=cp(t.location);P.startPosition=N.start,P.endPosition=N.end;var M=m.create(Za.MINDMAP_LINE,P),A=[T.id,M.id];e.isRootNode||A.push(e.id);var D=T.onAlignTheTree(m);A.push.apply(A,D.map((function(e){return e.id})));var R=this.upime.createLock(A);if(d)this.upime.clearLock(R);else{var B=f.selectElement(T);c?this.upime.clearLock(R):B.startEdit({lock:R,op:m})}return m.sync(),T},t.prototype.setDefaultInsertState=function(e,t,n){this.defalutLayout=e,this.defalutTheme=t,this.defalutChildrenCount=n},t.prototype.resetDefaultInsertState=function(){this.setDefaultInsertState(Xa.NONE,Qa.COLORBRANCH,0)},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_userEvent;void 0!==e&&e()},t}(zd);function RF(e,t,n,i,r){return A(this,void 0,void 0,(function(){var o,a;return D(this,(function(s){switch(s.label){case 0:return t.isUsingAi?[2]:(t.isUsingAi=!0,o=!1,t.aiAborter=function(){o=!0},[4,Qy(t)]);case 1:return a=s.sent(),o?[2]:a?(t.aiServerHelper.generateCommonContentUsingAi({texts:[e],type:i,translate:r},a).then((function(e){if(!o){t.onAiGenerteEnd();var i=Array.isArray(e)?e.join("\n"):e;i?(BF(i,t,{beforeInsert:function(){return n(!1)},afterInsert:function(){return n(!0)}}),t.addToast(O("ai.using.done"))):t.addToast(O("ai.error"))}})).catch((function(){o||(t.onAiGenerteEnd(),t.addToast(O("ai.error")))})),[2]):(t.isUsingAi=!1,[2,!1])}}))}))}function BF(e,t,n){var i,r=(null==n?void 0:n.toTop)||!1,o=(null==n?void 0:n.select)||!0,a=Lt(t.view.getViewbox());t.operationInterrupt();var s=t.createOperation(),l=t.insertTextAt(a,{text:e,autoStartEdit:!1,verticalPos:"center",currentOp:s,noSync:!0,slient:!0}),c=l.getGlobalBox(),u=Jg(c,t,(function(e){return e===l||e.elementType===Za.FRAME})),d=u[0],p=u[1];d&&(s.update(l,{position:{x:p.left,y:p.top}}),c=p),s.sync(),t.followManager.forcedFollowing||(null===(i=null==n?void 0:n.beforeInsert)||void 0===i||i.call(n),Promise.race([t.makeBorderCenter(c,ty(t,r)),Dc(1)]).finally((function(){var e;null===(e=null==n?void 0:n.afterInsert)||void 0===e||e.call(n)}))),o&&t.selectElement(l)}function LF(e,t,n){e.forEach((function(e){if(e.isSupportFrame&&e.parentRefSystem===n.view.elementsRoot){var i=e.getBorderBox(),r=n.getAllFrames().find((function(e){return e.checkBorderInFrame(i)}));r&&t.update(e,{frameId:r.id})}}))}function OF(){switch(Ce){case"www":return"https://infi.cn/static/infi-gpt/";case"test":return"https://testc2c.plaso.cn/static/infi-gpt";default:return"https://devc2c.plaso.cn/static/infi-gpt/"}}var FF=e.createContext({isShowScaleShow:!0,setIsShowScaleShow:function(){return""},eventCenter:new ro});function zF(){return e.useContext(FF)}var HF=function(t){var n,i=t.onClose,r=t.upime,o=t.setSupportResize,a=t.hide,s=t.headRef,l=t.bodyRef;al(r,["aiCountInPackage","aiCountOutPackage"]);var c=r.phoneMode,u=e.useRef(null),d=zF().setIsShowScaleShow,p=KF(),h=p.setBaseSize,f=p.checkTranslation;e.useEffect((function(){a||f()}),[a]),e.useEffect((function(){if(!a)return r.subscribe("boardResized",(function(){f()}))}),[a]);var m=W().getUpimeTrans,v=e.useRef(null),g=e.useState(!1),y=g[0],b=g[1],E=e.useState(!1),x=E[0],w=E[1],C=e.useState(!1),S=C[0],k=C[1];e.useEffect((function(){r.freshAiCount()}),[]);var _=e.useState(""),T=_[0],I=_[1],P=e.useState("dashboard"),N=P[0],M=P[1],B=e.useState(!1),L=B[0],O=B[1],F=e.useState(2),z=F[0],H=F[1];function U(e){var t,n="dashboard"===N||"chat"===N;M(e),I("");var i=function(e){switch(e){case"dashboard":return;case"chat":return"cv_interface_chat";case"mindmap":return"cv_interface_mindmap";case"simsticker":return"cv_interface_association";case"todo":return"cv_interface_task";case"translate":return"cv_interface_translation"}}(e);i&&_c(i);var a="dashboard"===e||"chat"===e;if(n!==a)if(a)null==o||o(!0),h(500,r.userManager.enableAIChat?420:352);else{null==o||o(!1);var s="translate"===e?68:0,l=(null===(t=r.chatgptConfig)||void 0===t?void 0:t.isShowRemainTip)?30:0;h(500,140+s+l)}a&&n?!L&&O(!0):L&&O(!1)}return e.createElement("div",{className:j("dashboardContainer_mRFS-",c&&"phone_1kP_V",_e.isPwa&&"pwa_3ESK_"),style:{backgroundImage:"url(".concat($o("ai_tool_bg.png"),")")},ref:u},e.createElement(UF,{upime:r,onClose:function(){U("dashboard"),i()},onClear:function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return x?(r.isDesktopModal=!0,r.showWindow(r.phoneMode?sP:YF,{content:m("ai.center.chat.clear.confirmation"),confirmText:m("ai.center.chat.clear.bt")},!1,!1).then((function(){var e,t;null===(t=null===(e=v.current)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({type:"clear"},"*")})).catch((function(){})).finally((function(){r.isDesktopModal=!1})),[2]):[2]}))}))},type:N,setType:U,headRef:s,scrolled:S}),e.createElement("div",{className:j.apply(void 0,R(R(["dashbardContentContainer_33BP7","chat"===N&&"noPaddingTop_3SfjG"],function(){switch(N){case"dashboard":return["noPaddingBottom_1Jt0M"];case"chat":return["chat_1UIt-"];case"mindmap":case"simsticker":case"todo":case"aippt":case"document":return[SF];case"translate":return[SF,"translate_FB3df"];default:return[!1]}}(),!1),[L&&"animate_1gxYl",!r.userManager.enableAIChat&&"simple_3IvPg",!(null===(n=r.chatgptConfig)||void 0===n?void 0:n.isShowRemainTip)&&"tinyPaddingBottom_29MWw"],!1)),ref:l},r.userManager.enableAIChat&&e.createElement(jF,{setAsking:b,ifrRef:v,ready:x,setReady:w,setScrolled:k}),e.createElement(WF,{value:T,setValue:I,type:N,setType:U,transType:z,setTransType:H,onSubmit:function(){var e,t;return A(this,void 0,void 0,(function(){var n,i,o;return D(this,(function(a){switch(a.label){case 0:return(n=T.trim())?"chat"!==N||y||!x?[3,4]:[4,r.freshAiCount()]:[2];case 1:return(i=a.sent())?r.aiCountInPackage+r.aiCountOutPackage<1?(r.aiServerHelper.showToBuyToast(),[2]):(r.minusCurrentAiCount(),[4,r.getFileToken()]):[3,3];case 2:o=a.sent(),null===(t=null===(e=v.current)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({type:"ask",payload:{signInfo:i.extraInfo,aiSignInfo:o,value:n}},"*"),I(""),a.label=3;case 3:return[2];case 4:if(r.isUsingAi)return[2];if(!r.editable)return r.addToast(m("ai.center.toast.notAllow")),[2];switch(N){case"mindmap":return function(e,t,n){var i=Lt(t.view.getViewbox()),r=t.createOperation(),o=[[e.split(""),{color:1710618}]],a=exports.E(exports.E({},AF(t)),{position:i,richContent:{version:t.genOtVersion(0),content:o}}),s=Wi(e.split(""),{lineHeight:a.lineHeight||Ue,fontSize:a.fontSize||14,fontFamily:a.fontFamily},{wordWrapWidth:600}),l=wD.getPadding(a.lineHeight||Ue,!0);a.size={width:s.width+l.left+l.right+4+64,height:s.height+l.top+l.bottom+4};var c=r.create(Za.MINDMAP_NODE,a,{hide:!0}),u=c.getBorderBox(),d=u.right-u.left,p=u.bottom-u.top,h=Jg(exports.E(exports.E({},u),{left:u.left-6*d/2,right:u.left+6*d/2,top:u.top-10*p/2,bottom:u.top+10*p/2}),t,(function(e){return e===c||e.elementType===Za.FRAME})),f=h[1],m=Rt(f),v=f.left,g=f.top+m.height/2;r.update(c,{position:{x:v,y:g}}),Zy(t,{keyword:e,preconditions:[],useChinese:!0},c,{isSelectRoot:!0,beforeMoveBoard:function(){return n(!1)},afterMoveBoard:function(){return n(!0)},onFreshedAiCount:function(e){e?(t.followManager.forcedFollowing||(n(!1),Promise.race([t.makeBorderCenter(f,ty(t)),Dc(1)]).finally((function(){n(!0)}))),LF([c],r,t),c.eleHided=!1,r.update(c,{}),r.sync()):(r.update(c,{deleted:!0}),r.sync(),t.opManager.delete(r))},onFreshAiCountEndAbort:function(){r.update(c,{deleted:!0}),r.sync(),t.opManager.delete(r)}})}(T,r,d),[2];case"todo":return RF(T,r,d,Ct.Todo),[2];case"translate":return RF(T,r,d,Ct.Translate,z),[2];case"simsticker":return function(e,t,n){A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C;return D(this,(function(S){return i=Lt(t.view.getViewbox()),r=t.createOperation(),o=[[e.split(""),{color:1710618}]],a=t.getCurrentStickerStyle(),s=Ke,l=a.scale,c=s.width*l*.5,u=s.height*l*.5,d={x:i.x-c,y:i.y-u},p=exports.E(exports.E({},a),{zIndex:t.newMaxZindex(),size:s,shape:eb.SQUARE,textSize:Ze,position:d,showAuthor:!1,richContent:{version:t.genOtVersion(0),content:o}}),h=r.create(Za.STICKER,p,{hide:!0}),f=h.richTextClient.calcMaxSize(h.richTextClient.chars),m=ib(f,p.lineHeightRate),r.update(h,{fontSize:f,lineHeight:m,autoFontSize:!0}),v=h.getGlobalBox(),g=v.right-v.left,y=v.bottom-v.top,b=exports.E(exports.E({},v),{left:v.left-2.5*g-50,right:v.left+2.5*g+50,top:v.top-1.5*y-10,bottom:v.top+1.5*y+10}),E=Jg(b,t,(function(e){return e===h||e.elementType===Za.FRAME})),x=E[1],w=x.left,C=x.top,r.update(h,{position:{x:w,y:C}}),rb(t,[e],[h],Ct.Sticker,void 0,{isSelectRoot:!0,beforeMoveBoard:function(){return n(!1)},afterMoveBoard:function(){return n(!0)},onFreshedAiCount:function(e){e?(t.followManager.forcedFollowing||(n(!1),Promise.race([t.makeBorderCenter(x,ty(t)),Dc(1)]).finally((function(){n(!0)}))),LF([h],r,t),h.eleHided=!1,r.update(h,{}),r.sync()):(r.update(h,{deleted:!0}),r.sync(),t.opManager.delete(r))},onFreshAiCountEndAbort:function(){r.update(h,{deleted:!0}),r.sync(),t.opManager.delete(r)}}),[2]}))}))}(T,r,d),[2];case"aippt":return ey(T,r),[2];case"document":return $y(T,r),[2]}return[2]}}))}))},loading:"chat"===N?y:!!["mindmap","todo","translate","simsticker","aippt","document"].includes(N)&&r.isUsingAi,setBaseSize:h,container:u.current,hide:a,showInput:"dashboard"!==N||r.userManager.enableAIChat}),e.createElement(VF,{type:N,setType:U})))},UF=function(t){var n,i=t.onClose,r=t.onClear,o=t.upime,a=t.type,s=t.setType,l=t.headRef,c=t.scrolled;al(o,["aiCountInPackage","aiCountOutPackage"]);var u,d=W().getUpimeTrans,p=o.userManager.userAccessHint,h=d("ai.center.restcount.tip",o.aiCountInPackage,o.aiCountOutPackage),f=e.useMemo((function(){return function(){var t="";switch(a){case"dashboard":t=d("ai.center.title.dashboard");break;case"chat":t=d("ai.center.generate.chat");break;case"mindmap":t=d("ai.center.generate.mindmap");break;case"todo":t=d("ai.center.generate.todo");break;case"translate":t=d("ai.center.generate.translate");break;case"simsticker":t=d("ai.center.generate.sticker");break;case"aippt":t=d("ai.center.generate.aippt");break;case"document":t=d("ai.center.generate.doc")}return e.createElement("div",{className:j(wF,"dashboard"===a&&"hideIcon_3z6hm"),style:{cursor:"pointer"},onClick:function(){return s("dashboard")}},e.createElement(hl,{icon:"fanhui",className:"backIcon_2EsRJ"}),e.createElement("b",null,t))}()}),[a]),m=null===(n=o.chatgptConfig)||void 0===n?void 0:n.isShowRemainTip;return e.createElement("div",{className:j("dashboardHead_s3G4o",c&&"chat"===a&&"borderBottom_2iHD0"),ref:l},e.createElement("div",{className:"dashboardFirstRow_3TdZU"},e.createElement("div",{className:j(wF)},f),e.createElement("div",{className:"mlauto_1CSAG"}),"chat"===a&&e.createElement(e.Fragment,null,e.createElement(Dl,{placement:"top",content:d("ai.center.chat.clear.tip"),rootClass:"clearContainer_1scVk"},o.phoneMode&&e.createElement("div",{className:j("hotArea_1VdnJ"),onClick:r}),e.createElement("div",{className:"clearIconContainer_2EA4W",onClick:r},e.createElement(hl,{icon:"qingkong",className:"clearIcon_3gBAN"}))),e.createElement("div",{className:"split_line_15nu0"})),e.createElement("div",{className:"closeContainer_6bfwg",onClick:i},e.createElement(hl,{icon:"guanbi",className:"closeIcon_2ECz8"}))),m&&e.createElement("div",{className:j("dashboardHeadSubRow_1MQgh","dashboard"!==a&&"inSubWindow_1yHt2")},e.createElement("div",{className:j("headTip_2MODA")},(u=Math.max(0,o.aiCountInPackage+o.aiCountOutPackage),e.createElement("span",null,d("ai.center.restcount"),"：",e.createElement("span",{className:j(0===u&&"totalError_1H8eT")},u)," ",d("ai.center.restcount.unit")))),!o.phoneMode&&h&&e.createElement(Dl,{placement:"top",content:h,rootClass:j(CF),large:!0,useClick:_e.isTouchSupported},e.createElement(hl,{icon:"xinxi",className:j(CF,_e.desktop&&"desktop_2mKZ5")})),!o.phoneMode&&p.AiSessionPurchaseLabel&&e.createElement(p.AiSessionPurchaseLabel,null)))},WF=function(t){var n=t.type,i=t.setType,r=t.value,o=t.setValue,a=t.onSubmit,s=t.transType,l=t.setTransType,c=t.loading,u=t.setBaseSize,d=t.container,p=t.hide,h=t.showInput,f=W().getUpimeTrans,m=e.useContext(xl).upime,v=e.useRef(null),g=e.useRef(null),y=e.useRef(null);e.useEffect((function(){var e,t;m.phoneMode||"dashboard"===n||"chat"===n||(null===(e=y.current)||void 0===e||e.focus(),null===(t=v.current)||void 0===t||t.focus())}),[n]),e.useEffect((function(){return m.userEventManager.subscribe("click",(function(){var e,t;null===(e=v.current)||void 0===e||e.blur(),null===(t=y.current)||void 0===t||t.blur()}))}),[]),e.useEffect((function(){var e;p||"chat"!==n||null===(e=v.current)||void 0===e||e.focus()}),[p]);var b=m.phoneMode?40:48,E=m.phoneMode?106:128,x=e.useState(b),w=x[0],C=x[1];return e.useEffect((function(){setTimeout((function(){g.current&&function(e){var t;if(v.current){var i=Math.max(b,Math.min(e,E));if(C(i),d&&"chat"!==n&&"dashboard"!==n){var r=i-b,o=140+("translate"===n?68:0)+((null===(t=m.chatgptConfig)||void 0===t?void 0:t.isShowRemainTip)?30:0)+r;if(d.offsetHeight!==o){var a=d.offsetWidth;u(a,o)}}v.current.style.height="".concat(i,"px")}}(g.current.scrollHeight)}),20)}),[r]),e.createElement(e.Fragment,null,e.createElement(GF,{transType:s,setTransType:function(e){var t,n;l(e),null===(t=v.current)||void 0===t||t.click(),null===(n=v.current)||void 0===n||n.focus()}}),h&&e.createElement("div",{className:j("inputRow_2fmro")},e.createElement("div",{className:"inputContainer2_1kvD1"},e.createElement(e.Fragment,null,e.createElement("textarea",{value:r,onChange:function(e){o(e.target.value)},onFocus:function(){"dashboard"===n&&i("chat")},className:j(TF,w<E&&IF),placeholder:function(){switch(n){case"dashboard":case"chat":return f("ai.center.placeholder.chat");case"mindmap":return f("ai.center.placeholder.mindmap");case"todo":return f("ai.center.placeholder.todo");case"translate":return f("ai.center.placeholder.translate");case"simsticker":return f("ai.center.placeholder.sticker");case"aippt":return f("ai.center.placeholder.aippt");case"document":return f("ai.center.placeholder.doc");default:return}}(),ref:v,onKeyPress:function(e){"Enter"!==e.key||m.phoneMode||e.shiftKey||e.ctrlKey||e.metaKey||(a(),e.preventDefault())}}),e.createElement("textarea",{ref:g,value:r,className:j(TF,w<E&&IF,"supportInput_3RiYu"),onChange:function(){return""}}))),c?e.createElement("div",{className:"loadingGifContainer_2mHAm"},e.createElement("img",{src:$o("ai_gif.gif"),className:"loadingGif_Fa5ux"})):e.createElement("button",{onClick:a,className:j(PF,!r.trim()&&"actionBtDisabled_32TWU")},e.createElement(hl,{icon:"fasong",className:"actionIcon_1gO_4"}))))},VF=function(t){t.type;var n=t.setType,i=W().getUpimeTrans,r=e.useContext(xl).upime,o=KF().dragEvent,a=e.useRef(null),s=e.useState(4),l=s[0],c=s[1],u=[{label:i("ai.center.generate.mindmap"),image:$o("ai_tool_mind.png"),type:"mindmap"},{label:i("ai.center.generate.todo"),image:$o("ai_tool_todo.png"),type:"todo"},{label:i("ai.center.generate.translate"),image:$o("ai_tool_transe.png"),type:"translate"},{label:i("ai.center.generate.sticker"),image:$o("ai_tool_associate.png"),type:"simsticker"}];r.userManager.enableAIGenPPT&&!r.phoneMode&&u.push({label:i("ai.center.generate.aippt"),image:$o("ai_tool_ppt.png"),type:"aippt"}),r.userManager.enableDocument&&!r.phoneMode&&u.push({label:i("ai.center.generate.doc"),image:$o("ai_gen_doc.png"),type:"document"}),e.useEffect((function(){return o.subscribe("resize",(function(){if(a.current){var e=a.current.clientWidth,t=Math.min(Math.floor(e/108),u.length);t!==l&&c(t)}}))}),[a.current,u.length,l]);var d=r.phoneMode?void 0:{gridTemplateColumns:"repeat(".concat(l,", ").concat(108,"px)")};return e.createElement("div",{className:j("aiGridContainer_3dyEB"),ref:a,style:d},u.map((function(t,i){return e.createElement("div",{key:i,className:"cell_caDP7",onClick:function(){return n(t.type)}},e.createElement("img",{className:"cellImage_2pW7E",src:t.image,alt:""}),e.createElement("div",{className:"cellLabel_2IGNf"},t.label))})))},jF=function(t){var n=t.setAsking,i=t.ifrRef,r=t.ready,o=t.setReady,a=t.setScrolled,s=e.useContext(xl).upime,l=KF().dragEvent,c=e.useState(!1),u=c[0],d=c[1],p=zF().setIsShowScaleShow;return e.useEffect((function(){var e=function(e){var t,r=e.data;switch(null==r?void 0:r.type){case"chatgpt_loaded":if(!i.current)return;var l=s.localUserInfo;null===(t=i.current.contentWindow)||void 0===t||t.postMessage({type:"userInfo",payload:{userInfo:{userName:l.userName,userAvatar:l.avatarUrl,userId:l.loginName},curLocale:L}},"*");break;case"chatgpt_ready":o(!0);break;case"chatgpt_startAnswer":n(!0);break;case"chatgpt_endAnswer":n(!1);break;case"chatgpt_scrolled":a(r.payload);break;case"chatgpt_askReload":s.freshAiCount().then((function(e){s.aiCountInPackage+s.aiCountOutPackage<=0?s.aiServerHelper.showToBuyToast():(s.minusCurrentAiCount(),s.getFileToken().then((function(t){var n,o;null===(o=null===(n=i.current)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage({type:"reloadRow",payload:{signInfo:null==e?void 0:e.extraInfo,aiSignInfo:t,index:r.payload}},"*")})))}));break;case"chatgpt_isDeleteRow":s.showWindow(s.phoneMode?sP:YF,{content:O("ai.center.chat.clearone.confirmation"),confirmText:O("ai.center.chat.clearone.bt")},!1,!1).then((function(){var e,t;null===(t=null===(e=i.current)||void 0===e?void 0:e.contentWindow)||void 0===t||t.postMessage({type:"deleteRow",payload:r.payload},"*")})).catch((function(){}));break;case"chatgpt_showToast":var c=r.payload;s.addToast(c);break;case"chatgpt_insetText":if(_c("cv_option_importcanvas"),!s.editable)return void s.addToast(O("ai.center.toast.notAllow.export"));BF(r.payload,s,{toTop:s.phoneMode,select:!0,beforeInsert:function(){return p(!1)},afterInsert:function(){return p(!0)}}),s.addToast(O("ai.center.export.to.board.success"))}},t=function(e){var t=i.current;if(t&&t.contains(document.activeElement)){var n=e.target;t.contains(n)||t.blur()}};window.addEventListener("message",e),document.addEventListener("click",t);var r=[null==l?void 0:l.subscribe("start",(function(){return d(!0)})),null==l?void 0:l.subscribe("end",(function(){return d(!1)}))];return function(){r.forEach((function(e){return null==e?void 0:e()})),window.removeEventListener("message",e),document.removeEventListener("click",t)}}),[]),s.chatgptConfig,e.createElement("div",{className:j("aiChatListContainer_1onuK")},e.createElement("iframe",{className:"iframe_3Z4K2",src:OF(),ref:i,style:{pointerEvents:u?"none":"auto"}}),!r&&e.createElement("div",{className:"loadingWrap_aI2Yk"},e.createElement("div",{className:"balls_3_r1Q"},e.createElement("div",null),e.createElement("div",null),e.createElement("div",null))))},GF=function(t){var n,i=t.transType,r=t.setTransType,o=W().getUpimeTrans,a=e.useState("bottom"),s=a[0],l=a[1],c=e.useContext(Ic).rootContainer,u=e.useState(!1),d=u[0],p=u[1],h=e.useContext(xl).upime,f=yb(o),m=null===(n=f.find((function(e){return e.type===i})))||void 0===n?void 0:n.label,v=e.createElement("div",{className:j("translateSelectorBox_YasZk",d&&"active_2r-OK"),onClick:function(){h.phoneMode&&h.showWindow(Bb,{options:f},void 0,!0,{type:"drawer",config:{showCancel:!0}}).then((function(e){r(e)}))}},e.createElement("div",{className:"translateSelectorText_1y_-R"},m),e.createElement(hl,{icon:"jiantou-xia",className:j("arrowIcon_36nSO")}));return h.phoneMode?e.createElement("div",{className:kF},e.createElement("div",{className:_F},o("ai.common.translate.target"),"："),v):e.createElement("div",{className:kF},e.createElement("div",{className:_F},o("ai.common.translate.target"),"："),e.createElement(Dh,{renderData:{render:qF,data:{translateOptions:f,transType:i,onSelect:r,setIsActive:function(e){return p(e)}}},calcRect:function(e){var t,n=null===(t=c.current)||void 0===t?void 0:t.getBoundingClientRect();return n?(e.top+e.height+300>n.top+n.height?"top"!==s&&l("top"):"bottom"!==s&&l("bottom"),e):e},placement:s},v))},qF=function(t){var n=t.translateOptions,i=t.onSelect,r=t.setIsActive;return e.useEffect((function(){return r(!0),function(){r(!1)}}),[]),e.createElement("div",{className:"childrenOptionContainer_2L_DM",onClick:function(e){return e.stopPropagation()}},n.map((function(t,n){return e.createElement("div",{className:"childRow_2EzXH",key:n,onClick:function(){return i(t.type)}},t.label)})))};function KF(){return e.useContext(zc)||Oc()}var YF=function(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans,a=(null==r?void 0:r.content)||o("comment.message.delete.confirm"),s=(null==r?void 0:r.confirmText)||o("common.delete");return e.createElement("div",{className:"modalBox_30MYB"},e.createElement("div",{className:NF},e.createElement("div",{className:"contentRow_1DQ38"},!(null==r?void 0:r.hideIcon)&&e.createElement(hl,{icon:"qingchu",className:"iconContaienr_1nE6O"}),e.createElement("b",{className:NF},a)),(null==r?void 0:r.tip)&&e.createElement("div",{className:"tipRow_3SATp"},r.tip)),e.createElement("div",{className:"actionsRow_1I17N"},e.createElement("button",{onClick:function(){return n(1)},className:j(PF,"primary_3uqhB")},s),e.createElement("button",{onClick:function(){return i("cancel")},className:j(PF)},o("modal.cancel"))))},XF=[15812389,16434961,9703596,9425231,4279474,8421504,1363412,14286947,6630579,16643140,1025929,2989040],QF={radio:"单选",checkbox:"多选",timeRange:"日期",richText:"多行文本",userList:"用户",fileList:"附件",text:"文本"};function ZF(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=e.useContext(xl).upime,a=e.useReducer((function(e){return e+1}),0)[1],s=e.useState(null),l=s[0],c=s[1],u=e.useState(null),d=u[0],p=u[1];function h(e){if(e!==l){c(e);var t=_t.cloneDeep(e);p(t),b(null),i&&(i.configDefaultColId=null==e?void 0:e.id)}}e.useEffect((function(){var e=null==i?void 0:i.configDefaultColId,t=(null==i?void 0:i.attributes.find((function(t){return t.id===e})))||(null==i?void 0:i.attributes[0]);t&&h(t)}),[i]),e.useEffect((function(){if(i){var e=function(){a()};return i.onAttributesUpdateCBList.push(e),function(){i&&(i.onAttributesUpdateCBList=i.onAttributesUpdateCBList.filter((function(t){return t!==e})))}}}),[i,l]);var f=e.useState(null),m=f[0],v=f[1],g=e.useState(null),y=g[0],b=g[1];e.useEffect((function(){i&&l&&!y&&i.attributes.every((function(e){return e.id!==l.id}))&&h(null)}),[i,null==i?void 0:i.attributes,l,y]),e.useEffect((function(){o.editable||n()}),[o.editable]);var E=e.useState(!1),x=E[0],w=E[1],C=e.useState(0),S=C[0],k=C[1];return e.useEffect((function(){return function(){S&&clearTimeout(S)}}),[]),i?e.createElement("div",{className:GL.kanbanConfigWrapper,onMouseMove:function(e){e.stopPropagation()}},e.createElement("div",{className:GL.kanbanConfigContainer},e.createElement("div",{className:GL.kanbanHead},e.createElement("b",null,r("kanban.config.label")),e.createElement("span",{className:GL.kanbanTitleTip},r("kanban.title.tip")),e.createElement(hl,{icon:"guanbi",className:GL.guanbiButton,size:20,onClick:function(){return n()}})),e.createElement("div",{className:GL.kanbanMainContainer},e.createElement("div",{className:GL.kanbanOptionsList},e.createElement(JF,{kanban:i,activeProp:l,setActiveProp:h,timeRangeExtraInfo:m,setTimeRangeExtraInfo:v,startCreateNewProp:function(){if(i&&!y){var e={id:pN(i.attributes.map((function(e){return e.id}))),label:r("kanban.config.custom.option"),source:"custom",visiable:!0,type:gB.radio,typeExtraInfo:{options:[]}};h(e),b(e)}},creatingProp:y})),d&&l?e.createElement(ez,{key:d.id,option:d,setOption:d===y?b:p,originOption:l,timeRangeExtraInfo:m,saveKanbanConfig:function(e){if(null==i?void 0:i.deleted)return n(),void bF(o);if(i&&e){var t=R([],i.attributes,!0),r=e.id===(null==y?void 0:y.id);if(r)t.push(_t.cloneDeep(e)),b(null);else{var a=t.findIndex((function(e){return e.id===(null==l?void 0:l.id)}));t[a]=_t.cloneDeep(e)}c(_t.cloneDeep(e)),o.kanbanManager.updateKanban(i,{attributes:t}),S&&clearTimeout(S),w(!0),k(window.setTimeout((function(){w(!1)}),1e3)),r&&_c("cv_kanban_setcustomattribute",{type:QF[e.type]})}},isCreate:d.id===(null==y?void 0:y.id),cancelCreate:function(){b(null),h(null)},onDelete:function(){if(i&&d){var e=R([],i.attributes,!0).filter((function(e){return e.id!==d.id}));c(null),o.kanbanManager.updateKanban(i,{attributes:e})}},kanban:i,showSubmitSuccess:x}):e.createElement(rz,null)))):null}function JF(t){var n=t.kanban,i=t.activeProp,r=t.setActiveProp,o=t.timeRangeExtraInfo,a=t.setTimeRangeExtraInfo,s=t.startCreateNewProp,l=t.creatingProp,c=W().getUpimeTrans,u=e.useRef(null),d=n.attributes.filter((function(e){return"defalut"===e.source})),p=n.attributes.filter((function(e){return"custom"===e.source}));return e.createElement("div",{className:GL.kanbanOptionScroll,ref:u},e.createElement("div",{className:GL.kanbanOptionTitle},e.createElement("b",null,c("kanban.config.basic.option"))),d.map((function(t,n){return e.createElement($F,{key:n,option:t,activeProp:i,setActiveProp:r,timeRangeExtraInfo:o,setTimeRangeExtraInfo:a})})),e.createElement("div",{className:GL.kanbanOptionTitle,style:{marginTop:"4px"}},e.createElement("b",null,c("kanban.config.custom.option")),e.createElement(Dl,{content:c("kanban.config.custom.option.add"),placement:"top",zIndex:102},e.createElement("div",{className:j(GL.addBox,p.length>=50&&GL.noAdd),onClick:function(){p.length>=50||(s(),fr((function(){var e;null===(e=u.current)||void 0===e||e.scrollTo(0,u.current.scrollHeight)})))}},e.createElement(hl,{icon:"plus",size:16})))),p.map((function(t,n){return e.createElement($F,{key:n,option:t,activeProp:i,setActiveProp:r,timeRangeExtraInfo:o,setTimeRangeExtraInfo:a})})),l&&e.createElement($F,{key:"custom_new",option:l,activeProp:i,setActiveProp:r,timeRangeExtraInfo:o,setTimeRangeExtraInfo:a}))}function $F(t){var n=t.option,i=t.activeProp,r=t.setActiveProp,o=t.timeRangeExtraInfo,a=t.setTimeRangeExtraInfo;return n.type===gB.timeRange?e.createElement("div",null,e.createElement("div",{onClick:function(){null==r||r(n),null==a||a("timeRangeStart")},className:j(GL.kanbanOptionRow,(null==i?void 0:i.id)===n.id&&"timeRangeStart"===o&&GL.active)},n.typeExtraInfo.timeRangeLabels[0]),e.createElement("div",{onClick:function(){null==r||r(n),null==a||a("timeRangeEnd")},className:j(GL.kanbanOptionRow,(null==i?void 0:i.id)===n.id&&"timeRangeEnd"===o&&GL.active)},n.typeExtraInfo.timeRangeLabels[1])):e.createElement("div",{onClick:function(){return null==r?void 0:r(n)},className:j(GL.kanbanOptionRow,(null==i?void 0:i.id)===n.id&&GL.active)},n.label)}function ez(t){var n,i,r,o=t.option,a=t.setOption,s=t.originOption,l=t.timeRangeExtraInfo,c=t.saveKanbanConfig,u=t.isCreate,d=t.cancelCreate,p=t.kanban,h=t.onDelete,f=t.showSubmitSuccess,m=W().getUpimeTrans,v=e.useRef(null),g=e.useState({}),y=g[0],b=g[1],E=e.useState({}),x=E[0],w=E[1],C=e.useState(!1),S=C[0],k=C[1],_=e.useRef(null);e.useEffect((function(){return function(){_.current&&clearTimeout(_.current)}}),[]);var T=function(){var t=e.useRef(null),n=e.useState(!1),i=n[0],r=n[1];return e.useEffect((function(){if(t.current){var e=null,n=function(){e&&clearTimeout(e),r(!0)},i=function(){e=window.setTimeout((function(){r(!1)}),200)};return t.current.addEventListener("focus",n),t.current.addEventListener("blur",i),function(){var r,o;null===(r=t.current)||void 0===r||r.removeEventListener("focus",n),null===(o=t.current)||void 0===o||o.removeEventListener("blur",i),e&&clearTimeout(e)}}}),[t.current]),{inputRef:t,isFocus:i}}(),I=T.inputRef,P=T.isFocus;e.useEffect((function(){var e;u&&(null===(e=null==I?void 0:I.current)||void 0===e||e.select())}),[u]);var N=yh(!0),M=N.hide,B=N.toggleHide,L=N.skipRef,O=o.type===gB.timeRange?"timeRangeStart"===l?o.typeExtraInfo.timeRangeLabels[0]:o.typeExtraInfo.timeRangeLabels[1]:o.label;return e.createElement("div",{className:GL.kanbanMainContent},e.createElement(KL.Provider,{value:{scrollRef:v}},e.createElement("div",{className:GL.kanbanMainContentScroll,ref:v},e.createElement("div",{className:GL.kanbanMainContentProp},e.createElement("div",{className:GL.propTitle},e.createElement("span",{className:GL.star},"*"),e.createElement("span",null,m("kanban.config.attr.name"))),e.createElement("div",{className:j(GL.inputContainer,P&&GL.focus,(null===(n=x.label)||void 0===n?void 0:n.inError)&&GL.inError,"defalut"===o.source&&GL.inputDisabled)},e.createElement("input",{disabled:"defalut"===o.source,className:GL.input,maxLength:20,type:"text",value:O,onChange:function(e){return a(exports.E(exports.E({},o),{label:e.target.value}))},placeholder:m("common.placeholder.enter"),ref:I}),P&&e.createElement("div",{className:GL.inputControl},e.createElement(hl,{icon:"qingchu",className:GL.clearIcon,size:16,onClick:function(){a(exports.E(exports.E({},o),{label:""}))}}),e.createElement("div",null,O.length,"/20"))),e.createElement("div",{className:GL.inputErrmsg},null===(i=x.label)||void 0===i?void 0:i.errorMsg),e.createElement("div",{className:GL.propTitle},e.createElement("span",{className:GL.star},"*"),e.createElement("span",null,m("kanban.config.attr.type"))),e.createElement("div",{className:j(GL.selectorContainer,"defalut"===o.source&&GL.selectorDisabled),ref:L,onClick:"defalut"===o.source?void 0:B},e.createElement("div",null,function(){switch(o.type){case gB.radio:return m("kanban.config.attr.radio");case gB.checkbox:return m("kanban.config.attr.checkbox");case gB.timeRange:return m("kanban.config.attr.timeRange");case gB.fileList:return m("kanban.config.attr.fileList");case gB.richText:return m("kanban.config.attr.richText");case gB.userList:return m("kanban.config.attr.userList")}}()),"custom"===o.source&&e.createElement("div",{className:j(GL.icon,M&&GL.open)},e.createElement(hl,{icon:"fanhui",size:18})),!M&&e.createElement("div",{className:GL.selectOptionContainer},e.createElement("div",{className:GL.selectOptionRow},e.createElement(hl,{icon:"zhuangtaixianxing",size:16}),e.createElement("div",null,m("kanban.config.attr.radio"))))),o.type===gB.radio&&e.createElement(tz,{optionErrorMap:y,option:o,setOption:a,scrollToBottom:function(){var e;null===(e=v.current)||void 0===e||e.scrollTo(0,v.current.scrollHeight)},showError:null===(r=x.option)||void 0===r?void 0:r.inError})))),e.createElement(iz,{showSaveTip:S,option:o,originOption:s,save:function(){return A(this,void 0,void 0,(function(){var e,t,n,i,r,s,l;return D(this,(function(u){return e=!1,(t=_t.cloneDeep(o)).label.trim()!==t.label&&(e=!0,t.label=t.label.trim()),t.type!==gB.radio&&t.type!==gB.checkbox||t.typeExtraInfo.options.forEach((function(t){t.label.trim()!==t.label&&(e=!0,t.label=t.label.trim())})),e&&a(t),n=!0,i={},t.label?(r=p.attributes.filter((function(e){return e.id!==t.id})).map((function(e){return e.type===gB.timeRange?R(R([],e.typeExtraInfo.timeRangeLabels,!0),[e.label],!1):e.label})).flat(),r.includes(t.label)&&(n=!1,i.label={inError:!0,errorMsg:m("kanban.config.attr.duplicate.name")})):(n=!1,i.label={inError:!0,errorMsg:""}),t.type!==gB.radio&&t.type!==gB.checkbox||(0===t.typeExtraInfo.options.length&&(n=!1,i.option={inError:!0,errorMsg:""}),s={},l=t.typeExtraInfo.options.reduce((function(e,t){return e[t.label]?e[t.label]++:e[t.label]=1,e}),{}),t.typeExtraInfo.options.forEach((function(e){return e.label?l[e.label]>1?(n=!1,void(s[e.id]={inError:!0,errorMsg:m("kanban.config.attr.duplicate.name")})):void 0:(n=!1,void(s[e.id]={inError:!0,errorMsg:""}))})),b(s)),w(i),n?(c(t),_.current&&clearTimeout(_.current),k(!0),_.current=window.setTimeout((function(){k(!1)}),3e3),[2]):[2]}))}))},cancel:d,isCreate:u,onDelete:h,showSubmitSuccess:f}))}function tz(t){var n=t.option,i=t.setOption,r=t.scrollToBottom,o=t.optionErrorMap,a=t.showError;if(n.type!==gB.radio&&n.type!==gB.checkbox)throw new Error("OptionList only support radio and checkbox");function s(e){n.type!==gB.radio&&n.type!==gB.checkbox||i(exports.E(exports.E({},n),{typeExtraInfo:exports.E(exports.E({},n.typeExtraInfo),{options:e})}))}var l=W().getUpimeTrans;function c(){var e,t;if(n.type===gB.radio||n.type===gB.checkbox){var i=n.typeExtraInfo.options;if(!(i.length>=50)){var o=null===(e=i[i.length-1])||void 0===e?void 0:e.color,a=XF.indexOf(o),l=XF[a+1]||XF[0],c={id:pN(i.map((function(e){return e.id}))),label:"",icon:(null===(t=i[0])||void 0===t?void 0:t.icon)||null,color:l,editable:!0,source:"custom"};s(R(R([],i,!0),[c],!1)),fr((function(){r();var e=document.getElementsByClassName("kanban_config_input"),t=e[e.length-1];null==t||t.focus()}))}}}var u=n.typeExtraInfo.options;return e.createElement(e.Fragment,null,e.createElement("div",{className:j(GL.propTitle,GL.titleOptionContainer,a&&GL.inError)},e.createElement("span",{className:GL.star},"*"),e.createElement("span",null,l("kanban.config.attr.option")),e.createElement("div",{className:j(GL.addOptionContainer),onClick:c},e.createElement(hl,{icon:"plus",size:18}),e.createElement("div",null,l("kanban.config.attr.option.create")))),a&&e.createElement("div",{className:GL.propError},l("kanban.empty.group")),u.length>0&&e.createElement("div",{className:GL.optionListContainer},u.map((function(t,i){var r=t.editable,a=o[t.id];return e.createElement("div",{key:i,className:GL.opRow},e.createElement("div",{className:j(GL.opRowInner,!r&&GL.disabled,(null==a?void 0:a.inError)&&GL.inError,(null==a?void 0:a.errorMsg)&&GL.hasErrmsg)},e.createElement(nz,{editable:r,color:t.color,setColor:function(e){t.color=e,s(R([],u,!0))}}),e.createElement("input",{disabled:!r,type:"text",className:j(GL.opInputContainer,!r&&GL.opInputContainerDisabled,"kanban_config_input"),value:t.label,onChange:function(e){t.label=e.target.value,s(R([],u,!0))},placeholder:l("common.placeholder.enter"),onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),c())}}),e.createElement("div",{onClick:function(){return r&&function(e){n.type!==gB.radio&&n.type!==gB.checkbox||s(n.typeExtraInfo.options.filter((function(t,n){return n!==e})))}(i)},className:j(GL.closeIcon,!r&&GL.closeDisabled)},e.createElement(hl,{icon:"guanbi",size:16}))),(null==a?void 0:a.errorMsg)&&e.createElement("div",{className:GL.errmsgContainer},a.errorMsg))}))))}function nz(n){var i=n.editable,r=n.color,o=n.setColor,a=e.useContext(Ic),s=a.popContainer,l=a.rootContainer,c=e.useContext(xl).upime,u=e.useRef(null),d=e.useContext(KL).scrollRef,p=yh(!0,{checkSkip:function(e){return!!u.current&&V(u.current,e)}}),h=p.hide,f=p.setHide,m=p.toggleHide,v=p.skipRef,g=e.useState({x:0,y:0}),y=g[0],b=g[1];function E(){var e,t,n=null===(e=v.current)||void 0===e?void 0:e.getBoundingClientRect(),i=null===(t=l.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i){var r=i.bottom-n.bottom,o=Math.max(0,150-r),a=n.left,s=n.bottom-o;y.x===a&&y.y===s||b({x:n.left,y:n.bottom-o})}}e.useEffect((function(){return c.subscribe("boardResized",E)}),[]),e.useEffect((function(){if((null==d?void 0:d.current)&&!h){var e=function(){f(!0)};return d.current.addEventListener("scroll",e),function(){var t;null===(t=d.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[null==d?void 0:d.current,h]);var x=pr(r)+"90";return e.createElement("div",{ref:v},e.createElement("div",{className:GL.colorSelector,style:{background:x},onClick:function(){i&&(E(),m())}},e.createElement(hl,{icon:"down",size:8,style:{color:i?"#0C1024":"rgba(12, 16, 36, 0.15)"}})),!h&&t.createPortal(e.createElement("div",{ref:u,className:GL.colorPaletteContainer,style:{left:"".concat(y.x,"px"),top:"".concat(y.y+1,"px")}},e.createElement(Yb,{colorPalettes:XF,defaultValue:r,onChanged:function(e){return e&&o(e)},colorItemClassName:GL.colorItem})),s.current))}function iz(t){var n=t.showSaveTip,i=t.option,r=t.originOption,o=t.save,a=t.cancel,s=t.isCreate,l=t.onDelete,c=t.showSubmitSuccess,u=W().getUpimeTrans,d=e.useContext(xl).upime,p=s||!function(e,t){return oz(e)===oz(t)}(i,r);return e.createElement("div",{className:GL.actionsList},e.createElement("div",{className:j(GL.attrSaveBt,!p&&!c&&GL.disabled),onClick:function(){p&&o()}},c?e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",size:20}):u("kanban.config.attr.save")),n&&e.createElement("div",{className:GL.actionTipContainer},e.createElement(hl,{icon:"xinxi",size:16}),e.createElement("div",{className:GL.content},u("kanban.config.attr.save.ok"))),s&&e.createElement("div",{className:j(GL.attrCancelBt),onClick:function(){null==a||a()}},u("modal.cancel")),"custom"===i.source&&!s&&e.createElement("div",{onClick:function(){d.showWindow(YF,{content:u("kanban.config.attr.delete.confirm",i.label),tip:u("kanban.config.attr.delete.tip"),hideIcon:!0},!1,!1).then((function(){l()})).catch((function(){}))},className:GL.deleteContent},u("kanban.config.attr.delete")))}function rz(){var t=W().getUpimeTrans;return e.createElement("div",{className:GL.emptyContainer},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,t("kanban.config.attr.empty")))}function oz(e){return JSON.stringify(e)}var az=function(){function e(e){this.kanban=e,this.x=0,this.y=92,this.width=40,this.height=40,this.name="addCol",this.disabled=!1,this.on=!1}return e.prototype.getX=function(){return 16+272*this.kanban.grids.length+8*this.kanban.grids.length},e.prototype.render=function(){var e=this,t=this.getX();Na((function(n){n.beginFill(16119542),n.drawRoundedRect(t,e.y,e.width,e.height,4);var i=12.5;n.lineStyle({cap:"round",color:9540508,width:2}),n.moveTo(t+i,e.y+20),n.lineTo(t+i+15,e.y+20),n.moveTo(t+20,e.y+i),n.lineTo(t+20,e.y+i+15),n.lineStyle()}))},e.prototype.checkRelation=function(e,t){if(!this.kanban.upime.editable)return null;if(this.kanban.onlyCheckKanban)return null;var n=this.kanban.groupByAttr;return((null==n?void 0:n.type)===gB.radio||(null==n?void 0:n.type)===gB.checkbox)&&n.typeExtraInfo.options.length>=50?null:Ot(e,this.getBorderBox())?{name:this.name}:null},e.prototype.getBorderBox=function(){var e=this.getX();return{left:e*this.kanban.scale,top:this.y*this.kanban.scale,right:(e+this.width)*this.kanban.scale,bottom:(this.y+this.height)*this.kanban.scale}},e.prototype.dealClick=function(){if(this.kanban.upime.phoneMode)this.kanban.upime.addToast(O("kanban.usepc.attr"));else if(!(this.kanban.activeDomWidget&&this.kanban.activeDomWidget instanceof sz)){var e=new sz(this.kanban,this);this.kanban.addActiveDomWidget(e)}},e.prototype.dealHoverStart=function(){this.kanban.showWidgetTip(this.kanban.id,O("kanban.attr.create"),this.getHoverPoint())},e.prototype.dealHoverEnd=function(){},e.prototype.getHoverPoint=function(){return{x:(this.getX()+this.width/2)*this.kanban.scale,y:this.y*this.kanban.scale}},e}(),sz=function(){function e(e,t){this.element=e,this.addColWidget=t,this.renderer=lz,this.renderKey="kanban-add-new-col-".concat(e.id)}return e.prototype.remove=function(){this.element.removeActiveDomWidget()},e}();function lz(t){var n=t.element,i=t.upime,r=e.useRef(null);e.useEffect((function(){return gh((function(){n.remove()}),{skipElements:r.current?[r.current]:void 0})}),[]);var o=function(){var e=n.addColWidget.getBorderBox(),t=n.element.position,r=t.x+e.left,o=t.y+e.bottom;return i.view.getScreenPosition({x:r,y:o})}(),a=n.element.groupByAttr,s=(null==a?void 0:a.type)===gB.userList?uz:cz;return e.createElement("div",{ref:r,className:"addNewColWrapper_FtFRf",style:{left:"".concat(o.x,"px"),top:"".concat(o.y+4,"px")}},e.createElement(s,{kanban:n.element,onRemove:function(){return n.remove()}}))}function cz(t){var n=t.kanban,i=t.onRemove,r=t.afterCreate,o=t.toIndex,a=W().getUpimeTrans,s=e.useState(""),l=s[0],c=s[1],u=e.useState((function(){var e=n.groupByAttr;if((null==e?void 0:e.type)===gB.radio||(null==e?void 0:e.type)===gB.checkbox){var t=e.typeExtraInfo.options[e.typeExtraInfo.options.length-1],i=XF.findIndex((function(e){return e===t.color})),r=XF[i+1];if(r)return r}return XF[0]})),d=u[0],p=u[1],h=e.useRef(null);e.useEffect((function(){var e;null===(e=h.current)||void 0===e||e.focus()}),[]);var f=e.useState(),m=f[0],v=f[1];function g(){var e,t=l.trim();t!==l&&c(t);var s=n.groupByAttr;if((null==s?void 0:s.type)===gB.radio||(null==s?void 0:s.type)===gB.checkbox){var u=s.typeExtraInfo.options.map((function(e){return e.label}));if(!t||u.includes(t))return void v({inError:!0,errorMsg:a(t?"kanban.attr.create.error":"kanban.enter.gourp.name")});var p={id:pN(s.typeExtraInfo.options.map((function(e){return e.id}))),label:t,icon:(null===(e=s.typeExtraInfo.options[0])||void 0===e?void 0:e.icon)||null,color:d,editable:!0,source:"custom"},h=void 0===o?s.typeExtraInfo.options.length:o,f=R([],s.typeExtraInfo.options,!0);f.splice(h,0,p);var m=n.attributes.map((function(e){return e.id!==s.id?e:exports.E(exports.E({},e),{typeExtraInfo:exports.E(exports.E({},e.typeExtraInfo),{options:f})})}));n.upime.kanbanManager.updateKanban(n,{attributes:m}),null==i||i(),null==r||r()}}return e.createElement("div",{className:vO},e.createElement("div",null,a("kanban.attr.create")),e.createElement("div",{className:gO},e.createElement("input",{placeholder:a("common.placeholder.enter"),className:j(yO,m&&m.inError&&bO),type:"text",value:l,onChange:function(e){return c(e.target.value)},ref:h,onKeyPress:function(e){"Enter"===e.key&&g()}}),l&&e.createElement(hl,{icon:"qingchu",className:EO,size:16,onClick:function(){return c("")}})),e.createElement("div",{className:PO},null==m?void 0:m.errorMsg),e.createElement("div",null,a("kanban.attr.select.color")),e.createElement(Yb,{className:NO,colorItemClassName:MO,colorPalettes:XF,defaultValue:d,onChanged:function(e){return e&&p(e)}}),e.createElement("div",{className:AO},e.createElement("div",{onClick:function(){return null==i?void 0:i()},className:DO},a("common.cancel")),e.createElement("div",{onClick:g,className:RO},a("kanban.attr.create.action"))))}function uz(t){var n=t.kanban,i=t.onRemove,r=t.afterCreate,o=t.toIndex,a=W().getUpimeTrans,s=e.useContext(xl).upime,l=yh(!0),c=l.hide,u=l.toggleHide,d=l.skipRef,p=e.useState([]),h=p[0],f=p[1],m=e.useState(),v=m[0],g=m[1];return e.createElement("div",{className:vO},e.createElement("div",null,a("kanban.attr.create")),e.createElement("div",{className:xO,ref:d},e.createElement("div",{className:j(wO,!c&&CO,(null==v?void 0:v.inError)&&bO),onClick:u},e.createElement("div",{className:SO},0===h.length&&e.createElement("span",{className:_O},a("common.please.select")),e.createElement(oL,{tiny:!0,users:h,onChange:f})),e.createElement(hl,{icon:"jiantou-xia",className:kO,size:16})),!c&&e.createElement("div",{className:TO},e.createElement(nL,{users:h,onChange:f,showUsers:!1,showSend:!1})),(null==v?void 0:v.inError)&&v.errorMsg&&e.createElement("div",{className:IO},v.errorMsg)),e.createElement("div",{className:AO},e.createElement("div",{onClick:function(){return null==i?void 0:i()},className:DO},a("common.cancel")),e.createElement("div",{onClick:function(){var e=n.groupByAttr;if((null==e?void 0:e.type)===gB.userList)if(0!==h.length){var t=n.getDisplayUsers(),l=h.filter((function(e){return t.includes(e)}));if(l.length>0){var c=l.map((function(e){var t;return null===(t=s.userManager.getUser(e))||void 0===t?void 0:t.userName})),u=a("kanban.attr.group.duplicate.tip",c.map((function(e){return"【".concat(e,"】")})).join(""));g({inError:!0,errorMsg:u})}else{var d=void 0===o?t.length:o,p=R([],t,!0);p.splice.apply(p,R([d,0],h,!1));var f=n.attributes.map((function(t){return t.id!==e.id?t:exports.E(exports.E({},t),{typeExtraInfo:exports.E(exports.E({},t.typeExtraInfo),{displayUsers:p})})}));n.upime.kanbanManager.updateKanban(n,{attributes:f}),null==i||i(),null==r||r()}}else g({inError:!0,errorMsg:""})},className:RO},a("kanban.attr.create.action"))))}var dz=_D("gengduo"),pz=function(){function e(e,t){this.kanban=e,this.col=t,this.x=0,this.y=108,this.width=24,this.height=24,this.disabled=!1,this.on=!1,this.hoving=!1,this.active=!1,this.name="kanban_col_action_".concat(t.id)}return e.prototype.getX=function(){var e=this;return 16+280*this.kanban.grids.findIndex((function(t){return t.id===e.col.id}))+272-16-24},e.prototype.render=function(){var e=this.getX(),t=this.y;(this.hoving||this.active)&&Na((function(n){n.beginFill(15527150),n.drawRoundedRect(e,t,24,24,4)})),this.hoving&&!this.active||fa({alpha:.65}),Oa({src:dz,x:e+4,y:t+4,width:16,height:16}),this.hoving&&!this.active||ma()},e.prototype.checkRelation=function(e,t){return this.kanban.upime.editable?this.kanban.onlyCheckKanban?null:Ot(e,this.getBorderBox())?{name:this.name}:null:null},e.prototype.getBorderBox=function(){var e=this.y,t=this.getX();return{left:t*this.kanban.scale,top:e*this.kanban.scale,right:(t+this.width)*this.kanban.scale,bottom:(e+this.height)*this.kanban.scale}},e.prototype.dealClick=function(){if(!(this.kanban.activeDomWidget&&this.kanban.activeDomWidget instanceof hz)){this.widget&&this.kanban.removeActiveDomWidget();var e=new hz(this.kanban,this.col,this);this.widget=e,this.kanban.addActiveDomWidget(e)}},e.prototype.dealHoverStart=function(){this.hoving=!0},e.prototype.dealHoverEnd=function(){this.hoving=!1},e.prototype.getHoverPoint=function(){return{x:0,y:0}},e.prototype.destory=function(){this.widget&&(this.kanban.removeActiveDomWidget(),this.widget=void 0)},e}(),hz=function(){function e(e,t,n){this.element=e,this.col=t,this.widget=n,this.renderer=fz,this.renderKey="kanban-col-action-list-".concat(e.id,"-").concat(t.id)}return e.prototype.remove=function(){this.element.removeActiveDomWidget(),this.widget.widget=void 0},e}();function fz(t){var n=t.element,i=t.upime,r=e.useRef(null),o=W().getUpimeTrans;e.useEffect((function(){return n.widget.active=!0,function(){n.widget.active=!1,i.updateView()}}),[]),e.useEffect((function(){return gh((function(){n.remove()}),{skipElements:r.current?[r.current]:void 0})}),[]);var a=e.useState(null),s=a[0],l=a[1],c=function(e){var t=n.element.groupByAttr;((null==t?void 0:t.type)===gB.radio||(null==t?void 0:t.type)===gB.checkbox)&&t.typeExtraInfo.options.length>=50||l(e)},u=function(){var e=n.widget.getBorderBox(),t=n.element.position,r=t.x+e.left,o=t.y+e.bottom;return i.view.getScreenPosition({x:r,y:o})}(),d=void 0,p=n.element.groupByAttr;if((null==p?void 0:p.type)===gB.radio||(null==p?void 0:p.type)===gB.checkbox){var h=p.typeExtraInfo.options.findIndex((function(e){return e.id===n.col.id}));-1!==h&&(d=h)}(null==p?void 0:p.type)===gB.userList&&(d=n.element.getDisplayUsers().indexOf(n.col.id));var f=(null==p?void 0:p.type)===gB.userList?uz:cz,m=1;(null==p?void 0:p.type)!==gB.radio&&(null==p?void 0:p.type)!==gB.checkbox||(m=null==p?void 0:p.typeExtraInfo.options.length);var v=(null==p?void 0:p.type)===gB.userList||m>1;return e.createElement("div",{ref:r,className:"colActionList_2MjLy",style:{left:"".concat(u.x,"px"),top:"".concat(u.y+4,"px")}},(null==p?void 0:p.type)!==gB.userList&&e.createElement("div",{className:fO,onClick:function(){var e=n.element.groupNameWidgetList.find((function(e){return e.col.id===n.col.id}));e&&(e.textProxy.startEdit(),e.textProxy.editor.moveCursorToEnd(),e.kanban.updateGridUIInfo()),n.remove()}},o("element.rename")),e.createElement("div",{className:j(fO,"left"===s&&BO),onClick:function(){return c("left")}},o("kanban.attr.create.group.left")),e.createElement("div",{className:j(fO,"right"===s&&BO),onClick:function(){return c("right")}},o("kanban.attr.create.group.right")),n.col.editable&&e.createElement("div",{onClick:function(){return v&&function(){var e,t=null===(e=n.element.groupByAttr)||void 0===e?void 0:e.id,r=n.col.id;i.showWindow(YF,{content:o("kanban.config.group.delete.confirm",n.col.label),tip:o("kanban.config.group.delete.tip"),hideIcon:!0},!1,!1).then((function(){var e=n.element.groupByAttr;if((null==e?void 0:e.type)===gB.checkbox||(null==e?void 0:e.type)===gB.radio){var o=R([],n.element.attributes,!0).map((function(e){return e.id!==t?e:exports.E(exports.E({},e),{typeExtraInfo:exports.E(exports.E({},e.typeExtraInfo),{options:e.typeExtraInfo.options.filter((function(e){return e.id!==r}))})})}));i.kanbanManager.updateKanban(n.element,{attributes:o})}(null==e?void 0:e.type)===gB.userList&&(n.col.cards.forEach((function(e){var o=e.values.map((function(e){return e.type===gB.userList&&e.attribute===t?exports.E(exports.E({},e),{value:e.value.filter((function(e){return e!==r}))}):e})),a=n.element.cards.findIndex((function(t){return t===e.id}));i.kanbanManager.updateCard(e.id,{values:o},{index:a,kanbanId:n.element.id})})),o=R([],n.element.attributes,!0).map((function(e){return e.id===t&&e.type===gB.userList?exports.E(exports.E({},e),{typeExtraInfo:{displayUsers:e.typeExtraInfo.displayUsers.filter((function(e){return e!==r}))}}):e})),i.kanbanManager.updateKanban(n.element,{attributes:o}))})).catch((function(){}))}()},className:j(fO,!v&&"rowDisabled_2aliQ")},o("kanban.attr.delete.group")),s&&e.createElement("div",{className:"addGroupWrapper_BwG6p"},e.createElement(f,{kanban:n.element,onRemove:function(){return c(null)},afterCreate:function(){return n.remove()},toIndex:void 0!==d?"left"===s?d:d+1:void 0})))}var mz=function(){function e(e,t){this.upime=e,this.proxy=t,this.editing=!1,this.standby=!1,this._selectionStart=1,this._selectionEnd=1,this.showCursor=!0,this.selecting=!1}return Object.defineProperty(e.prototype,"selectionStart",{get:function(){return Math.min(this._selectionStart,this._selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return Math.max(this._selectionStart,this._selectionEnd)},enumerable:!1,configurable:!0}),e.prototype.setSelectionStart=function(e){this._selectionStart=e,this.updateSelectArea(),this.updateScroll(e)},e.prototype.setSelectionEnd=function(e){this._selectionEnd=e,this.updateSelectArea(),this.updateScroll(e)},e.prototype.setSelection=function(e,t){this._selectionStart=e,this._selectionEnd=t,this.updateSelectArea(),this.updateScroll(t)},Object.defineProperty(e.prototype,"cursorIndex",{get:function(){return this._selectionEnd},enumerable:!1,configurable:!0}),e.prototype.startEdit=function(e){if(this.standby=!1,!this.editing){var t=this.upime.view.setConnectedSimpleEditor(this);_e.desktop||(this.optimizeView(),null==t||t.focus()),this.editing=!0}if(null==e?void 0:e.position){this.proxy.calcRenderData();var n=this.getTextIndexByPosition(e.position);this.setSelection(n,n)}else this.setSelection(1,1)},e.prototype.stopEdit=function(){this.editing=!1,this.standby=!1,this.setSelection(1,1),this.endBlinkCursor(),this.upime.view.clearConnectedSimpleEditor(this)},e.prototype.optimizeView=function(){var e=this.proxy.renderData;if(e){var t=this.proxy.getPosition().y,n=this.upime.view.getViewbox(),i=n.bottom,r=n.top,o=n.left,a=i-r,s=t+e.height/2;if(this.upime.phoneMode)if(_e.isIphoneLike)t<r+a/2&&this.upime.slideViewTo(o,s-a/1.8,this.upime.view.scale,0);else if(t>r+a/2){var l=t-(r+a/4);this.upime.slideViewTo(o,r+l,this.upime.view.scale,100)}}},e.prototype.checkFocusing=function(){this.editing&&this.textareaDom&&this.textareaDom!==document.activeElement&&this.textareaDom.focus()},e.prototype.bindDom=function(e){var t=this;_e.desktop&&e.focus(),this.textareaDom=e;var n=function(e){(t.editing||t.standby)&&t.filterInput(e)},i=function(e){t.filterKeydown(e)},r=0,o=0,a=function(){var e,n;(t.editing||t.standby)&&(t.standby&&(t.startEdit(),t.proxy.doDelete(1,t.getAllLegalCursorCount()),t.setSelection(1,1),null===(n=(e=t.proxy).onStandbyToEditing)||void 0===n||n.call(e)),t.selectionStart!==t.selectionEnd&&t.deleteSelected(),o=t.getCharIndexByCursorIndex(t.selectionStart))},s=function(e){if(t.editing||t.standby){var n=t.getCharIndexByCursorIndex(t.selectionStart);if(r){t.proxy.doDelete(n-r,n);var i=t.getCursorIndexByCharIndex(o);t.setSelection(i,i)}var a=e.data;if(a){t.proxy.doAdd(a,o);var s=yi(a),l=t.getCursorIndexByCharIndex(o+s.length);r=s.length,t.setSelection(l,l)}else r=0}},l=function(e){s(e),r=0,o=0},c=function(e){if(t.standby)e.preventDefault();else{t.selectionStart!==t.selectionEnd&&t.deleteSelected();var n=t.upime.readClipboardDataFromClipboardEvent(e),i=null==n?void 0:n.plainData;if(i){i=i.replace(/\r\n/g,"\n");var r=t.getCharIndexByCursorIndex(t.selectionStart);t.proxy.doAdd(i,r);var o=t.getCursorIndexByCharIndex(r+i.length);t.setSelection(o,o)}}},u=function(e){var n;if(e.preventDefault(),e.stopPropagation(),t.standby){t.upime.userEventManager.publish("copy",void 0);var i=t.textareaDom;i&&(i.selectionStart=t.selectionStart-1,i.selectionEnd=t.selectionEnd-1)}else if(t.selectionStart!==t.selectionEnd){var r=t.getCharIndexByCursorIndex(t.selectionStart),o=t.getCharIndexByCursorIndex(t.selectionEnd),a=Ei(yi(t.proxy.temContent),r,o);null===(n=e.clipboardData)||void 0===n||n.setData("text/plain",a)}},d=function(e){var n,i;if(!t.standby&&t.selectionStart!==t.selectionEnd){e.preventDefault(),e.stopPropagation();var r=t.getCharIndexByCursorIndex(t.selectionStart),o=t.getCharIndexByCursorIndex(t.selectionEnd),a=Ei(yi(t.proxy.temContent),r,o);null===(n=e.clipboardData)||void 0===n||n.clearData(),null===(i=e.clipboardData)||void 0===i||i.setData("text/plain",a),t.deleteSelected()}},p=function(){t.proxy.stopEdit()};return e.addEventListener("compositionstart",a),e.addEventListener("compositionupdate",s),e.addEventListener("compositionend",l),e.addEventListener("beforeinput",n),e.addEventListener("keydown",i),e.addEventListener("paste",c),e.addEventListener("cut",d),e.addEventListener("copy",u),e.addEventListener("blur",p),function(){t.textareaDom=void 0,e.removeEventListener("compositionstart",a),e.removeEventListener("compositionupdate",s),e.removeEventListener("compositionend",l),e.removeEventListener("beforeinput",n),e.removeEventListener("keydown",i),e.removeEventListener("paste",c),e.removeEventListener("cut",d),e.removeEventListener("copy",u),e.removeEventListener("blur",p)}},e.prototype.updateSelectArea=function(){var e,t,n=this;if(this.editing){this.checkFocusing(),this.selectionCursor=void 0,this.selectionArea=void 0,this.endBlinkCursor();var i=this.selectionStart,r=this.selectionEnd;if(i===r)this.selectionCursor=this.getPositionByIndex(i),this.cursorPosition=exports.E({},this.selectionCursor),this.startBlinkCursor();else{var o=[],a=this.getPositionByIndex(i),s=this.getPositionByIndex(r),l=this.getLineIndexByIndex(i),c=this.getLineIndexByIndex(r),u=null===(e=this.proxy.renderData)||void 0===e?void 0:e.lineBreaks,d=null===(t=this.proxy.renderData)||void 0===t?void 0:t.originalLines;if(!u||!d)return;var p=1,h=0;d.forEach((function(e,t){var u=e;if(t<l)return e?p+=u.length+1:p++,void(h+=n.proxy.option.lineHeight);if(t!==l||t!==c){if(t===l)return d=ji(Ei(u,i-p,u.length),n.proxy.option.style),o.push({x:a.x,y:a.y,width:d}),void(h+=n.proxy.option.lineHeight);if(t!==c){if(t>l&&t<c)return d=ji(e.join(""),n.proxy.option.style),o.push({x:0,y:h,width:d}),void(h+=n.proxy.option.lineHeight)}else 0!==s.x&&o.push({x:0,y:s.y,width:s.x})}else{var d=ji(Ei(u,i-p,r-p),n.proxy.option.style);o.push({x:a.x,y:a.y,width:d})}})),this.selectionArea=o,this.cursorPosition=exports.E({},s)}this.upime.updateView()}},e.prototype.updateScroll=function(e){if(this.proxy.option.inline&&this.proxy.renderData){var t=this.getPositionByIndex(e),n=this.proxy.renderData.width,i=this.proxy.scrollX;t.x-this.proxy.scrollX>n?i=t.x-n:t.x-this.proxy.scrollX<0&&(i=t.x),this.proxy.scrollX=i}},e.prototype.startBlinkCursor=function(){var e=this;this.endBlinkCursor(),this.showCursor=!0,this.blinkTimer=window.setInterval((function(){e.showCursor=!e.showCursor,e.upime.updateView()}),500)},e.prototype.endBlinkCursor=function(){window.clearInterval(this.blinkTimer)},e.prototype.getPositionByIndex=function(e){var t=this.proxy.renderData;if(!t)return{x:0,y:0};for(var n=0,i=1,r=0;r<t.lines.length;r++){var o=t.lines[r];if(o){if(e>=i&&e<i+o.length+1)return{x:ji(o.slice(0,e-i).join(""),this.proxy.option.style),y:n};i+=o.length+1}else{if(e===i)return{x:0,y:n};i+=1}r!==t.lines.length-1&&(n+=this.proxy.option.lineHeight)}return{x:ji(t.lines[t.lines.length-1].join(""),this.proxy.option.style),y:n}},e.prototype.getLineIndexByIndex=function(e){var t=this.proxy.renderData;if(!t)return 0;for(var n=1,i=0;i<t.lines.length;i++){var r=t.lines[i];if(r){if(e>=n&&e<n+r.length+1)return i}else if(e===n)return i;n+=r.length+1}return 0},e.prototype.getTextIndexByPosition=function(e){var t;if(!this.proxy.renderData)return 1;var n=Math.floor(e.y/this.proxy.option.lineHeight);n=Math.max(0,n),n=Math.min(this.proxy.renderData.lines.length-1,n);var i=e.x+this.proxy.scrollX,r=null===(t=this.proxy.renderData)||void 0===t?void 0:t.originalLines[n],o=this.proxy.renderData.originalLines.slice(0,n).reduce((function(e,t){return e+t.length+1}),0),a=r;if(0===a.length)return o+1;var s=ut(this.proxy.option.style);st.font=s;for(var l,c=0,u=1;u<=a.length;u++){var d=(l=u,st.measureText(Ei(a,0,l)).width);if(d>=i)return d-i>i-c?o+u:o+u+1;c=d}return o+a.length+1},e.prototype.getCharIndexByCursorIndex=function(e){var t,n,i=0,r=0,o=null===(t=this.proxy.renderData)||void 0===t?void 0:t.originalLines,a=null===(n=this.proxy.renderData)||void 0===n?void 0:n.lineBreaks;if(!o||!a)return 1;for(var s=0;s<o.length;s++){var l=o[s],c=l;if(l){if(i===e)return r;if(i+c.length+1>=e)return r+e-i-1;i+=c.length+1,r+=c.length,a[s]&&r++}else{if(i+1===e)return r;i+=1,a[s]&&r++}}return r},e.prototype.getCursorIndexByCharIndex=function(e){var t,n;if(0===e)return 1;var i=0,r=0,o=null===(t=this.proxy.renderData)||void 0===t?void 0:t.originalLines,a=null===(n=this.proxy.renderData)||void 0===n?void 0:n.lineBreaks;if(!o||!a)return 1;for(var s=0;s<o.length;s++){var l=o[s],c=l;if(l){if(i===e)return r;var u=a[s]?1:0;if(i+c.length+u>=e)return r+e-i+1;r+=c.length+1,i+=c.length,a[s]&&i++}else{if(i+1===e)return r++,a[s]&&r++,r;r+=1,a[s]&&i++}}return r},e.prototype.startSelect=function(e){this.selecting=!0;var t=this.getTextIndexByPosition(e);this.setSelection(t,t)},e.prototype.onSelect=function(e){if(this.selecting){var t=this.getTextIndexByPosition(e);this.setSelectionEnd(t)}},e.prototype.selectEnd=function(e){this.selecting=!1;var t=this.getTextIndexByPosition(e);this.setSelectionEnd(t)},e.prototype.filterInput=function(e){var t,n,i=this.selectionStart!==this.selectionEnd;switch(e.inputType){case"deleteContentBackward":if(i)this.deleteSelected();else{if(1===this.selectionStart)return;var r=this.getCharIndexByCursorIndex(this.selectionStart);this.proxy.doDelete(r-1,r);var o=this.getCursorIndexByCharIndex(r-1);this.setSelection(o,o)}break;case"deleteContentForward":if(i)this.deleteSelected();else{if(this.selectionStart===this.getAllLegalCursorCount())return;var a=this.getCharIndexByCursorIndex(this.selectionStart);this.proxy.doDelete(a,a+1)}break;case"insertLineBreak":if(this.proxy.option.inline)return;i&&this.deleteSelected();var s=this.getCharIndexByCursorIndex(this.selectionStart);this.proxy.doAdd("\n",s);var l=this.selectionStart+1;this.setSelection(l,l);break;case"insertText":var c=e.data;if(this.standby){this.startEdit(),this.proxy.doDelete(1,this.getAllLegalCursorCount()),this.setSelection(1,1),null===(n=(t=this.proxy).onStandbyToEditing)||void 0===n||n.call(t);var u=1;this.proxy.doAdd(c,u),o=this.getCursorIndexByCharIndex(u+c.length),this.setSelection(o,o)}else i&&this.deleteSelected(),u=this.getCharIndexByCursorIndex(this.selectionStart),this.proxy.doAdd(c,u),o=this.getCursorIndexByCharIndex(u+c.length),this.setSelection(o,o)}return!0},e.prototype.filterKeydown=function(e){if(!e.isComposing&&!this.standby){var t=e.key;e.shiftKey;var n=e.ctrlKey,i=e.metaKey;if("ArrowLeft"===t){e.preventDefault();var r=Math.max(this.selectionStart-1,1);this.setSelection(r,r)}if("ArrowRight"===t){e.preventDefault();var o=this.getAllLegalCursorCount();r=Math.min(this.selectionEnd+1,o),this.setSelection(r,r)}if("ArrowUp"===t){if(e.preventDefault(),0===this.getLineIndexByIndex(this.selectionStart))return;var a={x:(s=this.getPositionByIndex(this.selectionStart)).x,y:s.y-this.proxy.option.lineHeight};r=this.getTextIndexByPosition(a),this.setSelection(r,r)}if("ArrowDown"===t){e.preventDefault();var s,l=this.proxy.renderData;if(!l)return;if(this.getLineIndexByIndex(this.selectionStart)===l.lines.length-1)return;a={x:(s=this.getPositionByIndex(this.selectionStart)).x,y:s.y+this.proxy.option.lineHeight},r=this.getTextIndexByPosition(a),this.setSelection(r,r)}"a"===t.toLocaleLowerCase()&&(n||i)&&(e.preventDefault(),this.setSelection(1,this.getAllLegalCursorCount()))}},e.prototype.deleteSelected=function(){this.proxy.doDelete(this.getCharIndexByCursorIndex(this.selectionStart),this.getCharIndexByCursorIndex(this.selectionEnd));var e=this.selectionStart;this.setSelection(e,e)},e.prototype.getAllLegalCursorCount=function(){var e;return(null===(e=this.proxy.renderData)||void 0===e?void 0:e.lines.reduce((function(e,t){return e+t.length+1}),0))||1},e.prototype.startStandby=function(){if(!this.standby&&!this.editing){this.standby=!0;var e=this.upime.view.setConnectedSimpleEditor(this),t=this.getPositionByIndex(1);this.cursorPosition=exports.E({},t),null==e||e.focus()}},e.prototype.endStandby=function(){this.standby&&(this.standby=!1,this.upime.view.clearConnectedSimpleEditor(this))},e.prototype.moveCursorToEnd=function(){var e=this.getAllLegalCursorCount();this.setSelection(e,e)},e}(),vz=function(){function e(e,t){this.upime=e,this.content="",this.temContent="",this.option={inline:!1,style:{fontSize:14},lineHeight:22,color:"black"},this.scrollX=0,this.getPosition=t.getPosition,this.getScale=t.getScale,this.onEditEnd=t.onEditEnd,this.onUpdate=t.onUpdate,this.onStandbyToEditing=t.onStandbyToEditing,this.editor=new mz(e,this)}return e.prototype.getRendeingContent=function(){return this.editor.editing?this.temContent:this.content},e.prototype.updateConfig=function(e){this.option=exports.E({},e),this.calcRenderData()},e.prototype.setContent=function(e){this.content=e,this.calcRenderData(),this.editor.updateSelectArea()},e.prototype.calcRenderData=function(){var e=this.getRendeingContent(),t=this.option.width;if(this.option.inline||!t)if(this.option.maxWidth&&!this.editor.editing){var n=jL(e,this.option.maxWidth,this.option.style);this.renderData={height:this.option.lineHeight,width:n.width,lines:[yi(n.content)],originalLines:[yi(e)],lineBreaks:[!1]}}else{var i=ji(e,this.option.style);this.option.maxWidth&&i>this.option.maxWidth&&(i=this.option.maxWidth);var r=[yi(e)];this.renderData={height:this.option.lineHeight,width:i,lines:r,originalLines:r,lineBreaks:[!1]}}else if(e){var o=yi(e),a=Wi(o,exports.E(exports.E({},this.option.style),{lineHeight:this.option.lineHeight}),{wordWrapWidth:t}),s=a.lines,l=[],c=0;s.forEach((function(e,t){if(t===s.length-1)l.push(!1);else{c+=e.length;var n=_i(o[c]);n&&(c+=1),l.push(n)}})),this.renderData={height:a.height,width:t,lines:s,originalLines:s,lineBreaks:l}}else this.renderData={height:this.option.lineHeight,width:0,lines:[[""]],originalLines:[[""]],lineBreaks:[!1]};this.upime.updateView()},e.prototype.startEdit=function(e){this.editor.editing||(this.temContent=this.content),this.editor.startEdit(e),this.calcRenderData()},e.prototype.stopEdit=function(){if(this.editor.editing){var e=this.temContent;this.scrollX=0,this.temContent="",this.editor.stopEdit(),this.calcRenderData(),this.onEditEnd(e)}},e.prototype.destory=function(){},e.prototype.doDelete=function(e,t){var n,i=yi(this.temContent);i.splice(e,t-e),this.temContent=i.join(""),this.calcRenderData(),null===(n=this.onUpdate)||void 0===n||n.call(this,this.temContent)},e.prototype.doAdd=function(e,t){var n,i=yi(this.temContent);i.splice.apply(i,R([t,0],yi(e),!1)),this.temContent=i.join(""),this.calcRenderData(),null===(n=this.onUpdate)||void 0===n||n.call(this,this.temContent)},e}(),gz=function(){function e(e){var t=this;this.kanban=e,this.x=16,this.y=16,this.width=0,this.height=22,this.name="kanbanName",this.disabled=!1,this.on=!1,this.displayName="",this.option={inline:!0,maxWidth:0,style:{fontSize:16,fontWeight:"bold"},lineHeight:22,color:"#0C1024"},this.textProxy=new vz(e.upime,{getPosition:function(){return{x:t.kanban.position.x+16*t.kanban.scale,y:t.kanban.position.y+16*t.kanban.scale}},getScale:function(){return t.kanban.scale},onEditEnd:function(n){n&&n!==t.kanban.name&&e.upime.kanbanManager.updateKanban(e,{name:n})}}),this.updateName()}return e.prototype.updateName=function(){var e=this.kanban.viewWidth-32;this.option.maxWidth=e;var t=this.kanban.name;this.textProxy.setContent(t),this.textProxy.updateConfig(this.option)},e.prototype.render=function(){NB({x:16,y:16,simpleTextProxy:this.textProxy})},e.prototype.checkRelation=function(e,t){var n=this.kanban.upime.getSelectedElements();return 1===n.length&&n[0]===this.kanban&&0===this.kanban.selectedCards.length&&Ot(e,this.getBorderBox())?{name:this.name,cursor:"text",clickData:{position:{x:e.x/this.kanban.scale-16,y:e.y/this.kanban.scale-16}}}:null},e.prototype.getWidth=function(){var e;return this.textProxy.editor.editing?this.kanban.viewWidth-32:(null===(e=this.textProxy.renderData)||void 0===e?void 0:e.width)||0},e.prototype.getBorderBox=function(){var e=this.getWidth();return{left:this.x*this.kanban.scale,top:this.y*this.kanban.scale,right:(this.x+e)*this.kanban.scale,bottom:(this.y+this.height)*this.kanban.scale}},e.prototype.dealClick=function(e){var t,n=null===(t=e.clickData)||void 0===t?void 0:t.position;this.textProxy.startEdit({position:n})},e.prototype.handleSelectCtrlEvt=function(e){if(this.textProxy.editor.editing){var t=this.kanban.getGlobalBox(),n={x:e.position.x-t.left,y:e.position.y-t.top};if(e.isStart&&Ot(n,this.getBorderBox())){var i={x:(e.startPosition.x-t.left)/this.kanban.scale-16,y:(e.startPosition.y-t.top)/this.kanban.scale-16};return this.textProxy.editor.startSelect(i),!0}if(this.textProxy.editor.selecting)return i={x:(e.position.x-t.left)/this.kanban.scale-16,y:(e.position.y-t.top)/this.kanban.scale-16},e.isEnd?this.textProxy.editor.selectEnd(i):this.textProxy.editor.onSelect(i),!0}return!1},e.prototype.dealHoverStart=function(){},e.prototype.dealHoverEnd=function(){},e.prototype.getHoverPoint=function(){return{x:0,y:0}},e}(),yz=function(){function e(e,t){var n=this;this.kanban=e,this.col=t,this.x=0,this.y=108,this.width=0,this.height=24,this.disabled=!1,this.on=!1,this.displayName="",this.option={inline:!0,maxWidth:0,style:{fontSize:16},lineHeight:24,color:"#0C1024"},this.name="kanban_group_name_".concat(t.id),this.textProxy=new vz(e.upime,{getPosition:function(){return{x:n.kanban.position.x+n.getX()*n.kanban.scale,y:n.kanban.position.y+n.y*n.kanban.scale}},getScale:function(){return n.kanban.scale},onEditEnd:function(e){if((e=e.trim())&&e!==n.col.label){var t=n.kanban.groupByAttr;if(t){if(t.type===gB.radio||t.type===gB.checkbox){var i=t.typeExtraInfo.options.map((function(e){return e.label}));if(i.includes(e))return n.updateName(),o=n.getUsedWidth(),a=n.kanban.grids.findIndex((function(e){return e.id===n.col.id})),void(n.kanban.gridsUIInfo[a].titleWidth=o)}var r=n.kanban.attributes.map((function(i){if(i.id!==t.id)return i;if(i.type===gB.radio||i.type===gB.checkbox){var r=i.typeExtraInfo.options.map((function(t){return t.id!==n.col.id?t:exports.E(exports.E({},t),{label:e})}));return exports.E(exports.E({},i),{typeExtraInfo:exports.E(exports.E({},i.typeExtraInfo),{options:r})})}return i}));n.kanban.upime.kanbanManager.updateKanban(n.kanban,{attributes:r})}}else{n.updateName();var o=n.getUsedWidth(),a=n.kanban.grids.findIndex((function(e){return e.id===n.col.id}));n.kanban.gridsUIInfo[a].titleWidth=o}},onUpdate:function(){var e=n.getUsedWidth(),t=n.kanban.grids.findIndex((function(e){return e.id===n.col.id}));n.kanban.gridsUIInfo[t].titleWidth=e}}),this.updateName()}return e.prototype.getX=function(){var e=this;return 16+280*this.kanban.grids.findIndex((function(t){return t.id===e.col.id}))+16},e.prototype.render=function(){fa({x:this.getX(),y:this.y});var e=this.textProxy.getRendeingContent();NB({x:0,y:0,simpleTextProxy:this.textProxy}),e||this.textProxy.editor.editing||(fa({fill:"#dfdfdf"}),ka({x:0,y:0,width:48,height:24}),ma()),ma()},e.prototype.checkRelation=function(e,t){if(!this.col.editable)return null;if(this.kanban.onlyCheckKanban)return null;var n=this.kanban.groupByAttr;if((null==n?void 0:n.type)===gB.userList)return null;var i=this.kanban.upime.getSelectedElements(),r=this.getBorderBox();return 1===i.length&&i[0]===this.kanban&&0===this.kanban.selectedCards.length&&Ot(e,r)?{name:this.name,cursor:"text",clickData:{offsetX:(e.x-r.left)/this.kanban.scale}}:null},e.prototype.getBorderBox=function(){var e=this.y,t=this.getX();return{left:t*this.kanban.scale,top:e*this.kanban.scale,right:(t+this.width)*this.kanban.scale,bottom:(e+this.height)*this.kanban.scale}},e.prototype.dealClick=function(e){var t,n=(null===(t=e.clickData)||void 0===t?void 0:t.offsetX)||0;this.textProxy.startEdit({position:{x:n,y:this.option.lineHeight/2}}),this.kanban.updateGridUIInfo()},e.prototype.dealHoverStart=function(){},e.prototype.dealHoverEnd=function(){},e.prototype.getHoverPoint=function(){return{x:0,y:0}},e.prototype.getUsedWidth=function(){var e;return this.textProxy.getRendeingContent()&&(null===(e=this.textProxy.renderData)||void 0===e?void 0:e.width)||48},e.prototype.updateMaxWidth=function(e){this.option.maxWidth=e,this.updateName()},e.prototype.updateName=function(){var e=this.col.label;this.textProxy.setContent(e),this.textProxy.updateConfig(this.option),this.width=this.getUsedWidth()},e.prototype.handleSelectCtrlEvt=function(e){if(this.textProxy.editor.editing){var t=this.kanban.getGlobalBox(),n={x:e.position.x-t.left,y:e.position.y-t.top},i=this.getBorderBox();if(e.isStart&&Ot(n,i)){var r={x:(e.startPosition.x-t.left)/this.kanban.scale-this.getX(),y:(e.startPosition.y-t.top)/this.kanban.scale-this.y};return this.textProxy.editor.startSelect(r),!0}if(this.textProxy.editor.selecting)return r={x:(e.position.x-t.left)/this.kanban.scale-this.getX(),y:(e.position.y-t.top)/this.kanban.scale-this.y},e.isEnd?this.textProxy.editor.selectEnd(r):this.textProxy.editor.onSelect(r),!0}return!1},e}(),bz=function(){function e(e){this.kanban=e,this.animateIndexList=[],this.currentTime=0,this.timer=0,this.animating=!1,this.upime=e.upime}return Object.defineProperty(e.prototype,"percent",{get:function(){return this.currentTime/8},enumerable:!1,configurable:!0}),e.prototype.start=function(e){0!==this.currentTime&&this.stop(),this.animateIndexList.push(e),this.animating||this.startAnimate()},e.prototype.stop=function(){this.animateIndexList=[],this.currentTime=0,this.animating=!1,mr(this.timer)},e.prototype.startAnimate=function(){this.currentTime=0,this.animating=!0,this.animateTrun()},e.prototype.animateTrun=function(){var e=this;this.currentTime<8?this.timer=fr((function(){e.currentTime++,e.upime.updateView(),e.animateTrun()})):this.stop()},e}(),Ez=function(){function e(e){this.kanban=e,this.x=0,this.y=0,this.width=84,this.height=30,this.name="kanbanFilter",this.disabled=!1,this.on=!1;var t=e.getGroupBorderBoxInKanban();this.y=t.top,this.x=t.right+8}return Object.defineProperty(e.prototype,"filters",{get:function(){return this.kanban.abledFilters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectiveFilters",{get:function(){var e;return(null===(e=this.filters)||void 0===e?void 0:e.filter((function(e){return e.targetProp&&e.value})))||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){var e=this.effectiveFilters;return 0===e.length?O("kanban.filter.label"):e.length>9?"9+ ".concat(O("kanban.filter.label.multi")):"".concat(e.length," ").concat(O("kanban.filter.label.multi"))},enumerable:!1,configurable:!0}),e.prototype.render=function(){var e=this;fa({x:this.x,y:this.y}),Na((function(t){t.lineStyle({color:15132649});var n=!1;e.effectiveFilters.length>0?(t.beginFill(3044325,.2),n=!0):e.on&&(t.beginFill(16119542),n=!0),t.drawRoundedRect(0,0,e.width,e.height,4),t.lineStyle(),n&&t.endFill()})),Ra({text:this.label,fontSize:14,fontFamily:He,lineHeight:30},{x:8,y:0,fill:"#0C1024"}),fa({alpha:.65}),Oa({src:"filter"===this.kanban.selectedState?FB:OB,x:this.width-8-16,y:7,width:16,height:16}),ma(),ma()},e.prototype.getBorderBox=function(){return{left:this.x*this.kanban.scale,top:this.y*this.kanban.scale,right:(this.x+this.width)*this.kanban.scale,bottom:(this.y+this.height)*this.kanban.scale}},e.prototype.checkRelation=function(e,t){return!this.kanban.upime.editable&&"hover"!==(null==t?void 0:t.type)||!this.kanban.upime.editable&&0===this.effectiveFilters.length||this.kanban.onlyCheckKanban?null:Ot(e,this.getBorderBox())?{name:this.name,cursor:this.kanban.upime.editable?"pointer":Wd()}:null},e.prototype.dealClick=function(){if(this.kanban.upime.phoneMode)this.kanban.upime.addToast(O("kanban.usepc.attr"));else if(_c("cv_kanban_setfilter"),!(this.kanban.activeDomWidget&&this.kanban.activeDomWidget instanceof xz)){var e=new xz(this.kanban,this);this.kanban.addActiveDomWidget(e)}},e.prototype.dealHoverStart=function(){this.on||(this.on=!0,this.effectiveFilters.length>0&&this.kanban.showWidgetTip(this,this.getTip(),this.getHoverPoint()))},e.prototype.getTip=function(){return this.kanban.upime.editable?O("kanban.setting.filter.tip"):O("kanban.setting.filter.noauth")},e.prototype.dealHoverEnd=function(){this.on=!1,this.kanban.clearWidgetTip(this)},e.prototype.getHoverPoint=function(){return{x:(this.x+this.width/2)*this.kanban.scale,y:this.y*this.kanban.scale}},e.prototype.remove=function(){this.kanban.removeActiveDomWidget()},e}(),xz=function(){function e(e,t){this.element=e,this.widget=t,this.renderer=wz,this.renderKey="kanban-filter-".concat(e.id)}return e.prototype.remove=function(){this.element.removeActiveDomWidget()},e}();function wz(t){var n=t.element,i=t.upime,r=e.useRef(null);e.useEffect((function(){return gh((function(){n.remove()}),{skipElements:r.current?[r.current]:void 0})}),[]),e.useEffect((function(){n.element.selectedState="filter",i.updateView()}),[]);var o=function(){var e=n.widget.getBorderBox(),t=n.element.position,r=t.x+e.left,o=t.y+e.bottom;return i.view.getScreenPosition({x:r,y:o})}();return e.createElement("div",{ref:r,className:"filterWrapper_1xZx7",style:{left:"".concat(o.x,"px"),top:"".concat(o.y+4,"px")}},e.createElement(kz,{element:n,upime:i,position:o}))}var Cz=1;function Sz(){return{targetProp:void 0,value:void 0,filterType:BB.EQUAL,id:Cz++}}function kz(t){var n=t.element,i=t.upime,r=t.position,o=W().getUpimeTrans,a=e.useState((function(){var e=_t.cloneDeep(n.element.abledFilters||[]);return e.length?e.map((function(e){return exports.E(exports.E({},e),{id:Cz++})})):[Sz()]})),s=a[0],l=a[1],c=function(e,t){l(e);var r=t||i.createOperation(),o=e.map((function(e){return{targetProp:Lz(e.targetProp),filterType:e.filterType,value:e.value,timeRangeExtra:e.timeRangeExtra}}));r.update(n.element,{filters:o}),r.sync(),_c("cv_kanban_filterby")},u=e.useRef(null);function d(){var e,t;return s.length>1||Boolean((null===(e=s[0])||void 0===e?void 0:e.targetProp)||(null===(t=s[0])||void 0===t?void 0:t.value))}return e.createElement(e.Fragment,null,e.createElement("div",{className:LO},e.createElement("div",null,o("kanban.filter.title")),e.createElement(Dl,{placement:"top",content:o("kanban.filter.title.tip"),large:!0,useClick:_e.isTouchSupported},e.createElement("div",{className:j(OO,iF)},e.createElement(hl,{icon:"xinxi",size:14}))),e.createElement("div",{className:j(FO,d()?iF:zO),onClick:function(){d()&&c([Sz()])}},e.createElement(hl,{icon:"qingkong",size:14}),e.createElement("span",null,o("kanban.filter.title.clear")))),e.createElement("div",{className:HO,ref:u},s.map((function(t,i){return e.createElement(_z,{position:r,filters:s,filter:t,setFilter:function(e,t){var n=exports.E(exports.E({},Sz()),e),r=R([],s,!0);r[i]=n,c(r,t)},kanban:n.element,onDelete:function(){var e=s.filter((function(e){return e.id!==t.id}));c(e)},scrollRef:u,key:t.id})}))),e.createElement("div",{className:j(JO,iF),onClick:function(){c(R(R([],s,!0),[Sz()],!1)),fr((function(){var e;null===(e=u.current)||void 0===e||e.scrollTo(0,u.current.scrollHeight)}))}},e.createElement(hl,{icon:"plus",size:16}),e.createElement("span",null,o("kanban.filter.add"))))}var _z=function(t){var n=t.filters,i=t.filter,r=t.setFilter,o=t.kanban,a=t.position,s=t.onDelete,l=t.scrollRef,c=n.length>1;return e.createElement("div",{className:"filterRowContainer_2xQPB"},e.createElement(Iz,{position:a,filter:i,setFilter:r,kanban:o,scrollRef:l}),e.createElement(Pz,{position:a,filter:i,setFilter:r,scrollRef:l}),e.createElement(Mz,{position:a,filter:i,setFilter:r,kanban:o,scrollRef:l}),e.createElement(Nz,{onDelete:function(){c?s():r(Sz())},canDelete:c,filter:i}))};function Tz(t,n,i){var r=yh(!0,{checkSkip:i}),o=r.hide,a=r.toggleHide,s=r.skipRef,l=e.useState({x:0,y:0}),c=l[0],u=l[1],d=e.useState({x:0,y:0}),p=d[0],h=d[1];function f(){var e;if(o){var n=(null===(e=s.current)||void 0===e?void 0:e.getBoundingClientRect())||new DOMRect;h({x:n.x,y:n.y}),u(t)}a()}e.useEffect((function(){if(n.current&&!o){var e=function(){f()};return n.current.addEventListener("scroll",e),function(){var t;null===(t=n.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[n.current,o]);var m=function(){if(o)return{x:0,y:0};var e=t.x-c.x,n=t.y-c.y;return{x:p.x+e,y:p.y+n+36+2}}();return{hide:o,toggleHide:f,skipRef:s,finallyOptionPosition:m}}var Iz=function(t){var n=t.filter,i=t.setFilter,r=t.position,o=t.kanban,a=t.scrollRef,s=W().getUpimeTrans,l=Tz(r,a),c=l.hide,u=l.toggleHide,d=l.skipRef,p=l.finallyOptionPosition,h=o.attributes,f=e.useMemo((function(){var e=[];return h.forEach((function(t){t.type===gB.timeRange?(e.push({label:t.typeExtraInfo.timeRangeLabels[0],timeRangeExtra:"timeRangeStart",targetProp:t,icon:aF(t)||null}),e.push({label:t.typeExtraInfo.timeRangeLabels[1],timeRangeExtra:"timeRangeEnd",targetProp:t,icon:aF(t)||null})):e.push({label:t.label,targetProp:t,icon:aF(t)||null})})),e}),[o.attributes]);return e.createElement("div",{ref:d,className:j(QO),onClick:u},e.createElement("div",{className:j(UO,!c&&mO)},n.targetProp?e.createElement("div",{className:VO},function(e){if("cardName"===e.targetProp)return s("kanban.filter.title.content");if(e.targetProp){var t=e.targetProp.id,n=o.attributes.find((function(e){return e.id===t}));return e.targetProp.type===gB.timeRange&&(null==n?void 0:n.type)===gB.timeRange?"timeRangeStart"===e.timeRangeExtra?n.typeExtraInfo.timeRangeLabels[0]:n.typeExtraInfo.timeRangeLabels[1]:(null==n?void 0:n.label)||""}return""}(n)):e.createElement("div",{className:GO},s("common.please.select")),e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:jO})),!c&&e.createElement("div",{className:qO,style:{left:"".concat(p.x,"px"),top:"".concat(p.y,"px")}},e.createElement("div",{className:j(KO,"cardName"===n.targetProp&&YO,iF),onClick:function(){"cardName"!==n.targetProp&&i(exports.E(exports.E({},n),{targetProp:"cardName",filterType:Oz("cardName"),timeRangeExtra:void 0,value:void 0}))}},e.createElement(hl,{icon:"kanbankapian",size:16}),e.createElement("div",{className:XO},s("kanban.filter.title.content"))),f.map((function(t,r){var o,a,s,l=(a=(o=t).targetProp,!(!(s=n.targetProp)||!a)&&("cardName"===a?"cardName"===s:"cardName"!==s&&(a.type===gB.timeRange?a.id===s.id&&n.timeRangeExtra===o.timeRangeExtra:a.id===s.id)));return e.createElement("div",{onClick:function(){l||i(exports.E(exports.E({},n),{targetProp:t.targetProp,timeRangeExtra:t.timeRangeExtra,filterType:Oz(t.targetProp),value:void 0}))},className:j(KO,l&&YO,iF),key:r},t.icon&&e.createElement(hl,{icon:t.icon,size:16}),e.createElement("div",{className:XO},t.label))}))))},Pz=function(t){var n,i=t.filter,r=t.setFilter,o=t.position,a=t.scrollRef,s=W().getUpimeTrans,l=Tz(o,a),c=l.hide,u=l.toggleHide,d=l.skipRef,p=l.finallyOptionPosition,h=((n={})[BB.CONTAIN]=s("kanban.filter.type.include"),n[BB.EQUAL]=s("kanban.filter.type.equal"),n),f=[BB.CONTAIN,BB.EQUAL],m=function(){var e;return!i||"cardName"===i.targetProp||(null===(e=i.targetProp)||void 0===e?void 0:e.type)!==gB.timeRange}();return e.createElement("div",{ref:d,className:j("filterTypeContainer_1BvIo",!m&&"filterTypeDisabled_3xnAE"),onClick:function(){return m&&u()}},e.createElement("div",{className:j(UO,!m&&WO,!c&&mO)},e.createElement("div",{className:VO},_t.isNil(i.filterType)?"":h[i.filterType]),m&&e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:jO})),!c&&e.createElement("div",{className:qO,style:{left:"".concat(p.x+12,"px"),top:"".concat(p.y,"px")}},f.map((function(t){var n=i.filterType===t;return e.createElement("div",{key:t,onClick:function(){i.filterType!==t&&r(exports.E(exports.E({},i),{filterType:t}))},className:j(KO,n&&YO,iF)},h[t])}))))},Nz=function(t){var n=t.onDelete,i=t.canDelete,r=t.filter,o=Boolean(r.targetProp);return e.createElement("div",{className:"filterIconContainer_3phpX"},e.createElement("div",{className:j("filterIcon_1wva3",i||o?iF:ZO),onClick:function(){(i||o)&&n()}},e.createElement(hl,{icon:"guanbi",size:16})))},Mz=function(t){var n=t.filter,i=t.setFilter,r=t.position,o=t.kanban,a=t.scrollRef,s=function(){var t=n.targetProp;if(!t)return e.createElement("div",{className:"emptyValueContainer_1E-hK"});if("cardName"===t||t.type===gB.richText||t.type===gB.fileList)return e.createElement(Az,{filter:n,setFilter:i,kanban:o});if(t.type===gB.radio)return e.createElement(Dz,{filter:n,setFilter:i,kanban:o,position:r,scrollRef:a});if(t.type===gB.userList)return e.createElement(Rz,{filter:n,setFilter:i,kanban:o,position:r,scrollRef:a});if(t.type===gB.timeRange)return e.createElement(Bz,{filter:n,setFilter:i,kanban:o,position:r,scrollRef:a});throw new Error("unknown filter type")}();return e.createElement("div",{className:"filterValueContainer_3tnqu"},s)},Az=function(t){var n=t.filter,i=t.setFilter,r=t.kanban,o=e.useRef(null);return e.createElement("input",{value:n.value||"",type:"text",placeholder:O("common.placeholder.enter"),className:"inputValue_A163d",onChange:function(e){return function(e){var t=e.target.value,a=function(){var e=o.current;if(e)return e;var t=r.upime.createOperation();return o.current=t,t}();i(exports.E(exports.E({},n),{value:t}),a)}(e)},onBlur:function(){o.current=null}})},Dz=function(t){var n=t.filter,i=t.setFilter,r=t.kanban,o=Tz(t.position,t.scrollRef),a=o.hide,s=o.toggleHide,l=o.skipRef,c=o.finallyOptionPosition,u=e.useMemo((function(){var e=n.targetProp;if(!e||"cardName"===e)return[];var t=r.attributes.find((function(t){return t.id===e.id}));return t&&t.type===gB.radio?t.typeExtraInfo.options:[]}),[n]),d=e.useMemo((function(){return u.find((function(e){return e.id===n.value}))}),[n,u]);return e.createElement("div",{ref:l,className:"radioSelectContainer_jlsUY",onClick:s},e.createElement("div",{className:"radioSelect_1iGuG"},e.createElement("div",{className:"radioContent_1ylwn"},d?e.createElement("div",{className:"radioValueContainer_1EBWG",style:{backgroundColor:"".concat(pr(d.color),"40")}},e.createElement("div",{className:"radioLabel_1zJ2V"},d.label),r.upime.editable&&e.createElement(hl,{onClick:function(e){e.stopPropagation(),e.preventDefault(),i(exports.E(exports.E({},n),{value:void 0}))},icon:"guanbi",size:14,style:{cursor:"pointer"}})):e.createElement("span",{className:nF},O("common.please.select"))),e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:"radioIcon_3ulr-"})),!a&&e.createElement("div",{className:qO,style:{left:"".concat(c.x,"px"),top:"".concat(c.y,"px")}},u.map((function(t,r){var o=n.value===t.id;return e.createElement("div",{onClick:function(){o||i(exports.E(exports.E({},n),{value:t.id}))},className:j(KO,o&&YO,iF),key:r},t.icon&&e.createElement(hl,{icon:t.icon,size:16,style:{color:pr(t.color)}}),e.createElement("div",{className:XO},t.label))}))))},Rz=function(t){var n=t.filter,i=t.setFilter,r=t.kanban,o=t.position,a=t.scrollRef,s=e.useRef(null),l=Tz(o,a,(function(e){return!!s.current&&(e===s.current||V(s.current,e))})),c=l.hide,u=l.toggleHide,d=l.skipRef,p=l.finallyOptionPosition,h=e.useReducer((function(e){return e+1}),0),f=h[0],m=h[1],v=e.useMemo((function(){var e;return(null===(e=n.value)||void 0===e?void 0:e.map((function(e){return r.upime.userManager.getUser(e)})))||[]}),[n.value,f]);function g(e){i(exports.E(exports.E({},n),{value:0===e.length?void 0:R([],e,!0)}))}return e.useEffect((function(){return r.upime.subscribe("updatedUserInfo",m)}),[]),e.createElement("div",{ref:d,className:"userSelectContainer_2bpct",onClick:u},e.createElement("div",{className:"userSelect_3cbjW"},e.createElement("div",{className:"userContent_3Z6Mt"},v.map((function(t){return e.createElement("div",{className:"displayItem_lfc0Q",key:t.loginName},e.createElement(ml,{url:t.avatarUrl,className:"avatar_3tYao"}),e.createElement("div",{className:j("userName_2v6ja")},t.userName||"--"),r.upime.editable&&e.createElement(hl,{icon:"guanbi",size:14,style:{cursor:"pointer"},onClick:function(e){var i;e.stopPropagation(),g((null===(i=n.value)||void 0===i?void 0:i.filter((function(e){return e!==t.loginName})))||[])}}))})),0===v.length&&e.createElement("span",{className:j(nF,"contentPlaceHolderUser_17MWr")},O("common.please.select"))),e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:"userIcon_2ECgb"})),!c&&e.createElement("div",{ref:s,className:qO,style:{width:"292px",left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),padding:0},onClick:function(e){return e.stopPropagation()}},e.createElement(nL,{users:n.value||[],onChange:g,showUsers:!1})))},Bz=function(t){var n=t.filter,i=t.setFilter,r=t.kanban,o=t.position,a=t.scrollRef,s=e.useRef(null),l=W().getUpimeTrans,c=Tz(o,a,(function(e){return!!s.current&&(e===s.current||V(s.current,e))})),u=c.hide,d=c.toggleHide,p=c.skipRef,h=c.finallyOptionPosition;return e.createElement("div",{ref:p,className:"timeRangeSelectContainer_CM3qf",onClick:d},e.createElement("div",{className:"timeRange_2vaDg"},e.createElement("div",{className:"timeRangeContent_3kkBH"},n.value?e.createElement("div",{className:"timeRangeValueContainer_2Nq4w"},e.createElement("div",{className:"timeRangeLabel_1DjWT"},e.createElement("span",null,tO(n.value)),e.createElement("span",null,"timeRangeStart"===n.timeRangeExtra?l("card.attr.startendtime.start.short"):l("card.attr.startendtime.end.short"))),r.upime.editable&&e.createElement(hl,{onClick:function(e){e.stopPropagation(),e.preventDefault(),i(exports.E(exports.E({},n),{value:void 0}))},icon:"guanbi",size:14,style:{cursor:"pointer"}})):e.createElement("span",{className:j(nF)},l("common.please.select"))),e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:"timeRangeIcon_3smkd"})),!u&&e.createElement("div",{className:qO,style:{left:"".concat(h.x,"px"),top:"".concat(h.y,"px"),width:"276px"},onClick:function(e){return e.stopPropagation()},ref:s},e.createElement(SL,{value:n.value,onChange:function(e){i(exports.E(exports.E({},n),{value:e})),d()}})))};function Lz(e){return"cardName"!==e&&e?{id:e.id,type:e.type}:e}function Oz(e){if(!e)return BB.EQUAL;if("cardName"===e)return BB.CONTAIN;switch(e.type){case gB.radio:return BB.EQUAL;case gB.userList:case gB.checkbox:case gB.fileList:case gB.text:case gB.richText:return BB.CONTAIN;case gB.timeRange:return BB.EQUAL}}var Fz=function(){function e(e){this.kanban=e,this.x=0,this.y=0,this.width=84,this.height=30,this.name="kanbanOrder",this.disabled=!1,this.on=!1;var t=e.getGroupBorderBoxInKanban();this.y=t.top,this.x=t.right+84+16}return Object.defineProperty(e.prototype,"orders",{get:function(){return this.kanban.abledOrders},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"effectOrders",{get:function(){var e;return(null===(e=this.orders)||void 0===e?void 0:e.filter((function(e){return e.targetProp&&e.value})))||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){var e=this.effectOrders;return 0===e.length?O("kanban.order.label"):e.length>9?"9+ ".concat(O("kanban.order.label.multi")):"".concat(e.length," ").concat(O("kanban.order.label.multi"))},enumerable:!1,configurable:!0}),e.prototype.render=function(){var e=this;fa({x:this.x,y:this.y}),Na((function(t){t.lineStyle({color:15132649});var n=!1;e.effectOrders.length>0?(t.beginFill(3044325,.2),n=!0):e.on&&(t.beginFill(16119542),n=!0),t.drawRoundedRect(0,0,e.width,e.height,4),t.lineStyle(),n&&t.endFill()})),Ra({text:this.label,fontSize:14,fontFamily:He,lineHeight:30},{x:8,y:0,fill:"#0C1024"}),fa({alpha:.65}),Oa({src:"order"===this.kanban.selectedState?FB:OB,x:this.width-8-16,y:7,width:16,height:16}),ma(),ma()},e.prototype.getBorderBox=function(){return{left:this.x*this.kanban.scale,top:this.y*this.kanban.scale,right:(this.x+this.width)*this.kanban.scale,bottom:(this.y+this.height)*this.kanban.scale}},e.prototype.checkRelation=function(e,t){return this.kanban.upime.editable?this.kanban.onlyCheckKanban?null:Ot(e,this.getBorderBox())?{name:this.name,cursor:"pointer"}:null:null},e.prototype.dealClick=function(){if(this.kanban.upime.phoneMode)this.kanban.upime.addToast(O("kanban.usepc.attr"));else if(_c("cv_kanban_setsort"),!(this.kanban.activeDomWidget&&this.kanban.activeDomWidget instanceof zz)){var e=new zz(this.kanban,this);this.kanban.addActiveDomWidget(e)}},e.prototype.dealHoverStart=function(){this.on=!0},e.prototype.dealHoverEnd=function(){this.on=!1},e.prototype.getHoverPoint=function(){return{x:(this.x+this.width/2)*this.kanban.scale,y:this.y*this.kanban.scale}},e.prototype.remove=function(){this.kanban.removeActiveDomWidget()},e}(),zz=function(){function e(e,t){this.element=e,this.widget=t,this.renderer=Hz,this.renderKey="kanban-order-".concat(e.id)}return e.prototype.remove=function(){this.element.removeActiveDomWidget()},e}();function Hz(t){var n=t.element,i=t.upime,r=e.useRef(null);e.useEffect((function(){return gh((function(){n.remove()}),{skipElements:r.current?[r.current]:void 0})}),[]),e.useEffect((function(){n.element.selectedState="order",i.updateView()}),[]);var o=function(){var e=n.widget.getBorderBox(),t=n.element.position,r=t.x+e.left,o=t.y+e.bottom;return i.view.getScreenPosition({x:r,y:o})}();return e.createElement("div",{ref:r,className:"orderWrapper_EQH_K",style:{left:"".concat(o.x,"px"),top:"".concat(o.y+4,"px")}},e.createElement(Vz,{element:n,upime:i,position:o}))}var Uz=1;function Wz(){return{targetProp:void 0,value:void 0,id:Uz++}}function Vz(t){var n=t.element,i=t.upime,r=t.position,o=W().getUpimeTrans,a=e.useState((function(){var e=_t.cloneDeep(n.element.abledOrders);return e.length?e.map((function(e){return exports.E(exports.E({},e),{id:Uz++})})):[Wz()]})),s=a[0],l=a[1],c=e.useRef(null);return e.createElement(e.Fragment,null,e.createElement("div",{className:$O},e.createElement("div",null,o("kanban.order.edit.title"))),e.createElement("div",{className:eF,ref:c},s.map((function(t,o){return e.createElement(jz,{order:t,setOrder:function(e,t){var r=exports.E(exports.E({},Wz()),e),a=R([],s,!0);a[o]=r,function(e,t){l(e);var r=t||i.createOperation(),o=e.map((function(e){return{targetProp:Xz(e.targetProp),value:e.value,timeRangeExtra:e.timeRangeExtra}}));r.update(n.element,{orders:o}),r.sync(),_c("cv_kanban_sortby")}(a,t)},position:r,kanban:n.element,scrollRef:c,key:t.id})}))))}var jz=function(t){var n=t.order,i=t.setOrder,r=t.position,o=t.kanban,a=t.scrollRef,s=Boolean(n.targetProp||n.value);return e.createElement("div",{className:"orderRowContainer_156f0"},e.createElement(Gz,{order:n,setOrder:i,position:r,kanban:o,scrollRef:a}),e.createElement(qz,{order:n,setOrder:i,position:r,kanban:o,scrollRef:a}),e.createElement(Kz,{onDelete:function(){i(Wz())},canDelete:s}))},Gz=function(t){var n=t.order,i=t.setOrder,r=t.position,o=t.kanban,a=t.scrollRef,s=W().getUpimeTrans,l=Yz(r,a),c=l.hide,u=l.toggleHide,d=l.skipRef,p=l.finallyOptionPosition,h=o.attributes,f=e.useMemo((function(){var e=[];return h.forEach((function(t){t.type===gB.timeRange?(e.push({label:t.typeExtraInfo.timeRangeLabels[0],timeRangeExtra:"timeRangeStart",targetProp:t,icon:aF(t)||null}),e.push({label:t.typeExtraInfo.timeRangeLabels[1],timeRangeExtra:"timeRangeEnd",targetProp:t,icon:aF(t)||null})):e.push({label:t.label,targetProp:t,icon:aF(t)||null})})),e}),[o.attributes]);return e.createElement("div",{ref:d,className:j(QO),onClick:u},e.createElement("div",{className:j("orderOptionLabel_2bHVr",!c&&mO)},n.targetProp?e.createElement("div",{className:VO},function(e){if("cardName"===e.targetProp)return s("kanban.filter.title.content");if(e.targetProp){var t=e.targetProp.id,n=o.attributes.find((function(e){return e.id===t}));return e.targetProp.type===gB.timeRange&&(null==n?void 0:n.type)===gB.timeRange?"timeRangeStart"===e.timeRangeExtra?n.typeExtraInfo.timeRangeLabels[0]:n.typeExtraInfo.timeRangeLabels[1]:(null==n?void 0:n.label)||""}return""}(n)):e.createElement("div",{className:GO},s("common.please.select")),e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:jO})),!c&&e.createElement("div",{className:tF,style:{left:"".concat(p.x,"px"),top:"".concat(p.y,"px")}},e.createElement("div",{className:j(KO,"cardName"===n.targetProp&&YO,iF),onClick:function(){"cardName"!==n.targetProp&&i(exports.E(exports.E({},n),{value:"asc",targetProp:"cardName",timeRangeExtra:void 0}))}},e.createElement(hl,{icon:"kanbankapian",size:16}),e.createElement("div",{className:XO},s("kanban.filter.title.content"))),f.map((function(t,r){var o,a,s,l=(a=(o=t).targetProp,!(!(s=n.targetProp)||!a)&&("cardName"===a?"cardName"===s:"cardName"!==s&&(a.type===gB.timeRange?a.id===s.id&&n.timeRangeExtra===o.timeRangeExtra:a.id===s.id)));return e.createElement("div",{onClick:function(){l||i(exports.E(exports.E({},n),{value:"asc",targetProp:t.targetProp,timeRangeExtra:t.timeRangeExtra}))},className:j(KO,l&&YO,iF),key:r},t.icon&&e.createElement(hl,{icon:t.icon,size:16}),e.createElement("div",{className:XO},t.label))}))))},qz=function(t){var n=t.order,i=t.setOrder,r=t.position;t.kanban;var o=t.scrollRef,a=W().getUpimeTrans,s=Yz(r,o),l=s.hide,c=s.toggleHide,u=s.skipRef,d=s.finallyOptionPosition,p=function(){var e;if("cardName"===n.targetProp)return[a("kanban.order.text.asc"),a("kanban.order.text.desc")];switch(null===(e=n.targetProp)||void 0===e?void 0:e.type){case gB.userList:case gB.richText:case gB.text:case gB.fileList:return[a("kanban.order.text.asc"),a("kanban.order.text.desc")];case gB.checkbox:case gB.radio:return[a("kanban.order.radio.asc"),a("kanban.order.radio.desc")];case gB.timeRange:return[a("kanban.order.common.asc"),a("kanban.order.common.desc")]}}(),h=Boolean(n.targetProp);return e.createElement("div",{ref:u,className:"orderValueWrapper_1lULl",onClick:function(){h&&c()}},e.createElement("div",{className:j("orderValueContainer_1vK_T",!h&&WO)},e.createElement("div",{className:"content_1iYVi"},n.value?"asc"===n.value?null==p?void 0:p[0]:null==p?void 0:p[1]:e.createElement("span",{className:j(nF)},a("common.please.select"))),h&&e.createElement(hl,{icon:"wenjianjiazhankai",size:18,className:"downIcon_1sDTw"})),!l&&e.createElement("div",{className:tF,style:{left:"".concat(d.x+12,"px"),top:"".concat(d.y,"px")}},e.createElement("div",{className:j(KO,"asc"===n.value&&YO,iF),onClick:function(){i(exports.E(exports.E({},n),{value:"asc"}))}},null==p?void 0:p[0]),e.createElement("div",{className:j(KO,"desc"===n.value&&YO,iF),onClick:function(){i(exports.E(exports.E({},n),{value:"desc"}))}},null==p?void 0:p[1])))},Kz=function(t){var n=t.onDelete,i=t.canDelete;return e.createElement("div",{className:"orderIconContainer_AyMYQ"},e.createElement("div",{className:j("orderIcon_-_Ify",i?iF:ZO),onClick:function(){i&&n()}},e.createElement(hl,{icon:"guanbi",size:16})))};function Yz(t,n){var i=yh(!0),r=i.hide,o=i.toggleHide,a=i.skipRef,s=e.useState({x:0,y:0}),l=s[0],c=s[1],u=e.useState({x:0,y:0}),d=u[0],p=u[1];function h(){var e;if(r){var n=(null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect())||new DOMRect;p({x:n.x,y:n.y}),c(t)}o()}e.useEffect((function(){if(n.current&&!r){var e=function(){h()};return n.current.addEventListener("scroll",e),function(){var t;null===(t=n.current)||void 0===t||t.removeEventListener("scroll",e)}}}),[n.current,r]);var f=function(){if(r)return{x:0,y:0};var e=t.x-l.x,n=t.y-l.y;return{x:d.x+e,y:d.y+n+36+2}}();return{hide:r,toggleHide:h,skipRef:a,finallyOptionPosition:f}}function Xz(e){return"cardName"!==e&&e?{id:e.id,type:e.type}:e}var Qz="unGroup",Zz=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.renderer=HB,i.editorType=VL,i.elementType=Za.KANBAN,i.globalBoxChanged=!0,i.borderBoxChanged=!0,i.nameWidth=0,i.configDefaultColId=void 0,i.colHeight=0,i._viewWidth=0,i._viewHeight=0,i.onAttributesUpdateCBList=[],i.onUpdateGroupCBOnceList=[],i.name="",i.colGroupBy="",i.rowGrouyBy="",i.disPlayColGroupBy="",i.attributes=[],i.disPlayConfigLabel=i.getDisplayConfigUI(),i.cards=[],i.grids=[],i.gridsUIInfo=[],i.cardsMap=new Map,i.hoverInfo={addBt:null,config:null},i.selectedState=void 0,i.wigetCard=null,i.wigetCardCol=null,i.activeDomWidgetAdding=!1,i.animateCtrl=new bz(i),i.hoverCardLink=!1,i.filters=null,i.orders=null,i.hidedCards=[],i.groupNameWidgetList=[],i.colActionWidgetList=[],i.selectedCards=[],i.movingCards=[],i.subscribeUserInfoChange(),i.addColWidget=new az(i),i.addInnerWidget(i.addColWidget),i.nameWidget=new gz(i),i.addInnerWidget(i.nameWidget),i.filterWidget=new Ez(i),i.addInnerWidget(i.filterWidget),i.orderWidget=new Fz(i),i.addInnerWidget(i.orderWidget),i}return P(t,e),Object.defineProperty(t.prototype,"viewWidth",{get:function(){return this._viewWidth},set:function(e){this._viewWidth=e,this.size.width=e*this.scale,this.updateBorderBox()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(e){this._viewHeight=e,this.size.height=e*this.scale,this.updateBorderBox()},enumerable:!1,configurable:!0}),t.prototype.updateCards=function(e){this.cards=R([],e,!0),new Set(this.cards).size,this.cards.length},Object.defineProperty(t.prototype,"abledFilters",{get:function(){var e=this;return this.filters?this.filters.filter((function(t){var n=t.targetProp,i=t.value;if(n&&"cardName"!==n){var r=e.attributes.find((function(e){return e.id===n.id}));if(!r)return!1;if(i&&(r.type===gB.radio||r.type===gB.checkbox)&&r.typeExtraInfo.options.every((function(e){return e.id!==i})))return!1}return!0})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"abledOrders",{get:function(){var e=this;return this.orders?this.orders.filter((function(t){var n=t.targetProp;return!(n&&"cardName"!==n&&!e.attributes.find((function(e){return e.id===n.id})))})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeOrders",{get:function(){var e;return(null===(e=this.abledOrders)||void 0===e?void 0:e.filter((function(e){return e.targetProp&&e.value})))||[]},enumerable:!1,configurable:!0}),t.prototype.removeActiveDomWidget=function(){this.activeDomWidget&&!this.activeDomWidgetAdding&&(this.upime.view.removeDomWidget(this.activeDomWidget),this.activeDomWidget=void 0,this.clearSelectedState())},t.prototype.addActiveDomWidget=function(e){var t=this;this.removeActiveDomWidget(),this.upime.view.addDomWidget(e),this.activeDomWidget=e,this.activeDomWidgetAdding=!0,fr((function(){t.activeDomWidgetAdding=!1}))},Object.defineProperty(t.prototype,"onlyCheckKanban",{get:function(){return 240*this.scale*this.upime.view.scale<24},enumerable:!1,configurable:!0}),t.prototype.setSelectedCards=function(e){var t,n=this,i=e.filter((function(e){var t=n.cardsMap.get(e.cardId);return t&&n.isCardDisplay(t)}));if(!_e.desktop){var r=new Set(i.map((function(e){return e.cardId})));this.cardsMap.forEach((function(e){r.has(e.id)||e.removeStartEditWidget()}))}if(this.selectedCards=R([],i,!0),this.currentEditor&&(this.currentEditor.supportZindex=0===this.selectedCards.length,null===(t=this.currentEditor)||void 0===t||t.updateProertyEditors()),_e.desktop||this.selectedCards.forEach((function(e){var t=n.cardsMap.get(e.cardId);t&&t.addStartEditWidget(),n.wigetCardCol=e.col})),_e.desktop&&!this.frozedGroupId){if(this.standbyEditingNameCardIndex){var o=this.cardsMap.get(this.standbyEditingNameCardIndex.cardId);null==o||o.textProxy.editor.endStandby()}if(1===this.selectedCards.length&&!this.editingNameCardIndex){var a=this.selectedCards[0];this.standbyEditingNameCardIndex=a;var s=this.cardsMap.get(a.cardId);null==s||s.textProxy.editor.startStandby()}}},t.prototype.setMovingToTargetKanban=function(e){this.movingToTargetKanban&&(this.movingToTargetKanban.movingFromOriginKanban=void 0,this.movingToTargetKanban.adsorptionLine=void 0),this.movingToTargetKanban=e,e&&(e.movingFromOriginKanban=this)},Object.defineProperty(t.prototype,"groupByAttr",{get:function(){var e=this;return this.attributes.find((function(t){return t.id===e.colGroupBy}))||this.attributes.find((function(e){return e.type===gB.radio||e.type===gB.checkbox||e.type===gB.userList}))||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRadio",{get:function(){var e;return(null===(e=this.groupByAttr)||void 0===e?void 0:e.type)===gB.radio},enumerable:!1,configurable:!0}),t.prototype.addChild=function(e){this.cardsMap.set(e.id,e),this.startUpdateGroupTask(),this.upime.updateView()},t.prototype.removeChild=function(e){this.cardsMap.delete(e.id),this.startUpdateGroupTask(),this.upime.updateView()},t.prototype.startUpdateGroupTask=function(){var e=this;this.updateGroupTask||(this.updateGroupTask=fr((function(){e.updateGroup(),e.updateGroupTask=void 0,e.upime.updateView()})))},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y;return{left:t,top:n,right:t+this.size.width,bottom:n+this.size.height,rotate:0}},t.prototype.checkClickName=function(e){var t=this.position,n=t.x,i=t.y,r=(e.x-n)/this.scale;return Ot({x:r,y:(e.y-i)/this.scale},{left:16,right:16+this.nameWidth,top:16,bottom:38})?r-16:null},t.prototype.dealUpdate=function(t){e.prototype.dealUpdate.call(this,t),t.scale&&(this.size.width=this.viewWidth*this.scale,this.size.height=this.viewHeight*this.scale),(t.position||void 0!==t.scale)&&this.updateBorderBox(),t.attributes&&this.cardsMap.forEach((function(e){e.updateViewHeight(),e.updateDisplayUIRows()})),(t.attributes||t.rowGrouyBy||"colGroupBy"in t||t.filters||t.orders)&&(this.updateGroup(),this.updateColGroupByUI()),(t.position||void 0!==t.scale)&&this.updateCardsPosition(),t.cards&&this.findChildren(),t.attributes&&this.onAttributesUpdateCBList.forEach((function(e){return e()})),"name"in t&&this.nameWidget.updateName()},t.prototype.updateGroup=function(){var e=this;this.grids=[];var t=this.groupByAttr;if(t&&(t.type===gB.checkbox||t.type===gB.radio||t.type===gB.userList)){var n=this.sortCards(this.getFiltedCards()),i=n.map((function(e){return e.id})),r=Array.from(this.cardsMap.values()).filter((function(e){return!i.includes(e.id)}));this.hidedCards=r;var o=this.selectedCards.filter((function(e){return n.some((function(t){return t.id===e.cardId}))}));o.length!==this.selectedCards.length&&(this.stopEditCardName(),this.grids=[],this.setSelectedCards(o));var a=new Set;t.type===gB.userList&&this.getDisplayUsers().map((function(t){return e.upime.userManager.getUser(t)})).forEach((function(i){var r=[];n.forEach((function(e){var n,o=e.values.find((function(e){return e.attribute===t.id&&e.type===t.type}));(null===(n=null==o?void 0:o.value)||void 0===n?void 0:n.includes(i.loginName))&&(r.push(e),a.add(e.id))})),e.grids.push({id:i.loginName,label:i.userName,icon:null,color:0,editable:!0,source:"defalut",cards:r})})),t.type!==gB.radio&&t.type!==gB.checkbox||t.typeExtraInfo.options.forEach((function(i){var r=[];n.forEach((function(e){var n,o=e.values.find((function(e){return e.attribute===t.id&&e.type===t.type}));(Array.isArray(null==o?void 0:o.value)&&(null===(n=null==o?void 0:o.value)||void 0===n?void 0:n.includes(i.id))||(null==o?void 0:o.value)===i.id)&&(r.push(e),a.add(e.id))})),e.grids.push(exports.E(exports.E({},i),{cards:r}))}));var s=n.filter((function(e){return!a.has(e.id)}));(s.length||0===this.grids.length)&&this.grids.unshift({id:Qz,label:O("kanban.no.group"),icon:null,color:0,editable:!1,source:"defalut",cards:s}),this.updateColWidgets(),this.grepSelect(),this.grepEditingName(),this.grepMoving(),this.viewWidth=this.getViewWidth(),this.nameWidget.updateName(),this.updateGridUIInfo();var l=this.getViewHeightAndColHeight(),c=l.viewHeight,u=l.colHeight;this.viewHeight=c,this.colHeight=u,this.updateBorderBox(),this.upime.updateBorderBox(),this.onUpdateGroupCBOnceList.forEach((function(e){return e()})),this.onUpdateGroupCBOnceList=[]}},t.prototype.getFiltedCards=function(){var e=this;return Array.from(this.cardsMap.values()).filter((function(t){return e.cards.includes(t.id)})).filter((function(t){return e.isCardDisplay(t)}))},t.prototype.updateColWidgets=function(){var e=this;if(!this.upime.phoneMode){var t=new Map(this.colActionWidgetList.map((function(e){return[e.col.id,e]})));this.colActionWidgetList=[],this.grids.forEach((function(n){if(n.id===Qz||!n.editable)return(i=t.get(n.id))&&i.destory(),void(i&&e.removeInnerWidget(i));if(t.has(n.id))(i=t.get(n.id))&&e.colActionWidgetList.push(i),i&&(i.col=n),t.delete(n.id);else{var i=new pz(e,n);e.addInnerWidget(i),e.colActionWidgetList.push(i)}})),t.forEach((function(t){t.destory(),e.removeInnerWidget(t)}))}var n=new Map(this.groupNameWidgetList.map((function(e){return[e.col.id,e]})));this.groupNameWidgetList=[],this.grids.forEach((function(t){if(n.has(t.id))(i=n.get(t.id))&&e.groupNameWidgetList.push(i),i&&(i.col=t),i&&i.updateName(),n.delete(t.id);else{var i=new yz(e,t);e.addInnerWidget(i),e.groupNameWidgetList.push(i)}})),n.forEach((function(t){t.textProxy.stopEdit(),e.removeInnerWidget(t)}))},t.prototype.updateGridUIInfo=function(){var e=this;this.gridsUIInfo=this.grids.map((function(t,n){var i=t.cards.length,r=ji(i.toString(),{fontSize:16,fontFamily:He}),o=223-r-(t.editable?32:0),a=e.groupNameWidgetList[n];a.updateMaxWidth(o);var s=a.getUsedWidth(),l=0;return t.cards.length&&(l=t.cards.reduce((function(e,t){return e+t.viewHeight}),12*(t.cards.length-1))),{titleWidth:s,countNumber:i,countNumberWidth:r,cardListHeight:l}})),this.updateCardsPosition()},t.prototype.updateCardsPosition=function(){var e=this,t=this.position,n=12*this.scale;this.grids.map((function(i,r){var o=t.x+(16+280*r+16)*e.scale,a=t.y+142*e.scale;i.cards.forEach((function(t){t.dealUpdate({position:{x:o,y:a},scale:e.scale}),a+=t.viewHeight*e.scale+n}))})),this.hidedCards.forEach((function(n){n.dealUpdate({position:exports.E({},t),scale:e.scale})}))},t.prototype.getViewWidth=function(){var e=this.orderWidget.x+this.orderWidget.width+16,t=32+272*this.grids.length+8*this.grids.length+40;return Math.max(t,e)},t.prototype.getViewHeightAndColHeight=function(){var e=Math.max.apply(Math,this.gridsUIInfo.map((function(e){return e.cardListHeight})))+92+(0===this.cards.length?0:12);return{viewHeight:108+e,colHeight:e}},t.prototype.checkSelectRelation=function(t,n){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b;if(this.stable)return null;var E=!this.onlyCheckKanban;if("click"===(null==n?void 0:n.type)){if(this.nameWidget.textProxy.editor.editing){var x=this.getBorderBox(),w={x:t.x-x.left,y:t.y-x.top};return(S=E?this.nameWidget.checkRelation(w):null)?{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{widgetData:S}}}:{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!0}}}}}if(this.editingNameCardIndex&&(P=this.cardsMap.get(this.editingNameCardIndex.cardId))){x=this.getCardBorder(this.editingNameCardIndex);var C={x:(t.x-x.left)/this.scale,y:(t.y-x.top)/this.scale};if(!E||!P.checkPointInName(C))return{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!0}}}}}var S,k=this.groupNameWidgetList.find((function(e){return e.textProxy.editor.editing}));if(k)return x=this.getBorderBox(),w={x:t.x-x.left,y:t.y-x.top},(S=E?k.checkRelation(w):null)?{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{widgetData:S}}}:{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!0}}}}}if("hover"===(null==n?void 0:n.type)||"click"===(null==n?void 0:n.type)){var _=this.upime.getSelectedElements().length>1,T="right"===n.evt.connectType;if(!E)return(R=e.prototype.checkSelectRelation.call(this,t,n))&&!R.metaData&&this.selectedCards.length>0&&!this.editingNameCardIndex?{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!1}}}}:R;var I=_&&T?null:this.checkCard(t);if(I){var P=this.cardsMap.get(I.cardId),N=this.isRadio,M=this.selectedCards.some((function(e){return e.cardId===I.cardId&&(N||e.col===I.col)})),A=this.getCardBorder(I),D={x:A.left,y:A.top},R=null==P?void 0:P.checkDetailRelation(t,M,n,D);if(this.editingNameCardIndex&&this.editingNameCardIndex.cardId===I.cardId&&(N||this.editingNameCardIndex.col===I.col))return(null===(r=null===(i=null==R?void 0:R.metaData)||void 0===i?void 0:i.clickData)||void 0===r?void 0:r.cardName)?exports.E(exports.E({},R),{metaData:{clickData:{cardNameInKanban:exports.E(exports.E({},I),{info:null===(a=null===(o=R.metaData)||void 0===o?void 0:o.clickData)||void 0===a?void 0:a.cardName})}}}):{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!1}}}};var B=n.evt.originEvent,L=B.shiftKey,O=B.metaKey,F=B.ctrlKey;if(P&&(L||O||F))return{transparent:!1,metric:240*P.viewHeight*this.scale*this.scale,metaData:{clickData:{cardInKanban:{index:I,option:{shiftKey:L,metaKey:O,ctrlKey:F}}}}};if(!_&&T&&P&&"click"===(null==n?void 0:n.type))return{transparent:!1,metric:240*P.viewHeight*this.scale*this.scale,metaData:{clickData:{cardInKanbanContext:{index:I,position:n.evt.globalPosition}}}};if(P&&("view"===this.upime.xmode||"laser"===this.upime.xmode))return{transparent:!1,metric:240*P.viewHeight*this.scale*this.scale,metaData:{clickData:{cardTagInKanban:I}}};if(!P)return null;if(R){if(null===(l=null===(s=R.metaData)||void 0===s?void 0:s.clickData)||void 0===l?void 0:l.widgetData)return exports.E(exports.E({},R),{metaData:{clickData:{cardInKanban:{index:I},widgetData:null===(u=null===(c=R.metaData)||void 0===c?void 0:c.clickData)||void 0===u?void 0:u.widgetData}}});if(null===(p=null===(d=R.metaData)||void 0===d?void 0:d.clickData)||void 0===p?void 0:p.cardTag)return exports.E(exports.E({},R),{metaData:{clickData:{cardTagInKanban:I}}});if(void 0!==(null===(f=null===(h=R.metaData)||void 0===h?void 0:h.clickData)||void 0===f?void 0:f.onLink)){var z=this.getCardBorder(I);return exports.E(exports.E({},R),{metaData:{clickData:{onCardLink:{link:(null===(m=this.cardsMap.get(I.cardId))||void 0===m?void 0:m.link)||"",anchor:this.upime.view.getScreenPosition({x:z.right,y:z.top})}}}})}if("view"!==this.upime.xmode&&"laser"!==this.upime.xmode&&!this.frozedGroupId&&void 0!==(null===(g=null===(v=R.metaData)||void 0===v?void 0:v.clickData)||void 0===g?void 0:g.cardName))return exports.E(exports.E({},R),{metaData:{clickData:{cardNameInKanban:exports.E(exports.E({},I),{info:null===(b=null===(y=R.metaData)||void 0===y?void 0:y.clickData)||void 0===b?void 0:b.cardName})}}})}if("view"!==this.upime.xmode&&"laser"!==this.upime.xmode)return{transparent:!1,metric:240*P.viewHeight*this.scale*this.scale,metaData:{clickData:{cardInKanban:{index:I}}}}}var H=T?null:this.checkAddBt(t);if(null!==H)return{transparent:!1,metric:576,metaData:{clickData:{kanbanAddBtIndex:H}}};if(!T&&this.checkGroup(t))return{transparent:!1,metric:4500,metaData:{clickData:{kanbanGroup:!0}}};if(!T&&this.checkConfig(t))return{transparent:!1,metric:2820,metaData:{clickData:{kanbanConfig:!0}}};if("click"===n.type&&this.selectedCards.length>0){if(null==(R=e.prototype.checkSelectRelation.call(this,t,n))?void 0:R.metaData)return R;if(Ot(t,z=this.getGlobalBox()))return{transparent:!1,metric:this.size.width*this.size.height,metaData:{clickData:{kanbanEmptyArea:{position:t,isStopSimpleText:!1}}}}}}return e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.checkAddBt=function(e){if(!this.upime.editable)return null;for(var t=(e.x-this.position.x)/this.scale,n=(e.y-this.position.y)/this.scale,i=0;i<this.gridsUIInfo.length;i++){var r=this.gridsUIInfo[i],o=16+280*i+16,a=o+24;if(t<o)return null;var s=144+r.cardListHeight+(0===r.cardListHeight?0:12);if(t>=o&&t<=a&&n>=s&&n<=s+24)return i}return null},t.prototype.checkCard=function(e){var t=(e.x-this.position.x)/this.scale,n=(e.y-this.position.y)/this.scale;if(n<144)return null;for(var i=0;i<this.grids.length;i++){var r=this.grids[i];if(0!==r.cards.length){var o=16+280*i+16;if(t<o)return null;if(!(t>o+240))for(var a=144,s=0;s<r.cards.length;s++){var l=r.cards[s],c=a,u=c+l.viewHeight;if(n<c)return null;if(!(n>u))return{col:i,cardId:l.id};a+=l.viewHeight+12}}}return null},t.prototype.findCard=function(e){var t=this.checkCard(e);return t&&this.cardsMap.get(t.cardId)||null},t.prototype.checkGroup=function(e){return!!this.upime.editable&&Ot({x:(e.x-this.position.x)/this.scale,y:(e.y-this.position.y)/this.scale},this.getGroupBorderBoxInKanban())},t.prototype.checkConfig=function(e){return!!this.upime.editable&&Ot({x:(e.x-this.position.x)/this.scale,y:(e.y-this.position.y)/this.scale},this.getConfigBorderBoxInKanban())},t.prototype.dealHoverStart=function(t){var n,i=null===(n=t.metaData)||void 0===n?void 0:n.clickData;if(i){var r=i.kanbanAddBtIndex,o=i.cardNameInKanban,a=i.cardTagInKanban,s=i.cardInKanban,l=i.kanbanGroup,c=i.kanbanConfig,u=i.onCardLink,d=i.kanbanEmptyArea,p=i.widgetData;if(p&&this.upime.view.setCursor("pointer",this),void 0!==r){this.hoverInfo.addBt=r,this.upime.updateView(),this.upime.view.setCursor("pointer",this);var h=this.gridsUIInfo[r],f=16+280*r+16,m=144+h.cardListHeight+(0===h.cardListHeight?0:12),v={x:(f+12)*this.scale,y:m*this.scale};return void this.showWidgetTip(this.id,O("kanban.create.card"),v)}if(a||l||u||c)return p||this.upime.view.setCursor("pointer",this),!a||"view"!==this.upime.xmode&&"laser"!==this.upime.xmode||this.addStartEditWidget(a.cardId,a.col),u&&(this.upime.linkHover(!0,u.anchor,u.link),this.hoverCardLink=!0),l&&(this.hoverInfo.config="group"),void(c&&(this.hoverInfo.config="setting"));if(s||o){var g=(null==s?void 0:s.index.cardId)||(null==o?void 0:o.cardId);return void(g&&this.addStartEditWidget(g,null==s?void 0:s.index.col))}if(d)return void(this.wigetCard&&(this.wigetCard.removeStartEditWidget(),this.wigetCard=null,this.wigetCardCol=null))}else this.wigetCard&&(this.wigetCard.removeStartEditWidget(),this.wigetCard=null,this.wigetCardCol=null);return e.prototype.dealHoverStart.call(this,t)},t.prototype.dealHoverEnd=function(){return this.hoverCardLink&&(this.upime.linkHover(!1,{x:0,y:0},""),this.hoverCardLink=!1),this.hoverInfo.addBt=null,this.hoverInfo.config=null,this.upime.updateView(),this.upime.view.setCursor("",this),this.clearWidgetTip(this.id),e.prototype.dealHoverEnd.call(this)},t.prototype.dealClickStart=function(t){var n,i,r,o=null===(n=t.metaData)||void 0===n?void 0:n.clickData;if(o){var a=o.kanbanAddBtIndex,s=o.cardNameInKanban,l=o.cardTagInKanban,c=o.cardInKanban,u=o.kanbanEmptyArea,d=o.kanbanGroup,p=o.kanbanConfig,h=o.onCardLink,f=o.cardInKanbanContext,m=o.widgetData;if(c&&m)return void((v=this.cardsMap.get(c.index.cardId))&&v.dealClickStart(t));if(void 0!==a){var v=this.createCard(a),g=this.upime.getSelectedElements();return 1===g.length&&g[0]===this||this.upime.selectElement(this),this.setSelectedCards([{cardId:v.id,col:a}]),void this.dealHoverEnd()}if(l)return void((v=this.cardsMap.get(l.cardId))&&this.openCardEditor(v));if(s&&this.onStartEditCardName(s),h&&(this.upime.clearSelect(),this.upime.gotoLink(h.link)),f&&this.openContextMenu(f.index,f.position),c){this.upime.getSelectedElements().length>1&&this.upime.clearSelect(),this.currentEditor||this.upime.selectElement(this);var y=c.option||{},b=y.metaKey;if(y.ctrlKey||b){var E=this.isRadio,x=this.selectedCards.find((function(e){return e.cardId===c.index.cardId&&(E||e.col===c.index.col)}));x?this.setSelectedCards(this.selectedCards.filter((function(e){return e!==x}))):this.setSelectedCards(R(R([],this.selectedCards,!0),[exports.E({},c.index)],!1))}else this.setSelectedCards([exports.E({},c.index)]);return void(null===(i=this.currentEditor)||void 0===i||i.updateBorderBox())}if(u){this.stopEditColName(),this.setSelectedCards([]),this.nameWidget.textProxy.stopEdit(),this.stopEditCardName(),null===(r=this.currentEditor)||void 0===r||r.updateBorderBox();var w=u.position;if(u.isStopSimpleText){var C=this.checkSelectRelation(w,{type:"click",evt:{Hits:1,connected:!0,connectType:"left",originEvent:new MouseEvent("click"),position:w,globalPosition:w}});C&&this.dealClickStart(C)}return}if(d){if(this.activeDomWidget&&this.activeDomWidget instanceof rF)return;var S=new rF(this);return this.addActiveDomWidget(S),this.selectedState="group",void _c("cv_kanban_setgroup")}if(p)return void this.openKanbanConfig()}return e.prototype.dealClickStart.call(this,t)},t.prototype.grepSelect=function(){var e=this;if(this.currentEditor){var t=this.isRadio,n=this.selectedCards.filter((function(n){if(t)return e.cards.includes(n.cardId);var i=e.grids[n.col];return null==i?void 0:i.cards.some((function(e){return e.id===n.cardId}))}));n.length!==this.selectedCards.length&&this.setSelectedCards(n)}},t.prototype.grepEditingName=function(){var e=this.editingNameCardIndex;if(e&&!this.isRadio){var t=this.grids[e.col];(null==t?void 0:t.cards.some((function(t){return t.id===e.cardId})))||this.setSelectedCards([])}},t.prototype.grepMoving=function(){var e=this,t=this.isRadio;this.movingCards.every((function(n){if(t)return e.cards.includes(n.cardId);var i=e.grids[n.col];return null==i?void 0:i.cards.some((function(e){return e.id===n.cardId}))}))||(this.movingCards=[],this.adsorptionLine=void 0)},t.prototype.getSelectedCardBoxes=function(){var e=this,t=[];return this.selectedCards.forEach((function(n){e.cardsMap.get(n.cardId)&&t.push(e.getCardBorder(n))})),t},t.prototype.getCardBorder=function(e){var t,n=this.isRadio,i=n?this.grids.findIndex((function(t){return t.cards.some((function(t){return t.id===e.cardId}))})):e.col,r=this.grids[i].cards.findIndex((function(t){return t.id===e.cardId}));if(-1===r)return{left:0,right:0,top:10,bottom:10};for(var o=16+280*i+16-.5,a=o+240+1,s=this.grids[i],l=143.5,c=this.animateCtrl.percent,u=function(e){var t=s.cards[e],r=d.animateCtrl.animateIndexList.some((function(e){return t.id===e.cardId&&(n||e.col===i)})),o=r?t.viewHeight*c:t.viewHeight;l+=o+12},d=this,p=0;p<r;p++)u(p);var h=l+(null===(t=s.cards[r])||void 0===t?void 0:t.viewHeight)+1,f=this.position,m=f.x,v=f.y;return{left:m+o*this.scale,right:m+a*this.scale,top:v+l*this.scale,bottom:v+h*this.scale}},t.prototype.createCard=function(e){var t=this,n={id:this.upime.genID(Za.CARD),name:"",color:this.upime.getInitCardColor(),coverFileId:"",kanbanId:this.id,values:[],position:{x:0,y:0},size:{width:240,height:0},zIndex:this.upime.newMaxZindex()},i=this.grids[0].id===Qz,r=e-(i?1:0),o=this.groupByAttr;this.attributes.forEach((function(i){if(i===o){if(i.type===gB.checkbox){if(!(s=r>=0?i.typeExtraInfo.options[r]:void 0))return;var a={attribute:i.id,type:i.type,value:[s.id]};n.values.push(a)}if(i.type===gB.radio){var s;if(!(s=r>=0?i.typeExtraInfo.options[r]:void 0))return;a={attribute:i.id,type:i.type,value:s.id},n.values.push(a)}if(i.type,gB.checkbox,i.type===gB.userList){var l=t.grids[e].id,c=l===Qz?[]:[l];a={attribute:i.id,type:i.type,value:c},n.values.push(a)}}else{if(void 0===i.deaultValue)return;n.values.push({attribute:i.id,type:i.type,value:i.deaultValue})}}));var a={kanbanId:this.id,index:this.cards.length};return this.upime.kanbanManager.createCard(n,a)},t.prototype.openCardEditor=function(e){return A(this,void 0,void 0,(function(){var t,n=this;return D(this,(function(i){switch(i.label){case 0:return this.upime.isDesktopModal=!0,[4,this.upime.showWindow(gF,{card:e,kanban:this}).catch((function(){})).finally((function(){n.upime.isDesktopModal=!1}))];case 1:return t=i.sent(),e.deleted?(bF(this.upime),[2]):this.cards.includes(e.id)?("string"==typeof t?""===t&&this.onDeleteCard(e):t&&this.onCardValueUpdate(e.id,t,e),[2]):[2]}}))}))},t.prototype.openKanbanConfig=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return this.upime.phoneMode?(this.upime.addToast(O("kanban.usepc.attr")),[2]):(this.upime.isDesktopModal=!0,this.upime.showWindow(ZF,this).finally((function(){e.upime.isDesktopModal=!1})),_c("cv_kanbansettings"),[2])}))}))},t.prototype.onCardValueUpdate=function(e,t,n){t.color&&t.color!==n.color&&this.upime.setInitCardColor(t.color);var i={kanbanId:this.id,index:this.cards.indexOf(e)};this.upime.kanbanManager.updateCard(e,t,i),this.onCardAddUser(t),this.upime.updateView()},t.prototype.onCardAddUser=function(e){var t,n=this.groupByAttr;if((null==n?void 0:n.type)===gB.userList){var i=n.typeExtraInfo.displayUsers,r=null===(t=e.values)||void 0===t?void 0:t.find((function(e){return e.attribute===n.id})),o=((null==r?void 0:r.value)||[]).filter((function(e){return!i.includes(e)}));if(o.length){var a=R(R([],i,!0),o,!0),s=this.attributes.map((function(e){return e.id===n.id&&e.type===gB.userList?exports.E(exports.E({},e),{typeExtraInfo:exports.E(exports.E({},e.typeExtraInfo),{displayUsers:a})}):e}));this.upime.kanbanManager.updateKanban(this,{attributes:s})}}},t.prototype.onDeleteCard=function(e){var t={kanbanId:this.id,index:this.cards.indexOf(e.id)};this.upime.kanbanManager.deleteCard(e.id,t)},t.prototype.onStartEditCardName=function(e){if(e){this.editingNameCardIndex=e;var t=this.cardsMap.get(e.cardId);t&&t.startEditName(e.info.position),this.upime.updateView()}},t.prototype.onRemove=function(){var e,t=this;this.cardsMap.forEach((function(e){t.upime.kanbanManager.addGhostCard(e),e.isGhost=!0})),null===(e=this.unSubUserInfoChange)||void 0===e||e.call(this)},t.prototype.onRestore=function(){this.findChildren(),this.subscribeUserInfoChange()},t.prototype.findChildren=function(){var e=this;R([],this.upime.kanbanManager.getAllGhostCards(),!0).reverse().forEach((function(t){e.cards.includes(t.id)&&(e.addChild(t),t.pareantKanban=e,t.isGhost=!1,t.freshUI(),e.upime.kanbanManager.removeGhostCard(t))})),this.upime.updateView()},t.prototype.updateColGroupByUI=function(){var e,t="".concat(O("kanban.group"),"：").concat(null===(e=this.groupByAttr)||void 0===e?void 0:e.label);this.disPlayColGroupBy=jL(t,110,{fontSize:14}).content},t.prototype.getDisplayConfigUI=function(){return jL(O("kanban.config.label.short"),58,{fontSize:14}).content},t.prototype.clearSelectedState=function(){this.selectedState=void 0,this.upime.updateView()},t.prototype.getGroupBorderBoxInKanban=function(){return{left:143,right:293,top:46,bottom:76}},t.prototype.getConfigBorderBoxInKanban=function(){return{left:16,right:110,top:46,bottom:76}},t.prototype.getAllCardsUserIds=function(){var e=[],t=this.attributes.filter((function(e){return e.type===gB.userList})).map((function(e){return e.id}));return this.cardsMap.forEach((function(n){n.values.forEach((function(n){n.type===gB.userList&&t.includes(n.attribute)&&n.value.forEach((function(t){e.includes(t)||e.push(t)}))}))})),e.sort(),e},t.prototype.getDisplayUsers=function(){var e=this.groupByAttr;if((null==e?void 0:e.type)!==gB.userList)return[];var t=e.typeExtraInfo.displayUsers||[],n=this.getAllCardsUserIds(),i=R([],t,!0);return n.forEach((function(e){i.includes(e)||i.push(e)})),i},t.prototype.subscribeUserInfoChange=function(){var e,t=this;null===(e=this.unSubUserInfoChange)||void 0===e||e.call(this),this.unSubUserInfoChange=this.upime.subscribe("updatedUserInfo",(function(){var e;if((null===(e=t.groupByAttr)||void 0===e?void 0:e.type)===gB.userList){var n=!1;t.grids.forEach((function(e){if(e.id!==Qz){var i=t.upime.userManager.getUser(e.id);i.userName!==e.label&&(n=!0,e.label=i.userName)}})),n&&(t.updateGridUIInfo(),t.upime.updateView())}})),this.unsubs.push(this.unSubUserInfoChange)},t.prototype.selectCard=function(e){var t=R([],this.grids,!0).reverse().findIndex((function(t){return t.cards.some((function(t){return t.id===e.id}))}));if(-1!==t){var n=this.grids.length-t-1;this.setSelectedCards([{col:n,cardId:e.id}])}},t.prototype.getLinkToElement=function(){var e=this.selectedCards[0];return(e?this.cardsMap.get(e.cardId):void 0)||this},t.prototype.openContextMenu=function(e,t){var n,i=this;this.currentEditor||this.upime.selectElement(this),this.setSelectedCards([exports.E({},e)]),null===(n=this.currentEditor)||void 0===n||n.updateBorderBox(),_c("cv_contextmenu");var r=new Kh(this.upime,t,(function(){return i.upime.view.removeContextMenu()}),this.currentEditor);this.upime.view.addContextMenu(r)},t.prototype.dealRectSelectCells=function(e){var t=this;if(Kt(e,this.getBorderBox())){var n=[];this.grids.forEach((function(i,r){i.cards.forEach((function(i){var o={col:r,cardId:i.id},a=t.getCardBorder(o);Kt(e,a)&&n.push(o)}))})),this.setSelectedCards(n)}},t.prototype.stopEditCardName=function(){if(this.editingNameCardIndex){var e=this.cardsMap.get(this.editingNameCardIndex.cardId);this.editingNameCardIndex=void 0,null==e||e.stopEditName()}},t.prototype.stopEditColName=function(){var e=this.groupNameWidgetList.find((function(e){return e.textProxy.editor.editing}));e&&e.textProxy.stopEdit()},t.prototype.handleCardEdtingNameCtrlEvt=function(e){if(!this.editingNameCardIndex)return!1;var t=this.cardsMap.get(this.editingNameCardIndex.cardId);if(!t)return!1;var n=this.getCardBorder(this.editingNameCardIndex),i={x:(e.position.x-n.left)/this.scale,y:(e.position.y-n.top)/this.scale};if(t.textProxy.editor.selecting){var r={x:(e.position.x-n.left)/this.scale-16,y:(e.position.y-n.top)/this.scale-16};return e.isEnd?t.textProxy.editor.selectEnd(r):t.textProxy.editor.onSelect(r),!0}var o=this.checkCard(e.position),a=this.isRadio;if(!o||o.cardId!==this.editingNameCardIndex.cardId||!a&&o.col!==this.editingNameCardIndex.col)return!1;var s=t.checkPointInName(i);return!(!e.isStart||!s)&&(r={x:(e.startPosition.x-n.left)/this.scale-16,y:(e.startPosition.y-n.top)/this.scale-16},t.textProxy.editor.startSelect(r),!0)},t.prototype.onFrozed=function(){(this.movingCards.length>0||this.movingToTargetKanban)&&(this.movingCards=[],this.setMovingToTargetKanban(void 0),this.updateBorderBox(),this.upime.updateView())},t.prototype.addStartEditWidget=function(e,t){var n=this.cardsMap.get(e);n&&(this.wigetCard&&(this.wigetCard.removeStartEditWidget(),this.wigetCard=null,this.wigetCardCol=null),n.addStartEditWidget(),this.wigetCard=n,this.wigetCardCol=null!=t?t:null)},t.prototype.isCardDisplay=function(e){var t=this.abledFilters;return 0===t.length||t.every((function(t){var n;if(!t.targetProp||!t.value)return!0;var i=t.filterType,r=t.targetProp;if("cardName"===r){var o=e.name;return i===BB.CONTAIN?o.includes(t.value):o===t.value}var a=null===(n=e.values.find((function(e){return e.attribute===r.id})))||void 0===n?void 0:n.value;switch(r.type){case gB.radio:return a===t.value;case gB.checkbox:case gB.text:return!0;case gB.userList:if(i===BB.CONTAIN){if(yt.exports.isArray(a))for(var s=0;s<a.length;s++){var l=a[s];if(t.value.includes(l))return!0}return!1}if(yt.exports.isArray(a)&&a.length===t.value.length){for(s=0;s<a.length;s++)if(l=a[s],!t.value.includes(l))return!1;return!0}return!1;case gB.timeRange:return("timeRangeEnd"===t.timeRangeExtra?null==a?void 0:a[1]:null==a?void 0:a[0])===t.value;case gB.richText:var c=a;return i===BB.CONTAIN?null==c?void 0:c.includes(t.value):c===t.value;case gB.fileList:if(i===BB.CONTAIN){if(yt.exports.isArray(a))for(s=0;s<a.length;s++)if((u=iH(a[s]))&&u.includes(t.value))return!0;return!1}if(yt.exports.isArray(a))for(s=0;s<a.length;s++){var u;if((u=iH(a[s]))&&u===t.value)return!0}return!1}}))},t.prototype.sortCards=function(e){var t=this,n=R([],e,!0);return n.sort((function(e,n){return t.cards.indexOf(e.id)-t.cards.indexOf(n.id)})),this.activeOrders.forEach((function(e){var i=e.targetProp;if(i){var r=function(t){return"asc"===e.value||0===t?t:-t};if("cardName"!==i){var o=t.attributes.find((function(e){return e.id===i.id}));if(o)switch(o.type){case gB.radio:return void n.sort((function(e,t){var n,i,a=null===(n=e.values.find((function(e){return e.attribute===o.id})))||void 0===n?void 0:n.value,s=null===(i=t.values.find((function(e){return e.attribute===o.id})))||void 0===i?void 0:i.value,l=o.typeExtraInfo.options.findIndex((function(e){return e.id===a})),c=o.typeExtraInfo.options.findIndex((function(e){return e.id===s}));return-1===l&&-1===c?0:-1===l?1:-1===c?-1:r(nH(-1===l?void 0:l,-1===c?void 0:c))}));case gB.checkbox:return;case gB.text:case gB.richText:return void n.sort((function(e,t){var n,i,a=(null===(n=e.values.find((function(e){return e.attribute===o.id})))||void 0===n?void 0:n.value)||"",s=(null===(i=t.values.find((function(e){return e.attribute===o.id})))||void 0===i?void 0:i.value)||"";return a||s?a?s?r(Jz(a,s)):-1:1:0}));case gB.fileList:return void n.sort((function(e,t){var n,i,a=(null===(n=e.values.find((function(e){return e.attribute===o.id})))||void 0===n?void 0:n.value)||[],s=(null===(i=t.values.find((function(e){return e.attribute===o.id})))||void 0===i?void 0:i.value)||[],l=a.map((function(e){return iH(e)})).join(""),c=s.map((function(e){return iH(e)})).join("");return l||c?l?c?r(Jz(l,c)):-1:1:0}));case gB.userList:return void n.sort((function(e,n){var i,a,s=(null===(i=e.values.find((function(e){return e.attribute===o.id})))||void 0===i?void 0:i.value)||[],l=(null===(a=n.values.find((function(e){return e.attribute===o.id})))||void 0===a?void 0:a.value)||[],c=s.map((function(e){return t.upime.userManager.getUser(e).userName})).join(""),u=l.map((function(e){return t.upime.userManager.getUser(e).userName})).join("");return c||u?c?u?r(Jz(c,u)):-1:1:0}));case gB.timeRange:return void n.sort((function(t,n){var i,a,s=null===(i=t.values.find((function(e){return e.attribute===o.id})))||void 0===i?void 0:i.value,l=null===(a=n.values.find((function(e){return e.attribute===o.id})))||void 0===a?void 0:a.value,c="timeRangeEnd"===e.timeRangeExtra?null==s?void 0:s[1]:null==s?void 0:s[0],u="timeRangeEnd"===e.timeRangeExtra?null==l?void 0:l[1]:null==l?void 0:l[0];return _t.isNil(c)&&_t.isNil(u)?0:_t.isNil(c)?1:_t.isNil(u)?-1:r(nH(c,u))}))}}else n.sort((function(e,t){return e.name||t.name?e.name?t.name?r(Jz(e.name,t.name)):-1:1:0}))}})),n},t}(oy);function Jz(e,t){if(e===t)return 0;var n=""===e,i=""===t;if(n&&!i)return 1;if(!n&&i)return-1;var r=eH(e),o=eH(t);if(r&&!o)return-1;if(!r&&o)return 1;var a=function(e,t){if(!e&&!t)return 0;if(!e)return 1;if(!t)return-1;for(var n=Math.min(e.length,t.length),i=0;i<n;i++){if(e[i]>t[i])return 1;if(e[i]<t[i])return-1}return e.length>t.length?1:e.length<t.length?-1:0}(r,o);if(0!==a)return a;var s=tH(e),l=tH(t);return s&&!l?-1:!s&&l||e.localeCompare(t,"zh-CN")>0?1:-1}var $z=new Map;function eH(e){if($z.has(e))return $z.get(e)||null;var t=/^(?:(?:(?:[\(\[<（【]?)(\d+)(?:[\)\]>）】]?))[\._、-]?)+/.exec(e);if(t){var n=t[0].split(/[\._、-]/g).map((function(e){return e.replace(/[\(\[<（【\)\]>）】]/g,"")})).map((function(e){return parseInt(e)}));return $z.set(e,n),n}return $z.set(e,null),null}function tH(e){return/^[a-zA-Z]/.test(e)}function nH(e,t){return e===t?0:_t.isNil(e)?1:_t.isNil(t)?-1:e-t}function iH(e){return e.fileId?rH(e.name):rH(e.append.name)}function rH(e){if(!e)return e;var t=e.lastIndexOf(".");return-1===t?e:e.slice(0,t)}var oH=_D("baibanquanping","white"),aH=function(){function e(e){this.card=e,this.x=210,this.y=0,this.width=24,this.height=24,this.name="cardStartEdit",this.disabled=!1,this.on=!1}return e.prototype.getY=function(){return this.card.viewHeight-6-4-24},e.prototype.render=function(){var e=this,t=this.getY();Na((function(n){n.beginFill(9540508),n.drawRoundedRect(e.x,t,e.width,e.height,4)})),Oa({src:oH,x:this.x+4,y:t+4,width:16,height:16})},e.prototype.checkRelation=function(e,t){var n=this.getY();return Ot(e,{left:this.x,top:n,right:this.x+this.width,bottom:n+this.height})?{name:this.name}:null},e.prototype.dealClick=function(){this.card.pareantKanban&&this.card.pareantKanban.openCardEditor(this.card)},e.prototype.dealHoverStart=function(){},e.prototype.dealHoverEnd=function(){},e.prototype.getHoverPoint=function(){return{x:0,y:0}},e}(),sH=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.renderer=LB,i.elementType=Za.CARD,i.onValueUpdateCBList=[],i._viewHeight=0,i.isGhost=!1,i.name="",i.color=0,i.coverFileId="",i.kanbanId=null,i.values=[],i.displayUIRows=[],i.renderUserList=[],i.startEditWidget=null,i.subscribeUserInfoChange(),i.textProxy=new vz(i.upime,{getPosition:function(){var e=i.position.x,t=i.position.y;if(i.pareantKanban){var n=i.pareantKanban.editingNameCardIndex||i.pareantKanban.standbyEditingNameCardIndex;if(n){var r=i.pareantKanban.getCardBorder(n);e=r.left,t=r.top}}return{x:e+=16*i.scale,y:t+=16*i.scale}},getScale:function(){return i.scale},onEditEnd:function(e){var t;if(!i.deleted&&e!==i.name)if(i.pareantKanban){var n=i.pareantKanban.cards.indexOf(i.id);i.upime.kanbanManager.updateCard(i.id,{name:e},{index:n,kanbanId:i.pareantKanban.id})}else null===(t=i.currentEditor)||void 0===t||t.updateProperty({name:e})},onUpdate:function(){var e;i.deleted||(i.updateViewHeight(),null===(e=i.pareantKanban)||void 0===e||e.updateGroup())},onStandbyToEditing:function(){i.pareantKanban&&i.pareantKanban.standbyEditingNameCardIndex&&(i.pareantKanban.editingNameCardIndex=exports.E(exports.E({},i.pareantKanban.standbyEditingNameCardIndex),{info:{position:{x:0,y:0}}}),i.pareantKanban.standbyEditingNameCardIndex=void 0)}}),i.textProxy.updateConfig({inline:!1,style:{fontSize:14,fontWeight:"bold"},width:208,lineHeight:22,color:"#0c1024"}),i}return P(t,e),Object.defineProperty(t.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(e){this._viewHeight=e,this.size.height=e*this.scale,this.updateBorderBox()},enumerable:!1,configurable:!0}),t.prototype.checkMounted=function(){return!this.isGhost&&!this.isHideByFilter&&e.prototype.checkMounted.call(this)},Object.defineProperty(t.prototype,"isSupportSelected",{get:function(){return!1===this.isGhost},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportCopy",{get:function(){return!1===this.isGhost},enumerable:!1,configurable:!0}),t.prototype.addStartEditWidget=function(){if(!this.startEditWidget){var e=new aH(this);this.addInnerWidget(e),this.startEditWidget=e}},t.prototype.removeStartEditWidget=function(){this.startEditWidget&&(this.removeInnerWidget(this.startEditWidget),this.startEditWidget=null)},t.prototype.dealUpdate=function(t){var n,i=t.kanbanId===this.kanbanId;if(e.prototype.dealUpdate.call(this,t),"kanbanId"in t&&!i&&(this.pareantKanban&&this.pareantKanban.removeChild(this),t.kanbanId)){var r=this.upime.elementManager.getElementById(t.kanbanId);r&&r.elementType===Za.KANBAN?(r.addChild(this),this.pareantKanban=r):this.toGhost()}"name"in t&&this.updateName(),("kanbanId"in t||t.values)&&this.updateDisplayUIRows(),("kanbanId"in t||t.values||"coverFileId"in t||"name"in t)&&(this.updateViewHeight(),null===(n=this.pareantKanban)||void 0===n||n.updateGroup()),(t.scale||t.size)&&this.updateSize(),(t.position||void 0!==t.scale)&&(this.updateBorderBox(),this.isHideByFilter&&this.updateGlobalBorderBox()),t.values&&this.onValueUpdateCBList.forEach((function(e){return e()}))},t.prototype.checkVisible=function(t){return!this.kanbanId&&e.prototype.checkVisible.call(this,t)},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y;return{left:t,top:n,right:t+this.size.width,bottom:n+this.size.height,rotate:0}},t.prototype.updateSize=function(){this.size.width=240*this.scale,this.size.height=this.viewHeight*this.scale},Object.defineProperty(t.prototype,"displayRows",{get:function(){var e,t=this;return((null===(e=this.pareantKanban)||void 0===e?void 0:e.attributes)||[]).filter((function(e){return e.visiable})).filter((function(e){var n=t.values.find((function(t){return t.attribute===e.id&&t.type===e.type}));return!!(null==n?void 0:n.value)&&(e.type===gB.radio?e.typeExtraInfo.options.find((function(e){return e.id===n.value})):e.type===gB.userList?n.value.length>0:e.type===gB.timeRange?n.value[0]||n.value[1]:e.type===gB.fileList?n.value.length>0:e.type===gB.richText&&n.value)}))},enumerable:!1,configurable:!0}),t.prototype.updateName=function(){this.textProxy.setContent(this.name)},t.prototype.getTitleHeight=function(){var e;return(null===(e=this.textProxy.renderData)||void 0===e?void 0:e.height)||22},t.prototype.updateViewHeight=function(){var e=this,t=36;t+=this.getTitleHeight();var n=this.displayRows,i=n.filter((function(e){return"defalut"===e.source})),r=n.filter((function(e){return"custom"===e.source}));i.length>0&&(t+=16,i.forEach((function(n){t+=e.getOptionHeight(n)})),t+=4*(i.length-1)),r.length>0&&(t+=16,t+=20*r.length,t+=4*(r.length-1)),this.viewHeight=t},t.prototype.getOptionHeight=function(e){var t;if(e.type===gB.userList){var n=this.displayUIRows.find((function(t){return t.id===e.id})),i=(null===(t=null==n?void 0:n.users)||void 0===t?void 0:t.length)||1;return 20*i+4*(i-1)}return 24},t.prototype.updateDisplayUIRows=function(){var e=this;this.displayUIRows=this.displayRows.map((function(t){var n=[],i=void 0,r=t.label,o=0,a=186;if("custom"===t.source){var s=jL(r,84,{fontSize:12,fontFamily:He});a=184-(o=Vi(r="".concat(s.content,":")))}switch(t.type){case gB.radio:n.push.apply(n,e.getRadioUICell(t.id,t.typeExtraInfo.options,a));break;case gB.userList:i=e.getUserListUICell(t.id);break;case gB.timeRange:n.push.apply(n,e.getTimeRangeUICell(t.id));break;case gB.fileList:n.push.apply(n,e.getFileListUICell(t.id));case gB.richText:n.push.apply(n,e.getRichTextUICell(t.id))}return"defalut"===t.source?{cells:n,users:i,source:"default",id:t.id}:{cells:n,users:i,source:"custom",displayLabel:r,labelWidth:o,id:t.id}})),this.saveUserRenderInfo()},t.prototype.checkDetailRelation=function(e,t,n,i){for(var r=i||this.position,o={x:(e.x-r.x)/this.scale,y:(e.y-r.y)/this.scale},a=0,s=this.innerWidgets;a<s.length;a++){var l=s[a].checkRelation(o,n);if(l)return{transparent:!1,metric:-1,metaData:{clickData:{widgetData:l}}}}if("click"===(null==n?void 0:n.type)&&2===n.evt.Hits){var c=!1;if(Ot(o,{left:0,right:240,top:0,bottom:8})&&(c=!0),Ot(o,{left:0,right:240,top:16+this.getTitleHeight(),bottom:this.viewHeight})&&(c=!0),c)return{transparent:!1,metric:240*this.viewHeight*this.scale*this.scale,metaData:{clickData:{cardTag:!0}}}}return t&&this.upime.editable&&"click"===(null==n?void 0:n.type)&&this.checkPointInName(o)?{transparent:!1,metric:240*this.viewHeight*this.scale*this.scale,metaData:{clickData:{cardName:{position:o}}}}:this.checkPointInTag(o)?{transparent:!1,metric:240*this.viewHeight*this.scale*this.scale,metaData:{clickData:{cardTag:!0}}}:this.checkLink(o)?{transparent:!1,metric:-1,metaData:{clickData:{onLink:!0}}}:null},t.prototype.checkLink=function(e){return!!this.link&&Ot(e,Bt(this.getLinkRect(this.upime.view.scale)))},t.prototype.checkPointInName=function(e){return Ot(e,{left:16,right:224,top:8,bottom:16+this.getTitleHeight()})},t.prototype.checkPointInTag=function(e){var t,n=16+this.getTitleHeight(),i=this.displayUIRows,r=i.filter((function(e){return"default"===e.source})),o=i.filter((function(e){return"custom"===e.source}));r.length>0&&(n+=16);for(var a=0;a<r.length;a++){if((m=r[a]).cells.length){var s=n+24;if(e.y>=n&&e.y<=s){for(var l=38,c=0;c<m.cells.length;c++){var u=l+(v=m.cells[c]).width;if(e.x>=l&&e.x<=u)return!0;l+=v.width+4}return!1}}if(null===(t=m.users)||void 0===t?void 0:t.length)for(var d=0;d<m.users.length;d++){var p=m.users[d],h=n+28*d;if(s=h+20,e.y<h)break;if(!(e.y>s))for(l=38,c=0;c<p.length;c++){var f=p[c];if(u=f.width+l,e.x>=l&&e.x<=u)return!0;l+=f.width+8}}n+=this.getOptionHeight(this.displayRows[a]),a<r.length-1&&(n+=4)}for(n+=12,a=0;a<o.length;a++){var m;if("custom"===(m=o[a]).source){if(m.cells.length&&(s=n+20,e.y>=n&&e.y<=s)){for(l=32+m.labelWidth,c=0;c<m.cells.length;c++){var v;if(u=l+(v=m.cells[c]).width,e.x>=l&&e.x<=u)return!0;l+=v.width+4}return!1}n+=24}}},t.prototype.getRadioUICell=function(e,t,n){var i,r=null===(i=this.values.find((function(t){return t.attribute===e&&t.type===gB.radio})))||void 0===i?void 0:i.value,o=t.find((function(e){return e.id===r}));if(!o)return[];var a=jL(o.label,n-16,{fontSize:12,fontFamily:He});return[{label:a.content,width:a.width+16,bgColor:o.color}]},t.prototype.getUserListUICell=function(e){var t,n={fontSize:12,fontFamily:He},i=null===(t=this.values.find((function(t){return t.attribute===e&&t.type===gB.userList})))||void 0===t?void 0:t.value;if(!i||0===i.length)return[];for(var r=[[]],o=0,a=0;a<i.length;a++){var s=i[a],l=this.upime.userManager.getUser(s),c=24;l.userName?c+=ji(l.userName,n):c+=36;var u=l.avatorSource;u||(u=tr(l.avatarUrl),l.avatorSource=u),l.avatarUrl&&er(u);var d={label:l.userName,width:c,noName:!l.userName,ava:u,loginName:l.loginName};if(o+c>186){if(1!==r.length){if(0==i.length-a){if((p=186-o-20-4)<=0)break;d.noName||(h=jL(d.label,p,n),d.label=h.content,d.width=p+20+4),r[r.length-1].push(d)}break}if(d.noName)r.push([d]);else{var p=162,h=jL(d.label,p,n);d.label=h.content,d.width=h.width+20+4,r.push([d])}o=0}else r[r.length-1].push(d);o+=d.width+8,r=r.filter((function(e){return e.length}))}var f=i.length-r.flat().length;if(0!==f){var m=r[r.length-1],v=m[m.length-1];f=Math.min(999,f);var g="+".concat(f),y=ji(g,n)+8,b=186-m.reduce((function(e,t,n){return e+(n===m.length-1?0:t.width)}),0),E=b-y-16-20-4;if(E<=0||v.noName)m.pop(),f++,y=ji(g="+".concat(f),n)+8;else{var x=jL(v.label,E,n);v.label=x.content,v.width=x.width+20+4}d={label:g,width:y,noName:!1,restCount:!0},r[r.length-1].push(d)}return r.filter((function(e){return e.length}))},t.prototype.getTimeRangeUICell=function(e){var t,n=null===(t=this.values.find((function(t){return t.attribute===e&&t.type===gB.timeRange})))||void 0===t?void 0:t.value;if(!n||!n[0]&&!n[1])return[];var i=n,r=i[0],o=i[1],a=tO(r),s=tO(o),l="--";return a&&s?l="".concat(a," ~ ").concat(s):a?l="".concat(a," ").concat(O("card.attr.startendtime.start.short")):s&&(l="".concat(s," ").concat(O("card.attr.startendtime.end.short"))),[{label:l,width:ji(l,{fontSize:12,fontFamily:He})}]},t.prototype.getFileListUICell=function(e){var t,n=null===(t=this.values.find((function(t){return t.attribute===e&&t.type===gB.fileList})))||void 0===t?void 0:t.value,i="".concat(null==n?void 0:n.length," ").concat(O("card.attr.attachment"));return[{label:i,width:ji(i,{fontSize:12,fontFamily:He})}]},t.prototype.getRichTextUICell=function(e){var t,n=null===(t=this.values.find((function(t){return t.attribute===e&&t.type===gB.richText})))||void 0===t?void 0:t.value;if(!n)return[];var i=n.split(/\n/g).filter(Boolean);if(!(n=i[0]))return[];var r=jL(n,186,{fontSize:12,fontFamily:He});return[{label:r.content,width:r.width}]},t.prototype.saveUserRenderInfo=function(){var e=this;this.renderUserList=[],this.displayUIRows.forEach((function(t){var n;null===(n=t.users)||void 0===n||n.forEach((function(t){t.forEach((function(t){var n=t.loginName;n&&e.renderUserList.push({label:t.label,ava:t.ava,loginName:n})}))}))}))},t.prototype.onRemove=function(){var e;this.pareantKanban&&this.pareantKanban.removeChild(this),null===(e=this.unSubUserInfoChange)||void 0===e||e.call(this),this.textProxy.stopEdit(),this.textProxy.editor.endStandby(),this.removeStartEditWidget()},t.prototype.onRestore=function(){var e;if(this.kanbanId){var t=this.upime.elementManager.getElementById(this.kanbanId);t&&t.addChild(this)}this.subscribeUserInfoChange(),this.updateDisplayUIRows(),this.updateViewHeight(),null===(e=this.pareantKanban)||void 0===e||e.updateGroup(),this.upime.updateView()},t.prototype.subscribeUserInfoChange=function(){var e,t=this;null===(e=this.unSubUserInfoChange)||void 0===e||e.call(this),this.unSubUserInfoChange=this.upime.subscribe("updatedUserInfo",(function(){var e;t.renderUserList.some((function(e){return t.upime.userManager.getUser(e.loginName).userName!==e.label}))&&(t.updateDisplayUIRows(),t.updateViewHeight(),null===(e=t.pareantKanban)||void 0===e||e.updateGroup(),t.upime.updateView())})),this.unsubs.push(this.unSubUserInfoChange)},t.prototype.toGhost=function(){this.upime.kanbanManager.addGhostCard(this),this.isGhost=!0,this.pareantKanban=void 0},t.prototype.freshUI=function(){this.updateSize(),this.updateDisplayUIRows(),this.updateViewHeight(),this.updateBorderBox()},Object.defineProperty(t.prototype,"isSupportFrame",{get:function(){return!Boolean(this.kanbanId)},enumerable:!1,configurable:!0}),t.prototype.getLinkRect=function(t){if(!this.pareantKanban)return e.prototype.getLinkRect.call(this,t);var n=e.prototype.getLinkRect.call(this,t),i=n.width/this.pareantKanban.scale;return{x:240-(i+1),y:0,width:i,height:n.height/this.pareantKanban.scale}},t.prototype.startEditName=function(e){var t={x:e.x-16,y:e.y-16};this.textProxy.startEdit({position:t}),this.removeStartEditWidget()},t.prototype.stopEditName=function(){this.textProxy.stopEdit()},Object.defineProperty(t.prototype,"isHideByFilter",{get:function(){return!!this.pareantKanban&&!this.pareantKanban.isCardDisplay(this)},enumerable:!1,configurable:!0}),t}(oy),lH=function(e){var t=js.value;t.viewbox;var n=t.addLoadingSource,i=t.exportType,r=e.renderFlow,o=e.position,a=e.size,s=e.titleHeight,l=e.scale,c=e.scrollTop,u=e.docContentEditor,d=new Set,p=s*l,h=a.width*l,f=a.height*l+p,m=h/480;function v(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i.node,o=i.renderFlows,s=r.position;r.borderSize;var l=r.moving,u=l;if(l?d.add(r):d.has(r.parent)&&(d.add(r),u=!0),s.y>c+a.height)break;u?(fa({alpha:.3}),r.render(),ma()):r.render(),o&&o.forEach(v)}}yf(e,!u.hideSelectRect);var g=[["M",h,0],["L",h,f],["L",0,f],["L",0,0],["Z"]];fa({x:o.x,y:o.y}),za([new Sa(g)]),function(){fa({scaleX:m,scaleY:m}),Na((function(e){e.clear(),e.beginFill(16119542),e.drawRect(0,0,480,26),e.endFill(),e.lineStyle(1,15527150),e.moveTo(0,25.5),e.lineTo(480,25.5)}));var t=_D("wendangbiaotitubiao");t.loaded?Oa({src:t,x:8,y:3,width:20,height:20}):n&&n(t),Ra(e.useMemo("nameText",(function(){return{text:e.name,textWidth:406,lineHeight:18,fontSize:10,lineClamp:1,textOverflow:"ellipse",fontFamily:He}}),[e.name]),{x:36,y:4,fill:"#0C1024"}),e.maxBtn.render(),ma()}(),function(){if(fa({x:0,y:s*l,scaleX:l,scaleY:l}),Na((function(e){e.beginFill(16777215),e.drawRect(0,0,a.width,a.height)})),za([new wa({x:0,y:0,width:a.width,height:a.height})]),fa({y:-c}),v(r),e.hoverBtn.render(),u.moveBlockData){var t=u.moveBlockData,n=t.parentNode,i=t.childIndex;if(void 0!==n&&void 0!==i){var o,d,p;"root"===n.nodeTag?(o=40,p=n.borderSize.width-40-40):(o=n.position.x+n.indentWidth,p=n.borderSize.width-n.indentWidth);var h=n.children[i-1];if(h)d=h.position.y+h.treeHeight+4;else{var f=n.children[i];d=f?f.position.y:n.position.y+n.treeHeight+4}Na((function(e){e.lineStyle(2,6134012),e.moveTo(o,d),e.lineTo(o+p,d)}))}}ma(),ma()}(),fa({stroke:u.editing&&!i?"#5798F2":"#D8D8D8",lineWidth:2*m}),Ta(g),ma(),ma(),ma()},cH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="docTextColor",t.renderer=mE,t.couldAffectGroup=!1,t}return P(t,e),t.prototype.getHighLight=function(){return this.element.currentStyle.highLight||null},t.prototype.changeHighLight=function(e){this.onSetRichStyle({highLight:e})},t.prototype.slideChangeHighLight=function(e,t){this.slideSetRichStyle({highLight:e},t)},t.prototype.getColor=function(){return this.element.currentStyle.color},t.prototype.getColorPalettes=function(){return this.editor.upime.userManager.userPalette},t.prototype.changeColor=function(e){this.onSetRichStyle({color:e})},t.prototype.slideChangeColor=function(e,t){this.slideSetRichStyle({color:e},t)},t.prototype.onSetRichStyle=function(e){this.element.setRichStyle(e)},t.prototype.slideSetRichStyle=function(e,t){this.element.slideSetRichStyle(e,t)},Object.defineProperty(t.prototype,"available",{get:function(){return this.element.editing},enumerable:!1,configurable:!0}),t}(ay),uH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="docTextStyle",t.renderer=aA,t.couldAffectGroup=!1,t}return P(t,e),Object.defineProperty(t.prototype,"canAddAnchor",{get:function(){return this.element.canAddAnchor},enumerable:!1,configurable:!0}),t.prototype.getTextPropertyStatus=function(e){return this.element.getTextPropertyStatus(e)},t.prototype.addAnchorLink=function(){this.element.addAnchorLink()},t.prototype.toggleTextStyleProperty=function(e){this.element.toggleTextStyleProperty(e)},Object.defineProperty(t.prototype,"available",{get:function(){return this.element.editing},enumerable:!1,configurable:!0}),t}(ay),dH=function(e){Kd(e);var t=e.element.element,n=e.viewbox;if(t.docContentEditor.moveBlockData){var i=n.left,r=n.top,o=n.scale,a=t.position,s=t.titleHeight,l=t.scale,c=t.scrollTop,u=t.docContentEditor.moveBlockData,d=u.cursorPoint,p=u.moveSnippetSource,h=u.moveSnippetSize;fa({x:(a.x+d.x*l-i)*o,y:(a.y+(d.y-c+s)*l-r)*o+20}),Oa(exports.E({src:p},h)),ma()}},pH={option_list:"option_list_2fVIE",option_item:"option_item_2NQRV",active:"active_1pwgj",option_icon:"option_icon_18fZs",option_text:"option_text_4J4Mz",select_icon:"select_icon_2CJRU",node_menu:"node_menu_2TnQY",split_line:"split_line_Tjx6K",add:"add_28H9H",btn_group:"btn_group_3uY4M",type:"type_3r3TJ",btns:"btns_3tk0H",btn:"btn_1QjMZ",btn_icon:"btn_icon_WL9f8",btn_bar:"btn_bar_3nYM8",btn_name:"btn_name_1sj6v",node_type_select:"node_type_select_1f7cC",types:"types_2TAh-",type_icon:"type_icon_3nQj_",selected:"selected_2_WFP",node_align_btn:"node_align_btn_1xYq2",align_option:"align_option_1bkez",disabled:"disabled_Mm6ss",right_icon:"right_icon_1Tg4P",icon:"icon_LcPRG",text:"text_3sB8Z",align_option_group:"align_option_group_2NnKY",node_align_menu:"node_align_menu_2NACD",hover_style:"hover_style_3dBbz"},hH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="NodeTypeSelect",t.renderer=mH,t.couldAffectGroup=!1,t}return P(t,e),t.prototype.getCurrentType=function(){for(var e="rawText",t=0,n=this.element.selectedNodes;t<n.length;t++){var i=n[t];if("text"===i.nodeTag){var r=i.textStyle;e="title"===r.type?"h".concat(r.level):r.type;break}}return e},t.prototype.getActiveTypes=function(){for(var e,t,n=0,i=this.element.selectedNodes;n<i.length;n++){var r=i[n];if("text"===r.nodeTag){var o=r.textStyle;if(null!==e){var a="title"===o.type?"h".concat(o.level):o.type;void 0===e?e=a:e!==a&&(e=null)}!1!==t&&(t="title"===o.type&&null!==o.index||"orderedList"===o.type)}}var s=[];return e&&s.push(e),t&&s.push("orderedList"),s},t.prototype.selectType=function(e){this.element.selectNodeType(e)},t.prototype.unselectType=function(e){this.element.unSelectNodeType(e)},Object.defineProperty(t.prototype,"available",{get:function(){return this.element.editing},enumerable:!1,configurable:!0}),t}(ay),fH=[["rawText","Hwenben","bigDoc.nodeType.rawText"],["h1","H1","bigDoc.nodeType.h1"],["h2","H2","bigDoc.nodeType.h2"],["h3","H3","bigDoc.nodeType.h3"],["orderedList","youxuliebiao","bigDoc.nodeType.orderedList"],["list","wuxuliebiao","bigDoc.nodeType.list"]],mH=function(t){var n=t.propEditor,i=W().getUpimeTrans,r=e.useContext(xl).upime,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u=n.getCurrentType(),d=n.getActiveTypes(),p=(fH.find((function(e){return e[0]===u}))||fH[0])[1],h="phone"===n.editor.phoneToolbarMode&&r.phoneMode;return e.createElement("div",{className:pH.color_editor,ref:c,onPointerDown:ie},e.createElement(Dl,{placement:"top",content:i("text.style"),rootClass:Ml.cm_item},e.createElement("div",{className:Ml.icon_box,onClick:l},e.createElement(ul,{className:j(pH.editorBtn)},e.createElement(hl,{icon:p})))),!a&&e.createElement(xh,{align:"left",forceTop:h,selfAdjust:!0},e.createElement("div",{className:pH.option_list},fH.map((function(t){var r=t[0],o=t[1],a=t[2],l=d.includes(r);return e.createElement("div",{className:j(pH.option_item,l&&pH.active),key:r,onClick:function(){l?n.unselectType(r):n.selectType(r),s(!0)}},e.createElement(hl,{className:pH.option_icon,icon:o}),e.createElement("div",{className:pH.option_text},i(a)),l&&e.createElement(hl,{className:pH.select_icon,icon:"dagou-quxiaoyuansuxuanze"}))})))))};function vH(t){var n=t.element,i=t.upime,r=n.element.docContentEditor,o="";return r.editing?r.toolbarCtrl.toolbarData&&(o=r.toolbarCtrl.toolbarData.id):o="not_editing",o?e.createElement(Eb,{key:o,element:n,upime:i}):null}var gH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="textAlign",t.renderer=$M,t.couldAffectGroup=!1,t}return P(t,e),Object.defineProperty(t.prototype,"ha",{get:function(){var e;return(null===(e=this.element.selectedNodes[0])||void 0===e?void 0:e.ha)||"left"},enumerable:!1,configurable:!0}),t.prototype.setHa=function(e){this.element.setSelectedHorizAlign(e)},Object.defineProperty(t.prototype,"available",{get:function(){return this.element.editing},enumerable:!1,configurable:!0}),t}(ay),yH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=ZM,t}return P(t,e),t}(gH),bH=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propertyName="nodeDelete",t.renderer=EH,t.couldAffectGroup=!1,t}return P(t,e),t.prototype.deleteNode=function(){this.element.deleteSelected()},Object.defineProperty(t.prototype,"available",{get:function(){return this.element.editing},enumerable:!1,configurable:!0}),t}(ay),EH=function(t){var n=t.propEditor,i=(0,W().getUpimeTrans)("element.delete");return e.createElement(Dl,{placement:"top",content:i},e.createElement("div",{className:j(Ml.cm_item),onPointerDown:ie},e.createElement("div",{className:j(Ml.propEditorIconBox),onClick:function(){return n.deleteNode()}},e.createElement(hl,{icon:"shanchu"}))))},xH=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){switch(e[0]){case 0:var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4];return r.forEach((function(e){e.textOp&&(e.textOp=e.textOp.map((function(e){return Array.isArray(e)&&"string"==typeof e[0]?[yi(e[0]),e[1]]:e})))})),{type:t,elementId:n,version:i,actions:r,serverVersion:o};case 1:return{type:t=e[0],elementId:n=e[1],serverVersion:o=e[2]};case 2:t=e[0],n=e[1],i=e[2];var a=e[3];return o=e[4],a.nodes.forEach((function(e){e.content&&(e.content=e.content.map((function(e){return e[0]=yi(e[0]),e})))})),{type:t,elementId:n,version:i,nodeTree:a,serverVersion:o}}},t.prototype.sendDocAction=function(e,t,n){var i=t.actions.map((function(e){var t;return e.textOp&&(e=exports.E(exports.E({},e),{textOp:(t=e.textOp,t.map((function(e){return Array.isArray(e)&&"number"!=typeof e[0]?[bi(e[0]),e[1]]:e})))})),e}));this.sendSCmd(0,e,t.version,i,n)},t}(Sp);function wH(e){return"doc_nodes"===e.type}var CH=function(e){function t(n){var i=e.call(this,n)||this;return i.upime=n,i.docs={},i.unAckedDocs=[],i.dealDocAction=function(e){var t=e.type,n=e.elementId,r=e.serverVersion;i.upime.updateServerVersion(r);var o=i.getDoc(n);if(o)if(0===t){var a=e.version,s=e.actions;o.onRecvServerAction({version:a,actions:s})}else 1===t?(i.unAckedDocs=i.unAckedDocs.filter((function(e){return e.doc!==o})),o.dealServerAck()):2===t&&(i.unAckedDocs=i.unAckedDocs.filter((function(e){return e.doc!==o})),o.version=e.version,o.rollbackData(e.nodeTree))},i.unsub_xmode=i.upime.subscribe("xmodechange",(function(e){"bigDoc"===e?i.listenMoveto(!0):i.listenMoveto(!1)})),i._selectAllToastId=null,i.needToastSelectAll=void 0,i.subSvc=new xH(n,11,i.dealDocAction),i.subSvc.open(),"bigDoc"===n.xmode&&i.listenMoveto(!0),n.copyPasteCtrl.addTranscoder(t.transNodeCopyData),i}return P(t,e),t.transNodeCopyData=function(e){if(wH(e)){for(var t=e.data.nodeDatas,n=[],i=0,r=t;i<r.length;i++){var o=r[i];if("img"===o.nodeTag){var a=o.targetState,s={position:{x:0,y:0},size:a.size,clipRect:a.clipRect,fileId:a.fileId,scaleMode:1.5,scale:a.targetScale,imgType:a.imgType,name:a.name,zIndex:0};n.push({id:"0",elementType:Za.IMAGE,data:s})}}if(1===t.length&&n.length)return n}return null},t.prototype.getDoc=function(e){var t=this.docs[e];if(!t){var n=this.upime.elementManager.getElementById(e);n&&(t=n,this.docs[e]=n)}return t},t.prototype.sendDocAction=function(e,t){if(!this.upime.isSyncing){var n=this.upime.genLocalSeq();this.subSvc.sendDocAction(e.id,t,n),this.unAckedDocs.push({doc:e,seq:n})}},t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.insertBigDoc(e)}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}}},t.prototype.genNodeId=function(){return this.upime.genID("n"+Za.BIG_DOC)},t.prototype.insertBigDoc=function(e){this.insertBigDocAt(e.position)},t.prototype.insertBigDocAt=function(e,t){var n=e.x,i=e.y,r=t||{},o=r.op,a=r.unSelect,s=r.nodeTree,l=r.name,c=1/this.upime.view.scale,u={x:n,y:i},d=s;if(!d){var p=this.genNodeId();d={nodes:[{id:p,nodeTag:"text",content:[],state:{}}],tree:[p]}}var h={version:0,zIndex:this.upime.newMaxZindex(),size:{width:960,height:540},position:u,name:l||O("bigDoc.default.name"),scale:c,nodeTree:d},f=o||this.upime.createOperation(),m=f.create(Za.BIG_DOC,h);return!o&&f.sync(),a||(this.upime.switchMode("select"),this.upime.selectElement(m)),m},t.prototype.resetData=function(){this.docs={},this.unAckedDocs=[]},t.prototype.beforeIncrementalUpdate=function(e){},t.prototype.afterIncrementalUpdate=function(){var e=this.unAckedDocs;this.unAckedDocs=[],e.forEach((function(e){return e.doc.docContentEditor.reSendLocalActions()}))},t.prototype.showSelectAllToast=function(){var e=this;if(null===this._selectAllToastId){var t="upime-no-toast-selectAll";if(void 0===this.needToastSelectAll&&(this.needToastSelectAll="true"!==localStorage.getItem(t)),this.needToastSelectAll)var n="".concat(_e.isMac?"⌘":"Ctrl","+A"),i=this._selectAllToastId=this.upime.addToast(O("bigDoc.selectAll.toast",n),{autoHideTime:3500,btn:{text:O("common.nomoreToast"),onClick:function(){e.upime.removeToast(i),e.needToastSelectAll=!1,localStorage.setItem(t,"true")}},removedCB:function(){e._selectAllToastId=null}})}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd),SH=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.docContentEditor=n.docContentEditor,r}return P(t,e),Object.defineProperty(t.prototype,"available",{get:function(){return!this.docContentEditor.editing},enumerable:!1,configurable:!0}),t}(WR),kH=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.renderer=dH,r.domRenderer=vH,t.phoneMode&&"default"!==r.phoneToolbarMode||r.propertyEditors.push(new SH(r,n,!r.editable)),r}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!this.element.docContentEditor.editing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportDownload",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectableLocations",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportFullCommonOp",{get:function(){return!this.element.docContentEditor.editing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportMoreCtrl",{get:function(){return!this.element.docContentEditor.editing},enumerable:!1,configurable:!0}),t.prototype.checkHideToolbar=function(){var e,t=this.element.docContentEditor;return!(!t.editing||t.isSelecting)||!!(null===(e=t.currentAnchorEditor)||void 0===e?void 0:e.editing)},t.prototype.getToolBarPosition=function(t){var n=this.element.docContentEditor;if(n.editing&&n.toolbarCtrl.toolbarData){var i=this.upime.view,r=n.toolbarCtrl.toolbarData,o=r.centerPoint,a=r.atBottom,s=o.x-t.width/2,l=a?o.y+4:o.y-4-t.height;return l<64?l=64:l+t.height>i.viewHeight-64&&(l=i.viewHeight-64-t.height),s<62?s=62:s+t.width>i.viewWidth-10&&(s=i.viewWidth-10-t.width),{x:s,y:l}}return e.prototype.getToolBarPosition.call(this,t)},t.prototype.checkHideSelectRect=function(){return!!this.element.docContentEditor.hideSelectRect},t.prototype.resetPropertyEditors=function(e){var t=this,n=t.element,i=t.element.docContentEditor,r=t.upime;e||(this.propertyEditors=[],r.phoneMode&&"default"!==this.phoneToolbarMode||this.propertyEditors.push(new SH(this,n,!this.editable))),"text"===e?this.propertyEditors=[new hH(this,i),new gH(this,i),new uH(this,i),new cH(this,i)]:"img"===e&&(this.propertyEditors=[new yH(this,i),new bH(this,i)])},t.prototype.checkDealScroll=function(e){return Ot(e,this.element.getGlobalBox())},t.prototype.dealScroll=function(e){var t=this.element;t.scrollTop,t.setScrollTop(t.scrollTop+e.deltaY)},t.prototype.getMinSize=function(e){return"n"===e||"s"===e?(540+this.element.titleHeight)*this.element.scale:18},t.prototype.dealBorderResize=function(e,t,n){var i=t.left,r=t.top,o=t.right,a=t.bottom,s=this.element.position;if("n"===n||"s"===n){var l=this.element,c=l.size,u=c.width,d=c.height,p=l.titleHeight,h=(a-r)/this.element.scale-p;return h<540&&540!==d&&(h=540),void this.updateSelf({position:exports.E(exports.E({},s),{x:i,y:r}),size:{width:u,height:h}})}var f=(o-i)/this.element.size.width;this.updateSelf({position:exports.E(exports.E({},s),{x:i,y:r}),scale:f})},t.prototype.checkPointDirection=function(e,t,n){return Ft(e,t,n,["w","e"])},t.prototype.supportLinkTo=function(){return!0},t.prototype.select=function(t){e.prototype.select.call(this),t||(this.upime.view.scrollTarget=this)},t.prototype.unselect=function(t){if(!t){var n=this.element.docContentEditor;n.stopEdit(),this.upime.view.scrollTarget===this&&(this.upime.view.scrollTarget=void 0),n.unselect()}e.prototype.unselect.call(this)},t.prototype.dealClick=function(e){},t.prototype.checkSelectRelation=function(t,n){var i=this.element.globalTransform,r=i.applyInverse(t),o=this.element,a=o.position,s=a.x,l=a.y,c=o.size,u=c.width,d=c.height,p=o.scale,h=o.titleHeight;if(Ot(r,{left:s,top:l+h*p,right:s+u*p,bottom:l+(h+d)*p})){if("move"===(null==n?void 0:n.type)){var f=this.element.checkInteractRelation(r,n);if(f)return f.transparent=!0,f}var m=i.currentScale;return{transparent:!0,metric:u*d*p*p*m*m}}return e.prototype.checkSelectRelation.call(this,t,n)},t.prototype.dealDirectCtrl=function(e,t){var n=this,i=this.element,r=i.docContentEditor;e.isStart&&r.toolbarCtrl.removeToolbar();var o=void 0;if("nodeSelect"===t.type)o=r.dealNodeSelectEvt.bind(r,t);else if("ctrlWidget"===t.type){var a=t.ctrlWidget,s=t.ctrlData;o=a.dealCtrlWidgetEvt.bind(a,s)}if(o){window.clearInterval(this.docScrollTimer);var l=this.element,c=l.position,u=l.size,d=l.titleHeight,p=l.scale,h=l.globalTransform.applyInverse(e.position),f=c.y+d*p,m=c.y+(d+u.height)*p,v=h.y<f||h.y>m,g=function(){h.y<f&&i.setScrollTop(i.scrollTop+(h.y-f)/p-10),h.y>m&&i.setScrollTop(i.scrollTop+(h.y-m)/p+10)},y=function(){return{x:(h.x-c.x)/p,y:(h.y-f)/p+n.element.scrollTop}};if(v&&!e.isEnd){var b=o;this.docScrollTimer=window.setInterval((function(){b(y(),{isStart:!1,isEnd:!1}),g()}),50)}o(y(),{isStart:e.isStart,isEnd:e.isEnd}),v&&g()}},t}(Ob);function _H(e,t){for(var n=e.version,i=t.version,r=e.actions,o=t.actions,a=[],s=0;s<o.length;s++){for(var l=o[s],c=[],u=0,d=r;u<d.length;u++){var p=d[u],h=TH(p,l);if(null===h)return null;p=h[0],l=h[1],c.push(p)}r=c,a.push(l)}return[{version:n,actions:r},{version:i,actions:o=a}]}function TH(e,t){var n,i=e.id,r=t.id,o={id:i,nodeTag:e.nodeTag,originPosition:fe(e.originPosition)},a={id:r,nodeTag:t.nodeTag,originPosition:fe(t.originPosition)};if(void 0!==e.targetPosition&&void 0!==t.targetPosition)if("null"===e.targetPosition.parentId){if(i===r)"null"!==t.targetPosition.parentId&&(o.originPosition=t.targetPosition,o.targetPosition=e.targetPosition);else if(t.originPosition.path.includes(i)||t.targetPosition.path.includes(i))return null}else if(i===r)a.originPosition=e.targetPosition,a.targetPosition=t.targetPosition;else{o.targetPosition=fe(e.targetPosition),a.targetPosition=fe(t.targetPosition);var s=t.originPosition.path.indexOf(i);if(s>=0&&(a.originPosition.path=R(R([],e.targetPosition.path,!0),t.originPosition.path.slice(s),!0)),(s=t.targetPosition.path.indexOf(i))>=0&&(a.targetPosition.path=R(R([],e.targetPosition.path,!0),t.targetPosition.path.slice(s),!0)),a.targetPosition.path.includes(r))return null;if((s=e.originPosition.path.indexOf(r))>=0&&(o.originPosition.path=R(R([],t.targetPosition.path,!0),e.originPosition.path.slice(s),!0)),(s=e.targetPosition.path.indexOf(r))>=0&&(o.targetPosition.path=R(R([],t.targetPosition.path,!0),e.targetPosition.path.slice(s),!0)),o.targetPosition.path.includes(i))return null;a.originPosition.parentId===o.originPosition.parentId&&(a.originPosition.index>o.originPosition.index?a.originPosition.index-=1:a.originPosition.index<o.originPosition.index&&(o.originPosition.index-=1)),a.originPosition.parentId===o.targetPosition.parentId&&(a.originPosition.index>=o.targetPosition.index?a.originPosition.index+=1:o.targetPosition.index-=1),a.targetPosition.parentId===o.originPosition.parentId&&(a.targetPosition.index>o.originPosition.index?a.targetPosition.index-=1:o.originPosition.index+=1),a.targetPosition.parentId===o.targetPosition.parentId&&(a.targetPosition.index>=o.targetPosition.index?a.targetPosition.index+=1:o.targetPosition.index+=1)}else void 0!==e.targetPosition?o.targetPosition=e.targetPosition:void 0!==t.targetPosition&&(a.targetPosition=t.targetPosition);if(void 0!==e.textOp&&void 0!==t.textOp&&i===r){var l=e.textOp,c=t.textOp;l=(n=Ps(l,c))[0],c=n[1],o.textOp=l,a.textOp=c}else o.textOp=e.textOp,a.textOp=t.textOp;if(void 0!==e.targetState&&void 0!==t.targetState&&i===r){var u=exports.E({},e.targetState),d=t.targetState;Object.keys(e.targetState).forEach((function(e){void 0!==d[e]&&delete u[e]})),o.targetState=u,a.targetState=d}else o.targetState=e.targetState,a.targetState=t.targetState;return[o,a]}function IH(e,t){var n=e.actions;if(n.length&&n[n.length-1].id===t.id){var i=n[n.length-1];t.textOp&&(i.textOp?i.textOp=Is(i.textOp,t.textOp):i.textOp=t.textOp),t.targetPosition&&(i.targetPosition=t.targetPosition),t.targetState&&(i.targetState?i.targetState=exports.E(exports.E({},i.targetState),t.targetState):i.targetState=t.targetState)}else n.push(t);return e}var PH="confirm_3hzO3",NH=function(t){var n=t.success,i=t.fail,r=W().getUpimeTrans;return e.createElement("div",{className:"insert_panel_muX5o"},e.createElement("div",{className:"content_3r3Dl"},e.createElement("div",{className:"header_3dHHU"},e.createElement("div",{className:"title_3J0PX"},r("table.paste.dialog.title")),e.createElement(hl,{icon:"guanbi",onClick:function(){return i("close")},className:"close_1JPKp"})),e.createElement("div",{className:"desc_9hwut"},r("table.paste.dialog.desc")),e.createElement("div",{className:"text_3RM8x"},r("table.paste.dialog.text"))),e.createElement("div",{className:"actions_2GczT"},e.createElement(ul,{type:"primary",className:PH,onClick:function(){return n(At.TABLE)}},r("table.paste.dialog.toTable")),e.createElement(ul,{type:"secondary",className:PH,onClick:function(){return n(At.STICKERS)}},r("table.paste.dialog.toSticker"))))};function MH(e,t){return"<span meta-data='<--(plaso-custom-data)".concat(window.btoa(encodeURI(t)),"(/plaso-data)--\x3e'></span>").concat(e)}function AH(e){var t=/<--\(plaso-custom-data\)(.*)\(\/plaso-data\)-->/.exec(e);return t?JSON.parse(decodeURI(window.atob(t[1]))):null}function DH(e,t){return"<span meta-data='<--(plaso-data)".concat(window.btoa(encodeURI(t)),"(/plaso-data)--\x3e'></span>").concat(e)}function RH(e){var t=/<--\(plaso-data\)(.*)\(\/plaso-data\)-->/.exec(e);return t?JSON.parse(decodeURI(window.atob(t[1]))):null}function BH(e){return e===Za.CONNECTIONLINE||e===Za.MINDMAP_LINE}var LH=function(t){function n(n){var i=t.call(this,n)||this;return i.dataTranscoders=[],i.unsub_past=i.upime.userEventManager.subscribe("paste",(function(e){var t=e.clipData,n=e.position,r=e.globalPosition,o=e.originEvent;o.stopPropagation(),o.preventDefault();var a=i.upime;if(a.editable&&"hand"!==a.xmode){var s=t.getData("text/html"),l=t.getData("text/plain"),c=lA(s),u=i.upime.checkFocusTableCell();if(c)i.insertTableData(c,u,n);else{if(s){var d=i.parseElementInfo(s);if(d)return u?void i.useEleInfoForTableCell(d,u):void i.useEleInfo(d,n)}if(l&&i.checkInsertWebpage(l))a.insertWebpageAt(n,{url:l});else{if(s){var p=Nr(s);if(p)return void i.insertRichTextAt(n,{content:p,autoAdjust:!0})}if(l){var h=o.target;if("INPUT"===h.tagName||"TEXTAREA"===h.tagName&&"false"!==h.dataset.nativeEvtHandle||"true"===h.contentEditable)return;if(i.overwriteRichContent(l))return;i.insertRawText(n,{text:l,autoAdjust:!0})}else!function(){for(var e=[],n=0;n<t.items.length;n++){var i=t.items[n];if("file"===i.kind){var o=i.getAsFile();o&&e.push(o)}}e.length>0&&a.insertFiles(e,{position:r})}()}}}})),i.overwriteRichContent=function(e){var t=i.upime.view.connectedRichEditor;if(t&&t.doOverwriteAll){var n=t.element;return n.currentEditor?n.currentEditor.startEdit():i.upime.selectElement(n).startEdit(),t.doOverwriteAll(e),!0}return!1},i.readClipboardData=function(){return A(i,void 0,void 0,(function(){var t,n,i,r,o,a,s,l;return D(this,(function(c){switch(c.label){case 0:return c.trys.push([0,13,,14]),[4,navigator.permissions.query({name:"clipboard-read"})];case 1:return"denied"===c.sent().state?(function(t){t.addToast(e.createElement(EF,null))}(this.upime),[2,null]):[4,navigator.clipboard.read()];case 2:t=c.sent()[0],n=null,i="",r="",o=null,a=0,s=t.types,c.label=3;case 3:return a<s.length?(l=s[a]).startsWith("image/")?[4,t.getType(l)]:[3,5]:[3,12];case 4:n=c.sent(),c.label=5;case 5:return"text/plain"!==l?[3,8]:[4,t.getType("text/plain")];case 6:return[4,c.sent().text()];case 7:r=c.sent(),c.label=8;case 8:return"text/html"!==l?[3,11]:[4,t.getType("text/html")];case 9:return[4,c.sent().text()];case 10:i=c.sent(),o=lA(i),c.label=11;case 11:return a++,[3,3];case 12:return[2,{imageBlob:n,htmlData:i,plainData:r,tableData:o}];case 13:return c.sent(),this.upime.addToast("读取剪切板数据错误，请尝试 ctrl + V 来进行粘贴"),[2,null];case 14:return[2]}}))}))},i.unsub_copy=i.upime.userEventManager.subscribe("copy",(function(){i.copyElements()})),i.unsub_cut=i.upime.registerHotKey({key:"x",ctrlKey:!0,i:!0},(function(){var e=i.upime.getSelectedElements();if(1===e.length&&e[0].elementType===Za.TABLE){var t=e[0];if(t.focusingCell){var n=t.currentEditor,r=n.couldDeleteRow||n.couldDeleteCol,o=1===t.focusedCells.filter((function(e){return!e.clusterId||e.clusterRoot})).length;return void(o&&!r?(i.copyElements(),i.upime.deleteSelected(),i.upime.updateView()):o?(i.copyElements(void 0,void 0,void 0,void 0,void 0,{forcePasteToTable:!0}),i.upime.deleteSelectedTableRowCols(),i.upime.updateView()):(i.copyElements(),r?i.upime.deleteSelectedTableRowCols():i.upime.deleteSelected(),i.upime.updateView()))}}i.copyElements(),i.upime.deleteSelected(),i.upime.updateView()})),i}return P(n,t),n.prototype.addTranscoder=function(e){!this.dataTranscoders.includes(e)&&this.dataTranscoders.push(e)},n.prototype.removeTranscoder=function(e){this.dataTranscoders=this.dataTranscoders.filter((function(t){return t!==e}))},n.prototype.parseElementInfo=function(e){var t=RH(e);if(!t&&this.dataTranscoders.length){var n=AH(e);if(n)for(var i=0,r=this.dataTranscoders;i<r.length&&!(t=(0,r[i])(n));i++);}return t},n.prototype._useTableData=function(e,t,n){if(t){var i=e[0].data,r=i.rows,o=i.cols,a=Array(r*o).fill(null).map((function(e,t){return t}));i.focusedCellsIdx=a,this.useEleInfoForTableCell(e,t)}else this.useEleInfo(e,n)},n.prototype.insertTableData=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c;return D(this,(function(u){switch(u.label){case 0:if(i=At.TABLE,t)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.upime.showWindow(NH)];case 2:return i=u.sent(),[3,4];case 3:return u.sent(),[2];case 4:switch(r=50,i){case At.STICKERS:o=function(e,t,n){var i={bgColor:qe,scale:tb.S,ha:"center",va:"middle",autoFontSize:!0,fontSize:64,lineHeightRate:Le(He),lineHeight:ib(64,Le(He)),fontFamily:He,isPrivate:!1},r=exports.E(exports.E({},i),{zIndex:t.newMaxZindex(),size:Ke,shape:eb.SQUARE,textSize:Ze,position:{x:0,y:0},showAuthor:!1,richContent:{version:t.genOtVersion(0),content:[]}}),o={shape:eb.RECT,position:{X:0,Y:0},size:{width:1.8*Ke.width,height:Ke.height},textSize:{width:Ze.width+.8*Ke.width,height:Ze.height}},a=[],s=0,l=cA(e,(function(e,l,c,u){if(n&&(l>=n.rows||c>=n.cols))return{textId:void 0};var d="".concat(++s),p=exports.E(exports.E(exports.E({},r),u.colCluster&&c<((null==n?void 0:n.cols)||1/0)-1&&o),{zIndex:t.newMaxZindex(),position:{x:c*(Ke.width*i.scale+20),y:l*((Ke.height+15)*i.scale+10)}});if(e.trim()){var h=e.replace(/\r\n/g,"\n"),f=yi(h),m=[[f,{color:1710618}]],v=uA(p,f);p=exports.E(exports.E({},p),{richContent:{version:t.genOtVersion(0),content:m},fontSize:v,lineHeight:ib(v,p.lineHeightRate)})}return a.push({elementType:Za.STICKER,id:d,data:p}),{textId:d}})),c=l.maxCols,u=l.maxRows;return{data:a,preCols:c,preRows:u}}(e,this.upime,{rows:r,cols:r}),s=o.data,l=o.preRows,c=o.preCols,(l>r||c>r)&&this.upime.addToast(O("table.paste.limit.hint"),{autoHideTime:5e3}),this.useEleInfo(s,n);break;case At.TABLE:a=function(e,t,n){var i={elementType:Za.TABLE,id:"0",data:{zIndex:t.newMaxZindex(),name:O("table.title"),rows:0,cols:0,fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,rotate:0,scale:1,meshColor:9540508,cells:[],rowWidths:[],rowHeights:[],position:{x:0,y:0},size:{width:0,height:0},bgOpacity:1,hasBg:!0,color:1710618,bgColor:je[0],va:"middle",ha:"center",focusedCellsIdx:null}},r=[i],o={scale:1,va:"middle",ha:"center",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He},a=0,s=[],l=cA(e,(function(e,i,l){if(n&&(i>=n.rows||l>=n.cols))return{textId:void 0};if(e.trim()){var c=function(e){e=e.replace(/\r\n/g,"\n");var t=Wi(yi(e),o,256).height;return{content:[[yi(e),{color:1710618,highLight:null}]],height:t}}(e),u=c.content,d=c.height,p="".concat(++a),h={elementType:Za.GRID_TEXT,id:p,data:exports.E(exports.E({hasBg:!1,bgColor:0,bgOpacity:1},o),{size:{width:248,height:d},autoWidth:!1,zIndex:t.newMaxZindex(),richContent:{version:t.genOtVersion(0),content:u},position:{parentId:"0",parentType:Za.TABLE,x:0,y:0,rowId:"".concat(i),columnId:"".concat(l)}})};return r.push(h),d+20>72&&(s[i]=d+20),{textId:p}}return{textId:void 0}})),c=l.maxCols,u=l.grids,d=l.maxRows,p=n?u.map((function(e){return e.slice(0,n.cols)})).slice(0,n.rows):u,h=n?Math.min(n.cols,c):c,f=n?Math.min(n.rows,d):d,m=Array(h).fill(256),v=Array(f).fill(72).map((function(e,t){return s[t]||e}));return i.data=exports.E(exports.E({},i.data),{cells:p.flat(),cols:h,rows:f,rowHeights:v,rowWidths:m,size:{width:m.reduce((function(e,t){return e+t}),0),height:v.reduce((function(e,t){return e+t}),0)}}),{data:r,preRows:d,preCols:c}}(e,this.upime,{rows:r,cols:r}),s=a.data,l=a.preRows,c=a.preCols,(l>r||c>r)&&this.upime.addToast(O("table.paste.limit.hint"),{autoHideTime:5e3}),this._useTableData(s,t,n)}return[2]}}))}))},n.prototype.useEleInfoForTableCell=function(e,t){var n=!1,i=!1;e.filter((function(e){return DE.includes(e.elementType)||(i=!0),e.elementType===Za.TABLE&&(e.data.focusedCellsIdx&&(n=!0),!0)})).length>1&&n||(n?t.useCellsData(e):i?this.upime.addToast(O("table.cell.unsupported.eleType")):t.pasteElesIntoCell(e))},n.prototype.useEleInfo=function(e,t,n){var i,r,o,a;return A(this,void 0,void 0,(function(){var s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A,B,L,O,F,z,H,U,W,V,j,G,q,K,Y,X,Q=this;return D(this,(function(D){switch(D.label){case 0:if(n||(n={autoSelect:!0,scaleView:!0}),s=this.upime,l=s.newMaxZindex(),c=[],u=[],d={},p={},h=[],f=[],m={},v=[],g=s.createOperation(),y=e.filter((function(e){return e.elementType===Za.TABLE})),1===y.length&&!(null===(i=y[0].extraInfo)||void 0===i?void 0:i.forcePasteToTable)&&1===(null===(r=y[0].data.focusedCellsIdx)||void 0===r?void 0:r.length)&&e.every((function(e){return e.elementType===Za.TABLE||e.data.position.parentType&&e.data.position.parentId===y[0].id}))){if(b=[],e.forEach((function(e){if(e.elementType!==Za.TABLE&&e.data._globalRsUpdate){e.elementType===Za.GRID_TEXT&&(e.elementType=Za.TEXT);var t=e.data._globalRsUpdate;delete e.data._globalRsUpdate,Object.assign(e.data,t),b.push(e)}})),!b.length)return[2];e=b}for(k=0;k<e.length;k++)E=e[k].elementType,c.push(s.genID(E));return[4,ra(this.upime)];case 1:for(x=D.sent(),w=[],C=function(n){if((e[n].elementType===Za.AUDIO||e[n].elementType===Za.DOCUMENT||e[n].elementType===Za.IMAGE||e[n].elementType===Za.VIDEO)&&!x)return"continue";var i=e[n],r=i.elementType,s=i.data,y=i.id;if(s.position.parentType?s.position.parentId=c[s.position.parentId]:s.position=En(s.position,t),s.zIndex+=l,s.frameId&&(s.frameId=c[s.frameId]||null),s.groupId&&(u[s.groupId]||(u[s.groupId]=S.upime.genID("g")),s.groupId=u[s.groupId]),r===Za.FRAME){var b=S.upime.elementManager.sequentialFrames,E=(null===(o=b[b.length-1])||void 0===o?void 0:o.id)||null;s.prevFrameId=E}if(BH(r)){var C=s,k=C.startElementId,_=C.startPosition,T=C.endElementId,I=C.endPosition,P=C.breakPointData,N=void 0!==C.position.parentType;k?C.startElementId=c[k]:N||(C.startPosition=En(_,t)),T?C.endElementId=c[T]:N||(C.endPosition=En(I,t)),P.points.length&&!N&&(C.breakPointData=exports.E(exports.E({},P),{points:P.points.map((function(e){return En(e,t)}))}))}if(S.upime.elementManager.getElementGenerator(r)){if(r===Za.KANBAN){var M=S.upime.kanbanManager.createKanban(exports.E(exports.E({},s),{cards:s.cards.map((function(e){return c[e]})),id:c[n]}));return v.push(M),"continue"}if(r===Za.CARD){var A=c[s.kanbanId];if(M=v.find((function(e){return e.id===A})),M){var D=c[n],R=M.cards.findIndex((function(e){return e===D})),B={kanbanId:A,index:R},L=S.upime.kanbanManager.restoreCard(exports.E(exports.E({},s),{id:D,kanbanId:A}),B);return v.push(L),"continue"}return w.push(s),"continue"}if(r===Za.BIG_DOC){s.version=0;var O=s.nodeTree;if(O){var F=S.upime.bigDocManager,z={},H=O.nodes,U=O.tree;H.forEach((function(e){var t=e.id,n=F.genNodeId();e.id=n,z[t]=n}));var W=function(e){for(var t=0;t<e.length;t++){var n=e[t];"string"==typeof n?e[t]=z[n]:(n.id=z[n.id],W(n.children))}};W(U)}}var V=g.create(r,s,{id:c[n]});if((null===(a=s.position)||void 0===a?void 0:a.parentType)===Za.TABLE&&(f.push(V),m[y]=V.id),r===Za.TABLE&&(d[y]=V.id,h.push(V)),r===Za.GRID_TEXT)return p[y]=V.id,"continue";v.push(V)}},S=this,k=0;k<e.length;k++)C(k);return _=[],T=0,w.length&&(I=FL(t,this.upime),P=I.targetKanban,N=I.adsorptionLine,P&&N&&(T=null==N?void 0:N.col,M=zL(N,P),A=HL(N,P),B=A.afterCard,(L=A.preCard)&&w.reverse(),O=function(){return UL({targetKanban:P,preCard:L,afterCard:B})},w.forEach((function(e){var t=O().targetIndex,n=WL({values:e.values,originAttributes:e._partentKanbanAttributes,targetKanban:P,targetValue:M}).update,i=Q.upime.genID(Za.CARD),r=exports.E(exports.E({},e),n);delete r._partentKanbanAttributes;var o=Q.upime.kanbanManager.createCard(exports.E(exports.E({},r),{id:i}),{kanbanId:P.id,index:t});_.push(o)})))),F=R([],v,!0),z=[],(H=v.filter((function(e){return e.elementType===Za.MINDMAP_NODE}))).length>0&&(U=lp(H),1===(W=s.getSelectedElements()).length&&W[0].elementType===Za.MINDMAP_NODE?(V=W[0],new V.editorType(s,V).insertNodes(U,g).forEach((function(e){F.includes(e)||F.push(e)}))):(U.forEach((function(e){e.isRootNode||z.push(e)})),z.forEach((function(e){e.toRoot(g)})))),j=this.upime.view.elementsRoot,F.forEach((function(e){if(e.supportChangeRS&&!e.position.parentType&&!e.frameId){var t=e,n=t.startElement,i=t.endElement;if(n&&i){if(n.parentRefSystem&&n.parentRefSystem!==j){var r=e.calcTransformedUpdate(n.parentRefSystem);g.update(e,r)}else n.frame&&e.isSupportFrame&&g.update(e,{frameId:n.frame.id});return}var o=Q.findRefSystem(e,(function(e){return!e.baseElement||!v.includes(e.baseElement)}));if(o)return r=e.calcTransformedUpdate(o),void g.update(e,r);var a=Q.findFrame(e,(function(e){return!v.includes(e)}));a&&g.update(e,{frameId:a.id})}})),F.forEach((function(e){var t;if(e.elementType!==Za.FRAME&&!e.frameId&&(null===(t=e.group)||void 0===t?void 0:t.members)){var n=e.group.members;if(0===n.indexOf(e)){for(var i=void 0,r=0,o=n;r<o.length;r++){var a=o[r];if(a.frame){i=a.frame;break}}if(!i)return;var s=i.id;n.forEach((function(e){e.position.parentType||g.update(e,{frameId:s})}))}}})),_.length&&n&&n.autoSelect&&(G=_[0].pareantKanban)&&(s.switchMode("select"),s.selectElement(G),G.setSelectedCards(_.map((function(e){return{cardId:e.id,col:T}})))),v.length>0?(q=s.createLock(F.map((function(e){return e.id}))),s.clearLock(q),s.switchMode("select"),K=v.filter((function(e){return e.elementType!==Za.MINDMAP_NODE||!e.isMindmapNodeHideByCollapsed})).filter((function(e){return e.elementType!==Za.CONNECTIONLINE||e.mounted})).filter((function(e){return e.elementType!==Za.CARD||!e.kanbanId})),Y=Yt(K.filter((function(e){return e.elementType!==Za.MINDMAP_LINE})).map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)}))),n&&n.autoSelect&&s.selectElements(K),n&&n.scaleView&&s.makeBorderInSight(Y),X=K.filter((function(e){return e.elementType!==Za.CONNECTIONLINE})),X.length>0&&(this.upime.makeBorderInSight(Y,{left:90,right:20,top:60,bottom:60}),this.upime.makeBorderFixedSizeInSight(Y,12)),z.forEach((function(e){e.updateRootStyle(!0,g),e.onAlignTheTree(g)})),g.sync()):s.deleteOperation(g),[2,v]}}))}))},n.prototype.copyElements=function(e,t,n,i,r,o){if(void 0===e&&(e="center"),void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),r&&("select"!==this.upime.xmode&&"hand"!==this.upime.xmode||!this.upime.editable))return null;var a=!1,s=this.upime.getSelectedElements().filter((function(e){return e.elementType===Za.FRAME&&e.hide&&(a=!0),e.supportCopy}));if(a&&i)return this.upime.addToast(O("frame.hide.copy.hint")),null;if(0===s.length)return null;var l=this.getElementsData(s,{align:e,resetGroup:t}),c=l.info,u=l.eleList,d=l.border;if(o&&c.forEach((function(e){e.extraInfo=o})),n){var p="",h="",f=u.filter((function(e){return e.rawText}));f.sort((function(e,t){var n=e.getGlobalBox(),i=t.getGlobalBox();return n.top===i.top?n.left-i.left:n.top-i.top})),f.forEach((function(e,t){var n=e.rawText;p+=n+"\n";var i=e.richTextClient.contentEditor.convertSelectedRichText2HTML();i&&(h+="".concat(i.outerHTML).concat(t!==f.length-1?"<br><br>":""))})),1!==c.length||c[0].elementType!==Za.IMAGE||_e.safari?Xd("1",{onCopy:function(e){e.setData("text/html",DH(h,JSON.stringify(c))),e.setData("text/plain",p)}}):this.copyImageElement(u[0],c)}return{info:c,eleList:u,border:d}},n.prototype.copyImageElement=function(e,t){return A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){switch(r.label){case 0:return(n=new Image).crossOrigin="anonymous",[4,this.upime.getFileInfo(e.fileId)];case 1:return i=r.sent(),n.src=i.url,n.onload=function(){var e=document.createElement("canvas");e.width=n.width,e.height=n.height;var i=e.getContext("2d");null==i||i.drawImage(n,0,0);var r=e.toDataURL("image/png"),o=document.createElement("img");o.src=r,e.toBlob((function(e){Xd("1",{onCopy:function(n){e&&n.setData("image/png",e),n.setData("text/html",DH(o.outerHTML,JSON.stringify(t)))},forceApi:!0})}))},[2]}}))}))},n.prototype.getElementsData=function(e,t){var n,i,r;void 0===t&&(t={align:"center",resetGroup:!1});var o=t.align,a=t.resetGroup,s=t.targetBox;e.filter((function(e){return e.elementType===Za.FRAME})).forEach((function(t){t.getMembers().filter((function(e){return e.supportCopy})).forEach((function(t){e.indexOf(t)<0&&t.elementType!==Za.MINDMAP_LINE&&e.push(t)}))}));var l=e.filter((function(e){return e.elementType===Za.MINDMAP_NODE})),c=[],u=e.filter((function(e){return e.elementType===Za.TABLE})),d=1===e.length&&(null===(n=u[0])||void 0===n?void 0:n.focusingCell),p=1===e.length&&1===(null===(i=u[0])||void 0===i?void 0:i.focusedCells.length);u.forEach((function(t){var n=t.getMembers().filter((function(e){return e.supportCopy}));n.forEach((function(t){e.includes(t)||e.push(t),c.push(t)}))}));var h=e.filter(Hu),f=[],m=h.map((function(e){return 0===e.selectedCards.length?Array.from(e.cardsMap.values()):(f.push(e),Array.from(new Set(e.selectedCards.map((function(e){return e.cardId})))).map((function(t){return e.cardsMap.get(t)})))})).flat();e.push.apply(e,m),f.forEach((function(t){var n=e.indexOf(t);n>=0&&e.splice(n,1)})),lp(l).forEach((function(t){e.includes(t)||e.push(t),t.getDescendants().forEach((function(t){e.includes(t)||e.push(t),e.includes(t.precursorLine)||e.push(t.precursorLine)}))}));var v=[];e.forEach((function(t){var n=t.connectionLines;n&&n.forEach((function(n){!n.deleted&&n.startElement===t&&n.endElement&&e.includes(n.endElement)&&!e.includes(n)&&v.push(n)}))})),v.forEach((function(t){return e.push(t)}));for(var g=e.reduce((function(e,t){var n=t.group;if(n){var i=e.find((function(e){return e.group===n}));i?i.count++:e.push({group:n,count:1})}return e}),[]).reduce((function(e,t){var n=t.group,i=t.count;return n.members.length===i&&e.push(n.id),e}),[]),y={},b=function(e){return e===Za.FRAME?-1:BH(e)?1:0},E=e.sort((function(e,t){return b(e.elementType)-b(t.elementType)})),x=[],w=null!=s?s:Yt(d?u[0].getFocusedCellsBoxes(!0):E.filter((function(e){return e.isSupportSelected})).filter((function(e){return e.elementType!==Za.MINDMAP_NODE||!e.isMindmapNodeHideByCollapsed})).filter((function(e){return e.elementType!==Za.CONNECTIONLINE||e.mounted})).map((function(e){return e.getGlobalBox()}))),C="center"===o?{x:(w.right+w.left)/2,y:(w.bottom+w.top)/2}:{x:w.left,y:w.top},S=E.map((function(e){return e.zIndex})).sort((function(e,t){return e-t})),k=0;k<E.length;k++){var _=E[k];y[_.id]=k}var T=this.upime.view.elementsRoot,I={};for(k=0;k<E.length;k++){var P=zs(_=E[k],_.elementType),N=P.position;if(_.elementType===Za.DOCUMENT&&(P.startPage=_.currentPage,2!==_.mode&&(P.titleHeight=.05416666666666667*_.size.width)),_.elementType!==Za.VIDEO&&_.elementType!==Za.AUDIO||(P.titleHeight||(P.titleHeight=.05416666666666667*_.size.width),P.markPoints=[]),_.elementType===Za.KANBAN&&(P.cards=P.cards.map((function(e){var t;return null===(t=y[e])||void 0===t?void 0:t.toString()})).filter(Boolean)),Fu(_)&&!1===_.isGhost){var M=_.kanbanId;M&&(void 0!==y[M]?P.kanbanId=y[M].toString():(I[M]||(I[M]=_t.cloneDeep((null===(r=_.pareantKanban)||void 0===r?void 0:r.attributes)||[])),P._partentKanbanAttributes=I[M]))}if(_.elementType===Za.BIG_DOC&&(P.nodeTree=_.genNodeTree()),N.parentType){var A=y[N.parentId];if(A>=0&&(P.position=exports.E(exports.E({},N),{parentId:A+""})),void 0===A||p){var D=_.calcTransformedUpdate(T),R=D.position;D.position=xn(R,C),void 0===A?Object.assign(P,D):P._globalRsUpdate=D}}else P.position=xn(N,C);if(P.zIndex=S.indexOf(_.zIndex),_.frameId){var B=y[_.frameId];P.frameId=B>=0?B+"":null}if(_.groupId&&(a?P.groupId=null:(B=g.indexOf(_.groupId),P.groupId=B>=0?B+"":null)),P.frozedGroupId=null,BH(_.elementType)){var L=P,O=_,F=O.startElementId,z=O.endElementId,H=O.startPoint,U=O.endPoint,W=O.breakPointData,V=y[F],j=void 0!==L.position.parentType;V>=0?L.startElementId=V+"":(L.startElementId=null,j?L.startPosition=exports.E({},H):O.startElement?L.startPosition=xn(O.globalTransform.apply(H),C):L.startPosition=xn(L.startPosition,C),L.endType=0);var G=y[z];G>=0?L.endElementId=G+"":(L.endElementId=null,j?L.endPosition=exports.E({},U):O.endElement?L.endPosition=xn(O.globalTransform.apply(U),C):L.endPosition=xn(L.endPosition,C),L.endType=0),W.points.length&&!j&&(L.breakPointData=exports.E(exports.E({},W),{points:W.points.map((function(e){return xn(e,C)}))}))}x.push({id:k+"",elementType:_.elementType,data:P})}return c.forEach((function(e){var t=y[e.id],n=x[t].data.position,i=n.parentId,r=n.rowId,o=n.columnId,a=x[+i];a&&a.data.cells.forEach((function(n){n.rId===r&&n.cId===o&&(e.elementType===Za.GRID_TEXT?n.textEleId=t+"":n.attachEleIds?n.attachEleIds.push("".concat(t)):n.attachEleIds=["".concat(t)])}))})),{info:x,eleList:E,border:w}},n.prototype.readFromClipboard=function(e){var t;return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u,d,p;return D(this,(function(h){switch(h.label){case 0:return[4,this.readClipboardData()];case 1:if(!(n=h.sent()))return[2];if(i=n.htmlData,r=n.plainData,o=n.tableData,a=n.imageBlob,o)return s=this.upime.checkFocusTableCell(),this.insertTableData(o,s,e),[2];if(l=this.upime.checkFocusTableCell(),c=this.parseElementInfo(i),u=Nr(i),c)return l?(this.useEleInfoForTableCell(c,l),[2]):(this.useEleInfo(c,e),[2]);if(r){if(this.checkInsertWebpage(r))return this.upime.insertWebpageAt(e,{url:r}),[2];if(l)return this.overwriteRichContent(r),[2]}return u?(this.insertRichTextAt(e,{content:u,autoAdjust:!0}),[2]):a?(d=new File([a],"image.".concat(null!==(t=a.type.split("/")[1])&&void 0!==t?t:"png"),{lastModified:Date.now()}),p=this.upime.view.getScreenPosition(e),this.upime.insertFiles([d],{position:p}),[2]):r?(this.insertRawText(e,{text:r,autoAdjust:!0}),[2]):[2]}}))}))},n.prototype.readClipboardDataFromClipboardEvent=function(e){var t=e.clipboardData;if(!t)return null;for(var n=t.getData("text/html"),i=t.getData("text/plain"),r=lA(n),o=null,a=0;a<t.items.length;a++){var s=t.items[a];if("file"===s.kind&&s.type.startsWith("image/")){o=s.getAsFile();break}}return{imageBlob:o,htmlData:n,plainData:i,tableData:r}},n.prototype.insertRichTextAt=function(e,t){this.upime.insertTextAt(e,t)},n.prototype.checkInsertWebpage=function(e){return this.upime.userManager.enableWebpage&&ae(e)&&me(e)},n.prototype.insertRawText=function(e,t){this.upime.insertTextAt(e,t)},n.prototype.useRawElesData=function(e,t){if(!e)return!1;var n=this.upime,i=new Set,r={},o=e.reduce((function(e,o){var a=Ms(o),s=a.elementType,l=a.id,c=a.data;if(!n.elementManager.getElementGenerator(s))return e;var u=c.position,d=c.groupId,p=c.frameId,h=N(c,["position","groupId","frameId"]),f=h;r[l]||(r[l]=n.genID(s));var m=r[l];if(d){if(!r[d]){var v=n.genID("g");r[d]=v}f.groupId=r[d]}if(p){if(!r[p]){var g=n.genID(Za.FRAME);r[p]=g}f.frameId=r[p]}var y=BH(s);if(u.parentType){var b=u.parentId;r[b]||(r[b]=n.genID(u.parentType)),f.position=exports.E(exports.E({},u),{parentId:r[b]})}else f.position=y?u:En(u,t);if(y){var E=h,x=E.startElementId,w=E.startPosition,C=E.endElementId,S=E.endPosition,k=E.breakPointData;if(x){if(!r[x]){var _=x.split("_")[0];r[x]=n.genID(_)}f.startElementId=r[x]}else u.parentType||(f.startPosition=En(w,t));C?(r[C]||(_=C.split("_")[0],r[C]=n.genID(_)),f.endElementId=r[C]):u.parentType||(f.endPosition=En(S,t)),k.points.length&&!u.parentType&&(f.breakPointData=exports.E(exports.E({},k),{points:k.points.map((function(e){return En(e,t)}))}))}return i.add(m),R(R([],e,!0),[{id:m,elementType:s,data:f}],!1)}),[]),a=n.createOperation(),s=n.newMaxZindex(),l=[];o.forEach((function(e){var t=e.elementType,n=e.data,r=e.id;if(!n.position.parentType||i.has(n.position.parentId)){if(t===Za.CONNECTIONLINE){var o=n;if(o.startElementId&&!i.has(o.startElementId))return;if(o.endElementId&&!i.has(o.endElementId))return}l.push(a.create(t,exports.E(exports.E({},n),{zIndex:n.zIndex+s}),{id:r}))}})),a.sync();var c=l.reduce((function(e,t){return t.mounted?R(R([],e,!0),[t.getGlobalBox()],!1):e}),[]);c.length&&n.makeBorderCenter(Yt(c))},n.prototype.destroy=function(){this.unsub_copy(),this.unsub_past(),this.unsub_cut()},n}(zd),OH=function(){function e(e){this.manager=e,this.relativeElements=[],this.isUndo=!0,this.updateGroup=[],this.docOt={version:0,actions:[]},this.lastEditTime=Date.now()}return e.prototype.onRelease=function(){this.isUndo?this.manager.removeUndo(this):this.manager.removeRedo(this)},e.prototype.getRevertOperation=function(){return this.isUndo?this.manager.undoOp(this):this.manager.redoOp(this)},e}(),FH=function(e){function t(t,n){for(var i=this,r=document.createElement("canvas"),o=n[0],a=n[n.length-1],s=o.position.x,l=o.position.y,c=0,u=n;c<u.length;c++){var d=u[c];s>d.position.x&&(s=d.position.x)}var p=o.position.x+o.borderSize.width-s,h=a.position.y+a.treeHeight-l,f=1;return p*h>25e4&&(f=Math.sqrt(25e4/p/h)),p*=f,h*=f,(i=e.call(this,r,p,h,{resolution:window.devicePixelRatio})||this).option={upime:t,scale:f,offsetX:s,offsetY:l,toMoveNodes:n},i}return P(t,e),t.prototype.paint=function(){var e=this.width,t=this.height,n=this.option,i=n.upime,r=n.scale,o=n.offsetX,a=n.offsetY,s=n.toMoveNodes,l={left:o,top:a,right:o+e/r,bottom:a+t/r,scale:r};js.setContext({viewbox:l,upime:i,exportType:"base64"});var c=function(e){e.renderContent(),e.children.forEach(c)};Na((function(n){n.beginFill(16777215),n.lineStyle(1,0,.1),n.drawRoundedRect(.5,.5,e-1,t-1,4)})),fa({x:-o*r,y:-a*r,scaleX:r,scaleY:r}),s.forEach(c),this.finishPaint(),js.popContext()},t}(ba);function zH(e){return"img"===e.nodeTag}var HH=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.docTree=i,r.targetScale=1,r.nodeTag="img",r.childIndex=0,r.children=[],r.supportChild=!1,r.marginTop=12,r.marginBottom=0,r.indentWidth=0,r.nodeSelected=!1,r.blockSelected=!1,r.topDistance=0,r.bottomDistance=0,r.ha="left",r.moving=!1,r.treeHeight=0,r.parentRefSystem=i.docRefsystem,r.nodeCtrlWidget=new UH(r),r}return P(t,e),Object.defineProperty(t.prototype,"showCommonCtrl",{get:function(){return this.nodeSelected||this.blockSelected},enumerable:!1,configurable:!0}),t.prototype.blockBlink=function(){},Object.defineProperty(t.prototype,"parentPath",{get:function(){return this.parent?"root"===this.parent.nodeTag?[]:R(R([],this.parent.parentPath,!0),[this.parent.id],!1):["null"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentId",{get:function(){return this.parent?"root"===this.parent.nodeTag?"root":this.parent.id:"null"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderSize",{get:function(){return{width:this.scale*this.clipRect.width,height:this.scale*this.clipRect.height}},enumerable:!1,configurable:!0}),t.prototype.init=function(e,t){this.dealStateChange(e)},t.prototype.dealStateChange=function(e){var t=e.fileId,n=e.targetScale,i=e.size,r=e.clipRect,o=e.imgType,a=e.name,s=e.ha;void 0!==a&&(this.name=a),void 0!==n&&(this.targetScale=n),o&&(this.imgType=o),void 0!==t&&t!==this.fileId&&(this.fileId=t,delete this.localImage,this.updateImageFile()),i&&(this.size=i),r&&(this.clipRect=r),s&&(this.ha=s)},t.prototype.getInitState=function(){var e=this;return{fileId:e.fileId,targetScale:e.targetScale,size:e.size,clipRect:e.clipRect,imgType:e.imgType,name:e.name,ha:e.ha}},t.prototype.updateOuterWidth=function(e){var t=this.clipRect,n=this.targetScale;t.width*n>e?this.scale=e/t.width:this.scale=n},t.prototype.textSelect=function(e){this.nodeSelected=!0},t.prototype.unTextSelect=function(){this.nodeSelected=!1},t.prototype.getBorderBox=function(){return this.calcBorderBox()},t.prototype.getGlobalBox=function(){var e=this.getBorderBox();return this.globalTransform.applyBorderBox(e)},t.prototype.render=function(){this.renderContent();var e=this,t=e.position,n=t.x,i=t.y,r=e.borderSize,o=e.docTree,a=o.scrollTop,s=o.scale,l=o.size.height;if(i+r.height>a&&i<a+l&&this.renderContent(),(this.nodeSelected||this.blockSelected)&&i+r.height+6>a&&i-6<a+l){var c=js.value.viewbox.scale*s,u=r.width*c,d=r.height*c;Na((function(e){e.lineStyle(1,6134012),e.drawRect(-.5,-.5,u+1,d+1),e.lineStyle({width:2,color:11119017}),e.beginFill(16316666,1),e.drawCircle(-.5,-.5,5),e.drawCircle(u+.5,-.5,5),e.drawCircle(-.5,d+.5,5),e.drawCircle(u+.5,d+.5,5)}),{x:n,y:i,scaleX:1/c,scaleY:1/c})}},t.prototype.renderContent=function(){OA(this)},t.prototype.checkNodeRelation=function(e,t){var n=t.type,i=void 0!==this.docTree.currentEditor,r={},o={transparent:!1,metric:-1,metaData:r};if("select"!==this.upime.xmode||!i)return null;var a=this.docTree.docContentEditor.editing,s=this.nodeCtrlWidget.checkSelectRelation(e,t);if(s)return s;var l={x:e.x-this.position.x,y:e.y-this.position.y},c=this.borderSize,u=l.y>=-this.topDistance/2&&l.y<c.height+this.bottomDistance/2;if("click"===n){var d=t.evt;if("right"===d.connectType)return r.clickData={customData:{type:"textMenu",position:d.globalPosition}},o;if(u)return r.clickData={customData:{type:"nodeSelect",node:this,pointInNode:l}},o}else if("hover"===n){var p=this.nodeCtrlWidget.checkCursor(e);if(!p&&u&&(p=a?"text":""),void 0!==p)return r.clickData={customData:{type:"hover",nodeId:this.id,cursor:p}},o}else if("move"===n&&this.docTree.docContentEditor.editing&&u)return r.directCtrlData={type:"nodeSelect",node:this,pointInNode:l},o;return null},t}(zA),UH=function(){function e(e){this.node=e}return e.prototype.checkCursor=function(e){if(this.node.showCommonCtrl){var t=this.node.getBorderBox();if(Ot(e,t,8)){var n=Ht(e,t,8);return this.getCursorByDirection(n)}}},e.prototype.getCursorByDirection=function(e){switch(e){case"n":case"s":return"ns-resize";case"e":case"w":return"ew-resize";case"ne":case"sw":return"nesw-resize";case"nw":case"se":return"nwse-resize"}return"pointer"},e.prototype.dealCtrlWidgetEvt=function(e,t,n){var i=e.type,r=this.node,o=r.docTree,a=r.upime,s=o.docContentEditor,l=n.isStart,c=n.isEnd;function u(){1===s.selectedNodes.length&&s.selectedNodes[0]===r||(s.selectedNodes.forEach((function(e){return e!==r&&e.unTextSelect()})),r.textSelect(),s.setSelectedNodes([r]))}if("resize"===i){var d=e.direction,p=e.startPoint,h=Gt(e.originBorder,p,t,d,{keepRatio:!0,minSize:20,noExtend:!0}),f=(h.right-h.left)/r.clipRect.width;l&&(u(),s.preventOperationMerge(),a.view.setCursor(this.getCursorByDirection(d),this)),s.changeNodeState(r,{targetScale:f}),c&&(s.preventOperationMerge(),a.view.setCursor("",this)),o.updateRenderFlow()}else"move"===i&&(n.isStart&&(u(),s.startBlockMove([r])),s.updateBlockMove(t),n.isEnd&&s.endBlockMove())},e.prototype.checkSelectRelation=function(e,t){if(!t)return null;if(!this.node.showCommonCtrl)return null;var n=t.type,i=this.node.getBorderBox();if(Ot(e,i,8)){var r=Ht(e,i,8);if("move"===n){var o={type:"ctrlWidget",ctrlData:{},ctrlWidget:this};return o.ctrlData=r?{type:"resize",direction:r,originBorder:i,startPoint:e}:{type:"move"},{transparent:!1,metric:-1,metaData:{directCtrlData:o}}}}return null},e.prototype.dealHoverStart=function(e){},e.prototype.dealHoverEnd=function(){},e.prototype.dealClickStart=function(e){},e.prototype.dealSelectCtrlEvt=function(e){},e.prototype.getBorderBox=function(){return this.node.getBorderBox()},e}(),WH=function(){function e(e,t){this.upime=e,this.contenteditor=t,this.toolbarIdSeq=0,this.needHide=!1}return e.prototype.hideToolbar=function(e){this.needHide=e},e.prototype.start=function(){this.toolbarData=void 0,this.subMousemove(),this.upime.updateView()},e.prototype.subMousemove=function(){var e=this;this.unsub_mousemove&&this.unsub_mousemove(),this.unsub_mousemove=this.upime.userEventManager.subscribe("mousemove",(function(t){t.connected||e.updateToolbar()}))},e.prototype.updateToolbar=function(e){void 0===e&&(e={}),!this.contenteditor.isSelecting||this.needHide?this.removeToolbar():this.toolbarData&&!e.force||this.addToolbar(e)},e.prototype.addToolbar=function(e){var t;void 0===e&&(e={});var n,i=e.refPoint,r=this.contenteditor,o=r.selectedNodes,a=r.reverseSelected;n=1===o.length&&zH(o[0])?"img":"text",this.updatePropertyEditors(n);var s,l=!1;if(!a)if(o.length>1)l=!0;else if(1===o.length&&o[0].textClient){var c=o[0].textClient.contentEditor,u=c.realSelectionStart,d=c.realSelectionEnd;c.getLineIdByIndex(u)!==c.getLineIdByIndex(d,!0)&&(l=!0)}if(l){var p=o[o.length-1];if(Yy(p)){var h=(f=p.textClient.contentEditor).getPositionByIndex(f.realSelectionEnd,!0);s={x:p.position.x+p.textRect.x+h.x,y:p.position.y+p.textRect.y+h.y+p.lineHeight}}else s={x:p.position.x+p.borderSize.width/2,y:p.position.y+p.borderSize.height}}else{var f,m=o[0];if(Yy(m))h=(f=m.textClient.contentEditor).getPositionByIndex(f.realSelectionEnd,!a),s={x:m.position.x+m.textRect.x+h.x,y:m.position.y+m.textRect.y+h.y};else s={x:m.position.x+m.borderSize.width/2,y:m.position.y}}var v=this.contenteditor.element;s.y-=v.scrollTop,s.y<0?s.y=0:s.y>v.size.height&&(s.y=v.size.height),s=v.getScreenPointByDocPoint(s),i&&(s.x=i.x),this.toolbarData={id:""+this.toolbarIdSeq++,type:n,centerPoint:s,atBottom:l},null===(t=this.unsub_mousemove)||void 0===t||t.call(this),this.unsub_mousemove=void 0,this.upime.updateView()},e.prototype.updatePropertyEditors=function(e){var t;null===(t=this.contenteditor.element.currentEditor)||void 0===t||t.resetPropertyEditors(e)},e.prototype.removeToolbar=function(){this.toolbarData=void 0,this.subMousemove(),this.updatePropertyEditors(null),this.upime.updateView()},e.prototype.stop=function(){this.toolbarData=void 0,this.unsub_mousemove&&(this.unsub_mousemove(),this.unsub_mousemove=void 0),this.updatePropertyEditors(null),this.upime.updateView()},e}();function VH(e){var t=e.nodeTag;return"root"===t||"col"===t||"tableCell"===t}function jH(e){return!!e.parent&&VH(e.parent)}var GH=function(){function e(e){var t=this;this.element=e,this.editing=!1,this.isComposing=!1,this.composingId=0,this.undoOperations=[],this.redoOperations=[],this.selectedNodes=[],this.reverseSelected=!1,this._inputLocked=!1,this.deletedNodes=[],this.onCut=function(e){t.preventOperationMerge(),t.isSelecting&&(t.onCopy(e),t.deleteSelected(),t.checkScroll(),t.toolbarCtrl.removeToolbar())},this.onCopy=function(e){if(t.preventOperationMerge(),t.isSelecting){e.preventDefault(),e.stopPropagation();var n=e.clipboardData;if(n){n.clearData();var i=t.getCopyNodeData(),r=t.getCopyImageData();if(r){var o=r.blob,a=r.html;Xd("1",{onCopy:function(e){e.setData("image/png",o),e.setData("text/html",MH(a,JSON.stringify(i)))},forceApi:!0}),t.checkFocusing(!0)}else{var s=t.getCopyHtmlData(),l=t.getCopyRawString();n.setData("text/plain",l),n.setData("text/html",MH(s,JSON.stringify(i)))}}}},this.copySelected=function(){if(t.preventOperationMerge(),t.isSelecting){var e=t.getCopyNodeData(),n=t.getCopyImageData();if(n){var i=n.blob,r=n.html;Xd("1",{onCopy:function(t){t.setData("image/png",i),t.setData("text/html",MH(r,JSON.stringify(e)))},forceApi:!0}),t.checkFocusing(!0)}else{var o=t.getCopyHtmlData(),a=t.getCopyRawString();Xd("1",{onCopy:function(t){t.setData("text/plain",a),t.setData("text/html",MH(o,JSON.stringify(e)))}}),t.checkFocusing(!0)}}},this.cutSelected=function(){t.preventOperationMerge(),t.isSelecting&&(t.copySelected(),t.deleteSelected(),t.checkScroll(),t.toolbarCtrl.removeToolbar())},this.dealPaste=function(e){return A(t,void 0,void 0,(function(){var t,n,i=this;return D(this,(function(r){switch(r.label){case 0:return this.preventOperationMerge(),(n=e)?[3,2]:[4,this.element.upime.readClipboardData()];case 1:n=r.sent(),r.label=2;case 2:return t=n,this.editing&&t?(function(){if(t.htmlData){var e=RH(t.htmlData);if(e){var n=i.transElementInfoToNodes(e);if(n)return void i.pasteCustomData({type:"doc_nodes",data:{nodeDatas:n}})}var r=AH(t.htmlData);if(r&&wH(r))return void i.pasteCustomData(r);var o=Nr(t.htmlData);if(o)return void i.pasteHtmlRichContent(o)}t.imageBlob?i.addImgFromClipboard(t.imageBlob):t.plainData&&i.pastePlainData(t.plainData)}(),this.checkScroll(),this.toolbarCtrl.updateToolbar({force:!0}),[2]):[2]}}))}))},this.pickAll=function(e){void 0===e&&(e=!1),t.editing||t.startEdit();var n=t.selectedNodes;if(!0===e&&1===n.length){var i=n[0];if(i.textClient){var r=i.textClient,o=r.contentEditor,a=r.length;if(0!==o.selectionStart||o.selectionEnd!==a)return o.pickAll(),t.toolbarCtrl.removeToolbar(),void t.element.upime.bigDocManager.showSelectAllToast()}}t.clearSelected();var s=[];!function(e){for(var t=0;t<e.length;t++){var n=e[t].node;s.push(n),n.textSelect(!1)}}(t.element.renderFlow),t.setSelectedNodes(s),t.toolbarCtrl.removeToolbar()},this.toolbarCtrl=new WH(e.upime,this)}return Object.defineProperty(e.prototype,"currentStyle",{get:function(){var e=this.editingText;return e?e.contentEditor.currentStyle:exports.E({},Ry)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canRedo",{get:function(){return this.redoOperations.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canUndo",{get:function(){return this.undoOperations.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalOpManager",{get:function(){return this.element.upime.opManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelecting",{get:function(){if(this.selectedNodes.length>1)return!0;if(1===this.selectedNodes.length){var e=this.selectedNodes[0];return!e.textClient||e.textClient.contentEditor.isSelecting}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showHoverBtn",{get:function(){return 1===this.selectedNodes.length&&!this.selectedNodes[0].textClient||!this.isSelecting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartNode",{get:function(){if(this.selectedNodes.length)return this.reverseSelected?this.selectedNodes[this.selectedNodes.length-1]:this.selectedNodes[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndNode",{get:function(){if(this.selectedNodes.length)return this.reverseSelected?this.selectedNodes[0]:this.selectedNodes[this.selectedNodes.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editingNode",{get:function(){return this.selectedNodes[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editingText",{get:function(){var e=this.selectedNodes[0];return null==e?void 0:e.textClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectStartNodeInfo",{get:function(){return this._selectStartNodeInfo},set:function(e){this._selectStartNodeInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputLocked",{get:function(){return this._inputLocked},set:function(e){},enumerable:!1,configurable:!0}),e.prototype.lockInput=function(e){e!==this._inputLocked&&(this._inputLocked=e,this.textareaDom&&(this.textareaDom.readOnly=e))},Object.defineProperty(e.prototype,"hideSelectRect",{get:function(){var e;return!(!this.editing&&!(null===(e=this.currentAnchorEditor)||void 0===e?void 0:e.editing))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moveBlockData",{get:function(){return this._moveBlockData},set:function(e){var t,n;(null===(n=null===(t=this._moveBlockData)||void 0===t?void 0:t.parentNode)||void 0===n?void 0:n.blockSelected)&&(this._moveBlockData.parentNode.blockSelected=!1),this._moveBlockData=e,this.lockInput(void 0!==e)},enumerable:!1,configurable:!0}),e.prototype.calcGlobalTextRect=function(e){if(this.editingText){var t=this.editingText.contentEditor.calcGlobalTextRect(e);return this.cursorPosition={x:t.x,y:t.y},t}return this.cursorPosition={x:0,y:0},{x:0,y:0,width:0,height:21,fontSize:14}},e.prototype.clearSelected=function(){this.selectedNodes.forEach((function(e){return e.unTextSelect()}))},e.prototype.setSelectedNodes=function(e,t){void 0===t&&(t=!1),this.selectedNodes=e,this.reverseSelected=t,this.textareaDom&&this.editingText,e.forEach((function(t,n){if(t.textClient){var i=t.textClient.contentEditor;i.multiSelected=e.length>1,i.selectedNextNode=e.length>1&&n!==e.length-1}})),this.element.upime.updateView()},e.prototype.clickNode=function(e){var t,n=e.node,i=e.pointInNode;this.editing||this.startEdit(),this.clearSelected(),this.setSelectedNodes([n]),n.textSelect(),null===(t=n.textClient)||void 0===t||t.contentEditor.moveCursorToPosition(i),this.checkFocusing(),this.preventOperationMerge(),this.toolbarCtrl.updateToolbar({force:!0})},e.prototype.dealNodeSelectEvt=function(e,t,n){n.isStart&&this.startNodeSelect(e),this.updateNodeSelect(t),n.isEnd&&(this.endNodeSelect(),this.toolbarCtrl.updateToolbar({refPoint:this.element.getScreenPointByDocPoint(t)}),this.preventOperationMerge())},e.prototype.startNodeSelect=function(e){this.editing||this.startEdit(),this.selectStartNodeInfo=e;var t=e.node,n=e.pointInNode;if(this.clearSelected(),this.setSelectedNodes([]),t.textSelect(),t.textClient){var i=t.textClient.contentEditor,r=i.getIndexByPosition(n).index;e.textIndex=r,i.setSelectionStart(r)}},e.prototype.updateNodeSelect=function(e){var t=this;if(this.selectStartNodeInfo){var n=this.selectStartNodeInfo,i=n.node,r=n.textIndex;this.selectedNodes.forEach((function(e){return e!==i&&e.unTextSelect()}));var o=[],a=!1,s=!1;!function(n){for(var l=0,c=n;l<c.length;l++){var u=c[l],d=u.node;if(u.renderFlows,d===i&&(a=!0,o.push(d),t.reverseSelected=s,Yy(d))){var p=(f=d.richTextClient).contentEditor;s?p.updateSelection(0):p.updateSelection(f.length)}if(s)a||(o.push(d),d.textSelect(!0));else if(e.y<d.position.y)if(s=!0,a){if(d===i){var h=d.textClient;h&&(p=h.contentEditor).updateSelection(0)}}else o.push(d),d.textSelect(!0);else if(e.y>=d.position.y&&e.y<=d.position.y+d.borderSize.height){if(s=!0,a?d!==i&&(o.push(d),d.textSelect(!1)):(o.push(d),d.textSelect(!0)),Yy(d)){var f=d.richTextClient,m=d.textRect,v=(p=f.contentEditor,{x:e.x-d.position.x-m.x,y:e.y-d.position.y-m.y}),g=p.getIndexByPosition(v).index;a?d===i?(t.reverseSelected=g<r,p.updateSelection(g)):(p.setSelectionStart(0),p.setSelectionEnd(g)):(p.setSelectionStart(f.length),p.setSelectionEnd(g))}}else{if(!a)continue;d!==i&&(o.push(d),d.textSelect())}if(s&&a)return}}(this.element.renderFlow),this.setSelectedNodes(o,this.reverseSelected)}},e.prototype.endNodeSelect=function(){this.selectStartNodeInfo=void 0},e.prototype.startBlockMove=function(e){var t=new FH(this.element.upime,e);t.render();var n=tr(t.canvas);this.moveBlockData={toMoveNodes:e,moveSnippetSource:n,moveSnippetSize:{width:t.width,height:t.height},cursorPoint:{x:0,y:0}},e.forEach((function(e){e.blockSelected=!1,e.moving=!0}))},e.prototype.updateBlockMove=function(e){if(this.moveBlockData){var t=this.moveBlockData,n=t.toMoveNodes;t.moveSnippetSource;var i=t.parentNode;i&&i.blockSelected&&(i.blockSelected=!1);for(var r=e.x,o=e.y,a=this.element,s=0;;){var l=a.children,c=void 0;for(s=0;s<l.length;s++){var u=l[s];if(u.position.y+4>o)break;if(!(u.position.y+u.treeHeight<o)&&!u.moving&&"text"===u.nodeTag&&(r>u.position.x&&u.children.length||u.supportChild&&r>u.position.x+u.indentWidth)){c=u;break}}if(!c)break;a=c}for(var d=0,p=n;d<p.length;d++){var h=p[d];if(h.parent===a&&(h.childIndex===s||h.childIndex+1===s))return this.moveBlockData=exports.E(exports.E({},this.moveBlockData),{parentNode:void 0,childIndex:void 0,cursorPoint:e}),void this.element.upime.updateView()}var f=VH(a);this.moveBlockData=exports.E(exports.E({},this.moveBlockData),{cursorPoint:e,parentNode:a,childIndex:s}),f||(a.blockSelected=!0),this.element.upime.updateView()}},e.prototype.endBlockMove=function(){var e=this;if(this.moveBlockData){var t=this.moveBlockData,n=t.toMoveNodes,i=t.parentNode,r=t.childIndex;if(n.forEach((function(e){return e.moving=!1})),i&&i.blockSelected&&(i.blockSelected=!1),void 0!==i&&void 0!==r){var o=0;n.forEach((function(e){e.parent===i&&e.childIndex<r&&o++}));var a=r-o;n.forEach((function(t){e.moveNodeTo(t,i,a++),t.blockBlink()}))}this.moveBlockData=void 0,this.element.upime.updateView()}},e.prototype.clickBottom=function(e,t){var n,i=t[t.length-1].node;this.editing||this.startEdit(),Yy(i)&&i.isEmpty?n=i:(n=this.element.genNewTextNode(),this.createNodeAt(n,e,e.children.length)),this.clearSelected(),n.textSelect(),n.richTextClient.contentEditor.moveCursorToEnd(),this.setSelectedNodes([n]),this.element.updateRenderFlow(),this.checkScroll()},e.prototype.bindDom=function(e){var t=this;e.focus(),e.readOnly=this.inputLocked,this.textareaDom=e,this.isComposing=!1,e.selectionStart=0,e.selectionEnd=0;var n=function(e){t.editing&&t.filterInput(e)},i=function(e){t.filterKeydown(e)},r=function(e){window.ignore_blur||t.stopEdit()},o=function(e){var n;t.isSelecting&&(t.preventOperationMerge(),t.deleteMultiSelected()),t.editing&&(t.isComposing=!0,t.composingId++,t.tempComposingText=t.editingText,null===(n=t.tempComposingText)||void 0===n||n.contentEditor.onCompositionStart(e))},a=function(e){var n;null===(n=t.tempComposingText)||void 0===n||n.contentEditor.onCompositionUpdate(e),t.checkScroll(),t.toolbarCtrl.removeToolbar()},s=function(e){var n;null===(n=t.tempComposingText)||void 0===n||n.contentEditor.onCompositionEnd(e),t.tempComposingText=void 0,t.isComposing=!1,t.checkScroll(),t.toolbarCtrl.removeToolbar()},l=function(e){t.isSelecting&&t.onCut(e)},c=function(e){t.isSelecting&&t.onCopy(e)},u=function(e){var n;e.preventDefault(),e.stopPropagation();var i=t.element.upime.readClipboardDataFromClipboardEvent(e);if(i&&!i.imageBlob&&(null===(n=e.clipboardData)||void 0===n?void 0:n.items.length))for(var r=0;r<e.clipboardData.items.length;r++){var o=e.clipboardData.items[r];if("file"===o.kind){i.imageBlob=o.getAsFile();break}}t.dealPaste(i)},d=function(){},p=function(){void 0!==t.windowBlurTimer&&mr(t.windowBlurTimer)};return e.addEventListener("compositionstart",o),e.addEventListener("compositionupdate",a),e.addEventListener("compositionend",s),e.addEventListener("beforeinput",n),e.addEventListener("blur",r),e.addEventListener("keydown",i),e.addEventListener("cut",l),e.addEventListener("copy",c),e.addEventListener("paste",u),window.addEventListener("focus",d),window.addEventListener("blur",p),function(){e.readOnly=!1,e.removeEventListener("beforeinput",n),e.removeEventListener("blur",r),e.removeEventListener("keydown",i),e.removeEventListener("compositionstart",o),e.removeEventListener("compositionupdate",a),e.removeEventListener("compositionend",s),e.removeEventListener("cut",l),e.removeEventListener("copy",c),e.removeEventListener("paste",u),window.removeEventListener("focus",d),window.removeEventListener("blur",p),t.textareaDom=void 0,t.isComposing=!1}},e.prototype.checkFocusing=function(e){void 0===e&&(e=!1);var t=this.textareaDom;this.editing&&t&&(t!==document.activeElement||e)&&(t.focus(),t.selectionStart=0,t.selectionEnd=0)},e.prototype.startEdit=function(){this.clearActiveMention(),this.editing=!0,this.element.upime.view.setConnectedRichEditor(this),this.globalOpManager.setProxyManager(this),this.toolbarCtrl.start()},e.prototype.stopEdit=function(){if(this.editing){this.editing=!1,this.clearTempData();var e=this.globalOpManager;e.proxyManager===this&&e.setProxyManager(void 0),this.element.upime.view.clearConnectedRichEditor(),this.element.upime.updateView(),this.toolbarCtrl.stop()}},e.prototype.unselect=function(){this.clearTempData(),this.clearCurrentAnchorEditor()},e.prototype.clearCurrentAnchorEditor=function(){this.currentAnchorEditor&&(this.currentAnchorEditor.clear(),this.currentAnchorEditor=void 0)},e.prototype.clearActiveMention=function(){this.activeMentionClient&&(this.activeMentionClient.unSelectMention(),this.activeMentionClient=void 0)},e.prototype.clearTempData=function(){this.tempComposingText=void 0,this.isComposing=!1,this.element.hoverBtn.clearNode(),this.moveBlockData=void 0,this.selectStartNodeInfo=void 0,this.clearActiveMention(),this.clearSelected(),this.setSelectedNodes([])},e.prototype.rollback=function(){var e=this;this.clearTempData(),this.clearCurrentAnchorEditor(),this.element.nodeMap={},this.element.children=[],this.deletedNodes=[],this.bufferAction=void 0,this.waitingAckAction=void 0,this.waitingSendAction=void 0,this.globalOpManager.grepOperationList((function(t){return!e.undoOperations.some((function(e){return e===t}))&&!e.redoOperations.some((function(e){return e===t}))})),this.undoOperations=[],this.redoOperations=[],this.stopEdit()},e.prototype.onRecvAction=function(e){if(this.element.version=e.version,this.bufferAction){if(!(s=_H(e,this.bufferAction)))return;e=s[0],this.bufferAction=s[1]}if(this.waitingAckAction){if(!(s=_H(e,this.waitingAckAction)))return;e=s[0],this.waitingAckAction=s[1]}if(this.waitingSendAction){if(!(s=_H(e,this.waitingSendAction)))return;e=s[0],this.waitingSendAction=s[1]}var t=fe(e),n=fe(e);if(this.undoOperations.length){for(var i=this.undoOperations.length,r=!1,o=0;o<this.undoOperations.length;o++){var a=this.undoOperations[o];r||((s=_H(t,a.docOt))?(t=s[0],a.docOt=s[1]):(r=!0,i=o)),r&&this.globalOpManager.deleteUndoAddRedo(a)}r&&(this.undoOperations.length=i)}if(this.redoOperations.length){for(i=this.redoOperations.length,r=!1,o=0;o<this.redoOperations.length;o++){var s;a=this.redoOperations[o],r||((s=_H(n,a.docOt))?(n=s[0],a.docOt=s[1]):(r=!0,i=o)),r&&this.globalOpManager.deleteRedoAddUndo(a)}r&&(this.redoOperations.length=i)}this.dealDocOtAction(e),this.updateEditorStatusByDocOt(e)},e.prototype.onRecvAck=function(){var e=this.waitingAckAction,t=this.waitingSendAction;e&&(this.waitingAckAction=void 0,this.element.version+=1),t&&(this.waitingSendAction=void 0,this.recordDocAction(t))},e.prototype.dealDocOtAction=function(e,t){var n=this;e.actions.forEach((function(e){var t=e.id,i=e.nodeTag;e.originPosition;var r=e.targetPosition,o=e.targetState,a=e.textOp,s=n.element.nodeMap[t];if(s?(o&&s.dealStateChange(o),a&&s.textClient&&s.textClient.dealRemoteAction({opList:a})):(s=n.element.genNodeByTagAndId(i,t)).init(o||{},a),r)if("null"===r.parentId)n.handleNodeNove(s,null);else{var l=n.element.nodeMap[r.parentId];n.handleNodeNove(s,l,r.index)}})),this.element.updateRenderFlow()},e.prototype.handleNodeNove=function(e,t,n){var i=e.parent;if(i){i.children.splice(e.childIndex,1);for(var r=e.childIndex;r<i.children.length;r++)i.children[r].childIndex=r;e.parent=void 0,e.childIndex=-1}else this.deletedNodes=this.deletedNodes.filter((function(t){return t!==e}));if(null!==t){e.parent=t;var o=n;for(t.children.splice(o,0,e),r=o;r<t.children.length;r++)t.children[r].childIndex=r}else e.parent=void 0,e.childIndex=-1,this.deletedNodes.includes(e)||this.deletedNodes.push(e);this.element.updateRenderFlow()},e.prototype.getNodePosInfo=function(e){return{parentId:e.parentId,path:e.parentPath,index:e.childIndex}},e.prototype.createNodeAt=function(e,t,n){var i,r={id:e.id,nodeTag:e.nodeTag,originPosition:{parentId:"null",index:0,path:["null"]},targetState:e.getInitState(),textOp:null===(i=e.textClient)||void 0===i?void 0:i.content};this.handleNodeNove(e,t,n),r.targetPosition={parentId:e.parentId,path:e.parentPath,index:e.childIndex},this.recordNodeAction(e,r),this.saveHistoryAction(e,r)},e.prototype.moveNodeTo=function(e,t,n){var i={id:e.id,nodeTag:e.nodeTag,originPosition:{parentId:e.parentId,path:e.parentPath,index:e.childIndex}};this.handleNodeNove(e,t,n),i.targetPosition={parentId:e.parentId,path:e.parentPath,index:e.childIndex},this.recordNodeAction(e,i),this.saveHistoryAction(e,i)},e.prototype.deleteNode=function(e){var t={id:e.id,nodeTag:e.nodeTag,originPosition:{parentId:e.parentId,path:e.parentPath,index:e.childIndex}};this.handleNodeNove(e,null),t.targetPosition={parentId:"null",index:0,path:["null"]},this.recordNodeAction(e,t),this.saveHistoryAction(e,t)},e.prototype.mergeTextToPrevNode=function(e){var t=this,n=e.parent;if(n){var i=e.textStyle;if("rawText"!==i.type)return this.preventOperationMerge(),"title"===i.type&&null!==i.index?this.changeTextStyle(e,exports.E(exports.E({},i),{index:null})):this.changeTextStyle(e,{type:"rawText"}),this.element.updateRenderFlow(),void this.preventOperationMerge();var r=e.childIndex<n.children.length-1,o=jH(e);if(r||o){var a=this.getPrevNodeBefore(e);if(!a)return;var s=a.textClient;if(s){this.clearSelected(),a.textSelect(),s.contentEditor.updateCursor(s.length),this.setSelectedNodes([a]),0!==e.textClient.length&&s.contentEditor.addContentToEnd(e.textClient.content);var l=R([],e.children,!0),c=e.childIndex;l.forEach((function(n){t.moveNodeTo(n,e.parent,++c)})),this.deleteNode(e)}else this.clearSelected(),a.textSelect(),this.setSelectedNodes([a]),0===e.textClient.length&&this.deleteNode(e)}else n.parent&&this.moveNodeTo(e,n.parent,n.childIndex+1)}},e.prototype.mergeNextNodeText=function(e){var t=this,n=this.getNextNodeAfter(e);if(n){var i=n.textClient;if(i){i.length&&e.textClient.contentEditor.addContentToEnd(i.content);var r=R([],n.children,!0),o=n.childIndex;r.forEach((function(e){t.moveNodeTo(e,n.parent,++o)})),this.deleteNode(n)}else this.clearSelected(),n.textSelect(),this.setSelectedNodes([n]),0===e.textClient.length&&this.deleteNode(e)}},e.prototype.getNextNodeAfterNodeBlock=function(e){var t=e.parent;if(t){for(var n=t.children[e.childIndex+1];!n;){if(!(t=(e=t).parent)||"root"===t.nodeTag)return;n=t.children[e.childIndex+1]}return n}},e.prototype.deleteNodeBlock=function(e){var t=!0,n=void 0;if((n=this.getPrevNodeBefore(e))||(n=this.getNextNodeAfterNodeBlock(e),t=!1),this.preventOperationMerge(),this.clearSelected(),n){this.deleteNode(e),n.textSelect();var i=n.textClient;i&&i.contentEditor.updateCursor(t?i.length:0),this.setSelectedNodes([n])}else{var r=e.parent,o=e.childIndex;this.deleteNode(e);var a=this.element.genNewTextNode();this.createNodeAt(a,r,o),a.textSelect(),a.textClient.contentEditor.updateCursor(0),this.setSelectedNodes([a])}this.preventOperationMerge(),this.element.updateRenderFlow()},e.prototype.deleteOneSelectNode=function(e,t){void 0===t&&(t=!0);var n=void 0;if(t?(n=this.getPrevNodeBefore(e))||(n=this.getNextNodeAfter(e),t=!1):(n=this.getNextNodeAfter(e))||(n=this.getPrevNodeBefore(e),t=!0),this.preventOperationMerge(),e.unTextSelect(),n){this.deleteNode(e),n.textSelect();var i=n.textClient;i&&i.contentEditor.updateCursor(t?i.length:0),this.setSelectedNodes([n])}else{var r=e.parent,o=e.childIndex;this.deleteNode(e);var a=this.element.genNewTextNode();this.createNodeAt(a,r,o),a.textSelect(),a.textClient.contentEditor.updateCursor(0),this.setSelectedNodes([a])}this.preventOperationMerge(),this.element.updateRenderFlow()},e.prototype.deleteSelected=function(){var e=this.selectedNodes;if(e.length>1)this.deleteMultiSelected();else if(1===e.length){var t=e[0];t.textClient?t.textClient.contentEditor.deleteSelected():this.deleteOneSelectNode(t)}},e.prototype.deleteMultiSelected=function(){var e=this.selectedNodes;if(e.length>1){var t=e[0],n=e[e.length-1],i=R([],e,!0),r=void 0,o=void 0;t.textClient?(r=t,(o=t.textClient).contentEditor.deleteSelected(),i=i.slice(1)):(o=(r=this.element.genNewTextNode()).textClient,r.textSelect(),o.contentEditor.updateCursor(0),this.createNodeAt(r,t.parent,t.childIndex));var a=null==n?void 0:n.textClient;if(a){var s=a.contentEditor,l=a.length,c=a.contentEditor.getRichTextByRange(s.selectionEnd,l);o.contentEditor.addContentToEnd(c)}i.forEach((function(e){e.unTextSelect()})),this.setSelectedNodes([r]),this.deleteNodeSaveChild(i,r,0)}},e.prototype.filterInput=function(e){var t;if("insertCompositionText"===e.inputType||e.isComposing)null===(t=this.editingText)||void 0===t||t.contentEditor.handleDocInput(e);else{switch(e.inputType){case"deleteContentBackward":case"deleteContentForward":this.selectedNodes.length>1?this.deleteMultiSelected():1===this.selectedNodes.length&&((n=this.selectedNodes[0]).textClient?n.textClient.contentEditor.handleDocInput(e):this.deleteOneSelectNode(n,"deleteContentBackward"===e.inputType));break;default:var n;this.selectedNodes.length>1&&this.deleteMultiSelected(),1===this.selectedNodes.length&&(n=this.selectedNodes[0]).textClient&&n.textClient.contentEditor.handleDocInput(e)}this.checkScroll(),this.toolbarCtrl.removeToolbar()}},e.prototype.getFirstNode=function(){return function(e){for(var t=0;t<e.length;t++){var n=e[t],i=n.node;return n.renderFlows,i}}(this.element.renderFlow)},e.prototype.getLastNode=function(){return function(e){for(var t=e.length-1;t>=0;t--){var n=e[t],i=n.node;return n.renderFlows,i}}(this.element.renderFlow)},e.prototype.selectToDocStart=function(e){var t,n=this.selectionStartNode;if(e&&n){this.selectedNodes.forEach((function(e){return e!==n&&e.unTextSelect()}));var i=!1,r=[];!function(e){for(var t,o=0;o<e.length;o++){var a=e[o].node;if(r.push(a),a===n?(i=!0,null===(t=a.textClient)||void 0===t||t.contentEditor.updateSelection(0)):a.textSelect(!0),i)break}}(this.element.renderFlow),this.setSelectedNodes(r,!0)}else{this.clearSelected(),this.setSelectedNodes([]);var o=this.getFirstNode();o&&(this.setSelectedNodes([o]),o.textSelect(),null===(t=o.textClient)||void 0===t||t.contentEditor.updateCursor(0))}},e.prototype.selectToDocEnd=function(e){var t=this.selectionStartNode;if(e&&t){this.selectedNodes.forEach((function(e){return e!==t&&e.unTextSelect()}));var n=!1,i=[];!function(e){for(var r=0;r<e.length;r++){var o=e[r].node;(n||o===t)&&(o===t?(n=!0,i.push(o),o.textClient&&o.textClient.contentEditor.updateSelection(o.textClient.length)):(i.push(o),o.textSelect(!1)))}}(this.element.renderFlow),this.setSelectedNodes(i)}else{this.clearSelected(),this.setSelectedNodes([]);var r=this.getLastNode();r&&(this.setSelectedNodes([r]),r.textSelect(),r.textClient&&r.textClient.contentEditor.updateCursor(r.textClient.length))}},e.prototype.selectToPrevNode=function(e){var t=this,n=e.shiftKey,i=e.pointInDoc,r=this.selectedNodes;if(0!==r.length){var o=function(e){var n;null===(n=e.textClient)||void 0===n||n.contentEditor.updateSelection(0);var o=t.getPrevNodeBefore(e);if(o){t.setSelectedNodes(R([o],r,!0),!0),o.textSelect(!0);var a=o.textClient;if(a){var s=a.length;if(i){var l={x:i.x-o.position.x-a.textRect.x,y:a.textRect.height};s=a.contentEditor.getIndexByPosition(l).index}a.contentEditor.updateSelection(s)}}};if(n){if(this.reverseSelected)o(r[0]);else if(1===r.length)o(u=r[0]);else if(r[r.length-1].unTextSelect(),r.length-=1,this.setSelectedNodes(r),i){var a=this.selectedNodes[this.selectedNodes.length-1];if(c=a.textClient){var s={x:i.x-a.position.x-c.textRect.x,y:c.textRect.height},l=c.contentEditor.getIndexByPosition(s).index;c.contentEditor.updateSelection(l)}}}else{var c,u=r[0],d=this.getPrevNodeBefore(u);d&&(this.clearSelected(),this.setSelectedNodes([d],!0),d.textSelect(!0),(c=d.textClient)&&(l=c.length,i&&(s={x:i.x-d.position.x-c.textRect.x,y:c.textRect.height},l=c.contentEditor.getIndexByPosition(s).index),c.contentEditor.updateCursor(l)))}}},e.prototype.selectToNextNode=function(e){var t=this,n=e.shiftKey,i=e.pointInDoc,r=this.selectedNodes;if(0!==r.length){var o=function(e){e.textClient&&e.textClient.contentEditor.updateSelection(e.textClient.length);var n=t.getNextNodeAfter(e);if(n){t.setSelectedNodes(R(R([],r,!0),[n],!1)),n.textSelect(!1);var o=n.textClient;if(o){var a=0;if(i){var s={x:i.x-n.position.x-o.textRect.x,y:0};a=o.contentEditor.getIndexByPosition(s).index}o.contentEditor.updateSelection(a)}}};if(n)if(this.reverseSelected){if(1===r.length)o(u=r[0]);else if(r[0].unTextSelect(),this.setSelectedNodes(r.slice(1)),i){var a=this.selectedNodes[0];if(c=a.textClient){var s={x:i.x-a.position.x-c.textRect.x,y:0},l=c.contentEditor.getIndexByPosition(s).index;c.contentEditor.updateSelection(l)}}}else o(r[r.length-1]);else{var c,u=r[r.length-1],d=this.getNextNodeAfter(u);d&&(this.clearSelected(),this.setSelectedNodes([d]),d.textSelect(),(c=d.textClient)&&(l=0,i&&(s={x:i.x-d.position.x-c.textRect.x,y:0},l=c.contentEditor.getIndexByPosition(s).index),c.contentEditor.updateCursor(l)))}}},e.prototype.getPrevNodeBefore=function(e){var t=void 0,n=!1;return function(i){for(var r=0;r<i.length;r++){var o=i[r].node;if(o===e?n=!0:t=o,n)break}}(this.element.renderFlow),n?t:void 0},e.prototype.getNextNodeAfter=function(e){var t=void 0,n=!1;return function(i){for(var r=0;r<i.length;r++){var o=i[r].node;if(o===e?n=!0:n&&!t&&(t=o),n&&t)break}}(this.element.renderFlow),t},e.prototype.filterKeydown=function(e){var t;if(this.element.hoverBtn.clearNode(),this.moveBlockData||this.selectStartNodeInfo)e.preventDefault();else if(!e.isComposing){var n=this.selectionEndNode;if(!(null===(t=this.editingText)||void 0===t?void 0:t.contentEditor.mentionHandleKeydown(e))){var i=null==n?void 0:n.textClient,r=e.key,o=e.shiftKey,a=e.ctrlKey,s=e.metaKey;if("Home"===r||_e.isMac&&"ArrowLeft"===r&&s||!_e.isMac&&"ArrowLeft"===r&&a)this.preventOperationMerge(),e.preventDefault(),e.ctrlKey&&("Home"===r||_e.isMac&&"ArrowLeft"===r&&s)?this.selectToDocStart(o):i&&i.contentEditor.handleDocKeydown(e),this.checkScroll(),this.toolbarCtrl.removeToolbar();else if("End"===r||_e.isMac&&"ArrowRight"===r&&s||!_e.isMac&&"ArrowRight"===r&&a)this.preventOperationMerge(),e.preventDefault(),e.ctrlKey&&("End"===r||_e.isMac&&"ArrowRight"===r&&s)?this.selectToDocEnd(o):i&&i.contentEditor.handleDocKeydown(e),this.checkScroll(),this.toolbarCtrl.removeToolbar();else if("ArrowLeft"===r||"ArrowRight"===r||"ArrowUp"===r||"ArrowDown"===r){if(this.preventOperationMerge(),e.preventDefault(),!this.selectedNodes.length)return;if(this.selectedNodes.length>1&&!o){var l,c=this.selectedNodes[0],u=this.selectedNodes[this.selectedNodes.length-1];l="ArrowLeft"===r?c:"ArrowRight"===r?u:this.reverseSelected?c:u,this.selectedNodes.forEach((function(e){return e!==l&&e.unTextSelect()})),this.setSelectedNodes([l]),i=l.textClient}i?i.contentEditor.handleDocKeydown(e):"ArrowLeft"===r||"ArrowUp"===r?this.selectToPrevNode({shiftKey:o}):this.selectToNextNode({shiftKey:o}),this.checkScroll(),this.toolbarCtrl.removeToolbar()}else if("z"===r.toLowerCase())(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.dealUndo());else if("y"===r.toLowerCase())(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.dealRedo());else if("a"===r.toLowerCase())(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.pickAll(!0));else if("b"===r.toLowerCase());else if("i"===r.toLowerCase());else if("u"===r.toLowerCase());else if("Enter"===r){if(0===this.selectedNodes.length);else if(1===this.selectedNodes.length){var d=e.shiftKey,p=e.ctrlKey||e.metaKey,h=this.selectedNodes[0];d&&!p&&h.textClient||(e.preventDefault(),this.insertNewLineWithNode({ctrlKey:p,shiftKey:d}),this.checkScroll())}else e.preventDefault(),this.insertNewLineWithNode(),this.checkScroll();this.toolbarCtrl.removeToolbar()}else"Escape"===r?(e.preventDefault(),this.stopEdit()):"Tab"===r&&(this.onTab(e),this.toolbarCtrl.removeToolbar())}}},e.prototype.onTab=function(e){var t=this;e.preventDefault();var n=this.selectedNodes;if(n.length>0){var i=n[0];if(e.shiftKey)for(var r=new Set,o=function(e){for(var n=e.parent,i=e.childIndex,o=n.childIndex+1;;){r.add(e);var a=n.children[i+1];if(!a){t.moveNodeTo(e,n.parent,o);break}if(!a.nodeSelected&&e.supportChild){n.children.slice(i+1).forEach((function(n){t.moveNodeTo(n,e,e.children.length)})),t.moveNodeTo(e,n.parent,o);break}t.moveNodeTo(e,n.parent,o++),e=a}},a=0;a<n.length;a++){var s=n[a],l=s.parent;if(jH(s)){if(0===a)return}else l.nodeSelected||r.has(s)||o(s)}else if(i.parent&&0!==i.childIndex){var c=i.parent.children[i.childIndex-1];c.supportChild&&n.forEach((function(e){e.parent&&!e.parent.nodeSelected&&t.moveNodeTo(e,c,c.children.length)}))}}this.element.updateRenderFlow()},e.prototype.insertNewLineWithNode=function(e){var t,n=void 0===e?{}:e,i=n.ctrlKey,r=void 0!==i&&i,o=n.shiftKey,a=void 0!==o&&o,s=this.selectedNodes;s.length>1?this.deleteMultiSelected():1===s.length&&(h=null===(t=s[0].textClient)||void 0===t?void 0:t.contentEditor)&&(r||a||!h.isSelecting||h.deleteSelected());var l=this.selectedNodes[0];if(l){var c=this.element.genNewTextNode(),u={type:"rawText"};if(Yy(l)){var d=l.textStyle;"title"===d.type?l.textClient.contentEditor.selectionEnd!==l.textClient.length&&(u={type:"title",level:d.level,index:null===d.index?null:-1}):"orderedList"===d.type?u={type:"orderedList",index:-1}:"list"===d.type&&(u={type:"list"})}if(c.dealStateChange({textStyle:u}),a||r||!l.textClient||0!==l.textClient.contentEditor.selectionStart){a?this.createNodeAt(c,l.parent,l.childIndex):l.children.length?this.createNodeAt(c,l,0):this.createNodeAt(c,l.parent,l.childIndex+1),c.textSelect(),c.textClient.contentEditor.updateCursor(0);var p=l.textClient;if(!a&&!r&&p){var h,f=p.length,m=(h=p.contentEditor).selectionEnd;if(f>m){var v=h.getRichTextByRange(m,f);h.setSelectionStart(m),h.updateSelection(f),h.deleteSelected(),c.richTextClient.contentEditor.addContentToEnd(v)}}l.unTextSelect(),this.setSelectedNodes([c])}else this.createNodeAt(c,l.parent,l.childIndex)}},e.prototype.getCopyNodeData=function(){for(var e=[],t=0,n={},i=0;i<this.selectedNodes.length;i++){var r=this.selectedNodes[i],o=t+++"";n[r.id]=o;var a={id:o,originPosition:{parentId:n[r.parentId]||"",index:0,path:[]},nodeTag:r.nodeTag,targetState:r.getInitState()};r.textClient&&(a.textOp=r.textClient.contentEditor.getSelectedContent()),e.push(a)}return{type:"doc_nodes",data:{nodeDatas:e}}},e.prototype.getCopyHtmlData=function(){for(var e=document.createElement("div"),t=0,n=this.selectedNodes;t<n.length;t++){var i=n[t];if(i.textClient){var r=i.textClient.contentEditor.convertSelectedRichText2HTML();r&&e.appendChild(r)}}return e.outerHTML},e.prototype.getCopyRawString=function(){for(var e="",t=!0,n=0,i=this.selectedNodes;n<i.length;n++){var r=i[n];if(r.textClient){var o=r.textClient,a=o.chars,s=o.contentEditor;t?t=!1:e+="\n",e+=Ei(a,s.selectionStart,s.selectionEnd)}}return e},e.prototype.getCopyImageData=function(){var e=this.selectedNodes[0];if(1===this.selectedNodes.length&&zH(e)){var t=e.renderingSource;if(t&&t.loaded){var n=at;n.width=t.originWidth,n.height=t.originHeight,st.drawImage(t.content,0,0);var i=n.toDataURL("image/png"),r=document.createElement("img");r.src=i;var o=r.outerHTML;return{blob:K(i),html:o}}}},e.prototype.transElementInfoToNodes=function(e){for(var t=[],n=0,i=0,r=e;i<r.length;i++){var o=r[i];if(o.elementType===Za.IMAGE){var a=o.data,s={id:"".concat(n++),nodeTag:"img",originPosition:{parentId:"",index:0,path:[]},targetState:{name:a.name,clipRect:a.clipRect,size:a.size,targetScale:a.scale,imgType:a.imgType,fileId:a.fileId}};t.push(s)}}return 1===e.length&&t.length?t:null},e.prototype.replaceOneSelectedNodeWithText=function(e){var t=e.parent,n=e.childIndex;e.unTextSelect(),this.deleteNode(e);var i=this.element.genNewTextNode();return this.createNodeAt(i,t,n),i.textSelect(),i.textClient.contentEditor.updateCursor(0),this.setSelectedNodes([i]),i},e.prototype.pasteSingleText=function(e){if(this.selectedNodes.length>1&&this.deleteMultiSelected(),1===this.selectedNodes.length){var t=this.selectedNodes[0];if(t.textClient){var n=t.textClient.contentEditor;n.deleteSelected(),e.textOp&&n.addContent(e.textOp)}else this.replaceOneSelectedNodeWithText(t).textClient.contentEditor.addContent(e.textOp)}this.checkScroll()},e.prototype.pasteDatasToSingleText=function(e){var t=this.selectedNodes[0],n=t.textClient,i=n.contentEditor,r=n.length,o=i.getRichTextByRange(i.selectionEnd,r);r>i.selectionStart&&i.deleteContentByRange(i.selectionStart,r);var a=t.children.length>0,s=a?t:t.parent,l=null,c=a?0:t.childIndex+1;if("text"===e[0].nodeTag){var u=e[0];u.textOp&&(i.addContentToEnd(u.textOp),l=u.id)}else a||0!==r||(c=t.childIndex,this.deleteNode(t));for(var d={},p=0,h=void 0,f=l?1:0;f<e.length;f++){var m=e[f],v=m.originPosition.parentId,g=v===l?t:""===v?s:d[v];if(g){var y=void 0;if("text"===m.nodeTag){var b=this.element.genNewTextNode();b.textClient.initContent(m.textOp||[]),y=b}else"img"===m.nodeTag&&(y=this.element.genNewImgNode());if(y){m.targetState&&y.dealStateChange(m.targetState);var E=void 0;v===l?(E=p++,a&&c++):E=""===v?c++:g.children.length,this.createNodeAt(y,g,E),h=y,d[m.id]=y}}}var x=void 0;h&&Yy(h)&&(x=h),x?(x.textSelect(),x.textClient.contentEditor.moveCursorToEnd(),x.textClient.contentEditor.addContentToEnd(o)):o.length&&((x=this.element.genNewTextNode()).textClient.initContent(o),this.createNodeAt(x,s,c++),x.textSelect(),x.textClient.contentEditor.updateCursor(0),h=x),this.clearSelected(),h?this.setSelectedNodes([h]):this.setSelectedNodes([])},e.prototype.pasteDatasToNodes=function(e){var t=this.selectedNodes[0],n=t.children.length>0,i=n?t:t.parent,r=this.selectedNodes.slice(0),o=e,a=null;if(Yy(t)){r=this.selectedNodes.slice(1);var s=t.textClient,l=s.contentEditor,c=s.length;if(l.deleteContentByRange(l.selectionStart,c),"text"===e[0].nodeTag){var u=e[0];u.textOp&&(l.addContentToEnd(u.textOp),a=u.id,o=o.slice(1))}}t.unTextSelect();var d=void 0,p=void 0,h=this.selectedNodes[this.selectedNodes.length-1];if(Yy(h)){var f=h.textClient,m=(l=f.contentEditor,f.length);if(r.includes(h.parent))p=l.getRichTextByRange(l.selectionEnd,m);else if(d=h,r=r.slice(0,r.length-1),"text"===o[o.length-1].nodeTag){var v=o.pop();v.textOp&&(l.updateCursor(0),l.addContent(v.textOp))}}for(var g={},y=n?0:t.childIndex+1,b=0,E=i,x=void 0,w=0;w<o.length;w++){var C=o[w],S=C.originPosition.parentId,k=S===a?t:""===S?i:g[S];if(k){var _=void 0;if("text"===C.nodeTag){var T=this.element.genNewTextNode();T.textClient.initContent(C.textOp||[]),_=T}else"img"===C.nodeTag&&(_=this.element.genNewImgNode());if(_){C.targetState&&_.dealStateChange(C.targetState);var I=void 0;S===a?(I=b++,n&&y++):I=""===S?y++:k.children.length,this.createNodeAt(_,k,I),x=_,g[C.id]=_,n||""!==S||(E=_)}}}if(r.forEach((function(e){e.unTextSelect()})),d)this.setSelectedNodes([d]);else{var P=void 0;x&&Yy(x)&&(P=x),P?(P.textSelect(),P.textClient.contentEditor.moveCursorToEnd(),p&&P.textClient.contentEditor.addContentToEnd(p)):p&&((P=this.element.genNewTextNode()).textClient.initContent(p),this.createNodeAt(P,i,y++),n||(E=P),P.textSelect(),P.textClient.contentEditor.moveCursorToEnd(),x=P),x?this.setSelectedNodes([x]):this.setSelectedNodes([])}this.deleteNodeSaveChild(r,E,y)},e.prototype.pasteCustomData=function(e){if(0!==this.selectedNodes.length){var t=e.data.nodeDatas;0!==t.length&&(1!==t.length||"text"!==t[0].nodeTag?1!==this.selectedNodes.length||"text"!==this.selectedNodes[0].nodeTag?this.pasteDatasToNodes(t):this.pasteDatasToSingleText(t):this.pasteSingleText(t[0]))}},e.prototype.pasteHtmlRichContent=function(e){if(0!==this.selectedNodes.length&&e&&(this.selectedNodes.length>1&&this.deleteMultiSelected(),1===this.selectedNodes.length)){var t=this.selectedNodes[0];t.textClient?(t.textClient.contentEditor.deleteSelected(),t.textClient.contentEditor.addContent(e)):this.replaceOneSelectedNodeWithText(t).textClient.contentEditor.addContent(e)}},e.prototype.pastePlainData=function(e){if(0!==this.selectedNodes.length&&(this.selectedNodes.length>1&&this.deleteMultiSelected(),1===this.selectedNodes.length)){var t=this.selectedNodes[0];t.textClient?(t.textClient.contentEditor.deleteSelected(),t.textClient.contentEditor.pastePlainData(e)):this.replaceOneSelectedNodeWithText(t).textClient.contentEditor.pastePlainData(e)}},e.prototype.recordTextOp=function(e,t){var n={id:e.id,originPosition:{parentId:e.parentId,index:e.childIndex,path:e.parentPath},nodeTag:e.nodeTag,textOp:t.opList},i=exports.E(exports.E({},n),{textReverseOp:t.reverseOpList});this.recordNodeAction(e,n),this.saveHistoryAction(e,i)},e.prototype.changeNodeState=function(e,t,n){void 0===n&&(n=!0);var i={id:e.id,originPosition:{parentId:e.parentId,index:e.childIndex,path:e.parentPath},nodeTag:e.nodeTag,targetState:t},r={};for(var o in t)r[o]=e[o];var a=exports.E(exports.E({},i),{originState:r});this.recordNodeAction(e,i),n&&this.saveHistoryAction(e,a),e.dealStateChange(t)},e.prototype.changeTextStyle=function(e,t){var n={textStyle:t};this.changeNodeState(e,n)},e.prototype.recordDocAction=function(e){var t=this,n=this.element;if(this.waitingAckAction)if(this.waitingSendAction)for(var i=0,r=e.actions;i<r.length;i++)s=r[i],this.waitingSendAction=IH(this.waitingSendAction,s);else this.waitingSendAction=e;else if(this.bufferAction)for(var o=0,a=e.actions;o<a.length;o++){var s=a[o];this.bufferAction=IH(this.bufferAction,s)}else this.bufferAction=e,e.version=n.version,Promise.resolve().then((function(){var e=t.bufferAction;e&&(e.version=n.version,t.waitingAckAction=e,n.upime.bigDocManager.sendDocAction(n,e),t.bufferAction=void 0)}))},e.prototype.recordNodeAction=function(e,t){var n={version:this.element.version,actions:[t]};this.recordDocAction(n)},e.prototype.saveHistoryAction=function(e,t){var n={id:t.id,nodeTag:t.nodeTag,originPosition:t.originPosition,textOp:t.textReverseOp,targetState:t.originState};t.targetPosition&&(n.originPosition=t.targetPosition,n.targetPosition=t.originPosition);var i=this.currentOperation;!i||i.lastEditTime<Date.now()-1e3&&(!this.isComposing||i.composingId!==this.composingId)?((i=this.startNewOperation()).docOt={version:0,actions:[n]},this.isComposing&&(i.composingId=this.composingId)):(i.docOt=function(e,t){var n=e.actions;if(n.length&&n[0].id===t.id){var i=n[0];t.textOp&&(i.textOp?i.textOp=Is(t.textOp,i.textOp):i.textOp=t.textOp),t.targetPosition&&(i.originPosition=t.originPosition),t.targetState&&(i.targetState?i.targetState=exports.E(exports.E({},t.targetState),i.targetState):i.targetState=t.targetState)}else n.unshift(t);return e}(i.docOt,n),i.lastEditTime=Date.now(),this.isComposing&&(i.composingId=this.composingId))},e.prototype.startNewOperation=function(){var e=new OH(this);return this.currentOperation=e,this.undoOperations.unshift(e),this.redoOperations=[],this.globalOpManager.insertAnyOperation(e),e},e.prototype.preventOperationMerge=function(){this.currentOperation=void 0},e.prototype.dealUndo=function(){if(this.undoOperations.length){this.preventOperationMerge();var e=this.undoOperations[0],t=this.undoOp(e);this.globalOpManager.deleteUndoAddRedo(e,t)}},e.prototype.dealRedo=function(){if(this.redoOperations.length){this.preventOperationMerge();var e=this.redoOperations[0],t=this.redoOp(e);this.globalOpManager.deleteRedoAddUndo(e,t)}},e.prototype.removeUndo=function(e){this.undoOperations=this.undoOperations.filter((function(t){return t!==e}))},e.prototype.removeRedo=function(e){this.redoOperations=this.redoOperations.filter((function(t){return t!==e}))},e.prototype.getReverseOp=function(e){var t=this,n=new OH(this);return e.docOt.actions.forEach((function(e){var i=t.element.nodeMap[e.id];if(i){var r={id:e.id,originPosition:e.originPosition,nodeTag:e.nodeTag};if(e.targetPosition&&(r.originPosition=e.targetPosition,r.targetPosition=e.originPosition),e.textOp&&i.textClient&&(r.textOp=i.textClient.contentEditor.calcReverseOt(e.textOp)),e.targetState)for(var o in e.targetState)r[o]=i[o];n.docOt.actions.unshift(r)}})),n},e.prototype.undoOp=function(e){this.undoOperations[0],this.undoOperations.shift();var t=this.getReverseOp(e);return t.isUndo=!1,this.recordDocAction(e.docOt),this.dealDocOtAction(e.docOt,!0),this.updateCursorBySelfOperation(e),this.redoOperations.unshift(t),t},e.prototype.redoOp=function(e){this.redoOperations[0],this.redoOperations.shift();var t=this.getReverseOp(e);return t.isUndo=!0,this.recordDocAction(e.docOt),this.dealDocOtAction(e.docOt,!0),this.updateCursorBySelfOperation(e),this.undoOperations.unshift(t),t},e.prototype.updateCursorBySelfOperation=function(e){this.editing&&this.updateEditorStatusByDocOt(e.docOt)},e.prototype.updateCursorByDocOt=function(e){var t=this;if(1===this.selectedNodes.length){var n=this.selectedNodes[0],i=void 0;if(!n.textClient||!n.textClient.contentEditor.isSelecting){if(n.parent){for(var r=n;r.parent&&"root"!==(r=r.parent).nodeTag;)if(!r.parent){i=r;break}}else i=n;if(i){this.clearSelected(),this.setSelectedNodes([]),this.toolbarCtrl.removeToolbar();for(var o=void 0,a=0,s=0,l=e.actions;s<l.length;s++){var c=l[s];if(c.id===i.id){var u=this.element.nodeMap[c.originPosition.parentId];if(!u)return;o=u,a=c.originPosition.index-1;break}}if(!o)return;o.children.length-1<a&&(a=o.children.length-1);var d=void 0,p=!0;if(-1===a)if("root"===o.nodeTag){var h=function(e){return e.children.length?h(e.children[0]):e};d=h(o[0]),p=!1}else d=o;else{var f=function(e){return e.children.length?f(e.children[e.children.length-1]):e};d=f(o.children[a])}if(!d)return;return this.clearSelected(),d.textSelect(),d.textClient&&d.textClient.contentEditor.updateCursor(p?d.textClient.length:0),void this.setSelectedNodes([d])}}}for(var m=[],v=0,g=this.selectedNodes;v<g.length;v++){var y=g[v];rU(y)?y.unTextSelect():m.push(y)}if(!m.length)return this.setSelectedNodes([]),void this.toolbarCtrl.removeToolbar();if(m.length>1){var b=0,E=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i.node,o=i.renderFlows;if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(E(l))return!0}else if(r===m[b]){if((b+=1)===m.length)return!0}else if(0!==b)return!0}};if(E(this.element.renderFlow),b!==m.length)return m.forEach((function(e){return e.unTextSelect()})),this.setSelectedNodes([]),void this.toolbarCtrl.removeToolbar()}e.actions.forEach((function(e){var n=t.element.nodeMap[e.id];if(n.textClient&&e.textOp){var i=n.textClient.contentEditor;if(!n.nodeSelected)return i.anchorEditor&&i.transformAnchorPos(e.textOp),void(i.hoveredMention&&i.transformMentionEditor(e.textOp));i.fullSelected?i.fullSelect(0!==i.realSelectionStart):(i.updateContentByRemoteAction({opList:e.textOp}),n!==t.selectedNodes[0]&&(i.realSelectionStart<=i.realSelectionEnd?i.setSelectionStart(0):i.setSelectionEnd(0)))}})),this.toolbarCtrl.toolbarData&&1===m.length&&m[0].nodeTag!==this.toolbarCtrl.toolbarData.type&&this.toolbarCtrl.updateToolbar({force:!0})},e.prototype.checkSelectingAfterDocOt=function(e){var t=this.selectStartNodeInfo;if(t){var n=t.node;if(n.parent){var i=t.textIndex;if(void 0!==i){for(var r=0,o=e.actions;r<o.length;r++){var a=o[r];a.id===n.id&&a.textOp&&(i=Oy(i,a.textOp))}t.textIndex=i}}else this.selectStartNodeInfo=void 0}},e.prototype.checkMoveDataAfterDocOt=function(e){var t=this.moveBlockData;if(t){for(var n=t.toMoveNodes,i=t.cursorPoint,r=!1,o=0,a=n;o<a.length;o++)if(!a[o].parent){r=!0;break}r?this.moveBlockData=void 0:this.updateBlockMove(i)}},e.prototype.updateEditorStatusByDocOt=function(e){this.updateCursorByDocOt(e),this.checkSelectingAfterDocOt(e),this.checkMoveDataAfterDocOt(e)},e.prototype.setRichStyle=function(e){this.preventOperationMerge(),this.selectedNodes.forEach((function(t){t.textClient&&t.textClient.contentEditor.setRichStyle(e)})),this.preventOperationMerge()},e.prototype.slideSetRichStyle=function(e,t){},e.prototype.getTextPropertyStatus=function(e){for(var t=0,n=this.selectedNodes;t<n.length;t++){var i=n[t];if(i.textClient)return i.textClient.contentEditor.getTextPropertyStatus(e)}return!1},e.prototype.toggleTextStyleProperty=function(e){this.preventOperationMerge();var t=!this.getTextPropertyStatus(e);this.selectedNodes.forEach((function(n){n.textClient&&n.textClient.contentEditor.setTextStyle(e,t)})),this.preventOperationMerge()},Object.defineProperty(e.prototype,"canAddAnchor",{get:function(){return 1===this.selectedNodes.length&&void 0!==this.selectedNodes[0].textClient},enumerable:!1,configurable:!0}),e.prototype.addAnchorLink=function(){var e=this.editingText;e&&(e.contentEditor.addAnchorLink(),this.checkScroll())},e.prototype.checkScroll=function(){var e=this,t=e.selectionEndNode,n=e.reverseSelected,i=e.element;if(t){if(this.element.calcRenderFlowIfChanged(),!t.textClient){var r=t.position,o=t.borderSize;return r.y-8<i.scrollTop&&i.setScrollTop(r.y-8),void(r.y+o.height+8>i.scrollTop+i.size.height&&i.setScrollTop(r.y+o.height+8-i.size.height))}if(t.textClient){var a=t.textClient,s=a.contentEditor,l=a.textRect,c=s.realSelectionEnd,u=s.isSelecting,d=s.getPositionByIndex(c,u&&!n),p={x:t.position.x+l.x+d.x,y:t.position.y+l.y+d.y};p.y-8<i.scrollTop&&i.setScrollTop(p.y-8);var h=t.lineHeight||0;p.y+h+8>i.scrollTop+i.size.height&&i.setScrollTop(p.y+h+8-i.size.height)}}},e.prototype.selectNodeType=function(e){var t=this.selectedNodes;this.addNodesType(t,e)},e.prototype.unSelectNodeType=function(e){var t=this.selectedNodes;this.removeNodeType(t,e)},e.prototype.addNodesType=function(e,t){var n=this,i=null,r=/h(\d+)/.exec(t);this.preventOperationMerge(),r&&(i=parseInt(r[1])),e.forEach((function(e){if(Yy(e)){var r=e.textStyle;t.startsWith("h")&&i?"orderedList"===r.type?n.changeTextStyle(e,{type:"title",level:i,index:-1}):"title"===r.type?r.level!==i&&n.changeTextStyle(e,{type:"title",level:i,index:null===r.index?null:-1}):n.changeTextStyle(e,{type:"title",level:i,index:null}):"orderedList"===t?"orderedList"===r.type||("title"===r.type?null===r.index&&n.changeTextStyle(e,{type:"title",level:r.level,index:-1}):n.changeTextStyle(e,{type:"orderedList",index:-1})):"rawText"!==t&&"list"!==t||n.changeTextStyle(e,{type:t})}})),this.preventOperationMerge(),this.element.updateRenderFlow()},e.prototype.removeNodeType=function(e,t){var n=this,i=null!==/h(\d+)/.exec(t);this.preventOperationMerge(),e.forEach((function(e){if(Yy(e)){var r=e.textStyle;i?"title"===r.type&&null!==r.index?n.changeTextStyle(e,{type:"orderedList",index:-1}):n.changeTextStyle(e,{type:"rawText"}):"orderedList"===t&&("title"===r.type&&null!==r.index?n.changeTextStyle(e,exports.E(exports.E({},r),{index:null})):n.changeTextStyle(e,{type:"rawText"}))}})),this.preventOperationMerge(),this.element.updateRenderFlow()},e.prototype.addSeqToNode=function(e,t){this.preventOperationMerge();var n=e.textClient.contentEditor;if(n.deleteContentByRange(0,n.realSelectionEnd),void 0===t)this.changeTextStyle(e,{type:"list"});else{var i=e.textStyle;"title"===i.type?this.changeTextStyle(e,exports.E(exports.E({},i),{index:-1})):this.changeTextStyle(e,{type:"orderedList",index:-1})}this.preventOperationMerge(),this.element.updateRenderFlow()},e.prototype.insertNode=function(e){var t=this.selectedNodes;if(t.length)if(1===t.length){var n=t[0];Yy(n)?this.insertNodeToSingleText(e,n):this.insertNodeToNodes(e,t)}else this.insertNodeToNodes(e,t)},e.prototype.insertNodeAfterNode=function(e,t){t.children.length>0?this.createNodeAt(e,t,0):this.createNodeAt(e,t.parent,t.childIndex+1),this.clearSelected(),e.textSelect(),this.setSelectedNodes([e])},e.prototype.insertNodeToSingleText=function(e,t){var n=t.textClient,i=n.contentEditor,r=n.length,o=i.getRichTextByRange(i.selectionEnd,r);r>i.selectionStart&&i.deleteContentByRange(i.selectionStart,r);var a=t.children.length>0,s=a?t:t.parent,l=t.children.length?0:t.childIndex+1;if(a||0!==r||(l=t.childIndex,this.deleteNode(t)),this.createNodeAt(e,s,l),o.length){var c=this.element.genNewTextNode();c.textClient.initContent(o),this.createNodeAt(c,s,++l)}this.clearSelected(),e.textSelect(),this.setSelectedNodes([e])},e.prototype.insertNodeToNodes=function(e,t){var n=t[0],i=n.children.length>0,r=i?n:n.parent,o=t.slice();if(Yy(n)){o=o.slice(1);var a=n.textClient,s=a.contentEditor,l=a.length;s.deleteContentByRange(s.selectionStart,l)}var c=void 0,u=void 0,d=t[t.length-1];if(Yy(d)){var p=d.textClient,h=(s=p.contentEditor,p.length);o.includes(d.parent)?u=s.getRichTextByRange(s.selectionEnd,h):(c=d,o=o.slice(0,o.length-1))}var f=i?0:n.childIndex+1;this.createNodeAt(e,r,f);var m=r;if(!c&&u){var v=this.element.genNewTextNode();v.textClient.initContent(u),this.createNodeAt(v,r,f++),i||(m=v)}this.deleteNodeSaveChild(o,m,f),this.clearSelected(),e.textSelect(),this.setSelectedNodes([e])},e.prototype.deleteNodeSaveChild=function(e,t,n){var i=this,r={};e.forEach((function(e){r[e.id]=e}));var o=function(e){for(var a=e.children.slice(0),s=0;s<a.length;s++){var l=a[s];void 0!==r[l.id]?(delete r[l.id],o(l)):i.moveNodeTo(l,t,n++)}};e.forEach((function(e){void 0!==r[e.id]&&(o(e),i.deleteNode(e))}))},e.prototype.addImgFromInput=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return t=this.element,this.stopEdit(),[4,t.getImgFileFromInput()];case 1:return(n=s.sent())?(i=e.parent,r=e.childIndex,rU(e)?[2]:(this.startEdit(),[4,this.element.createImgNodeFromFile(n.file)])):[2];case 2:return o=s.sent(),Yy(e)&&e.isEmpty?(this.createNodeAt(o,i,r+1),o.textSelect(),this.deleteNode(e),this.setSelectedNodes([o])):this.insertNodeAfterNode(o,e),this.element.updateRenderFlow(),this.toolbarCtrl.updateToolbar({force:!0}),this.preventOperationMerge(),[4,this.element.saveImageFile(n,o.id)];case 3:return a=s.sent(),this.changeNodeState(o,{fileId:a,imgType:n.ext},!1),this.element.updateRenderFlow(),[2]}}))}))},e.prototype.addImgFromClipboard=function(e){var t;return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return n=null!==(t=e.type.split("/")[1])&&void 0!==t?t:"png",i=new File([e],"image.".concat(n),{lastModified:Date.now()}),this.selectedNodes.length?[4,this.element.createImgNodeFromFile(i)]:[2];case 1:return r=a.sent(),this.preventOperationMerge(),this.insertNode(r),this.preventOperationMerge(),this.element.updateRenderFlow(),this.toolbarCtrl.updateToolbar({force:!0}),[4,this.element.saveImageFile({file:i,ext:n},r.id)];case 2:return o=a.sent(),this.changeNodeState(r,{fileId:o,imgType:n},!1),this.element.updateRenderFlow(),[2]}}))}))},e.prototype.switchEmptyNodeType=function(e,t){this.preventOperationMerge();var n=null,i=/h(\d+)/.exec(t);i&&(n=parseInt(i[1]));var r={type:"rawText"};t.startsWith("h")&&n?r={type:"title",level:n,index:null}:"orderedList"===t?r={type:"orderedList",index:-1}:"list"===t&&(r={type:t}),this.changeTextStyle(e,r),this.preventOperationMerge(),this.element.updateRenderFlow(),this.checkScroll()},e.prototype.onlySelectNode=function(e){var t;this.selectedNodes.forEach((function(t){return t!==e&&t.unTextSelect()})),e.nodeSelected||(e.textSelect(),null===(t=e.textClient)||void 0===t||t.contentEditor.updateCursor(0)),this.setSelectedNodes([e])},e.prototype.setSelectedHorizAlign=function(e){var t=this.selectedNodes;t.length&&this.setNodesHorizAlign(t,e)},e.prototype.setNodesHorizAlign=function(e,t){var n=this;this.preventOperationMerge(),e.forEach((function(e){n.changeNodeState(e,{ha:t})})),this.preventOperationMerge(),this.element.updateRenderFlow(),this.checkScroll()},e.prototype.reSendLocalActions=function(){if(this.waitingAckAction){var e=this.element;if(this.waitingSendAction){for(var t=0,n=this.waitingSendAction.actions;t<n.length;t++){var i=n[t];this.waitingAckAction=IH(this.waitingAckAction,i)}this.waitingSendAction=void 0}this.waitingAckAction.version=this.element.version,e.upime.bigDocManager.sendDocAction(e,this.waitingAckAction)}},e}(),qH=function(e){function t(n){var i=e.call(this)||this;return i.parentId=n,i.id=t.genId(i.parentId),i}return P(t,e),Object.defineProperty(t.prototype,"highDimension",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseElePos",{get:function(){if(this.baseElement){var e=this.baseElement,t=e.position,n=e.scale,i=e.titleHeight,r=e.scrollTop;return{x:t.x,y:t.y+(i-r)*n}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.genId=function(){return t.genId(this.parentId)},t.prototype.getRelateInfo=function(){return{parentType:Za.BIG_DOC,parentId:this.parentId}},t.genId=function(e){return"".concat(e,"_rs")},t}(Us),KH=function(e){this.hoverBtn=e,this.renderer=XH,this.renderKey="nodeMenu"},YH=e.createContext({}),XH=function(t){var n=t.element;t.upime;var i=t.viewbox,r=e.useState(null),o=r[0],a=r[1],s=n.hoverBtn,l=s.showPlusBtn,c=s.currentNode,u="text"===(null==c?void 0:c.nodeTag);W().getUpimeTrans;var d,p=e.useRef(null),h=e.useRef(s.doc.scrollTop),f=(i.right-i.left)*i.scale,m=(i.bottom-i.top)*i.scale,v=s.getGlobalBorderBox(),g=(v.left-i.left)*i.scale,y=(v.top-i.top)*i.scale,b=(v.right-i.left)*i.scale,E=(v.bottom-i.top)*i.scale,x=e.useMemo((function(){if(o){var e={left:62,top:64,bottom:64,right:10},t=(y+E)/2,n=g-8-o.width;o.width>f-e.left-e.right?n=e.left:n<e.left&&(n=b+8)+o.width>f-e.right&&(n=f-e.right-o.width);var i=t-o.height/2;return o.height>m-e.top-e.bottom||i<e.top?i=e.top:i+o.height>m-e.bottom&&(i=m-e.bottom-o.height),{left:n,top:i}}return{visibility:"hidden",pointerEvents:"none",left:0,top:0}}),[m,m,o,g,b,(y+E)/2]),w=o&&x.left+o.width+184>f?"left":"right";return e.useEffect((function(){var e=p.current,t=e.offsetWidth,i=e.offsetHeight;return a({width:t,height:i}),n.menuDom=e,function(){n.menuDom=void 0}}),[n]),e.useEffect((function(){h.current!==s.doc.scrollTop&&s.setFixedNode(void 0)}),[s.doc.scrollTop]),l?d=e.createElement($H,{element:n}):u?d=e.createElement(tU,{element:n}):(w="left"===w?"leftTop":"rightTop",d=e.createElement(eU,{element:n})),e.createElement(YH.Provider,{value:{subMenuPlacement:w}},e.createElement("div",{ref:p,style:x,className:j(pH.node_menu,l&&pH.add,Ml.pane),onPointerDown:ie},d))},QH=function(t){var n=t.element,i=n.hoverBtn.getHa(),r=W().getUpimeTrans,o=[r("bigDoc.align.left"),r("bigDoc.align.center"),r("bigDoc.align.right")],a=n.hoverBtn.canIncreaseIndent(),s=n.hoverBtn.canReduceIndent();return e.createElement("div",{className:j(pH.node_align_menu,Ml.pane),onPointerDown:ie},e.createElement("div",{className:pH.align_option_group},["left","center","right"].map((function(t,r){var a=XM[t];return e.createElement("div",{key:t+"",className:j(pH.align_option,pH.hover_style,t===i&&pH.selected),onClick:function(){return function(e){n.hoverBtn.setHa(e)}(t)}},e.createElement(hl,{icon:a,className:pH.icon}),e.createElement("div",{className:pH.text},o[r]),e.createElement(hl,{className:pH.right_icon,icon:"dagou-quxiaoyuansuxuanze"}))}))),e.createElement("div",{className:pH.split_line}),e.createElement("div",{className:pH.align_option_group},e.createElement("div",{className:j(pH.align_option,a?pH.hover_style:pH.disabled),onClick:function(){n.hoverBtn.increaseIndent()}},e.createElement(hl,{icon:"suojinzengjia",className:pH.icon}),e.createElement("div",{className:pH.text},r("bigDoc.indent.increase"))),e.createElement("div",{className:j(pH.align_option,s?pH.hover_style:pH.disabled),onClick:function(){n.hoverBtn.reduceIndent()}},e.createElement(hl,{icon:"suojinjianshao",className:pH.icon}),e.createElement("div",{className:pH.text},r("bigDoc.indent.reduce")))))},ZH=function(t){var n=t.element,i=(0,W().getUpimeTrans)("bigDoc.indentAndAlign"),r=e.useContext(YH).subMenuPlacement,o=r.includes("right")?{marginLeft:-8}:{marginRight:-8};return e.createElement(Dh,{renderData:{render:QH,data:{element:n}},placement:r,useHover:!0,noPortal:!0,extraStyle:o},e.createElement("div",{className:j(pH.node_align_btn)},e.createElement(hl,{className:pH.icon,icon:"wendangmulu"}),e.createElement("div",{className:pH.text},i),e.createElement(hl,{className:pH.right_icon,icon:"youjiantou"})))},JH=function(t){var n=t.element,i=W().getUpimeTrans,r=[{name:i("common.cut"),func:function(){n.hoverBtn.doCut()},icon:"jianqie"},{name:i("element.copy"),func:function(){n.hoverBtn.doCopy()},icon:"fuzhi"},{name:i("common.delete"),func:function(){n.hoverBtn.doDelete()},icon:"shanchu"}];return e.createElement("div",{className:pH.align_option_group},r.map((function(t){return e.createElement("div",{className:j(pH.align_option,pH.hover_style),key:t.name,onClick:t.func},e.createElement(hl,{className:pH.icon,icon:t.icon}),e.createElement("div",{className:pH.text},t.name))})))},$H=function(t){var n=t.element,i=W().getUpimeTrans,r=n.hoverBtn,o=r.showPlusBtn;e.useEffect((function(){o||r.setFixedNode(void 0)}),[o]);var a=[["H1",function(){return r.switchNodeType("h1")}],["H2",function(){return r.switchNodeType("h2")}],["H3",function(){return r.switchNodeType("h3")}],["youxuliebiao",function(){return r.switchNodeType("orderedList")}],["wuxuliebiao",function(){return r.switchNodeType("list")}]];return e.createElement(e.Fragment,null,e.createElement("div",{className:pH.btn_group},e.createElement("div",{className:pH.type},i("common.basics")),e.createElement("div",{className:pH.btns},a.map((function(t){var n=t[0],i=t[1];return e.createElement("div",{key:n,onClick:i,className:j(pH.btn,pH.hover_style)},e.createElement(hl,{className:pH.btn_icon,icon:n}))})))),e.createElement("div",{className:pH.btn_group},e.createElement("div",{className:pH.type},i("common.common")),e.createElement("div",{className:j(pH.btn_bar,pH.hover_style),onClick:function(){return r.insertIamage()}},e.createElement(hl,{className:pH.btn_icon,icon:"tupian"}),e.createElement("div",{className:pH.btn_name},i("toolbar.upload.image")))))},eU=function(t){var n=t.element;return e.createElement(e.Fragment,null,e.createElement(ZH,{element:n}),e.createElement("div",{className:pH.split_line}),e.createElement(JH,{element:n}))},tU=function(t){var n=t.element,i=n.hoverBtn,r=i.getActiveTextTypes();return e.createElement(e.Fragment,null,e.createElement("div",{className:pH.node_type_select},e.createElement("div",{className:pH.types},fH.map((function(t){var n=t[0],o=t[1],a=r.includes(n);return e.createElement("div",{className:j(pH.type,a&&pH.selected,pH.hover_style),key:n,onClick:function(){a?i.unSelectNodeType(n):i.selectNodeType(n)}},e.createElement(hl,{className:pH.type_icon,icon:o}))})))),e.createElement("div",{className:pH.split_line}),e.createElement(ZH,{element:n}),e.createElement("div",{className:pH.split_line}),e.createElement(JH,{element:n}))},nU=function(){function e(e){this.doc=e,this.hovering=!1}return Object.defineProperty(e.prototype,"position",{get:function(){if(this.currentNode){var e=this.currentNode.position,t=this.showPlusBtn?e.x-32:e.x-30,n=e.y;return Yy(this.currentNode)&&(n+=this.currentNode.lineHeight/2-12),{x:t,y:n}}return{x:0,y:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.showPlusBtn?{width:24,height:24}:{width:20,height:24}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentNode",{get:function(){return this.fixedNode||this.hoveringNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.doc.docContentEditor.showHoverBtn&&void 0!==this.currentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"showPlusBtn",{get:function(){var e=this.currentNode;return!!(e&&Yy(e)&&e.isEmpty)},enumerable:!1,configurable:!0}),e.prototype.checkSelectRelation=function(e,t){var n,i=null;if(void 0!==t&&this.visible){this.showPlusBtn,e={x:e.x,y:e.y+this.doc.scrollTop};var r=t.type;Ot(e,this.getBorderBox(),8/this.doc.upime.view.scale/this.doc.scale)&&("click"===r?i={transparent:!1,metric:-1,metaData:{clickData:{customData:{type:"ctrlWidget",ctrlWidget:this,ctrlData:{type:"menu"}}}}}:"hover"===r?i={realTarget:this,transparent:!1,metric:-1,metaData:{clickData:{customData:{currentNodeId:null===(n=this.currentNode)||void 0===n?void 0:n.id}}}}:"move"===r&&(i={transparent:!1,metric:-1,metaData:{directCtrlData:{type:"ctrlWidget",ctrlWidget:this,ctrlData:{type:"move",toMoveNode:this.currentNode}}}}))}return i},e.prototype.dealHoverStart=function(e){var t,n,i=null===(n=null===(t=e.metaData)||void 0===t?void 0:t.clickData)||void 0===n?void 0:n.customData;if(null==i?void 0:i.currentNodeId){var r=this.doc.nodeMap[null==i?void 0:i.currentNodeId];r&&(this.hovering=!0,this.setHoveringNode(r),this.doc.upime.view.setCursor("grab",this))}},e.prototype.dealHoverEnd=function(){this.hovering=!1,this.setHoveringNode(void 0),this.doc.upime.view.setCursor("",this)},e.prototype.dealClickStart=function(e){var t,n,i,r=null===(n=null===(t=e.metaData)||void 0===t?void 0:t.clickData)||void 0===n?void 0:n.customData;if(r&&"ctrlWidget"===r.type&&"menu"===r.ctrlData.type){if(!this.currentNode)return;if(this.fixedNode)this.setFixedNode(void 0);else{var o=this.doc.docContentEditor;o.editing?o.onlySelectNode(this.currentNode):(o.startEdit(),this.currentNode.textSelect(),null===(i=this.currentNode.textClient)||void 0===i||i.contentEditor.updateCursor(0),o.setSelectedNodes([this.currentNode])),this.setFixedNode(this.currentNode)}}},e.prototype.dealSelectCtrlEvt=function(e){},e.prototype.dealCtrlWidgetEvt=function(e,t,n){var i=this.doc.docContentEditor;n.isStart&&(this.fixedNode&&this.setFixedNode(void 0),i.startBlockMove([e.toMoveNode])),i.updateBlockMove(t),n.isEnd&&i.endBlockMove()},e.prototype.getBorderBox=function(){var e=this.position,t=this.size;return{left:e.x,top:e.y,right:e.x+t.width,bottom:e.y+t.height}},e.prototype.getGlobalBorderBox=function(){var e=this.doc,t=e.position,n=e.titleHeight,i=e.scale,r=e.scrollTop,o=t.x+this.position.x*i,a=t.y+(n+this.position.y-r)*i;return{left:o,top:a,right:o+this.size.width*i,bottom:a+this.size.height*i}},e.prototype.onRenderFlowUpdate=function(){this.setHoveringNode(void 0),this.fixedNode&&rU(this.fixedNode)&&this.setFixedNode(void 0)},e.prototype.clearNode=function(){this.setFixedNode(void 0),this.setHoveringNode(void 0),this.hovering&&(this.hovering=!1,this.doc.upime.view.setCursor("",this))},e.prototype.setFixedNode=function(e){this.fixedNode&&this.fixedNode!==e&&(this.fixedNode.blockSelected=!1,this.removeMenuDom()),this.fixedNode=e,e&&(e.blockSelected=!0,this.addMenuDom(e),this.doc.docContentEditor.toolbarCtrl.removeToolbar()),this.doc.docContentEditor.toolbarCtrl.hideToolbar(void 0!==e),this.hoveringNode&&(e?e!==this.hoveringNode&&(this.hoveringNode.blockSelected=!1):this.hovering&&(this.hoveringNode.blockSelected=!0))},e.prototype.setHoveringNode=function(e){this.hoveringNode&&this.hoveringNode!==e&&this.hoveringNode!==this.fixedNode&&(this.hoveringNode.blockSelected=!1),!this.fixedNode&&this.hovering&&e&&(e.blockSelected=!0),this.hoveringNode=e},e.prototype.render=function(){var e=this;if(this.visible){var t=this,n=t.showPlusBtn,i=t.position,r=i.x,o=i.y,a=t.size,s=a.width,l=a.height;Na((function(t){t.lineStyle(1,15132649),t.beginFill(e.hovering||e.fixedNode?16119542:16777215),t.drawRoundedRect(r+.5,o+.5,s-1,l-1,4),t.endFill()}));var c=n?_D("jia","#0C1024"):_D("liugedian","#91939C"),u=js.value.addLoadingSource;!c.loaded&&(null==u||u(c)),Oa({src:c,width:20,height:20,x:r+(s-20)/2,y:o+2})}},e.prototype.addMenuDom=function(e){var t=this;if(!this.menuWidget){var n=new KH(this);n.renderKey+="_"+e.id,this.menuWidget=n,this.doc.upime.view.addDomWidget(n);var i=document.getElementById("userevent_target"),r=this.doc.upime,o=function(){t.setFixedNode(void 0)},a=[r.view.subscribe("viewboxChange",o),r.userEventManager.subscribe("click",o),r.userEventManager.subscribe("moveto",o),r.userEventManager.subscribe("touchscale",o),gh(o,{quick:!0,once:!0,checkSkip:function(e){return e===i||!(!n.menuDom||!V(n.menuDom,e))}})];n.onDestroy=function(){return a.forEach((function(e){return e()}))}}},e.prototype.removeMenuDom=function(){this.menuWidget&&(this.doc.upime.view.removeDomWidget(this.menuWidget),this.menuWidget=void 0)},e.prototype.switchNodeType=function(e){if(this.fixedNode&&Yy(this.fixedNode)){var t=this.doc.docContentEditor;t.editing||(t.startEdit(),this.fixedNode.textSelect(),this.fixedNode.richTextClient.contentEditor.moveCursorToEnd(),t.setSelectedNodes([this.fixedNode])),this.doc.docContentEditor.switchEmptyNodeType(this.fixedNode,e)}this.setFixedNode(void 0)},e.prototype.getNodes=function(){var e=[];return this.fixedNode&&function t(n){e.push(n),n.children.length&&n.children.forEach(t)}(this.fixedNode),e},e.prototype.selectNodeType=function(e){this.fixedNode&&(this.doc.docContentEditor.addNodesType(this.getNodes(),e),this.setFixedNode(void 0))},e.prototype.unSelectNodeType=function(e){this.fixedNode&&(this.doc.docContentEditor.removeNodeType(this.getNodes(),e),this.setFixedNode(void 0))},e.prototype.getActiveTextTypes=function(){var e,t,n=[];if(this.fixedNode&&Yy(this.fixedNode)){var i=this.fixedNode.textStyle;if(null!==e){var r="title"===i.type?"h".concat(i.level):i.type;void 0===e?e=r:e!==r&&(e=null)}t="title"===i.type&&null!==i.index||"orderedList"===i.type}return e&&n.push(e),t&&n.push("orderedList"),n},e.prototype.insertIamage=function(){this.fixedNode&&this.doc.docContentEditor.addImgFromInput(this.fixedNode),this.setFixedNode(void 0)},e.prototype.getHa=function(){return this.fixedNode?this.fixedNode.ha:"left"},e.prototype.setHa=function(e){if(this.fixedNode){var t=this.getNodes();this.doc.docContentEditor.setNodesHorizAlign(t,e),this.setFixedNode(void 0)}},e.prototype._increaseIndent=function(e){void 0===e&&(e={});var t=e.isCheck,n=void 0!==t&&t,i=this.fixedNode;if(!i)return!1;if(i.parent&&0!==i.childIndex){var r=i.parent.children[i.childIndex-1];if(r.supportChild)return n||this.doc.docContentEditor.moveNodeTo(i,r,r.children.length),!0}return!1},e.prototype.canIncreaseIndent=function(){return this._increaseIndent({isCheck:!0})},e.prototype.increaseIndent=function(){this._increaseIndent(),this.setFixedNode(void 0)},e.prototype._reduceIndent=function(e){void 0===e&&(e={});var t=e.isCheck,n=void 0!==t&&t,i=this.fixedNode;if(!i)return!1;if(jH(i))return!1;if(n)return!0;for(var r=i.parent,o=i,a=o.childIndex,s=r.childIndex+1,l=this.doc.docContentEditor;;){var c=r.children[a+1];if(!c){l.moveNodeTo(o,r.parent,s);break}if(!c.nodeSelected&&o.supportChild){r.children.slice(a+1).forEach((function(e){l.moveNodeTo(e,o,o.children.length)})),l.moveNodeTo(o,r.parent,s);break}l.moveNodeTo(o,r.parent,s++),o=c}return!0},e.prototype.canReduceIndent=function(){return!!this.fixedNode&&this._reduceIndent({isCheck:!0})},e.prototype.reduceIndent=function(){this._reduceIndent(),this.setFixedNode(void 0)},e.prototype.doCut=function(){if(!this.fixedNode)return!1;this.copyNodes(),this.doDelete()},e.prototype.copyNodes=function(){var e,t=this.fixedNode;if(!t)return!1;var n=this.getNodes(),i=this.doc.docContentEditor;i.clearSelected(),n.forEach((function(e){return e.textSelect()})),i.setSelectedNodes(n),i.copySelected(),i.clearSelected(),t.textSelect(),null===(e=t.textClient)||void 0===e||e.contentEditor.updateCursor(0),i.setSelectedNodes([t])},e.prototype.doCopy=function(){this.copyNodes(),this.setFixedNode(void 0)},e.prototype.doDelete=function(){var e=this.fixedNode;if(!e)return!1;this.doc.docContentEditor.deleteNodeBlock(e),this.setFixedNode(void 0)},e}();function iU(e,t,n){var i=document.getElementById("tmp-infi-input-file");i&&document.body.removeChild(i);var r=document.createElement("input");r.setAttribute("id","tmp-infi-input-file"),r.setAttribute("type","file"),t&&r.setAttribute("multiple","multiple"),r.setAttribute("accept",e),r.style.display="none",r.addEventListener("change",(function(e){var t=e.target.files;n(t?Array().slice.call(t):[]),document.body.removeChild(r)})),document.body.appendChild(r),r.click()}function rU(e){for(;e.parent;)if("root"===(e=e.parent).nodeTag)return!1;return!0}var oU=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.docContentEditor=new GH(i),i.titleHeight=52,i.marginTop=0,i.marginBottom=0,i.indentWidth=0,i.scrollTop=0,i.maxScrollTop=0,i.topDistance=0,i.bottomDistance=0,i.nodeTag="root",i.elementType=Za.BIG_DOC,i.renderer=lH,i.editorType=kH,i.name="",i.version=0,i.nodeMap={root:i},i.childIndex=-1,i.children=[],i.bufferActions=[],i.treeHeight=0,i._renderFlow=[],i._renderFlowChanged=!1,i.inited=!1,i.isEmpty=!1,i.docRefsystem=new qH(i.id),i.docRefsystem.bindBaseElement(i),i.hoverBtn=new nU(i);var r=i.maxBtn=new WN(i,"maxBtn",Af);return r.x=450,r.y=2,r.iconSize=18,r.onclick=function(){i.upime.maximizeElement(i)},i.addInnerWidget(r),i}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docTree",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChild",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeSelected",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blockSelected",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moving",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ha",{get:function(){return"center"},enumerable:!1,configurable:!0}),t.prototype.updateOuterWidth=function(e){},Object.defineProperty(t.prototype,"renderFlow",{get:function(){return this._renderFlowChanged&&this.calcRenderFlow(),this._renderFlow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentWidth",{get:function(){return this.size.width-40-40},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentHeight",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentPath",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentId",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderSize",{get:function(){return this.size},enumerable:!1,configurable:!0}),t.prototype.renderContent=function(){},t.prototype.onAdd=function(){var t;e.prototype.onAdd.call(this),null===(t=this.parentRefSystem)||void 0===t||t.addChildRS(this.docRefsystem)},t.prototype.onDelete=function(){e.prototype.onDelete.call(this),this.unmounRefSystem(this.docRefsystem)},t.prototype.init=function(){},t.prototype.dealStateChange=function(){},t.prototype.getInitState=function(){return{}},t.prototype.calcBorderBox=function(){var e=this,t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale;return{left:n,top:i,right:n+o*s,bottom:i+(e.titleHeight+a)*s}},t.prototype.dealUpdate=function(t){var n=t.nodeTree,i=N(t,["nodeTree"]),r=this.inited&&t.size&&t.size.height!==this.size.height;e.prototype.dealUpdate.call(this,i),(t.position||t.size||void 0!==t.scale)&&(this.updateBorderBox(),this.docRefsystem.updateTransform()),n&&!this.inited&&(this.inited=!0,this.initData(n)),r&&(this._renderFlowChanged?this.calcRenderFlow():(this.maxScrollTop=Math.max(this.treeHeight-this.size.height,0),this.scrollTop>this.maxScrollTop&&this.setScrollTop(this.maxScrollTop)))},t.prototype.checkInteractRelation=function(t,n){var i=this,r=e.prototype.checkInteractRelation.call(this,t,n);if(r)return r;var o=n.type,a=this,s=a.position,l=a.size,c=a.titleHeight,u=a.scale,d=this.docContentEditor.editing,p=void 0!==this.currentEditor&&"single"===this.selectStatus,h="select"===this.upime.xmode,f={x:(t.x-s.x)/u,y:(t.y-s.y)/u-c};if(d&&"click"===o&&f.x>=0&&f.x<=l.width&&f.y<0&&f.y>-c)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{type:"clickStopEdit"}}}};var m=this.hoverBtn.checkSelectRelation(f,n);if(m)return m;if(f.x>=0&&f.x<=l.width&&f.y>=0&&f.y<=l.height&&(f.y+=this.scrollTop,p||"move"!==o)){var v=function(e,t){for(var r=!0,a=0;a<t.length;a++){var s=t[a].node;if(!(f.y>s.position.y+s.borderSize.height+20)){if(f.y<s.position.y-20)return void(r=!1);var l=s.checkNodeRelation(f,n);if(l)return l}}if(r&&p&&h){if("click"===o)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{type:"clickBottom",parentNode:e,renderFlow:t}}}};if("hover"===o){var c=i.renderFlow[i.renderFlow.length-1];if(!c.renderFlows)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{type:"hover",nodeId:c.node.id,cursor:d?"text":""}}}}}}}(this,this.renderFlow);if(v)return v}return null},t.prototype.initData=function(e){var t=this,n=e.nodes,i=e.tree;n.forEach((function(e){var n=e.id,i=e.state,r=e.content,o=e.nodeTag,a=void 0;"text"===o?a=new Xy(t.upime,n,t):"img"===o&&(a=new HH(t.upime,n,t)),a&&(a.init(i||{},r),t.nodeMap[n]=a)}));var r=function(e,n){if("string"==typeof n){var i=t.nodeMap[n];i&&(i.childIndex=e.children.length,i.parent=e,e.children.push(i))}else{var o=n.id,a=n.children,s=t.nodeMap[o];s&&(s.childIndex=e.children.length,s.parent=e,e.children.push(s),a.forEach((function(e){return r(s,e)})))}};i.forEach((function(e){return r(t,e)})),this.updateRenderFlow()},t.prototype.rollbackData=function(e){this.docContentEditor.rollback(),this.initData(e)},t.prototype.calcRenderFlowIfChanged=function(){this._renderFlowChanged&&this.calcRenderFlow()},t.prototype.updateRenderFlow=function(){if(this._renderFlowChanged=!0,this.hoverBtn.onRenderFlowUpdate(),this.isEmpty=!1,1===this.children.length){var e=this.children[0];Yy(e)&&e.isEmpty&&(this.isEmpty=!0)}this.upime.updateView()},t.prototype.calcRenderFlow=function(){var e,t=[],n=this.size.width-40-40,i=40,r=40,o=n,a=0,s=new Set;this.children.forEach((function(e){if(Yy(e)){var t=e.textStyle;"title"===t.type&&s.add(t.level)}}));var l=[{seq:0,prefix:"",ended:!0}],c=1,u=[[0]],d=function(n){var p;if(e){var h=Math.max(e.marginBottom,n.marginTop);e.bottomDistance=h,n.topDistance=h,r+=h}else n.topDistance=0;if(Yy(n)){n.position={x:i,y:r};var f=n.textStyle,m="",v=u[u.length-1];if("title"===f.type&&"root"===(null===(p=n.parent)||void 0===p?void 0:p.nodeTag)){var g=f.level,y=f.index;if(f.followPrefix,v[0]=0,null===y)g>=c||(c=g,l.length=c,l[c-1].ended=!0);else{var b=l[c-1];if(g>c){b.ended&&(b.ended=!1,b.seq++);for(var E=c;E<g;E++){var x={seq:1,ended:!1,prefix:b.prefix};s.has(E)&&(x.prefix=b.prefix+b.seq+"."),b=x,l.push(b)}c=g}else g===c?(b.seq++,b.ended=!1):(c=g,l.length=c,(b=l[c-1]).seq++,b.ended=!1);m=b.prefix?b.prefix+b.seq:b.seq+"."}}else if("title"===f.type&&null!==f.index||"orderedList"===f.type){var w,C=v.length-1;switch(w=-1===f.index?++v[C]:f.index,C%3){case 0:m=w+".";break;case 1:m=function(e){for(var t="",n="a".charCodeAt(0)-1;e>0;){var i=Math.floor(e/26),r=e-26*i;0===r&&(r=26,i-=1),t=String.fromCharCode(r+n)+t,e=i}return t}(w)+".";break;case 2:m=function(e){for(var t=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],n=["m","cm","d","cd","c","xc","l","xl","x","ix","v","iv","i"],i="",r=0;r<t.length;r++)for(;e>=t[r];)e-=t[r],i+=n[r];return i}(w)+"."}}else if("list"===f.type)switch((C=v.length-1)%3){case 0:m="•";break;case 1:m="◦";break;case 2:m="▪"}if(n.seqText=m,n.updateOuterWidth(o),r+=n.borderSize.height,t.push({node:n,index:a++}),e=n,n.children){v.push(0);var S=n.indentWidth;o-S>128?(i+=S,o-=S,n.children.forEach(d),o+=S,i-=S):n.children.forEach(d),v.pop()}n.treeHeight=r-n.position.y}else if(zH(n)){n.updateOuterWidth(o);var k=n.borderSize,_=0;"left"!==n.ha&&(_=o-k.width,"center"===n.ha&&(_/=2)),n.position={x:i+_,y:r},r+=n.borderSize.height,t.push({node:n,index:a++}),e=n,n.treeHeight=r-n.position.y}};this.children.forEach(d),e&&(e.bottomDistance=0),this.treeHeight=r+40,this.maxScrollTop=Math.max(this.treeHeight-this.size.height,0),this._renderFlow=t,this.scrollTop>this.maxScrollTop&&this.setScrollTop(this.maxScrollTop),this._renderFlowChanged=!1},t.prototype.dealHoverStart=function(t){var n,i,r=null===(i=null===(n=t.metaData)||void 0===n?void 0:n.clickData)||void 0===i?void 0:i.customData;if(r){if("hover"===(null==r?void 0:r.type)){var o=r.nodeId,a=r.cursor,s=r.textAnchor,l=r.mentionStartIndex,c=this.nodeMap[o];if(c){if(this.hoveringNode=c,void 0!==s||void 0!==l)return void c.dealRichTextHoverStart({textAnchor:s,mentionStartIndex:l});this.docContentEditor.showHoverBtn&&this.hoverBtn.setHoveringNode(c)}var u="pointer";void 0!==a&&(u=a),this.upime.view.setCursor(u,this),this.upime.updateView()}}else e.prototype.dealHoverStart.call(this,t)},t.prototype.dealHoverEnd=function(){var t,n;this.hoverBtn.setHoveringNode(void 0),this.hoveringNode&&(null===(n=(t=this.hoveringNode).dealHoverEnd)||void 0===n||n.call(t),this.hoveringNode=void 0),e.prototype.dealHoverEnd.call(this)},t.prototype.dealClickStart=function(t){var n,i,r=null===(i=null===(n=t.metaData)||void 0===n?void 0:n.clickData)||void 0===i?void 0:i.customData;if(r)if("textMenu"===r.type)this.openTextMenu(r.position);else if("ctrlWidget"===r.type)r.ctrlWidget.dealClickStart(t);else if("click"===r.type){var o=r.node,a=r.textAnchor,s=r.mentionStartIndex;o.dealRichTextClick({textAnchor:a,mentionStartIndex:s}),void 0!==s&&this.upime.selectElement(this)}else"nodeSelect"===r.type?(this.currentEditor||this.upime.selectElement(this),this.docContentEditor.clickNode(r)):"clickBottom"===r.type?(this.currentEditor||this.upime.selectElement(this),this.docContentEditor.clickBottom(r.parentNode,r.renderFlow)):"clickStopEdit"===r.type?this.docContentEditor.stopEdit():e.prototype.dealClickStart.call(this,t);else e.prototype.dealClickStart.call(this,t)},t.prototype.openTextMenu=function(e){var t=this,n=new Kh(this.upime,e,(function(){return t.upime.view.removeContextMenu()}));n.textEditor=this.docContentEditor,this.upime.view.addContextMenu(n)},t.prototype.textSelect=function(){},t.prototype.unTextSelect=function(){},t.prototype.genNodeTree=function(){var e=[],t=[],n=function(t,i){var r,o=t.id,a=t.nodeTag,s=t.children;if(e.push({id:o,nodeTag:a,state:t.getInitState(),content:null===(r=t.textClient)||void 0===r?void 0:r.content}),s.length){var l=[];i.push({id:o,children:l}),t.children.forEach((function(e){return n(e,l)}))}else i.push(o)};return this.children.forEach((function(e){return n(e,t)})),{nodes:e,tree:t}},t.prototype.onRecvServerAction=function(e){this.docContentEditor.onRecvAction(e)},t.prototype.dealServerAck=function(){this.docContentEditor.onRecvAck()},t.prototype.genNodeId=function(){return this.upime.bigDocManager.genNodeId()},t.prototype.genNodeByTagAndId=function(e,t){var n;return(n=this.genTextNode()).id=t,this.nodeMap[t]=n,n},t.prototype.genTextNode=function(){return new Xy(this.upime,"temp",this)},t.prototype.genNewTextNode=function(){var e=this.genTextNode();return e.id=this.genNodeId(),this.nodeMap[e.id]=e,e},t.prototype.genNewImgNode=function(){var e=this.genNodeId(),t=new HH(this.upime,e,this);return this.nodeMap[e]=t,t},t.prototype.startEditNodeAnchor=function(e){this.editingAnchorNode=e},t.prototype.setScrollTop=function(e){e<0?e=0:e>this.maxScrollTop&&(e=this.maxScrollTop),this.scrollTop!==e&&(this.scrollTop=e,this.docRefsystem.updateTransform(),this.upime.updateView())},t.prototype.blockBlink=function(){},t.prototype.getImgFileFromInput=function(){var e=this;return new Promise((function(t){iU(".jpg, .jpeg, .png, .gif, .bmp, .svg, .webp",!1,(function(n){return A(e,void 0,void 0,(function(){var e,i,r,o;return D(this,(function(a){for(e=0,i=n;e<i.length;e++)if(r=i[e],Pp(o=Jo(r.name)))return t({file:r,ext:o}),[2];return t(null),[2]}))}))}))}))},t.prototype.createImgNodeFromFile=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,wp(e)];case 1:return t=o.sent(),n=t.naturalWidth,i=t.naturalHeight,(r=this.genNewImgNode()).size={width:n,height:i},r.clipRect={x:0,y:0,width:n,height:i},r.localImage=t.src,r.name=e.name,r.updateImageFile(),[2,r]}}))}))},t.prototype.saveImageFile=function(e,t){return A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){switch(r.label){case 0:return n=e.file,i=e.ext,[4,this.upime.saveFile(2,{file:n,ext:i,fakeName:"".concat(this.upime.genFileName(t),".").concat(i)})];case 1:return[2,r.sent()]}}))}))},t.prototype.checkNodeRelation=function(e,t){return null},t.prototype.getScreenPointByDocPoint=function(e){return this.upime.view.getScreenPosition({x:e.x*this.scale+this.position.x,y:(e.y+this.titleHeight)*this.scale+this.position.y})},t.prototype.searchText=function(t){t=t.toLowerCase();var n=function(e){for(var i=0,r=e;i<r.length;i++){var o=r[i];if(o.renderFlows)for(var a=0,s=o.renderFlows;a<s.length;a++){var l=s[a];return n(l)}if(o.node.textClient){var c=o.node.textClient.chars.join("");if(c.toLocaleLowerCase().includes(t))return c}}return null};return n(this.renderFlow)||e.prototype.searchText.call(this,t)},t}(oy),aU={__value:{handle:function(e,t){return{type:"value",value:e}}}},sU={};function lU(e,t){aU[e]={handle:function(n,i){var r=(0,i.parseExp)(t);return{type:"unary",operator:e,right:r}}}}function cU(e,t,n){void 0===n&&(n=!1),sU[e]={precedence:t,handle:function(i,r,o){var a=(0,o.parseExp)(n?t-1:t);return{type:"binary",operator:e,left:i,right:a}}}}function uU(e){return!e.match(/^[\w\.]$/)}function dU(e){return function(e){var t={parseProgram:function(){return n(0)},parseExp:n,scanner:e};return t;function n(n){var i,r=e.consume();if(!r)throw new Error("expect token but found none");for(var o=(null!==(i=aU[r])&&void 0!==i?i:aU.__value).handle(r,t);;){var a=e.peek();if(!a)break;var s=sU[a];if(!s)break;if(s.precedence<=n)break;e.consume(),o=s.handle(o,a,t)}return o}}(function(e){var t=e[Symbol.iterator](),n=t.next(),i=[];return{peek:r,consume:function(e){var t=r();if(e&&t!==e)throw new Error("expect token ".concat(e," but got ").concat(t));return t&&i.shift(),t}};function r(e){for(void 0===e&&(e=0);i.length<=e;){var t=o();if(!t)break;i.push(t)}return i[e]||null}function o(){for(;!n.done&&n.value.match(/\s/);)n=t.next();if(n.done)return null;if(uU(n.value)){var e=n.value;return n=t.next(),">"!==e&&"<"!==e||"="!==n.value?"="===e&&"="===n.value?(n=t.next(),"=="):"!"===e&&"="===n.value?(n=t.next(),"!="):"*"===e&&"*"===n.value?(n=t.next(),"**"):e:(n=t.next(),e+"=")}for(var i="";!n.done&&!uU(n.value);)i+=n.value,n=t.next();return i}}(e.toString())).parseProgram()}function pU(e){switch(e.type){case"value":return function(e){return"true"===e.value?{getter:function(){return!0}}:"false"===e.value?{getter:function(){return!1}}:isNaN(Number(e.value))?"PI"===e.value?{getter:function(){return Math.PI}}:{getter:function(t){var n=t[e.value];return yt.exports.isNumber(n)||yt.exports.isBoolean(n)?n:n.getter(t)}}:{getter:function(){return Number(e.value)}}}(e);case"binary":return function(e){var t=pU(e.left),n=pU(e.right);switch(e.operator){case"+":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op <+> can't add boolean");return e+t}(t.getter(e),n.getter(e))}};case"-":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op <-> can't sub boolean");return e-t}(t.getter(e),n.getter(e))}};case"*":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op <*> can't mul boolean");return e*t}(t.getter(e),n.getter(e))}};case"/":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op </> can't div boolean");return e/t}(t.getter(e),n.getter(e))}};case">":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op < can't compare boolean");return e>t}(t.getter(e),n.getter(e))}};case">=":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op <= can't compare boolean");return e>=t}(t.getter(e),n.getter(e))}};case"<":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op > can't compare boolean");return e<t}(t.getter(e),n.getter(e))}};case"<=":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op >= can't compare boolean");return e<=t}(t.getter(e),n.getter(e))}};case"and":return{getter:function(e){return function(e,t){return Boolean(e)&&Boolean(t)}(t.getter(e),n.getter(e))}};case"or":return{getter:function(e){return function(e,t){return Boolean(e)||Boolean(t)}(t.getter(e),n.getter(e))}};case"^":return{getter:function(e){return function(e,t){if(yt.exports.isBoolean(e)||yt.exports.isBoolean(t))throw new Error("op ^ can't compare boolean");return Math.pow(e,t)}(t.getter(e),n.getter(e))}};case"==":return{getter:function(e){return function(e,t){return e===t}(t.getter(e),n.getter(e))}};case"!=":return{getter:function(e){return function(e,t){return e!==t}(t.getter(e),n.getter(e))}};case"=":return{getter:n.getter,effect:{type:"set",key:e.left.value}};default:throw new Error("unknown operator ".concat(e.operator))}}(e);case"conditional":return function(e){var t=pU(e.trueBranch),n=pU(e.falseBranch),i=pU(e.condition);return{getter:function(e){return i.getter(e)?t.getter(e):n.getter(e)}}}(e);case"unary":return function(e){var t=pU(e.right);return"-"===e.operator?{getter:function(e){return-t.getter(e)}}:t}(e);case"fnCall":return function(e){var t=e.args.map(pU);if("value"!==e.function.type)throw new Error("parseFunctionCall : unknown function ".concat(e.function));var n=e.function.value;if(!(n in Math))throw new Error("parseFunctionCall : unknown function ".concat(n));return{getter:function(e){var i=t.map((function(t){return t.getter(e)}));return Math[n].apply(Math,i)}}}(e);default:throw new Error("unknown ast type ".concat(e))}}lU("+",150),lU("-",150),aU["("]={handle:function(e,t){var n=t.parseExp,i=t.scanner,r=n(0);return i.consume(")"),r}},cU("+",120),cU("-",120),cU("*",130),cU("/",130),cU("^",140,!0),cU(">",110),cU("<",110),cU("<=",110),cU(">=",110),cU("and",100),cU("or",95),cU("==",150),cU("!=",150),cU("=",10),sU["?"]={precedence:30,handle:function(e,t,n){var i=n.parseExp,r=n.scanner,o=i(0);return r.consume(":"),{type:"conditional",condition:e,trueBranch:o,falseBranch:i(0)}}},sU["("]={precedence:180,handle:function(e,t,n){for(var i=n.parseExp,r=n.scanner,o=[];")"!==r.peek()&&(o.push(i(0)),","===r.peek());)r.consume(",");return r.consume(")"),{type:"fnCall",function:e,args:o}}};var hU={};function fU(e){var t=function(e){return yt.exports.isString(e)?pU(dU(e)):{getter:function(){return Boolean(e)}}}(e.hidden);return exports.E(exports.E({},function(){switch(e.type){case"rect":case"ellipse":case"resource":case"text":return exports.E(exports.E({},e),{bounds:mU(e.bounds)});case"caption":return exports.E(exports.E({},e),{bounds:{y:vU(e.bounds.y),width:vU(e.bounds.width)}});case"roundedRect":return exports.E(exports.E({},e),{bounds:exports.E(exports.E({},mU(e.bounds)),{radius:vU(e.bounds.radius)})});case"path":return function(e){var t=e.commands.map((function(e){var t={};return Object.keys(e).forEach((function(n){"c"===n?t.c=e[n]:t[n]=vU(e[n])})),t}));return exports.E(exports.E({},e),{commands:t})}(e)}}()),{hidden:t})}function mU(e){var t=e.x,n=e.y,i=e.width,r=e.height;return{x:vU(t),y:vU(n),width:vU(i),height:vU(r)}}function vU(e){return yt.exports.isNumber(e)||yt.exports.isBoolean(e)?{getter:function(){return e}}:pU(dU(e))}function gU(e,t){var n=!!e.hidden&&e.hidden.getter(t);return exports.E(exports.E({},function(){switch(e.type){case"rect":case"ellipse":case"resource":case"text":return exports.E(exports.E({},e),{bounds:yU(e.bounds,t)});case"caption":return exports.E(exports.E({},e),{bounds:{y:e.bounds.y.getter(t),width:e.bounds.width.getter(t)}});case"roundedRect":return exports.E(exports.E({},e),{bounds:exports.E(exports.E({},yU(e.bounds,t)),{radius:e.bounds.radius.getter(t)})});case"path":return function(e,t){var n=e.commands.map((function(e){var n={};return Object.keys(e).forEach((function(i){"c"===i?n.c=e[i]:n[i]=e[i].getter(t)})),n}));return exports.E(exports.E({},e),{commands:n})}(e,t)}}()),{hidden:n})}function yU(e,t){var n=e.x,i=e.y,r=e.width,o=e.height;return{x:n.getter(t),y:i.getter(t),width:r.getter(t),height:o.getter(t)}}var bU=function(e){var t,n,i,r=e.hasBorder,o=e.borderThickness,a=e.borderStyle,s=e.borderColor,l=e.borderOpacity,c=e.hasBg,u=e.bgColor,d=e.bgOpacity,p=e.showAttachedOnsideShadow,h=e.scale,f={x:e.position.x,y:e.position.y},m=hf(e,1,[e.size,e.scale]),v={lineWidth:r?o:0,lineDash:(n=a,i=o,3===n?[4*i,4*i]:2===n?[i,i]:[]),stroke:pr(s),strokeAlpha:l};c&&(v.fill=pr(u),v.fillAlpha=d);var g=e.computedBgGeoList,y=e.computedFgGeoList;mf(e,m,!p),fa(exports.E({x:f.x,y:f.y,scaleX:h,scaleY:h},v)),g.forEach((function(t){return EU(t,e,v)})),p&&(fa({fill:"#858585",alpha:.2}),g.length?g.forEach((function(t){return EU(t,e,{fill:"#858585",alpha:.2},!0)})):ka({x:0,y:0,width:e.size.width,height:e.size.height}),ma()),y.forEach((function(t){return EU(t,e,v)})),null===(t=e.childElements)||void 0===t||t.forEach((function(e){return e.render()})),ma(),bf(e),Ef(e),ma()};function EU(e,t,n,i){if(void 0===i&&(i=!1),!e.hidden){var r=t.scale;switch(e.type){case"rect":var o=i?void 0:xU(e,r,n);ka(e.bounds),null==o||o();break;case"ellipse":var a=i?void 0:xU(e,r,n);_a({cx:e.bounds.x+e.bounds.width/2,cy:e.bounds.y+e.bounds.height/2,rx:e.bounds.width/2,ry:e.bounds.height/2}),null==a||a();break;case"path":!function(e,t,n,i){void 0===i&&(i=!1);var r=wU(t,n,i),o=r.before,a=r.after;Na((function(t){o(t),e.forEach((function(e){switch(e.c){case"L":t.lineTo(e.x,e.y);break;case"M":t.moveTo(e.x,e.y);break;case"Z":t.closePath();break;case"A":t.arcTo(e.x1,e.y1,e.x2,e.y2,e.radius);break;case"a":default:break;case"C":t.bezierCurveTo(e.cpX1,e.cpY1,e.cpX2,e.cpY2,e.x,e.y)}})),a(t)}))}(e.commands,e,n,i);break;case"roundedRect":var s=wU(e,n,i),l=s.before,c=s.after,u=e.bounds,d=u.x,p=u.y,h=u.width,f=u.height,m=u.radius;Na((function(e){l(e),e.drawRoundedRect(d,p,h,f,m),c(e)}))}}}function xU(e,t,n){if(e.styles){var i=e.styles||{},r=i.bc,o=i.brw,a=i.bro,s=i.bo,l=i.brc,c={};if(!yt.exports.isNil(o)&&(c.lineWidth=o*t),!yt.exports.isNil(l)&&(c.stroke=pr(l)),!yt.exports.isNil(a)&&(c.strokeAlpha=a),!yt.exports.isNil(r)&&(c.fill=pr(r)),!yt.exports.isNil(s)&&(c.fillAlpha=s),0!==Object.keys(c).length)return fa(exports.E(exports.E({},n),c)),ma}}function wU(e,t,n){void 0===n&&(n=!1);var i=0!==t.lineWidth,r=!yt.exports.isNil(t.fill),o=t.lineDash,a=t.fill?xr(t.fill):0,s=t.lineWidth||0,l=t.strokeAlpha||1,c=t.fillAlpha||1,u=t.stroke?xr(t.stroke):void 0;if(!n){var d=e.styles||{},p=d.bc,h=d.brw,f=d.bro,m=d.bo,v=d.brc;a=yt.exports.isNil(p)?a:p,s=yt.exports.isNil(h)?s:h,l=yt.exports.isNil(f)?l:f,c=yt.exports.isNil(m)?c:m,u=yt.exports.isNil(v)?u:v}return{before:function(e){e.clear(),i&&e.lineStyle({width:s,color:u,alpha:l,lineDash:o}),r&&e.beginFill(a,c)},after:function(e){e.endFill(),e.lineStyle()}}}var CU=function(e){function t(t){var n=e.call(this,t)||this;return n.editor=t,n.propertyName="shapeTextFontSize",n.renderer=sN,n.couldAffectGroup=!0,n.sizeList=Ve,n.maxSize=999,n.minSize=10,n}return P(t,e),t.prototype.getEditingTextNode=function(){var e;if(this.editor.editingEditor){var t=this.editor.editingEditor.element;return null===(e=this.editor.element.textNodes)||void 0===e?void 0:e.find((function(e){return e.id===t.id}))}},t.prototype.getValue=function(){var e,t,n=this.getEditingTextNode();if(n)return Math.max(Math.round(((null===(e=n.styleProperty.getInitData())||void 0===e?void 0:e.fontSize)||14)*this.editor.element.scale),1);var i=this.editor.element.textNodes[0];return i?Math.max(Math.round(((null===(t=i.styleProperty.getInitData())||void 0===t?void 0:t.fontSize)||14)*this.editor.element.scale),1):14},t.prototype.changeSelfValue=function(e,t){var n=Math.max(1,e/this.editor.element.scale),i=t||this.editor.getOp(),r=this.getEditingTextNode();if(r){var o=ib(n,r.lineHeightRate);r.updateStyle(i,{fontSize:n,lineHeight:o})}else this.editor.element.textNodes.forEach((function(e){var t=ib(n,e.lineHeightRate);e.updateStyle(i,{fontSize:n,lineHeight:t})}));!t&&i.sync(),this.editor.saveTxtStyle(r||this.editor.element.textNodes[0])},t}(CD),SU=function(e){function t(t){var n=e.call(this,t)||this;return n.editor=t,n}return P(t,e),t.prototype.getEditingTextNode=function(){var e;if(this.editor.editingEditor){var t=this.editor.editingEditor.element;return null===(e=this.editor.element.textNodes)||void 0===e?void 0:e.find((function(e){return e.id===t.id}))}},Object.defineProperty(t.prototype,"ha",{get:function(){var e,t,n=this.getEditingTextNode();if(n)return(null===(e=n.styleProperty.getInitData())||void 0===e?void 0:e.ha)||"center";var i=this.editor.element.textNodes[0];return i&&(null===(t=i.styleProperty.getInitData())||void 0===t?void 0:t.ha)||"center"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"va",{get:function(){var e,t,n=this.getEditingTextNode();if(n)return(null===(e=n.styleProperty.getInitData())||void 0===e?void 0:e.va)||"middle";var i=this.editor.element.textNodes[0];return i&&(null===(t=i.styleProperty.getInitData())||void 0===t?void 0:t.va)||"middle"},enumerable:!1,configurable:!0}),t.prototype.setSelfVa=function(e,t){var n=t||this.editor.upime.createOperation(),i=this.getEditingTextNode();i?i.updateStyle(n,{va:e}):this.editor.element.textNodes.forEach((function(t){t.updateStyle(n,{va:e})})),!t&&n.sync(),this.editor.saveTxtStyle(i||this.editor.element.textNodes[0])},t.prototype.setSelfHa=function(e,t){var n=t||this.editor.upime.createOperation(),i=this.getEditingTextNode();i?i.updateStyle(n,{ha:e}):this.editor.element.textNodes.forEach((function(t){t.updateStyle(n,{ha:e})})),!t&&n.sync(),this.editor.saveTxtStyle(i||this.editor.element.textNodes[0])},t}(tA),kU=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.element=n,r.updatePropertyEditors(),r.multiResizeDirection.push("n","w","e","s"),r}return P(t,e),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.element.schema},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"limitStyles",{get:function(){var e,t;return null===(t=null===(e=this.schema)||void 0===e?void 0:e.constraints)||void 0===t?void 0:t.styles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bgEditBlock",{get:function(){var e,t,n,i;return{color:!this.schema||(null===(t=null===(e=this.limitStyles)||void 0===e?void 0:e.bc)||void 0===t?void 0:t.disabled),opacity:!this.schema||(null===(i=null===(n=this.limitStyles)||void 0===n?void 0:n.bo)||void 0===i?void 0:i.disabled)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"borderEditBlock",{get:function(){var e,t,n,i,r,o,a,s;return{color:!this.schema||(null===(t=null===(e=this.limitStyles)||void 0===e?void 0:e.brc)||void 0===t?void 0:t.disabled),width:!this.schema||(null===(i=null===(n=this.limitStyles)||void 0===n?void 0:n.brw)||void 0===i?void 0:i.disabled),style:!this.schema||(null===(o=null===(r=this.limitStyles)||void 0===r?void 0:r.brs)||void 0===o?void 0:o.disabled),opacity:!this.schema||(null===(s=null===(a=this.limitStyles)||void 0===a?void 0:a.bro)||void 0===s?void 0:s.disabled)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastColor",{set:function(e){var t=this.element.categoryId;t&&void 0!==e&&this.upime.setGraphicLastColorByCategory(t,e)},enumerable:!1,configurable:!0}),t.prototype.updatePropertyEditors=function(){var e,t,n=this;if(this.editable&&!this.isHandMode){this.richContentEditors||(this.richContentEditors=[],null===(e=this.element.childElements)||void 0===e||e.forEach((function(e){var t;e.richTextClient&&(null===(t=n.richContentEditors)||void 0===t||t.push(e.richTextClient.contentEditor))})));var i=this.element.textNodes[0];i&&(this.richContentEditor=null===(t=i.richTextClient)||void 0===t?void 0:t.contentEditor),this.propertyEditors=[],this.upime.phoneMode||this.propertyEditors.push(new mA(this,this.element)),this.richContentEditor&&this.propertyEditors.push(new CU(this),new SU(this),new sA(this,this.richContentEditor),new vE(this,this.richContentEditor));var r=new pE(this,this.element);r.borderEditor.block=this.borderEditBlock,r.bgEditor.block=this.bgEditBlock,this.propertyEditors.push(r)}},t.prototype.checkKeepRatio=function(t){return e.prototype.checkKeepRatio.call(this,t)&&this.shiftKeyDown},t.prototype.getMinSize=function(e,t){var n,i,r,o,a,s;if(this.getIsUpdateScale(e,t)){var l=this.element.globalTransform.currentScale;return[(null!==(r=null===(i=null===(n=this.schema)||void 0===n?void 0:n.constraints)||void 0===i?void 0:i.minWidth)&&void 0!==r?r:0)/l,(null!==(s=null===(a=null===(o=this.schema)||void 0===o?void 0:o.constraints)||void 0===a?void 0:a.minHeight)&&void 0!==s?s:0)/l]}return[this.element.minWidth,this.element.minHeight]},t.prototype.dealBorderResize=function(e,t,n){if(this.element.schema){var i=t.left,r=t.top,o=t.right,a=t.bottom,s=(o-i)/this.element.scale,l=(a-r)/this.element.scale,c=this.element.position,u={position:exports.E(exports.E({},c),{x:i,y:r}),size:{width:s,height:l}};if(this.getIsUpdateScale(n,e)&&u.size&&u.size){var d=u.size.width/this.element.size.width*this.element.scale;delete u.size,u.scale=d}this.updateSelf(u),this.saveStyle()}},t.prototype.getQuickAddClone=function(e){var t=new BU(this.upime,e);return t.graphicId=this.element.graphicId,t.categoryId=this.element.categoryId,t.schema=this.schema,t.onUpdatedSchema(),t},t.prototype.transformQuickAddProcesseCreateData=function(e){var t,n=this;return e.cps=(null===(t=e.cps)||void 0===t?void 0:t.map((function(e){return"weakOt"===e[1]?[e[0],e[1],{version:n.upime.genOtVersion(0),content:[]}]:e})))||[],e},t.prototype.onQuickAddEnd=function(e,t){var n,i=null===(n=t.textNodes[0])||void 0===n?void 0:n.richTextClient.contentEditor.currentStyle.color;e.onGetSchema=function(){var t;if(_e.desktop&&e.currentEditor&&"single"===e.selectStatus){var n=e.currentEditor;n.connectedEditor||n.connectTextEditor(),void 0!==i&&(null===(t=n.connectedEditor)||void 0===t||t.updateStyle({color:i})),n.startEdit(),e.onGetSchema=void 0}}},t.prototype.drawOutline=function(){var e=this,t=this.upime.view.getViewbox().scale*this.element.scale*this.element.globalTransform.currentScale,n=1/(this.element.scale*this.element.globalTransform.currentScale),i={lineWidth:n,lineDash:[4*n,4*n],stroke:pr(5740786)};this.element.computedBgGeoList.length>0?(fa(exports.E({x:0,y:0,scaleX:t,scaleY:t},i)),this.element.computedBgGeoList.forEach((function(t){return EU(t,e.element,i)})),ma()):(fa(exports.E({x:0,y:0,scaleX:t,scaleY:t},i)),ka({x:0,y:0,width:this.element.size.width,height:this.element.size.height}),ma())},t.prototype.saveStyle=function(){var e=this.element.categoryId;if(e){var t={size:this.element.size,hasBorder:this.element.hasBorder,borderStyle:this.element.borderStyle,borderColor:this.element.borderColor,borderThickness:this.element.borderThickness,borderOpacity:this.element.borderOpacity,hasBg:this.element.hasBg,bgColor:this.element.bgColor,bgOpacity:this.element.bgOpacity};this.upime.setGraphicStyleByCategory(e,t)}},t.prototype.saveTxtStyle=function(e){var t=this.element.categoryId;if(t){var n={size:this.element.size,hasBorder:this.element.hasBorder,borderStyle:this.element.borderStyle,borderColor:this.element.borderColor,borderThickness:this.element.borderThickness,borderOpacity:this.element.borderOpacity,hasBg:this.element.hasBg,bgColor:this.element.bgColor,bgOpacity:this.element.bgOpacity,va:e.va,ha:e.ha,fontSize:e.fontSize,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate,fontFamily:e.fontFamily};this.upime.setGraphicStyleByCategory(t,n)}},t.prototype.updateProperty=function(t){e.prototype.updateProperty.call(this,t),this.saveStyle()},t.prototype.slideUpdateProperty=function(t,n,i){void 0===i&&(i=!1),e.prototype.slideUpdateProperty.call(this,t,n,i),this.saveStyle()},t.prototype.getIsUpdateScale=function(e,t){var n=t.originEvent.shiftKey||t.originEvent.ctrlKey,i=["nw","ne","sw","se"].indexOf(e)>=0;return n&&i},t}(BD),_U=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.parentElement=i,r.fontFamily=He,r.fontSize=14,r.lineHeight=Ue,r.ha="center",r.va="middle",r.parentTransform=sr,r._globalTransform=sr,r.dealStyleChange=function(e){r.fontFamily=e.fontFamily,r.va=e.va,r.ha=e.ha,r.fontSize=e.fontSize,r.lineHeight=e.lineHeight},r.textProperty=i.getCustomProperty(r.id+"_text","weakOt"),r.textProperty.bindClient(r.richTextClient),r.styleProperty=i.getCustomProperty(r.id+"_style","value"),r.styleProperty.onchange=r.dealStyleChange,r.styleProperty.data?r.dealStyleChange(r.styleProperty.data):r.styleProperty.data=r.getStyle(),r}return P(t,e),Object.defineProperty(t.prototype,"globalTransform",{get:function(){return this._globalTransform},enumerable:!1,configurable:!0}),t.prototype.updateTransform=function(){var e=this.parentElement.globalTransform,t=function(e){var t=e.scale,n=e.rotate,i=e.size,r=e.position,o=r.x,a=r.y;if(0===n)return{x:o,y:a,scaleX:t,scaleY:t,pivotX:0,pivotY:0,rotation:0};var s=i.width/2,l=i.height/2;return{x:o+=s*t,y:a+=l*t,scaleX:t,scaleY:t,pivotX:s,pivotY:l,rotation:n}}(this.parentElement),n=t.x,i=t.y,r=t.scaleX,o=t.scaleY,a=t.pivotX,s=t.pivotY,l=t.rotation,c=new ar;c.update(n,i,r,o,a,s,l*Math.PI/180),this.parentTransform=c,this._globalTransform=e.clone().append(c)},t.prototype.initRichClient=function(){return new TU(this)},t.prototype.getStyle=function(){var e=this;return{fontFamily:e.fontFamily,va:e.va,ha:e.ha,fontSize:e.fontSize,lineHeight:e.lineHeight,lineHeightRate:e.lineHeightRate}},t.prototype.updateStyle=function(e,t){var n=this.styleProperty,i=exports.E(exports.E({},this.getStyle()),t);n.data=i,e.update(this.parentElement,{cps:[[n.name,n.type,i]]})},t.prototype.isSingleSelected=function(){return void 0!==this.parentElement.currentEditor&&"single"===this.parentElement.selectStatus},t.prototype.isEditingSelf=function(){return void 0!==this.parentElement.currentEditor&&this.parentElement.currentEditor.editingEditor===this.richTextClient.contentEditor},t.prototype.isFrozed=function(){return void 0!==this.parentElement.frozedGroup},t.prototype.hasGroup=function(){return void 0!==this.parentElement.group&&this.parentElement.group.members.length>1},t.prototype.checkSelectRelation=function(e,t){if(!t)return null;if("attach"===t.type)return null;var n=this.parentTransform.applyInverse(e);if(!Ot(n,this.getBorderBox()))return null;var i,r=t.type,o="select"===this.upime.xmode,a={},s={transparent:!1,metric:-1,realTarget:this,metaData:a};if(void 0===this.parentElement.currentEditor&&("hover"===r||"click"===r)||!o&&"click"===r){var l=this.checkRichTextHoverClick(n,t);if(l){var c=l.textAnchor,u=l.mentionStartIndex,d=l.mobileHover;return i={type:"childClickData",childId:this.id,data:{mobileHover:d,textAnchor:c,mentionStartIndex:u}},a.clickData={customData:i,mobileHover:d},s.transparent=!1,s}}if("click"===r||"hover"===r||"move"===r){var p=this.checkTextEdit(n,t);if(null==p?void 0:p.selectingText){if(a.selectingText=!0,p.clickData)i={type:"childClickData",childId:this.id,data:null==p?void 0:p.clickData},a.clickData={customData:i};else{var h={type:"childCtrlData",child:this,data:void 0};a.directCtrlData=h}return s.transparent=!1,s}}return null},t.prototype.dealHoverStart=function(e){var t,n,i=null===(n=null===(t=e.metaData)||void 0===t?void 0:t.clickData)||void 0===n?void 0:n.customData;if(i){var r=i.data,o=r.textAnchor,a=r.mentionStartIndex,s=r.editText;void 0!==o||void 0!==a?this.dealRichTextHoverStart({textAnchor:o,mentionStartIndex:a}):s&&(this.upime.view.setCursor("text",this),this.upime.updateView())}},t.prototype.dealHoverEnd=function(){this.dealRichTextHoverEnd(),this.upime.view.setCursor("",this)},t.prototype.dealClickStart=function(e){var t,n,i=null===(n=null===(t=e.metaData)||void 0===t?void 0:t.clickData)||void 0===n?void 0:n.customData;if(i){var r=i.data,o=r.textAnchor,a=r.mentionStartIndex,s=r.editText;void 0!==o||void 0!==a?this.dealRichTextClick({textAnchor:o,mentionStartIndex:a}):void 0!==s&&this.dealEditTextClick(s)}},t.prototype.applyEditText=function(e,t){return this.parentElement.applyEditText(e,t)},t.prototype.dealParentEditCtrl=function(e,t){this.richTextClient.contentEditor.dealTextSelect(e)},t.prototype.render=function(){var e=this,t=e.richTextClient,n=e.textRect,i=e.position,r=i.x,o=i.y;e.size,fa({x:r,y:o}),jy({x:n.x,y:n.y,maxHeight:n.height,element:this,richClient:t,isWheeling:this.upime.view.isWheeling}),ma()},t.prototype.getBorderBox=function(){var e=this.position,t=this.size;return{left:e.x,top:e.y,right:e.x+t.width,bottom:e.y+t.height}},t.prototype.getGlobalBox=function(){var e=this.getBorderBox();return this._globalTransform.applyBorderBox(e)},t.prototype.applySelectSelf=function(){return this.upime.selectElement(this.parentElement)},t}(EA),TU=function(e){function t(t){return e.call(this,t)||this}return P(t,e),t.prototype.createContentEditor=function(){return new IU(this)},Object.defineProperty(t.prototype,"currentEditor",{get:function(){return this.element.parentElement.currentEditor},enumerable:!1,configurable:!0}),t.prototype.syncWeakOt=function(e,t){var n,i=this.element,r=i.parentElement,o=i.textProperty;null===(n=r.currentEditor)||void 0===n||n.syncWeakOt(e,t,o)},t}(yA),IU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t}(Ly),PU={exports:{}};PU.exports=function(){var e=e||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==mt&&mt.crypto&&(n=mt.crypto),!n)try{n=require("crypto")}catch(e){}var i=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},a=o.lib={},s=a.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=a.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=a<<24-(i+o)%4*8}else for(var s=0;s<r;s+=4)t[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new l.init(t,e)}}),c=o.enc={},u=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new l.init(n,t/2)}},d=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new l.init(n,t)}},p=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},h=a.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,i=this._data,r=i.words,o=i.sigBytes,a=this.blockSize,s=o/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*c,o);if(c){for(var d=0;d<c;d+=a)this._doProcessBlock(r,d);n=r.splice(0,c),i.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});a.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=o.algo={};return o}(Math);return e}(),function(e){return n=(t=e).lib,i=n.Base,r=n.WordArray,(o=t.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;i<t;i++){var o=e[i];n.push(o.high),n.push(o.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),e;var t,n,i,r,o}(PU.exports),function(e){(function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init,i=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,i=[],r=0;r<t;r++)i[r>>>2]|=e[r]<<24-r%4*8;n.call(this,i,t)}else n.apply(this,arguments)};i.prototype=t}})(),e.lib.WordArray}(PU.exports),function(e){(function(){var t=e,n=t.lib.WordArray,i=t.enc;function r(e){return e<<8&4278255360|e>>>8&16711935}i.Utf16=i.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=2){var o=t[r>>>2]>>>16-r%4*8&65535;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,i=[],r=0;r<t;r++)i[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return n.create(i,2*t)}},i.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var a=r(t[o>>>2]>>>16-o%4*8&65535);i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,i=[],o=0;o<t;o++)i[o>>>1]|=r(e.charCodeAt(o)<<16-o%2*16);return n.create(i,2*t)}}})(),e.enc.Utf16}(PU.exports);var NU=function(e){return function(){var t=e,n=t.lib.WordArray;function i(e,t,i){for(var r=[],o=0,a=0;a<t;a++)if(a%4){var s=i[e.charCodeAt(a-1)]<<a%4*2|i[e.charCodeAt(a)]>>>6-a%4*2;r[o>>>2]|=s<<24-o%4*8,o++}return n.create(r,o)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<n;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<n;s++)r.push(i.charAt(a>>>6*(3-s)&63));var l=i.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return i(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(PU.exports);!function(e){(function(){var t=e,n=t.lib.WordArray;function i(e,t,i){for(var r=[],o=0,a=0;a<t;a++)if(a%4){var s=i[e.charCodeAt(a-1)]<<a%4*2|i[e.charCodeAt(a)]>>>6-a%4*2;r[o>>>2]|=s<<24-o%4*8,o++}return n.create(r,o)}t.enc.Base64url={stringify:function(e,t=!0){var n=e.words,i=e.sigBytes,r=t?this._safe_map:this._map;e.clamp();for(var o=[],a=0;a<i;a+=3)for(var s=(n[a>>>2]>>>24-a%4*8&255)<<16|(n[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|n[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;l<4&&a+.75*l<i;l++)o.push(r.charAt(s>>>6*(3-l)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e,t=!0){var n=e.length,r=t?this._safe_map:this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var a=0;a<r.length;a++)o[r.charCodeAt(a)]=a}var s=r.charAt(64);if(s){var l=e.indexOf(s);-1!==l&&(n=l)}return i(e,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}})(),e.enc.Base64url}(PU.exports),function(e){(function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,a=n.algo,s=[];!function(){for(var e=0;e<64;e++)s[e]=4294967296*t.abs(t.sin(e+1))|0}();var l=a.MD5=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var o=this._hash.words,a=e[t+0],l=e[t+1],h=e[t+2],f=e[t+3],m=e[t+4],v=e[t+5],g=e[t+6],y=e[t+7],b=e[t+8],E=e[t+9],x=e[t+10],w=e[t+11],C=e[t+12],S=e[t+13],k=e[t+14],_=e[t+15],T=o[0],I=o[1],P=o[2],N=o[3];T=c(T,I,P,N,a,7,s[0]),N=c(N,T,I,P,l,12,s[1]),P=c(P,N,T,I,h,17,s[2]),I=c(I,P,N,T,f,22,s[3]),T=c(T,I,P,N,m,7,s[4]),N=c(N,T,I,P,v,12,s[5]),P=c(P,N,T,I,g,17,s[6]),I=c(I,P,N,T,y,22,s[7]),T=c(T,I,P,N,b,7,s[8]),N=c(N,T,I,P,E,12,s[9]),P=c(P,N,T,I,x,17,s[10]),I=c(I,P,N,T,w,22,s[11]),T=c(T,I,P,N,C,7,s[12]),N=c(N,T,I,P,S,12,s[13]),P=c(P,N,T,I,k,17,s[14]),T=u(T,I=c(I,P,N,T,_,22,s[15]),P,N,l,5,s[16]),N=u(N,T,I,P,g,9,s[17]),P=u(P,N,T,I,w,14,s[18]),I=u(I,P,N,T,a,20,s[19]),T=u(T,I,P,N,v,5,s[20]),N=u(N,T,I,P,x,9,s[21]),P=u(P,N,T,I,_,14,s[22]),I=u(I,P,N,T,m,20,s[23]),T=u(T,I,P,N,E,5,s[24]),N=u(N,T,I,P,k,9,s[25]),P=u(P,N,T,I,f,14,s[26]),I=u(I,P,N,T,b,20,s[27]),T=u(T,I,P,N,S,5,s[28]),N=u(N,T,I,P,h,9,s[29]),P=u(P,N,T,I,y,14,s[30]),T=d(T,I=u(I,P,N,T,C,20,s[31]),P,N,v,4,s[32]),N=d(N,T,I,P,b,11,s[33]),P=d(P,N,T,I,w,16,s[34]),I=d(I,P,N,T,k,23,s[35]),T=d(T,I,P,N,l,4,s[36]),N=d(N,T,I,P,m,11,s[37]),P=d(P,N,T,I,y,16,s[38]),I=d(I,P,N,T,x,23,s[39]),T=d(T,I,P,N,S,4,s[40]),N=d(N,T,I,P,a,11,s[41]),P=d(P,N,T,I,f,16,s[42]),I=d(I,P,N,T,g,23,s[43]),T=d(T,I,P,N,E,4,s[44]),N=d(N,T,I,P,C,11,s[45]),P=d(P,N,T,I,_,16,s[46]),T=p(T,I=d(I,P,N,T,h,23,s[47]),P,N,a,6,s[48]),N=p(N,T,I,P,y,10,s[49]),P=p(P,N,T,I,k,15,s[50]),I=p(I,P,N,T,v,21,s[51]),T=p(T,I,P,N,C,6,s[52]),N=p(N,T,I,P,f,10,s[53]),P=p(P,N,T,I,x,15,s[54]),I=p(I,P,N,T,l,21,s[55]),T=p(T,I,P,N,b,6,s[56]),N=p(N,T,I,P,_,10,s[57]),P=p(P,N,T,I,g,15,s[58]),I=p(I,P,N,T,S,21,s[59]),T=p(T,I,P,N,m,6,s[60]),N=p(N,T,I,P,w,10,s[61]),P=p(P,N,T,I,h,15,s[62]),I=p(I,P,N,T,E,21,s[63]),o[0]=o[0]+T|0,o[1]=o[1]+I|0,o[2]=o[2]+P|0,o[3]=o[3]+N|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var o=t.floor(i/4294967296),a=i;n[15+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,i,r,o,a){var s=e+(t&n|~t&i)+r+a;return(s<<o|s>>>32-o)+t}function u(e,t,n,i,r,o,a){var s=e+(t&i|n&~i)+r+a;return(s<<o|s>>>32-o)+t}function d(e,t,n,i,r,o,a){var s=e+(t^n^i)+r+a;return(s<<o|s>>>32-o)+t}function p(e,t,n,i,r,o,a){var s=e+(n^(t|~i))+r+a;return(s<<o|s>>>32-o)+t}n.MD5=o._createHelper(l),n.HmacMD5=o._createHmacHelper(l)})(Math),e.MD5}(PU.exports),function(e){(function(){var t=e,n=t.lib,i=n.WordArray,r=n.Hasher,o=t.algo,a=[],s=o.SHA1=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],l=n[4],c=0;c<80;c++){if(c<16)a[c]=0|e[t+c];else{var u=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=u<<1|u>>>31}var d=(i<<5|i>>>27)+l+a[c];d+=c<20?1518500249+(r&o|~r&s):c<40?1859775393+(r^o^s):c<60?(r&o|r&s|o&s)-1894007588:(r^o^s)-899497514,l=s,s=o,o=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=r._createHelper(s),t.HmacSHA1=r._createHmacHelper(s)})(),e.SHA1}(PU.exports),function(e){(function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,a=n.algo,s=[],l=[];!function(){function e(e){for(var n=t.sqrt(e),i=2;i<=n;i++)if(!(e%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)e(i)&&(r<8&&(s[r]=n(t.pow(i,.5))),l[r]=n(t.pow(i,1/3)),r++),i++}();var c=[],u=a.SHA256=o.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,v=c[h-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[h]=m+c[h-7]+g+c[h-16]}var y=i&r^i&o^r&o,b=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),E=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[h]+c[h];p=d,d=u,u=s,s=a+E|0,a=o,o=r,r=i,i=E+(b+y)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=o._createHelper(u),n.HmacSHA256=o._createHmacHelper(u)})(Math),e.SHA256}(PU.exports),function(e){return n=(t=e).lib.WordArray,i=t.algo,r=i.SHA256,o=i.SHA224=r.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=r._createHelper(o),t.HmacSHA224=r._createHmacHelper(o),e.SHA224;var t,n,i,r,o}(PU.exports),function(e){(function(){var t=e,n=t.lib.Hasher,i=t.x64,r=i.Word,o=i.WordArray,a=t.algo;function s(){return r.create.apply(r,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var u=a.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=i.high,f=i.low,m=r.high,v=r.low,g=o.high,y=o.low,b=a.high,E=a.low,x=s.high,w=s.low,C=u.high,S=u.low,k=d.high,_=d.low,T=p.high,I=p.low,P=h,N=f,M=m,A=v,D=g,R=y,B=b,L=E,O=x,F=w,z=C,H=S,U=k,W=_,V=T,j=I,G=0;G<80;G++){var q,K,Y=c[G];if(G<16)K=Y.high=0|e[t+2*G],q=Y.low=0|e[t+2*G+1];else{var X=c[G-15],Q=X.high,Z=X.low,J=(Q>>>1|Z<<31)^(Q>>>8|Z<<24)^Q>>>7,$=(Z>>>1|Q<<31)^(Z>>>8|Q<<24)^(Z>>>7|Q<<25),ee=c[G-2],te=ee.high,ne=ee.low,ie=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,re=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=c[G-7],ae=oe.high,se=oe.low,le=c[G-16],ce=le.high,ue=le.low;K=(K=(K=J+ae+((q=$+se)>>>0<$>>>0?1:0))+ie+((q+=re)>>>0<re>>>0?1:0))+ce+((q+=ue)>>>0<ue>>>0?1:0),Y.high=K,Y.low=q}var de,pe=O&z^~O&U,he=F&H^~F&W,fe=P&M^P&D^M&D,me=N&A^N&R^A&R,ve=(P>>>28|N<<4)^(P<<30|N>>>2)^(P<<25|N>>>7),ge=(N>>>28|P<<4)^(N<<30|P>>>2)^(N<<25|P>>>7),ye=(O>>>14|F<<18)^(O>>>18|F<<14)^(O<<23|F>>>9),be=(F>>>14|O<<18)^(F>>>18|O<<14)^(F<<23|O>>>9),Ee=l[G],xe=Ee.high,we=Ee.low,Ce=V+ye+((de=j+be)>>>0<j>>>0?1:0),Se=ge+me;V=U,j=W,U=z,W=H,z=O,H=F,O=B+(Ce=(Ce=(Ce=Ce+pe+((de+=he)>>>0<he>>>0?1:0))+xe+((de+=we)>>>0<we>>>0?1:0))+K+((de+=q)>>>0<q>>>0?1:0))+((F=L+de|0)>>>0<L>>>0?1:0)|0,B=D,L=R,D=M,R=A,M=P,A=N,P=Ce+(ve+fe+(Se>>>0<ge>>>0?1:0))+((N=de+Se|0)>>>0<de>>>0?1:0)|0}f=i.low=f+N,i.high=h+P+(f>>>0<N>>>0?1:0),v=r.low=v+A,r.high=m+M+(v>>>0<A>>>0?1:0),y=o.low=y+R,o.high=g+D+(y>>>0<R>>>0?1:0),E=a.low=E+L,a.high=b+B+(E>>>0<L>>>0?1:0),w=s.low=w+F,s.high=x+O+(w>>>0<F>>>0?1:0),S=u.low=S+H,u.high=C+z+(S>>>0<H>>>0?1:0),_=d.low=_+W,d.high=k+U+(_>>>0<W>>>0?1:0),I=p.low=I+j,p.high=T+V+(I>>>0<j>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(i+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=n._createHelper(u),t.HmacSHA512=n._createHmacHelper(u)})(),e.SHA512}(PU.exports),function(e){return n=(t=e).x64,i=n.Word,r=n.WordArray,o=t.algo,a=o.SHA512,s=o.SHA384=a.extend({_doReset:function(){this._hash=new r.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=16,e}}),t.SHA384=a._createHelper(s),t.HmacSHA384=a._createHmacHelper(s),e.SHA384;var t,n,i,r,o,a,s}(PU.exports),function(e){(function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,a=n.x64.Word,s=n.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var r=1,o=0;o<24;o++){for(var s=0,d=0,p=0;p<7;p++){if(1&r){var h=(1<<p)-1;h<32?d^=1<<h:s^=1<<h-32}128&r?r=r<<1^113:r<<=1}u[o]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var p=s.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,r=0;r<i;r++){var o=e[t+2*r],a=e[t+2*r+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(I=n[r]).high^=a,I.low^=o}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var h=0,f=0,m=0;m<5;m++)h^=(I=n[p+5*m]).high,f^=I.low;var v=d[p];v.high=h,v.low=f}for(p=0;p<5;p++){var g=d[(p+4)%5],y=d[(p+1)%5],b=y.high,E=y.low;for(h=g.high^(b<<1|E>>>31),f=g.low^(E<<1|b>>>31),m=0;m<5;m++)(I=n[p+5*m]).high^=h,I.low^=f}for(var x=1;x<25;x++){var w=(I=n[x]).high,C=I.low,S=l[x];S<32?(h=w<<S|C>>>32-S,f=C<<S|w>>>32-S):(h=C<<S-32|w>>>64-S,f=w<<S-32|C>>>64-S);var k=d[c[x]];k.high=h,k.low=f}var _=d[0],T=n[0];for(_.high=T.high,_.low=T.low,p=0;p<5;p++)for(m=0;m<5;m++){var I=n[x=p+5*m],P=d[x],N=d[(p+1)%5+5*m],M=d[(p+2)%5+5*m];I.high=P.high^~N.high&M.high,I.low=P.low^~N.low&M.low}I=n[0];var A=u[s];I.high^=A.high,I.low^=A.low}},_doFinalize:function(){var e=this._data,n=e.words;this._nDataBytes;var i=8*e.sigBytes,o=32*this.blockSize;n[i>>>5]|=1<<24-i%32,n[(t.ceil((i+1)/o)*o>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],u=0;u<l;u++){var d=a[u],p=d.high,h=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),c.push(h),c.push(p)}return new r.init(c,s)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=o._createHelper(p),n.HmacSHA3=o._createHmacHelper(p)})(Math),e.SHA3}(PU.exports),function(e){
/** @preserve
	(c) 2012 by Cédric Mesnil. All rights reserved.

	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/
(function(t){var n=e,i=n.lib,r=i.WordArray,o=i.Hasher,a=n.algo,s=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=r.create([0,1518500249,1859775393,2400959708,2840853838]),p=r.create([1352829926,1548603684,1836072691,2053994217,0]),h=a.RIPEMD160=o.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,r=e[i];e[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var o,a,h,E,x,w,C,S,k,_,T,I=this._hash.words,P=d.words,N=p.words,M=s.words,A=l.words,D=c.words,R=u.words;for(w=o=I[0],C=a=I[1],S=h=I[2],k=E=I[3],_=x=I[4],n=0;n<80;n+=1)T=o+e[t+M[n]]|0,T+=n<16?f(a,h,E)+P[0]:n<32?m(a,h,E)+P[1]:n<48?v(a,h,E)+P[2]:n<64?g(a,h,E)+P[3]:y(a,h,E)+P[4],T=(T=b(T|=0,D[n]))+x|0,o=x,x=E,E=b(h,10),h=a,a=T,T=w+e[t+A[n]]|0,T+=n<16?y(C,S,k)+N[0]:n<32?g(C,S,k)+N[1]:n<48?v(C,S,k)+N[2]:n<64?m(C,S,k)+N[3]:f(C,S,k)+N[4],T=(T=b(T|=0,R[n]))+_|0,w=_,_=k,k=b(S,10),S=C,C=T;T=I[1]+h+k|0,I[1]=I[2]+E+_|0,I[2]=I[3]+x+w|0,I[3]=I[4]+o+C|0,I[4]=I[0]+a+S|0,I[0]=T},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,o=r.words,a=0;a<5;a++){var s=o[a];o[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return r},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function f(e,t,n){return e^t^n}function m(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function g(e,t,n){return e&n|t&~n}function y(e,t,n){return e^(t|~n)}function b(e,t){return e<<t|e>>>32-t}n.RIPEMD160=o._createHelper(h),n.HmacRIPEMD160=o._createHmacHelper(h)})(),e.RIPEMD160}(PU.exports),function(e){var t,n,i;n=(t=PU.exports).lib.Base,i=t.enc.Utf8,t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),a=this._iKey=t.clone(),s=o.words,l=a.words,c=0;c<n;c++)s[c]^=1549556828,l[c]^=909522486;o.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(e){return i=(n=(t=e).lib).Base,r=n.WordArray,a=(o=t.algo).SHA1,s=o.HMAC,l=o.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=s.create(n.hasher,e),o=r.create(),a=r.create([1]),l=o.words,c=a.words,u=n.keySize,d=n.iterations;l.length<u;){var p=i.update(t).finalize(a);i.reset();for(var h=p.words,f=h.length,m=p,v=1;v<d;v++){m=i.finalize(m),i.reset();for(var g=m.words,y=0;y<f;y++)h[y]^=g[y]}o.concat(p),c[0]++}return o.sigBytes=4*u,o}}),t.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},e.PBKDF2;var t,n,i,r,o,a,s,l}(PU.exports),function(e){return i=(n=(t=e).lib).Base,r=n.WordArray,a=(o=t.algo).MD5,s=o.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,i=this.cfg,o=i.hasher.create(),a=r.create(),s=a.words,l=i.keySize,c=i.iterations;s.length<l;){n&&o.update(n),n=o.update(e).finalize(t),o.reset();for(var u=1;u<c;u++)n=o.finalize(n),o.reset();a.concat(n)}return a.sigBytes=4*l,a}}),t.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)},e.EvpKDF;var t,n,i,r,o,a,s}(PU.exports),function(e){e.lib.Cipher||function(t){var n=e,i=n.lib,r=i.Base,o=i.WordArray,a=i.BufferedBlockAlgorithm,s=n.enc;s.Utf8;var l=s.Base64,c=n.algo.EvpKDF,u=i.Cipher=a.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?b:g}return function(t){return{encrypt:function(n,i,r){return e(i).encrypt(t,n,i,r)},decrypt:function(n,i,r){return e(i).decrypt(t,n,i,r)}}}}()});i.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=n.mode={},p=i.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=d.CBC=function(){var e=p.extend();function t(e,t,n){var i,r=this._iv;r?(i=r,this._iv=undefined):i=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,r=i.blockSize;t.call(this,e,n,r),i.encryptBlock(e,n),this._prevBlock=e.slice(n,n+r)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,r=i.blockSize,o=e.slice(n,n+r);i.decryptBlock(e,n),t.call(this,e,n,r),this._prevBlock=o}}),e}(),f=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,i=n-e.sigBytes%n,r=i<<24|i<<16|i<<8|i,a=[],s=0;s<i;s+=4)a.push(r);var l=o.create(a,i);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};i.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:f}),reset:function(){var e;u.reset.call(this);var t=this.cfg,n=t.iv,i=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=i.createEncryptor:(e=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(i,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var m=i.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?o.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(e){var t,n=l.parse(e),i=n.words;return 1398893684==i[0]&&1701076831==i[1]&&(t=o.create(i.slice(2,4)),i.splice(0,4),n.sigBytes-=16),m.create({ciphertext:n,salt:t})}},g=i.SerializableCipher=r.extend({cfg:r.extend({format:v}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var r=e.createEncryptor(n,i),o=r.finalize(t),a=r.cfg;return m.create({ciphertext:o,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(n.kdf={}).OpenSSL={execute:function(e,t,n,i){i||(i=o.random(8));var r=c.create({keySize:t+n}).compute(e,i),a=o.create(r.words.slice(t),4*n);return r.sigBytes=4*t,m.create({key:r,iv:a,salt:i})}},b=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:y}),encrypt:function(e,t,n,i){var r=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=r.iv;var o=g.encrypt.call(this,e,t,r.key,i);return o.mixIn(r),o},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var r=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=r.iv,g.decrypt.call(this,e,t,r.key,i)}})}()}(PU.exports),function(e){e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function n(e,t,n,i){var r,o=this._iv;o?(r=o.slice(0),this._iv=void 0):r=this._prevBlock,i.encryptBlock(r,0);for(var a=0;a<n;a++)e[t+a]^=r[a]}return t.Encryptor=t.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize;n.call(this,e,t,r,i),this._prevBlock=e.slice(t,t+r)}}),t.Decryptor=t.extend({processBlock:function(e,t){var i=this._cipher,r=i.blockSize,o=e.slice(t,t+r);n.call(this,e,t,r,i),this._prevBlock=o}}),t}(),e.mode.CFB}(PU.exports),function(e){return e.mode.CTR=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,o=this._counter;r&&(o=this._counter=r.slice(0),this._iv=void 0);var a=o.slice(0);n.encryptBlock(a,0),o[i-1]=o[i-1]+1|0;for(var s=0;s<i;s++)e[t+s]^=a[s]}}),t.Decryptor=n,t),e.mode.CTR;var t,n}(PU.exports),function(e){
/** @preserve
	 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
	 * derived from CryptoJS.mode.CTR
	 * Jan Hruby jhruby.web@gmail.com
	 */
e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}return e}function i(e){return 0===(e[0]=n(e[0]))&&(e[1]=n(e[1])),e}var r=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0),i(a);var s=a.slice(0);n.encryptBlock(s,0);for(var l=0;l<r;l++)e[t+l]^=s[l]}});return t.Decryptor=r,t}(),e.mode.CTRGladman}(PU.exports),function(e){return e.mode.OFB=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=this._iv,o=this._keystream;r&&(o=this._keystream=r.slice(0),this._iv=void 0),n.encryptBlock(o,0);for(var a=0;a<i;a++)e[t+a]^=o[a]}}),t.Decryptor=n,t),e.mode.OFB;var t,n}(PU.exports),function(e){return e.mode.ECB=((t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t),e.mode.ECB;var t}(PU.exports),function(e){e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,i=4*t,r=i-n%i,o=n+r-1;e.clamp(),e.words[o>>>2]|=r<<24-o%4*8,e.sigBytes+=r},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923}(PU.exports),function(e){e.pad.Iso10126={pad:function(t,n){var i=4*n,r=i-t.sigBytes%i;t.concat(e.lib.WordArray.random(r-1)).concat(e.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126}(PU.exports),function(e){e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971}(PU.exports),function(e){e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},e.pad.ZeroPadding}(PU.exports),function(e){e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding}(PU.exports),function(e){return n=(t=e).lib.CipherParams,i=t.enc.Hex,t.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return n.create({ciphertext:t})}},e.format.Hex;var t,n,i}(PU.exports),function(e){(function(){var t=e,n=t.lib.BlockCipher,i=t.algo,r=[],o=[],a=[],s=[],l=[],c=[],u=[],d=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,i=0;for(t=0;t<256;t++){var f=i^i<<1^i<<2^i<<3^i<<4;f=f>>>8^255&f^99,r[n]=f,o[f]=n;var m=e[n],v=e[m],g=e[v],y=257*e[f]^16843008*f;a[n]=y<<24|y>>>8,s[n]=y<<16|y>>>16,l[n]=y<<8|y>>>24,c[n]=y,y=16843009*g^65537*v^257*m^16843008*n,u[f]=y<<24|y>>>8,d[f]=y<<16|y>>>16,p[f]=y<<8|y>>>24,h[f]=y,n?(n=m^e[e[e[g^m]]],i^=e[e[i]]):n=i=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],m=i.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],a=0;a<i;a++)a<n?o[a]=t[a]:(c=o[a-1],a%n?n>6&&a%n==4&&(c=r[c>>>24]<<24|r[c>>>16&255]<<16|r[c>>>8&255]<<8|r[255&c]):(c=r[(c=c<<8|c>>>24)>>>24]<<24|r[c>>>16&255]<<16|r[c>>>8&255]<<8|r[255&c],c^=f[a/n|0]<<24),o[a]=o[a-n]^c);for(var s=this._invKeySchedule=[],l=0;l<i;l++){if(a=i-l,l%4)var c=o[a];else c=o[a-4];s[l]=l<4||a<=4?c:u[r[c>>>24]]^d[r[c>>>16&255]]^p[r[c>>>8&255]]^h[r[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,l,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,d,p,h,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,r,o,a,s){for(var l=this._nRounds,c=e[t]^n[0],u=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],h=4,f=1;f<l;f++){var m=i[c>>>24]^r[u>>>16&255]^o[d>>>8&255]^a[255&p]^n[h++],v=i[u>>>24]^r[d>>>16&255]^o[p>>>8&255]^a[255&c]^n[h++],g=i[d>>>24]^r[p>>>16&255]^o[c>>>8&255]^a[255&u]^n[h++],y=i[p>>>24]^r[c>>>16&255]^o[u>>>8&255]^a[255&d]^n[h++];c=m,u=v,d=g,p=y}m=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[h++],v=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[h++],g=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^n[h++],y=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^n[h++],e[t]=m,e[t+1]=v,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=n._createHelper(m)})(),e.AES}(PU.exports),function(e){(function(){var t=e,n=t.lib,i=n.WordArray,r=n.BlockCipher,o=t.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var i=a[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(var r=this._subKeys=[],o=0;o<16;o++){var c=r[o]=[],u=l[o];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+u)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+u)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=r[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),p.call(this,1,1431655765);for(var i=0;i<16;i++){for(var r=n[i],o=this._lBlock,a=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((a^r[l])&u[l])>>>0];this._lBlock=a,this._rBlock=o^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function h(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}t.DES=r._createHelper(d);var f=o.TripleDES=r.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),n=e.length<4?e.slice(0,2):e.slice(2,4),r=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(i.create(t)),this._des2=d.createEncryptor(i.create(n)),this._des3=d.createEncryptor(i.create(r))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=r._createHelper(f)})(),e.TripleDES}(PU.exports),function(e){(function(){var t=e,n=t.lib.StreamCipher,i=t.algo,r=i.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,i=this._S=[],r=0;r<256;r++)i[r]=r;r=0;for(var o=0;r<256;r++){var a=r%n,s=t[a>>>2]>>>24-a%4*8&255;o=(o+i[r]+s)%256;var l=i[r];i[r]=i[o],i[o]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,i=0,r=0;r<4;r++){n=(n+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[n],e[n]=o,i|=e[(e[t]+e[n])%256]<<24-8*r}return this._i=t,this._j=n,i}t.RC4=n._createHelper(r);var a=i.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});t.RC4Drop=n._createHelper(a)})(),e.RC4}(PU.exports),function(e){(function(){var t=e,n=t.lib.StreamCipher,i=t.algo,r=[],o=[],a=[],s=i.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)r[n]^=i[n+4&7];if(t){var o=t.words,a=o[0],s=o[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(r[0]^=c,r[1]^=d,r[2]^=u,r[3]^=p,r[4]^=c,r[5]^=d,r[6]^=u,r[7]^=p,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),e[t+i]^=r[i]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],r=65535&i,s=i>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=n._createHelper(s)})(),e.Rabbit}(PU.exports),function(e){(function(){var t=e,n=t.lib.StreamCipher,i=t.algo,r=[],o=[],a=[],s=i.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var r=0;r<4;r++)l.call(this);for(r=0;r<8;r++)i[r]^=n[r+4&7];if(t){var o=t.words,a=o[0],s=o[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(i[0]^=c,i[1]^=d,i[2]^=u,i[3]^=p,i[4]^=c,i[5]^=d,i[6]^=u,i[7]^=p,r=0;r<4;r++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),e[t+i]^=r[i]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],r=65535&i,s=i>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=n._createHelper(s)})(),e.RabbitLegacy}(PU.exports);var MU=PU.exports;function AU(e,t){void 0===t&&(t="cyzxwfhqxb");var n=t+e,i=n.length;i>32?n=n.substring(0,32):i<32&&(n+="xxxxxxxxxxxxxxxxxxxxxx".substring(0,32-i));var r=MU.enc.Utf8.parse(n),o=MU.enc.Hex.parse("1934576290ABCBEF1264147890ACAE45");return{encrypt:function(e){var t=MU.enc.Utf8.parse(e),n=MU.AES.encrypt(t,r,{iv:o,mode:MU.mode.CBC,padding:MU.pad.Pkcs7});return MU.enc.Base64.stringify(n.ciphertext)},decrypt:function(e){return MU.AES.decrypt(e,r,{iv:o,mode:MU.mode.CBC,padding:MU.pad.Pkcs7}).toString(MU.enc.Utf8).toString()}}}var DU=function(){function e(){this.schemaMap={},this.toGetGraphicList=[],this.crypto=AU("Accept-Language:zh-CN,zh;q=0,en;",""),"production"!==process.env.NODE_ENV&&(window.schemaMap=this.schemaMap)}return e.prototype.get=function(e){var t=this;if(!e.graphicId)return Promise.reject();var n=this.schemaMap[e.graphicId];return n?Promise.resolve(n):new Promise((function(n){t.toGetGraphicList.push({graphic:e,resolve:n}),t.willToGet(e.upime)}))},e.prototype.willToGet=function(e){var t=this;window.clearTimeout(this.getTimer),this.getTimer=window.setTimeout((function(){return A(t,void 0,void 0,(function(){var t,n,i,r,o,a,s=this;return D(this,(function(l){switch(l.label){case 0:return t=this.toGetGraphicList.map((function(e){return e.graphic.graphicId})),n=R([],this.toGetGraphicList,!0),this.toGetGraphicList=[],[4,e.fileHelper.getFileToken()];case 1:return i=l.sent(),r=i.host,o=i.query,[4,Sd({lang:e.getLang(),ids:Array.from(new Set(t))},{host:r,query:o}).result];case 2:return(a=l.sent()).obj&&Object.entries(a.obj).forEach((function(e){var t=e[0],n=e[1],i=JSON.parse(s.crypto.decrypt(n));s.schemaMap[t]=i})),n.forEach((function(e){var t=e.graphic,n=e.resolve;if(t.graphicId){var i=s.schemaMap[t.graphicId];i&&n(i)}})),[2]}}))}))}),16)},e}(),RU=new DU,BU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderer=bU,t.editorType=kU,t.elementType=Za.GRAPHIC,t.elementTypeMask=Za.SHAPE,t.hasBorder=!0,t.borderStyle=1,t.borderColor=1710618,t.borderThickness=2,t.borderOpacity=1,t.hasBg=!1,t.bgColor=0,t.bgOpacity=1,t.baseValues={},t.computedValues={},t.bgGeoList=[],t.fgGeoList=[],t.textNodes=[],t.textSort=[],t.connects=null,t.getAttachedPoint=function(n,i){var r;if(!i)return e.prototype.getAttachedPoint.call(t,n,i);var o={x:(n.x-t.position.x)/t.scale,y:(n.y-t.position.y)/t.scale},a=null===(r=t.findNestestPointToBg(o))||void 0===r?void 0:r.point;return a?{x:a.x*t.scale+t.position.x,y:a.y*t.scale+t.position.y}:e.prototype.getAttachedPoint.call(t,n,i)},t.getConnectionPointAngle=function(n,i){var r={x:n.x*t.size.width,y:n.y*t.size.height},o=t.findNestestPointToBg(r);if(!o)return e.prototype.getConnectionPointAngle.call(t,n,i);var a=o.point,s=o.geo,l=o.cmdInfoList;if(gn(a,r)>4&&!t.isPointInGraphic(r))return e.prototype.getConnectionPointAngle.call(t,n,i);var c=void 0;switch(s.type){case"rect":c=t.getRectGeoAngle(a,s,i);break;case"roundedRect":c=t.getRoundRectGeoAngle(a,s,i);break;case"ellipse":c=t.getEllipseGeoAngle(a,s,i);break;case"path":c=t.getPathGeoAngle(a,l)}void 0===c&&(c=e.prototype.getConnectionPointAngle.call(t,n,i)),2===i&&(c=t.toPi(c));var u;return u=2===i?(360-90*((t.rotate+45)/90|0)%360)%360:(360-t.rotate)%360,t.formatToPi(on(c+u*Math.PI/180))},t}return P(t,e),Object.defineProperty(t.prototype,"supportRotate",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportAI",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transparent",{get:function(){return!(this.hasBg&&1===this.bgOpacity)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportChangeRS",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){var e,t,n,i=this.scale;return(null!==(n=null===(t=null===(e=this.schema)||void 0===e?void 0:e.constraints)||void 0===t?void 0:t.minWidth)&&void 0!==n?n:0)*Math.max(1/this.globalTransform.currentScale,i)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){var e,t,n,i=this.scale;return(null!==(n=null===(t=null===(e=this.schema)||void 0===e?void 0:e.constraints)||void 0===t?void 0:t.minHeight)&&void 0!==n?n:0)*Math.max(1/this.globalTransform.currentScale,i)},enumerable:!1,configurable:!0}),t.prototype.dealUpdate=function(t){var n=t.graphicId,i=N(t,["graphicId"]);e.prototype.dealUpdate.call(this,i),this.onUpdateGraphicId(n),(i.position||i.size||void 0!==i.rotate)&&this.updateBorderBox(),i.size&&this.updateTextNode()},t.prototype.onUpdateGraphicId=function(e){var t=this;e&&this.graphicId!==e&&(this.graphicId=e,RU.get(this).then((function(e){t.schema=e,t.onUpdatedSchema()})))},t.prototype.onUpdatedSchema=function(){var e,t,n;this.analysisSchema(),this.updateText(),this.updateTextNode(),null===(t=null===(e=this.currentEditor)||void 0===e?void 0:e.updatePropertyEditors)||void 0===t||t.call(e),null===(n=this.onGetSchema)||void 0===n||n.call(this),this.connectionLines.forEach((function(e){e.handleAttachedElementChanged()})),this.upime.updateView()},t.prototype.analysisSchema=function(){var e=this;if(this.schema){this.baseValues=exports.E({},this.schema.defaults.formulaValues),this.constraints=this.schema.constraints,this.computedValues={};var t=this.schema.computed;t&&Object.keys(t).forEach((function(n){var i=t[n].split(";").filter(Boolean),r=[];i.forEach((function(e){var t=pU(dU(e));r.push(t)})),e.computedValues[n]=function(e){return 1===e.length?e[0]:{getter:function(t){var n=exports.E({},t),i=0;return e.forEach((function(t,r){t.effect&&r!==e.length-1&&(n[t.effect.key]=t.getter(n)),r===e.length-1&&(i=t.getter(n))})),i},effect:e[e.length-1].effect}}(r)}));var n=function(e){var t,n,i=e.graphicId;if(!i||!e.schema)return{bg:[],fg:[]};if(hU[i])return hU[i];var r=null===(t=e.schema)||void 0===t?void 0:t.geometry.bg.map(fU),o=null===(n=e.schema)||void 0===n?void 0:n.geometry.fg.map(fU);return hU[i]={bg:r,fg:o},{bg:r,fg:o}}(this),i=n.bg,r=n.fg;if(this.bgGeoList=i,this.fgGeoList=r,this.connects=function(e){var t,n=null===(t=e.schema)||void 0===t?void 0:t.connections;return n?n.map((function(e){return{x:vU(e.x),y:vU(e.y)}})):null}(this),this.schema.constraints){var o=this.minWidth,a=this.minHeight,s=exports.E({},this.size),l=!1,c=this.scale;o&&this.size.width*c<o&&(s.width=o/c,l=!0),a&&this.size.height*c<a&&(s.height=a/c,l=!0),l&&(this.dealUpdate({size:s}),this.upime.publish("elementsUpdated",[{element:this,update:{size:s}}]))}}},t.prototype.updateText=function(){var e,t=this;this.schema&&(this.textSort=[],null===(e=this.schema.defaults.texts)||void 0===e||e.forEach((function(e){t.textSort.includes(e.key)||t.textSort.push(e.key)})),this.schema.geometry.fg.forEach((function(e){"caption"!==e.type&&"text"!==e.type||t.textSort.includes(e.id)||t.textSort.push(e.id)})),this.textSort.forEach((function(e,n){var i;if(null===(i=t.schema)||void 0===i?void 0:i.geometry.fg.find((function(t){return("caption"===t.type||"text"===t.type)&&t.id===e}))){var r=new _U(t.upime,"text".concat(n+1),t);t.childElements||(t.childElements=[]),t.textNodes.push(r),t.childElements.push(r)}})))},t.prototype.updateTextNode=function(){var e=this;this.computedFgGeoList.forEach((function(t){if("caption"===t.type||"text"===t.type){var n=e.textSort.indexOf(t.id),i=e.textNodes[n];i&&(t.type,"text"===t.type&&(i.position.x=t.bounds.x,i.position.y=t.bounds.y,i.size.width=t.bounds.width,i.size.height=t.bounds.height))}})),this.textNodes.forEach((function(e){return e.updateTransform()}))},t.prototype.getGetterValue=function(e){var t=exports.E(exports.E(exports.E(exports.E({},this.baseValues),this.values),this.computedValues),{width:this.size.width,height:this.size.height});return e.getter(t)},Object.defineProperty(t.prototype,"allVariableValue",{get:function(){var e=this;return this.useMemo("allVariableValue",(function(){var t=exports.E(exports.E(exports.E({},e.baseValues),e.values),{width:e.size.width,height:e.size.height});return Object.keys(e.computedValues).forEach((function(n){var i=e.getGetterValue(e.computedValues[n]);t[n]=i})),t}),[this.size.width,this.size.height,this.schema])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"computedBgGeoList",{get:function(){var e=this;return this.useMemo("computedBgGeoList",(function(){var t=e.allVariableValue;return e.bgGeoList.map((function(e){return gU(e,t)}))}),[this.size.width,this.size.height,this.schema])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"computedFgGeoList",{get:function(){var e=this;return this.useMemo("computedFgGeoList",(function(){var t=e.allVariableValue;return e.fgGeoList.map((function(e){return gU(e,t)}))}),[this.size.width,this.size.height,this.schema])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"computedConnects",{get:function(){var e=this;return this.useMemo("connects",(function(){var t,n=e.allVariableValue,i=e.computedBgGeoList;return null===(t=e.connects)||void 0===t?void 0:t.map((function(t,r){var o=t.x,a=t.y,s=o.getter(n),l=a.getter(n),c={x:s,y:l};if(i.length>0){var u=Un(s,0),d=Un(l,0),p=Un(s,e.size.width),h=Un(l,e.size.height);if((u||p)&&!d&&!h){var f=e.findCrossPointsToBg(c,!1),m=e.findNestestPoint(c,f),v=m.point,g=m.distance;if(v&&g>2)return v}if((d||h)&&!u&&!p){f=e.findCrossPointsToBg(c,!0);var y=e.findNestestPoint(c,f);if(v=y.point,g=y.distance,v&&g>2)return v}}return c.x*=e.scale,c.y*=e.scale,c}))}),[this.size.width,this.size.height,this.schema,this.computedBgGeoList,this.scale])},enumerable:!1,configurable:!0}),t.prototype.getAdsorptionPoints=function(){var t=this.computedConnects;if(t){var n=this.getBorderBox(),i=n.left,r=n.top;return t.map((function(e){return{x:e.x+i,y:e.y+r}}))}return e.prototype.getAdsorptionPoints.call(this)},Object.defineProperty(t.prototype,"closedGraphicGeo",{get:function(){if(!this.schema)return[];for(var e=this.computedBgGeoList,t=[],n=0;n<e.length;n++){var i=e[n];switch(i.type){case"ellipse":case"rect":case"roundedRect":t.push(i);break;case"path":var r=i.commands[i.commands.length-1],o=i.commands.some((function(e,t){return 0!==t&&"M"===e.c}));"Z"!==r.c||o||t.push(i)}}return t},enumerable:!1,configurable:!0}),t.prototype.isPointInGraphic=function(e){var t=this.closedGraphicGeo;if(0===t.length)return!1;for(var n=0;n<t.length;n++){var i=t[n];switch(i.type){case"resource":case"rect":if(Ot(e,{left:i.bounds.x,top:i.bounds.y,right:i.bounds.x+i.bounds.width,bottom:i.bounds.y+i.bounds.height}))return!0;break;case"roundedRect":if(Qn(e,i.bounds,i.bounds.radius))return!0;break;case"ellipse":if(Zn(e,i.bounds))return!0;break;case"path":if(this.isPointInClosePath(e,i))return!0}}return!1},t.prototype.calcBorderBox=function(){return{left:this.position.x,top:this.position.y,right:this.position.x+this.size.width*this.scale,bottom:this.position.y+this.size.height*this.scale,rotate:this.rotate}},t.prototype.bindRefSystem=function(t){e.prototype.bindRefSystem.call(this,t)},t.prototype.getAttachedProps=function(t,n){var i={x:"l"===n?0:"r"===n?this.size.width:.5*this.size.width,y:"t"===n?0:"b"===n?this.size.height:.5*this.size.height},r="t"===n||"b"===n,o=this.findCrossPointsToBg(i,r).reduce((function(e,t){return e?"t"===n?t.y<e.y?t:e:"b"===n?t.y>e.y?t:e:"l"===n?t.x<e.x?t:e:"r"===n&&t.x>e.x?t:e:t}),null);return o?{attachedElementId:this.id,attachedPointType:2,percentOffset:{x:o.x/this.size.width,y:o.y/this.size.height}}:e.prototype.getAttachedProps.call(this,t,n)},t.prototype.findNestestPointToBg=function(e){var t=this,n=this.computedBgGeoList.filter((function(e){return!e.hidden}));if(0===n.length)return null;var i=null,r=1/0,o=null,a=[],s=[];return n.forEach((function(n){var l=null;switch(n.type){case"text":case"caption":case"resource":break;case"ellipse":l=function(e,t){var n=t.width/2,i=t.height/2,r={x:t.x+n,y:t.y+i},o=e.x-r.x,a=e.y-r.y;if(0===o)return{x:r.x,y:r.y+(a>0?i:-i)};var s=o>0?1:-1,l=a/o,c=n*i/Math.sqrt(Math.pow(n,2)*Math.pow(l,2)+Math.pow(i,2))*s;return{x:c+r.x,y:l*c+r.y}}(e,n.bounds)||l;break;case"roundedRect":l=function(e,t,n){var i=t.width,r=t.height,o=t.x,a=t.y,s=a+r,l=o+i,c=n,u=i-n,d=n,p=r-n,h=Bn({x:o,y:d},{x:o,y:p},e),f=Bn({x:c,y:a},{x:u,y:a},e),m=Bn({x:l,y:d},{x:l,y:p},e),v=Bn({x:c,y:s},{x:u,y:s},e),g=Hn(e,{x:n,y:n},n,{x:0,y:n},{x:n,y:0}),y=Hn(e,{x:n,y:p},n,{x:n,y:s},{x:0,y:p}),b=Hn(e,{x:u,y:n},n,{x:u,y:0},{x:l,y:n}),E=Hn(e,{x:u,y:p},n,{x:l,y:p},{x:u,y:s}),x=1/0,w=h;return[h,f,m,v,g,y,b,E].forEach((function(t){var n=mn(t,e);n<x&&(x=n,w=t)})),w}(e,n.bounds,n.bounds.radius)||l;break;case"rect":l=function(e,t){var n=t.width,i=t.height,r=t.x,o=t.y,a=o+i,s=r+n,l=Bn({x:r,y:o},{x:r,y:a},e),c=Bn({x:r,y:o},{x:s,y:o},e),u=Bn({x:s,y:o},{x:s,y:a},e),d=Bn({x:r,y:a},{x:s,y:a},e),p=mn(c,e),h=mn(l,e),f=mn(u,e),m=mn(d,e),v=Math.min(p,h,f,m);return p===v?c:h===v?l:f===v?u:m===v?d:c}(e,n.bounds)||l;break;case"path":var c=t.findNestestPointToPath(e,n);c&&(l=c.point,s=c.cmdInfoList)}if(l){var u=fn(l,e);u<r&&(i=l,r=u,o=n,"path"===n.type&&(a=R([],s,!0)))}})),i&&o?{point:i,geo:o,cmdInfoList:a}:null},t.prototype.findNestestPointToPath=function(e,t){var n=null,i=1/0,r=-2,o=[],a={x:0,y:0},s={x:0,y:0},l=null;function c(e){a=s,s=e,l||(l=e)}return t.commands.forEach((function(t,u){var d,p=null;switch(t.c){case"M":c({x:t.x,y:t.y});break;case"L":p=Bn(s,{x:t.x,y:t.y},e),c({x:t.x,y:t.y});break;case"Z":l&&(p=Bn(s,l,e)||p,c(l));break;case"A":var h={x:t.x1,y:t.y1},f={x:t.x2,y:t.y2};p=function(e,t,n,i,r){var o=Vn(e,t,n,i);if(!o)return null;var a=Bn(e,t,o),s=Bn(n,t,o),l=Bn(e,a,r),c=Hn(r,o,i,a,s);return mn(r,l)<mn(r,c)?l:c}(s,h,f,t.radius,e)||p;var m=Kn(s,h,f,t.radius);m&&c(m);break;case"a":break;case"C":var v={x:t.cpX1,y:t.cpY1},g={x:t.cpX2,y:t.cpY2},y={x:t.x,y:t.y};p=(null===(d=pn(e,s,v,g,0,1,20,y))||void 0===d?void 0:d.point)||p,c({x:t.x,y:t.y})}if(p){var b=fn(p,e);Un(b,i,1)&&u===r+1?o.push({cmd:t,cmdStart:a,cmdEnd:s,checkPoint:exports.E({},p)}):b<i&&(o=[{cmd:t,cmdStart:a,cmdEnd:s,checkPoint:exports.E({},p)}],n=p,i=b,r=u)}})),n&&0!==o.length?{point:n,cmdInfoList:o}:null},t.prototype.findCrossPointsToBg=function(e,t){var n=this;if(0===this.computedBgGeoList.length)return[];var i=e.x,r=e.y,o=[];return this.computedBgGeoList.forEach((function(a){if(!a.hidden)switch(a.type){case"text":case"caption":case"resource":break;case"roundedRect":o.push.apply(o,n.findCrossPointsToRoundRect(e,a,t));break;case"rect":t&&a.bounds.x<=i&&a.bounds.x+a.bounds.width>=i&&(o.push({x:e.x,y:a.bounds.y}),o.push({x:e.x,y:a.bounds.y+a.bounds.height})),!t&&a.bounds.y<=r&&a.bounds.y+a.bounds.height>=r&&(o.push({x:a.bounds.x,y:e.y}),o.push({x:a.bounds.x+a.bounds.width,y:e.y}));break;case"ellipse":var s=a.bounds.x+a.bounds.width/2,l=a.bounds.y+a.bounds.height/2,c=a.bounds.width/2,u=a.bounds.height/2;if(t&&a.bounds.x<=i&&a.bounds.x+a.bounds.width>=i){var d=function(e,t){var n=e.h,i=e.k,r=e.a,o=e.b*Math.sqrt(1-Math.pow(t-n,2)/Math.pow(r,2));return[i+o,i-o]}({h:s,k:l,a:c,b:u},i),p=d[0],h=d[1];o.push({x:e.x,y:p}),o.push({x:e.x,y:h})}if(!t&&a.bounds.y<=r&&a.bounds.y+a.bounds.height>=r){var f=function(e,t){var n=e.h,i=e.k,r=e.b,o=e.a*Math.sqrt(1-Math.pow(t-i,2)/Math.pow(r,2));return[n+o,n-o]}({h:s,k:l,a:c,b:u},r),m=f[0],v=f[1];o.push({x:m,y:e.y}),o.push({x:v,y:e.y})}break;case"path":o.push.apply(o,n.findCrossPointsToPath(e,a,t))}})),o},t.prototype.findCrossPointsToPath=function(e,t,n){var i=[],r={x:0,y:0},o=null;function a(e){r=e,o||(o=e)}t.commands.forEach((function(t){switch(t.c){case"M":a({x:t.x,y:t.y});break;case"L":var s=Math.min(r.x,t.x),l=Math.max(r.x,t.x),c=Math.min(r.y,t.y),u=Math.max(r.y,t.y);if(n&&s<=e.x&&l>=e.x)if(Un(s,l)){var d=Math.abs(e.y-t.y)<Math.abs(e.y-r.y)?t.y:r.y;i.push({x:e.x,y:d})}else{var p=c===r.y?r.x:t.x,h=p===r.x?t.x:r.x;d=Rn(c,u,(e.x-p)/(h-p)),i.push({x:e.x,y:d})}if(!n&&c<=e.y&&u>=e.y)if(Un(c,u)){var f=Math.abs(e.x-t.x)<Math.abs(e.x-r.x)?t.x:r.x;i.push({x:f,y:e.y})}else{var m=s===r.x?r.y:t.y,v=m===r.y?t.y:r.y;f=Rn(s,l,(e.y-m)/(v-m)),i.push({x:f,y:e.y})}a({x:t.x,y:t.y});break;case"Z":if(o){var g=Math.min(r.x,o.x),y=Math.max(r.x,o.x),b=Math.min(r.y,o.y),E=Math.max(r.y,o.y);n&&g<=e.x&&y>=e.x&&(Un(g,y)?(d=Math.abs(e.y-o.y)<Math.abs(e.y-r.y)?o.y:r.y,i.push({x:e.x,y:d})):(d=Rn(b,E,(e.x-g)/(y-g)),i.push({x:e.x,y:d}))),!n&&b<=e.y&&E>=e.y&&(Un(b,E)?(f=Math.abs(e.x-o.x)<Math.abs(e.x-r.x)?o.x:r.x,i.push({x:f,y:e.y})):(f=Rn(g,y,(e.y-b)/(E-b)),i.push({x:f,y:e.y}))),a(o)}break;case"A":var x={x:t.x1,y:t.y1},w={x:t.x2,y:t.y2};if(n){var C=Wn(r,x,w,t.radius,e.x);i.push.apply(i,C.map((function(t){return{x:e.x,y:t}})))}else{var S=function(e,t,n,i,r){var o=Vn(e,t,n,i);if(!o)return[];var a=Bn(e,t,o),s=Bn(n,t,o),l=[],c=e.y<a.y?e:a,u=e.y<a.y?a:e;r>=c.y&&r<=u.y&&l.push(Rn(c.x,u.x,(r-c.y)/(u.y-c.y)));var d=function(e,t,n){if(n<e.y-t||n>e.y+t)return[];var i=e.x,r=e.y,o=Math.sqrt(Math.pow(t,2)-Math.pow(n-r,2));return[i+o,i-o]}(o,i,r);return d.forEach((function(e){!l.includes(e)&&Xn(o,a,s,{x:e,y:r})&&l.push(e)})),l}(r,x,w,t.radius,e.y);i.push.apply(i,S.map((function(t){return{x:t,y:e.y}})))}var k=Kn(r,x,w,t.radius);k&&a(k);break;case"a":break;case"C":var _={x:t.cpX1,y:t.cpY1},T={x:t.cpX2,y:t.cpY2},I={x:t.x,y:t.y};n?(C=hn(r,_,T,I,e.x))&&i.push.apply(i,C.map((function(t){return{x:e.x,y:t}}))):(S=function(e,t,n,i,r){var o=sn(_t.round(-e.y+3*t.y-3*n.y+i.y,2),_t.round(3*e.y-6*t.y+3*n.y,2),_t.round(-3*e.y+3*t.y,2),_t.round(e.y-r,2)),a=o.t1,s=o.t2,l=o.t3,c=[];return[a,s,l].forEach((function(r){if(void 0!==r&&r>=0&&r<=1){var o=un(e,t,n,i,r).x;c.push(o)}})),c}(r,_,T,I,e.y),S&&i.push.apply(i,S.map((function(t){return{x:t,y:e.y}})))),a({x:t.x,y:t.y})}}));var s=i.reduce((function(e,t){return e.every((function(e){return e.x!==t.x||e.y!==t.y}))?R(R([],e,!0),[t],!1):e}),[]);return s},t.prototype.findCrossPointsToRoundRect=function(e,t,n){var i=t.bounds.radius||0,r=t.bounds.width,o=t.bounds.height,a=e.x,s=e.y,l=[];if(n&&t.bounds.x<=a&&t.bounds.x+r>=a){var c=i,u=r-i;if(c<=e.x&&e.x<=u)l.push({x:e.x,y:t.bounds.y}),l.push({x:e.x,y:t.bounds.y+t.bounds.height});else if(e.x<c){var d=i-Math.sqrt(i*i-(e.x-i)*(e.x-i)),p=o-i+Math.sqrt(i*i-(e.x-i)*(e.x-i));l.push({x:e.x,y:d}),l.push({x:e.x,y:p})}else d=i-Math.sqrt(i*i-(e.x-(r-i))*(e.x-(r-i))),p=o-i+Math.sqrt(i*i-(e.x-(r-i))*(e.x-(r-i))),l.push({x:e.x,y:d}),l.push({x:e.x,y:p})}if(!n&&t.bounds.y<=s&&t.bounds.y+o>=s){var h=i,f=o-i;if(h<=e.y&&e.y<=f)l.push({x:t.bounds.x,y:e.y}),l.push({x:t.bounds.x+t.bounds.width,y:e.y});else if(e.y<h){var m=i-Math.sqrt(i*i-(e.y-i)*(e.y-i)),v=r-i+Math.sqrt(i*i-(e.y-i)*(e.y-i));l.push({x:m,y:e.y}),l.push({x:v,y:e.y})}else m=i-Math.sqrt(i*i-(e.y-(o-i))*(e.y-(o-i))),v=r-i+Math.sqrt(i*i-(e.y-(o-i))*(e.y-(o-i))),l.push({x:m,y:e.y}),l.push({x:v,y:e.y})}return l},t.prototype.checkPointPosition=function(t,n,i,r){if(0===this.computedBgGeoList.filter((function(e){return!e.hidden})).length)return e.prototype.checkPointPosition.call(this,t,n,i,r);var o=this.getOuterInnerSensitivation(r,n,i),a=o.outerInsideSensitivation,s=o.innerOnsideSensitivation,l=this.getBorderBox(),c=l.left,u=l.top,d=l.right,p=l.bottom;if(!Ot(t,{left:c-a,top:u-a,right:d+a,bottom:p+a}))return{onside:!1,inside:!1,onText:!1};var h={x:(t.x-c)/this.scale,y:(t.y-u)/this.scale},f=this.getAdsorptionPoints().some((function(e){return fn(e,t)<=a}));return f?{inside:!0,onside:!0,onText:!1}:this.getGraphicInSideOnSide(h,a,s)},t.prototype.getGraphicInSideOnSide=function(e,t,n){var i=this.findNestestPointToBg(e);return(i?fn(e,i.point)*this.scale:1/0)<=Math.max(t,n)?{inside:!0,onside:!0,onText:!1}:{inside:this.isPointInGraphic(e),onside:!1,onText:!1}},t.prototype.getRectGeoAngle=function(e,t,n){var i=t.bounds,r=i.x,o=i.y,a=i.width,s=i.height,l=yn(e.x,r),c=yn(e.y,o),u=yn(e.x,r+a),d=yn(e.y,o+s),p=0;return(l||c||u||d)&&(l?p=0:u&&(p=Math.PI),c?p=1.5*Math.PI:d&&(p=.5*Math.PI),3===n&&(l&&c?p=7*Math.PI/4:u&&c?p=5*Math.PI/4:u&&d?p=3*Math.PI/4:l&&d&&(p=Math.PI/4))),rn(p)},t.prototype.getRoundRectGeoAngle=function(e,t,n){var i=t.bounds,r=i.x,o=i.y,a=i.width,s=i.height,l=i.radius,c=a-l,u=s-l,d=0,p=yn(e.x,r)&&e.y>=o+l&&e.y<=o+u,h=yn(e.y,o)&&e.x>=r+l&&e.x<=r+c,f=yn(e.x,r+a)&&e.y>=o+l&&e.y<=o+u,m=yn(e.y,o+s)&&e.x>=r+l&&e.x<=r+c;if(p||h||f||m)p?d=0:f&&(d=Math.PI),h?d=1.5*Math.PI:m&&(d=.5*Math.PI),3===n&&(p&&h?d=7*Math.PI/4:f&&h?d=5*Math.PI/4:f&&m?d=3*Math.PI/4:p&&m&&(d=Math.PI/4));else{var v={x:e.x>=r+a/2?r+c:r+l,y:e.y>=o+s/2?o+u:o+l};d=Math.PI-Yn(v,e)}return rn(d)},t.prototype.getEllipseGeoAngle=function(e,t,n){var i=t.bounds,r=i.x,o=i.y,a=i.width,s=i.height,l=a/2,c=s/2,u=r+l,d=o+c,p=yn(e.x,r+l),h=yn(e.y,o+c),f=yn(e.x,r),m=yn(e.y,o),v=yn(e.x,r+a),g=yn(e.y,o+s),y=0;if(p&&m)y=1.5*Math.PI;else if(v&&h)y=Math.PI;else if(p&&g)y=.5*Math.PI;else if(f&&h)y=0;else{var b=e.x-u,E=e.y-d,x=Math.abs(-b*Math.pow(c,2)/(E*Math.pow(l,2)));y=Math.atan(1/x),b<0&&E<0?y=2*Math.PI-y:b>0&&E>0?y=Math.PI-y:b>0&&E<0&&(y+=Math.PI)}return rn(y)},t.prototype.getPathGeoAngle=function(e,t){var n=this;if(0!==t.length){var i=t.map((function(e){var t,i=e.cmd,r=e.cmdEnd,o=e.cmdStart,a=e.checkPoint,s=0;switch(i.c){case"M":case"a":return 0;case"L":case"Z":var l=r.x-o.x,c=r.y-o.y,u=Math.atan(c/l);s=1.5*Math.PI-u,a.x=(r.x+o.x)/2,a.y=(r.y+o.y)/2;break;case"A":s=null!==(t=function(e,t,n,i,r){var o=Vn(e,t,n,i);if(!o)return null;var a=Bn(e,t,o);if(Un(fn(r,o),i))return Math.PI-Yn(o,r);var s=a.x-e.x,l=a.y-e.y;return 1.5*Math.PI-Math.atan(l/s)}(o,{x:i.x1,y:i.y1},{x:i.x2,y:i.y2},i.radius,a))&&void 0!==t?t:s;break;case"C":var d={x:i.cpX1,y:i.cpY1},p={x:i.cpX2,y:i.cpY2},h={x:i.x,y:i.y},f=function(e,t,n,i,r){for(var o=r.x,a=r.y,s=sn(-e.x+3*t.x-3*n.x+i.x,3*e.x-6*t.x+3*n.x,-3*e.x+3*t.x,e.x-o),l=s.t1,c=s.t2,u=s.t3,d=Array.from(new Set([l,c,u])),p=0;p<d.length;p++){var h=d[p];if(!(void 0===h||h<0||h>1)){var f=un(e,t,n,i,h).y;if(Math.abs(f-a)<.1)return h}}return null}(o,d,p,h,a);if(null!==f){var m=function(e,t,n,i,r){function o(e,t,n,i,r){return-3*Math.pow(1-e,2)*t+3*Math.pow(1-e,2)*n-6*e*(1-e)*n-3*e*e*i+6*e*(1-e)*i+3*e*e*r}return{x:o(e,t.x,n.x,i.x,r.x),y:o(e,t.y,n.y,i.y,r.y)}}(f,o,d,p,h);s=1.5*Math.PI-Math.atan2(m.y,m.x)}}return n.overturnAngle(s,a)}));return 1===i.length?i[0]:this.overturnAngle(_t.mean(i),e)}},t.prototype.isPointInClosePath=function(e,t){var n=new Set,i={x:0,y:0},r=null;function o(e){i=e,r||(r=e)}return t.commands.forEach((function(t){switch(t.c){case"M":o({x:t.x,y:t.y});break;case"L":if(Un(i.x,t.x))Un(e.x,i.x)&&n.add(i.y);else{var a=Math.min(i.x,t.x),s=Math.max(i.x,t.x);if(e.x<=s&&e.x>=a){var l=(e.x-i.x)/(t.x-i.x);(c=Rn(i.y,t.y,l))<=e.y&&n.add(c)}}o({x:t.x,y:t.y});break;case"Z":if(r){var c,u=Math.min(i.x,r.x),d=Math.max(i.x,r.x);if(e.x<=d&&e.x>=u)l=(e.x-i.x)/(r.x-i.x),(c=Rn(i.y,r.y,l))<=e.y&&n.add(c);o({x:r.x,y:r.y})}break;case"a":break;case"A":var p={x:t.x1,y:t.y1},h={x:t.x2,y:t.y2};Wn(i,p,h,t.radius,e.x).filter((function(t){return t<=e.y})).forEach((function(e){return n.add(e)}));var f=Kn(i,p,h,t.radius);f&&o(f);break;case"C":var m={x:t.cpX1,y:t.cpY1},v={x:t.cpX2,y:t.cpY2},g={x:t.x,y:t.y};hn(i,m,v,g,e.x).filter((function(t){return t<=e.y})).forEach((function(e){return n.add(e)})),o({x:t.x,y:t.y})}})),n.size%2==1},t.prototype.overturnAngle=function(e,t){var n=e,i=e-1.5*Math.PI;i<0&&(i+=2*Math.PI);var r=Math.max(2,this.size.width/100),o=Math.cos(i)*r,a=Math.sin(i)*r,s={x:_t.round(t.x-a,4),y:_t.round(t.y-o,4)};return this.isPointInGraphic(s)&&(n-=Math.PI),on(n)},t.prototype.formatToPi=function(e){return Un(e,0)?0:Un(e,.5*Math.PI)?.5*Math.PI:Un(e,Math.PI)?Math.PI:Un(e,1.5*Math.PI)?1.5*Math.PI:Un(e,2*Math.PI)?2*Math.PI:e},t.prototype.toPi=function(e){var t=[-2,-1.5,-1,-.5,0,.5,1,1.5,2],n=t.map((function(t){return Math.abs(e-t*Math.PI)})),i=_t.min(n);return void 0===i?0:t[n.indexOf(i)]*Math.PI},t.prototype.getGlobalPointByPercentOffset=function(t,n){if(2===(null==n?void 0:n.attachedType)){var i=this.getPointByPercentOffset(t,!0),r={x:(i.x-this.position.x)/this.scale,y:(i.y-this.position.y)/this.scale},o=this.getAdsorptionPoints().some((function(e){return fn(e,i)<=1}));if(o)return e.prototype.getGlobalPointByPercentOffset.call(this,t,n);if(this.schema){var a=this.findNestestPointToBg(r),s=a?fn(r,a.point):1/0;if(a&&s>2){var l=a.point,c={x:l.x/this.size.width,y:l.y/this.size.height};return e.prototype.getGlobalPointByPercentOffset.call(this,c,n)}}}return e.prototype.getGlobalPointByPercentOffset.call(this,t,n)},t.prototype.findNestestPoint=function(e,t){var n=null,i=1/0;return t.forEach((function(t){var r=fn(t,e);r<i&&(n=t,i=r)})),{point:n,distance:i}},t.prototype.searchText=function(t){t=t.toLowerCase();for(var n=0,i=this.textNodes;n<i.length;n++){var r=i[n].rawText;if(r.toLocaleLowerCase().includes(t))return r}return e.prototype.searchText.call(this,t)},t}(oy),LU=function(e){function t(t){var n=e.call(this)||this;return n.id=t,n}return P(t,e),t}(Ks),OU=function(){function e(e){this.upime=e,this.allElements=[],this.allElementMap=new Map,this.elements=[],this.frames=[],this.comments=[],this._gridTextMap=new Map,this._tableMap=new Map,this.mindMapNodes=[],this.groupMap=new Map,this.frozedGroupMap=new Map,this.frameCoverData=[],this.genCoverStack=[],this.shadowEles=[],this.refSystemDict={},this.customRefSystemHosts=[],this.globalRefSystem=this.upime.view.elementsRoot}return Object.defineProperty(e.prototype,"sequentialFrames",{get:function(){return this.upime.framesListManager.sequentialFrames},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tableMap",{get:function(){return this._tableMap},enumerable:!1,configurable:!0}),e.prototype.addCustomRefSystemHost=function(e){this.customRefSystemHosts.includes(e)||this.customRefSystemHosts.push(e)},e.prototype.getVisibleElements=function(e){var t=this,n=this.upime.view.getViewbox();return this.elements.filter((function(i){return i.isSupportSelected&&!i.unavailable&&t.checkVisible(i,n)&&(!e||e(i))}))},e.prototype.getAllElements=function(e){return void 0===e&&(e=!0),e?R(R([],this.elements,!0),this.frames,!0):R([],this.elements,!0)},e.prototype.checkVisible=function(e,t){var n=e.getGlobalBox();return Kt(n,n.rotate?kn(t,-n.rotate,Lt(n)):t)},e.prototype.getGroupMembers=function(e){var t;return null===(t=this.groupMap.get(e))||void 0===t?void 0:t.members},e.prototype.getFrozedGroupMembers=function(e){var t;return null===(t=this.frozedGroupMap.get(e))||void 0===t?void 0:t.members},e.prototype.resetData=function(){this.allElements.filter((function(e){return e.elementType===Za.TIMER})).forEach((function(e){window.clearInterval(e.anim)})),this.allElements=[],this.allElementMap=new Map,this.elements.forEach((function(e){return e.destroy()})),this.elements=[],this.comments=[],this.frames=[],this.mindMapNodes=[],this.groupMap=new Map,this.globalRefSystem.clear(),this.refSystemDict={},this.customRefSystemHosts=[],this.shadowEles=[]},e.prototype.clearShadowEles=function(){var e=this;this.shadowEles.forEach((function(t){e.removeElement(t,!0),t.destroy()})),this.shadowEles=[]},e.prototype.getAvailableFrames=function(e){return this.frames.filter((function(t){return!t.unavailable&&(!e||e(t))}))},e.prototype.getAvailableElements=function(e){return this.elements.filter((function(t){return t.isSupportSelected&&!t.unavailable&&(!e||e(t))}))},e.prototype.getFrames=function(e){return void 0!==e?this.frames.filter((function(t){return Kt(t.getBorderBox(),e)})):this.frames},e.prototype.getRightMostElement=function(e){var t=this.getAllElements().filter((function(e){return!e.deleted}));if(t.length){var n,i=-Number.MAX_SAFE_INTEGER;return e&&(t=t.filter((function(t){return t.elementType===e}))),t.forEach((function(e){var t=e.position.x,r=e.size.width;t+r>=i&&(i=t+r,n=e)})),n}},e.prototype.getElements=function(e){var t=this;return void 0!==e?this.elements.filter((function(n){return t.checkVisible(n,e)})):this.elements},e.prototype.getVisibleSelectableElements=function(){return this.getAvailableElements((function(e){return e.isSupportSelected}))},e.prototype.getConnectableElements=function(){return this.elements.filter((function(e){return e instanceof oy}))},e.prototype.getElementById=function(e){return this.allElementMap.get(e)},e.prototype.getElementByOriginId=function(e){return this.allElements.find((function(t){return!t.deleted&&t.originId===e}))},e.prototype.getComments=function(e){return this.comments.filter((function(t){return!t.unavailable&&(!e||e(t))}))},e.prototype.addElement=function(e){if(!e.deleted){var t=this.upime.view,n=e.id.endsWith("_sd");if(n&&(e.stable=!0),e.elementType===Za.FRAME){if(this.frames.includes(e))return;this.frames.push(e),!n&&this.upime.framesListManager.insertFrame(e.id),t.frames=this.getFrames()}else if(e.elementType===Za.COMMENT){if(this.comments.find((function(t){return t.id===e.id})))return;this.comments.push(e),this.comments.sort(Hs)}else{if(this.elements.includes(e))return;e.elementType===Za.TABLE?this._tableMap.set(e.id,e):e.elementType===Za.GRID_TEXT?this._gridTextMap.set(e.id,e):e.elementType===Za.MINDMAP_NODE?this.mindMapNodes.push(e):e.elementType===Za.AUDIO&&t.audios.push(e),this.elements.push(e)}e.onAdd(),n&&(this.shadowEles[e.id]=e)}},e.prototype.insertCommentDraft=function(e){var t=this.upime.view;t.curCommentDraft=e,t.update()},e.prototype.openCommentById=function(e,t){void 0===t&&(t=!0);var n=this.comments.find((function(t){return t.id===e}));return n&&this.openComment(n,t),n},e.prototype.openComment=function(e,t){void 0===t&&(t=!0),this.upime.phoneMode&&e.expanded&&!t&&this.upime.closePhoneDrawer(),e.expanded=!!t,t&&this.upime.commentManager.reportLastOpen(e.id),this.upime.view.update()},e.prototype.collapseComments=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var n=this.getAllComments((function(n){return!(e.length&&!e.includes(n.id)||n.pined||!n.expanded||t.includes(n.id)||(n.expanded=!1,0))}));return this.upime.view.curCommentDraft=null,this.upime.updateView(),n},e.prototype.removeElement=function(e,t){if(void 0===t&&(t=!1),e){t&&(this.allElements=this.allElements.filter((function(t){return t!==e})),this.allElementMap.delete(e.id));var n=e.id.endsWith("_sd"),i=this.upime.view;e.elementType===Za.FRAME?(this.frames=this.frames.filter((function(t){return t!==e})),!n&&this.upime.framesListManager.removeFrame(e.id),i.frames=this.getFrames()):e.elementType===Za.COMMENT?this.comments=this.comments.filter((function(t){return t!==e})):(this.elements=this.elements.filter((function(t){return t!==e})),e.elementType===Za.MINDMAP_NODE?this.mindMapNodes=this.mindMapNodes.filter((function(t){return t!==e})):e.elementType===Za.TABLE?this._tableMap.delete(e.id):e.elementType===Za.GRID_TEXT?this._gridTextMap.delete(e.id):e.elementType===Za.AUDIO&&(i.audios=i.audios.filter((function(t){return t!==e})))),e.onDelete(),this.upime.publish("elementDeleted",e)}},e.prototype.getElementGenerator=function(e){var t;switch(e){case Za.LINE:t=bE;break;case Za.FRAME:t=VM;break;case Za.CONNECTIONLINE:t=IN;break;case Za.SHAPE:t=eR;break;case Za.TEXT:t=EA;break;case Za.IMAGE:t=zA;break;case Za.DOCUMENT:t=SM;break;case Za.STICKER:t=fR;break;case Za.MINDMAP_NODE:t=wD;break;case Za.MINDMAP_LINE:t=lD;break;case Za.COMMENT:t=kP;break;case Za.VIDEO:t=nB;break;case Za.TABLE:t=HR;break;case Za.GRID_TEXT:t=kA;break;case Za.AUDIO:t=aB;break;case Za.WEBPAGE:t=fB;break;case Za.TIMER:t=IB;break;case Za.CARD:t=sH;break;case Za.KANBAN:t=Zz;break;case Za.BIG_DOC:t=oU;break;case Za.GRAPHIC:t=BU;break;default:t=PB[e]}return t},e.prototype.genElement=function(e,t){var n=this.getElementGenerator(e);if(n){var i=new n(this.upime,t);return this.allElements.push(i),this.allElementMap.set(t,i),i}},e.prototype.updateElement=function(e,t,n){var i,r,o=this;void 0===n&&(n={isServerUpdate:!1,isServerCreate:!1,clipUpdate:void 0});var a=this.upime.view,s=a.getViewbox(),l=function(){if(o.upime.userManager.expRenderClip&&null!==a.renderBox&&e.mounted&&e.checkUpdateView(s,t))if(!e.lineConnected&&[Za.LINE,Za.IMAGE,Za.TEXT,Za.SHAPE,Za.STICKER,Za.GRAPHIC].includes(e.elementType)){var n=e.getGlobalBox(),i=Sn(n,n.rotate);Kt(i,s)&&o.upime.updateView(i)}else o.upime.updateView()};n.clipUpdate&&l(),a.updated&&e.mounted&&e.checkUpdateView(s,t)&&this.upime.updateView(),e.renderInView;var c=e.id.endsWith("_sd"),u=e.frameId;function d(t,n,i){if(n!==i){var r=null!==i&&t.get(i);if(r){var o=r.members.filter((function(t){return t!==e}));o.length?r.members=o:t.delete(i)}if(n){var a=t.get(n);return a?a.members.push(e):(a=new _A(n,[e]),t.set(n,a)),a}}}var p=t.zIndex,h=t.prevFrameId,f=t.frameId,m=t.deleted,v=t.groupId,g=t.frozedGroupId,y=N(t,["zIndex","prevFrameId","frameId","deleted","groupId","frozedGroupId"]);if(void 0!==m&&e.deleted!==m&&(e.deleted=m,m?e.onRemove():e.onRestore()),void 0!==p&&(e.zIndex=p,this.upime.updateMaxMinZindex(p)),Object.keys(y).length&&e.dealUpdate(exports.E(exports.E(exports.E({},y),!1===m&&{deleted:m}),{updateOptions:n})),m?!n.isServerCreate&&this.removeElement(e):!1===m?this.addElement(e):void 0!==p&&(null===(i=e.parentRefSystem)||void 0===i||i.updateChildIndex(e)),void 0!==f){var b=null==f?void 0:this.upime.elementManager.getElementById(f);b!==e.frame&&(null===(r=e.frame)||void 0===r||r.remove(e),e.frame=b,null==b||b.add(e)),e.frameId=f}if(void 0!==v&&(e.group=d(this.groupMap,v,e.groupId),e.groupId=v),void 0!==g&&(e.frozedGroup=d(this.frozedGroupMap,g,e.frozedGroupId),e.frozedGroupId=g,e.onFrozed()),void 0===h||c)e.elementType===Za.FRAME?this.frameCoverChanged(e.id):(u&&this.frameCoverChanged(u),e.frameId&&e.frameId!==u&&this.frameCoverChanged(e.frameId));else{var E=n.isServerUpdate,x=n.localUpdateSeq;E&&this.upime.framesListManager.dealServerSequenceChanged(e.id,h),x&&this.upime.framesListManager.changeSequenceInternal(e.id,h,x)}e.elementType===Za.COMMENT&&(this.upime.publish("commentMessagesUpdate",e.id),this.upime.commentManager.updateUnreadCount()),n.clipUpdate&&l(),a.updated&&e.mounted&&e.checkUpdateView(s,t)&&this.upime.updateView(),e.elementType===Za.FRAME&&void 0!==m&&this.upime.publish("sdkAction",{type:"frameEvent",payload:{frameId:e.id,deleted:m}})},e.prototype.frameCoverChanged=function(e){var t=this.frameCoverData.find((function(t){return t.id===e}));t&&(t.needUpdate=!0)},e.prototype.refreshFrameCover=function(){var e=this;void 0===this.refreshTimer&&(this.refreshTimer=fr((function(){e.frameCoverData.forEach((function(t){t.needUpdate&&t.consumers.length&&e.genFrameCover(t.id)})),e.refreshTimer=void 0})))},e.prototype._genFrameCover=function(e){var t=this,n=this.genCoverStack.find((function(t){return t.id===e}));if(n)return n.result;n=new LU(e),this.genCoverStack.push(n);var i=function(){fr((function(){return A(t,void 0,void 0,(function(){var e,t,n;return D(this,(function(r){switch(r.label){case 0:return this.genCoverStack.length?(e=this.genCoverStack[0],(t=this.frames.find((function(t){return t.id===e.id})))?[4,Jf(this.upime,t,{width:240,height:136})]:[3,2]):[2];case 1:return n=r.sent(),[3,3];case 2:n="",r.label=3;case 3:return e.done(n),this.genCoverStack.shift(),this.genCoverStack.length&&i(),[2]}}))}))}))};return 1===this.genCoverStack.length&&i(),n.result},e.prototype.genFrameCover=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this._genFrameCover(e)];case 1:return t=i.sent(),n=this.frameCoverData.find((function(t){return t.id===e})),n.needUpdate=!1,n.data=t,n.consumers.forEach((function(e){return e(t)})),[2]}}))}))},e.prototype.registerFrameCover=function(e,t,n){var i=this;void 0===n&&(n=0);var r=this.frameCoverData.find((function(t){return t.id===e}));r&&void 0!==r.data?t(r.data):t("");var o=function(){r=i.frameCoverData.find((function(t){return t.id===e})),r?r.consumers.push(t):(r={id:e,consumers:[t],needUpdate:!1},i.frameCoverData.push(r)),r.data&&!r.needUpdate||i.genFrameCover(e)},a=function(){var n=i.frameCoverData.find((function(t){return t.id===e}));n&&(n.consumers=n.consumers.filter((function(e){return e!==t})))};if(n){var s=null;return s=window.setTimeout((function(){s=null,o()}),n),function(){null!==s&&clearTimeout(s),a()}}return o(),a},e.prototype.addElementAttachedComment=function(e,t){e.attachedComments.find((function(e){return e.id===t.id}))||e.attachedComments.push(t)},e.prototype.removeElementAttachedComment=function(e,t){e.attachedComments=e.attachedComments.filter((function(e){return e.id!==t.id}))},e.prototype.getAllComments=function(e){return this.comments.filter((function(t){return!t.deleted&&(!e||e(t))}))},e.prototype.getCommentDestination=function(e){var t=this.upime.view,n=t.renderingTree,i=t.renderingFrames,r=function(t){for(var n,i,o=t.refSystem,a=t.children,s=o.globalTransform.applyInverse(e),l=a.length-1;l>=0;l--){var c=a[l];if(c.refSystem){var u=r(c);if(u)return u}else{var d=c;if(d.elementType===Za.CONNECTIONLINE||d.elementType===Za.MINDMAP_LINE||d.elementType===Za.GRID_TEXT)continue;if(d.elementType===Za.STICKER&&(null===(i=(n=d).hideForPrivate)||void 0===i?void 0:i.call(n)))continue;var p=d.getBorderBox(),h=p.left,f=p.top,m=p.right,v=p.bottom,g=p.rotate,y=void 0===g?0:g,b=s;if(y&&(b=an(b,y,{x:(h+m)/2,y:(f+v)/2})),Ot(b,p)){if(d.elementType===Za.KANBAN){var E=d.findCard(s);if(E){d=E;var x=E.getBorderBox();h=x.left,f=x.top,m=x.right,v=x.bottom,y=x.rotate||0}}var w={x:Math.max(b.x-h,0)/(m-h),y:Math.max(b.y-f,0)/(v-f)};return d.isSupportComment?{attachElement:d,position:b,relativePos:w}:{position:b}}}}if(o.supportComment&&o.checkPointIn(e))return b=exports.E(exports.E({},s),o.getRelateInfo()),{refSystem:o,position:b}},o=r(n);if(o)return o;for(var a=i.length-1;a>=0;a--){var s=i[a];if(!s.unavailable){var l=s.getGlobalBox();if(Ot(e,l)){var c=l.left,u=l.top,d=l.right,p=l.bottom;return{position:e,attachElement:s,relativePos:{x:Math.max(e.x-c,0)/(d-c),y:Math.max(e.y-u,0)/(p-u)}}}}}return{position:e}},e.prototype.getRefSystem=function(e){var t=this.globalRefSystem;switch(e.parentType){case Za.DOCUMENT:var n=e.parentId,i=e.pageId;t=this.getDocumentPageRS(n,i);break;case Za.VIDEO:case Za.AUDIO:n=e.parentId;var r=e.mediaTime;t=this.getMediaMarkRS(e.parentType,n,r);break;case Za.TABLE:n=e.parentId;var o=e.rowId,a=e.columnId;t=this.getTableRS(n,o,a);break;default:if(void 0!==e.parentType)for(var s=0,l=this.customRefSystemHosts;s<l.length;s++){var c=l[s].getRefSystem(e);if(c)return c}}return t},e.prototype.getDocumentPageRS=function(e,t){var n=iB.genId(e,t),i=this.refSystemDict[n];return i||(i=new iB(e,t),this.refSystemDict[n]=i),i},e.prototype.getMediaMarkRS=function(e,t,n){var i=sB.genId(t,n),r=this.refSystemDict[i];return r||(r=new sB(e,t,n),this.refSystemDict[i]=r),r},e.prototype.getTableRS=function(e,t,n){var i=lB.genId(e,t,n),r=this.refSystemDict[i];return r||(r=new lB(e,t,n),this.refSystemDict[i]=r),r},e.prototype.destroy=function(){this.genCoverStack.forEach((function(e){return e.done("")})),this.genCoverStack.length=0,this.refreshTimer&&mr(this.refreshTimer)},e}(),FU=function(e){function t(t){var n=e.call(this,t)||this;return n.multiSelected=!1,n.invalidEvt=!1,n.ctrlWidgets=[],n._hoverTarget=void 0,n._selectedGroup=void 0,n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"select"===e?n.startSelectMode():"hand"===e?n.startHandMode():"pick-single-element"===e?n.startPickSingleElementMode():"laser"===e?n.startLaserMode():"view"===e?n.startViewMode():n.clearWork(),n.upime.view.removeContextMenu()})),n._altArrowKeyMap={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1},n.deleteElements=function(){if(n.elementEditor){var e=n.elementEditor.getElements(),t=e.filter((function(e){return e.elementType===Za.MINDMAP_NODE}));if(n.elementEditor.delete(),!(n.elementEditor instanceof FR&&e[0].focusingCell)&&n.clearEditor(),t[0]){var i=t[0].parent;i&&!i.deleted&&!i.unavailable&&n.directSelect([i])}}},n.deleteSelectedTableRowCols=function(){var e=n.elementEditor;e&&e instanceof FR&&(e.couldDeleteRow?e.removeFullRows():e.couldDeleteCol&&e.removeFullCols())},n.handleTabKey=function(e){n.elementEditor&&n.elementEditor.dealTabKey(e)},n.handleEnterKey=function(e){n.elementEditor&&n.elementEditor.dealEnterKey(e)},n.setDirectMoveTarget=function(e){n.moveTargetCandidate=e},n.clearDirectMoveTarget=function(){n.moveTargetCandidate=void 0},n.upime=t,"select"===t.xmode?n.startSelectMode():"hand"===t.xmode&&n.startHandMode(),n}return P(t,e),Object.defineProperty(t.prototype,"currentSelectGroup",{get:function(){return this._selectedGroup},set:function(e){this._selectedGroup=e,this.upime.view.groupSelectEles=null==e?void 0:e.members},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hoverTarget",{get:function(){return this._hoverTarget},enumerable:!1,configurable:!0}),t.prototype.triggerHover=function(){var e;null===(e=this.hoverCB)||void 0===e||e.call(this)},t.prototype.setHoverTarget=function(e,t){this._hoverTarget&&(this._hoverTarget!==e||re(this.hoverData,t))&&this._hoverTarget.dealHoverEnd(),this._hoverTarget=e,this.hoverData=t},t.prototype.checkHoverTarget=function(e,t){this._hoverTarget&&(this._hoverTarget!==e||re(this.hoverData,t))&&(this._hoverTarget.dealHoverEnd(),this._hoverTarget=void 0,this.hoverData=void 0)},Object.defineProperty(t.prototype,"currentEditor",{get:function(){return this.elementEditor||this.tempEditor},enumerable:!1,configurable:!0}),t.prototype.getTopmostComment=function(e,t){void 0===t&&(t=!1);var n=this.upime.view,i=n.renderingComments,r=n.viewClip,o=n.x,a=n.y,s=n.scale;if(r){var l=r.rect;if(l.x=(l.x-o)*s,l.y=(l.y-a)*s,l.width*=s,l.height*=s,!Ot(e,Bt(l),2))return}for(var c=i.length-1;c>=0;c--){var u=i[c];if("draft"!==u.type||t){var d=u.getScreenPosition();if(Ot(e,u.expanded&&!this.upime.phoneMode?{left:d.x-7,top:d.y-7,right:d.x+7,bottom:d.y+7}:{left:d.x-26,top:d.y-40,right:d.x+26,bottom:d.y+10}))return u}}},t.prototype.arrowKeyDownHandler=function(e,t){var n=t.originEvent,i=n.shiftKey,r=n.altKey,o=n.metaKey;this.currentEditor instanceof wA||this.currentEditor&&(r?this.dupElesByDirection(e):this.currentEditor.frozed||(this.currentEditor instanceof Lb&&this.currentEditor.dealArrowKeyInternally?this.currentEditor.dealInternalArrowKeyDown(e,t):o||this.currentEditor.handleDirectMoveCtrl(e,i)))},t.prototype.cloneSelectedEles=function(){var e;if(this.currentEditor&&this.currentEditor.clone)this.currentEditor.clone();else if(this.currentEditor&&!this.upime.checkFocusTableCell()){var t=null!==(e=this.upime.copySelected("topLeft",!1,!1))&&void 0!==e?e:{},n=t.info,i=t.border,r=t.eleList;if(n&&i&&r){for(var o=this.upime.elementManager.getAllElements(!1),a=!0,s=!0,l=!0,c=!0,u=i.left,d=i.right,p=i.top,h=i.bottom,f=i.rotate,m=i.right-i.left,v=i.right-i.left,g={left:d+20,right:d+20+m,bottom:h,top:p,rotate:f},y={left:u-20-m,right:u-20,top:p,bottom:h},b={left:u,right:d,top:p-20-v,bottom:p-20},E={left:u,right:d,top:h+20,bottom:h+20+v},x=0,w=o;x<w.length;x++){var C=w[x];if(!r.includes(C)){var S=C.getBorderBox();if(Kt(S,g)&&(a=!1),Kt(S,E)&&(s=!1),Kt(S,y)&&(l=!1),Kt(S,b)&&(c=!1),!(a||s||l||c))break}}this.dupElesByDirection((a?"ArrowRight":s&&"ArrowDown")||l&&"ArrowLeft"||c&&"ArrowUp"||"TL_offset",!0,{border:i,info:n})}}},t.prototype.groupElement=function(e){var t=this.currentEditor;if(t&&t instanceof kh&&!t.isHandMode&&!t.frameHided){var n=t;e?n.canGroup&&n.makeGroup():n.canSplitGroup&&n.splitGroup()}},t.prototype.lockElement=function(){var e=this.currentEditor;e&&!e.frameHided&&e.editable&&!e.isHandMode&&(e.frozed?e.couldUnfroze&&e.unfrozeElement():e.supportFullCommonOp&&e.supportFrozeLock&&e.frozeElement())},t.prototype.toggleHideFrame=function(){var e=this.currentEditor,t=this.upime.editable;if(e&&t&&e.hasFrame){var n=e.upime.userManager,i=n.enableHideFrame,r=n.userAccessHint,o=e.allFrameHided,a=!i&&r.HideFrameHint&&!o;o&&!e.couldUnHideFrame||a||(e.getElements().length>1?e.handleHidedFrame(!o):e.hideFrame(!o),_c("cv_hideframe_shortcuts"))}},t.prototype.dupElesByDirection=function(e,t,n){if(void 0===t&&(t=!1),!(this.currentEditor instanceof wA)&&!this.upime.checkFocusTableCell()&&(!this._altArrowKeyMap[e]||t)&&this.currentEditor){t||(this._altArrowKeyMap[e]=!0);var i=null!=n?n:this.upime.copySelected("topLeft",!1,!1);if(this.clearSelect(),i){var r=i.border,o=r.left,a=r.right,s=r.top,l=r.bottom,c=a-o,u=l-s,d=null,p=this.upime.view.scale;switch(e){case"ArrowDown":d={x:o,y:l+20};break;case"ArrowLeft":d={x:o-c-20,y:s};break;case"ArrowRight":d={x:a+20,y:s};break;case"ArrowUp":d={x:o,y:s-20-u};break;case"TL_offset":d={x:o+20/p,y:s+20/p}}var h=this.upime.view.getViewbox(),f={left:d.x,top:d.y,right:d.x+c,bottom:d.y+u};if(!qt(f,h)){var m=50/p,v=void 0,g=this.upime.view.viewWidth/this.upime.view.viewHeight;switch(e){case"ArrowDown":var y=f.bottom-h.bottom+m;v={left:h.left-y/g,right:h.right+y/g,top:h.top-y,bottom:h.bottom+y};break;case"ArrowUp":y=h.top-f.top+m,v={left:h.left-y/g,right:h.right+y/g,top:h.top-y,bottom:h.bottom+y};break;case"ArrowLeft":y=h.left-f.left+m,v={left:h.left-y,right:h.right+y,top:h.top-y*g,bottom:h.bottom+y*g};break;case"ArrowRight":y=f.right-h.right+m,v={left:h.left-y,right:h.right+y,top:h.top-y*g,bottom:h.bottom+y*g};break;case"TL_offset":f.bottom>h.bottom?(y=f.bottom-h.bottom+m,v={left:h.left-y/g,right:h.right+y/g,top:h.top-y,bottom:h.bottom+y}):(y=f.right-h.right+m,v={left:h.left-y,right:h.right+y,top:h.top-y*g,bottom:h.bottom+y*g})}this.upime.makeBorderInSight(v)}this.upime.useElementsInfo(i.info,d)}}},t.prototype.arrowKeyUpHandler=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.currentEditor instanceof wA||this.currentEditor&&!this.currentEditor.frozed&&this.upime.editable&&(this.currentEditor instanceof Lb&&this.currentEditor.dealArrowKeyInternally?this.currentEditor.dealInternalArrowKeyUp(e,t,n):t?this._altArrowKeyMap[e]=!1:this.currentEditor.handleDirectMoveKeyUp(e))},t.prototype.addCtrlWidget=function(e){this.ctrlWidgets.includes(e)||(this.ctrlWidgets.push(e),this.upime.view.addCtrlWidget(e))},t.prototype.removeCtrlWidget=function(e){this.ctrlWidgets.includes(e)&&(this.ctrlWidgets=this.ctrlWidgets.filter((function(t){return t!==e})),this.upime.view.removeCtrlWidget(e))},t.prototype.getSelectedElements=function(){var e,t;return null!==(t=null===(e=this.currentEditor)||void 0===e?void 0:e.getElements())&&void 0!==t?t:[]},t.prototype.directSelect=function(e){return this.clearEditor(),this.clearTempEditor(),e=e.filter((function(e){return e.elementType!==Za.MINDMAP_LINE})),this.createEditor(e)},t.prototype.switchEditor=function(e){this.clearEditor(),e.select(),this.elementEditor=e,this.elementEditor.visiable=!0,this.upime.view.selectedEditor=this.elementEditor},t.prototype.hideEditor=function(){this.elementEditor&&(this.elementEditor.visiable=!1,this.elementEditor.getElements().forEach((function(e){return e.showSelected=!1})))},t.prototype.createTempEditor=function(e,t){1===e.length?(this.tempEditor=new e[0].editorType(this.upime,e[0]),!_e.desktop&&(e[0].showSelected=!0)):(this.tempEditor=new kh(this.upime,e),e.forEach((function(e){e.selectStatus="multi",!_e.desktop&&(e.showSelected=!0)}))),this.tempEditor.opData=t||{moveData:{originBorder:this.tempEditor.borderRect}},this.upime.view.update(),this.tempEditor.select(!0)},t.prototype.clearTempEditor=function(){this.tempEditor&&(this.currentSelectGroup=void 0,this.tempEditor.getElements().forEach((function(e){e.selectStatus="",e.showSelected=!1})),this.tempEditor.unselect(!0),this.tempEditor=void 0,this.upime.view.update())},t.prototype.createEditor=function(e){var t;if(1===e.length){var n=e[0];this.elementEditor=new n.editorType(this.upime,n),null===(t=n.showFileControlDom)||void 0===t||t.call(n),n.selectStatus="single",n.showSelected=n.elementType!==Za.CONNECTIONLINE,n.elementType===Za.FRAME&&this.upime.onFrameSelected(n)}else this.elementEditor=new kh(this.upime,e),e.forEach((function(e){e.selectStatus="multi",e.showSelected=!0}));this.elementEditor.visiable=!0;var i=this.upime.view;return i.selectedEditor=this.elementEditor,this.upime.publish("elementSelected",e),this.elementEditor.select(!1),i.update(),this.elementEditor},t.prototype.clearEditor=function(){if(this.elementEditor){this.currentSelectGroup=void 0,this.elementEditor.getElements().forEach((function(e){e.selectStatus="",e.showSelected=!1})),this.elementEditor.unselect(!1);var e=this.upime.view;e.selectedEditor=void 0,this.elementEditor=void 0,e.update()}},t.prototype.openContextMenu=function(e){var t=this;_c("cv_contextmenu");var n=new Kh(this.upime,e,(function(){return t.upime.view.removeContextMenu()}),this.elementEditor);this.upime.view.addContextMenu(n)},t.prototype.clearSelect=function(){this.clearEditor(),this.clearTempEditor()},t.prototype.clearWork=function(){this.stopWork&&(this.stopWork(),this.stopWork=void 0)},t.prototype.startHandMode=function(){var e=this;this.clearWork();var t=this.upime,n=null,i=null,r=[this.upime.userEventManager.subscribe("click",(function(n){var i,r,o,a,s,l,c,u,d,p=e.getTopmostComment(n.globalPosition);if(p)return p.expanded||(e.upime.collapseComments(),e.upime.expandComment(p)),e.setHoverTarget(),void e.clearSelect();t.userManager.commentOnlyMode&&t.saveComment()||e.upime.collapseComments();var h,f=n.position,m=void 0,v=e.selectElement(f,{type:"click",evt:n});if(m=v.element,h=v.relation,m&&(null===(r=null===(i=null==h?void 0:h.metaData)||void 0===i?void 0:i.clickData)||void 0===r?void 0:r.mobileHover))return e.setHoverTarget(m,null===(o=null==h?void 0:h.metaData)||void 0===o?void 0:o.clickData),void m.dealHoverStart(h);if(e.checkHoverTarget(m||void 0,null===(a=null==h?void 0:h.metaData)||void 0===a?void 0:a.clickData),m){if(null===(s=null==h?void 0:h.metaData)||void 0===s?void 0:s.clickData)return void m.dealClickStart(h);if(e.elementEditor&&m&&e.elementEditor.contains(m))return void(2===n.Hits?t.phoneMode?t.showElement(m,{left:40,right:40,top:80,bottom:80,duration:800}):t.showElement(m,{left:90,right:20,top:60,bottom:60,duration:800}):null===(l=m.showFileControlDom)||void 0===l||l.call(m))}if(e.clearEditor(),m){if(null===(c=null==h?void 0:h.metaData)||void 0===c?void 0:c.clickData)return void m.dealClickStart(h);if(m.stable)null===(u=m.showFileControlDom)||void 0===u||u.call(m);else{var g=m.group||m.frozedGroup;g?(null===(d=m.showFileControlDom)||void 0===d||d.call(m),e.createEditor(g.members)):e.createEditor([m])}}"right"===n.connectType&&e.openContextMenu(n.globalPosition)})),this.upime.userEventManager.subscribe("moveto",(function(n){if(e.setHoverTarget(),t.userManager.commentOnlyMode){if(n.isStart&&("touch"===n.connectType&&n.longPress||"left"===n.connectType)){var r=e.getTopmostComment(n.globalPosition);(null==r?void 0:r.couldBeEdit)&&(i=r)}if(i&&n.connected&&"right"!==n.connectType)null==i||i.handleMoveSelf(n);else{var o=n.globalPosition,a=n.preGlobalPosition,s=e.upime.view,l=s.x-(o.x-a.x)/s.scale,c=s.y-(o.y-a.y)/s.scale;e.upime.setViewPosScale(l,c)}n.isEnd&&i&&(i=null)}})),this.upime.userEventManager.subscribe("mousemove",(function(i){var r,o;if(!i.connected){var a=t.getTopmostCommentByPos(i.globalPosition);if(a)return null===(r=e.hoverTarget)||void 0===r||r.dealHoverEnd(),void(a.couldBeEdit&&n!==a&&(n=a,t.view.setCursor("default",t)));n&&(n=null,t.view.setCursor(Wd(),t));var s=e.selectElement(i.position,{type:"hover",evt:i});if(null!==s.element&&null!==s.relation){var l=s.relation.realTarget||s.element;return e.setHoverTarget(l,null===(o=s.relation.metaData)||void 0===o?void 0:o.clickData),void l.dealHoverStart(s.relation)}e.setHoverTarget()}}))];this.stopWork=function(){r.forEach((function(e){return e()})),e.clearEditor()}},t.prototype.startViewMode=function(){var e=this;this.clearWork();var t=this.upime,n=null,i=this.upime.registerKeyup([" "],(function(){e.upime.toggleSelectAndViewMode("select")})),r=this.upime.registerHotKey({key:" "},(function(e){e.originEvent.repeat||(i(),r())})),o=[this.upime.userEventManager.subscribe("click",(function(n){var i,r,o=e.getTopmostComment(n.globalPosition);if(o)return o.expanded||(e.upime.collapseComments(),e.upime.expandComment(o)),e.setHoverTarget(),void e.clearSelect();t.userManager.commentOnlyMode&&t.saveComment()||e.upime.collapseComments();var a,s=n.position,l=void 0,c=e.selectElement(s,{type:"click",evt:n});if(l=c.element,a=c.relation,l){var u=null===(i=null==a?void 0:a.metaData)||void 0===i?void 0:i.clickData;if(a&&(null==u?void 0:u.mobileHover))return e.setHoverTarget(l,u),void l.dealHoverStart(a);if(a&&u)return void l.dealClickStart(a);null===(r=l.showFileControlDom)||void 0===r||r.call(l),2!==n.Hits||l.locked||l.frozedGroupId||e.dealCBClickStartEdit(l,n,"view")}else e.setHoverTarget();"right"===n.connectType&&e.openContextMenu(n.globalPosition)})),this.upime.userEventManager.subscribe("mousemove",(function(i){var r,o;if(!i.connected){var a=t.getTopmostCommentByPos(i.globalPosition);if(a)return null===(r=e.hoverTarget)||void 0===r||r.dealHoverEnd(),void(a.couldBeEdit&&n!==a&&(n=a,t.view.setCursor("default",t)));n&&(n=null,t.view.setCursor(Wd(),t));var s=e.selectElement(i.position,{type:"hover",evt:i});if(null!==s.element&&null!==s.relation){var l=s.relation.realTarget||s.element;return e.setHoverTarget(l,null===(o=s.relation.metaData)||void 0===o?void 0:o.clickData),void l.dealHoverStart(s.relation)}e.setHoverTarget()}})),r,i];this.stopWork=function(){o.forEach((function(e){return e()}))}},t.prototype.startLaserMode=function(){var e=this;this.clearWork();var t=this.upime,n=null,i=[this.upime.userEventManager.subscribe("click",(function(n){var i,r,o=e.getTopmostComment(n.globalPosition);if(o)return o.expanded||(e.upime.collapseComments(),e.upime.expandComment(o)),e.setHoverTarget(),void e.clearSelect();t.userManager.commentOnlyMode&&t.saveComment()||e.upime.collapseComments();var a,s=n.position,l=void 0,c=e.selectElement(s,{type:"click",evt:n});if(l=c.element,a=c.relation,l){if(null===(i=null==a?void 0:a.metaData)||void 0===i?void 0:i.clickData)return void l.dealClickStart(a);null===(r=l.showFileControlDom)||void 0===r||r.call(l),2!==n.Hits||l.locked||l.frozedGroupId||e.dealCBClickStartEdit(l,n,"laser")}else e.setHoverTarget()})),this.upime.userEventManager.subscribe("mousemove",(function(i){var r,o;if(!i.connected){var a=t.getTopmostCommentByPos(i.globalPosition);if(a)return null===(r=e.hoverTarget)||void 0===r||r.dealHoverEnd(),void(a.couldBeEdit&&n!==a&&(n=a,t.view.setCursor("default",t)));n&&(n=null,t.view.setCursor(jd(),t));var s=e.selectElement(i.position,{type:"hover",evt:i});if(null!==s.element&&null!==s.relation){var l=s.relation.realTarget||s.element;return e.setHoverTarget(l,null===(o=s.relation.metaData)||void 0===o?void 0:o.clickData),void l.dealHoverStart(s.relation)}e.setHoverTarget()}}))];this.stopWork=function(){i.forEach((function(e){return e()}))}},t.prototype.startPickSingleElementMode=function(){var e=this;this.clearWork();var t=new uh;this.upime.view.addAssistWidget(t);var n=null,i=null,r=function(i){var r=e.selectElement(i.position,{type:"hover",forceNormalCheck:!0,evt:i}).element;(null==r?void 0:r.stable)&&(r=null),r&&e.singlePickFilter&&!e.singlePickFilter(r)&&(r=null),r!==n&&(r!==n&&(t.lastHoveredEle=r,e.upime.updateView()),n=r)},o=[this.upime.userEventManager.subscribe("click",(function(o){if(_e.isTouchSupported&&r(o),n){if(n===i)return;return i=n,t.lastPickedEle=i,t.lastHoveredEle=null,e.upime.publish("singleElementPicked",i),void e.upime.updateView()}i=null,t.lastPickedEle=null,e.upime.publish("singleElementPicked",i),e.upime.updateView()})),this.upime.userEventManager.subscribe("mousemove",r)];this.stopWork=function(){e.upime.view.removeAssistWidget(t),o.forEach((function(e){return e()}))}},t.prototype.startSelectMode=function(){var e=this;this.clearWork();var t=this.upime,n=void 0,i=[],r=null,o=null,a=null,s=!1,l=function(t){if(!n){var i=t.startPosition,r=i.x,o=i.y;n=new Xp(r,o,0,0),t.longPress&&(n.dashedBorder=!0),"touch"===t.connectType&&(n.crosshair=!0),n.bgOpacity=.3,n.borderThickness=1,e.upime.view.addAssistWidget(n),e.upime.view.setCursor(Ud(),e)}},c=function(a){var s=a.longPress,l=a.position,c=a.startPosition;u.checkMoveBorderCondition(a);var d=function(e,t){var n,i,r=e.x,o=e.y,a=t.x,s=t.y;return r=(n=jt(r,a))[0],a=n[1],{x:r,y:o=(i=jt(o,s))[0],width:a-r,height:(s=i[1])-o}}(c,l);n.position=l,n.data=d;var p=Bt(d),h=e.upime.view.viewClip;if(h&&(p=Ln(p,Bt(h.rect))),i.forEach((function(e){e.showSelected=!1})),null!==p){var f=p,m=e.selectElementsInBorder(f,{selectInBorder:s&&"touch"!==a.connectType});if(i=m,m.length)r&&r.clearFocusedCells(),o&&o.setSelectedCards([]),r=null,o=null;else{var v=t.elementManager.getAvailableElements((function(e){return(e.elementType===Za.TABLE||e.elementType===Za.KANBAN)&&!e.frozedGroup&&!e.hideByFrame&&!e.stable&&Kt(e.getGlobalBox(),f)}));if(r&&!v.includes(r)&&(r.clearFocusedCells(),r=null),o&&!v.includes(o)&&(o.setSelectedCards([]),o=null),1===v.length){var g=v[0];g.elementType===Za.TABLE?r=g:o=g,g.dealRectSelectCells(f)}else r&&r.dealRectSelectCells(f),o&&o.dealRectSelectCells(f)}t.view.update()}else t.view.update()},u=new dh(this.upime,c),d=function(){e.upime.view.setCursor("",e),e.upime.view.removeAssistWidget(n),n=void 0,i.length>0&&e.createEditor(i),r&&e.createEditor([r]),o&&o.selectedCards.length>0&&e.createEditor([o]),i=[],r=null,o=null,u._bounceAnimation&&mr(u._bounceAnimation),u._bounceAnimation=null},p=function(n){var i,r,o,l,c,u,d,p,h,f,m,v,g;e.clearTempEditor(),e.invalidEvt=!1;var y=e.currentSelectGroup,b=null==y?void 0:y.members,E=b&&function(e){return b.includes(e)},x=E,w=function(){if(!e.upime.phoneMode&&e.upime.saveComment())return!0;var i=e.getTopmostComment(n.globalPosition,t.phoneMode);if(i){if(("left"===n.connectType||"touch"===n.connectType&&n.longPress||"touch"===n.connectType&&i.expanded||"touch"===n.connectType&&"draft"===i.type)&&(e._movingComment=i),!t.phoneMode){var r=e.upime.getAllComments((function(e){return e.id!==i.id})).map((function(e){return e.id}));r.length&&e.upime.collapseComments(r)}if(e._movingComment)return e.clearSelect(),!0}else e.upime.phoneMode||e.upime.collapseComments();return!1},C=function(t){var n=t.group;n?e.createTempEditor(n.members):e.createTempEditor([t])},S=void 0,k=void 0;if(e.elementEditor){var _=e.elementEditor.checkSelectRelation(n.startPosition,{type:"move"});if(e.invalidEvt=!!(null===(i=null==_?void 0:_.metaData)||void 0===i?void 0:i.notAllowed),_){if(!(null==_?void 0:_.metaData)&&w())return;if(_.transparent){var T;if(S=(T=e.selectElement(n.startPosition,{type:"move",elementFilter:E,frameFilter:x})).element,k=T.relation,e.invalidEvt=!!(null===(r=null==k?void 0:k.metaData)||void 0===r?void 0:r.notAllowed),e.invalidEvt)return;if(S&&!S.stable&&!e.elementEditor.contains(S)){var I=S.getGlobalBox();if(I&&qt(I,e.elementEditor.getBorderBox())){if("touch"===n.connectType&&!n.longPress)return void(s=!0);if(e.clearEditor(),S.frozedGroupId)return;return void C(S)}}}var P=null===(o=_.metaData)||void 0===o?void 0:o.connectionData,N=!!P&&!P.isMindMapLocation;return e.elementEditor.frozed&&!N?void e.clearEditor():(e.elementEditor.opData=_.metaData,_.metaData&&(_.metaData.resizeData||_.metaData.rotateData)||(e.elementEditor.opData=exports.E(exports.E({},_.metaData),{moveData:{originBorder:e.elementEditor.borderRect}})),void(e.elementEditor.visiable=!!(null===(l=_.metaData)||void 0===l?void 0:l.notAllowed)||!!(null===(c=_.metaData)||void 0===c?void 0:c.selectingText)))}if(w())return;if(e.elementEditor instanceof kh&&(S=(T=e.selectElement(n.startPosition,{type:"move",elementFilter:E,frameFilter:x})).element,k=T.relation,S&&e.elementEditor.contains(S)))return void(e.elementEditor.frozed?e.clearEditor():e.elementEditor.opData={moveData:{originBorder:e.elementEditor.borderRect}});"touch"===n.connectType&&n.longPress&&e.clearSelect()}else if(w())return;if(void 0===S&&(S=(T=e.selectElement(n.startPosition,{type:"move",elementFilter:E,frameFilter:x})).element,k=T.relation),e.invalidEvt=!!(null===(u=null==k?void 0:k.metaData)||void 0===u?void 0:u.notAllowed),!e.invalidEvt)if(null!==S&&S.stable&&(S=null),S&&(null===(d=null==k?void 0:k.metaData)||void 0===d?void 0:d.directCtrlData))S.currentEditor||e.createTempEditor([S],null==k?void 0:k.metaData);else{if((null==S?void 0:S.elementType)===Za.TABLE&&((null===(h=null===(p=null==k?void 0:k.metaData)||void 0===p?void 0:p.tableCtrlData)||void 0===h?void 0:h.resizeData)||(null===(m=null===(f=null==k?void 0:k.metaData)||void 0===f?void 0:f.tableCtrlData)||void 0===m?void 0:m.sortData)))return a={element:S,meta:null===(v=null==k?void 0:k.metaData)||void 0===v?void 0:v.tableCtrlData},void(S.currentEditor||C(S));if("touch"!==n.connectType||n.longPress){if(e.clearEditor(),S&&!S.frozedGroup){if(S.elementType===Za.CONNECTIONLINE&&(null===(g=null==k?void 0:k.metaData)||void 0===g?void 0:g.lineEndpointType))return e.createEditor([S]),e.elementEditor.visiable=!1,void(e.elementEditor.opData=k.metaData);C(S)}}else e.elementEditor&&(s=!0)}},h=null,f=null,m=null,v=function(t,i){var r,o,u,v,y,b="left"===t.connectType&&t.originEvent.altKey;if(t.isStart)if(e.moveTargetCandidate){e.setHoverTarget(),e.clearSelect();var E=e.createEditor([e.moveTargetCandidate]);E.visiable=!1,E.opData={moveData:{originBorder:E.borderRect}}}else if(t.longPress)e.setHoverTarget(),i||(e.clearSelect(),l(t));else{if(p(t),e.setHoverTarget(),b&&e.currentEditor&&!e.invalidEvt&&!a){if(!e.currentEditor.getElements().find((function(e){return e.elementType===Za.FRAME&&e.hide}))){var x=(h=e.currentEditor.getElements())[0];return 1===h.length&&Hu(x)&&x.selectedCards.length&&x.setSelectedCards([]),m=e.upime.createLock(h.map((function(e){return e.id}))),void(f=h.map((function(t){var n=t.getGlobalBox(),i=n.left,r=n.top,o=n.right,a=n.bottom,s=new Xp(i,r,o-i,a-r,t.rotate,t.id);return s.bgOpacity=.2,s.borderThickness=.5,e.upime.view.addAssistWidget(s),s})))}e.clearSelect(),e.upime.addToast(O("frame.hide.copy.hint"))}e.currentEditor||i||e.invalidEvt||e._movingComment||l(t)}else if(t.isEnd){if(n)d();else if(a)a.element.dealInternalMove(t,a.meta),a=null;else if(h){if(null==f||f.forEach((function(t){return e.upime.view.removeAssistWidget(t)})),f=null,m&&e.upime.clearLock(m),m=null,h.length){var w=Yt(h.map((function(e){return e.getGlobalBox()}))),C=w.top,S=w.left,k=t.startPosition,_=(P=t.position).x-k.x,T=P.y-k.y,I=(null!==(r=e.upime.copySelected("topLeft",!1,!1))&&void 0!==r?r:{}).info;e.clearTempEditor(),I&&(1===h.length&&h[0].elementType===Za.MINDMAP_NODE&&(null===(o=I[0])||void 0===o?void 0:o.elementType)===Za.MINDMAP_NODE&&e.upime.clearSelect(),e.upime.useElementsInfo(I,{x:S+_,y:C+T}))}h=null}else s?s=!1:e.currentEditor?(e.elementEditor&&(e.elementEditor.visiable=!0),e.invalidEvt||e.currentEditor.dealSelectCtrlEvt(t),e.moveTargetCandidate&&(e.moveTargetCandidate.richTextClient?null===(u=e.moveTargetCandidate.currentEditor)||void 0===u||u.startEdit():Iu(e.moveTargetCandidate)&&(null===(y=(v=e.moveTargetCandidate).onDragInsertEnd)||void 0===y||y.call(v)),e.moveTargetCandidate=void 0),e.clearTempEditor()):e._movingComment&&(e._movingComment.handleMoveSelf(t),e._movingComment=void 0);return void(g=null)}if(n)c(t);else if(a)e.clearTempEditor(),e.currentEditor instanceof FR||e.clearEditor(),a.element.dealInternalMove(t,a.meta);else if(h){var P,N=t.prePosition,M=(P=t.position).x-N.x,A=P.y-N.y;null==f||f.forEach((function(e){e.dealMove(M,A)})),e.upime.view.update()}else s?e.upime.dealMove(t):e.currentEditor?e.invalidEvt||e.currentEditor.dealSelectCtrlEvt(t):e._movingComment?e._movingComment.handleMoveSelf(t):i&&e.upime.dealMove(t)},g=null,y=[this.upime.userEventManager.subscribe("longpress",(function(t){if("left"===t.connectType)e.clearEditor(),e.upime.view.setCursor(Ud(),e);else if("touch"===t.connectType){var n=exports.E(exports.E({},t),{startPosition:t.position,prePosition:t.position,startGlobalPosition:t.globalPosition,preGlobalPosition:t.globalPosition,isStart:!1,isEnd:!0});p(n),e.currentEditor||e._movingComment||(e.clearSelect(),l(n))}})),this.upime.userEventManager.subscribe("moveto",(function(t){var n="touch"===t.connectType;"left"===t.connectType||n?("touch"===t.connectType&&t.originEvent.touches.length>1||!g&&!t.isStart?(g&&v(exports.E(exports.E({},g),{isEnd:!0}),n),e.upime.dealMove(t),g=null):(g=t,v(t,n)),e.setHoverTarget()):e.setHoverTarget()})),this.upime.userEventManager.subscribe("click",(function(i){var r,o,a,s,l,c,u,p,h,f,m,v,g,y,b=i.position;e.upime.view.removeContextMenu(),"left"===i.connectType&&i.longPress?e.upime.view.setCursor("",e):"touch"===i.connectType&&i.longPress&&n&&d();var E=null===(r=e.selectCtrlWidget(i.position,{type:"click",evt:i}))||void 0===r?void 0:r.widget;if(E)E.dealClick(i);else{var x=function(){if(e.upime.saveComment())return!t.phoneMode;var n=e.getTopmostComment(i.globalPosition);return n?(n.expanded||(e.upime.collapseComments(),e.upime.expandComment(n)),e.clearSelect(),!0):(e.upime.collapseComments(),!1)},w=void 0,C=void 0,S=e.currentSelectGroup,k=null==S?void 0:S.members,_=k?function(e){return k.includes(e)}:void 0,T=_;if(e.elementEditor){if(i.originEvent.ctrlKey||i.originEvent.metaKey||i.originEvent.shiftKey){if(e.elementEditor.frozed)return void x();var I=e.getSelectedElements().filter((function(e){return e.elementType!==Za.GRID_TEXT})),P=e.elementEditor.checkSelectRelation(b,{type:"click",evt:i});if(!(null==P?void 0:P.metaData)&&x())return;if(P&&!P.transparent)return;w=(B=e.selectElement(b,{type:"click",evt:i,elementFilter:_,frameFilter:T})).element,C=B.relation;var N=w&&I.includes(w);if(!N&&(null==w?void 0:w.frozedGroupId))return;if(!N&&(null===(a=null===(o=null==C?void 0:C.metaData)||void 0===o?void 0:o.clickData)||void 0===a?void 0:a.candidateTableCells))return;if(!w)return void e.clearEditor();if(null===(s=null==C?void 0:C.metaData)||void 0===s?void 0:s.clickData)return C.metaData.clickData.ctrlKey=!0,i.originEvent.shiftKey&&(C.metaData.clickData.shiftKey=!0),void w.dealClickStart(C);if(e.clearEditor(),w.stable)return;var M,A=!S&&w.group?w.group.members:[w];return N?M=I.filter((function(e){return!A.includes(e)})):(M=R([],I,!0),A.forEach((function(e){return!M.includes(e)&&M.push(e)}))),void(M.length&&(e.createEditor(M),S&&(e.elementEditor.group=S,e.currentSelectGroup=S)))}var D=e.elementEditor.checkSelectRelation(b,{type:"click",evt:i});if(D){if((!D.metaData||e.elementEditor.frozed)&&x())return;if(!D.transparent&&!e.elementEditor.frozed)return e.elementEditor.opData=D.metaData,void e.elementEditor.dealClick(i,D.metaData);if(w=(B=e.selectElement(b,{type:"click",evt:i,elementFilter:_,frameFilter:T})).element,C=B.relation,w&&(null===(c=null===(l=null==C?void 0:C.metaData)||void 0===l?void 0:l.clickData)||void 0===c?void 0:c.mobileHover))return e.setHoverTarget(w,C.metaData.clickData),void w.dealHoverStart(C);if(w&&(null===(u=null==C?void 0:C.metaData)||void 0===u?void 0:u.clickData))return void w.dealClickStart(C);if(w&&e.elementEditor.contains(w)){if("right"===i.connectType)return void e.openContextMenu(i.globalPosition);if(e.elementEditor.frozed)return void(2===i.Hits&&e.upime.showElement(w,{left:90,right:20,top:60,bottom:60,duration:800}));if(1===i.Hits&&(null===(p=w.showFileControlDom)||void 0===p||p.call(w)),w.stable)return void e.clearEditor();if(e.elementEditor instanceof kh&&2===i.Hits){if(w.group)return e.clearEditor(),e.createEditor([w]),e.currentSelectGroup=w.group,void(e.elementEditor.group=w.group);if(void 0!==w.rawText)return e.clearEditor(),e.createEditor([w]),void e.elementEditor.dealClick(i);if(w.elementType===Za.FRAME&&w.checkClickName(i.position))return e.clearEditor(),e.createEditor([w]),void e.elementEditor.dealClick(i)}return e.elementEditor.opData=D.metaData,void e.elementEditor.dealClick(i)}}else{if(x())return;var B;if(e.elementEditor instanceof kh&&(w=(B=e.selectElement(b,{type:"click",evt:i,elementFilter:_,frameFilter:T})).element,C=B.relation,w&&!C&&e.elementEditor.contains(w)))return}}else if(x())return void e.setHoverTarget();if(void 0===w&&(w=(B=e.selectElement(b,{type:"click",evt:i,elementFilter:_,frameFilter:T})).element,C=B.relation),!e.elementEditor||w&&e.elementEditor.contains(w)||e.clearEditor(),w&&(null===(f=null===(h=null==C?void 0:C.metaData)||void 0===h?void 0:h.clickData)||void 0===f?void 0:f.mobileHover))return e.setHoverTarget(w,C.metaData.clickData),void w.dealHoverStart(C);if(e.checkHoverTarget(w||void 0,null===(m=null==C?void 0:C.metaData)||void 0===m?void 0:m.clickData),w){if(null===(v=null==C?void 0:C.metaData)||void 0===v?void 0:v.clickData)return w.dealClickStart(C),void(C.metaData.clickData.candidateTableCells&&"right"===i.connectType&&e.openContextMenu(i.globalPosition));if(e.clearEditor(),S)e.elementEditor=e.createEditor([w]),e.currentSelectGroup=S,e.elementEditor.group=S;else{var L=w.group||w.frozedGroup;L?(null===(g=w.showFileControlDom)||void 0===g||g.call(w),e.createEditor(L.members)):w.stable?null===(y=w.showFileControlDom)||void 0===y||y.call(w):e.createEditor([w])}}"right"===i.connectType&&e.openContextMenu(i.globalPosition)}})),this.upime.userEventManager.subscribe("mousemove",(function(t){var n,i,r,o,a;if(!t.connected)if(t.outTarget)e.setHoverTarget();else{if(e.ctrlWidgets.length||e.elementEditor){var s=e.selectCtrlWidget(t.position,{type:"hover",evt:t});if(s){var l=s.widget,c=s.relation;return e.setHoverTarget(l,null===(n=c.metaData)||void 0===n?void 0:n.clickData),void l.dealHoverStart(c)}}if(e.elementEditor){var u=e.elementEditor.checkSelectRelation(t.position,{type:"hover",evt:t});if(u){var d=null===(i=u.metaData)||void 0===i?void 0:i.connectionData,p=!!d&&!d.isMindMapLocation;if(!(u.transparent||e.elementEditor.frozed&&!p)){var h=u.realTarget||e.elementEditor;return e.setHoverTarget(h,null===(r=u.metaData)||void 0===r?void 0:r.clickData),void h.dealHoverStart(u)}}}if(e.getTopmostComment(t.globalPosition))null===(o=e.hoverTarget)||void 0===o||o.dealHoverEnd();else{var f=e.selectElement(t.position,{type:"hover",evt:t});if(null!==f.element&&null!==f.relation)return h=f.relation.realTarget||f.element,e.setHoverTarget(h,null===(a=f.relation.metaData)||void 0===a?void 0:a.clickData),void h.dealHoverStart(f.relation);e.setHoverTarget()}}})),this.upime.registerHotKey({key:" "},(function(t){t.originEvent.repeat||n||e.upime.toggleSelectAndViewMode("view")}))],b=["Delete","Backspace"].map((function(t){return e.upime.registerHotKey({key:t},(function(){return e.deleteElements()}))})),E=this.upime.registerHotKey({key:"Tab"},this.handleTabKey),x=this.upime.registerHotKey({key:"Enter"},this.handleEnterKey),w=R(R(R([],y,!0),b,!0),[E,x],!1);this.stopWork=function(){w.forEach((function(e){return e()})),e.clearDirectMoveTarget(),e.clearEditor(),n&&(e.upime.view.setCursor("",e),e.upime.view.removeAssistWidget(n),n=void 0)}},t.prototype.selectElementsInBorder=function(e,t){void 0===t&&(t={});var n=t.selectCross,i=t.selectInBorder,r=[],o=!0===n?Kt:qt,a=!0===i?qt:Kt;this.upime.elementManager.getFrames().forEach((function(t){t.unavailable||t.stable||t.frozedGroup||!o(t.getGlobalBox(),e)||(t.showSelected=!0,r.push(t))}));var s=function(e){return!(e.unavailable||e.frozedGroup||e.hideByFrame||e.showSelected||e.elementType===Za.MINDMAP_NODE&&e.isMindmapNodeHideByCollapsed||e.elementType===Za.CARD&&e.kanbanId)},l=function(t){for(var n,i,c=t.children,u=0;u<c.length;u++){var d=c[u];if(d.isRefSystem)!d.unavailable&&l(d);else{var p=d;if(p.unavailable||p.stable||p.frozedGroup||p.hideByFrame||p.elementType===Za.MINDMAP_LINE||p.elementType===Za.GRID_TEXT||p.showSelected)continue;if(null===(i=(n=p).hideForPrivate)||void 0===i?void 0:i.call(n))continue;var h=p.getGlobalBox(),f=Sn(h,h.rotate);(p.elementType===Za.TABLE||p.elementType===Za.KANBAN?o(h,e):a(f,e))&&(p.group?p.group.members.forEach((function(e){s(e)&&(e.showSelected=!0,r.push(e))})):s(p)&&(p.showSelected=!0,r.push(p)))}}};return l(this.upime.view.elementsRoot),r},t.prototype.selectElement=function(e,t){var n=t.elementFilter,i=t.frameFilter,r=t.canSelectUnavailable,o=void 0!==r&&r,a=N(t,["elementFilter","frameFilter","canSelectUnavailable"]),s=this.upime.view,l=s.renderingTree,c=s.renderingFrames,u=s.viewClip;if(null!=u&&!1===Ot(e,Bt(u.rect)))return{relation:null,element:null};for(var d=c.filter((function(e){return(!1===e.unavailable||o)&&(void 0===i||i(e))})),p=[],h=d.length-1;h>=0;h--){if(null!==(g=d[h]).checkClickName(e))return{relation:null,element:g};if(!0===g.hide&&!0===Ot(e,g.getBorderBox()))return{relation:{transparent:!1,metric:-1},element:g}}var f=!1,m=function(t){for(var i=t.refSystem,r=t.children,s=i.globalTransform.applyInverse(e),l=r.length-1;l>=0&&!0!==f;l--){var c=r[l];if(c.refSystem){if(c.refSystem.unavailable&&!1===o)continue;var u=m(c);if(void 0!==u)return u}else{var d=r[l];if(d.isSupportSelected&&(!1===d.unavailable||o)&&!1===d.hideByFrame&&(void 0===n||n(d))){var h=d.checkSelectRelation(s,a);if(null===h)continue;if(-1===h.metric)return{relation:h,element:d};if(p.push({relation:h,element:d}),!1===h.transparent){f=!0;break}}}}},v=m(l);if(void 0!==v)return v;for(h=d.length-1;h>=0;h--)if(!0===(g=d[h]).checkClickBorder(e))return{relation:{transparent:!1,metric:-1},element:g};if(!1===f||"hover"===a.type)for(h=d.length-1;h>=0;h--){var g,y=(g=d[h]).checkSelectRelation(e,a);null!==y&&p.push({relation:y,element:g})}var b=void 0,E={relation:null,element:null};for(h=0;h<p.length;h++){var x=p[h];(void 0===b||x.relation.metric<b)&&(b=x.relation.metric,E=x)}return E},t.prototype.selectCtrlWidget=function(e,t){for(var n=this.ctrlWidgets.length-1;n>=0;n--){var i=this.ctrlWidgets[n],r=i.checkSelectRelation(e,t);if(r)return{relation:r,widget:i}}return null},t.prototype.updateBorderBox=function(){var e;null===(e=this.elementEditor)||void 0===e||e.updateBorderBox()},t.prototype.dealCBClickStartEdit=function(e,t,n){var i,r,o,a,s,l=this;if(t.position,e.elementType===Za.TIMER){if(e.checkRelationInText(exports.E({},t.position))){this.upime.switchMode("select"),this.upime.selectElement(e);var c=this.elementEditor;this.upime.nextTick((function(){c&&l.elementEditor===c&&l.elementEditor.dealClick(exports.E(exports.E({},t),{Hits:1}))}))}}else if(e.elementType===Za.CONNECTIONLINE){this.upime.switchMode("select"),this.upime.selectElement(e);var u=e.checkSelectRelation(t.position,{type:"click",evt:t});(null===(r=null===(i=null==u?void 0:u.metaData)||void 0===i?void 0:i.clickData)||void 0===r?void 0:r.lineText)?null===(o=this.elementEditor)||void 0===o||o.dealClick(t,null==u?void 0:u.metaData):(null===(a=null==u?void 0:u.metaData)||void 0===a?void 0:a.lineControl)?(this.upime.clearSelect(),this.upime.switchMode(n)):e.supportDBClickAddText?null===(s=this.elementEditor)||void 0===s||s.dealClick(t,null==u?void 0:u.metaData):(this.upime.clearSelect(),this.upime.switchMode(n))}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.stopWork;void 0!==e&&e(),this.clearEditor(),this.clearTempEditor()},t}(zd),zU=function(e){function t(t){var n=e.call(this,t)||this;return n._textConfig={scale:1,hasBg:!1,bgColor:0,bgOpacity:1,ha:"left",va:"top",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He},n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"text"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),n.insertText=function(e,t){var i=void 0===t?{}:t,r=i.text,o=i.verticalPos,a=void 0===o?"center":o,s=i.link,l=i.autoStartEdit,c=void 0===l||l,u=i.currentOp,d=i.content,p=i.noSync,h=i.maxWidth,f=i.slient,m=i.autoAdjust,v=n.upime,g=u||n.upime.createOperation(),y=n.getDefaultTextSize(),b=!1,E=n._textConfig.scale,x=!0,w=[];if(d){x=!1;var C=Wi((w=d).reduce((function(e,t){return R(R([],e,!0),t[0],!0)}),[]),n._textConfig,h||600);y={width:C.width,height:C.height}}else if(r){(r=r.replace(/\r\n/g,"\n")).indexOf("\n")>=0&&(x=!1);var S=Wi(yi(r),n._textConfig,h||600);y={width:S.width,height:S.height};var k={color:void 0!==v.lastTextColor?v.lastTextColor:1710618};s?k.link=s:ae(r)&&(k.link=r),w=[[yi(r),k]]}else b=!0;var _="center"===a?.5*y.height:0,T={x:e.x,y:e.y-_},I=exports.E(exports.E({},n._textConfig),{position:T,size:y,autoWidth:x,zIndex:v.newMaxZindex(),richContent:{version:n.upime.genOtVersion(0),content:w}}),P=g.create(Za.TEXT,I);if(n.findAndSetParent(g,P),b||m){var N=kE({upime:v,size:n.getDefaultTextSize(),scale:E,id:P.id,currentScale:P.globalTransform.currentScale,position:e,eleType:Za.TEXT});g.update(P,{scale:N})}var M=n.upime.createLock([P.id]);if(p||g.sync(),v.switchMode("select"),f)n.upime.clearLock(M);else{var A=v.selectElement(P);c?A.startEdit({lock:M,op:g}):n.upime.clearLock(M),A.richContentEditor.moveCursorToEnd(),void 0!==v.lastTextColor&&A.richContentEditor.updateStyle({color:v.lastTextColor})}return P},"text"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.textConfig=function(e){Object.assign(this._textConfig,e)},t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.insertText(e.position)}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}}},t.prototype.getDefaultTextSize=function(){return{width:ji(Oe.placeholder,this._textConfig),height:this._textConfig.lineHeight}},t.prototype.genPickWidgetUpdateFromElement=function(e){var t=this._textConfig;if(e.elementType===Za.TEXT)t={scale:(n=e).scale,hasBg:n.hasBg,bgColor:n.bgColor,bgOpacity:n.bgOpacity,ha:n.ha,va:n.va,fontSize:n.fontSize,lineHeight:n.lineHeight,lineHeightRate:n.lineHeightRate,fontFamily:n.fontFamily},this.textConfig(t);else if(e.elementType===Za.SHAPE){var n=e;t.hasBg=n.hasBg,t.bgColor=n.bgColor,t.bgOpacity=n.bgOpacity,t.ha=n.ha,t.va=n.va,t.lineHeightRate=n.lineHeightRate,t.fontFamily=n.fontFamily,this.textConfig(t)}else if(e.elementType===Za.GRAPHIC){n=e,t.hasBg=n.hasBg,t.bgColor=n.bgColor,t.bgOpacity=n.bgOpacity;var i=n.textNodes[0];i&&(t.ha=i.ha,t.va=i.va,t.fontFamily=i.fontFamily,t.lineHeightRate=i.lineHeightRate),this.textConfig(t)}var r=this.getDefaultTextSize();return{update:exports.E(exports.E({size:r,autoWidth:!0},t),{richContent:{version:this.upime.genOtVersion(0),content:[]}})}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd),HU=function(e){function t(t){var n=e.call(this,t)||this;return n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"frame"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),n.insertFrameAt=function(e,t){var i,r=n.upime.lastFrame||n.upime.framesListManager.lastFrameInList,o=0,a=0;if(r&&"custom"===e)o=r.size.width,a=r.size.height;else{var s=n._calcSizeByAreaAndType(e,r?r.size.width*r.size.height:void 0);o=s.width,a=s.height}var l={x:t.x-o/2,y:t.y-a/2},c=n.upime.createOperation(),u=c.create(Za.FRAME,{position:l,type:e,name:O("frame.title"),size:{width:o,height:a},hasBg:!0,bgColor:je[0],showDB:!1,hide:!1,prevFrameId:null!==(i=null==r?void 0:r.id)&&void 0!==i?i:null});return c.sync(),n.upime.switchMode("select"),u},"frame"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.insertFrame=function(e,t){var n,i=this;void 0===e&&(e="custom");var r=0===this.upime.elementManager.getFrames().length,o=r?this._getFirstFrameRect(e,t):this._getNextFrameRect(e,t),a=o.x,s=o.y,l=o.width,c=o.height,u=this.upime.createOperation(),d=u.create(Za.FRAME,{position:{x:a,y:s},type:e,name:O("frame.title"),size:{width:l,height:c},hasBg:!0,bgColor:je[0],showDB:!1,hide:!1,prevFrameId:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:null});if(!r)var p=this.upime.subscribe("frameSelected",(function(e){e.id===d.id&&(qt(d.getBorderBox(),i.upime.view.getViewbox())||i.upime.makeBorderInSight(d.getBorderBox(),{left:440,top:90,bottom:90,right:40,duration:300}),p())}));var h=this.upime.createLock([d.id]);u.sync(),this.upime.clearLock(h),this.upime.selectElement(d)},t.prototype._getFirstFrameRect=function(e,t){var n=this._calcSizeByAreaAndType(e,t?t.size.height*t.size.width:void 0),i=n.width,r=n.height,o=this.upime.view,a=o.x,s=o.y;return{x:a+(o.width-i)/2,y:s+(o.height-r)/2,width:i,height:r}},t.prototype._getNextFrameRect=function(e,t){if(void 0===e&&(e="custom"),t){var n=t.position,i=n.x,r=n.y,o=t.size,a=o.width,s=o.height,l=a,c=s;if("custom"!==e){var u=this._calcSizeByAreaAndType(e,a*s);l=u.width,c=u.height}var d={left:i+a+100,top:r,right:i+a+100+l,bottom:r+c},p=this.upime.getAllFrames().some((function(e){return Kt(d,exports.E({},e.getBorderBox()))}));return p?{x:(h=this.upime.getRightMostElement(Za.FRAME)).position.x+h.size.width+100,y:h.position.y,width:l,height:c}:{x:i+a+100,y:r,width:l,height:c}}var h,f=(h=this.upime.getRightMostElement(Za.FRAME)).position,m=f.x,v=f.y,g=h.size,y=g.width,b=g.height;if("custom"!==e){var E=this._calcSizeByAreaAndType(e,y*b);return{x:m+y+100,y:v,width:E.width,height:E.height}}return{x:m+y+100,y:v,width:y,height:b}},t.prototype.calcEmptyFrameArea=function(e){var t,n=e.size,i=e.refFrame,r=e.position,o=void 0===r?"right":r,a=e.distance,s=void 0===a?100:a,l=i.getBorderBox();t="bottom"===o?{left:l.left,top:l.bottom+s,right:l.left+n.width,bottom:l.bottom+s+n.height}:{left:l.right+s,top:l.top,right:l.right+s+n.width,bottom:l.top+n.height};var c=this.upime.getAllFrames().some((function(e){return Kt(t,exports.E({},e.getBorderBox()))}));if(c){var u=this.upime.getRightMostElement(Za.FRAME);return{x:u.position.x+u.size.width+s,y:u.position.y,width:n.width,height:n.height}}return{x:t.left,y:t.top,width:n.width,height:n.height}},t.prototype._calcSizeByAreaAndType=function(e,t){void 0===e&&(e="custom");var n=0,i=0,r=PM[e],o=null!=t?t:this.upime.view.width*this.upime.view.height/4;switch(e){case"16:9":case"1:1":case"4:3":case"A4":case"letter":var a=In(r,o);n=a.width,i=a.height;break;default:n=this.upime.view.width/2,i=this.upime.view.height/2}return{width:n,height:i}},t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n,i=[],r=[this.upime.userEventManager.subscribe("moveto",(function(e){var r,o=e.isStart,a=e.isEnd,s=e.position,l=e.startPosition;if("left"===e.connectType||"touch"===e.connectType){var c=jt(s.x,l.x),u=c[0],d=c[1],p=jt(s.y,l.y),h=p[0],f=d-u,m=p[1]-h,v={x:u,y:h};f<4&&(s.x<l.x&&(v.x+=f-4),f=4),m<4&&(s.y<l.y&&(v.y+=m-4),m=4),e.originEvent.shiftKey&&(s.y<l.y&&(v.y+=m-f),m=f);var g={width:f,height:m};if(n)n.data={x:v.x,y:v.y,width:f,height:m},t.upime.view.update();else{if(!o)return;n=new Xp(v.x,v.y,f,m),t.upime.view.addAssistWidget(n)}var y=t.upime.view.elementsRoot,b=t.upime.elementManager.getAvailableElements((function(e){if(!e.frame&&e.parentRefSystem===y&&e.isSupportFrame&&Vt(e.getBorderBox(),n.data))return!0}));if(a){t.upime.view.removeAssistWidget(n),n=null,t.upime.switchMode("select");var E=t.upime.createOperation(),x=t.upime.elementManager.sequentialFrames,w=(null===(r=x[x.length-1])||void 0===r?void 0:r.id)||null,C=E.create(Za.FRAME,{position:v,type:"custom",name:O("frame.title"),size:g,hasBg:!0,bgColor:je[0],showDB:!1,hide:!1,prevFrameId:w});i.forEach((function(e){e.showInParentShadow=!1})),i=[],b.forEach((function(e){return E.update(e,{frameId:C.id})}));var S=t.upime.createLock(R([C.id],b.map((function(e){return e.id})),!0));E.sync(),t.upime.clearLock(S),t.upime.selectElement(C)}else i.forEach((function(e){b.indexOf(e)<0&&(e.showInParentShadow=!1)})),b.forEach((function(e){i.indexOf(e)<0&&(e.showInParentShadow=!0)})),i=b}})),this.upime.userEventManager.subscribe("click",(function(e){var n=e.position,i=t.upime.elementManager,r="custom",o=0===i.getFrames().length?t._getFirstFrameRect(r):t._getNextFrameRect(r,i.sequentialFrames[i.sequentialFrames.length-1]),a=o.width,s=o.height,l=t.upime.createOperation(),c={x:n.x-a/2,y:n.y-s/2},u=l.create(Za.FRAME,{position:c,type:r,name:O("frame.title"),size:{width:a,height:s},hasBg:!0,bgColor:je[0],showDB:!1,hide:!1});t.upime.switchMode("select");var d=t.upime.createLock([u.id]);l.sync(),t.upime.clearLock(d),t.upime.selectElement(u)}))];this.unsub_move=function(){return r.forEach((function(e){return e()}))}}},t.prototype.createFrameFromElements=function(e){var t;if(e.length){e=e.filter((function(e){return!e.position.parentType&&e.isSupportFrame})),e=this.expandMindmapLeafs(e);var n=this.upime.createOperation(),i=this.upime.elementManager.sequentialFrames,r=(null===(t=i[i.length-1])||void 0===t?void 0:t.id)||null,o=Yt(e.map((function(e){return e.getBorderBox()}))),a=n.create(Za.FRAME,{position:{x:o.left-50,y:o.top-50},type:"custom",name:O("frame.title"),size:{width:o.right-o.left+100,height:o.bottom-o.top+100},hasBg:!0,bgColor:je[0],showDB:!1,prevFrameId:r}),s=e.filter((function(e){return!e.frameId&&e.elementType!==Za.FRAME}));s.forEach((function(e){n.update(e,{frameId:a.id})}));var l=this.upime.createLock(R([a.id],s.map((function(e){return e.id})),!0));n.sync(),this.upime.clearLock(l),this.upime.selectElement(a),this.upime.updateView()}},t.prototype.expandMindmapLeafs=function(e){return e.reduce((function(e,t){if(t.elementType===Za.MINDMAP_NODE&&t.isRootNode){var n=t.getDescendants((function(e){return!e.isMindmapNodeHideByCollapsed}));return e.concat(t).concat(n)}return e.concat(t)}),[])},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd);function UU(t){var n=t.success,i=t.fail,r=W().getUpimeTrans;return e.createElement("div",{className:AN.insertExcelChooseModalBox},e.createElement("div",{className:AN.titleRow},r("upload.excel.modal.title"),e.createElement(hl,{icon:"guanbi",onClick:function(){i("close")}})),e.createElement("div",{className:AN.iconRow},e.createElement("div",{className:j(AN.item,AN.first)},e.createElement("img",{className:AN.bg,src:$o("excel_to_table.png")}),e.createElement("div",{className:AN.btn,onClick:function(){n(1)}},r("upload.excel.modal.table"))),e.createElement("div",{className:j(AN.item)},e.createElement("img",{className:AN.bg,src:$o("excel_to_file.png")}),e.createElement("div",{className:AN.btn,onClick:function(){n(2)}},r("upload.excel.modal.attachment")))),e.createElement("div",{className:AN.descRow},e.createElement("div",{className:AN.row},r("upload.excel.shuoming.title")),e.createElement("div",{className:AN.row},r("upload.excel.shuoming.item1")),e.createElement("div",{className:AN.row},r("upload.excel.shuoming.item2"))))}var WU=function(e){function t(t){var n=e.call(this,t)||this;return n.x=1,n.maxHeight=0,n.baseX=null,n.baseY=null,n.currentPosition=null,n.gapX=10,n.gapY=10,n.addDragListener(),"production"!==process.env.NODE_ENV&&(window._insetRandomTextList=n._insetRandomTextList.bind(n)),n}return P(t,e),t.prototype.addDragListener=function(){var e=this,t=null,n=[this.upime.userEventManager.subscribe("dragenter",(function(){e.upime.editable&&"hand"!==e.upime.xmode&&(t=new Zp,e.upime.view.addAssistWidget(t))})),this.upime.userEventManager.subscribe("dragleave",(function(){t&&(e.upime.view.removeAssistWidget(t),t=null)})),this.upime.userEventManager.subscribe("drop",(function(n){t&&(e.upime.view.removeAssistWidget(t),t=null),e.upime.editable&&"hand"!==e.upime.xmode&&n.dataTransfer&&e._insertFiles(Array().slice.call(n.dataTransfer.files),{position:{x:n.pageX,y:n.pageY}})}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}},t.prototype.insertImageByUrl=function(e,t){var n=this.upime.view,i=n.x,r=n.y,o=n.width,a=n.height;this.upime.fileHelper.uploadImageByUrl(e,t,{x:i,y:r},{width:o,height:a})},t.prototype.insertDocumentByUrl=function(e,t,n){var i=this.upime.view,r=i.x,o=i.y,a=i.width,s=i.height;this.upime.fileHelper.uploadDocByUrl(e,t,n,{x:r,y:o},{width:a,height:s})},t.prototype.insertVideoByUrl=function(e,t){var n=this.upime.view,i=n.x,r=n.y,o=n.width,a=n.height;this.upime.fileHelper.uploadVideoByUrl(e,t,{x:i,y:r},{width:o,height:a})},t.prototype.insertAudioByUrl=function(e,t){var n=this.upime.view,i=n.x,r=n.y,o=n.width,a=n.height,s={x:(i+o)/2-ot.width/2,y:(r+a)/2-ot.height/2};this.upime.fileHelper.uploadAudioByUrl(e,t,s,ot)},t.prototype.insertFiles=function(e,t){void 0===t&&(t={});var n=t.position,i=this.upime.view,r={x:i.viewWidth/2,y:i.viewHeight/2};n&&(r=n),this._insertFiles(e,exports.E(exports.E({},t),{position:r}))},t.prototype._insertFiles=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_;return D(this,(function(T){switch(T.label){case 0:return n=t.position,i=t.ispringppt,[4,ra(this.upime)];case 1:return T.sent()?(r=this.upime.userManager.uploadSizeLimit,o=Bp(e,{fileSizeLimit:r}),a=o.validFiles,s=o.exceedLimitFiles,o.notSupportedFiles.length>0&&this.upime.addToast(O("upload.notSupportFiles")),s.length>0&&this.upime.addToast(O("upload.exceedLimitSize",na(r))),l=this.upime.view.scale,c=a[0],u=this.upime.view.getAbsolutePosition(n),d={x:u.x,y:u.y},p=!0,c&&(h={width:$p.width/l,height:$p.height/l},1===a.length&&"image"!==a[0].type&&(f=this.upime.view,(h.width>f.viewWidth||h.height>f.viewHeight)&&(p=!1,m={x:f.viewWidth/2,y:f.viewHeight/2},d=f.getAbsolutePosition(m))),d={x:d.x-h.width/2,y:d.y-h.height/2}),[4,Hp(a,d,l)]):[2];case 2:v=T.sent(),g=v.files,y=v.elementBounds,a.length>0&&(b=Yt(y),E=p?.3:0,this.upime.makeBorderInSight(b,{left:72,top:64,right:72,bottom:64,duration:1e3*E})),x=[],w=0,T.label=3;case 3:if(!(w<g.length))return[3,14];switch((C=g[w]).extFile.type){case"document":return[3,4];case"mp4":return[3,9];case"mp3":return[3,10];case"image":return[3,11]}return[3,13];case 4:return i&&Mp(C.extFile.ext)?(this._insertIspringPpt(C.extFile,C.position,l),[3,8]):[3,5];case 5:return Rp(C.extFile.ext)?[4,this.upime.showWindow(UU,null,!1,!0)]:[3,7];case 6:return 1===(S=T.sent())?this.insertExcel(C.extFile,C.position):2===S&&this._insertDocument(C.extFile,C.position,l),[3,8];case 7:this._insertDocument(C.extFile,C.position,l),T.label=8;case 8:return[3,13];case 9:return this._insertMp4(C.extFile,C.position,l),[3,13];case 10:return this._insertMp3(C.extFile,C.position,l),[3,13];case 11:return k=C,[4,this.insertImage(k.extFile,k.image,k.position,{autoSize:!1},"",l)];case 12:return _=T.sent(),x.push(_),[3,13];case 13:return w++,[3,3];case 14:return x.length>0&&this.upime.selectElements(x),[2]}}))}))},t.prototype.insertExcel=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l;return D(this,(function(c){switch(c.label){case 0:return n=e.file,i=e.ext,r=this.upime.genID(Za.TABLE),[4,this.upime.uploadToOssBySdk({file:n,ext:i,fakeName:"".concat(this.upime.genFileName(r),".").concat(i)})];case 1:o=c.sent(),c.label=2;case 2:return c.trys.push([2,6,,7]),[4,this.upime.getTableDataByExcel(o.name)];case 3:return(a=c.sent())?(this.handleTableData(a),[4,this.upime.useElementsInfo(a,t)]):[3,5];case 4:c.sent(),s=this.upime.getSelectedElements(),l=Yt(s.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)}))),this.upime.makeBorderInSight(l,{left:90,right:20,top:60,bottom:60}),c.label=5;case 5:return[3,7];case 6:return"100"===c.sent().message&&this.upime.addToast(O("upload.excel.overlimit.toast")),[3,7];case 7:return[2]}}))}))},t.prototype.getCharsFromContent=function(e){var t=[];return e.forEach((function(e){return e[0].forEach((function(e){return t.push(e)}))})),t},t.prototype.handleTableData=function(e){for(var t=0;t<e.length;t++)if(e[t].elementType===Za.TABLE){var n=[],i=e[t].data;i.lineHeightRate=Le(i.fontFamily),i.lineHeight=ib(i.fontSize,i.lineHeightRate);for(var r=i.cols,o=i.rows,a=i.cells,s=0,l=0;l<o;l++){for(var c=72,u=function(t){var n=a[s];n.lineHeightRate=Le(n.fontFamily),n.lineHeight=ib(n.fontSize,n.lineHeightRate);var i=n.textEleId;if(i){var r=e.find((function(e){return e.id===i&&e.elementType===Za.GRID_TEXT}));if(r){var o=r.data;o.lineHeightRate=Le(o.fontFamily),o.lineHeight=ib(o.fontSize,o.lineHeightRate),o.richContent.content=o.richContent.content.map((function(e){return[e[0].map((function(e){return aa(e)})),e[1]]}));var l=Wi(d.getCharsFromContent(o.richContent.content),{lineHeight:o.lineHeight,fontSize:o.fontSize,fontFamily:o.fontFamily},{wordWrapWidth:o.size.width}).height;c=Math.max(c,l+20)}}s++},d=this,p=0;p<r;p++)u();n.push(c)}i.rowHeights=n,i.size.height=n.reduce((function(e,t){return e+t}),0)}},t.prototype.insertImage=function(e,t,n,i,r,o){return void 0===i&&(i={autoSize:!0}),void 0===o&&(o=1),A(this,void 0,void 0,(function(){var a,s,l,c,u,d,p,h,f,m,v,g,y,b,E;return D(this,(function(x){switch(x.label){case 0:return a=e.file,s=e.ext,c=(l=i||{}).autoSize,u=l.showLoading,d=l.elementSize,p={width:t.naturalWidth,height:t.naturalHeight},h=p.width,f=1,m=n,c||(d?p=d:(h=zp(p.width,p.height,o).width,f=h/p.width,m={x:n.x+($p.width/o-h)/2,y:n.y})),v=this.upime.createOperation(),g=this.upime.genID(Za.IMAGE),y=new $p(g,a.name,n.x,n.y,o),u&&this.upime.view.addAssistWidget(y),(b=v.create(Za.IMAGE,{position:m,scale:f,size:p,clipRect:exports.E({x:0,y:0},p),fileId:"",name:a.name,imgType:s,zIndex:this.upime.newMaxZindex()})).localImage=t.src,b.updateImageFile(),r?[3,2]:[4,this.upime.saveFile(2,{file:a,ext:s,fakeName:"".concat(this.upime.genFileName(g),".").concat(s)})];case 1:r=x.sent(),x.label=2;case 2:return E=this.upime.createLock([b.id]),r&&v.update(b,{fileId:r}),this.findAndSetParent(v,b),v.sync(),this.upime.clearLock(E),u&&this.upime.view.removeAssistWidget(y),[2,b]}}))}))},t.prototype._insertIspringPpt=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return i=this.upime.genID(Za.DOCUMENT),r=e.file,o=new $p(i,r.name,t.x,t.y,n),this.upime.view.addAssistWidget(o),[4,Wp(e,t,this.upime,{id:i},n)];case 1:return null!=(a=d.sent())?(s=this.upime.createOperation(),l=s.create(Za.DOCUMENT,a),(c=this.findFrame(l))&&s.update(l,{frameId:c.id}),u=this.upime.createLock([l.id]),s.sync(),this.upime.clearLock(u)):this.upime.addToast(O("toolbar.upload.dongtaippt.fail")),this.upime.view.removeAssistWidget(o),[2]}}))}))},t.prototype._insertDocument=function(e,t,n){return void 0===n&&(n=1),A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return i=this.upime.genID(Za.DOCUMENT),r=e.file,o=new $p(i,r.name,t.x,t.y,n),this.upime.view.addAssistWidget(o),[4,Vp(e,t,this.upime,{id:i},n)];case 1:return null!=(a=d.sent())&&(s=this.upime.createOperation(),l=s.create(Za.DOCUMENT,a),(c=this.findFrame(l))&&s.update(l,{frameId:c.id}),u=this.upime.createLock([l.id]),s.sync(),this.upime.clearLock(u)),this.upime.view.removeAssistWidget(o),[2]}}))}))},t.prototype._insertMp4=function(e,t,n){return void 0===n&&(n=1),A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return i=e.file,r=this.upime.genID(Za.VIDEO),o=new $p(r,i.name,t.x,t.y,n),this.upime.view.addAssistWidget(o),[4,jp(e,t,this.upime,{id:r},n)];case 1:return null!=(a=d.sent())?(s=this.upime.createOperation(),l=s.create(Za.VIDEO,a),(c=this.findFrame(l))&&s.update(l,{frameId:c.id}),u=this.upime.createLock([l.id]),s.sync(),this.upime.clearLock(u)):this.upime.addToast(O("toolbar.upload.transcodingFailed")),this.upime.view.removeAssistWidget(o),[2]}}))}))},t.prototype._insertMp3=function(e,t,n){return void 0===n&&(n=1),A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return i=e.file,r=this.upime.genID(Za.AUDIO),o=new $p(r,i.name,t.x,t.y,n),this.upime.view.addAssistWidget(o),[4,Gp(e,t,this.upime,{id:r},n)];case 1:return null!=(a=d.sent())?(s=this.upime.createOperation(),l=s.create(Za.AUDIO,a),(c=this.findFrame(l))&&s.update(l,{frameId:c.id}),u=this.upime.createLock([l.id]),s.sync(),this.upime.clearLock(u)):this.upime.addToast(O("toolbar.upload.transcodingFailed")),this.upime.view.removeAssistWidget(o),[2]}}))}))},t.prototype.destroy=function(){var e=this.unsub_move;void 0!==e&&e()},t.prototype._insetRandomTextList=function(e,t){for(var n=0;n<e;n++){var i=VU(t),r=this.upime.createOperation(),o={x:0,y:0};null===this.currentPosition&&(this.currentPosition=exports.E({},o),this.baseX=o.x,this.baseY=o.y);var a=this.upime.insertTextAt(this.currentPosition,{text:i,autoStartEdit:!1,verticalPos:"center",currentOp:r,noSync:!0,slient:!0});r.update(a,{position:exports.E({},this.currentPosition)});var s=a.getGlobalBox();this.x<50?(this.x++,this.maxHeight=Math.max(this.maxHeight,s.bottom-s.top),this.currentPosition.x=s.right+this.gapX):(this.x=1,this.currentPosition={x:this.baseX||0,y:(this.baseY||0)+this.maxHeight+this.gapY},this.baseY=this.currentPosition.y,this.maxHeight=0),r.sync()}},t}(zd);function VU(e){for(var t=Object.values(B).join("")+Object.values(z).join("")+"：「」【】《》？，。、；‘’“”！……（）——",n="",i=0;i<e;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}var jU=function(e){function t(t){var n=e.call(this,t)||this;return n._style={bgColor:qe,scale:tb.S,ha:"center",va:"middle",autoFontSize:!0,fontSize:64,lineHeightRate:Le(He),lineHeight:ib(64,Le(He)),fontFamily:He,isPrivate:!1},n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"sticker"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),n.insertSticker=function(e,t,i){void 0===t&&(t=!0);var r=n.upime,o=n.upime.createOperation(),a=Ke,s=n._style.scale,l=a.width*s*.5,c=a.height*s*.5,u={x:e.position.x-l,y:e.position.y-c},d=exports.E(exports.E({},n._style),{zIndex:r.newMaxZindex(),size:a,shape:eb.SQUARE,textSize:Ze,position:u,showAuthor:!1,richContent:{version:n.upime.genOtVersion(0),content:[]}}),p=o.create(Za.STICKER,d),h=p.globalTransform.currentScale,f=kE({upime:r,id:p.id,size:a,scale:s,currentScale:h,position:u,eleType:Za.STICKER});if(o.update(p,{scale:f,position:{x:u.x+a.width*h*(s-f)*.5,y:u.y+a.height*h*(s-f)*.5}}),n.findAndSetParent(o,p),o.sync(),r.switchMode("select"),t){var m=n.upime.createLock([p.id]);r.selectElement(p).startEdit({lock:m,optimizeView:i})}return p},"sticker"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.getCurrentStyle=function(){return exports.E({},this._style)},t.prototype.setStyle=function(e){Object.assign(this._style,e)},t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.insertSticker(e)}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}}},t.prototype.genPickWidgetUpdateFromElement=function(e,t){var n=this._style;if(e.elementType===Za.STICKER){var i=e;n={autoFontSize:i.autoFontSize,scale:i.scale,bgColor:i.bgColor,ha:i.ha,va:i.va,fontSize:i.fontSize,lineHeight:i.lineHeight,lineHeightRate:i.lineHeightRate,fontFamily:i.fontFamily,isPrivate:i.isPrivate},this.setStyle(n)}var r=exports.E({},Ke);return t===eb.RECT&&(r.width=1.8*r.width),{update:exports.E(exports.E({size:r,textSize:{width:Ze.width+(t===eb.RECT?.8*Ke.width:0),height:Ze.height}},n),{shape:null!=t?t:eb.SQUARE,richContent:{version:this.upime.genOtVersion(0),content:[]}})}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd),GU=function(e){function t(t){var n=e.call(this,t)||this;return n.upime=t,n}return P(t,e),Object.defineProperty(t.prototype,"customImageEvent",{get:function(){return{insertImage:this.insertImage.bind(this)}},enumerable:!1,configurable:!0}),t.prototype.insertImage=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g;return D(this,(function(y){switch(y.label){case 0:return e.file?[4,ra(this.upime)]:[2,null];case 1:return y.sent()?(n=(t=e||{}).file,i=t.size,r=t.fileId,o=t.autoSize,a=this.upime.userEventManager,s=a.mousePosition,l=a.targetDom,c=e.position||s,[4,wp(n)]):[2,null];case 2:return u=y.sent(),d=i||{width:u.naturalWidth,height:u.naturalHeight},p=o?1:this.upime.view.scale,d={width:d.width/p,height:d.height/p},h=l?q(l):{left:0,top:0},f=this.upime.view.getAbsolutePosition({x:c.x-h.left,y:c.y-h.top}),m={x:f.x-d.width/2,y:f.y-d.height/2},v={left:m.x,top:m.y,right:m.x+d.width,bottom:m.y+d.height},this.upime.makeBorderInSight(v,{left:72,top:64,right:72,bottom:64,duration:300}),g=Jo(n.name),[4,this.upime.insertImage({file:n,ext:g,type:"image"},u,m,{autoSize:o,elementSize:d,showLoading:!1},r)];case 3:return[2,y.sent().id]}}))}))},t.prototype.destroy=function(){},t}(zd),qU=function(){function e(e){this.loginName=e,this.avatarUrl="",this.userName="",this.online=!1,this.userType="visitor",this.nickName="",this.role=1;for(var t=0,n=0;n<e.length;n++)t+=e.charCodeAt(n);this.color=[6671026,16434961,9142527,15558284,8442485,16753698,6129407,16627396,12246870,16547402,8558847,15373520,14082178,16744026,9813481,13203423,15916848,16738893,6538981,10971135][t%20]}return Object.defineProperty(e.prototype,"meetingName",{get:function(){return this.nickName||this.userName},enumerable:!1,configurable:!0}),e.prototype.onAvatorUrlChange=function(){if(this.avatorSource){var e=this.avatarUrl;e&&this.avatorSource.imgSrc!==e&&(""===this.avatorSource.imgSrc?(this.avatorSource.imgSrc=e,er(this.avatorSource)):(this.avatorSource=tr(e),er(this.avatorSource)))}},M([rl],e.prototype,"avatarUrl",void 0),M([rl],e.prototype,"userName",void 0),M([il],e)}(),KU={owner:bs,editor:bs-ys.EDIT_UNLOCK_CONDITION-ys.EDIT_UNHIDE_FRAME_CONDITION,visitor:ys.MEETING_MODULE},YU=function(){function e(e,t,n,i){var r,o;this.upime=e,this.localUserPreference=t,this.userType=n,this.userAccessHint=i,this.onlineUsers=[],this.userMap=new Map,this._userAccess=0,this._userPalette=[],this._userAccess=null!==(r=t.accessSetting)&&void 0!==r?r:KU[n],this._userPalette=null!==(o=t.palette)&&void 0!==o?o:[],this.addRongKeComment=t.addRongKeComment}return e.prototype.updateUserAccess=function(e){this._userAccess=e,this.upime.setEditable(!!(this._userAccess&ys.EDITABLE))},Object.defineProperty(e.prototype,"userAccess",{get:function(){return this._userAccess},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uploadSizeLimit",{get:function(){var e;return null!==(e=this.localUserPreference.uploadSizeLimit)&&void 0!==e?e:62914560},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawEditPerm",{get:function(){return!!(this.userAccess&ys.EDITABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editable",{get:function(){return!this.commentOnlyMode&&this.rawEditPerm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"commentOnlyMode",{get:function(){return!!(this.userAccess&ys.COMMENT_ONLY)||!(this.rawEditPerm||!this.upime.phoneMode||!this.upime.meetingMode||"viewer"===this.upime.meetingMode)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableHideFrame",{get:function(){return!!(this.userAccess&ys.HIDE_FRAME)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableBorderVersion",{get:function(){return!!(this.userAccess&ys.BOARD_VERSION)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableBorderHistory",{get:function(){return!!(this.userAccess&ys.BOARD_HISTORY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableMeeting",{get:function(){return!!(this.userAccess&ys.MEETING_MODULE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableCallForFollow",{get:function(){return!!(this.userAccess&ys.CALL_FOR_FOLLOW)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableDownloadFile",{get:function(){return!!(this.userAccess&ys.FILE_DOWNLOAD)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableExportImage",{get:function(){return!!(this.userAccess&ys.EXPORT_IMAGE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableExportHQImage",{get:function(){return!!(this.userAccess&ys.EXPORT_IMAGE_HIGH_QUALITY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableExportSvg",{get:function(){return!!(this.userAccess&ys.EXPORT_SVG)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableExportPDF",{get:function(){return!!(this.userAccess&ys.EXPORT_PDF)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableExportHQPDF",{get:function(){return!!(this.userAccess&ys.EXPORT_PDF_HIGH_QUALITY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableUploadTemplate",{get:function(){return!!this.localUserPreference.enableUploadTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userPalette",{get:function(){return je.concat(this._userPalette).filter((function(e){return!!e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editUnlockCondition",{get:function(){return!!(this.userAccess&ys.EDIT_UNLOCK_CONDITION)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editUnHideCondition",{get:function(){return!!(this.userAccess&ys.EDIT_UNLOCK_CONDITION)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onChangeShowOtherCursor",{get:function(){return this.localUserPreference.onChangeShowOtherCursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableWebpage",{get:function(){return!!this.localUserPreference.enableWebpage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dynamicPPT",{get:function(){return!!this.localUserPreference.dynamicPPT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableTimer",{get:function(){return!!this.localUserPreference.enableTimer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableCommentExport",{get:function(){return!!this.localUserPreference.enableCommentExport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableKanban",{get:function(){return!!this.localUserPreference.enableKanban},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableGraphic",{get:function(){return!!this.localUserPreference.enableGraphic},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableDocument",{get:function(){return!!this.localUserPreference.enableDocument},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAIGenPPT",{get:function(){return!!this.localUserPreference.enableAIGenPPT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAIChat",{get:function(){return void 0===this.localUserPreference.enableAIChat||this.localUserPreference.enableAIChat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableMeetingHistory",{get:function(){return!!this.localUserPreference.enableMeetingHistory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expRenderClip",{get:function(){return!!this.localUserPreference.expRenderClip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expLowResolutionWhenViewChange",{get:function(){return!!this.localUserPreference.expLowResolutionWhenViewChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableIncrementalUpdate",{get:function(){return!!this.localUserPreference.enableIncrementalUpdate},enumerable:!1,configurable:!0}),e.prototype.addLocalUser=function(e){this.userMap.set(e.loginName,e)},e.prototype.loadUsers=function(e){return A(this,void 0,void 0,(function(){var t,n,i=this;return D(this,(function(r){switch(r.label){case 0:return(t=e.filter((function(e){return!i.userMap.has(e)}))).length?(t.forEach((function(e){return i.userMap.set(e,new qU(e))})),this.upime.getExtraUserInfo?[4,this.upime.getExtraUserInfo(t)]:[3,2]):[2];case 1:n=r.sent(),Object.entries(n).forEach((function(e){var t=e[0],n=e[1],r=i.userMap.get(t);r.avatarUrl=n.avatarUrl,r.userName=n.userName,r.onAvatorUrlChange()})),r.label=2;case 2:return[2]}}))}))},e.prototype.setUsers=function(e){var t=this;e.forEach((function(e){var n=t.userMap.get(e.loginName);n?(n.avatarUrl=e.avatarUrl,n.userName=e.userName):((n=new qU(e.loginName)).avatarUrl=e.avatarUrl,n.userName=e.userName,t.userMap.set(e.loginName,n)),n.onAvatorUrlChange()})),e.length&&this.upime.publish("updatedUserInfo","*")},e.prototype.getUser=function(e){var t=this,n=!1,i=this.userMap.get(e)||(n=!0,new qU(e));return n&&(this.userMap.set(e,i),this.upime.getExtraUserInfo&&i&&this.upime.getExtraUserInfo(e).then((function(e){var n=e.avatarUrl,r=e.userName;i.avatarUrl=n,i.onAvatorUrlChange(),i.userName||(i.userName=r),t.upime.publish("updatedUserInfo","*")}))),i},e.prototype.getUsers=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,new Promise((function(n,i){var r=t,o=r.upime,a=r.userMap,s=e.map((function(e){return A(t,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(s){switch(s.label){case 0:return void 0!==(t=a.get(e))?[2,Promise.resolve(t)]:(t=new qU(e),void 0===o.getExtraUserInfo?[3,2]:[4,o.getExtraUserInfo(e)]);case 1:return n=s.sent(),i=n.avatarUrl,r=n.userName,t.avatarUrl=i,t.userName=r,t.onAvatorUrlChange(),a.set(e,t),[2,t];case 2:return[2,Promise.resolve(new qU(e))]}}))}))}));Promise.all(s).then(n).catch(i)}))]}))}))},e.prototype.hasUser=function(e){return Boolean(this.userMap.get(e))},e.prototype.mergeColor=function(e){var t,n;this.userPalette.includes(e)||(this._userPalette.push(e),null===(n=(t=this.localUserPreference).onChangePalette)||void 0===n||n.call(t,this._userPalette),this.upime.updateView())},e.prototype.removeColor=function(e){var t,n;this._userPalette=this._userPalette.filter((function(t){return t!==e})),this.upime.updateView(),null===(n=(t=this.localUserPreference).onChangePalette)||void 0===n||n.call(t,this._userPalette)},e.prototype.checkWebpageType=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.localUserPreference.checkWebpageType?[2,this.localUserPreference.checkWebpageType(e)]:[2,"iframe"]}))}))},M([rl],e.prototype,"onlineUsers",void 0),M([il],e)}(),XU=function(e){function t(t){var n=e.call(this,t)||this,i=window.screen.width/3,r=2*i/3,o={width:i/n.upime.view.scale,height:r/n.upime.view.scale},a=n.upime.view.getAbsolutePosition({x:(n.upime.view.viewWidth-i)/2,y:(n.upime.view.viewHeight-r)/2});return n.upime.enableViewPicker(o,a),n}return P(t,e),t.prototype.destroy=function(){this.upime.switchToPrevXmode()},t}(zd),QU=function(e){function t(t){var n=e.call(this,t)||this;n.operationList=[],n.operationBin=[],n.canUndo=!1,n.canRedo=!1;var i=t.registerHotKey({key:"z",ctrlKey:!0,shiftKey:!1,i:!0,connected:!1},(function(){t.editable&&"hand"!==t.xmode&&n.undo()})),r=t.registerHotKey({key:"z",ctrlKey:!0,shiftKey:!0,i:!0,connected:!1},(function(){t.editable&&"hand"!==t.xmode&&n.redo()})),o=t.registerHotKey({key:"y",ctrlKey:!0,i:!0,connected:!1},(function(){t.editable&&"hand"!==t.xmode&&n.redo()}));return n.unsubHotKey=function(){o(),i(),r()},n}return P(t,e),t.prototype.setProxyManager=function(e){this.proxyManager=e,this.updateUndoRedo()},t.prototype.getLastUndo=function(){return this.operationList[this.operationList.length-1]},t.prototype.getLastRedo=function(){return this.operationBin[this.operationBin.length-1]},t.prototype.resetData=function(){this.operationList.forEach((function(e){var t;return null===(t=e.onRelease)||void 0===t?void 0:t.call(e)})),this.operationBin.forEach((function(e){var t;return null===(t=e.onRelease)||void 0===t?void 0:t.call(e)})),this.operationList=[],this.operationBin=[],this.updateUndoRedo()},t.prototype.updateUndoRedo=function(){if(this.proxyManager)return this.canRedo=this.proxyManager.canRedo,void(this.canUndo=this.proxyManager.canUndo);this.canUndo=0!==this.operationList.length,this.canRedo=0!==this.operationBin.length},t.prototype.elementModified=function(e){this.operationList=this.operationList.filter((function(t){var n;return t.relativeElements.findIndex((function(t){return t.id===e}))<0||(null===(n=t.onRelease)||void 0===n||n.call(t),!1)})),this.operationBin=this.operationBin.filter((function(t){var n;return t.relativeElements.findIndex((function(t){return t.id===e}))<0||(null===(n=t.onRelease)||void 0===n||n.call(t),!1)})),this.updateUndoRedo()},t.prototype.create=function(){var e=new bN(this.upime);return this.insertAnyOperation(e),e},t.prototype.hasOp=function(e){return this.operationList.includes(e)},t.prototype.insertAnyOperation=function(e){var t;if(50===this.operationList.length){var n=this.operationList.shift();null===(t=null==n?void 0:n.onRelease)||void 0===t||t.call(n)}this.operationList.push(e),this.operationBin.forEach((function(e){var t;return null===(t=e.onRelease)||void 0===t?void 0:t.call(e)})),this.operationBin=[],this.updateUndoRedo()},t.prototype.deleteRedoAddUndo=function(e,t){this.operationBin=this.operationBin.filter((function(t){return t!==e})),t&&this.operationList.push(t),this.updateUndoRedo()},t.prototype.deleteUndoAddRedo=function(e,t){this.operationList=this.operationList.filter((function(t){return t!==e})),t&&this.operationBin.push(t),this.updateUndoRedo()},t.prototype.grepOperationList=function(e){this.operationList=this.operationList.filter((function(t){var n,i=e(t);return i||null===(n=t.onRelease)||void 0===n||n.call(t),i})),this.operationBin=this.operationBin.filter((function(t){var n,i=e(t);return i||null===(n=t.onRelease)||void 0===n||n.call(t),i})),this.updateUndoRedo()},t.prototype.undo=function(){var e;if(this.proxyManager)this.proxyManager.dealUndo();else if(0!==this.operationList.length){var t=this.operationList.pop();if(t){var n=t.localOnly?void 0:this.upime.createLock(t.relativeElements.map((function(e){return e.id}))),i=t.getRevertOperation();n&&this.upime.clearLock(n),this.operationBin.push(i),this.updateUndoRedo(),null===(e=t.onRelease)||void 0===e||e.call(t),this.upime.publish("elementsUpdated",t.updateGroup)}}},t.prototype.redo=function(){var e;if(this.proxyManager)this.proxyManager.dealRedo();else if(0!==this.operationBin.length){var t=this.operationBin.pop();if(t){var n=t.localOnly?void 0:this.upime.createLock(t.relativeElements.map((function(e){return e.id}))),i=t.getRevertOperation();n&&this.upime.clearLock(n),this.operationList.push(i),this.updateUndoRedo(),null===(e=t.onRelease)||void 0===e||e.call(t),this.upime.publish("elementsUpdated",t.updateGroup)}}},t.prototype.delete=function(e){this.operationList=this.operationList.filter((function(t){var n;return t!==e||(null===(n=t.onRelease)||void 0===n||n.call(t),!1)})),this.updateUndoRedo()},t.prototype.destroy=function(){this.unsubHotKey()},M([rl],t.prototype,"canUndo",void 0),M([rl],t.prototype,"canRedo",void 0),M([il],t)}(zd),ZU=function(e){var t=e.element,n=e.viewbox,i=t.borderRect;if(!i)return null;var r=t.owner.userName,o=n.left,a=n.top,s=n.scale,l=t.useMemo("nameData",(function(){var e={text:r,fontSize:14,lineHeight:24},t=Da(e);return e.metrics=t,{textData:e,textWidth:e.metrics.width}}),[r]),c=l.textData,u=l.textWidth,d=(i.right-o)*s+2-u,p=(i.bottom-a)*s;Wa({borderRect:i,viewbox:n,option:{withResizePoint:!1,color:8750469,lineWidth:2}}),fa({x:d-8,y:p}),Na((function(e){e.clear(),e.beginFill(8750469),e.drawRect(0,0,u+8,30)})),Ra(c,{x:4,y:5,fill:"#ffffff"}),ma()},JU=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.upime=t,o.lockId=n,o.owner=i,o.ids=r,o.renderer=ZU,o.borderRect=void 0,o.unsubUpdate=o.upime.subscribe("elementsUpdated",(function(e){e.some((function(e){var t=e.element;return o.ids.includes(t.id)}))&&o.updateBorderBox()})),o.renderKey="lock-group"+n,o.updateBorderBox(),o}return P(t,e),t.prototype.destroy=function(){this.unsubUpdate()},t.prototype.updateBorderBox=function(){var e=this.ids,t=this.upime,n=[];if(e.forEach((function(e){var i,r,o=t.elementManager.getElementById(e);if(o){if(!o.mounted)return;(o.elementType!==Za.LINE||o.ended)&&(o.elementType===Za.STICKER&&(null===(r=(i=o).hideForPrivate)||void 0===r?void 0:r.call(i))||o.elementType===Za.MINDMAP_NODE&&o.isInLocalModeTree||n.push(o))}})),n.length){var i=n.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate)}));this.borderRect=Yt(i)}else this.borderRect=void 0},t}(el),$U={border:"border_Q60AG",goToLinkToolTip:"goToLinkToolTip_Jo9f-",regular_content:"regular_content_vXb4B",ui_layout:"ui_layout_QVnWA",ui_left:"ui_left_21TLy",leftSideBar:"leftSideBar_2tLvJ",left_side_content:"left_side_content_2lbe_",title_bar:"title_bar_tzIpJ",controls:"controls_2TAe2",toolbar_wrap:"toolbar_wrap_2GDlz",sideBarIcon:"sideBarIcon_376N9",hidden:"hidden_2F1ub",disable:"disable_3IN0Q",ui_right:"ui_right_3ti2x",learning_center:"learning_center_3U01n",right_side_content:"right_side_content_2Io3C",NEFloatMenu:"NEFloatMenu_18zWd",rightSidePanelRoot:"rightSidePanelRoot_2OnGa",rightSlidePanel:"rightSlidePanel_TKkAn",audio_con:"audio_con_1eDZb",bottomSideBar:"bottomSideBar_1SzAf",bottomSideBarContainer:"bottomSideBarContainer_1ILqr"},eW=function(){function e(e){var t=this;this.view=e,this.mapview=null,this.updated=!1,this.view.subscribe("viewboxChange",(function(){return t.update()}))}return e.prototype.bindDom=function(e){var t,n,i=this,r=function(t){var n=e.getBoundingClientRect(),r=i.mapview;return{x:r.x+(t.x-n.x)/r.scale,y:r.y+(t.y-n.y)/r.scale}};this.update();var o=!1,a=this.view,s=function(e){if(!i.view.upime.followManager.forcedFollowing&&(i.view.upime.followManager.stopFollowCurrent(),!o&&i.mapview)){var s=r({x:e.clientX,y:e.clientY});t=s,Ot(s,a.getViewbox())||a.setView(s.x-a.width/2,s.y-a.height/2),n=a.getViewbox(),o=!0}};function l(e){if(o){var i=xn(r({x:e.clientX,y:e.clientY}),t);a.setView(n.left+i.x,n.top+i.y)}}function c(e){o&&(l(e),o=!1)}return e.addEventListener("pointerdown",s),document.addEventListener("pointermove",l),document.addEventListener("pointerup",c),function(){e.removeEventListener("pointerdown",s),document.removeEventListener("pointermove",l),document.removeEventListener("pointerup",c),i.mapview=null}},e.prototype.update=function(){this.updated=!1},e}(),tW=new Map;function nW(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){return(n=tW.get(e))||(n=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:t=0,n=e,r.label=1;case 1:return t<n.length?(i=n[t],Array.isArray(i)?[4,Promise.all(i.map((function(e){return iW(e)})))]:[3,3]):[3,6];case 2:return r.sent(),[3,5];case 3:return[4,iW(i)];case 4:r.sent(),r.label=5;case 5:return t++,[3,1];case 6:return[2]}}))}))}(t),tW.set(e,n)),[2,n]}))}))}function iW(e){return new Promise((function(t,n){if(0==e.indexOf("http")){if(0==location.protocol.indexOf("http")){var i=e.indexOf("//");e=e.substring(i)}}else 0==e.indexOf("//")&&0!==location.protocol.indexOf("http")&&(e="https://"+e);var r;/\.css$/.test(e)?((r=document.createElement("link")).type="text/css",r.rel="stylesheet",r.href=e):((r=document.createElement("script")).type="text/javascript",r.src=e),document.head.appendChild(r),r.onerror=function(){n()},r.onload=function(){t()}}))}var rW=function(){function e(e,t){var n=this;this.enteringImmersivePlayAnimationIds=new Set,this.currentPageIndex=0,this.totalPageCount=0,this.lastKey="",_e.desktop&&this.initGamePad();var i=[e.view.subscribe("viewboxChange",(function(){0===n.enteringImmersivePlayAnimationIds.size&&n.exitImmersivePlay()})),e.view.subscribe("viewboxChangeAnimationEnd",(function(e){n.enteringImmersivePlayAnimationIds.delete(e)}))];this.baseUnsub=function(){return i.forEach((function(e){return e()}))}}return Object.defineProperty(e.prototype,"pages",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canPrev",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canNext",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFramePaginator",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.initGamePad=function(){return A(this,void 0,void 0,(function(){var e,t=this;return D(this,(function(n){switch(n.label){case 0:return[4,Promise.resolve().then((function(){return require("./index-f64ac25a-f8af6c3a.js")}))];case 1:return e=n.sent().Gamepad,this.gamepad=new e,this.gamepad.on("pressed","d_pad_up",(function(){t.prevStep()})),this.gamepad.on("pressed","d_pad_left",(function(){t.prevStep()})),this.gamepad.on("pressed","d_pad_down",(function(){t.nextStep()})),this.gamepad.on("pressed","d_pad_right",(function(){t.nextStep()})),this.gamepad.on("pressed","shoulder_top_left",(function(){t.prevPrevStep()})),this.gamepad.on("pressed","shoulder_top_right",(function(){t.nextNextStep()})),this.gamepad.on("pressed","shoulder_bottom_left",(function(){t.prevPage()})),this.gamepad.on("pressed","shoulder_bottom_right",(function(){t.nextPage()})),this.gamepad.start(),[2]}}))}))},e.prototype.handleKeyAction=function(e,t){var n,i=this;e!==this.lastKey?(this.lastKeyTimer&&window.clearTimeout(this.lastKeyTimer),null===(n=this.lastKeyTask)||void 0===n||n.call(this),this.lastKeyTask=function(){t?i.nextStep():i.prevStep(),i.lastKey="",i.lastKeyTask=void 0},this.lastKeyTimer=window.setTimeout(this.lastKeyTask,300),this.lastKey=e):(window.clearTimeout(this.lastKeyTimer),this.lastKey="",this.lastKeyTask=void 0,t?this.nextNextStep():this.prevPrevStep())},e.prototype.prevStep=function(){},e.prototype.nextStep=function(){},e.prototype.prevPrevStep=function(){},e.prototype.nextNextStep=function(){},e.prototype.handlePrev=function(e){this.handleKeyAction(e,!1)},e.prototype.handleNext=function(e){this.handleKeyAction(e,!0)},e.prototype.prevPage=function(){},e.prototype.nextPage=function(){},e.prototype.dealPlayerState=function(e){},e.prototype.replayCurrent=function(){},e.prototype.replayCurrentFrame=function(){},e.prototype.start=function(){},e.prototype.end=function(){},e.prototype.onResize=function(){},e.prototype.enterImmersivePlay=function(e,t){return void 0===t&&(t={duration:200}),A(this,void 0,void 0,(function(){var n,i=this;return D(this,(function(r){return n=this.upime.view.subscribe("viewboxChangeAnimationStart",(function(e){i.enteringImmersivePlayAnimationIds.add(e)})),this.upime.maximizeElement(e,t),this.upime.view.isImmersivePlayingEnabled&&(this.upime.view.enterImmersivePlay(),this.upime.view.updatePlayingBorder(e)),setTimeout((function(){n()}),0),[2]}))}))},e.prototype.exitImmersivePlay=function(){this.enteringImmersivePlayAnimationIds.clear(),this.upime.view.exitImmersivePlay()},e.prototype.destroy=function(){var e;this.baseUnsub(),null===(e=this.gamepad)||void 0===e||e.stop(),this.exitImmersivePlay()},e.prototype.onPlayEnd=function(){},e}(),oW=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.upime=t,i.element=n,i.elementEventUnsubs=new Map,i.unsubElementEvents=function(e){var t;(null!==(t=i.elementEventUnsubs.get(e))&&void 0!==t?t:[]).forEach((function(e){return e()}))},i.subElementEvents=function(e){i.unsubElementEvents(e);var t=[e.subscribe("elementBorderBoxUpdated",(function(e){i.exitImmersivePlay()})),e.subscribe("elementDeleted",(function(t){i.exitImmersivePlay(),i.unsubElementEvents(e)}))];e.elementType===Za.DOCUMENT&&t.push(e.subscribe("documentPageChanged",(function(e){e===i.currentFile&&i.enterImmersivePlay(e)}))),i.elementEventUnsubs.set(e,t)},i.unsubAllElementEvents=function(){i.elementEventUnsubs.forEach((function(e){e.forEach((function(e){return e()}))}))},i.currentPageIndex=0,i.totalPageCount=0,i.unsub=function(){},i.frameListWillChange=function(e){i.frameList.filter((function(t){return!e.includes(t)})).forEach((function(e){i.upime.addToast(e.name.length>16?"【".concat(e.name.substring(0,16),"...】 ").concat(O("meeting.frame.deleted")):"【".concat(e.name,"】 ").concat(O("meeting.frame.deleted")),{type:"normal"})}))},i.currentFrame=n,i.frameList=t.elementManager.sequentialFrames,i.currentPageIndex=i.frameList.indexOf(i.currentFrame),i.totalPageCount=i.frameList.length,i.initEventListeners(t),i}return P(t,e),Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this._currentFrame},set:function(e){void 0!==this.currentFrame&&this.unsubElementEvents(this.currentFrame),void 0!==e&&this.subElementEvents(e),this._currentFrame=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFile",{get:function(){return this._currentFile},set:function(e){void 0!==this._currentFile&&this.unsubElementEvents(this._currentFile),void 0!==e&&this.subElementEvents(e),this._currentFile=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canPrev",{get:function(){return this.currentPageIndex>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canNext",{get:function(){return this.currentPageIndex<this.frameList.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFramePaginator",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initEventListeners=function(e){var t=this,n=[e.subscribe("framesUpdated",(function(e){t.frameListWillChange(e),t.frameList=e,t.currentPageIndex=t.frameList.indexOf(t.currentFrame),t.totalPageCount=e.length})),e.subscribe("frameSelected",(function(e){t.currentFrame=e,t.tempFile=void 0,t.currentFile=void 0,t.upime.clearDocumentFileHelper(),t.currentPageIndex=t.frameList.indexOf(t.currentFrame),t.syncPlayerState()})),e.subscribe("documentFocused",(function(e){1===e.mode&&(t.currentFrame&&e.frame===t.currentFrame?(t.tempFile=void 0,t.currentFile=e):t.tempFile=e,t.syncPlayerState())})),e.subscribe("mediaFocused",(function(e){0!==e.transStatus&&1!==e.transStatus||(t.currentFrame&&e.frame===t.currentFrame?(t.tempFile=void 0,t.currentFile=e):t.tempFile=e,t.syncPlayerState())}))];this.unsub=function(){return n.forEach((function(e){return e()}))}},t.prototype.syncPlayerState=function(){this.upime.followManager.syncFramePlayer(this)},t.prototype.playCurrentFrame=function(){var e=this.currentFrame;e&&(this.upime.view.playingElement=e,this.enterImmersivePlay(e,{duration:0}),this.tempFile=void 0,this.currentFile=void 0,this.upime.clearSelect(),this.upime.clearDocumentFileHelper(),this.syncPlayerState())},t.prototype.playFrame=function(e){this.upime.onFrameSelected(e),this.currentFrame=e,this.playCurrentFrame()},t.prototype.playDocument=function(e){this.upime.enableFileHelperWidget(e),this.upime.view.playingElement=e,this.enterImmersivePlay(e),this.currentFile=e,this.tempFile=void 0,this.upime.clearSelect(),this.syncPlayerState()},t.prototype.playMedia=function(e){this.upime.enableFileHelperWidget(e),this.upime.view.playingElement=e,this.enterImmersivePlay(e),this.currentFile=e,this.tempFile=void 0,this.upime.clearSelect(),this.syncPlayerState()},t.prototype.playElement=function(e){e.elementType===Za.DOCUMENT?this.playDocument(e):e.elementType!==Za.AUDIO&&e.elementType!==Za.VIDEO||this.playMedia(e)},t.prototype.replayCurrent=function(){var e=this.tempFile||this.currentFile,t=this.currentFrame;e?e.elementType===Za.DOCUMENT?this.playDocument(e):e.elementType!==Za.AUDIO&&e.elementType!==Za.VIDEO||this.playMedia(e):t&&this.playFrame(t)},t.prototype.replayCurrentFrame=function(){var e=this.currentFrame;e&&this.playFrame(e)},t.prototype.dealPlayerState=function(e){var t=e.frameId,n=e.fileId,i=e.tempFileId,r=t?this.upime.elementManager.getElementById(t):void 0,o=n?this.upime.elementManager.getElementById(n):void 0,a=i?this.upime.elementManager.getElementById(i):void 0;r!==this.currentFrame&&(this.currentFrame=r,this.currentPageIndex=this.frameList.indexOf(this.currentFrame),r&&this.upime.changeSelectFrame(r)),o!==this.currentFile&&(this.currentFile=o,this.upime.clearDocumentFileHelper()),a!==this.tempFile&&(this.tempFile=a,this.upime.clearDocumentFileHelper())},t.prototype.calcElementListInFrame=function(e){if(e.hide)return[];var t=e.getMembers().filter((function(e){return e.elementType===Za.DOCUMENT&&1===e.mode&&1===e.parseStatus||e.elementType===Za.AUDIO||e.elementType===Za.VIDEO}));return t.sort((function(e,t){var n=e.position.x-t.position.x,i=e.position.y-t.position.y;return Math.abs(n)>1?n<0?-1:1:Math.abs(i)>1?i<0?-1:1:0})),t},t.prototype.finishDocumentPlaying=function(e,t){var n=t.isNext;if(this.currentFrame&&!this.currentFrame.deleted){var i=this.calcElementListInFrame(this.currentFrame);if(e.frame===this.currentFrame||e===this.currentFile){if(0===i.length)return void this.playCurrentFrame();var r=i.indexOf(e);if(-1===r)n?this.playElement(i[0]):this.playCurrentFrame();else{var o=n?r+1:r-1;if(-1===o)return void this.playCurrentFrame();if(o===i.length)return void this.nextPage();this.playElement(i[o])}}else!this.currentFile||this.currentFile.deleted||this.currentFile.frame!==this.currentFrame?this.playCurrentFrame():this.playElement(this.currentFile)}else this.nextPage()},t.prototype.finishMediaPlaying=function(e,t){var n=t.isNext;if(this.currentFrame&&!this.currentFrame.deleted){var i=this.calcElementListInFrame(this.currentFrame),r=i.indexOf(e);if(-1===r)n?this.playElement(i[0]):this.playCurrentFrame();else{var o=n?r+1:r-1;if(-1===o)return void this.playCurrentFrame();if(o===i.length)return void this.nextPage();this.playElement(i[o])}}else this.nextPage()},t.prototype.prevStep=function(){var e=this.tempFile||this.currentFile;if(e){if(e.elementType===Za.DOCUMENT){var t=e,n=t.canPrevStep,i=t.deleted;!n||i?this.finishDocumentPlaying(t,{isNext:!1}):(t.gotoPrevStep(),this.enterImmersivePlay(t))}else if(e.elementType===Za.AUDIO||e.elementType===Za.VIDEO){var r=e;this.finishMediaPlaying(r,{isNext:!1})}}else this.currentFrame&&this.prevPage()},t.prototype.prevPrevStep=function(){var e=this.tempFile||this.currentFile;if(e){if(e.elementType===Za.DOCUMENT){var t=e;this.finishDocumentPlaying(t,{isNext:!1})}else if(e.elementType===Za.AUDIO||e.elementType===Za.VIDEO){var n=e;this.finishMediaPlaying(n,{isNext:!1})}}else this.prevStep()},t.prototype.nextStep=function(){var e=this.tempFile||this.currentFile;if(e){if(e.elementType===Za.DOCUMENT){var t=e,n=t.canNextStep,i=t.deleted;!n||i?this.finishDocumentPlaying(t,{isNext:!0}):(t.gotoNextStep(),this.enterImmersivePlay(t))}else if(e.elementType===Za.AUDIO||e.elementType===Za.VIDEO){var r=e;this.finishMediaPlaying(r,{isNext:!0})}}else if(this.currentFrame){var o=this.calcElementListInFrame(this.currentFrame);o.length?this.playElement(o[0]):this.nextPage()}},t.prototype.nextNextStep=function(){var e=this.tempFile||this.currentFile;if(e){if(e.elementType===Za.DOCUMENT){var t=e;this.finishDocumentPlaying(t,{isNext:!0})}else if(e.elementType===Za.AUDIO||e.elementType===Za.VIDEO){var n=e;this.finishMediaPlaying(n,{isNext:!0})}}else this.nextStep()},t.prototype.prevPage=function(){if(this.canPrev){var t=this.frameList[this.currentPageIndex-1];this.playFrame(t),e.prototype.prevPage.call(this)}},t.prototype.nextPage=function(){if(this.canNext){var t=this.frameList[this.currentPageIndex+1];this.playFrame(t),e.prototype.prevPage.call(this)}else this.onPlayEnd()},t.prototype.start=function(){e.prototype.start.call(this),0===this.frameList.length&&this.upime.addToast(O("presentation.noFrameWarning")),this.playCurrentFrame()},t.prototype.end=function(){e.prototype.end.call(this),this.exitImmersivePlay()},t.prototype.onResize=function(){this.playCurrentFrame()},t.prototype.destroy=function(){this.unsub(),this.unsubAllElementEvents(),e.prototype.destroy.call(this)},M([rl],t.prototype,"currentPageIndex",void 0),M([rl],t.prototype,"totalPageCount",void 0),M([il],t)}(rW),aW=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.upime=t,i.element=n,i.currentPageIndex=0,i.totalPageCount=0,i.currentPageIndex=n.currentPage-1,i.totalPageCount=n.totalPage;var r=[n.subscribe("documentPageChanged",(function(e){i.currentPageIndex=e.currentPage-1,i.enterImmersivePlay(e)})),n.subscribe("elementDeleted",(function(){i.exitImmersivePlay(),i.currentPageIndex=0,i.totalPageCount=1})),n.subscribe("elementRestored",(function(){i.currentPageIndex=n.currentPage-1,i.totalPageCount=n.totalPage})),n.subscribe("elementBorderBoxUpdated",(function(){i.exitImmersivePlay()}))];return i.elementEventUnsub=function(){r.forEach((function(e){return e()}))},i}return P(t,e),Object.defineProperty(t.prototype,"canNext",{get:function(){return!1===this.element.deleted&&this.element.canNextStep},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canPrev",{get:function(){return!1===this.element.deleted&&this.element.canPrevStep},enumerable:!1,configurable:!0}),t.prototype.syncPlayerState=function(){},t.prototype.playDocument=function(){var e=this.element;(e.totalPage>1||5===e.fileType)&&this.upime.enableFileHelperWidget(e),this.upime.view.playingElement=e,this.enterImmersivePlay(e),this.upime.clearSelect()},t.prototype.prevStep=function(){var e=this.element;e.canPrevStep&&(e.gotoPrevStep(),this.currentPageIndex=e.currentPage-1,this.enterImmersivePlay(e))},t.prototype.nextStep=function(){var e=this.element;e.canNextStep&&(e.gotoNextStep(),this.currentPageIndex=e.currentPage-1,this.enterImmersivePlay(e))},t.prototype.prevPrevStep=function(){this.prevStep()},t.prototype.nextNextStep=function(){this.nextStep()},t.prototype.prevPage=function(){this.prevStep()},t.prototype.nextPage=function(){this.nextStep()},t.prototype.replayCurrent=function(){this.playDocument()},t.prototype.start=function(){this.playDocument()},t.prototype.end=function(){e.prototype.end.call(this),this.exitImmersivePlay()},t.prototype.onResize=function(){this.replayCurrent()},t.prototype.destroy=function(){this.elementEventUnsub(),e.prototype.destroy.call(this)},M([rl],t.prototype,"currentPageIndex",void 0),M([rl],t.prototype,"totalPageCount",void 0),M([il],t)}(rW),sW=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.upime=t,i.element=n;var r=[n.subscribe("elementDeleted",(function(){i.exitImmersivePlay()})),n.subscribe("elementBorderBoxUpdated",(function(){i.exitImmersivePlay()}))];return i.elementEventUnsub=function(){r.forEach((function(e){return e()}))},i}return P(t,e),t.prototype.syncPlayerState=function(){},t.prototype.replayCurrent=function(){this.playMedia()},t.prototype.playMedia=function(){var e=this.element;0!==e.transStatus&&1!==e.transStatus||this.upime.enableFileHelperWidget(e),this.upime.view.playingElement=e,this.enterImmersivePlay(e),this.upime.clearSelect(),this.syncPlayerState()},t.prototype.start=function(){this.playMedia()},t.prototype.end=function(){e.prototype.end.call(this),this.exitImmersivePlay()},t.prototype.onResize=function(){this.replayCurrent()},t.prototype.destroy=function(){this.elementEventUnsub(),e.prototype.destroy.call(this)},t}(rW),lW=function(){function e(e,t){var n=this;this.upime=e,this.element=t,this.enteredFullScreen=!1,this.checkAutoHide=function(){n.autoHideTimer&&clearTimeout(n.autoHideTimer),n.upime.hideAllControls(!1),n.upime.view.setCursor("",n),n.autoHideTimer=window.setTimeout((function(){n.autoHideTimer=void 0;var e=n.upime,t=e.toolbarOpened,i=e.leftSideOpened,r=e.t_timerOpened,o=e.xmode;t||i||r||"laser"===o||(n.upime.hideAllControls(!0),n.upime.view.setCursor("none",n))}),3e3)},this.initPlayer(),_e.isTouchSupported||(window.addEventListener("click",this.checkAutoHide,!0),window.addEventListener("mousemove",this.checkAutoHide,!0));var i=[e.subscribe("boardResized",(function(){n.fullscreenChange(J())})),e.subscribe("xmodechange",(function(){"laser"===e.prexmode&&n.checkAutoHide()})),e.registerHotKey({key:"Escape"},(function(){e.endPresentation()}))];this.unsub=function(){return i.forEach((function(e){return e()}))},this.currentPlayer.start(),J()&&(e.screenPlayMode=!0,this.enteredFullScreen=!0),ee(!0,e.onFullScreenChange)}return Object.defineProperty(e.prototype,"framePlayer",{get:function(){return this._framePlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentPlayer",{get:function(){return this._documentPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaPlayer",{get:function(){return this._mediaPlayer},enumerable:!1,configurable:!0}),e.prototype.initPlayer=function(){var e,t=this,n=this.element,i=this.upime,r=n.elementType;r===Za.FRAME?(this._framePlayer=new oW(i,n),e=this._framePlayer):r===Za.DOCUMENT?(this._documentPlayer=new aW(i,n),e=this._documentPlayer):(this._mediaPlayer=new sW(i,n),e=this._mediaPlayer),this.currentPlayer=e,e.onPlayEnd=function(){i.hideControls&&t.checkAutoHide()}},e.prototype.fullscreenChange=function(e){e||!this.enteredFullScreen?(this.upime.screenPlayMode=e,e&&(this.enteredFullScreen=!0),this.currentPlayer.onResize()):this.upime.endPresentation()},e.prototype.handlePrev=function(e){this.currentPlayer.handlePrev(e)},e.prototype.handleNext=function(e){this.currentPlayer.handleNext(e)},e.prototype.dealPlayerState=function(e){this.currentPlayer.dealPlayerState(e)},e.prototype.changePlayElement=function(e){e!==this.element?(this.currentPlayer.end(),this.currentPlayer.destroy(),this.element=e,this.initPlayer(),this.currentPlayer.start()):this.currentPlayer.replayCurrent()},e.prototype.destroy=function(){var e=this.upime,t=this.currentPlayer;this.upime.view.setCursor("",this),t.end(),t.destroy(),e.screenPlayMode=!1,e.hideAllControls(!1),ee(!1,e.onFullScreenChange),this.unsub(),clearTimeout(this.autoHideTimer),window.removeEventListener("click",this.checkAutoHide,!0),window.removeEventListener("mousemove",this.checkAutoHide,!0)},M([rl],e.prototype,"currentPlayer",void 0),M([il],e)}(),cW=function(){function e(e){var t,n=this;this.upime=e,this.dealPlayerState=function(e){n._framePlayer.dealPlayerState(e)},this.handlePrev=function(e){n._framePlayer.handlePrev(e)},this.handleNext=function(e){n._framePlayer.handleNext(e)};var i=null!==(t=e.lastFrame)&&void 0!==t?t:e.elementManager.sequentialFrames[0];this._framePlayer=new oW(e,i)}return Object.defineProperty(e.prototype,"framePlayer",{get:function(){return this._framePlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPlayer",{get:function(){return this._framePlayer},enumerable:!1,configurable:!0}),e}(),uW={start_btn:"start_btn_2xPSl",control_bar:"control_bar_2GNJS",btn:"btn_XxtUf",btn_icon:"btn_icon_2ym5R",btn_sm:"btn_sm_2iT5K",setting_panel:"setting_panel_11GAp",label:"label_3yVEf",label_content:"label_content_3C8uG",switch_btn:"switch_btn_32uwa",on:"on_1GpqW",stop_btn:"stop_btn_2CADH",iconWrap:"iconWrap_2KJpW",iconWrapActive:"iconWrapActive_3X4RO"},dW="btn_1GO1Z",pW="btn_icon_1H0aX",hW="btn_sm_70fgs",fW="iconWrap_3PXPZ",mW="iconWrapDisabled_1IWwT",vW=function(t){var n=t.paginator,i=t.className;al(n);var r=n.canPrev,o=n.canNext,a=n.currentPageIndex,s=n.totalPageCount,l=W().getUpimeTrans,c=e.useContext(xl).upime,u=0===s?l("presentation.noFrame"):"".concat(a+1," / ").concat(s);return e.createElement("div",{className:j("root_2uqfG",i)},e.createElement("div",{className:j(dW,hW,fW,!r&&mW),onClick:function(){c.followManager.forcedFollowing?c.addToast(l("meeting.view.locked.view.hint")):n.prevPage()}},e.createElement(hl,{className:pW,icon:"fanhui"})),e.createElement(Dl,{content:l("presentation.backToCurrentPlaying"),placement:"top"},e.createElement("div",{className:j("slide_info_2sd3p",fW),onClick:function(){c.followManager.forcedFollowing?c.addToast(l("meeting.view.locked.view.hint")):!0===n.isFramePaginator?n.replayCurrentFrame():n.replayCurrent()}},u)),e.createElement("div",{className:j(dW,hW,fW,!o&&mW),onClick:function(){c.followManager.forcedFollowing?c.addToast(l("meeting.view.locked.view.hint")):n.nextPage()}},e.createElement(hl,{className:j(pW,Ml.rotateY180),icon:"fanhui"})))},gW=function(t){var n,i=t.upime,r=t.className;al(i,["standardPresentation","meetingPresentation"]);var o,a,s,l,c=e.useReducer((function(e){return e+1}),0)[1],u=i.standardPresentation,d=i.meetingPresentation,p=null!=u?u:d,h=W().getUpimeTrans,f=yh(!0),m=f.hide,v=f.toggleHide,g=f.skipRef,y=(o={left:8},a=e.useRef(null),s=e.useContext(Ic).rootContainer,l=e.useCallback((function(){if(null!==a.current&&null!==s.current){var e=a.current,t=s.current,n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.left;void 0!==o.left&&(r=Math.max(i.left+o.left,r)),void 0!==o.right&&(r=Math.min(i.right-o.right-n.width,r));var l=n.top;void 0!==o.top&&(l=Math.max(i.top+o.top,l)),void 0!==o.bottom&&(l=Math.min(i.bottom-o.bottom-n.height,l));var c=r-n.left,u=l-n.top;e.style.transform="translate(".concat(c,"px, ").concat(u,"px)")}}),[]),e.useLayoutEffect((function(){return l(),window.addEventListener("resize",l),function(){return window.removeEventListener("resize",l)}}),[]),e.useCallback((function(e){a.current=e,l()}),[])),b=void 0!==d||(null==u?void 0:u.currentPlayer)instanceof oW,E=(null==u?void 0:u.currentPlayer)instanceof aW,x=(b||E)&&void 0!==p,w=void 0!==u||void 0!==d&&(null===(n=i.meetingManager.meetingChannel)||void 0===n?void 0:n.curViewSrc)===i.localUserInfo.loginName,C=void 0!==u&&void 0===d;return e.createElement("div",{className:j(uW.control_bar,r)},x&&e.createElement(vW,{paginator:p.currentPlayer}),w&&e.createElement("div",{ref:g},e.createElement(Dl,{content:h("presentation.settings"),placement:"top"},e.createElement("div",{className:j(uW.btn,uW.setting_btn,Ml.btn_style,uW.iconWrap,!1===m&&uW.iconWrapActive),onClick:v},e.createElement(hl,{className:uW.btn_icon,icon:"shezhi"}))),!1===m&&e.createElement("div",{className:uW.setting_panel,ref:y},e.createElement("div",{className:uW.label},e.createElement(hl,{className:uW.btn_icon,icon:"yanshiheibian"}),e.createElement("span",{className:uW.label_content},h("presentation.settings.focusMode"))),e.createElement("div",{className:j(uW.switch_btn,i.view.isImmersivePlayingEnabled&&uW.on),onClick:function(){!0==!i.view.isImmersivePlayingEnabled?(i.view.enableImmersivePlaying(!0),null==p||p.currentPlayer.replayCurrent()):(i.view.enableImmersivePlaying(!1),i.view.exitImmersivePlay()),c()}}))),C&&e.createElement(Dl,{content:h("presentation.close"),placement:"top"},e.createElement("div",{className:j(uW.btn,uW.stop_btn,Ml.btn_style,uW.iconWrap),onClick:function(){return i.endPresentation()}},e.createElement(hl,{className:uW.btn_icon,icon:"icontingzhi"}))))},yW=function(t){var n=t.upime;al(n,["presentation"]);var i=W().getUpimeTrans,r=n.standardPresentation;return e.createElement(ul,{type:r?"danger":"primary",className:j(uW.start_btn,Ml.btn_style),onClick:function(){void 0===r?(n.startPresentation(),_c("cv_sidebar_play",{in_meeting:"否"})):n.endPresentation()}},e.createElement(hl,{icon:r?"tingzhibofang":"yanjiangmoshi"}),e.createElement("span",null,i(r?"frameList.stopPresentation":"frameList.playPresentation")))},bW=function(e){function t(t,n,i){var r=e.call(this)||this;r.view=i,r.renderer=EW,r.renderKey="user-cursor-".concat(t.loginName),r.loginName=t.loginName,r.userName=t.userName,r.userBackground=t.color,r.loginName=t.loginName,r.cursorCanvasPosition=n;var o,a=i.viewWidth,s=i.viewHeight;return r.actualCursorCanvasPosition={x:a,y:s},r.setPosition(n),r.cursorImg=tr((o=pr(r.userBackground),"data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 14" width="15" height="14"><path d="M.97 6.547 13.814.554a.5.5 0 0 1 .671.65l-2.4 5.599a.5.5 0 0 0 0 .394l2.4 5.599a.5.5 0 0 1-.671.65L.971 7.453a.5.5 0 0 1 0-.906Z" fill="'.concat(o,'"></path></svg>')))),er(r.cursorImg,(function(){r.view.updateWidgetCvs()})),r}return P(t,e),t.prototype.setPosition=function(e){var t=this.cursorCanvasPosition;t.x===e.x&&t.y===e.y||(this.cursorCanvasPosition=e,this.updateActualPosition())},t.prototype.updateActualPosition=function(){var e,t=this;null===(e=this.cancelAnimation)||void 0===e||e.call(this);var n=this.actualCursorCanvasPosition,i=this.cursorCanvasPosition;this.cancelAnimation=Ll([n.x,n.y],[i.x,i.y],(function(e){var n=e[0],i=e[1];t.actualCursorCanvasPosition={x:n,y:i},t.view.updateWidgetCvs()}),400)},t}(el),EW=function(e){var t=e.element,n=e.upime,i=t.userName,r=t.userBackground,o=t.actualCursorCanvasPosition,a=t.loginName;if(n.laserManager.hasPen(a))return null;var s=t.useMemo("nameData",(function(){var e=df.getFont(He),t={text:i,fontSize:12,fontFamily:e.family,textWidth:184,lineHeight:15.6,lineClamp:2};t.metrics=Da(t);var n=t.metrics.height;return{textData:t,nameRect:{width:t.metrics.width+16,height:n+2}}}),[i]),l=s.textData,c=s.nameRect,u=n.view.viewWidth,d=n.view.viewHeight,p=u-c.width-28,h=d-c.height-28,f=n.view.getScreenPosition(o),m={x:f.x+8,y:f.y+16},v=f.x,g=f.y+7.5,y=m.x,b=m.y,E=54;m.x<28?(v=(y=28)-5-15,g=b+c.height/2,E=0):f.x>p&&(v=(y=p)+c.width+5+15,g=b+c.height/2,E=180),m.y<28?(b=28,v=y+c.width/2,g=b-5-15,E=90):m.y>h&&(b=h,v=y+c.width/2,g=b+c.height+5+15,E=270);var x=v,w=g;fa({x:y,y:b}),Na((function(e){var t=c.height>17.6?4:c.height/2,n=c.width,i=c.height;e.clear(),e.beginFill(r),e.moveTo(t,0),e.arcTo(n,0,n,t,t),e.arcTo(n,i,n-t,i,t),e.arcTo(0,i,0,t,t),e.arcTo(0,0,t,0,t),e.closePath(),e.endFill()})),Ra(l,{fill:"#000000",ha:"left",x:8,y:1}),ma(),fa({rotation:E,x:x,y:w,pivotX:x,pivotY:w}),Oa({x:v-7,y:g-7.5,width:14,height:15,src:t.cursorImg}),ma()},xW=function(){function e(e){var t=this;this.upime=e,this.cursorsActive=!1,this.active=!1,this.cursorForceDisplayUsers=new Set,this.updateCursorWrapper=this.updateCursor.bind(this),this.cursors=new Map,this.cursorSubService=e.createUserCursorService(1,(function(e){return t.messageHandler(e)})),!this.upime.phoneMode&&this.cursorSubService.open()}return e.prototype.messageHandler=function(e){switch(e.type){case ts.NOTICE:var t=e.loginName,n=e.cursorCanvasPosition;if(!this.active&&!this.cursorForceDisplayUsers.has(t))return;var i=this.cursors.get(t);if(t!==this.upime.localUserInfo.loginName){if(i)i.setPosition(n);else{var r=this.upime.userManager.getUser(t),o=new bW(r,n,this.upime.view);this.cursors.set(t,o),this.upime.view.addCanvasWidget(o)}this.upime.view.updateWidgetCvs()}break;case ts.REPORT_SIGNAL:this.startSendCursorPostion()}},e.prototype.updateCursorUserName=function(e,t){var n=this.cursors.get(e);n&&(n.userName=t)},e.prototype.updateCursor=function(){if(!window._stop_cursor_){var e=this.upime.view.getAbsolutePosition(this.upime.userEventManager.mousePosition),t=e.x,n=e.y;t=Math.round(t),n=Math.round(n),this.prevSendCursor&&t===this.prevSendCursor.x&&n===this.prevSendCursor.y||(this.prevSendCursor={x:t,y:n},this.cursorSubService.reportCursorPosition({x:t,y:n}))}},e.prototype.setCursorsShow=function(e,t){return void 0===t&&(t=!1),A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return t&&(this.cursorsActive=e),e?[4,this.cursorSubService.subscribe()]:[3,2];case 1:return n.sent()?(this.upime.addToast(O("userCursor.subscribe.failed")),[2]):(this.active=e,[3,3]);case 2:this.active=e,this.cursorSubService.unsubscribe(),this.resetCursors(),this.upime.view.update(),n.label=3;case 3:return[2]}}))}))},e.prototype.showCursors=function(e){return void 0===e&&(e=!1),A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.setCursorsShow(!0,e)]}))}))},e.prototype.hideCursors=function(e){void 0===e&&(e=!1),this.setCursorsShow(!1,e)},e.prototype.restoreCursors=function(){!this.active&&this.cursorsActive&&this.setCursorsShow(!0)},e.prototype.startSendCursorPostion=function(){this.cursorSendInterval||(this.cursorSendInterval=window.setInterval(this.updateCursorWrapper,200))},e.prototype.stopSendCursorPostion=function(){this.cursorSendInterval&&(window.clearInterval(this.cursorSendInterval),this.cursorSendInterval=void 0)},e.prototype.removeUserCursor=function(e){var t=this.cursors.get(e);t&&(this.upime.view.removeCanvasWidget(t),this.cursors.delete(e))},e.prototype.resetCursors=function(){var e=this;Array.from(this.cursors.keys()).forEach((function(t){var n=e.cursors.get(t);n&&(e.cursorForceDisplayUsers.has(t)||(e.upime.view.removeCanvasWidget(n),e.cursors.delete(t)))}))},e.prototype.destroy=function(){this.resetCursors(),this.active=!1,this.cursorsActive=!1,this.prevSendCursor=void 0,this.cursorForceDisplayUsers.clear(),this.setCursorsShow(!1),this.stopSendCursorPostion()},e.prototype.addForceDisplayUser=function(e){this.cursorForceDisplayUsers.add(e)},e.prototype.removeForceDisplayUser=function(e){var t=this;this.cursorForceDisplayUsers.delete(e),this.active||this.cursors.forEach((function(n){n.loginName===e&&(t.upime.view.removeCanvasWidget(n),t.cursors.delete(e))}))},M([rl],e.prototype,"active",void 0),M([il],e)}(),wW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e[0];switch(t){case ts.NOTICE:var n=e[1],i=e[2];return{type:t,loginName:n,cursorCanvasPosition:{x:i[0],y:i[1]}};case ts.REPORT_SIGNAL:return{type:t}}},t.prototype.reportCursorPosition=function(e){this.sendSCmd(ns.REPORT,[e.x,e.y])},t.prototype.subscribe=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(es.SUBSCRIBE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.unsubscribe=function(){this.sendSCmd(ns.CANCEL)},t.prototype.close=function(){e.prototype.close.call(this)},t}(Sp);function CW(t){var n=t.content;return e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},e.createElement(hl,{icon:"yidongduanshoushidianji"}),e.createElement("div",null,n))}var SW,kW=function(t){function n(e){var n=t.call(this,e)||this;return n._attachCandidate=void 0,n._curDraft=null,n.draftCommentColor=0,n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"comment"===e?n.listenToEvents(!0):(n.upime.elementManager.getAllElements().forEach((function(e){return e.showAttachComment=!1})),n.upime.updateView(),n.listenToEvents(!1))})),n.handleEsc=function(){n._curDraft?n.onDiscardDraft():(n.upime.switchMode("select"),n.resetCandidate(),n.upime.updateView())},n.onFinishDraft=function(e,t){return void 0===t&&(t=!1),A(n,void 0,void 0,(function(){var e,n,i,r,o,a,s,l,c,u,d,p=this;return D(this,(function(h){switch(h.label){case 0:return this.upime.phoneMode?[4,this.upime.closePhoneDrawer()]:[3,3];case 1:return h.sent(),[4,Dc(.3)];case 2:h.sent(),h.label=3;case 3:return(e=this._curDraft)?this.upime.phoneMode&&!t||!e.dirty&&!e.appendFiles?[3,8]:(n=this.upime.createOperation(),i=n.create(Za.COMMENT,{position:e.position,zIndex:this.upime.newMaxZindex(),attached:e.attached,color:this.draftCommentColor,resolved:!1,relativePos:e.relativePos}),(r=this.upime.elementManager.getElementById(e.attached))&&(i.attachedElement=r,this.upime.elementManager.addElementAttachedComment(r,i)),e.appendFiles?[3,4]:(o=e.curValue,a={type:TI.TEXT,elmId:i.id,content:JSON.stringify(o),at:i.extractMentionPeople(o)},this.upime.commentManager.updateCommentMsg(a),i.empty=!1,n.sync(),this.upime.elementManager.openComment(i),i.expanded=!0,i.dealSelfOpenClose(),[3,8])):[3,8];case 4:s=function(t){var r,o,a;return D(this,(function(s){switch(s.label){case 0:return[4,e.getMediaInfo(t)];case 1:return r=s.sent(),o=Jo(t.name),a={type:r.type,elmId:i.id,pending:{request:function(e,n){return p.upime.saveFile(1,{file:t,ext:o,fakeName:"".concat(p.upime.genFileName(""),".").concat(o)},n,e)},progress:0},append:r.append},l.upime.commentManager.updateCommentMsg(a),i.curValue=e.curValue,i.empty=!1,n.sync(),l.upime.elementManager.openComment(i),i.expanded=!0,i.dealSelfOpenClose(),[2]}}))},l=this,c=0,u=e.appendFiles,h.label=5;case 5:return c<u.length?(d=u[c],[5,s(d)]):[3,8];case 6:h.sent(),h.label=7;case 7:return c++,[3,5];case 8:return this.onDiscardDraft(),[2]}}))}))},n.onDiscardDraft=function(){n.upime.view.curCommentDraft=null,n._curDraft=null,n.resetCandidate(),n.upime.updateView()},n.insertComment=function(e){if(n._curDraft)n._curDraft.curValue?n.onFinishDraft():n.onDiscardDraft();else{if(n.upime.saveComment())return;var t=n.upime.getTopmostCommentByPos(e.globalPosition);if(t)return n.resetCandidate(),void n.upime.expandComment(t);if(n.upime.getAllComments((function(e){return e.expanded&&!e.pined})).length)return n.resetCandidate(),void n.upime.collapseComments();var i=n.upime.getCommentDestination(e.position),r=i.position,o=i.attachElement,a=i.refSystem;if(n._attachCandidate=o,n._curDraft=new kP(n.upime,"temp"),n._curDraft.type="draft",n._curDraft.color=n.draftCommentColor,n._curDraft.onFinishDraft=n.onFinishDraft,n._curDraft.position=r,a&&(n._curDraft.parentRefSystem=a),n._curDraft.escapeHandler=n.handleEsc,o){var s=i.relativePos;o.showAttachComment=!0,n._curDraft.attached=o.id,n._curDraft.relativePos=s}n.upime.elementManager.insertCommentDraft(n._curDraft),n.resetCandidate(),n.upime.switchMode("select"),n.upime.phoneMode&&n.upime.showPhoneDrawer(NI,{upime:n.upime,element:n._curDraft},{supportSwipe:!1,coverVisible:!1}),n.upime.updateView()}},n.createCommentOnElement=function(e,t){if(n.resetCandidate(),n.onDiscardDraft(),n._curDraft=new kP(n.upime,"temp"),n._curDraft.type="draft",n._curDraft.color=n.draftCommentColor,n._curDraft.onFinishDraft=n.onFinishDraft,n._curDraft.escapeHandler=n.handleEsc,!t){var i=e.getGlobalBox();t=e.elementType===Za.KANBAN?{x:(i.right+i.left)/2,y:i.top+27*e.scale}:{x:(i.right+i.left)/2,y:(i.bottom+i.top)/2}}var r=n.upime.getCommentDestination(t),o=r.position,a=r.refSystem;(null==a?void 0:a.baseElement)===e?(n._curDraft.parentRefSystem=a,n._curDraft.position=o):(n._curDraft.attached=e.id,n._curDraft.relativePos=n._curDraft.getCandidateRelativePos(t,e)),n.upime.elementManager.insertCommentDraft(n._curDraft),n.upime.switchMode("select"),n.upime.updateView()},n.onMouseMove=function(e){n.resetCandidate();var t=n.upime.getCommentDestination(e.position),i=t.attachElement,r=t.refSystem;i?n._attachCandidate=i:(null==r?void 0:r.baseElement)&&(n._attachCandidate=r.baseElement),n._attachCandidate&&(n._attachCandidate.showAttachComment=!0),n.upime.updateView()},n.upime=e,"comment"===e.xmode&&n.listenToEvents(!0),n}return P(n,t),Object.defineProperty(n.prototype,"curUnsavedDraft",{get:function(){return!!this._curDraft},enumerable:!1,configurable:!0}),n.prototype.setDraftCommentColor=function(e){this.draftCommentColor=e},n.prototype.listenToEvents=function(t){var n,i=this;if(t){this.cModeUnsubs&&this.cModeUnsubs();var r=[this.upime.userEventManager.subscribe("click",this.insertComment),this.upime.userEventManager.subscribe("mousemove",this.onMouseMove)];if(this.upime.phoneMode){var o=this.upime.addToast(e.createElement(CW,{content:O("common.tap.insert")}),{autoHide:!1,top:16,style:{borderRadius:"20px",padding:"8px 16px 8px 10px",zIndex:20}}),a=this.upime.userEventManager.subscribe("moveto",(function(e){i.upime.dealMove(e)}));r.push((function(){return i.upime.removeToast(o)})),r.push(a)}this.cModeUnsubs=function(){return r.forEach((function(e){return e()}))}}else null===(n=this.cModeUnsubs)||void 0===n||n.call(this)},n.prototype.resetCandidate=function(){this._attachCandidate&&(this._attachCandidate&&(this._attachCandidate.showAttachComment=!1),this._attachCandidate=void 0)},n.prototype.destroy=function(){var e;this.unsub_xmode(),null===(e=this.cModeUnsubs)||void 0===e||e.call(this)},n}(zd),_W=function(){function e(e){var t=this;this.upime=e,this.totalUnreadCount=0,this.commentMsgMap={},this.commentsLastOpenMap={},this.allCommentsHided=!1,this.resolvedHided=!1,this._uploadingAbortMap={},this._latestStatusMap=null,this._commentSubService=e.createCommentService(2,(function(e){return t._messageHandler(e)})),this._commentSubService.open()}return e.prototype.hideAllComments=function(e){var t=this;this._latestStatusMap=null,this.upime.collapseComments(),this.upime.getAllComments((function(e){return!(e.pined||t.resolvedHided&&e.resolved)})).forEach((function(t){return t.visible=!e})),this.allCommentsHided=e,this.upime.updateView()},e.prototype.hideResolvedComments=function(e){if(!this.allCommentsHided){var t=this.upime.getAllComments((function(e){return e.resolved&&!e.pined}));t.length&&this.upime.collapseComments(t.map((function(e){return e.id}))),t.forEach((function(t){return t.visible=!e})),this.upime.updateView()}this.resolvedHided=e},e.prototype.muteAllComments=function(e){if(e)this._latestStatusMap=this.upime.getAllComments((function(e){return!e.pined})).reduce((function(e,t){var n,i=exports.E(exports.E({},e),((n={})[t.id]=t.visible,n));return t.visible=!1,i}),{}),this.allCommentsHided=!0,this.upime.updateView();else if(this._latestStatusMap&&this.allCommentsHided){this.allCommentsHided=!1;var t=this.upime.getAllComments().reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t.id]=t,n))}),{});Object.entries(this._latestStatusMap).forEach((function(e){var n=e[0],i=e[1];t[n].visible=i})),this.upime.updateView()}},e.prototype.updateUnreadCount=function(e){var t=this;void 0===e&&(e=[]);var n=Object.keys(this.commentMsgMap);e.length&&(n=n.filter((function(t){return e.includes(t)})));var i=this.upime.getAllComments((function(e){return n.includes(e.id)}));i.forEach((function(e){var n,i=t.commentsLastOpenMap[e.id]||0,r=(null!==(n=t.commentMsgMap[e.id])&&void 0!==n?n:[]).filter((function(e){return!e.deleted&&e.id})),o=0;e.empty=!1,r.forEach((function(e){e.createTime>=i&&o++})),e.unreadCount=o})),this._statisticTotalUnread(),this.upime.updateView()},e.prototype._statisticTotalUnread=function(){var e=this;this.totalUnreadCount=this.upime.getAllComments((function(t){return Object.keys(e.commentMsgMap).includes(t.id)})).reduce((function(e,t){return e+t.unreadCount}),0)},e.prototype._messageHandler=function(e){var t=this;switch(e.type){case is.LAST_OPEN_TIME_MAP:this.commentsLastOpenMap=e.lastOpenMap,0!==Object.keys(this.commentMsgMap).length&&this.updateUnreadCount();break;case is.ALL_COMMENT_MESSAGE:this.commentMsgMap=e.allCommentMsgs,Object.keys(this.commentMsgMap).forEach((function(e){void 0===t.commentsLastOpenMap[e]&&(t.commentsLastOpenMap[e]=0),t.upime.publish("commentMessagesUpdate",e)})),this.updateUnreadCount();break;case is.UPDATE_COMMENT_MESSAGE:var n=e.message,i=this.commentMsgMap[e.commentId];if(void 0===this.commentsLastOpenMap[e.commentId]&&(this.commentsLastOpenMap[e.commentId]=0),i)if(a=i.find((function(e){return e.id===n.id})))a.content=n.content,a.updateTime=n.updateTime,a.deleted=n.deleted;else{var r=i.findIndex((function(e){return void 0!==e.id&&e.id>n.id}));-1!==r?i.splice(r,0,n):i.push(n)}else this.commentMsgMap[e.commentId]=[n];this.commentMsgMap[e.commentId]=R([],this.commentMsgMap[e.commentId],!0);var o=this.upime.getAllComments((function(t){return t.id===e.commentId}))[0];o&&(o.expanded?this.reportLastOpen(o.id).then((function(){t.updateUnreadCount([o.id]),t.upime.publish("commentMessagesUpdate",e.commentId)})):this.updateUnreadCount([o.id])),this.upime.publish("commentMessagesUpdate",e.commentId);break;case is.MEDIA_TRANS_MESSAGE:var a,s=e.commentId,l=e.messageId,c=e.transStatus,u=e.duration;(a=(i=this.commentMsgMap[s]).find((function(e){return e.id===l})))&&(a.append.transStatus=c,a.append.duration=u),this.commentMsgMap[s]=R([],this.commentMsgMap[s],!0),this.upime.publish("commentMessagesUpdate",s)}},e.prototype.reportLastOpen=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this._commentSubService.reportLastOpen(e)];case 1:return t=n.sent(),this.commentsLastOpenMap[e]=t,this.updateUnreadCount([e]),[2]}}))}))},e.prototype.updateCommentMsg=function(e){var t;return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u,d,p,h,f,m=this;return D(this,(function(v){switch(v.label){case 0:return e.messageId?(i=this.commentMsgMap[e.elmId].find((function(t){return t.id===e.messageId||(t.key===e.messageId?(n=!0,!0):void 0)})))?(e.type===TI.TEXT&&(i.content=e.content,i.at=e.at),i.updateTime=Date.now(),i.deleted=!!e.deleted,e.type!==TI.TEXT&&e.deleted&&(null===(t=e.abort)||void 0===t||t.call(e)),this.upime.publish("commentMessagesUpdate",e.elmId),n?[3,2]:[4,this._commentSubService.updateCommentMsg(e)]):[3,3]:[3,4];case 1:return a=v.sent(),e.type!==TI.TEXT&&this.upime.addToast(O("comment.file.deleted.hint"),{type:"normal"}),i.updateTime=a.updateTime,this.upime.publish("commentMessagesUpdate",e.elmId),[3,3];case 2:this.upime.addToast(O("comment.pending.deleted.hint")),v.label=3;case 3:return[3,8];case 4:return r=this.upime.getCurServerTime(),e.type!==TI.TEXT?[3,6]:(o=exports.E({commentator:this.upime.localUserInfo.loginName,deleted:!1,createTime:r,key:"local_".concat(r)},e),this.commentMsgMap[e.elmId]=R(R([],this.commentMsgMap[e.elmId]||[],!0),[o],!1),this.upime.publish("commentMessagesUpdate",e.elmId),[4,this._commentSubService.updateCommentMsg(e)]);case 5:return a=v.sent(),this.reportLastOpen(e.elmId),s=this.commentMsgMap[e.elmId],-1!==(l=s.indexOf(o))&&(s[l]=a),this.commentMsgMap[e.elmId]=R([],this.commentMsgMap[e.elmId],!0),this.upime.publish("commentMessagesUpdate",e.elmId),[3,7];case 6:c="local_".concat(r),u={type:e.type,commentator:this.upime.localUserInfo.loginName,deleted:!1,createTime:r,key:c,pending:e.pending,append:e.append},d=function(t,n){return function(){var i=m;return u.failed=!1,u.abort=n,m._uploadingAbortMap[c]=n,u.pending.request(t,(function(e){u.pending.progress=e})).then((function(t){return A(m,void 0,void 0,(function(){var n,r;return D(this,(function(o){switch(o.label){case 0:return u.append.fileId=t,u.finished=!0,u.failed=!1,delete u.pending,delete this._uploadingAbortMap[c],"local_record"===e.append.audioType||e.type!==TI.AUDIO&&e.type!==TI.VIDEO?[3,2]:[4,i.upime.transcodeMedia(t)];case 1:if(!(n=o.sent()))return this.commentMsgMap[e.elmId]=this.commentMsgMap[e.elmId].filter((function(e){return e.id!==u.id})),this.upime.publish("commentMessagesUpdate",e.elmId),this.upime.addToast(O("toolbar.upload.transcodingFailed")),[2];e.append.transStatus=n.status,e.append.estimateCompleteTime=n.estimateCompleteTime,e.append.coverInfo=n.coverInfo,o.label=2;case 2:return[4,i._commentSubService.updateCommentMsg(e)];case 3:return r=o.sent(),i.reportLastOpen(e.elmId),Object.assign(u,r),i.commentMsgMap[e.elmId]=R([],i.commentMsgMap[e.elmId],!0),i.upime.publish("commentMessagesUpdate",e.elmId),[2]}}))}))})).catch((function(){var t;u.failed=!0;var n=new Promise((function(e){return t=e}));u.pending.retry=d(n,t),i.commentMsgMap[e.elmId]=R([],i.commentMsgMap[e.elmId],!0),i.upime.publish("commentMessagesUpdate",e.elmId)}))}},h=new Promise((function(e){return p=e})),d(h,p)(),this.commentMsgMap[e.elmId]=R(R([],this.commentMsgMap[e.elmId]||[],!0),[u],!1),this.upime.publish("commentMessagesUpdate",e.elmId),v.label=7;case 7:f=this.upime.getAllComments((function(t){return t.id===e.elmId}))[0],f&&f.resolved&&f.setResolved(!1),v.label=8;case 8:return[2]}}))}))},e.prototype.readAllMessages=function(){return A(this,void 0,void 0,(function(){var e,t=this;return D(this,(function(n){switch(n.label){case 0:return[4,this._commentSubService.readAllMessages()];case 1:return e=n.sent(),Object.keys(this.commentsLastOpenMap).forEach((function(n){t.commentsLastOpenMap[n]=e})),this.updateUnreadCount(),[2]}}))}))},e.prototype.parseCommentTextContent=function(e){var t=this,n=this.commentMsgMap[e];if(!n)return[];var i=n.reduce((function(e,n){var i,r;if(n.type!==TI.TEXT)return e;var o=oa(n.content);if(!o)return e;var a=function(e){var t="",n=function(e){for(var i=0,r=e;i<r.length;i++){var o=r[i];if(o.text)t+=o.text;else switch(o.type){case"mention":t+="@"+o.userName+" ";break;case"url":t+=o.url;break;case"paragraph":Array.isArray(o.children)&&n(o.children),t+="\n"}}};return n(e),t.endsWith("\n")&&(t=t.slice(0,t.length-1)),t}(o),s={id:null!==(i=n.id)&&void 0!==i?i:Date.now(),commentator:t.upime.getUserInfo(n.commentator).userName,content:a,createTime:n.createTime,updateTime:null!==(r=n.updateTime)&&void 0!==r?r:Date.now()};return R(R([],e,!0),[s],!1)}),[]);return i},e.prototype.destroy=function(){this._commentSubService.close(),Object.values(this._uploadingAbortMap).forEach((function(e){return e()}))},M([rl],e.prototype,"totalUnreadCount",void 0),M([rl],e.prototype,"allCommentsHided",void 0),M([rl],e.prototype,"resolvedHided",void 0),M([il],e)}(),TW=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case is.LAST_OPEN_TIME_MAP:return{type:t[0],lastOpenMap:t[1]};case is.ALL_COMMENT_MESSAGE:return{type:t[0],allCommentMsgs:t[1]};case is.UPDATE_COMMENT_MESSAGE:return{type:t[0],commentId:t[1],message:t[2]};case is.MEDIA_TRANS_MESSAGE:return{type:t[0],commentId:t[1],messageId:t[2],transStatus:t[3],duration:t[4]}}},t.prototype.updateCommentMsg=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return t=exports.E(exports.E({},e),e.type!==TI.TEXT&&{append:exports.E(exports.E({},e.append),{localEle:void 0})}),[4,this.sendRCmd(rs.CUD_COMMENT_MESSAGE,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.reportLastOpen=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(rs.REPORT_LAST_OPEN,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.readAllMessages=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(rs.READ_ALL)];case 1:return[2,e.sent()[0]]}}))}))},t}(Sp),IW="iconBtn_30eFN",PW="footerBtn_1Hzla",NW="avatar_btGwc",MW="participantRow_tu-s0",AW="selected_rnhTn",DW="dagou_10DQi";function RW(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return SW?[2,SW]:[4,Promise.resolve().then((function(){return require("./index-86c40b3c.js")})).then((function(e){return e.index}))];case 1:return SW=e.sent().default,[2]}}))}))}var BW,LW=new Map,OW=function(e){var t;return!1===LW.has(e)&&void 0!==SW&&LW.set(e,SW(e.toLowerCase(),{style:SW.STYLE_NORMAL}).flat().join("")),null!==(t=LW.get(e))&&void 0!==t?t:e};function FW(e,t){for(var n,i,r=OW(e.userName),o=OW(t.userName),a=r[Symbol.iterator](),s=o[Symbol.iterator](),l=a.next(),c=s.next(),u=0;0===u&&!0!==l.done&&!0!==c.done;)u=(null!==(n=l.value.codePointAt(0))&&void 0!==n?n:0)-(null!==(i=c.value.codePointAt(0))&&void 0!==i?i:0),l=a.next(),c=s.next();return u}!function(e){e[e.commentList=1]="commentList",e[e.meetingList=2]="meetingList",e[e.extensionList=3]="extensionList"}(BW||(BW={}));var zW,HW,UW,WW,VW,jW,GW,qW,KW,YW,XW,QW=function(t){var n=t.message,i=t.domContainer,r=t.comment,o=e.useRef(r.formatContent(n.content)),a=e.useRef(null),s=W().getUpimeTrans;return e.useEffect((function(){var e;null===(e=a.current)||void 0===e||e.reset(r.formatContent(n.content))}),[n,n.content]),e.createElement(e.Fragment,null,e.createElement(bI,{initValue:o.current,ref:a,editable:!1,domContainer:i}),n.updateTime?e.createElement("span",{className:"updatedLabel_2Doah"},"(".concat(s("comment.message.updated"),")")):null)},ZW=function(t){var n=t.upime,i=t.message,r=t.unread,o=t.comment,a=t.viewportDom,s=e.useMemo((function(){return n.getUserInfo(i.commentator)}),[]);al(s);var l=e.useRef(null),c=e.useState(!1)[1];e.useEffect((function(){c(!0)}),[]);var u=e.useMemo((function(){switch(i.type){case TI.AUDIO:return"local_record"===i.append.audioType?uP:cP;case TI.FILE:return fP;case TI.IMAGE:return pP;case TI.VIDEO:return hP;default:return function(){return e.createElement(e.Fragment,null)}}}),[]);return e.createElement("div",{className:"itemRoot_3oqAr",onClick:function(){return function(){if(!n.viewLocked){n.followManager.stopFollowCurrent(),n.collapseComments([],[o.id]);var e=o.attached?n.elementManager.getElementById(o.attached):void 0;if(e){if(Bu(e)&&e.isMindmapNodeHideByCollapsed){var t=e.seekUnHideParent();return void(t&&(n.phoneMode?n.showElement(t,{left:40,top:80,bottom:80,right:40}):n.showElement(t,{left:90,right:20,top:60,bottom:60})))}if(Fu(e)&&e.isHideByFilter){var i=e.pareantKanban;return void(i&&(n.editable?n.addToast(O("kanban.setting.filter.tip")):n.addToast(O("kanban.setting.filter.noauth")),n.phoneMode?n.showElement(i,{left:40,top:80,bottom:80,right:40}):n.showElement(i,{left:90,right:20,top:60,bottom:60})))}}n.slideViewToComment(o).then((function(){return n.expandComment(o)}))}}()},ref:l},e.createElement("div",{className:"header_cIvPV"},r&&e.createElement("div",{className:"unread_2Qa3L"}),e.createElement(hl,{icon:"gou",className:j("resolved_3bLot",o.resolved&&"visible_KKdYs")}),e.createElement(ml,{url:null==s?void 0:s.avatarUrl,className:"avatar_t8Jv6"}),e.createElement("span",{className:"userName_2Ahv1"},null==s?void 0:s.userName),e.createElement("div",{className:"dateTime_38Y7k"},zI(i.createTime))),e.createElement("div",{className:"content_y-fPm"},i.type===TI.TEXT?l.current&&e.createElement(QW,{message:i,comment:o,domContainer:l.current}):e.createElement(u,{comment:o,readonly:!0,message:i,extras:{maxWidth:284,maxHeight:166},className:"listItem_1_a0G",viewportDom:a})))},JW=function(t){var n=t.comment,i=t.msgs,r=t.upime,o=t.viewportDom,a=e.useState(!1),s=a[0],l=a[1],c=i[0],u=i.slice(1),d=W().getUpimeTrans;al(n,["resolved","unreadCount"]),al(r.commentManager,["totalUnreadCount"]);var p=n.unreadCount;return e.createElement("div",{className:"itemBlockRoot_7yXam"},e.createElement(ZW,{upime:r,message:c,unread:p===i.length,comment:n,viewportDom:o}),u.length>0?e.createElement("span",{className:j("collapseLabel_1KNsg",p&&"unreadCollapse_2zGPh"),onClick:function(){return l(!s)}},s?d("comment.listMenu.foldMessages"):p?d("comment.listMenu.unfoldUnreadMessages",p===i.length?p-1:p):d("comment.listMenu.unfoldMessages",u.length)):null,s&&u.map((function(t,a){var s;return e.createElement(ZW,{upime:r,message:t,key:null!==(s=t.id)&&void 0!==s?s:t.key,unread:a+1>=i.length-p,comment:n,viewportDom:o})})))},$W=e.createContext({curUser:null,setCurUser:function(){}}),eV=e.memo((function(t){var n=t.upime,i=t.viewportDom,r=e.useState([]),o=r[0],a=r[1],s=n.commentManager;al(s,["resolvedHided"]);var l=e.useContext($W),c=l.curUser,u=l.setCurUser,d=function(){var e=!0,t=Object.entries(n.commentManager.commentMsgMap).map((function(e){var t,i=e[0],r=e[1];return{comment:null!==(t=n.getAllComments((function(e){return e.id===i}))[0])&&void 0!==t?t:null,msgs:r.filter((function(e){return!(e.type!==TI.TEXT&&e.pending||e.deleted)})),upime:n}})).filter((function(e){return e.comment&&e.msgs.length&&(!s.resolvedHided||!e.comment.resolved)})).sort((function(e,t){var n,i,r=e.msgs[e.msgs.length-1],o=t.msgs[t.msgs.length-1];return(null!==(n=null==o?void 0:o.createTime)&&void 0!==n?n:0)-(null!==(i=null==r?void 0:r.createTime)&&void 0!==i?i:0)})).filter((function(t){if(null===c)return!0;var n=t.msgs.find((function(e){return e.commentator===c.loginName}));return n&&(e=!1),!!n}));a(t),e&&u(null)};return e.useEffect((function(){d();var e=n.subscribe("commentMessagesUpdate",(function(){d()}));return function(){e()}}),[n.commentManager.commentMsgMap,s.resolvedHided,c]),e.createElement("div",{className:"listRoot_12W-t"},o.map((function(t){return e.createElement(JW,exports.E({key:t.comment.id},t,{viewportDom:i}))})))})),tV=function(t){var n=t.upime,i=W().getUpimeTrans;al(n.commentManager,["totalUnreadCount"]),al(n,["rightSlidePanelType","viewLocked"]);var r=n.commentManager.totalUnreadCount;return e.createElement(Dl,{content:i("comment.listMenu.icon.hint"),placement:"bottom",extraDistance:6},e.createElement("div",{className:j("iconContainer_2evAK","iconWrap_2PzPU",n.rightSlidePanelType===BW.commentList?"iconWrapActive_9X9U_":""),onClick:function(){_c("cv_comments"),n.switchRightSlidePanel(BW.commentList)}},e.createElement(hl,{icon:"pizhu"}),r?e.createElement("div",{className:"unreadHintContainer_SCRFL"},e.createElement("div",{className:"unreadHint_1ZtXu"}," ",r>99?"99+":r," ")):null))},nV=function(t){var n=t.upime,i=yh(!0),r=i.hide,o=i.setHide,a=i.toggleHide,s=i.skipRef,l=e.useState([]),c=l[0],u=l[1],d=e.useState(""),p=d[0],h=d[1],f=e.useRef(),m=W().getUpimeTrans,v=e.useContext($W),g=v.curUser,y=v.setCurUser,b=function(e){u(e.sort(FW))},E=function(){var e=Object.entries(n.commentManager.commentMsgMap).map((function(e){var t,i=e[0],r=e[1];return{comment:null!==(t=n.getAllComments((function(e){return e.id===i}))[0])&&void 0!==t?t:null,msgs:r}})).filter((function(e){return e.comment&&e.msgs.length&&(!n.commentManager.resolvedHided||!e.comment.resolved)})).reduce((function(e,t){return R(R([],e,!0),t.msgs,!0)}),[]).map((function(e){return e.commentator})),t=Array.from(new Set(e)).map((function(e){return n.getUserInfo(e)}));b(t),f.current=t};e.useEffect((function(){E();var e=[n.subscribe("commentMessagesUpdate",(function(){E()})),n.subscribe("updatedUserInfo",_t.debounce((function(){E()}),1e3))];return function(){e.forEach((function(e){return e()}))}}),[]);var x=m("common.suoyouren"),w=x.startsWith(p),C=e.useRef(null);return e.createElement("div",{className:"filterContainer_3-Rd6",ref:s},e.createElement("div",{className:j("condition_dLBrW",!r&&"subwinOpened_1DRes"),onClick:a},g&&e.createElement(ml,{url:g.avatarUrl,className:NW}),e.createElement("span",null,null===g?x:g.userName),e.createElement(hl,{icon:"jiantou-xia"})),!r&&e.createElement(xh,{align:"right",selfAdjust:!0,className:"participantContainer_2IQRQ"},e.createElement("div",{className:"searchContainer_110-h"},e.createElement(hl,{icon:"sousuo"}),e.createElement("input",{type:"text",placeholder:m("comment.filter.placeholder"),value:p,onChange:function(e){var t=e.target.value;h(t),b(f.current.filter((function(e){return e.userName.includes(t)})))},ref:C}),p&&e.createElement("div",{className:"clearInput_3jaHy",onClick:function(){var e;h(""),b(f.current),null===(e=C.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"}))),e.createElement("div",{className:"listContainer_39OQY"},w&&e.createElement("div",{className:j(MW,"allUsersRow_o6vJt",null===g&&AW),onClick:function(){y(null),o(!0)}},e.createElement(hl,{icon:"tuanduisuoyouchengyuan",style:{color:"#616371"}}),e.createElement("div",null,x),null===g&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",className:DW})),c.length>0&&c.map((function(t){var n=(null==g?void 0:g.loginName)===t.loginName;return e.createElement("div",{className:j(MW,n&&AW),key:t.loginName,onClick:function(){y(t),o(!0)}},e.createElement(ml,{url:t.avatarUrl,className:NW}),e.createElement("div",null,t.userName),n&&e.createElement(hl,{icon:"dagou-quxiaoyuansuxuanze",className:DW}))})),!w&&0===c.length&&e.createElement("div",{className:"noSearchResult_17Sej"},m("search.noSearchRes")))))},iV="slideInAnime_3foIX",rV="slideOutAnime_SiH7u",oV="header_qKk9X",aV="row_22xAk",sV="action_1_b8P",lV="disabled_1JF7e",cV="body_1kUzX",uV="empty_InCwa",dV="emptyPlaceholder_Tl3s0",pV="submenuRow_1KrCt",hV="onGoing_2RbKK";!function(e){e[e.PENDING=0]="PENDING",e[e.ON_GOING=1]="ON_GOING",e[e.ENDED=2]="ENDED",e[e.CANCELED=3]="CANCELED"}(zW||(zW={})),function(e){e[e.No=0]="No",e[e.Yes=1]="Yes"}(HW||(HW={})),function(e){e[e.SameWithSdk=0]="SameWithSdk",e[e.Edit=1]="Edit",e[e.Comment=2]="Comment",e[e.View=3]="View"}(UW||(UW={})),function(e){e[e.View=1]="View",e[e.Comment=2]="Comment",e[e.Edit=3]="Edit"}(WW||(WW={})),function(e){e[e.STARTING=0]="STARTING",e[e.RECORDING=1]="RECORDING"}(VW||(VW={})),function(e){e[e.ONGOING=1]="ONGOING",e[e.ENDED=2]="ENDED"}(jW||(jW={})),function(e){e[e.COMMON_FAILED=-1]="COMMON_FAILED",e[e.SUCCESS=0]="SUCCESS",e[e.START_TIME_ERROR=1]="START_TIME_ERROR",e[e.MEETING_OVER_ONE_DAY=2]="MEETING_OVER_ONE_DAY",e[e.START_LATER_THAN_END=3]="START_LATER_THAN_END",e[e.EDIT_ON_GOING_MEETING=4]="EDIT_ON_GOING_MEETING",e[e.MEETING_NOT_EXIST=5]="MEETING_NOT_EXIST",e[e.MEETING_ALREADY_ENDED=6]="MEETING_ALREADY_ENDED",e[e.RTC_HOST_LIMIT_REACHED=7]="RTC_HOST_LIMIT_REACHED",e[e.USER_LEFT_CHANNEL=8]="USER_LEFT_CHANNEL",e[e.IN_BLACK_LIST=17]="IN_BLACK_LIST"}(GW||(GW={})),function(e){e[e.AUDIO=1]="AUDIO",e[e.VIDEO=2]="VIDEO",e[e.EDIT=4]="EDIT",e[e.SCREEN_SHARE=8]="SCREEN_SHARE",e[e.COMMENT=16]="COMMENT",e[e.VIEW=32]="VIEW"}(qW||(qW={})),function(e){e[e.DEVICE_CONFLICT=1]="DEVICE_CONFLICT",e[e.TIME_OUT=2]="TIME_OUT",e[e.KICKOUT=3]="KICKOUT"}(KW||(KW={})),function(e){e[e.LEAVE=0]="LEAVE",e[e.END=1]="END"}(YW||(YW={})),function(e){e[e.CONFLICT=0]="CONFLICT",e[e.END=1]="END",e[e.RETRY=2]="RETRY",e[e.LEAVE=3]="LEAVE",e[e.KICKOUT=4]="KICKOUT"}(XW||(XW={}));var fV=function(t){var n=t.data,i=t.activeId,r=t.setActiveId,o=t.meetingManager,a=t.isToday,s=!_e.isHoverSupported,l=W().getUpimeTrans,c=e.useContext(xl),u=c.phoneMode,d=c.upime,p=e.useState(s&&!u),h=p[0],f=p[1],m=new Date(n.planStart),v="0".concat(m.getHours()).slice(-2),g="0".concat(m.getMinutes()).slice(-2),y=new Date(n.planEnd),b="0".concat(y.getHours()).slice(-2),E="0".concat(y.getMinutes()).slice(-2),x=yh(!0),w=x.hide,C=x.skipRef,S=x.toggleHide,k=x.setHide,_=e.useRef(!1),T=e.useRef(!1),I=e.useRef(null),P=e.useState(!1),N=P[0],M=P[1];al(o,["staticMeetingActFrozen"]);var R=function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return(e=o.meetingConfigs.preCheckMeetingAccessibility)?[4,e(void 0,n.id)]:[3,2];case 1:if(!t.sent())return[2];t.label=2;case 2:return o.ignoreMeetingHint(n.id),o.joinMeeting(n.id),[2]}}))}))},B=e.useCallback((function(){k(!0),r(""),f(s)}),[]);e.useEffect((function(){w&&_.current&&(_.current=!1,r(""),!T.current&&f(s))}),[w]);var L=e.useMemo((function(){return n.host===o.localUserInfo.loginName&&n.status===zW.PENDING}),[n,n.status,o.staticMeetingActFrozen]);e.useEffect((function(){setTimeout((function(){I.current&&M(I.current.scrollWidth>I.current.clientWidth)}))}),[]);var O=d.localUserInfo.role===Pt.VISITOR,F=e.useState(O&&n.status===zW.PENDING&&n.planStart-Date.now()>n.openAhead),z=F[0],H=F[1];return e.useEffect((function(){if(O){var e=n.planStart-Date.now()-n.openAhead;n.status===zW.PENDING?e>0&&setTimeout((function(){H(!1)}),e):n.status===zW.ON_GOING&&H(!1)}}),[n.status]),e.createElement("div",{className:j("meetingEntry_3PmAa",h&&"enableHover_1ACzX",!w&&"active_TspJI"),onPointerOver:function(){s||(""===i&&f(!0),T.current=!0)},onPointerLeave:function(){s||(i!==n.id&&f(!1),T.current=!1)},onClick:function(){u&&!n.joined&&(z?d.addToast(l("meeting.list.forbid.join.tip")):(R(),d.closePhoneDrawer()))}},e.createElement("div",{className:"headerSect_3bk5D"},e.createElement("span",null,"".concat(v,":").concat(g," - ").concat(b,":").concat(E)),a?e.createElement("span",{className:j(n.status===zW.ON_GOING&&hV,n.status===zW.PENDING&&"pending_3NLwl")},n.status===zW.PENDING?l("meeting.status.pending"):n.joined?l("meeting.cur.channel"):l("meeting.status.onGoing")):n.status===zW.ON_GOING?e.createElement("span",{className:j(hV)},n.joined?l("meeting.cur.channel"):l("meeting.status.onGoing")):null),e.createElement(Dl,{placement:"bottom",content:n.title,className:j(!N&&"hidden_7j73T")},e.createElement("div",{className:"content_kxcg4",ref:I},n.title)),u&&!n.joined&&e.createElement("span",{className:"rightText_2gqn9"},l("meeting.join")),(!u||!n.joined)&&e.createElement(hl,{icon:"jiantou-you",className:"arrow_3CEl_"}),e.createElement("div",{className:j("floatBtn_3t-sr",!h&&w&&"hide_2WdrY"),ref:C},e.createElement("div",{className:j("dropdown_3DeWK",!w&&"open_3q0P7"),onClick:function(){S(),r(w?n.id:""),setTimeout((function(){return _.current=w}))}},e.createElement(hl,{icon:"gengduo"})),!w&&e.createElement(xh,{align:"left",className:"submenuWrapper_390s6"},e.createElement("div",{className:"submenu_3utq8"},e.createElement("div",{className:j(pV,!L&&lV),onClick:function(){o.onEditMeeting(n.id),B()}},l("meeting.edit")),e.createElement("div",{className:j(pV,"cancel_2kYln",!L&&lV),onClick:function(){o.onCancelMeeting(n.id),B()}},l("meeting.cancel")))),e.createElement(Dl,{placement:"top",content:l("meeting.copyLink.link"),rootClass:j("linkBox_mPxuB"),onClick:function(){o.onCopyMeetingLink(n.id),B()}},e.createElement(hl,{icon:"iconlianjie"})),e.createElement("div",{className:j("primaryBtn_20YWT",(o.staticMeetingActFrozen||n.joined||z)&&lV),onClick:R},l("meeting.join"))))},mV=function(t){var n=t.block,i=t.meetingManager,r=t.index,o=W().getUpimeTrans,a=e.useState(""),s=a[0],l=a[1],c=e.useMemo((function(){var e=new Date(n.timeStamp),t="0".concat(e.getMonth()+1).slice(-2),i="0".concat(e.getDate()).slice(-2);return o("datetime.month.day",t,i)}),[n.timeStamp]);return e.createElement("div",{className:"blockRoot_2A8xC",style:{zIndex:1e3-r}},e.createElement("div",{className:oV},e.createElement("span",null," ",n.label),e.createElement("span",null," ",c)),n.meetings.map((function(t){return e.createElement(fV,{key:t.id,data:t,activeId:s,setActiveId:l,meetingManager:i,isToday:n.isToday})})))},vV=function(t){var n=t.meetingManager,i=t.className;al(n,["meetings"]);var r=e.useState([]),o=r[0],a=r[1],s=W().getUpimeTrans;return e.useEffect((function(){var e=n.meetings;if(e.length){var t={};e.forEach((function(e){var n=function(e){var t=new Date(e);return t.setHours(0,0,0,0),t.getTime()}(e.planStart);t[n]?t[n].push(e):t[n]=[e]}));var i=Object.entries(t).sort((function(e,t){return+e[0]-+t[0]})).map((function(e){var t=+e[0];return HI(t)?{label:s("datetime.today"),meetings:e[1],timeStamp:+e[0],isToday:!0}:function(e){var t=new Date;t.setHours(0,0,0,0);var n=t.getTime();return e>=n+864e5&&e<n+1728e5}(t)?{label:s("datetime.tomorrow"),meetings:e[1],timeStamp:+e[0],isToday:!1}:{label:VI(+e[0]),meetings:e[1],timeStamp:+e[0],isToday:!1}}));a(i)}}),[n,n.meetings]),e.createElement("div",{className:j("listRoot_2F2Jc",i)},o.map((function(t,i){return e.createElement(mV,{key:"".concat(t.timeStamp,"_").concat(t.meetings.length),block:t,meetingManager:n,index:i})})))},gV={root:"root_m21ec",content:"content_bVoEx",title:"title_3VGI6",userName:"userName_10EPX",titleDesc:"titleDesc_Yjg_w",desc:"desc_1O7NU",actions:"actions_2HLjp",reject:"reject_2xNpy",confirm:"confirm_1c35u",endMeetingRoot:"endMeetingRoot_2bkWY",forceLeave:"forceLeave_3gjGk",placeholderImg:"placeholderImg_1GUUu",cannotJoinBox:"cannotJoinBox_2G-Vj",subtitle:"subtitle_2_nR6",phoneModal:"phoneModal_1Ar6S",phoneForceLeave:"phoneForceLeave_2yuQo",visitorMode:"visitorMode_2FZhI",phoneConfirm:"phoneConfirm_1WF6t",disableConfirm:"disableConfirm_3zx7r",phoneReject:"phoneReject_3uUEe",imgContainer:"imgContainer_1mue6",nickNameInput:"nickNameInput_RAs3H",noPermissionJoinBox:"noPermissionJoinBox_2qDRl",headRow:"headRow_2ZRHv",wording:"wording_TcMYU",actionRow:"actionRow_NMogH",btn:"btn_1fd3R",requestMediaBox:"requestMediaBox_HOoWc",cancel:"cancel_2SaBS",outMeetingModalBox:"outMeetingModalBox_24pEe",endModalBox:"endModalBox_21TuR",inRecordingDialogBox:"inRecordingDialogBox_1Rmfm",endRecordingDialogBox:"endRecordingDialogBox_2Wz20",headerRow:"headerRow_2753X",bodyRow:"bodyRow__0o5c",footerRow:"footerRow_1VCfS",inRecordingFirstModalBox:"inRecordingFirstModalBox_3uFfF",text:"text_1QVqg",reminder:"reminder_1-FNE",inRecordingDialogBoxPhone:"inRecordingDialogBoxPhone_1StKI",iconCol:"iconCol_1DVly",contentCol:"contentCol_3Ex4j",btnCol:"btnCol_1zhks",endRecordingDialogBoxPhone:"endRecordingDialogBoxPhone_157qn",advanceSettingModal:"advanceSettingModal_DjNj6",closeBox:"closeBox_3I7Od"},yV="primary_3BPhn",bV=function(t){var n=t.className,i=t.children,r=t.header,o=t.footer;return e.createElement("div",{className:j("phoneModal_3GV2w",n)},r&&e.createElement("div",{className:"header_37qC0"},r),e.createElement("div",{className:"body_DcLs-"},i),o&&e.createElement("div",{className:"footer_2-dn_"},o.map((function(t,n){return e.createElement("div",{className:"btn_2Jg6u",key:"btn-".concat(n)},t)}))))};function EV(t){var n=t.success,i=W().getUpimeTrans;return e.createElement(bV,{header:i("rtc.device.denied.title"),footer:[e.createElement("span",{key:"link",className:yV,onClick:function(){return n(null)}},i("rtc.device.denied.link"))]},i("rtc.device.denied.content"))}var xV,wV,CV,SV=function(t){var n=t.success,i=W().getUpimeTrans;return e.useContext(xl).phoneMode?e.createElement(bV,{className:gV.phoneModal,header:i("meeting.discard.edit.title"),footer:[e.createElement("span",{key:"reject",onClick:function(){n(!1)}},i("meeting.discard.edit.cancel")),e.createElement("span",{key:"confirm",className:j(gV.phoneConfirm),onClick:function(){n(!0)}},i("meeting.discard.edit.confirm"))]},i("meeting.discard.edit.content")):e.createElement("div",{className:j(gV.root)},e.createElement("div",{className:gV.content},e.createElement("span",{className:j(gV.title)},i("meeting.discard.edit.title")),e.createElement("span",{className:j(gV.desc)},i("meeting.discard.edit.content"))),e.createElement("div",{className:j(gV.actions)},e.createElement(ul,{className:j(gV.reject),onClick:function(){n(!1)},type:"secondary"},i("meeting.discard.edit.cancel")),e.createElement(ul,{type:"primary",className:j(gV.confirm),onClick:function(){n(!0)}},i("meeting.discard.edit.confirm"))))},kV=e.memo((function(t){var n=t.onBack,i=t.meetingManager,r=t.meetingData,o=W().getUpimeTrans,a=i.upime,s=e.useRef(i.meetingConfigs.EditMeetingCmp||function(){return null});return al(a,["rightSlidePanelGuard"]),al(i,["editingMeetingId"]),e.createElement(e.Fragment,null,e.createElement("div",{className:"header_2Bfyw"},e.createElement(hl,{icon:"fanhui",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return a.rightSlidePanelGuard?[4,a.showWindow(a.rightSlidePanelGuard)]:[3,2];case 1:return e.sent()&&(i.clearEditingMeeting(),n(),a.clearRightSlidePanelGuard()),[3,3];case 2:i.clearEditingMeeting(),n(),e.label=3;case 3:return[2]}}))}))}}),e.createElement("span",null,o(r?"meeting.edit":"meeting.reserve.label")),e.createElement(hl,{icon:"guanbi",className:"close_2iPsi",onClick:function(){i.upime.switchRightSlidePanel(BW.meetingList)}})),e.createElement("div",{className:"body_1K9IF"},e.createElement(s.current,{data:r,onSubmit:function(e){return A(void 0,void 0,void 0,(function(){var t;return D(this,(function(o){switch(o.label){case 0:return t=r,r?[4,i.updateMeeting(e)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,i.createMeeting(e)];case 3:t=o.sent(),e.coHosts.length>0&&_c("cv_schedule_cohost"),o.label=4;case 4:return a.clearRightSlidePanelGuard(),n(),[2,t]}}))}))},onFormChanged:function(){a.rightSlidePanelGuard||i.upime.addRightSlidePanelGuard(SV)},getCurServerTime:function(){return i.upime.getCurServerTime()}})))})),_V="close_2hVJA",TV="headerSect_mEPBp",IV="date_2WnVZ",PV="day_1CxE4",NV="time_2_AWs",MV="content_3He2U",AV="footer_3mKMq",DV="creator_3C6eO",RV="avatar_3mANP",BV="userName_1xedc",LV="submenuWrapper_uENiW",OV="submenu_3N3Kt",FV="submenuRow_1zcGY",zV="deleteBtn_ihwUA",HV="disabledBtn_MOTO_",UV="title_1bACw",WV="member_1fV6y",VV="more_num_ONU11",jV="row_2f4Em",GV="transitioning_RA1-t",qV="tip_2MBzI",KV="navBar_2me9x",YV="bg_3GbR_",XV="selectBox_2SG4_",QV="unclickable_3q8V6",ZV="gray_3440t",JV="videoNavListBox_tOwT9",$V="videoItem_2FJGS",ej="xiazaiItem_WBfsI",tj="underline_2bDeS",nj="textTitle_mkNh-",ij="zhihui_28VMx",rj="col_1ZLaT",oj="noTextContainer_2lXVG",aj=function(t){var n=t.success,i=W().getUpimeTrans;return e.createElement("div",{className:j("dialogContainer_3ODmo")},e.createElement("div",{className:MV},e.createElement(hl,{icon:"qingchu"}),e.createElement("span",{className:j(UV)},i("meeting.history.delete.confirm"))),e.createElement("div",{className:j("actions_3cZr7")},e.createElement(ul,{className:j("reject_1RGTT"),onClick:function(){n(!1)},type:"secondary"},i("modal.cancel")),e.createElement(ul,{type:"danger",className:j("confirm_2xBqE"),onClick:function(){n(!0)}},i("common.delete"))))},sj=function(t){var n=t.onBack,i=t.meetingManager,r=t.currentMeeting,o=W().getUpimeTrans,a=e.useContext(xl).upime;al(a,["rightSlidePanelGuard"]);var s=new Date(r.startTime),l=s.getFullYear(),c=s.getMonth(),u=s.getDate(),d=s.getDay(),p="0".concat(s.getHours()).slice(-2),h="0".concat(s.getMinutes()).slice(-2),f=new Date(r.endTime),m="0".concat(f.getHours()).slice(-2),v="0".concat(f.getMinutes()).slice(-2),g=e.useState(-1),y=g[0],b=g[1],E=e.useRef([]),x=e.useRef(0),w=e.useState(-1),C=w[0],S=w[1],k=e.useState(0),_=k[0],T=k[1],I=e.useState([]),P=I[0],N=I[1],M=e.useState(0),R=M[0],B=M[1],L=e.useState([]),O=L[0],F=L[1],z=e.useRef(0),H=function(e){clearTimeout(z.current),e(),z.current=window.setTimeout((function(){return H(e)}),2e4)},U=function(){var e=E.current[x.current].id;i.detailText(e).then((function(e){var t=e.status,n=e.data,i=e.audioStatus;0===i||3===i?clearTimeout(z.current):1===i||2===i&&(T(t),N(n),2!==t&&(clearTimeout(z.current),t>=3&&(0===n.length?(F([]),B(5)):H(G))))}))},G=function(){var e=E.current[x.current].id;i.detailJiyao(e).then((function(e){var t=e.status,n=e.data;B(t),F(n),4!==t&&clearTimeout(z.current)}))},q=function(){i.detailVideo(r.cname).then((function(e){var t=e.totalCount,n=e.data;if(n.length>0){b(t),E.current=n;var i=n[x.current].recordStatus;S(i),1===i||10===i||(clearTimeout(z.current),2===i&&H(U))}else S(0)}))};e.useEffect((function(){return H(q),function(){clearTimeout(z.current)}}),[]);var K=e.useMemo((function(){return a.getUserInfo(r.host)}),[]),Y=e.useMemo((function(){return r.joiners.map((function(e){return a.getUserInfo(e.userId)}))}),[]),X=Y.length>3,Q=Y.length>3?3:Y.length,Z=e.useRef(null),J=e.useRef(null),$=e.useRef(null),ee=yh(!0),te=ee.hide,ne=ee.skipRef,ie=ee.toggleHide,re=yh(!0,{checkSkip:function(e){return!!Z.current&&V(Z.current,e)&&Z.current!==e}}),oe=re.hide,ae=re.skipRef,se=re.toggleHide,le=yh(!0,{checkSkip:function(e){return!!J.current&&V(J.current,e)&&J.current!==e}}),ce=le.hide,ue=le.skipRef,de=le.toggleHide,pe=yh(!0,{checkSkip:function(e){return!!$.current&&V($.current,e)&&$.current!==e}}),he=pe.hide,fe=pe.skipRef,me=pe.toggleHide,ve=K.loginName!==a.localUserInfo.loginName,ge=e.useRef(null),ye=e.useRef(null);e.useEffect((function(){ge.current&&ge.current.scrollWidth>ge.current.clientWidth&&(ge.current.title=r.title),ye.current&&ye.current.scrollWidth>ye.current.clientWidth&&(ye.current.title=K.userName)}),[]);var be=e.useState(1),Ee=be[0],xe=be[1],we=e.useRef("");e.useEffect((function(){var e=function(){var e=document.getElementsByClassName("popbox");we.current="",Array.from(e).forEach((function(e){"block"===e.style.display&&(we.current=e.id),e.style.display="none"}))};return window.addEventListener("click",e,{capture:!0}),function(){window.removeEventListener("click",e,{capture:!0})}}),[]);var Ce=e.useMemo((function(){if(r&&P.length>0){var e="",t=r.title+"\n",n=o("datetime.year",l)+o(WI[c])+o("datetime.day",u)+" "+o(UI[d])+" "+"".concat(p,":").concat(h,"-").concat(m,":").concat(v)+"\n",i=o("meeting.creator")+": "+K.userName+"\n",a=Y.map((function(e){return e.userName+", "})).join(""),s=o("meeting.canhuiren")+": "+a.slice(0,-2)+"\n";return e=t+n+i+s,P.forEach((function(t){var n=t.userName,i=t.content,r=t.startTime,o=Math.floor(r/1e3),a="0".concat(Math.floor(o/60)).slice(-2),s="0".concat(o%60).slice(-2),l="\n"+n+" ".concat(a,":").concat(s)+"\n";e+=l+(i+"\n")})),e}}),[r,P]),Se=function(e){return A(void 0,void 0,void 0,(function(){var t,n;return D(this,(function(a){switch(a.label){case 0:return me(),t=E.current.map((function(e,t){return{id:e.id,fileName:"".concat(r.title,"-").concat(o("meeting.history.video.record",t+1))}})).filter((function(t,n){return void 0===e||n===e})),[4,i.downloadVideo(t)];case 1:return(n=a.sent())&&n.forEach((function(e){var t,n,i;t=e.downloadUrl,void 0===n&&(n=100),void 0===i&&(i=1e3),setTimeout((function(){var e=document.createElement("iframe");e.style.display="none",e.className="multi-download",e.src=t,document.body.appendChild(e),setTimeout((function(){document.body.removeChild(e)}),i)}),n)})),[2]}}))}))},ke=E.current.some((function(e){return 1===e.recordStatus||10===e.recordStatus})),_e=a.downloadConfig.enable&&r.host===a.localUserInfo.loginName;return e.createElement(e.Fragment,null,e.createElement("div",{className:"detailHeader_3WPRu",style:{backgroundImage:"url(".concat($o("meeting_his_bg.png"),")"),backgroundSize:"cover"}},e.createElement("div",{className:"navbar_2g10K"},e.createElement(hl,{icon:"fanhui",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return a.rightSlidePanelGuard?[4,a.showWindow(a.rightSlidePanelGuard)]:[3,2];case 1:return e.sent()&&(n(),a.clearRightSlidePanelGuard()),[3,3];case 2:n(),e.label=3;case 3:return[2]}}))}))}}),e.createElement("span",null,o("meeting.title.detail")),e.createElement(hl,{icon:"guanbi",className:_V,onClick:function(){i.upime.switchRightSlidePanel(BW.meetingList)}})),e.createElement("div",{className:UV},e.createElement("div",{className:MV,ref:ge,title:r.title},r.title),e.createElement("div",{className:TV},e.createElement("span",{className:IV},l!==(new Date).getFullYear()&&o("datetime.year",l),o(WI[c]),o("datetime.day",u)),e.createElement("span",{className:PV},o(UI[d])),e.createElement("span",{className:NV},"".concat(p,":").concat(h,"-").concat(m,":").concat(v))),e.createElement("div",{className:AV},e.createElement("span",{className:DV},o("meeting.canhuiren"),": "),e.createElement(ml,{url:K.avatarUrl,className:RV}),e.createElement("div",{className:"divider_2T0hb"}),e.createElement("div",{ref:Z},Y&&Y.slice(0,Q).map((function(t,n){var i=5*n;return e.createElement("div",{className:WV,key:t.loginName,style:{right:i+"px"},onClick:function(e){se()}},e.createElement(ml,{className:VV,url:t.avatarUrl,shape:"circle"}))})),X&&e.createElement("div",{className:j(WV),style:{right:"15px"},onClick:function(e){se()}},4===Y.length?e.createElement(ml,{className:VV,url:Y[3].avatarUrl,shape:"circle"}):e.createElement(ml,{className:j(VV,Y.length>12&&"withBadge_bdKZp"),shape:"circle",style:{position:"relative",bottom:"7px"}},"+",Y.length-3))),!oe&&e.createElement("div",{className:"userList_h85Hs",ref:ae},Y.map((function(t){return e.createElement("div",{className:jV,key:t.loginName},e.createElement(ml,{className:RV,url:t.avatarUrl,shape:"circle"}),e.createElement("span",{className:BV},t.userName))}))))),e.createElement("div",{className:"divideBar_SIa3i"}),e.createElement("div",{className:"gengduo_1s9fD",ref:ne},e.createElement(hl,{icon:"gengduo",className:"floatIcon_1OtrW",onClick:function(){ie()}}),!te&&e.createElement(xh,{align:"right",className:j(LV)},e.createElement("div",{className:OV},e.createElement("div",{className:j(FV,zV,ve&&HV),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return ve?[2]:(ie(),a.isDesktopModal=!0,[4,a.showWindow(aj).finally((function(){a.isDesktopModal=!1}))]);case 1:if(!e.sent())return[3,5];e.label=2;case 2:return e.trys.push([2,4,,5]),[4,i.deleteMeetingById(r.id)];case 3:return e.sent(),n(),a.addToast(o("common.delete.success")),[3,5];case 4:return e.sent(),a.addToast(o("common.delete.failed")),[3,5];case 5:return[2]}}))}))}},o("common.delete")))))),e.createElement("div",{className:"detailBody_1gbNu"},1===C||10===C?e.createElement(e.Fragment,null,e.createElement("div",{className:j(KV)},e.createElement("div",{className:j(XV,!ce&&YV,1===y&&QV),onClick:function(){de()},ref:J},e.createElement("span",null,o("meeting.history.video.record",x.current+1),"(",o("common.gong.n.ge",y),")"),e.createElement(hl,{icon:"shaixuan-xia",className:j(1===y&&ZV)}),!ce&&e.createElement("div",{className:JV,ref:ue},E.current.map((function(t,n){return e.createElement("div",{className:$V,key:t.id,onClick:function(){x.current=n,H(q)}},o("meeting.history.video.record",n+1))}))))),e.createElement("div",{className:GV},e.createElement(hl,{className:"loading_F4VLd",icon:"jiazai"}),e.createElement("span",{className:qV},o("meeting.record.gening")))):2===C?e.createElement(e.Fragment,null,e.createElement("div",{className:j(KV)},e.createElement("div",{className:j(XV,!ce&&YV,1===y&&QV),onClick:function(){de()},ref:J},e.createElement("span",null,o("meeting.history.video.record",x.current+1),"(",o("common.gong.n.ge",y),")"),e.createElement(hl,{icon:"shaixuan-xia",className:j(1===y&&ZV)}),!ce&&e.createElement("div",{className:JV,ref:ue},E.current.map((function(t,n){return e.createElement("div",{className:$V,key:t.id,onClick:function(){x.current=n,H(q)}},o("meeting.history.video.record",n+1))})))),_e&&e.createElement("div",{onClick:function(){me()},className:j("xiazaiIconBox_1rOmi",!he&&YV),ref:$},e.createElement(hl,{icon:"file-xiazai"})),!he&&e.createElement("div",{className:"xiazaiBox_2OGPT",ref:fe},e.createElement("div",{className:ej,onClick:function(){Se(x.current)}},o("common.download")," ",o("meeting.history.video.record",x.current+1)),e.createElement(Dl,{placement:"bottom",content:o("meeting.history.record.download.tip"),enable:ke},e.createElement("div",{className:j(ej,ke&&"disable_3jlK5"),onClick:function(){ke||Se()}},o("common.download")," ",o("meeting.record.download.all"))))),e.createElement("div",{className:j("videoRoot_3aLGI")},e.createElement("video",{controls:!0,src:E.current[x.current].videoOssPath,controlsList:"nodownload"}))):3===C?e.createElement(e.Fragment,null,e.createElement("div",{className:j(KV)},e.createElement("div",{className:j(XV,!ce&&YV,1===y&&QV),onClick:function(){de()},ref:J},e.createElement("span",null,o("meeting.history.video.record",x.current+1),"(",o("common.gong.n.ge",y),")"),e.createElement(hl,{icon:"shaixuan-xia",className:j(1===y&&ZV)}),!ce&&e.createElement("div",{className:JV,ref:ue},E.current.map((function(t,n){return e.createElement("div",{className:$V,key:t.id,onClick:function(){x.current=n,H(q)}},o("meeting.history.video.record",n+1))}))))),e.createElement("div",{className:GV},e.createElement(hl,{icon:"file-jinggao",className:"jinggao_uu8-P"}),e.createElement("span",{className:qV},o("meeting.record.gening.failed")))):0===C?e.createElement("div",{className:"noContentBox_2GNb0"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",{className:qV},o("meeting.record.none"))):null),2===C&&e.createElement("div",{className:"textContainer_1JELQ"},1===_?e.createElement("div",{className:"audio2text_3UbiK",onClick:function(){T(2);var e=E.current[x.current].id;i.genText(e).then((function(){H(U)}))}},o("meeting.audio.to.text")):2===_?e.createElement(e.Fragment,null,e.createElement(hl,{className:"textLoading_129o3",icon:"jiazai"}),e.createElement("span",{className:"textTip_K_4gJ"},o("meeting.textRecord.gening"))):_>=3?e.createElement(e.Fragment,null,e.createElement("div",{className:"textTitleBox_1a_lY"},e.createElement("div",{className:j(nj,2===Ee&&ij),onClick:function(){xe(1)}},e.createElement("span",null,o("meeting.textRecord")),1===Ee&&e.createElement("div",{className:j(tj)})),e.createElement("div",{className:j(nj,1===Ee&&ij),onClick:function(){xe(2)}},e.createElement("span",null,o("meeting.huiyijiyao")),2===Ee&&e.createElement("div",{className:j(tj)}))),1===Ee&&e.createElement("div",{className:"textBox_2F1tW"},P.length>0?P.map((function(t,n){var i=t.userId,r=t.userName,s=t.content,l=t.startTime,c=a.getUserInfo(i),u=Math.floor(l/1e3),d="0".concat(Math.floor(u/60)).slice(-2),p="0".concat(u%60).slice(-2);return e.createElement("div",{className:"textItem_198Os",key:l},e.createElement(ml,{url:c.avatarUrl,className:RV}),e.createElement("div",{className:"textArea_3s9sD"},e.createElement("div",{className:"textHead_1RAD3"},e.createElement("span",null,r),e.createElement("span",null,"".concat(d,":").concat(p)),e.createElement("div",{onClick:function(){var e=document.getElementById("popbox"+n);e&&we.current!==e.id&&(e.style.display="block")},className:"iconBox_qRazk"},e.createElement(hl,{icon:"gengduo"})),e.createElement("div",{id:"popbox"+n,className:j("popBox_2ddu7","popbox")},e.createElement("div",{className:jV,style:{marginBottom:"10px"},onClick:function(){a.editable?(BF(s,a),a.addToast(o("ai.center.export.to.board.success"))):a.addToast(o("ai.center.toast.notAllow.export"))}},e.createElement(hl,{icon:"daoruhuabu"}),e.createElement("span",null,o("meeting.daoruhuabu"))),e.createElement("div",{className:jV,onClick:function(){Xd("1",{onCopy:function(e){e.setData("text/plain",s)}}),a.addToast(o("ai.center.copy.success"))}},e.createElement(hl,{icon:"fuzhi"}),e.createElement("span",null,o("element.copy"))))),e.createElement("div",{className:"textContent_1lDEl"},s)))})):e.createElement("div",{className:oj},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("meeting.text.history.empty")))),2===Ee&&e.createElement("div",{className:"jiyaoBox_3PTR2"},3===R?e.createElement("div",{className:"genBtn_3R8yf",onClick:function(){B(4);var e=E.current[x.current].id;i.genJiyao(e).then((function(){H(G)}))}},o("meeting.ai.gen.jiyao")):4===R?e.createElement("div",{className:"loadingBox_21d0K"},e.createElement("div",{className:"aiLoading_tbWMI",style:{background:"url(".concat($o("ai_gif.gif"),")"),backgroundSize:"100% 100%"}}),e.createElement("div",{className:"loadingTip_RaHDe"},o("meeting.gening.jiyao"))):5===R?e.createElement(e.Fragment,null,O.length>0?O.map((function(t,n){var i=t.text;return e.createElement("li",{className:"jiyaoItem_qLJPp",key:n},i+"\n")})):e.createElement("div",{className:oj},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("meeting.jiyao.emtpy")))):null),(1===Ee&&_>=3&&P.length>0||2===Ee&&5===R&&O.length>0)&&e.createElement("div",{className:"footerBox_29LnR"},e.createElement("div",{className:rj,onClick:function(){if(1===Ee)Ce&&(Xd("1",{onCopy:function(e){e.setData("text/plain",Ce)}}),a.addToast(o("ai.center.copy.success")));else if(2===Ee){var e=O.map((function(e){return e.text+"\n"})).join();Xd("1",{onCopy:function(t){t.setData("text/plain",e)}}),a.addToast(o("ai.center.copy.success"))}}},e.createElement(hl,{icon:"fuzhi",style:{width:"18px",height:"18px"}}),e.createElement("span",null,o(1===Ee?"meeting.fuzhijilu":"meeting.fuzhijiyao"))),e.createElement("div",{className:rj,onClick:function(){if(a.editable){if(1===Ee){var e=[],t=yi(r.title+"\n"),n=yi(o("datetime.year",l)+o(WI[c])+o("datetime.day",u)+" "+o(UI[d])+" "+"".concat(p,":").concat(h,"-").concat(m,":").concat(v)+"\n"),i=yi(o("meeting.creator")+": "+K.userName+"\n"),s=Y.map((function(e){return e.userName+", "})).join(""),f=yi(o("meeting.canhuiren")+": "+s.slice(0,-2)+"\n");e.push([t,{color:1710618}]),e.push([n,{color:1710618}]),e.push([i,{color:1710618}]),e.push([f,{color:1710618}]),P.forEach((function(t){var n=t.userName,i=t.content,r=t.startTime,o=Math.floor(r/1e3),a="0".concat(Math.floor(o/60)).slice(-2),s="0".concat(o%60).slice(-2),l=yi("\n"+n+" ".concat(a,":").concat(s)+"\n"),c=yi(i+"\n");e.push([l,{color:8421504}]),e.push([c,{color:1710618}])})),function(e,t,n){A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c;return D(this,(function(u){return i=Lt(t.view.getViewbox()),t.operationInterrupt(),r=t.createOperation(),o=t.insertTextAt(i,{content:e,autoStartEdit:!1,verticalPos:"center",currentOp:r,noSync:!0,slient:!0}),a=o.getGlobalBox(),s=Jg(a,t,(function(e){return e===o||e.elementType===Za.FRAME})),l=s[0],c=s[1],l&&(r.update(o,{position:{x:c.left,y:c.top}}),a=c),r.sync(),t.makeBorderCenter(a,ty(t,!1)),n&&n.select&&t.selectElement(o),[2]}))}))}(e,a,{select:!0}),a.addToast(o("ai.center.export.to.board.success"))}else if(2===Ee){var g=O.map((function(e){return e.text+"\n"})).join();BF(g,a,{select:!0}),a.addToast(o("ai.center.export.to.board.success"))}}else a.addToast(o("ai.center.toast.notAllow.export"))}},e.createElement(hl,{icon:"daoruhuabu"}),e.createElement("span",null,o("meeting.daoruhuabu"))))):null))},lj=function(t){var n=t.data,i=t.activeId,r=t.setActiveId,o=t.meetingManager,a=t.setCurrentMeeting,s=t.onDelete,l=!_e.isHoverSupported,c=W().getUpimeTrans,u=e.useState(l),d=u[0],p=u[1],h=new Date(n.startTime),f=h.getFullYear(),m=h.getMonth(),v=h.getDate(),g=h.getDay(),y=new Date(n.endTime),b="0".concat(y.getHours()).slice(-2),E="0".concat(y.getMinutes()).slice(-2),x=yh(!0),w=x.hide,C=x.skipRef,S=x.toggleHide,k=e.useRef(!1),_=e.useRef(!1),T=e.useRef(null),I=e.useRef(null),P=e.useContext(xl).upime;e.useEffect((function(){w&&k.current&&(k.current=!1,r(-1),!_.current&&p(l))}),[w]);var N=e.useMemo((function(){return P.getUserInfo(n.host)}),[]),M=N.loginName!==P.localUserInfo.loginName;return e.useEffect((function(){T.current&&T.current.scrollWidth>T.current.clientWidth&&(T.current.title=n.title),I.current&&I.current.scrollWidth>I.current.clientWidth&&(I.current.title=N.userName)}),[]),e.createElement("div",{className:j("meetingEntry_cr99G",d&&"enableHover_sNd9U",!w&&"active_osEt5"),onPointerOver:function(){l||(-1===i&&p(!0),_.current=!0)},onPointerLeave:function(){l||(i!==n.id&&p(!1),_.current=!1)}},e.createElement("div",{className:TV},e.createElement("span",{className:IV},f!==(new Date).getFullYear()&&c("datetime.year",f),c(WI[m]),c("datetime.day",v)),e.createElement("span",{className:PV},c(UI[g])),e.createElement("span",{className:NV},"".concat(b,":").concat(E))),e.createElement("div",{className:MV,ref:T},n.title),e.createElement("div",{className:AV},e.createElement("span",{className:DV},c("meeting.creator"),": "),e.createElement(ml,{url:N.avatarUrl,className:RV}),e.createElement("span",{className:BV,ref:I},N.userName)),e.createElement(hl,{icon:"jiantou-you",className:"arrow_HATtr"}),e.createElement("div",{className:j("floatBtn_3sfEF",!d&&w&&"hide_1vUGm"),ref:C},e.createElement("div",{className:j("primaryBtn_O_qwD",o.staticMeetingActFrozen&&"disabled_eTdpH"),onClick:function(){a(n)}},c("common.check.detail")),e.createElement("div",{className:j("dropdown_Ptzcv",!w&&"open_2Zkb3",w&&"dropdownNormal_4-Qox"),onClick:function(){S(),r(w?n.id:-1),setTimeout((function(){return k.current=w}))}},e.createElement("div",{className:"triangle_3ObZG"})),!w&&e.createElement(xh,{align:"right",className:LV},e.createElement("div",{className:OV},e.createElement("div",{className:j(FV,zV,M&&HV),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return M?[2]:(S(),P.isDesktopModal=!0,[4,P.showWindow(aj).finally((function(){P.isDesktopModal=!1}))]);case 1:if(!e.sent())return[3,5];e.label=2;case 2:return e.trys.push([2,4,,5]),[4,o.deleteMeetingById(n.id)];case 3:return e.sent(),s(n.id),P.addToast(c("common.delete.success")),[3,5];case 4:return e.sent(),P.addToast(c("common.delete.failed")),[3,5];case 5:return[2]}}))}))}},c("common.delete"))))))},cj=function(t){var n=t.onBack,i=t.meetingManager;t.meetingData;var r=W().getUpimeTrans,o=i.upime;al(o,["rightSlidePanelGuard"]);var a=e.useState(-1),s=a[0],l=a[1],c=e.useState(null),u=c[0],d=c[1],p=e.useState(null),h=p[0],f=p[1],m=function(e){i.getHistoryMeetingList(e).then((function(e){f(e.data)})).catch((function(e){}))},v=e.useState(""),g=v[0],y=v[1],b=e.useRef(null);e.useEffect((function(){if(""!==g){var e=setTimeout((function(){m(g)}),300);return function(){clearTimeout(e)}}m()}),[g]);var E=function(e){f((null==h?void 0:h.filter((function(t){return t.id!==e})))||null)};return null===u?e.createElement(e.Fragment,null,e.createElement("div",{className:"header_2OuWJ"},e.createElement(hl,{icon:"fanhui",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return o.rightSlidePanelGuard?[4,o.showWindow(o.rightSlidePanelGuard)]:[3,2];case 1:return e.sent()&&(n(),o.clearRightSlidePanelGuard()),[3,3];case 2:n(),e.label=3;case 3:return[2]}}))}))}}),e.createElement("span",null,r("meeting.title.history")),e.createElement(hl,{icon:"guanbi",className:_V,onClick:function(){i.upime.switchRightSlidePanel(BW.meetingList)}})),e.createElement("div",{className:"body_3jDAr"},e.createElement("div",{className:"searchBar_28EEk"},e.createElement(hl,{icon:"sousuo"}),e.createElement("input",{type:"text",ref:b,value:g,onChange:function(e){y(e.target.value)},placeholder:r("search.icon.hint")}),g&&e.createElement("div",{className:"clearInput_3Lnop",onClick:function(){var e;y(""),null===(e=b.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"}))),null===h?null:h.length>0?h.map((function(t){return e.createElement(lj,{key:t.id,data:t,activeId:s,setActiveId:l,meetingManager:i,setCurrentMeeting:d,onDelete:E})})):e.createElement("div",{className:"nohistoryContainer_1t9fp"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,r("meeting.list.history.empty"))))):e.createElement(sj,{onBack:function(){d(null),l(-1),m(g)},meetingManager:i,currentMeeting:u})},uj=function(t){var n=t.upime,i=n.meetingManager,r=e.useContext(xl).phoneMode,o=W().getUpimeTrans;al(i,["meetings","staticMeetingActFrozen","editingMeetingId"]);var a,s=e.useMemo((function(){return!i.meetings.length}),[i,i.meetings]),l=e.useState("normal"),c=l[0],u=l[1],d=i.meetingConfigs,p=d.couldCheckMemberList,h=d.couldCreateMeeting,f=!p&&!h,m=e.useMemo((function(){var e;return i.editingMeetingId&&null!==(e=i.meetings.find((function(e){return e.id===i.editingMeetingId})))&&void 0!==e?e:null}),[i.editingMeetingId]);return e.useEffect((function(){i.editingMeetingId&&m&&u("edit")}),[i.editingMeetingId,m]),e.useEffect((function(){return function(){i.clearEditingMeeting()}}),[]),"normal"===c?a=e.createElement(e.Fragment,null,!r&&e.createElement("div",{className:oV},e.createElement("div",{className:j(aV,"title_wV9l_")},e.createElement("span",null," ",o("meeting.iconBtn.tooltip")),n.userManager.enableMeetingHistory&&e.createElement(Dl,{placement:"top",content:o("meeting.title.history")},e.createElement(hl,{className:"zuijinIcon_3y9cm",icon:"zuijin",onClick:function(){u("history")}})),e.createElement(hl,{className:"closeIcon_sRg1B",icon:"guanbi",onClick:function(){n.switchRightSlidePanel(BW.meetingList)}})),h&&e.createElement("div",{className:aV},e.createElement("div",{className:j(sV,"quickMeeting_17nwV",i.staticMeetingActFrozen&&lV),onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return(e=i.meetingConfigs.preCheckMeetingAccessibility)?[4,e("fast")]:[3,2];case 1:if(!t.sent())return[2];t.label=2;case 2:return _c("cv_meeting_quick"),i.fastMeeting(),[2]}}))}))}},e.createElement(hl,{icon:"shandian"}),e.createElement("span",null," ",o("meeting.quick.label"))),e.createElement("div",{className:j(sV,"reserveMeeting_2im7x"),onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return(e=i.meetingConfigs.preCheckMeetingAccessibility)?[4,e("reserve")]:[3,2];case 1:if(!t.sent())return[2];t.label=2;case 2:return _c("cv_meeting_sched"),u("edit"),[2]}}))}))}},e.createElement(hl,{icon:"yuding"}),e.createElement("span",null," ",o("meeting.reserve.label"))))),f?e.createElement("div",{className:j(cV,uV)},e.createElement("div",{className:dV},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("meeting.list.forbidden")))):e.createElement("div",{className:j(cV,s&&uV)},s?e.createElement("div",{className:j(dV,r&&"phone_2Zp21")},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("meeting.list.empty"))):e.createElement(vV,{meetingManager:i}))):"edit"===c?a=e.createElement(kV,{onBack:function(){return u("normal")},meetingManager:i,meetingData:m}):"history"===c&&(a=e.createElement(cj,{onBack:function(){return u("normal")},meetingManager:i,meetingData:m})),e.createElement("div",{className:"containerRoot_2gzAs"},a)},dj={iconWrap:"iconWrap_1BOO_",iconWrapActive:"iconWrapActive_r6QNM",root:"root_3wRSW",divider:"divider_1b-Sa",extension:"extension_3hSxb",extensionItem:"extensionItem_P_yjW",active:"active_2ybfM",extensionSidePanelItemBtn:"extensionSidePanelItemBtn_1XWlA",badgeTip:"badgeTip_1w5fw",dotTip:"dotTip_1GF5x",extensionRoot:"extensionRoot_3XozC",header:"header_3nTR7",iconBox:"iconBox_1646h",closeIcon:"closeIcon_2pwh3"},pj=((xV={})[BW.commentList]=function(t){var n=t.upime,i=e.useRef(null),r=n.commentManager,o=W().getUpimeTrans;al(n),al(n.commentManager,["totalUnreadCount","allCommentsHided","resolvedHided"]);var a=e.useState(n.getAllComments().length),s=a[0],l=a[1],c=e.useRef(null),u=e.useState({})[1],d=e.useState(null),p=d[0],h=d[1];e.useEffect((function(){var e=n.subscribe("commentMessagesUpdate",(function(){l(n.getAllComments().length)}));return u({}),function(){e()}}),[]);var f=n.commentManager.allCommentsHided,m=n.commentManager.resolvedHided,v=n.commentManager.totalUnreadCount,g=s>0&&n.editable&&n.userManager.enableCommentExport;return e.createElement($W.Provider,{value:{curUser:p,setCurUser:h}},e.createElement("div",{className:j("commentListRoot_15Hqh"),ref:i,style:{fontFamily:He}},e.createElement("div",{className:"header_2bBbx"},e.createElement("span",null," ",o("comment.listMenu.icon.hint")," "),s>0&&e.createElement(nV,{upime:n}),g&&n.downloadConfig.enable&&e.createElement(Dl,{placement:"top",content:o("comment.export.all")},e.createElement(hl,{icon:"xiazai",onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,i,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return e=Object.entries(n.commentManager.commentMsgMap).map((function(e){var t,i=e[0],r=e[1];return{comment:null!==(t=n.getAllComments((function(e){return e.id===i}))[0])&&void 0!==t?t:null,msgs:r.filter((function(e,t){return!e.deleted&&(e.type===TI.TEXT||0===t)}))}})).filter((function(e){return e.comment&&e.msgs.length&&(!r.resolvedHided||!e.comment.resolved)})).sort((function(e,t){var n,i,r=e.msgs[e.msgs.length-1],o=t.msgs[t.msgs.length-1];return(null!==(n=null==o?void 0:o.createTime)&&void 0!==n?n:0)-(null!==(i=null==r?void 0:r.createTime)&&void 0!==i?i:0)})).map((function(e){return e.msgs})).map((function(e){return e.map((function(e){var t=JSON.parse(e.content||'[{"type":"paragraph","children":[{"text":""}]}]'),i="";return t[0].children.forEach((function(e){"text"in e?i+=e.text:"type"in e&&("mention"===e.type?i+="@"+e.userName+" ":"url"===e.type&&(i+=e.url))})),{id:e.id,commentator:n.getUserInfo(e.commentator).userName,content:i,createTime:e.createTime,updateTime:e.updateTime}}))})),t="unknown",n.queryBoardInfo&&(i=n.queryBoardInfo(),t=i.title),[4,Promise.all([n.getFileToken(),n.getDownloadSign("exportAnnotations")])];case 1:return o=d.sent(),a=o[0],s=o[1],l=a.host,c=a.query,[4,Q("".concat(l,"/fs/exportAnnotations?").concat(c),"blob","application/json","POST",JSON.stringify(exports.E({fileName:t,annotationList:e},s)))];case 2:return(u=d.sent()).text().then((function(e){try{JSON.parse(e)}catch(e){var n=document.createElement("a");n.href=window.URL.createObjectURL(u),n.download=t+"画布批注列表.xlsx",n.click()}})),[2]}}))}))},className:"exportBtn_24eAp"})),e.createElement(hl,{icon:"guanbi",onClick:function(){return n.switchRightSlidePanel(BW.commentList)},className:IW,style:{marginLeft:"auto",marginRight:0}})),e.createElement("div",{className:j("body_1F54M",!s&&"emptyBody_1TEB4"),ref:c},s?e.createElement(eV,{upime:n,viewportDom:c.current}):e.createElement("div",{className:"emptyPlaceholder_1DRpb"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("comment.listMenu.noComment")))),e.createElement("div",{className:"footer_3thMB"},e.createElement("div",{className:"icons_MET3h"},e.createElement(Dl,{placement:"top",content:o(f?"comment.listMenu.showAllBoardComments":"comment.listMenu.hideAllBoardComments")},e.createElement(hl,{className:j("footerIcon_3Oof8",IW),icon:f?"pizhuxianshi":"pizhuyincang",onClick:function(){return r.hideAllComments(!f)}}))),e.createElement("div",{className:"actions_3lNk8"},e.createElement(ul,{className:j(PW,"hideResolveBtn_eZ9Pk"),onClick:function(){return n.commentManager.hideResolvedComments(!m)}},o(m?"comment.listMenu.showResolve":"comment.listMenu.hideResolve")),e.createElement(ul,{className:j(PW,0===v&&"readAllBtnDisabled_52k19"),onClick:function(){return n.commentManager.readAllMessages()}},o("comment.listMenu.readAll"))))))},xV[BW.meetingList]=uj,xV[BW.extensionList]=function(t){var n,i=t.upime;al(i,["currentCustomFoldableTool"]);var r=e.useRef(null),o=i.currentCustomFoldableTool,a=Bg();return e.useEffect((function(){return i.subscribe("currentCustomFoldableToolUpdated",a)}),[]),e.createElement("div",{className:j(dj.extensionRoot),ref:r,style:{fontFamily:He}},!1!==(null==o?void 0:o.usePublicHead)&&e.createElement("div",{className:dj.header},e.createElement("span",null," ",null==o?void 0:o.name," "),o&&o.headWidget&&e.createElement(o.headWidget,null),e.createElement("div",{className:dj.iconBox,onClick:function(){i.switchRightSlidePanel(BW.extensionList,o)}},e.createElement(hl,{icon:"guanbi",className:dj.closeIcon}))),(null==o?void 0:o.toolPanel)&&e.createElement(o.toolPanel,exports.E({upime:i},null!==(n=o.toolPanelProps)&&void 0!==n?n:{})))},xV),hj=function(t){var n=t.upime,i=t.className,r=e.useRef(null),o=e.useState(!1),a=o[0],s=o[1],l=e.useRef(!1),c=e.useContext(Ic).openRightSubSlide;al(n,["rightSlidePanelType"]);var u=a&&n.rightSlidePanelType?pj[n.rightSlidePanelType]:null;return e.useEffect((function(){var e=r.current;if(e&&n.rightSlidePanelType)return s(!0),l.current=!0,c(!0),e.style.display="block",e.classList.remove(rV),e.classList.add(iV),function(){e.classList.remove(iV),e.classList.add(rV),setTimeout((function(){s(!1),l.current=!1,c(!1),e.style.display="none"}),300)}}),[null===n.rightSlidePanelType,r.current]),e.createElement("div",{className:j(i),ref:r,id:"rightSidePanel",onMouseMove:function(e){e.stopPropagation()}},a&&u?e.createElement(u,{upime:n}):null)};!function(e){e[e.STATIC_MEETINGS_KEY_FRAME=0]="STATIC_MEETINGS_KEY_FRAME",e[e.MEETING_STATUS_CHANGE=1]="MEETING_STATUS_CHANGE",e[e.STATIC_MEETING_CREATED=2]="STATIC_MEETING_CREATED",e[e.STATIC_MEETING_CANCELED=3]="STATIC_MEETING_CANCELED",e[e.STATIC_MEETING_UPDATED=4]="STATIC_MEETING_UPDATED",e[e.JOINER_UPDATED=5]="JOINER_UPDATED",e[e.UPDATE_ADVANCE_SETTING=48]="UPDATE_ADVANCE_SETTING"}(wV||(wV={})),function(e){e[e.CREATE_STATIC_MEETING=2]="CREATE_STATIC_MEETING",e[e.CANCEL_STATIC_MEETING=3]="CANCEL_STATIC_MEETING",e[e.UPDATE_STATIC_MEETING=4]="UPDATE_STATIC_MEETING",e[e.UPDATE_JOINER=5]="UPDATE_JOINER",e[e.JOIN_MEETING=6]="JOIN_MEETING",e[e.FAST_MEETING=13]="FAST_MEETING",e[e.QUERY_MEETING=24]="QUERY_MEETING",e[e.ADD_JOINER=45]="ADD_JOINER",e[e.UPDATE_ADVANCE_SETTING=48]="UPDATE_ADVANCE_SETTING"}(CV||(CV={}));var fj,mj,vj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case wV.STATIC_MEETINGS_KEY_FRAME:return{type:t[0],meetings:t[1]};case wV.MEETING_STATUS_CHANGE:return{type:t[0],meetingId:t[1],status:t[2]};case wV.STATIC_MEETING_CREATED:return{type:t[0],meetingData:t[1]};case wV.STATIC_MEETING_CANCELED:return{type:t[0],meetingId:t[1]};case wV.STATIC_MEETING_UPDATED:return{type:t[0],meetingData:t[1]};case wV.JOINER_UPDATED:return{type:t[0],meetingId:t[1],joiners:t[2]};case wV.UPDATE_ADVANCE_SETTING:return{type:t[0],meetingId:t[1],advanceSetting:t[2]}}},t.prototype.addPlanJoiner=function(e,t,n,i){return A(this,void 0,void 0,(function(){return D(this,(function(r){switch(r.label){case 0:return[4,this.sendRCmd(CV.ADD_JOINER,e,t,n,i)];case 1:return[2,r.sent()]}}))}))},t.prototype.queryMeeting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(CV.QUERY_MEETING,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.createMeeting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(CV.CREATE_STATIC_MEETING,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.updateAdvanceSettings=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(wV.UPDATE_ADVANCE_SETTING,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.cancelMeeting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(CV.CANCEL_STATIC_MEETING,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.updateMeeting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(CV.UPDATE_STATIC_MEETING,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.updateJoiners=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(CV.UPDATE_JOINER,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.joinMeeting=function(e,t,n,i){return A(this,void 0,void 0,(function(){return D(this,(function(r){switch(r.label){case 0:return[4,this.sendRCmd(CV.JOIN_MEETING,e,!!n,i||"",t)];case 1:return[2,r.sent()]}}))}))},t.prototype.fastMeeting=function(){var e,t,n;return A(this,void 0,void 0,(function(){var i,r;return D(this,(function(o){switch(o.label){case 0:return[4,null===(t=(e=this.upime).getAllUsersInMention)||void 0===t?void 0:t.call(e)];case 1:return i=o.sent(),r=null!==(n=null==i?void 0:i.map((function(e){return e.loginName})))&&void 0!==n?n:[],[4,this.sendRCmd(CV.FAST_MEETING,r)];case 2:return[2,o.sent()]}}))}))},t}(Sp);!function(e){e[e.USER_JOINED=6]="USER_JOINED",e[e.USER_LEAVED=7]="USER_LEAVED",e[e.MEETING_ENDED=8]="MEETING_ENDED",e[e.USER_PERMISSION_CHANGED=9]="USER_PERMISSION_CHANGED",e[e.FORCE_LEAVE=20]="FORCE_LEAVE",e[e.VIEW_SRC_CHANGED=23]="VIEW_SRC_CHANGED",e[e.MEETING_FORCE_FOLLOW_CHANGED=25]="MEETING_FORCE_FOLLOW_CHANGED",e[e.USER_FORCE_FOLLOW_CHANGED=26]="USER_FORCE_FOLLOW_CHANGED",e[e.VNC_OPENED=27]="VNC_OPENED",e[e.VNC_CLOSED=28]="VNC_CLOSED",e[e.RTC_MOVE_TOP=29]="RTC_MOVE_TOP",e[e.START_TIMER=30]="START_TIMER",e[e.STOP_TIMER=31]="STOP_TIMER",e[e.ADD_TIMER_TIME=32]="ADD_TIMER_TIME",e[e.UPDATE_TIMER=33]="UPDATE_TIMER",e[e.SET_COHOST=34]="SET_COHOST",e[e.CANCEL_COHOST=35]="CANCEL_COHOST",e[e.REQUEST_MEDIA_PERM=37]="REQUEST_MEDIA_PERM",e[e.RESPONSE_MEDIA_PERM=38]="RESPONSE_MEDIA_PERM",e[e.START_CLOUD_RECORD=39]="START_CLOUD_RECORD",e[e.RECORDING_CLOUD_RECORD=40]="RECORDING_CLOUD_RECORD",e[e.END_CLOUD_RECORD=41]="END_CLOUD_RECORD",e[e.END_CLOUD_RECORD_BY_NETWORK=42]="END_CLOUD_RECORD_BY_NETWORK",e[e.START_SCREEN_SHARE=43]="START_SCREEN_SHARE",e[e.STOP_SCREEN_SHARE=44]="STOP_SCREEN_SHARE",e[e.PERM_APPLY=46]="PERM_APPLY",e[e.HANDLE_PERM_APPLY=47]="HANDLE_PERM_APPLY",e[e.AUXI_RTC_PERM_MUTATED=101]="AUXI_RTC_PERM_MUTATED",e[e.AUXI_RTC_ENDED=102]="AUXI_RTC_ENDED"}(fj||(fj={})),function(e){e[e.LEAVE_MEETING=7]="LEAVE_MEETING",e[e.END_MEETING=8]="END_MEETING",e[e.ASSIGN_PERMISSION=9]="ASSIGN_PERMISSION",e[e.APPLY_PERMISSION=10]="APPLY_PERMISSION",e[e.REPORT_PERM_CHANGE=11]="REPORT_PERM_CHANGE",e[e.CHANGE_VIEW_FROM=23]="CHANGE_VIEW_FROM",e[e.CHANGE_MEETING_FORCE_FOLLOW=25]="CHANGE_MEETING_FORCE_FOLLOW",e[e.CHANGE_USER_FORCE_FOLLOW=26]="CHANGE_USER_FORCE_FOLLOW",e[e.OPEN_VNC=27]="OPEN_VNC",e[e.CLOSE_VNC=28]="CLOSE_VNC",e[e.START_TIMER=30]="START_TIMER",e[e.STOP_TIMER=31]="STOP_TIMER",e[e.ADD_TIMER_TIME=32]="ADD_TIMER_TIME",e[e.UPDATE_TIMER=33]="UPDATE_TIMER",e[e.SET_COHOST=34]="SET_COHOST",e[e.CANCEL_COHOST=35]="CANCEL_COHOST",e[e.KICKOUT=36]="KICKOUT",e[e.REQUEST_MEDIA_PERM=37]="REQUEST_MEDIA_PERM",e[e.RESPONSE_MEDIA_PERM=38]="RESPONSE_MEDIA_PERM",e[e.START_CLOUD_RECORD=39]="START_CLOUD_RECORD",e[e.END_CLOUD_RECORD=41]="END_CLOUD_RECORD",e[e.START_SCREEN_SHARE=43]="START_SCREEN_SHARE",e[e.STOP_SCREEN_SHARE=44]="STOP_SCREEN_SHARE",e[e.PERM_APPLY=46]="PERM_APPLY",e[e.HANDLE_PERM_APPLY=47]="HANDLE_PERM_APPLY",e[e.EXIT_FOLLOW=49]="EXIT_FOLLOW",e[e.RESUME_FOLLOW=50]="RESUME_FOLLOW",e[e.MUTATE_AUXI_RTC_PERM=101]="MUTATE_AUXI_RTC_PERM"}(mj||(mj={}));var gj,yj=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case fj.USER_JOINED:return{type:n=t[0],joinerData:t[1]};case fj.USER_LEAVED:return{type:n=t[0],userId:r=t[1]};case fj.MEETING_ENDED:return{type:n=t[0]};case fj.USER_PERMISSION_CHANGED:var n=t[0],i=t[1];return{type:n,perm:i.perm,userId:i.userId,en:i.en};case fj.FORCE_LEAVE:return{type:n=t[0],reason:t[1]};case fj.VIEW_SRC_CHANGED:return{type:n=t[0],userId:r=t[1]};case fj.MEETING_FORCE_FOLLOW_CHANGED:return{type:n=t[0],status:t[1]};case fj.USER_FORCE_FOLLOW_CHANGED:n=t[0];var r=t[1];return{type:n,status:t[2],userId:r};case fj.VNC_OPENED:return{type:n=t[0],vncId:t[1],elmId:t[2]};case fj.VNC_CLOSED:return{type:n=t[0],vncId:t[1]};case fj.RTC_MOVE_TOP:return{type:n=t[0],userId:r=t[1],status:t[2]};case fj.START_TIMER:return{type:n=t[0],userId:r=t[1],uniqueId:t[2],meetingTimer:t[3]};case fj.STOP_TIMER:return{type:n=t[0],userId:r=t[1],uniqueId:t[2]};case fj.UPDATE_TIMER:return{type:n=t[0],userId:r=t[1],uniqueId:t[2],meetingTimer:t[3]};case fj.ADD_TIMER_TIME:return{type:n=t[0],userId:r=t[1],uniqueId:t[2],meetingTimer:t[3],duration:t[4]};case fj.SET_COHOST:case fj.CANCEL_COHOST:return{type:n=t[0],userId:r=t[1]};case fj.REQUEST_MEDIA_PERM:case fj.RESPONSE_MEDIA_PERM:return{type:n=t[0],userId:r=t[1],kind:t[2]};case fj.START_CLOUD_RECORD:return{type:n=t[0],cloudRecordId:t[1],starter:t[2]};case fj.RECORDING_CLOUD_RECORD:return{type:n=t[0],on:t[1],cloudRecordData:t[2]};case fj.END_CLOUD_RECORD:case fj.END_CLOUD_RECORD_BY_NETWORK:return{type:n=t[0],cloudRecordId:t[1]};case fj.START_SCREEN_SHARE:case fj.STOP_SCREEN_SHARE:return{type:n=t[0],userId:r=t[1]};case fj.PERM_APPLY:return{type:n=t[0],userPermApplyList:t[1]};case fj.HANDLE_PERM_APPLY:return{type:n=t[0],userPermApply:t[1]};case fj.AUXI_RTC_PERM_MUTATED:n=t[0];var o=t[1];return{type:n,uniqueId:o.uniqueId,perm:o.perm,on:o.en};case fj.AUXI_RTC_ENDED:return{type:n=t[0]}}},t.prototype.reportStatusChange=function(e,t){this.sendSCmd(mj.REPORT_PERM_CHANGE,{perm:e,en:t})},t.prototype.permApply=function(e){this.sendSCmd(mj.PERM_APPLY,e)},t.prototype.handlePermApply=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.HANDLE_PERM_APPLY,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.startScreenShare=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(mj.START_SCREEN_SHARE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.stopScreenShare=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(mj.STOP_SCREEN_SHARE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.startCloudRecord=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this.sendRCmd(mj.START_CLOUD_RECORD,e)];case 1:return t=r.sent(),n=t[0],i=t[1],[2,[n,i]]}}))}))},t.prototype.endCloudRecord=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.END_CLOUD_RECORD,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.applyDevicePermission=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(mj.APPLY_PERMISSION)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.leaveMeeting=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(mj.LEAVE_MEETING)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.mutateOtherPerm=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){switch(i.label){case 0:return[4,this.sendRCmd(mj.ASSIGN_PERMISSION,{userId:e,perm:t,en:n})];case 1:return[2,i.sent()[0]]}}))}))},t.prototype.endMeeting=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(mj.END_MEETING)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.changeViewFrom=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.CHANGE_VIEW_FROM,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.toggleMeetingForceFollow=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.CHANGE_MEETING_FORCE_FOLLOW,e?1:0)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.toggleUserForceFollow=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(mj.CHANGE_USER_FORCE_FOLLOW,e,t?1:0)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.kickoutMeeting=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(mj.KICKOUT,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.requestMediaPermission=function(e,t){this.sendSCmd(mj.REQUEST_MEDIA_PERM,e,t)},t.prototype.answerOpenMediaRequest=function(e,t){this.sendSCmd(mj.RESPONSE_MEDIA_PERM,e,t)},t.prototype.requestVnc=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.sendRCmd(mj.OPEN_VNC,e,t)];case 1:return n=o.sent(),i=n[0],r=n[1],i===GW.SUCCESS?[2,r]:[2,null]}}))}))},t.prototype.closeVnc=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.CLOSE_VNC,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.changeTopUser=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(fj.RTC_MOVE_TOP,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.startTimer=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this.sendRCmd(mj.START_TIMER,e)];case 1:return t=r.sent(),n=t[0],i=t[1],[2,[n,i]]}}))}))},t.prototype.stopTimer=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.STOP_TIMER,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.addTimerTime=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(mj.ADD_TIMER_TIME,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.updateTimer=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(mj.UPDATE_TIMER,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.setCohost=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.SET_COHOST,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.cancelCohost=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.CANCEL_COHOST,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.mutateAuxiRtcPerm=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(mj.MUTATE_AUXI_RTC_PERM,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.exitFollowGroup=function(){this.sendRCmd(mj.EXIT_FOLLOW)},t.prototype.resumeFollowGroup=function(){this.sendRCmd(mj.RESUME_FOLLOW)},t}(Sp),bj=function(t){var n=t.success,i=W().getUpimeTrans;return e.useContext(xl).phoneMode?e.createElement(bV,{className:gV.phoneModal,header:i("meeting.cancel"),footer:[e.createElement("span",{key:"reject",onClick:function(){n(!1)}},i("meeting.cancel.dialog.reject")),e.createElement("span",{key:"confirm",className:j(gV.phoneReject),onClick:function(){n(!0)}},i("meeting.cancel"))]},i("meeting.cancel.dialog.content")):e.createElement("div",{className:j(gV.root)},e.createElement("div",{className:gV.content},e.createElement("span",{className:j(gV.title)},i("meeting.cancel")),e.createElement("span",{className:j(gV.desc)},i("meeting.cancel.dialog.content"))),e.createElement("div",{className:j(gV.actions)},e.createElement(ul,{className:j(gV.reject),onClick:function(){n(!1)},type:"secondary"},i("meeting.cancel.dialog.reject")),e.createElement(ul,{type:"danger",className:j(gV.confirm),onClick:function(){n(!0)}},i("meeting.cancel"))))},Ej=function(t){var n=t.success,i=W().getUpimeTrans,r=e.useState(5),o=r[0],a=r[1],s=e.useContext(xl),l=s.phoneMode,c=s.upime,u=e.useRef(5),d=c.localUserInfo.role===Pt.VISITOR;e.useEffect((function(){var e=setInterval((function(){if(!u.current)return clearInterval(e),void n(!0);u.current-=1,a(u.current)}),1e3);return function(){clearInterval(e)}}),[]);var p=function(){n(!0)},h=[e.createElement("span",{key:"confirm",onClick:p,className:gV.phoneConfirm},"".concat(i("meeting.end.confirm"),"(").concat(o,"s)"))];return l?e.createElement(bV,{className:gV.phoneModal,footer:h},e.createElement("div",{className:j(gV.phoneForceLeave,d&&gV.visitorMode)},i("meeting.endBy.host"))):e.createElement("div",{className:j(gV.endMeetingRoot)},e.createElement("div",{className:gV.forceLeave},i("meeting.endBy.host")),e.createElement(ul,{type:"primary",className:gV.confirm,onClick:p},"".concat(i("meeting.end.confirm"),"(").concat(o,"s)")))},xj=function(t){var n=t.success,i=W().getUpimeTrans,r=function(){n(!0)};return e.useContext(xl).phoneMode?e.createElement(bV,{className:gV.phoneModal,footer:[e.createElement("span",{key:"confirm",onClick:r,className:gV.phoneConfirm},i("meeting.end.confirm"))]},e.createElement("div",{className:gV.phoneForceLeave},i("meeting.conflict.dialog"))):e.createElement("div",{className:j(gV.endMeetingRoot)},e.createElement("div",{className:gV.forceLeave},i("meeting.conflict.dialog")),e.createElement(ul,{type:"primary",className:gV.confirm,onClick:r},i("meeting.end.confirm")))},wj=function(t){var n=t.success,i=t.content,r=i.host,o=i.title,a=i.onConfirm,s=i.nickName,l=i.cannotJoin,c=i.isVisitor,u=i.planStart,d=i.planEnd,p=W().getUpimeTrans,h=e.useContext(xl).phoneMode;al(r);var f=e.useState(null!=s?s:""),m=f[0],v=f[1],g=c&&""===m,y=[e.createElement("span",{className:j(gV.phoneConfirm,g&&gV.disableConfirm),key:"join",onClick:function(){n(!0),a(m)}},p("meeting.join"))];if(c||y.unshift(e.createElement("span",{key:"ignore",onClick:function(){return n(!1)}},p("meeting.ignore"))),l)return h?e.createElement(bV,{className:gV.phoneModal,header:p("meeting.not.start.yet"),footer:[e.createElement("span",{className:gV.phoneConfirm,key:"ignore",onClick:function(){return n(!1)}},p("guide.btn.try"))]},e.createElement("div",{className:j(gV.desc),style:{textAlign:"left"}},p("meeting.forbid.join.tip"))):e.createElement("div",{className:j(gV.root,gV.cannotJoinBox),style:{height:"unset",minHeight:"182px"}},e.createElement("div",{className:gV.content},e.createElement("span",{className:gV.title},p("meeting.not.start.yet")),e.createElement("span",{className:gV.subtitle},p("meeting.forbid.join.tip"))),e.createElement("div",{className:j(gV.actions)},e.createElement(ul,{type:"primary",className:j(gV.confirm),onClick:function(){n(!1)}},p("guide.btn.try"))));var b=new Date(u),E=b.getFullYear(),x="0".concat(b.getMonth()+1).slice(-2),w="0".concat(b.getDate()).slice(-2),C="0".concat(b.getHours()).slice(-2),S="0".concat(b.getMinutes()).slice(-2),k=new Date(d),_="0".concat(k.getHours()).slice(-2),T="0".concat(k.getMinutes()).slice(-2);return h?e.createElement(bV,{className:gV.phoneModal,header:p("meeting.autojoin.title"),footer:y},e.createElement(e.Fragment,null,e.createElement("div",{className:j(gV.desc),style:{textAlign:"left"}},p("meeting.autojoin.content",o)),e.createElement("div",{className:j(gV.desc),style:{textAlign:"left"}},p("meeting.starttime"),":"," ","".concat(E,"-").concat(x,"-").concat(w," ").concat(C,":").concat(S,"-").concat(_,":").concat(T)),c&&e.createElement(gl,{placeholder:["meeting.enter.nickname.hint"],maxLen:20,value:m,onChange:function(e){return v(e.target.value)},onClearClick:function(){return v("")},className:gV.nickNameInput}))):e.createElement("div",{className:j(gV.root),style:{height:"unset",minHeight:"182px"}},e.createElement("div",{className:gV.content},e.createElement("div",{style:{display:"flex"}},e.createElement("span",{className:j(gV.title,gV.userName)},r.userName),e.createElement("span",{className:j(gV.title,gV.titleDesc)},p("meeting.autojoin.confirm.title"))),e.createElement("span",{className:j(gV.desc)},p("meeting.autojoin.content",o)),e.createElement("span",{className:j(gV.desc)},p("meeting.starttime"),":"," ","".concat(E,"-").concat(x,"-").concat(w," ").concat(C,":").concat(S,"-").concat(_,":").concat(T))),c&&e.createElement(gl,{placeholder:["meeting.enter.nickname.hint"],maxLen:20,value:m,onChange:function(e){return v(e.target.value)},onClearClick:function(){return v("")},className:gV.nickNameInput}),e.createElement("div",{className:j(gV.actions)},!c&&e.createElement(ul,{className:j(gV.reject),onClick:function(){n(!1)},type:"secondary"},p("meeting.ignore")),e.createElement(ul,{type:"primary",className:j(gV.confirm),onClick:function(){n(!0),a(m)},disabled:g},p("meeting.join"))))},Cj=function(e,t){return function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:return t.sent(),[2,0];case 2:return[2,t.sent().message];case 3:return[2]}}))}))}},Sj=function(){function e(e){var t=this;this.config=e,this.audioDevice="",this.videoDevice="",this._rtcEngine=null,this._localAudioTrack=null,this._localVideoTrack=null,this._localScreenVideoTrack=null,this._localScreenAudioTrack=null,this._localVideoTrackMirrorMode=!0,this._inMeeting=!1,this._remoteHostMap={},this._rtcUsersMap={},this._volumeCheckTimer=null,this.userPublishHandler=function(e,n){return A(t,void 0,void 0,(function(){var t,i,r,o;return D(this,(function(a){switch(a.label){case 0:return this._remoteHostMap[+e.uid]=Object.assign(e,{upimeMirror:!1}),(null==(t=this._rtcUsersMap[+e.uid])?void 0:t.video)||(null==t?void 0:t.audio)?[4,this.geRtcEngine().subscribe(e,n)]:[3,2];case 1:(i=a.sent()).stop(),t.video&&"video"===n&&t.ele&&(i.play(t.ele,{fit:"contain"}),this.dealPictureInPicture(t.ele)),t.audio&&"audio"===n&&i.play(),a.label=2;case 2:return null===(o=null===(r=this.config)||void 0===r?void 0:r.onUserPublish)||void 0===o||o.call(r,e),[2]}}))}))},this.userUnpublishHandler=function(e,n){var i,r,o=t._remoteHostMap[+e.uid];o&&("audio"===n&&o.audioTrack&&o.audioTrack.stop(),"video"===n&&o.videoTrack&&o.videoTrack.stop(),e.hasAudio||e.hasVideo?t._remoteHostMap[+e.uid]=Object.assign(e,{upimeMirror:o.upimeMirror}):delete t._remoteHostMap[+e.uid]),null===(r=null===(i=t.config)||void 0===i?void 0:i.onUserUnPublish)||void 0===r||r.call(i,e)},this.userLeftHandler=function(e){var n,i,r,o,a,s;null===(i=null===(n=t._remoteHostMap[+e.uid])||void 0===n?void 0:n.audioTrack)||void 0===i||i.stop(),null===(o=null===(r=t._remoteHostMap[+e.uid])||void 0===r?void 0:r.videoTrack)||void 0===o||o.stop(),delete t._remoteHostMap[e.uid],null===(s=null===(a=t.config)||void 0===a?void 0:a.onUserLeft)||void 0===s||s.call(a,e)},this.geRtcEngine()}return Object.defineProperty(e.prototype,"localAudioStream",{get:function(){return this._localAudioTrack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localVideoStream",{get:function(){return this._localVideoTrack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localScreenVideoStream",{get:function(){return this._localScreenVideoTrack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localScreenAudioStream",{get:function(){return this._localScreenAudioTrack},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uid",{get:function(){var e;return null===(e=this._rtcEngine)||void 0===e?void 0:e.uid},enumerable:!1,configurable:!0}),e.prototype.getMicDevices=function(){return nm.getMicrophones()},e.prototype.getPlaybackDevices=function(){return nm.getPlaybackDevices()},e.prototype.getCameraDevices=function(){return nm.getCameras()},Object.defineProperty(e.prototype,"audioDeviceId",{set:function(e){e!==this.audioDevice&&(this.audioDevice=e,this._inMeeting&&this._localAudioTrack&&this._localAudioTrack.setDevice(e))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoDeviceId",{set:function(e){e!==this.videoDevice&&(this.videoDevice=e,this._inMeeting&&this._localVideoTrack&&this._localVideoTrack.setDevice(e))},enumerable:!1,configurable:!0}),e.prototype.geRtcEngine=function(){var e;return this._rtcEngine||(nm.enableLogUpload(),nm.setLogLevel(1),this._rtcEngine=nm.createClient({clientRoleOptions:{level:2},mode:"live",codec:"h264",role:null===(e=this.config)||void 0===e?void 0:e.defaultRole})),this._rtcEngine},e.prototype.switchRole=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,Cj()((function(){return A(t,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return e!==Nt.HOST?[3,2]:[4,this.geRtcEngine().setClientRole("host")];case 1:return t.sent(),[3,4];case 2:return[4,this.geRtcEngine().setClientRole("audience",{level:2})];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}))]}))}))},e.prototype.getLocalVideoTrack=function(){var e,t;return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return this._localVideoTrack?[3,2]:(n=this,[4,nm.createCameraVideoTrack(exports.E({cameraId:this.videoDevice,facingMode:"user",optimizationMode:"motion"},null===(t=null===(e=this.config)||void 0===e?void 0:e.localStreamConfigs)||void 0===t?void 0:t.videoConfig))]);case 1:n._localVideoTrack=i.sent(),i.label=2;case 2:return[2,this._localVideoTrack]}}))}))},e.prototype.getLocalAudioTrack=function(){var e,t;return A(this,void 0,void 0,(function(){var n,i=this;return D(this,(function(r){switch(r.label){case 0:return this._localAudioTrack?[3,2]:(n=this,[4,nm.createMicrophoneAudioTrack(exports.E({AEC:!0,ANS:!0,microphoneId:this.audioDevice,encoderConfig:"music_standard"},null===(t=null===(e=this.config)||void 0===e?void 0:e.localStreamConfigs)||void 0===t?void 0:t.audioConfig))]);case 1:n._localAudioTrack=r.sent(),this._volumeCheckTimer=setInterval((function(){var e;i.onMicVolumeChange(null===(e=i._localAudioTrack)||void 0===e?void 0:e.getVolumeLevel())}),200),r.label=2;case 2:return[2,this._localAudioTrack]}}))}))},e.prototype.getLocalScreenVideoAndAudioTrack=function(){var e,t;return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return[4,nm.createScreenVideoTrack(Object.assign({encoderConfig:"720p_3",displaySurface:"window",optimizationMode:"detail"},null===(t=null===(e=this.config)||void 0===e?void 0:e.localStreamConfigs)||void 0===t?void 0:t.shareConfig),"auto")];case 1:return n=i.sent(),Array.isArray(n)?(this._localScreenVideoTrack=n[0],this._localScreenAudioTrack=n[1]):this._localScreenVideoTrack=n,[2,[this._localScreenVideoTrack,this._localScreenAudioTrack]]}}))}))},e.prototype.enableLocalScreenVideoAndAudio=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,Cj()((function(){return A(t,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return this._localScreenVideoTrack&&this._localScreenAudioTrack?[3,2]:[4,this.getLocalScreenVideoAndAudioTrack()];case 1:r.sent(),r.label=2;case 2:return[4,Promise.all([null===(t=this._localScreenVideoTrack)||void 0===t?void 0:t.setEnabled(!0),null===(n=this._localScreenAudioTrack)||void 0===n?void 0:n.setEnabled(!0)])];case 3:return r.sent(),this._localScreenAudioTrack?[4,this.geRtcEngine().publish([this._localScreenVideoTrack,this._localScreenAudioTrack])]:[3,5];case 4:return r.sent(),[3,7];case 5:return[4,this.geRtcEngine().publish(this._localScreenVideoTrack)];case 6:r.sent(),r.label=7;case 7:return null===(i=this._localScreenVideoTrack)||void 0===i||i.once("track-ended",e),[2]}}))}))}))]}))}))},e.prototype.disableLocalScreenVideoAndAudio=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){var e,t,n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return this._localScreenVideoTrack||this._localScreenAudioTrack?[4,Promise.all([null===(e=this._localScreenVideoTrack)||void 0===e?void 0:e.setEnabled(!1),null===(t=this._localScreenAudioTrack)||void 0===t?void 0:t.setEnabled(!1)])]:[2,!0];case 1:return a.sent(),null===(n=this._localScreenVideoTrack)||void 0===n||n.stop(),null===(i=this._localScreenVideoTrack)||void 0===i||i.close(),null===(r=this._localScreenAudioTrack)||void 0===r||r.stop(),null===(o=this._localScreenAudioTrack)||void 0===o||o.close(),this._localScreenAudioTrack?[4,this.geRtcEngine().unpublish([this._localScreenVideoTrack,this._localScreenAudioTrack])]:[3,3];case 2:return a.sent(),[3,5];case 3:return[4,this.geRtcEngine().unpublish(this._localScreenVideoTrack)];case 4:a.sent(),a.label=5;case 5:return this._localScreenVideoTrack=null,this._localScreenAudioTrack=null,[2]}}))}))}))]}))}))},e.prototype.enableLocalAudio=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this._localAudioTrack?[3,2]:[4,this.getLocalAudioTrack()];case 1:t.sent(),t.label=2;case 2:return[4,null===(e=this._localAudioTrack)||void 0===e?void 0:e.setEnabled(!0)];case 3:return t.sent(),[4,this.geRtcEngine().publish(this._localAudioTrack)];case 4:return t.sent(),[2]}}))}))}))]}))}))},e.prototype.enableLocalVideo=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this._localVideoTrack?[3,2]:[4,this.getLocalVideoTrack()];case 1:t.sent(),t.label=2;case 2:return[4,null===(e=this._localVideoTrack)||void 0===e?void 0:e.setEnabled(!0)];case 3:return t.sent(),[4,this.geRtcEngine().publish(this._localVideoTrack)];case 4:return t.sent(),[2]}}))}))}))]}))}))},e.prototype.disableLocalAudio=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this._localAudioTrack?[4,this._localAudioTrack.setEnabled(!1)]:[2,!0];case 1:return e.sent(),[4,this.geRtcEngine().unpublish(this._localAudioTrack)];case 2:return e.sent(),[2]}}))}))}))]}))}))},e.prototype.disableLocalVideo=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this._localVideoTrack?[4,this._localVideoTrack.setEnabled(!1)]:[2,!0];case 1:return e.sent(),[4,this.geRtcEngine().unpublish(this._localVideoTrack)];case 2:return e.sent(),[2]}}))}))}))]}))}))},e.prototype.setRemoteVideoStreamType=function(e,t){return A(this,void 0,void 0,(function(){var n=this;return D(this,(function(i){return[2,Cj()((function(){return A(n,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.geRtcEngine().setRemoteVideoStreamType(e,t)];case 1:return n.sent(),[2]}}))}))}))]}))}))},e.prototype.onRemoteFirstFrameDecoded=function(e,t){var n,i=this._remoteHostMap[+e];i&&(null===(n=i.videoTrack)||void 0===n||n.on("first-frame-decoded",t))},e.prototype.subscribe=function(e,t,n){return A(this,void 0,void 0,(function(){var i=this;return D(this,(function(r){return[2,Cj()((function(){return A(i,void 0,void 0,(function(){var i,r,o;return D(this,(function(a){switch(a.label){case 0:return this._rtcUsersMap[+e]=exports.E(exports.E(exports.E(exports.E({},this._rtcUsersMap[+e]),"video"===t&&{video:!0}),"audio"===t&&{audio:!0}),n&&{ele:n}),(i=this._remoteHostMap[+e])?"audio"!==t?[3,3]:i.audioTrack||!i.hasAudio?[3,2]:[4,this.geRtcEngine().subscribe(i,"audio")]:[3,6];case 1:a.sent(),a.label=2;case 2:return null===(r=i.audioTrack)||void 0===r||r.play(),[3,6];case 3:return n?i.videoTrack||!i.hasVideo?[3,5]:[4,this.geRtcEngine().subscribe(i,"video")]:[3,6];case 4:a.sent(),a.label=5;case 5:null===(o=i.videoTrack)||void 0===o||o.play(n,{mirror:i.upimeMirror,fit:"contain"}),this.dealPictureInPicture(n),a.label=6;case 6:return[2]}}))}))}))]}))}))},e.prototype.unsubscribe=function(e,t){return A(this,void 0,void 0,(function(){var n=this;return D(this,(function(i){return[2,Cj()((function(){return A(n,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){return n=this._remoteHostMap[+e],this._rtcUsersMap[+e]&&("audio"===t&&(this._rtcUsersMap[+e].audio=!1),"video"===t&&(this._rtcUsersMap[+e].video=!1,this._rtcUsersMap[+e].ele=void 0)),n&&("audio"===t&&(null===(i=this._remoteHostMap[+e].audioTrack)||void 0===i||i.stop()),"video"===t&&(null===(r=this._remoteHostMap[+e].videoTrack)||void 0===r||r.removeAllListeners("first-frame-decoded"),null===(o=this._remoteHostMap[+e].videoTrack)||void 0===o||o.stop())),[2]}))}))}))]}))}))},e.prototype.startLocalPreview=function(e){this._localVideoTrack&&this._localVideoTrack.enabled?this._localVideoTrack.play(e,{mirror:this._localVideoTrackMirrorMode,fit:"contain"}):this._localScreenVideoTrack&&this._localScreenVideoTrack.enabled&&this._localScreenVideoTrack.play(e,{mirror:this._localVideoTrackMirrorMode,fit:"contain"}),this.dealPictureInPicture(e)},e.prototype.stopLocalPreview=function(){this._localVideoTrack&&this._localVideoTrack.enabled?this._localVideoTrack.stop():this._localScreenVideoTrack&&this._localScreenVideoTrack.enabled&&this._localScreenVideoTrack.stop()},e.prototype.join=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,Cj()((function(){return A(t,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return t=e.mediaId,n=e.vendorKey,i=e.channelName,r=e.token,this.geRtcEngine().setLowStreamParameter({width:320,height:180,framerate:15,bitrate:280}),this.geRtcEngine().enableAudioVolumeIndicator(),[4,this.geRtcEngine().enableDualStream()];case 1:return o.sent(),[4,this.geRtcEngine().join(n,i,r,t)];case 2:return o.sent(),this._inMeeting=!0,this.geRtcEngine().on("user-published",this.userPublishHandler),this.geRtcEngine().on("user-unpublished",this.userUnpublishHandler),this.geRtcEngine().on("user-left",this.userUnpublishHandler),this.geRtcEngine().on("volume-indicator",this.onRemoteVolumeChange),[2]}}))}))}))]}))}))},e.prototype.leave=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){return[2,Cj()((function(){return A(e,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.geRtcEngine().disableDualStream()];case 1:return e.sent(),[4,this.geRtcEngine().leave()];case 2:return e.sent(),this._rtcEngine=null,this._remoteHostMap={},this._inMeeting=!1,this.release(),[2]}}))}))}))]}))}))},e.prototype.toggleVideoMirrorMode=function(e){if(void 0!==e){var t=this._remoteHostMap[e];if(!t)return;t.upimeMirror=!t.upimeMirror}else this._localVideoTrackMirrorMode=!this._localVideoTrackMirrorMode},e.prototype.getVideoMirrorMode=function(e){var t;return void 0===e?this._localVideoTrackMirrorMode:!!(null===(t=this._remoteHostMap[e])||void 0===t?void 0:t.upimeMirror)},e.prototype.dealPictureInPicture=function(e){},e.prototype.release=function(){this._localAudioTrack&&(this._localAudioTrack.stop(),this._localAudioTrack.close()),this._localVideoTrack&&(this._localVideoTrack.stop(),this._localVideoTrack.close()),this._localScreenAudioTrack&&(this._localScreenAudioTrack.stop(),this._localScreenAudioTrack.close()),this._localScreenVideoTrack&&(this._localScreenVideoTrack.stop(),this._localScreenVideoTrack.close()),this._volumeCheckTimer&&clearInterval(this._volumeCheckTimer),this._volumeCheckTimer=null},e.prototype.onMicVolumeChange=function(e){},e.prototype.onRemoteVolumeChange=function(e){},e}(),kj="iconBox_3K0ij",_j="sliderBtn_3WSwu",Tj="pc_1ApMM",Ij="upBtn_2_rkT",Pj="downBtn_G1Z2B",Nj="btnDisabled_11Cql",Mj="mixBox_TmvtM",Aj="videoContainer_sXLil",Dj="avatarContainer_3r5DY",Rj="avatar_2kRaF",Bj="mediaBar_Jlsgf",Lj="micIconBox_6I7Ri",Oj="volume_3DLqs",Fj="divider_3Mksw",zj="camIconBox_XvVS_",Hj="header_1_vl9",Uj="shareIconBox_1340w",Wj="profileBox_2qul4",Vj="btnRow_3W-a0",jj="listbox_3k1M6",Gj="rtcBlockPhoneBox_1ORnM",qj="topLeftFloat_2EIJ9",Kj="detached_2vQjr",Yj="footer_3dPhq",Xj="identity_2XT-I",Qj="micIconContainer_35YUo",Zj="bar_2IijT",Jj="hoverTipRoot_2a1Xp",$j=e.createContext(null),eG=!0,tG=e.forwardRef((function(i,r){var o=i.rtcChannel,a=i.rtcSource,s=i.baseOffset,l=i.setBaseOffset,c=i.isLast,u=e.useRef(null),d=a.userInfo,p=e.useState(o.getVideoMirrorMode(-1===a.mediaId?void 0:a.mediaId)),h=p[0],f=p[1],m=e.useState(!1),v=m[0],g=m[1],y=e.useContext($j),b=y.enlargeVideoConRef,E=y.toggleRtcList,x=e.useContext(Ic).rootContainer,w=e.useContext(xl).phoneMode,C=W().getUpimeTrans,S=e.useState(!1),k=S[0],_=S[1],T=e.useState(!1),I=T[0],P=T[1],N=e.useRef(null),M=e.useRef(0);al(d),al(o,["topRtcUser","remoteMicVolumes"]),e.useImperativeHandle(r,(function(){return{resetTouched:function(){P(!1)}}}));var A=e.useRef(null),D=function(){var e,t,n=x.current,i=n.clientWidth,r=n.clientHeight,o=r-120,a=16*o/9,s=.5*(i-a),l=.5*(r-o);null===(e=A.current)||void 0===e||e.setSize(a,o),null===(t=A.current)||void 0===t||t.forceMoveTo(s,l)};e.useEffect((function(){var e,t=-1===a.mediaId?null===(e=o.rtcIns)||void 0===e?void 0:e.geRtcEngine().uid:a.mediaId,n=o.remoteMicVolumes.find((function(e){return e.uid===t}));n&&N.current&&(N.current.style.height=.1*n.level+"px")}),[o.remoteMicVolumes]),e.useEffect((function(){o.screenSharer&&o.screenSharer===d.loginName?(v&&D(),g(!0),eG=!0):g(!1)}),[o.screenSharer]);var B=e.useState(!1),L=B[0],O=B[1],F=e.useState(!0),z=F[0],H=F[1],U=e.useRef(0),G=yh(!0,{checkSkip:function(e){return V(t=document.getElementById("blockActionPortal"),n=e)||t==n;var t,n},quick:!0}),q=G.hide,K=G.toggleHide,Y=G.skipRef;e.useEffect((function(){v&&o.screenSharer&&o.screenSharer===d.loginName&&D()}),[v]),e.useEffect((function(){var e,t;if(o.localScreenVideoEnabled){var n=null===(t=null===(e=o.rtcIns)||void 0===e?void 0:e.localScreenVideoStream)||void 0===t?void 0:t.getMediaStreamTrack().getSettings();eG&&n&&("monitor"===n.displaySurface||"browser"===n.displaySurface&&!document.hidden)&&(O(!0),eG=!1)}else O(!1)}),[o.localScreenVideoEnabled]),e.useEffect((function(){if((a.video||a.screenShare)&&a.buffered)-1===a.mediaId?o.startLocalPreview(u.current):o.subscribeRemote(a.mediaId,"video",u.current,v?n.RemoteStreamType.HIGH_STREAM:n.RemoteStreamType.LOW_STREAM);else if(!a.video&&!a.screenShare||!v)if(-1!==a.mediaId)o.unsubscribeRemote(a.mediaId,"video");else{o.stopLocalPreview();for(var e=u.current;e.lastChild;)e.removeChild(e.lastChild)}}),[a.video,a.screenShare,a.buffered,v]),e.useEffect((function(){a.audio?-1!==a.mediaId&&o.subscribeRemote(a.mediaId,"audio"):-1!==a.mediaId&&o.unsubscribeRemote(a.mediaId,"audio")}),[a.audio]),e.useEffect((function(){return function(){-1!==a.mediaId&&(a.audio&&o.unsubscribeRemote(a.mediaId,"audio"),(a.video||a.screenShare)&&o.unsubscribeRemote(a.mediaId,"video")),clearTimeout(M.current)}}),[]);var X=function(){var e=-1===a.mediaId?void 0:a.mediaId;o.toggleVideoMirrorMode(e),f(o.getVideoMirrorMode(e))},Q=o.topRtcUser===a.userInfo.loginName,Z=function(){o.changeTopUser(a.userInfo.loginName,Q?0:1)},J=function(){if(g(!v),!v&&w&&E(),v){for(var e=0;e<s.length&&U.current!==s[e];e++);s.splice(e,1),l(R([],s,!0))}else U.current=s[0]>(x.current.clientHeight-320)/2?s[0]:s[0]+40,s.unshift(U.current),l(R([],s,!0))},$=e.useRef({}),ee="";if("meetingData"in o){var te=o;te.hostId===a.userInfo.loginName?ee=C("meeting.identity.host"):te.curViewSrc===a.userInfo.loginName&&(ee=C("meeting.identity.presenter"))}var ne=e.createElement("div",{className:"footer_2BN-f"},o.screenSharer&&o.screenSharer===d.loginName?e.createElement(e.Fragment,null,e.createElement("div",{className:"shareIconBox_KMbke"},e.createElement(hl,{icon:"gongxiangpingmu"})),e.createElement("span",null,-1===a.mediaId?"".concat(C("common.you")):d.meetingName+" ",C("meeting.screen.share.going"))):e.createElement(e.Fragment,null,ee&&e.createElement("div",{className:"identity_3h_h3"},ee),e.createElement("div",{className:j("micIconContainer_3vf1g")},a.audio?e.createElement(e.Fragment,null,e.createElement(hl,{icon:"maikefeng-kai"}),e.createElement("div",{className:"volume_3S_B9",ref:N})):e.createElement(hl,{icon:"maikefeng-guan-new"})),e.createElement("span",null,d.meetingName,-1===a.mediaId?"(".concat(C("common.me"),")"):""))),ie=e.createElement(e.Fragment,null,e.createElement("div",{className:"avatarContainer_Daww3"},e.createElement(ml,{shape:"circle",url:d.avatarUrl,className:"avatar_tQY6d"})),e.createElement("div",{ref:u,className:j("videoContainer_2tjGM",c&&"last_3MFEZ"),style:{transform:h?"rotateY(180deg)":"rotateY(0deg)"}}),v&&L&&e.createElement("div",{className:"coverContainer_vIm8s"},z&&e.createElement(e.Fragment,null,e.createElement("div",{className:"title_hRfdb"},C("meeting.screen.share.cover.title")),e.createElement("div",{className:"subtitle_1RUCP"},C("meeting.screen.share.cover.subtitle")),e.createElement("div",{className:"actionRow_JSAwY"},e.createElement("div",{className:"continueBtn_2LD-6",onClick:function(){O(!1)}},C("common.continue")),e.createElement("div",{className:"stopBtn_3-MlT",onClick:function(){o.disableLocalScreenVideoAndAudio()}},C("meeting.screen.share.icon.stop"))))),ne),re=function(){var e,t=null===(e=Y.current)||void 0===e?void 0:e.getBoundingClientRect();t&&($.current.top=t.top+32,$.current.right=window.innerWidth-t.right),K()};return e.createElement(e.Fragment,null,e.createElement("div",{className:"blockRoot_2ukEg",onPointerEnter:function(){_e.isHoverSupported&&_(!0)},onPointerLeave:function(){_e.isHoverSupported&&_(!1)},onTouchStartCapture:function(){P(!I),I||(clearTimeout(M.current),M.current=window.setTimeout((function(){P(!1)}),3e3))}},v?e.createElement(e.Fragment,null,e.createElement("div",{className:"detachedContent_3o6Vl"},e.createElement(hl,{icon:"dakaidulihuamian"}),e.createElement("span",null,C("meeting.independent.view.opened"))),ne):e.createElement(e.Fragment,null,ie),Q&&e.createElement("div",{className:"topLeftFloat_2b3X-"},e.createElement(hl,{icon:"zhiding"})),(k||I||!q)&&e.createElement("div",{className:j("cornerBtn_2ey9O",!q&&"active_2kkHX"),onClick:re,onTouchStartCapture:re,ref:Y},e.createElement(hl,{icon:"gengduo"}),!q&&t.createPortal(e.createElement(xh,{align:"right",selfAdjust:!0,className:"morePanel_25wIz",extraStyle:$.current},o.canChangeTopUser&&e.createElement("div",{className:Zj,onClick:Z,onTouchStartCapture:Z},e.createElement(hl,{icon:Q?"quxiaozhiding":"zhiding"}),e.createElement("span",null,C(Q?"meeting.cancel.avatar.top":"meeting.move.avatar.top"))),a.video&&e.createElement("div",{className:Zj,onClick:X,onTouchStartCapture:X},e.createElement(hl,{icon:h?"mirror-on":"mirror-off"}),e.createElement("span",null,C("meeting.video.mirror"))),e.createElement("div",{className:Zj,onClick:J,onTouchStartCapture:J},e.createElement(hl,{icon:v?"shouqidulihuamian":"dakaidulihuamian"}),e.createElement("span",null,C(v?"meeting.close.independent.view":"meeting.open.independent.view")))),document.getElementById("blockActionPortal")))),v&&b.current&&t.createPortal(e.createElement(Hc,{className:"draggableAvatar_2X3q9",supportResize:!0,supportFourCornersResize:!0,initOffset:function(){var e=x.current,t=e.clientWidth,n=e.clientHeight;return{x:(t-480)/2+U.current,y:(n-320)/2+U.current}}(),minScale:.75,ref:A,onResize:function(e,t){H(!(e<327))}},e.createElement(e.Fragment,null,ie,e.createElement(Dl,{content:C("meeting.close.independent.view"),rootClass:j("closeBtn_192oN",Jj)},e.createElement(hl,{icon:"shouqidulihuamian",onClick:function(){g(!1);for(var e=0;e<s.length&&U.current!==s[e];e++);s.splice(e,1),l(R([],s,!0))}})),(a.video||a.screenShare)&&e.createElement(e.Fragment,null,e.createElement("div",{className:"mirrorIconCon_3VjIc"},e.createElement(Dl,{rootClass:Jj,content:C("meeting.video.mirror")},e.createElement(hl,{icon:h?"mirror-on":"mirror-off",onClick:X}))),e.createElement("div",{className:"maxIconCon_1nUTw"},e.createElement(Dl,{rootClass:Jj,content:C("meeting.screen.share.maximize")},e.createElement(hl,{icon:"shiyezuidahua",onClick:function(){D()}})))))),b.current,a.userInfo.loginName))})),nG=e.memo(tG);!function(e){e.UPDATE_LIST="UPDATE_LIST",e.UPDATE_VISIBILITY="UPDATE_VISIBILITY"}(gj||(gj={}));var iG,rG={renderList:[],maxItems:0},oG=function(e,t){switch(t.type){case gj.UPDATE_LIST:var n,i,r=t.payload,o=r.localSource,a=r.remoteSources,s=r.topUser,l=r.screenSharer,c=r.host,u=[exports.E(exports.E({},o),{buffered:!0})],d=[];if(Object.values(a).forEach((function(e){if(e.userInfo.loginName!==s){var t=exports.E(exports.E({},e),{video:e.video,audio:e.audio,screenShare:e.screenShare,buffered:!0});e.userInfo.loginName===l?n=t:e.userInfo.loginName===c?i=t:d.push(t)}})),n&&u.push(n),i&&u.push(i),u.push.apply(u,d),s&&s!==o.userInfo.loginName){var p=a[s];p&&u.unshift(exports.E(exports.E({},p),{buffered:!0}))}return exports.E(exports.E({},e),{renderList:u});case gj.UPDATE_VISIBILITY:var h=t.payload,f=h.curHead,m=h.maxItem,v=(u=e.renderList).map((function(e,t){return exports.E(exports.E({},e),{buffered:t>=f-2&&t<f+m+2})}));return v[0]&&(v[0].buffered=!0),exports.E(exports.E({},e),{renderList:v});default:return e}},aG=function(t){var n=t.upime,i=t.className,r=t.rtcChannel;al(r,["rtcJoined","rtcListHided"]);var o=e.useRef(null),a=e.useRef(null),s=n.localUserInfo.role===Pt.RECORD_ASSISTANT,l=function(){o.current&&r&&(o.current.resetDrag(),o.current.enableDrag(!0),r.toggleRtcList(!0))};return e.useEffect((function(){var e=[n.subscribe("fullscreenModeChange",(function(e){e&&o.current&&r&&!r.rtcListHided&&(o.current.resetDrag(),o.current.enableDrag(!1),o.current.forceMoveTo(248,0),r.toggleRtcList(!1))})),n.subscribe("toolbarVisibilityChange",(function(e){"hidden"===e&&o.current&&r&&!r.rtcListHided&&(o.current.resetDrag(),o.current.enableDrag(!1),o.current.forceMoveTo(248,0),r.toggleRtcList(!1))}))];return function(){e.forEach((function(e){return e()}))}}),[]),(null==r?void 0:r.rtcJoined)?e.createElement($j.Provider,{value:{enlargeVideoConRef:a,toggleRtcList:l}},e.createElement(Hc,{className:j("root_1jyVi",i,r.rtcListHided&&"listHided_xwE6e",s&&"hide_2ZSIJ"),ref:o,safeDistance:8},e.createElement(sG,{rtcChannel:r,upime:n})),r.rtcListHided&&e.createElement("div",{className:j("sideToggle_1QrNC"),onClick:l},e.createElement(hl,{icon:"jiantou-you"})),e.createElement("div",{className:"enlargedVideoCon_1RozS",ref:a}),e.createElement("div",{id:"blockActionPortal",className:"blockActionPanel_2wlaF"})):null};!function(e){e[e.Mini=1]="Mini",e[e.Single=2]="Single",e[e.All=3]="All"}(iG||(iG={}));var sG=function(t){var n=t.rtcChannel,i=t.upime,r=e.useRef(null),o=W().getUpimeTrans,a=e.useState(iG.All),s=a[0],l=a[1],c=function(t,n,i,r){al(t,["localMemberState","remoteMemberStates","topRtcUser","remoteMicVolumes"]);var o=e.useReducer(oG,rG),a=o[0].renderList,s=o[1],l=e.useContext(zc),c=l.dragged,u=l.dragEvent;l.resetDrag;var d=e.useRef(0),p=e.useRef(0),h=e.useRef(0),f=e.useRef(0),m=e.useState({show:!1,couldUp:!1,couldDown:!1}),v=m[0],g=m[1],y=e.useContext(Ic).rootContainer.current,b=e.useRef(!1),E=e.useRef(!1),x=e.useRef(0),w=e.useRef(0),C=e.useRef(!0),S=e.useRef([]),k=e.useState(""),_=k[0],T=k[1];e.useEffect((function(){var e=t.remoteMicVolumes.slice(0,3),n=Array.from(new Set(R(R([],e,!0),S.current,!0).sort((function(e,t){return t.level-e.level})).map((function(e){return e.uid})))).slice(0,3),i=R([t.localMemberState],Object.values(t.remoteMemberStates),!0),o="";if(n.forEach((function(e){var n=i.find((function(n){var i;return(-1===n.mediaId?null===(i=t.rtcIns)||void 0===i?void 0:i.geRtcEngine().uid:n.mediaId)===e}));n&&(o+=n.userInfo.userName+", ")})),T(o.slice(0,-2)),r===iG.Single)if(n.length>0){var s=a.findIndex((function(e){var i;return(-1===e.mediaId?null===(i=t.rtcIns)||void 0===i?void 0:i.geRtcEngine().uid:e.mediaId)===n[0]})),l=p.current-s;M(l>0,Math.abs(l))}else M(p.current>0,Math.abs(p.current));S.current=e}),[t.remoteMicVolumes]);var I=function(){var e=r===iG.All&&h.current<f.current,t=r===iG.All&&p.current>0,n=r===iG.All&&p.current+h.current<f.current;g({show:e,couldDown:n,couldUp:t})},P=function(e){if(E.current)setTimeout((function(){return P(e)}),500);else{var t=n.current;if(t){var i=t.parentElement,o=0;if(r===iG.All)if(e)o=(y.clientHeight-195)/117;else{var a=t.getBoundingClientRect().top,l=y.getBoundingClientRect(),c=l.top;o=(l.height-(a-c)-60)/117}else r===iG.Single&&(o=1);h.current=Math.floor(o);var u=Math.min(h.current,f.current);w.current=u;var d=119*u;t.style.height="".concat(d,"px");var m=d+75;x.current!==m&&(b.current=!0,x.current=m),i.style.height="".concat(m,"px"),I(),s({type:gj.UPDATE_VISIBILITY,payload:{maxItem:h.current,curHead:p.current}})}}};e.useEffect((function(){C.current?(P(!0),C.current=!1):(P(!1),r===iG.All&&N())}),[r]),e.useEffect((function(){s({type:gj.UPDATE_LIST,payload:{localSource:t.localMemberState,remoteSources:t.remoteMemberStates,topUser:t.topRtcUser,screenSharer:t.screenSharer,host:t.hostId}})}),[t.localMemberState,t.remoteMemberStates,t.topRtcUser,t.screenSharer,t.hostId]),e.useEffect((function(){var e;if(t.topRtcUser){var i=null===(e=n.current)||void 0===e?void 0:e.firstChild;if(!i)return;i.style.transform="translate(".concat(0,"px, ").concat(0,"px)"),d.current=0,p.current=0,I(),s({type:gj.UPDATE_VISIBILITY,payload:{curHead:0,maxItem:h.current}})}}),[t.topRtcUser]);var N=function(){p.current+w.current>f.current&&M(!0,p.current+w.current-f.current)};e.useEffect((function(){var e,t=Od((function(){P(!1)}),i),r=ne((function(e){return M(e)}),400),o=function(e){e.preventDefault(),e.stopPropagation(),h.current>=f.current||function(){var e=document.getElementById("blockActionPortal");return!!(e&&e.children.length>0)}()||(e.deltaY>0&&!E.current&&r(!1),e.deltaY<0&&!E.current&&r(!0))};if(_e.desktop){var a=null===(e=n.current)||void 0===e?void 0:e.firstElementChild;a&&a.addEventListener("wheel",o)}var s=[u.subscribe("end",(function(){P(!1),N(),setTimeout((function(){b.current=!1}),350)})),u.subscribe("start",(function(){b.current=!0})),u.subscribe("reset",(function(){P(!0),N()}))];return function(){t(),window.removeEventListener("wheel",o),s.forEach((function(e){return e()}))}}),[r]),e.useEffect((function(){var e=n.current;if(e){var t=e.parentElement;e.addEventListener("transitionend",(function(){E.current=!1})),t.addEventListener("transitionend",(function(){b.current=!1}))}}),[]),e.useEffect((function(){var e=f.current;f.current=a.length;var t=h.current;if(e>t&&p.current+t>a.length){var n=p.current+t-a.length;if(M(!0,n),a.length>=h.current)return}e!==a.length&&(e<t||a.length<t?P(!c):I())}),[a,a.length,c]);var M=function(e,t){var i;void 0===t&&(t=1);var o=null===(i=n.current)||void 0===i?void 0:i.firstChild;if(o&&(!e||0!==p.current)&&(e||!(p.current+h.current>=f.current))){E.current=!0;var a=p.current;p.current+=e?-t:t,p.current=Math.max(p.current,0);var l=a-p.current;d.current+=119*l,r===iG.Single?(o.style.transition="none",E.current=!1):o.style.transition="transform 0.2s ease",o.style.transform="translate(".concat(0,"px, ").concat(d.current,"px)"),I(),s({type:gj.UPDATE_VISIBILITY,payload:{curHead:p.current,maxItem:h.current}})}},A=e.useCallback((function(){b.current||M(!0)}),[]),D=e.useCallback((function(){b.current||M(!1)}),[]);return{renderList:a,goUp:A,goDown:D,btnState:v,speakingNames:_,lastIdx:p.current+h.current}}(n,r,i,s),u=c.renderList,d=c.goUp,p=c.goDown,h=c.btnState,f=c.speakingNames,m=c.lastIdx;h.show;var v=h.couldUp,g=h.couldDown,y=e.useRef({}),b=e.useState([-40]),E=b[0],x=b[1];return e.createElement(e.Fragment,null,e.createElement("div",{className:"modeChangeBar_ZHvSH"},e.createElement("div",{className:"switchBox_39H2Y"},e.createElement(Dl,{placement:"top",content:o("rtc.yincangshipinsuoluetu")},e.createElement("div",{className:kj,onClick:function(){l(iG.Mini)}},e.createElement(hl,{icon:"shipinshouqi",style:{color:s===iG.Mini?"#fff":""}}))),e.createElement(Dl,{placement:"top",content:o("rtc.zhixianshitakingperson")},e.createElement("div",{className:kj,onClick:function(){l(iG.Single)}},e.createElement(hl,{icon:"xianshidangeshipin",style:{color:s===iG.Single?"#fff":""}}))),e.createElement(Dl,{placement:"top",content:o("rtc.xianshichenyuanliebiao")},e.createElement("div",{className:kj,onClick:function(){l(iG.All)}},e.createElement(hl,{icon:"zhankaichengyuan",style:{color:s===iG.All?"#fff":""}})))),e.createElement("div",{className:"hideBox_2BRMK"},e.createElement(Dl,{placement:"top",content:o("rtc.shouqiliebiao")},e.createElement("div",{className:kj,onClick:function(){n.toggleRtcList(!1)}},e.createElement(hl,{icon:"shouqiliebiao",style:{color:"#fff"}}))))),e.createElement("div",{className:j("speakingBar_29MAL",s===iG.Mini&&"round_5Dco5")},e.createElement("span",null,o("rtc.speaking")),e.createElement("span",null,f)),e.createElement("div",{ref:r,className:"viewport_2rmNk",onTouchStartCapture:function(){for(var e in y.current)y.current[e].resetTouched()}},e.createElement("div",{className:"transList_i2kjX"},u.map((function(t,i){return e.createElement(nG,{rtcChannel:n,key:t.mediaId,rtcSource:t,ref:function(e){e&&(y.current[t.mediaId]=e)},baseOffset:E,setBaseOffset:x,isLast:i+1===m})})))),v&&e.createElement("div",{className:j(_j,Ij,Tj),onClick:function(){return d()}},e.createElement(hl,{icon:"jiantou-shang"})),g&&e.createElement("div",{className:j(_j,Pj,Tj),onClick:function(){return p()}},e.createElement(hl,{icon:"jiantou-xia"})))},lG=function(){function e(e,t){var n=this;this.config=e,this.manager=t,this.extraLivePlayers=[],this.auxillaryRtcIns=null,this.rtcUserMap={},this.onAuxillaryRtcUserChange=function(e){var t,i,r=e.uid,o=e.hasAudio,a=e.hasVideo,s=null===(t=n.rtcUserMap)||void 0===t?void 0:t[r];if(s){s.hasAudio=o,s.hasVideo=a,n.rtcUserMap=exports.E({},n.rtcUserMap);var l=null===(i=n.manager.auxillaryRemoteUserMap)||void 0===i?void 0:i[r];if(l){var c=l.video,u=l.audio;n.muteMediaAudio(r,u),n.muteMediaVideo(r,c)}}},this.onAuxillaryRtcUserLeft=function(e){var t,i=e.uid,r=null===(t=n.rtcUserMap)||void 0===t?void 0:t[i];r&&(r.hasAudio=!1,r.hasVideo=!1,n.rtcUserMap=exports.E({},n.rtcUserMap),n.muteMediaAudio(i,!1),n.muteMediaVideo(i,!1))};var i=e.externalMediaInfo;this.rtcUserMap=i.reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t.mediaId]={usage:1===t.usage?"screen":"camera",hasVideo:!1,hasAudio:!1},n))}),{}),this.joinAuxillaryRtcChannel()}return e.prototype.joinAuxillaryRtcChannel=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return(e=this.config.rtc).vendor,Mt.AGORA,[3,1];case 1:return[4,om()];case 2:return t.sent(),this.auxillaryRtcIns=new Sj({defaultRole:"audience",onUserPublish:this.onAuxillaryRtcUserChange,onUserUnPublish:this.onAuxillaryRtcUserChange,onUserLeft:this.onAuxillaryRtcUserLeft}),[4,this.auxillaryRtcIns.join(e)];case 3:t.sent()&&(this.rtcUserMap={}),this.initAllRtcUser(),t.label=4;case 4:return[2]}}))}))},e.prototype.initAllRtcUser=function(){var e=this,t=this.manager.auxillaryRemoteUserMap;t&&Object.values(t).forEach((function(t){var n=t.audio,i=t.video;e.muteMediaAudio(+t.mediaId,n),e.muteMediaVideo(+t.mediaId,i)}))},e.prototype.releaseAuxiRtcIns=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this.rtcUserMap={},this.extraLivePlayers.forEach((function(e){return e.stopPlay()})),this.auxillaryRtcIns?[4,this.auxillaryRtcIns.leave()]:[2];case 1:return e.sent(),this.auxillaryRtcIns=null,[2]}}))}))},e.prototype.addLivePlayer=function(e){this.extraLivePlayers.includes(e)||this.extraLivePlayers.push(e)},e.prototype.removeLivePlayer=function(e){this.extraLivePlayers=this.extraLivePlayers.filter((function(t){return t!==e}))},e.prototype.muteMediaAudio=function(e,t){var n,i,r=this.rtcUserMap[e];if(r){var o=r.streamPlayer,a=r.hasAudio&&t;o||(o=r.streamPlayer=this.extraLivePlayers.find((function(e){return e.playerType===r.usage})),o&&o.updateOnline(!0)),o&&a!==o.micOn&&a!==o.micOn&&(a?null===(n=this.auxillaryRtcIns)||void 0===n||n.subscribe(e,"audio"):null===(i=this.auxillaryRtcIns)||void 0===i||i.unsubscribe(e,"audio"),o.updateMicState(a))}},e.prototype.muteMediaVideo=function(e,t){var n,i=this,r=this.rtcUserMap[e];if(r){var o=r.streamPlayer,a=r.hasVideo&&t;o||(o=r.streamPlayer=this.extraLivePlayers.find((function(e){return e.playerType===r.usage})),o&&o.updateOnline(!0)),o&&a!==o.cameraOn&&(a?o.playRtcStream((function(t){var n;null===(n=i.auxillaryRtcIns)||void 0===n||n.subscribe(e,"video",t)})):null===(n=this.auxillaryRtcIns)||void 0===n||n.unsubscribe(e,"video"),o.updateCameraState(a))}},e.prototype.destroy=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.releaseAuxiRtcIns()];case 1:return e.sent(),[2]}}))}))},e}();function cG(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=e.useContext(xl).phoneMode,a=i.kind,s=[e.createElement("span",{key:"ignore",onClick:function(){return n(!1)}},r(1===a?"meeting.zanbudakai.mic":"meeting.zanbudakai.cam")),e.createElement("span",{key:"open",style:{color:"#2e73e5"},onClick:function(){n(!0)}},r(1===a?"meeting.open.mic":"meeting.open.cam"))];return o?e.createElement(bV,{className:gV.phoneModal,header:r(1===a?"meeting.host.requet.mic":"meeting.host.requet.cam"),footer:s}):e.createElement("div",{className:gV.requestMediaBox},e.createElement("div",{className:gV.headRow},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",{className:gV.wording},r(1===a?"meeting.host.requet.mic":"meeting.host.requet.cam"))),e.createElement("div",{className:gV.actionRow},e.createElement("div",{className:gV.cancel,onClick:function(){n(!1)}},r(1===a?"meeting.zanbudakai.mic":"meeting.zanbudakai.cam")),e.createElement("div",{className:gV.confirm,onClick:function(){n(!0)}},r(1===a?"meeting.open.mic":"meeting.open.cam"))))}function uG(t){var n=t.fail;t.content;var i=W().getUpimeTrans,r=e.useContext(xl).phoneMode,o=[e.createElement("span",{key:"join",style:{color:"#2e73e5"},onClick:function(){n("cancel")}},i("meeting.end.confirm"))];return r?e.createElement(bV,{className:gV.phoneModal,header:i("meeting.yichuhuiyi.tip"),footer:o}):e.createElement("div",{className:gV.outMeetingModalBox},e.createElement("div",{className:gV.headRow},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",{className:gV.wording},i("meeting.yichuhuiyi.tip"))),e.createElement("div",{className:gV.actionRow},e.createElement("div",{className:gV.btn,onClick:function(){n("cancel")}},i("meeting.end.confirm"))))}function dG(t){var n=t.success,i=W().getUpimeTrans,r=e.useContext(xl),o=r.upime,a=r.phoneMode,s=o.localUserInfo.role===Pt.TEAMMEMBER;return a?e.createElement("div",{className:gV.inRecordingDialogBoxPhone},e.createElement("div",{className:gV.iconCol},e.createElement(hl,{icon:"yinshipintonghua"})),e.createElement("div",{className:gV.contentCol},e.createElement("div",null,i("meeting.recording.dialog.header")),e.createElement("div",null,i(s?"meeting.recording.dialog.body.member.phone":"meeting.recording.dialog.body.guest"))),e.createElement("div",{className:gV.btnCol},e.createElement("div",{className:gV.confirm,onClick:function(){n(0)}},i("guide.btn.try")))):e.createElement("div",{className:gV.inRecordingDialogBox},e.createElement("div",{className:gV.headerRow},e.createElement(hl,{icon:"yinshipintonghua"}),e.createElement("span",null,i("meeting.recording.dialog.header"))),e.createElement("div",{className:gV.bodyRow},i(s?"meeting.recording.dialog.body.member":"meeting.recording.dialog.body.guest")),e.createElement("div",{className:gV.footerRow},e.createElement("div",{className:gV.confirm,onClick:function(){n(0)}},i("guide.btn.try"))))}function pG(t){var n=t.success,i=W().getUpimeTrans,r=e.useContext(xl),o=r.upime,a=r.phoneMode,s=o.localUserInfo.role===Pt.TEAMMEMBER;if(a){var l=[e.createElement("span",{key:"leave",onClick:function(){n(0)}},i("meeting.leave")),e.createElement("span",{className:gV.phoneConfirm,key:"iknow",onClick:function(){return n(1)}},i("guide.btn.try"))];return e.createElement(bV,{className:gV.phoneModal,header:i("meeting.recording.modal.header"),footer:l},e.createElement("p",{style:{color:"#616371",textAlign:"center"}},i(s?"meeting.recording.modal.body.member":"meeting.recording.modal.body.guest")),e.createElement("p",{style:{textAlign:"center"}},i("meeting.recording.modal.body.reminder")))}return e.createElement("div",{className:gV.inRecordingFirstModalBox},e.createElement("div",{className:gV.headerRow},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,i("meeting.recording.modal.header"))),e.createElement("div",{className:gV.bodyRow},e.createElement("p",{className:gV.text},i(s?"meeting.recording.modal.body.member":"meeting.recording.modal.body.guest")),e.createElement("p",{className:gV.reminder},i("meeting.recording.modal.body.reminder"))),e.createElement("div",{className:gV.footerRow},e.createElement("div",{className:gV.cancel,onClick:function(){n(0)}},i("meeting.leave")),e.createElement("div",{className:gV.confirm,onClick:function(){n(1)}},i("guide.btn.try"))))}function hG(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=e.useContext(xl),a=o.upime,s=o.phoneMode,l=i.reason,c=a.localUserInfo.role===Pt.TEAMMEMBER;return s?e.createElement("div",{className:gV.endRecordingDialogBoxPhone},e.createElement("div",{className:gV.contentCol},e.createElement("div",null,r("meeting.record.end.dialog.header")),e.createElement("div",null,r(0===l?c?"meeting.record.end.dialog.body.member.phone":"meeting.record.end.dialog.body.guest":"meeting.record.end.dialog.body.network"))),e.createElement("div",{className:gV.btnCol},e.createElement("div",{className:gV.confirm,onClick:function(){n(0)}},r("guide.btn.try")))):e.createElement("div",{className:gV.endRecordingDialogBox},e.createElement("div",{className:gV.headerRow},e.createElement("span",null,r("meeting.record.end.dialog.header"))),e.createElement("div",{className:gV.bodyRow},r(0===l?c?"meeting.record.end.dialog.body.member":"meeting.record.end.dialog.body.guest":"meeting.record.end.dialog.body.network")),e.createElement("div",{className:gV.footerRow},e.createElement("div",{className:gV.confirm,onClick:function(){n(0)}},r("guide.btn.try"))))}var fG="miniMode_1ompl",mG="shareCtrlBox_2QMHf",vG="red_1MnrZ",gG="disabled_3_fmK",yG="shareWarningModal_UVO8o",bG="wordingBox_21dBN",EG="actionBtn_2cCU1",xG="shareChangeModal_3rnvO",wG="subtitle_19eNG",CG="actionRow_2FRj9",SG="cancel_ZRWbj",kG="confirm_tzeAF";function _G(t){var n=t.success,i=W().getUpimeTrans;return e.createElement("div",{className:"permissionDenyModal_im1cP"},e.createElement("div",{className:bG},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,i("meeting.screen.share.perm.deny.title"))),e.createElement("div",{className:wG},i("meeting.screen.share.perm.deny.subtitle")),e.createElement("div",{className:CG},e.createElement("div",{className:SG,onClick:function(){n(0)}},i("common.cancel")),e.createElement("div",{className:kG,onClick:function(){n(1);var e=document.createElement("a");e.href="x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture",e.click()}},i("meeting.screen.share.perm.deny.action"))))}var TG=function(e){function t(t){var n=e.call(this)||this;return n.hostId="",n.rtcIns=null,n.mics=[],n.cameras=[],n.curMic="",n.curCam="",n.localMicVolume=0,n.remoteMicVolumes=[],n.rtcJoined=!1,n.localVideoSuspending=!0,n.localVideoEnabled=!1,n.localAudioEnabled=!1,n.localScreenVideoEnabled=!1,n.audioTempEnable=!1,n.TempOpenAudioDenied=!1,n.spaceKeyPressed=!1,n.localAudioSuspending=!0,n.reachHostLimit=!1,n.remoteMemberStates={},n.rtcListHided=!1,n.micPermDenied=!1,n.camPermDenied=!1,n.openMicWillBeDenied=!1,n.openCamWillBeDenied=!1,n.rtcMaxHostNumber=0,n.topRtcUser="",n._isRtcHost=!1,n.prevMic="",n.waitingTempAudio=!1,n._hasGrantedPerm=!1,n.onMicrophoneChange=function(e){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.updateMicDevices()];case 1:return e.sent(),[2]}}))}))},n.updateMicDevices=function(){return A(n,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.rtcIns?(e=this,[4,this.rtcIns.getMicDevices()]):[2];case 1:return e.mics=t.sent(),[2]}}))}))},n.updateCamDevices=function(){return A(n,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.rtcIns?(e=this,[4,this.rtcIns.getCameraDevices()]):[2];case 1:return e.cameras=t.sent(),[2]}}))}))},n.upime=t,n.localMemberState={video:!1,audio:!1,screenShare:!1,mediaId:-1,userInfo:t.localUserInfo},n.deviceHelpLink=t.deviceHelpLink,_e.desktop&&n.listenSpaceKey(),n}return P(t,e),Object.defineProperty(t.prototype,"alwaysHost",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canChangeTopUser",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultSelectedUserOnPhone",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.initRtcEngine=function(e,t){var n,i,r,o;return A(this,void 0,void 0,(function(){var a,s,l,c=this;return D(this,(function(u){switch(u.label){case 0:return e.vendor,Mt.AGORA,[3,1];case 1:return[4,om()];case 2:u.sent(),this.rtcMaxHostNumber=e.mediaQuota,this.rtcIns=new Sj({localStreamConfigs:null==t?void 0:t[Mt.AGORA]}),this.rtcIns.onMicVolumeChange=function(e){return c.localMicVolume=e},this.rtcIns.onRemoteVolumeChange=function(e){c.remoteMicVolumes=e.filter((function(e){return e.level>60})).sort((function(e,t){return t.level-e.level}))},u.label=3;case 3:return u.trys.push([3,5,,6]),a=this,[4,this.rtcIns.getMicDevices()];case 4:return a.mics=u.sent(),this.curMic=null!==(i=null===(n=this.mics[0])||void 0===n?void 0:n.deviceId)&&void 0!==i?i:"",this.rtcIns.audioDeviceId=this.curMic,[3,6];case 5:return u.sent(),this.micPermDenied=!0,[3,6];case 6:return u.trys.push([6,8,,9]),s=this,[4,this.rtcIns.getCameraDevices()];case 7:return s.cameras=u.sent(),this.curCam=null!==(o=null===(r=this.cameras[0])||void 0===r?void 0:r.deviceId)&&void 0!==o?o:"",this.rtcIns.videoDeviceId=this.curCam,[3,9];case 8:return u.sent(),this.camPermDenied=!0,[3,9];case 9:this.localAudioSuspending=!1,this.localVideoSuspending=!1,nm.on("microphone-changed",this.onMicrophoneChange),u.label=10;case 10:return[4,this.rtcIns.join(e)];case 11:return(l=u.sent())||(this.rtcJoined=!0),[2,l]}}))}))},t.prototype.switchRole=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return(t=this.rtcIns)?this._isRtcHost===(e===Nt.HOST)?[3,2]:[4,t.switchRole(e)]:[2,"rtc not init"];case 1:return(n=i.sent())||(this._isRtcHost=e===Nt.HOST),[2,n];case 2:return[2,0]}}))}))},t.prototype.switchMic=function(e){this.rtcIns&&(this.curMic=e,this.rtcIns.audioDeviceId=e)},t.prototype.switchCam=function(e){this.rtcIns&&(this.curCam=e,this.rtcIns.videoDeviceId=e)},t.prototype.doApplyForHostRole=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2,"error"]}))}))},t.prototype.applyForHostRole=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this._hasGrantedPerm?[3,2]:[4,this.doApplyForHostRole()];case 1:return(e=t.sent())?(1===e&&(this.reachHostLimit=!0),[2,e]):(this._hasGrantedPerm=!0,this.reachHostLimit=!1,this._isRtcHost?[2,0]:[2,this.switchRole(Nt.HOST)]);case 2:return[2,this.switchRole(Nt.HOST)];case 3:return[2]}}))}))},t.prototype.enableLocalAudio=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return(e=this.rtcIns)?(this.localAudioSuspending=!0,[4,this.applyForHostRole()]):[2,"rtc not init"];case 1:return n.sent()?[3,3]:[4,e.enableLocalAudio()];case 2:(t=n.sent())?this.onLocalAudioOpenFail(t):(this.localAudioEnabled=!0,this.audioTempEnable||this.upime.addToast(O("rtc.audio.enabled"),{type:"normal"}),this.localMemberState=exports.E(exports.E({},this.localMemberState),{audio:!0}),this.onLocalAudioOpenSuccess()),n.label=3;case 3:return this.localAudioSuspending=!1,[2]}}))}))},t.prototype.onLocalAudioOpenSuccess=function(){},t.prototype.onLocalAudioOpenFail=function(e){},t.prototype.disableLocalAudio=function(e){return void 0===e&&(e=!0),A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return(t=this.rtcIns)?(this.localAudioSuspending=!0,n=this.audioTempEnable,this.audioTempEnable=!1,[4,t.disableLocalAudio()]):[2,"rtc not init"];case 1:return r.sent()||(this.localAudioEnabled=!1,n&&e||(i=O(e?"rtc.audio.disabled":"meeting.audio.disabledByHost"),this.upime.addToast(i,{type:"normal"})),this.localMemberState=exports.E(exports.E({},this.localMemberState),{audio:!1}),this.localVideoEnabled||(!this.alwaysHost&&this.switchRole(Nt.AUDIENCE),this._hasGrantedPerm=!1),this.onLocalAudioCloseSuccess(e)),this.localAudioSuspending=!1,[2]}}))}))},t.prototype.onLocalAudioCloseSuccess=function(e){},t.prototype.enableLocalVideo=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return(e=this.rtcIns)?this.localScreenVideoEnabled?[4,this.disableLocalScreenVideoAndAudio()]:[3,2]:[2,"rtc not init"];case 1:n.sent(),n.label=2;case 2:return this.localVideoSuspending=!0,[4,this.applyForHostRole()];case 3:return n.sent()?[3,5]:[4,e.enableLocalVideo()];case 4:(t=n.sent())?this.onLocalVideoOpenFail(t):(this.localVideoEnabled=!0,this.upime.addToast(O("rtc.video.enabled"),{type:"normal"}),this.localMemberState=exports.E(exports.E({},this.localMemberState),{video:!0}),this.onLocalVideoOpenSuccess()),n.label=5;case 5:return this.localVideoSuspending=!1,[2]}}))}))},t.prototype.onLocalVideoOpenSuccess=function(){},t.prototype.onLocalVideoOpenFail=function(e){},t.prototype.disableLocalVideo=function(e){return void 0===e&&(e=!0),A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return(t=this.rtcIns)?(this.localVideoSuspending=!0,[4,t.disableLocalVideo()]):[2,"rtc not init"];case 1:return i.sent()||(this.localVideoEnabled=!1,n=O(e?"rtc.video.disabled":"meeting.video.disabledByHost"),this.upime.addToast(n,{type:"normal"}),this.localMemberState=exports.E(exports.E({},this.localMemberState),{video:!1}),this.localAudioEnabled||(!this.alwaysHost&&this.switchRole(Nt.AUDIENCE),this._hasGrantedPerm=!1),this.onLocalVideoCloseSuccess(e)),this.localVideoSuspending=!1,[2]}}))}))},t.prototype.onLocalVideoCloseSuccess=function(e){},t.prototype.enableLocalScreenVideoAndAudio=function(){return A(this,void 0,void 0,(function(){var e,t,n=this;return D(this,(function(i){switch(i.label){case 0:return(e=this.rtcIns)?this.localVideoEnabled?[4,this.disableLocalVideo()]:[3,2]:[2,"rtc not init"];case 1:i.sent(),i.label=2;case 2:return[4,this.applyForHostRole()];case 3:return i.sent()?[3,5]:[4,e.enableLocalScreenVideoAndAudio((function(){n.disableLocalScreenVideoAndAudio()}))];case 4:(t=i.sent())?this.onScreenVideoAndAudioOpenFail(t):(this.localScreenVideoEnabled=!0,this.localMemberState=exports.E(exports.E({},this.localMemberState),{screenShare:!0}),this.onScreenVideoAndAudioOpenSuccess()),i.label=5;case 5:return[2]}}))}))},t.prototype.onScreenVideoAndAudioOpenSuccess=function(){},t.prototype.onScreenVideoAndAudioOpenFail=function(e){},t.prototype.disableLocalScreenVideoAndAudio=function(e){return void 0===e&&(e=!0),A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return(t=this.rtcIns)?[4,t.disableLocalScreenVideoAndAudio()]:[2,"rtc not init"];case 1:return n.sent()||(this.localScreenVideoEnabled=!1,this.localMemberState=exports.E(exports.E({},this.localMemberState),{screenShare:!1}),this.localAudioEnabled||(!this.alwaysHost&&this.switchRole(Nt.AUDIENCE),this._hasGrantedPerm=!1),this.onScreenVideoAndAudioCloseSuccess(e)),[2]}}))}))},t.prototype.onScreenVideoAndAudioCloseSuccess=function(e){},t.prototype.startLocalPreview=function(e){var t=this.rtcIns;return t?t.startLocalPreview(e):"rtc not init"},t.prototype.stopLocalPreview=function(){var e=this.rtcIns;return e?e.stopLocalPreview():"rtc not init"},t.prototype.subscribeRemote=function(e,t,i,r){return void 0===r&&(r=n.RemoteStreamType.HIGH_STREAM),A(this,void 0,void 0,(function(){var n;return D(this,(function(o){switch(o.label){case 0:return(n=this.rtcIns)?"video"!==t?[3,2]:[4,n.setRemoteVideoStreamType(e,r)]:[2,"rtc not init"];case 1:o.sent(),o.label=2;case 2:return[4,n.subscribe(e,t,i)];case 3:return[2,o.sent()]}}))}))},t.prototype.unsubscribeRemote=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return(n=this.rtcIns)?[4,n.unsubscribe(e,t)]:[2,"rtc not init"];case 1:return[2,i.sent()]}}))}))},t.prototype.leaveRtc=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return(e=this.rtcIns)?(e.release(),nm.off("microphone-changed",this.onMicrophoneChange),[4,e.leave()]):[2,"rtc not init"];case 1:return t=n.sent(),[2,Promise.resolve(t)]}}))}))},t.prototype.toggleRtcList=function(e){this.rtcListHided=!e},t.prototype.clearReachHostLimit=function(){this.reachHostLimit=!1},t.prototype.changeTopUser=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2]}))}))},t.prototype.toggleVideoMirrorMode=function(e){var t;null===(t=this.rtcIns)||void 0===t||t.toggleVideoMirrorMode(e)},t.prototype.getVideoMirrorMode=function(e){var t;return!!(null===(t=this.rtcIns)||void 0===t?void 0:t.getVideoMirrorMode(e))},t.prototype.listenSpaceKey=function(){var e=this,t=null,n=[this.upime.registerHotKey({key:"F2"},(function(){return A(e,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this.spaceKeyPressed?[3,3]:(this.spaceKeyPressed=!0,this.clearReachHostLimit(),this.micPermDenied?(this.TempOpenAudioDenied=!0,[2]):[4,new Promise((function(e){null!==t&&window.clearTimeout(t),t=window.setTimeout(e,500)}))]);case 1:return e.sent(),this.localAudioEnabled||this.localAudioSuspending?[3,3]:(this.waitingTempAudio=!0,this.audioTempEnable=!0,[4,this.enableLocalAudio()]);case 2:e.sent(),this.localAudioEnabled?this.waitingTempAudio||this.disableLocalAudio(!0):(this._hasGrantedPerm||(this.TempOpenAudioDenied=!0),this.audioTempEnable=!1),this.waitingTempAudio=!1,e.label=3;case 3:return[2]}}))}))})),this.upime.registerKeyup(["F2"],(function(){e.spaceKeyPressed&&(e.spaceKeyPressed=!1,null!==t&&(window.clearTimeout(t),t=null),e.TempOpenAudioDenied&&(e.TempOpenAudioDenied=!1),e.waitingTempAudio&&(e.waitingTempAudio=!1),e.localAudioEnabled&&e.audioTempEnable&&e.disableLocalAudio(!0))}))];this.unListenSpaceKey=function(){n.forEach((function(e){return e()})),null!==t&&window.clearTimeout(t)}},t.prototype.destroy=function(){var e;null===(e=this.unListenSpaceKey)||void 0===e||e.call(this)},M([rl],t.prototype,"mics",void 0),M([rl],t.prototype,"cameras",void 0),M([rl],t.prototype,"curMic",void 0),M([rl],t.prototype,"curCam",void 0),M([rl],t.prototype,"localMicVolume",void 0),M([rl],t.prototype,"remoteMicVolumes",void 0),M([rl],t.prototype,"rtcJoined",void 0),M([rl],t.prototype,"localVideoSuspending",void 0),M([rl],t.prototype,"localVideoEnabled",void 0),M([rl],t.prototype,"localAudioEnabled",void 0),M([rl],t.prototype,"localScreenVideoEnabled",void 0),M([rl],t.prototype,"screenSharer",void 0),M([rl],t.prototype,"TempOpenAudioDenied",void 0),M([rl],t.prototype,"spaceKeyPressed",void 0),M([rl],t.prototype,"localAudioSuspending",void 0),M([rl],t.prototype,"reachHostLimit",void 0),M([rl],t.prototype,"localMemberState",void 0),M([rl],t.prototype,"remoteMemberStates",void 0),M([rl],t.prototype,"rtcListHided",void 0),M([rl],t.prototype,"openMicWillBeDenied",void 0),M([rl],t.prototype,"openCamWillBeDenied",void 0),M([rl],t.prototype,"topRtcUser",void 0),M([il],t)}(ro),IG=function(){function e(e,t){void 0===t&&(t=""),this.upime=e,this.name=t,this.followConfig=this.getInitFollowConfig(),this.viewClipConfig=this.getInitViewConfig()}return Object.defineProperty(e.prototype,"view",{get:function(){return this.upime.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followManager",{get:function(){return this.upime.followManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"added",{get:function(){return void 0!==this.manager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actived",{get:function(){var e;return(null===(e=this.manager)||void 0===e?void 0:e.activedScene)===this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onlyActive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followingUser",{get:function(){return this.actived?this.followManager.followingUser:this.followConfig.target},enumerable:!1,configurable:!0}),e.prototype.getInitFollowConfig=function(){return{target:null,forcedFollowing:!1,forcedFollowHint:"",isStricky:!1,isSilent:!1}},e.prototype.getInitViewConfig=function(){return{viewClip:null}},e.prototype.setFollowingUser=function(e){var t=this.actived,n=this.followConfig;t?this.followManager.setFollowingUser(e):n.target=e},e.prototype.startFollowOther=function(e,t){void 0===t&&(t={});var n=this.actived,i=this.followConfig,r=t.connId,o=t.isStricky,a=void 0!==o&&o,s=t.isSilent,l=void 0!==s&&s;if(!n)return i.target=e,i.connId=r,i.isSilent=l,void(i.isStricky=a);this.followManager.startFollowOther(e,t)},e.prototype.endFollowOther=function(e){var t=this.actived,n=this.followConfig;t?this.followManager.endFollowOther(e):n.target=null},e.prototype.stopFollowCurrent=function(){var e=this.actived,t=this.followConfig;e?this.followManager.stopFollowCurrent():t.forcedFollowing||(t.target=null)},e.prototype.enableForceFollow=function(e){var t=this.actived,n=this.followConfig;if(!t)return n.forcedFollowing=!0,void(n.forcedFollowHint=e);this.followManager.enableForceFollow(e)},e.prototype.disableForceFollow=function(){var e=this.actived,t=this.followConfig;e?this.followManager.disableForceFollow():t.forcedFollowing=!1},e.prototype.setViewClip=function(e){var t=this,n=t.actived,i=t.viewClipConfig,r=t.view;n?(r.viewClip=e,r.update()):i.viewClip=e},e.prototype.clearViewClip=function(){var e=this,t=e.actived,n=e.viewClipConfig,i=e.view;t?(i.viewClip=null,i.update()):n.viewClip=null},e.prototype.saveAndPauseFollow=function(){var e=this.followConfig,t=this.followManager;e.target=t.followingUser,e.isStricky=t.stickyFollowing,e.isSilent=t.isSilent,e.forcedFollowing=t.forcedFollowing,e.forcedFollowHint=t.forcedFollowHint,e.target&&t.endFollowOther(e.target),e.forcedFollowing&&t.disableForceFollow()},e.prototype.resumeFollow=function(){var e=this.followConfig,t=e.target,n=e.isSilent,i=e.isStricky,r=e.forcedFollowing,o=e.forcedFollowHint;t&&(this.followManager.startFollowOther(t,{isSilent:n,isStricky:i}),r&&this.followManager.enableForceFollow(o)),this.followConfig=this.getInitFollowConfig()},e.prototype.saveAndClearViewClip=function(){var e=this.view;this.viewClipConfig={viewClip:e.viewClip},e.viewClip=null,e.update()},e.prototype.resumeViewClip=function(){var e=this.viewClipConfig,t=this.view;t.viewClip=e.viewClip,t.update(),this.viewClipConfig=this.getInitViewConfig()},e.prototype.sceneAdd=function(){var e;null===(e=this.onAdd)||void 0===e||e.call(this)},e.prototype.SceneRemove=function(){var e;null===(e=this.onRemove)||void 0===e||e.call(this)},e.prototype.sceneActive=function(){var e;this.resumeFollow(),this.resumeViewClip(),null===(e=this.onActive)||void 0===e||e.call(this)},e.prototype.sceneInactive=function(){var e;this.saveAndPauseFollow(),this.saveAndClearViewClip(),null===(e=this.onInactive)||void 0===e||e.call(this)},e.prototype.remove=function(){var e;null===(e=this.manager)||void 0===e||e.removeScene(this)},e}(),PG=function(){function e(e,t){var n=this;this.upime=e,this.meetingChannel=t,this.inGroup=!0,this.onStopFollow=function(){n.meetingChannel.curViewSrc!==n.upime.localUserInfo.loginName&&n.upime.publish("stopFollowInMeeting",void 0)}}return e.prototype.checkFollowAction=function(e,t){if(!this.inGroup)return!1;var n=this.meetingChannel.remoteMemberStates;return!(!n[e]||void 0!==t&&n[e].connectionId!==t||this.meetingChannel.absentJoiners.find((function(t){return t.loginName===e})))},e.prototype.isViewSrc=function(){return this.meetingChannel.curViewSrc===this.upime.localUserInfo.loginName},e.prototype.exitFollowGroup=function(){this.meetingChannel.exitFollowGroup(),this.inGroup=!1},e.prototype.resumeFollowGroup=function(){this.inGroup||(this.meetingChannel.resumeFollowGroup(),this.inGroup=!0)},e}(),NG=function(e){function t(t,n){var i=e.call(this,t)||this;return i.followGroup=new PG(t,n),i}return P(t,e),t.prototype.saveAndPauseFollow=function(){var e=this,t=e.followGroup,n=e.followConfig,i=e.followManager;t.exitFollowGroup(),n.target=i.followingUser,n.forcedFollowing=i.forcedFollowing,n.forcedFollowHint=i.forcedFollowHint,n.target&&i.stopFollowCurrent(),n.forcedFollowing&&i.disableForceFollow(),i.stickyFollowing=!1,i.isSilent=!1,i.followGroup=void 0,i.onStopFollowCurrent=void 0,this.upime.laserManager.stopReceiveLaserInfo(),this.upime.laserManager.reset()},t.prototype.resumeFollow=function(){var e=this,t=e.followGroup,n=e.followConfig,i=e.followManager;t.resumeFollowGroup(),i.followGroup=this.followGroup,i.stickyFollowing=!1,i.isSilent=!1,n.target&&(i.setFollowingUser(n.target),i.forcedFollowing&&i.enableForceFollow(n.forcedFollowHint)),i.onStopFollowCurrent=this.followGroup.onStopFollow,this.upime.laserManager.startReceiveLaserInfo(),this.followConfig=this.getInitFollowConfig()},t}(IG),MG=function(e){function t(t,n,i,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;o.upime=t,o.meetingData=n,o.configs=i,o.isFastMeeting=r,o.isHost=!1,o.isCohost=!1,o.remoteMemberStates={},o.editEnabled=!1,o.perm=WW.View,o.userPermApplyList=[],o.auxillaryRemoteUserMap=null,o.forceFollow=!1,o.shouldHideMeetingCtrl=!0,o.checkingMemberList=!1,o.proMeetingActFrozen=!1,o.absentJoiners=[],o.planJoinerIds=[],o.involvers=[],o.coHosts=[],o.hostMutatingId="",o.curViewSrc="",o._unsubs=[],o.vncs=[],o.vnsRcmdBuffer=new Set,o.isVncHost=!1,o.showTimer=!1,o.timerAddDuration=0,o.initBy="",o.updateStatus=!1,o.addTime=!1,o.startTimerVar=0,o.stopTimerVar=0,o.extraLivePlayers=[],o.externalMediaManager=null,o.endRecordingDialogId=-1,o.inRecordingDialogId=-1,o.opposeFF=[],o._progressMeetingMsgHandler=function(e){return A(o,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A,B,L,F,z,H,U,W,V,j,G,q,K,Y,X,Q,Z,J=this;return D(this,(function(D){switch(e.type){case fj.USER_JOINED:t=e.joinerData,(T=this.upime.getUserInfo(t.userId)).nickName=null!==(K=t.nickName)&&void 0!==K?K:"",T.role=t.role,n=!!(t.perm&qW.EDIT),i=!!(t.perm&qW.COMMENT),W=n?WW.Edit:i?WW.Comment:WW.View,this.remoteMemberStates=exports.E(exports.E({},this.remoteMemberStates),((G={})[t.userId]=exports.E(exports.E({},t),{userInfo:T,isHost:this.meetingData.host===t.userId,isCohost:this.coHosts.includes(t.userId),video:!!(t.perm&qW.VIDEO),audio:!!(t.perm&qW.AUDIO),screenShare:!!(t.perm&qW.SCREEN_SHARE),editable:n,perm:W,prevPerm:W,isForceFollowing:!!(this.opposeFF.includes(t.userId)?!this.forceFollow:this.forceFollow)}),G)),this.involvers.push({userId:t.userId,nickName:t.nickName,role:t.role}),this.absentJoiners=this.absentJoiners.filter((function(e){return e.loginName!==t.userId})),this.isHost&&this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(O("meeting.user.joined.postfix")):"".concat(T.meetingName," ").concat(O("meeting.user.joined.postfix")),{type:"normal"});break;case fj.USER_LEAVED:H=e.userId,this.remoteMemberStates[H]&&(T=this.remoteMemberStates[H].userInfo,this.absentJoiners=R(R([],this.absentJoiners,!0),[T],!1),delete this.remoteMemberStates[H],this.remoteMemberStates=exports.E({},this.remoteMemberStates),this.isHost&&this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(O("meeting.user.left.postfix")):"".concat(T.meetingName," ").concat(O("meeting.user.left.postfix")),{type:"normal"})),this.upime.laserManager.removeLaserPen(H),this.scene.followingUser===this.upime.getUserInfo(H)&&this.scene.stopFollowCurrent();break;case fj.USER_PERMISSION_CHANGED:if(H=e.userId,W=e.perm,r=e.en,H===this.upime.localUserInfo.loginName)switch(W){case qW.AUDIO:r||this.disableLocalAudio(!1);break;case qW.VIDEO:r||this.disableLocalVideo(!1);break;case qW.EDIT:this.enableSelfEdit(!1);break;case qW.COMMENT:this.enableSelfComment(!1);break;case qW.VIEW:this.enableSelfView(!1);break;case qW.SCREEN_SHARE:r||this.disableLocalScreenVideoAndAudio(!1)}else this.remoteMemberStates[H]&&(c=this.getMeetingPerm(W)||this.remoteMemberStates[H].perm,this.remoteMemberStates=exports.E(exports.E({},this.remoteMemberStates),((q={})[H]=exports.E(exports.E(exports.E(exports.E(exports.E(exports.E({},this.remoteMemberStates[H]),W===qW.AUDIO&&{audio:r}),W===qW.VIDEO&&{video:r}),W===qW.EDIT&&{editable:r}),W===qW.SCREEN_SHARE&&{screenShare:r}),{perm:c}),q)));break;case fj.PERM_APPLY:o=e.userPermApplyList,this.userPermApplyList=o;break;case fj.HANDLE_PERM_APPLY:a=e.userPermApply,s=a.userId,W=a.perm,l=a.status,this.userPermApplyList=this.userPermApplyList.filter((function(e){return e.userId!==s})),1===l?(c=WW.View,u="viewer",W===qW.EDIT?(c=WW.Edit,u="editor"):W===qW.COMMENT?(c=WW.Comment,u="commentor"):W===qW.VIEW&&(c=WW.View,u="viewer"),this.localMemberState.userId===s?(this.perm=c,this.localMemberState=exports.E(exports.E({},this.localMemberState),{perm:c}),this.upime.updateMeetingMode(u)):this.remoteMemberStates[s]&&(this.remoteMemberStates[s].perm=c,this.remoteMemberStates=exports.E({},this.remoteMemberStates))):2===l&&this.localMemberState.userId===s&&this.upime.addToast(O("meeting.apply.edit.perm.refused"));break;case fj.MEETING_ENDED:this._forceLeaveMeeting();break;case fj.FORCE_LEAVE:d=e.reason,this._forceLeaveMeeting(d);break;case fj.VIEW_SRC_CHANGED:H=e.userId,this.curViewSrc=H,p=this.scene,H===this.upime.localUserInfo.loginName?(p.disableForceFollow(),p.stopFollowCurrent()):(this.localMemberState.isForceFollowing&&this._setSelfForceFollow(),H!==this.localMemberState.userId&&p.setFollowingUser(this.upime.getUserInfo(H)),this.upime.view.exitImmersivePlay()),this.updateFileHelperDisplay(),this.setVncViewOnlyState();break;case fj.MEETING_FORCE_FOLLOW_CHANGED:h=e.status,this.forceFollow=!!h,this.localMemberState=exports.E(exports.E({},this.localMemberState),{isForceFollowing:!!h}),h?this.curViewSrc!==this.upime.localUserInfo.loginName&&(this._setSelfForceFollow(),this.scene.followingUser||this.scene.setFollowingUser(this.upime.getUserInfo(this.curViewSrc))):this.scene.disableForceFollow();break;case fj.USER_FORCE_FOLLOW_CHANGED:H=e.userId,f=e.status,this.localMemberState.userId===H?(this.localMemberState=exports.E(exports.E({},this.localMemberState),{isForceFollowing:!!f}),f?this.curViewSrc!==this.localMemberState.userId&&(this.scene.followingUser&&this.scene.setFollowingUser(this.upime.getUserInfo(this.curViewSrc)),this._setSelfForceFollow()):this.scene.disableForceFollow()):this.remoteMemberStates[H]&&(this.remoteMemberStates[H]=exports.E(exports.E({},this.remoteMemberStates[H]),{isForceFollowing:!!f}),this.remoteMemberStates=exports.E({},this.remoteMemberStates));break;case fj.VNC_OPENED:if(m=e.vncId,v=e.elmId,this.vncs.find((function(e){return e.vncId===m&&e.elmId===v})))return[2];g=this.startElementVnc(m,v,!1),this.vncs.push({vncId:m,elmId:v,webviewer:g});break;case fj.VNC_CLOSED:if(y=e.vncId,!(b=this.vncs.find((function(e){return e.vncId===y}))))return[2];this.vncs=this.vncs.filter((function(e){return e.vncId!==y})),this.stopElementVnc(b.elmId);break;case fj.RTC_MOVE_TOP:H=e.userId,E=e.status,this.remoteMemberStates[H]&&(this.topRtcUser=E?H:"",x=this.upime.getUserInfo(H),w=E?O("meeting.user.avatar.top.hint",function(e,t,n){var i=ta(e,14);if(i<86)return{resStr:e,width:i};for(var r=e.slice(0,e.length-1),o=ta(r+"...",12);o>=86;)r=r.slice(0,r.length-1),o=ta(r+"...",12);return{resStr:r+"...",width:o}}(x.meetingName).resStr):O("meeting.user.avatar.untop.hint"),this.upime.addToast(w));break;case fj.START_TIMER:H=e.userId,k=e.meetingTimer,T=this.upime.getUserInfo(H),this.startTimerVar++,this.meetingData.timer=k,this.upime.t_timerActive=!0,this.showTimer=!0,this.initBy="start",this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(O("timer.start.timer")):"".concat(T.meetingName," ").concat(O("timer.start.timer")));break;case fj.STOP_TIMER:H=e.userId,T=this.upime.getUserInfo(H),this.stopTimerVar++,this.showTimer=!1,this.upime.t_timerActive=!1,this.meetingData.timer=null,this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(O("timer.stop.timer")):"".concat(T.meetingName," ").concat(O("timer.stop.timer")));break;case fj.UPDATE_TIMER:H=e.userId,k=e.meetingTimer,T=this.upime.getUserInfo(H),this.updateStatus=!this.updateStatus,this.meetingData.timer=k,C=k.status,S=O("pause"===C?"timer.pause.timer":"timer.start.timer"),this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(S):"".concat(T.meetingName," ").concat(S));break;case fj.ADD_TIMER_TIME:H=e.userId,k=e.meetingTimer,_=e.duration,T=this.upime.getUserInfo(H),this.addTime=!this.addTime,this.meetingData.timer=k,this.timerAddDuration=_/1e3,I=O(_/6e4==1?"timer.add1.timer":"timer.add5.timer"),this.upime.addToast(T.meetingName.length>20?"".concat(T.meetingName.substring(0,20),"... ").concat(I):"".concat(T.meetingName," ").concat(I));break;case fj.SET_COHOST:P=e.userId,this.remoteMemberStates[P]&&(this.remoteMemberStates[P].isCohost=!0,this.remoteMemberStates[P].audio=!0,this.remoteMemberStates[P].editable=!0,this.remoteMemberStates[P].prevPerm=this.remoteMemberStates[P].perm,this.remoteMemberStates[P].perm=WW.Edit,this.remoteMemberStates=exports.E({},this.remoteMemberStates)),this.localMemberState.userId===P&&(this.localMemberState.isCohost=!0,this.isCohost=!0,this.localMemberState.prevPerm=this.localMemberState.perm,this.localAudioEnabled||this.micPermDenied||this.enableLocalAudio(),this.enableSelfEdit()),this.absentJoiners.find((function(e){return e.loginName===P}))&&(this.absentJoiners=R([],this.absentJoiners,!0)),this.coHosts=[P].concat(this.coHosts);break;case fj.CANCEL_COHOST:N=e.userId,this.remoteMemberStates[N]&&(this.remoteMemberStates[N].isCohost=!1,this.remoteMemberStates[N].perm=this.remoteMemberStates[N].prevPerm,this.remoteMemberStates=exports.E({},this.remoteMemberStates)),this.localMemberState.userId===N&&(this.localMemberState.isCohost=!1,this.isCohost=!1,(M=this.localMemberState.prevPerm)===WW.Edit?this.enableSelfEdit():M===WW.Comment?this.enableSelfComment():M===WW.View&&this.enableSelfView()),this.absentJoiners.find((function(e){return e.loginName===N}))&&(this.absentJoiners=R([],this.absentJoiners,!0)),this.coHosts=this.coHosts.filter((function(e){return e!==N}));break;case fj.REQUEST_MEDIA_PERM:H=e.userId,A=e.kind,this.handleOpenMediaRequest(A);break;case fj.RESPONSE_MEDIA_PERM:A=e.kind,H=e.userId,B=this.upime.getUserInfo(H),1===A?this.upime.addToast(B.userName+O("meeting.refuse.mic.req")):2===A&&this.upime.addToast(B.userName+O("meeting.refuse.cam.req"));break;case fj.START_CLOUD_RECORD:z=e.cloudRecordId,L=e.starter,this.cloudRecordStartingToastId=this.upime.addToast(O("meeting.record.starting"),{autoHide:!1}),this.cloudRecord={id:z,state:VW.STARTING,starter:L,firstNotify:!1},this.upime.publish("cloudRecordState",this.cloudRecord);break;case fj.RECORDING_CLOUD_RECORD:this.upime.removeToast(this.cloudRecordStartingToastId),V=e.on,F=e.cloudRecordData,1===V?(this.cloudRecord=void 0,this.upime.addToast(O("meeting.record.start.fail"))):0===V&&(this.cloudRecord=F,this.upime.showWindow(dG,null,!0,!1,void 0,(function(e){J.inRecordingDialogId=e})),setTimeout((function(){J.upime.removeWindow(J.inRecordingDialogId)}),5e3)),this.upime.publish("cloudRecordState",this.cloudRecord);break;case fj.END_CLOUD_RECORD:z=e.cloudRecordId,this.cloudRecord=void 0,this.upime.publish("cloudRecordState",this.cloudRecord),this.upime.showWindow(hG,{reason:0},!0,!1,void 0,(function(e){J.endRecordingDialogId=e})),setTimeout((function(){J.upime.removeWindow(J.endRecordingDialogId)}),5e3);break;case fj.END_CLOUD_RECORD_BY_NETWORK:z=e.cloudRecordId,this.cloudRecord=void 0,this.upime.publish("cloudRecordState",this.cloudRecord),this.upime.showWindow(hG,{reason:1},!0,!1,void 0,(function(e){J.endRecordingDialogId=e})),setTimeout((function(){J.upime.removeWindow(J.endRecordingDialogId)}),5e3);break;case fj.START_SCREEN_SHARE:H=e.userId,this.screenSharer&&this.screenSharer!==H&&this.disableLocalScreenVideoAndAudio(!1),this.screenSharer=H,this.upime.addToast(this.upime.getUserInfo(H).userName+" "+O("meeting.screen.share.going"));break;case fj.STOP_SCREEN_SHARE:H=e.userId,this.screenSharer=void 0,this.upime.addToast(this.upime.getUserInfo(H).userName+" "+O("meeting.screen.share.stop"));break;case fj.AUXI_RTC_PERM_MUTATED:if(U=e.uniqueId,W=e.perm,V=e.on,!this.auxillaryRemoteUserMap)return[2];if(null==(j=null===(Y=Object.values(this.auxillaryRemoteUserMap).find((function(e){return e.userId===U})))||void 0===Y?void 0:Y.mediaId))return[2];this.auxillaryRemoteUserMap[j]=exports.E(exports.E(exports.E({},this.auxillaryRemoteUserMap[j]),W&qW.AUDIO&&{audio:V}),W&qW.VIDEO&&{video:V}),this.auxillaryRemoteUserMap=exports.E({},this.auxillaryRemoteUserMap),W&qW.AUDIO&&(null===(X=this.externalMediaManager)||void 0===X||X.muteMediaAudio(j,V)),W&qW.VIDEO&&(null===(Q=this.externalMediaManager)||void 0===Q||Q.muteMediaVideo(j,V));break;case fj.AUXI_RTC_ENDED:null===(Z=this.externalMediaManager)||void 0===Z||Z.destroy()}return[2]}))}))},o.cloudRecordStartingToastId=0,o.mediaRequestModal=0,o.appendPlanJoiners=function(e){o.planJoinerIds=Array.from(new Set(R(R([],o.planJoinerIds,!0),e,!0)));var t=o.absentJoiners.map((function(e){return e.loginName}));e.forEach((function(e){o.remoteMemberStates[e]||t.includes(e)||e===o.localMemberState.userId||o.absentJoiners.push(o.upime.getUserInfo(e))})),o.absentJoiners=R([],o.absentJoiners,!0)},o.scene=new NG(t,o),o.scene.onRemove=function(){o.leaveMeeting()},t.sceneManager.addScene(o.scene),"production"!==process.env.NODE_ENV&&window._externalMeeting_&&(n.externalMeeting=window._externalMeeting_),o.autoShowInvite=r;var a=n.host,s=n.serverPort,l=n.rtc,c=n.curJoiners;n.planJoiners;var u=n.viewFrom,d=n.forceFollow,p=n.opposeFF,h=n.vnc,f=n.topJoiner,m=n.coHosts,v=n.involvers,g=n.externalMeeting,y=n.cloudRecord,b=n.screenSharer,E=n.userPermApplyList,x=t.localUserInfo;o.isHost=t.localUserInfo.loginName===a,o.isCohost=m.includes(t.localUserInfo.loginName),o.perm=o.upime.userManager.rawEditPerm?WW.Edit:o.upime.userManager.commentOnlyMode?WW.Comment:WW.View;var w=o.staticMeetings.find((function(e){return e.id===n.id}));!w||o.isHost||o.isCohost||w.defaultPerm!==UW.SameWithSdk&&(o.perm=w.defaultPerm===UW.Edit?WW.Edit:w.defaultPerm===UW.Comment?WW.Comment:(w.defaultPerm,UW.View,WW.View)),o.opposeFF=p,o.forceFollow=!!d,o.hostId=a,o.coHosts=m,o.screenSharer=b,o.userPermApplyList=null!=E?E:[],f&&(o.topRtcUser=f),o._progressMeetingSubService=new yj(t,s,o._progressMeetingMsgHandler),o._progressMeetingSubService.open();var C=c.find((function(e){return e.userId===x.loginName}));t.localUserInfo.nickName=C.nickName;var S="viewer";if(o.localMemberState=exports.E(exports.E({},C),{userInfo:t.localUserInfo,video:!1,screenShare:!1,audio:o.isHost||o.isCohost,isHost:o.isHost,isCohost:o.isCohost,mediaId:-1,editable:o.upime.userManager.rawEditPerm,perm:o.perm,prevPerm:o.perm,isForceFollowing:!!(p.includes(t.localUserInfo.loginName)?!d:d)}),o.perm===WW.Edit?(S="editor",o._progressMeetingSubService.reportStatusChange(qW.EDIT,!0)):o.perm===WW.Comment&&(S="commentor",o._progressMeetingSubService.reportStatusChange(qW.COMMENT,!0)),c.forEach((function(e){if(e.userId!==x.loginName){var t=o.upime.getUserInfo(e.userId);t.nickName=e.nickName;var i=!!(e.perm&qW.EDIT),r=!!(e.perm&qW.COMMENT),a=i?WW.Edit:r?WW.Comment:WW.View;o.remoteMemberStates[e.userId]=exports.E(exports.E({},e),{userInfo:t,isHost:n.host===e.userId,isCohost:n.coHosts.includes(e.userId),audio:!!(e.perm&qW.AUDIO),video:!!(e.perm&qW.VIDEO),screenShare:!!(e.perm&qW.SCREEN_SHARE),editable:i,perm:a,prevPerm:a,isForceFollowing:!!(p.includes(e.userId)?!d:d)})}})),o.remoteMemberStates=exports.E({},o.remoteMemberStates),o.involvers=v,v.forEach((function(e){if(!c.find((function(t){return t.userId===e.userId}))){var n=t.getUserInfo(e.userId);n.role=e.role,o.absentJoiners.push(n)}})),o.absentJoiners=R([],o.absentJoiners,!0),n.timer){var k=n.timer,_=k.status,T=k.timestamp,I=k.currentTime;"pause"===_||I-(t.getCurServerTime()-T)>0?(o.startTimerVar++,o.showTimer=!0,o.initBy="enter",t.t_timerActive=!0):n.timer=null}t.startMeetingMode(S),o.isHost||t.updateMeetingMode(S),o.isCohost&&o.enableSelfEdit(),o.startRtcInMeeting(l);var P=new cW(t);if(o.presentation=P,t.meetingPresentation=P,o.curViewSrc=u,u!==x.loginName&&(o.scene.setFollowingUser(o.upime.getUserInfo(u)),o.localMemberState.isForceFollowing&&o._setSelfForceFollow()),o.upime.clearLocalWebViewers(),o.isVncHost=o.curViewSrc===o.upime.localUserInfo.loginName,o.vncs=h.map((function(e){var t=e.vncId,n=e.elmId;return{vncId:t,elmId:n,webviewer:o.startElementVnc(t,n,!1)}})),o.cloudRecord=y,y&&o.handleCloudRecordWhenFirstEnter(y),o.upime.view.update(),g){var N=function(e){var t=e.externalMediaInfo,n=e.status,i=e.type;n===jW.ONGOING&&(o.auxillaryRemoteUserMap=t.reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t.mediaId]=exports.E(exports.E({},t),{video:!!(t.perm&qW.VIDEO),audio:!!(t.perm&qW.AUDIO),userId:t.uniqueId,userInfo:o.upime.getUserInfo(t.uniqueId),isHost:!1}),n))}),{}),i?o.configs.createExternalMediaManager&&(o.externalMediaManager=o.configs.createExternalMediaManager(e,o)):o.externalMediaManager=new lG(e,o))},M=g.type,B=g.status;if(!M&&B===jW.ONGOING&&o.configs.beforeEnterExternalMeeting){var L=o.configs.beforeEnterExternalMeeting(g);o.meetingData.externalMeeting=L,N(L)}else N(g)}return o}return P(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.meetingData.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vender",{get:function(){return this.meetingData.rtc.vendor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"staticMeetings",{get:function(){return this.upime.meetingManager.meetings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alwaysHost",{get:function(){return this.isHost},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultSelectedUserOnPhone",{get:function(){return this.curViewSrc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canChangeTopUser",{get:function(){return this.isHost||this.isCohost},enumerable:!1,configurable:!0}),t.prototype.handleCloudRecordWhenFirstEnter=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){switch(n.label){case 0:return e.state!==VW.RECORDING?[3,3]:e.firstNotify?[4,this.upime.showWindow(pG)]:[3,2];case 1:return 0===n.sent()&&this.leaveMeeting(),[3,3];case 2:this.upime.showWindow(dG,null,!0,!1,void 0,(function(e){t.inRecordingDialogId=e})),setTimeout((function(){t.upime.removeWindow(t.inRecordingDialogId)}),5e3),n.label=3;case 3:return[2]}}))}))},t.prototype.startRtcInMeeting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.initRtcEngine(e,this.configs.rtcLocalStreamConfigs)];case 1:return t.sent()?[3,4]:[3,2];case 2:return this.isHost||this.isCohost?[4,this.switchRole(Nt.HOST)]:[3,4];case 3:t.sent(),!this.micPermDenied&&this.enableLocalAudio(),t.label=4;case 4:return[2]}}))}))},t.prototype.getMeetingPerm=function(e){return e===qW.EDIT?WW.Edit:e===qW.COMMENT?WW.Comment:e===qW.VIEW?WW.View:""},t.prototype.permApply=function(e){this._progressMeetingSubService.permApply(e)},t.prototype.handlePermApply=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this._progressMeetingSubService.handlePermApply(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.startCloudRecord=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this._progressMeetingSubService.startCloudRecord(e)];case 1:return t=r.sent(),n=t[0],i=t[1],0===n&&(this.cloudRecordStartingToastId=this.upime.addToast(O("meeting.record.starting"),{autoHide:!1}),this.cloudRecord={id:i,state:VW.STARTING,starter:this.upime.localUserInfo.loginName,firstNotify:!1},this.upime.publish("cloudRecordState",this.cloudRecord)),[2,n]}}))}))},t.prototype.endCloudRecord=function(){return A(this,void 0,void 0,(function(){var e=this;return D(this,(function(t){switch(t.label){case 0:return this.cloudRecord?[4,this._progressMeetingSubService.endCloudRecord(this.cloudRecord.id)]:[3,2];case 1:0===t.sent()&&(this.cloudRecord=void 0,this.upime.showWindow(hG,{reason:0},!0,!1,void 0,(function(t){e.endRecordingDialogId=t})),setTimeout((function(){e.upime.removeWindow(e.endRecordingDialogId)}),5e3),this.upime.publish("cloudRecordState",this.cloudRecord)),t.label=2;case 2:return[2]}}))}))},t.prototype.handleOpenMediaRequest=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return(t=this.mediaRequestModal|e)===this.mediaRequestModal?[2]:(this.mediaRequestModal=t,this.openMicWillBeDenied=!1,this.openCamWillBeDenied=!1,[4,this.upime.showWindow(cG,{kind:e})]);case 1:return n=i.sent(),this.answerOpenMediaRequest(n,e),n?1!==e?[3,5]:this.micPermDenied?(this.openMicWillBeDenied=!0,[3,4]):[3,2]:[3,9];case 2:return[4,this.enableLocalAudio()];case 3:i.sent(),this.mediaRequestModal^=e,i.label=4;case 4:return[3,8];case 5:return 2!==e?[3,8]:this.camPermDenied?(this.openCamWillBeDenied=!0,[3,8]):[3,6];case 6:return[4,this.enableLocalVideo()];case 7:i.sent(),this.mediaRequestModal^=e,i.label=8;case 8:return[3,10];case 9:this.mediaRequestModal^=e,i.label=10;case 10:return[2]}}))}))},t.prototype._setSelfForceFollow=function(){this.scene.enableForceFollow(["meeting.view.locked.view.hint"])},t.prototype._forceLeaveMeeting=function(e){var t=e&&e!==KW.TIME_OUT,n=e===KW.KICKOUT,i=e===KW.DEVICE_CONFLICT;if(this.leaveMeeting(!t,t?n?XW.KICKOUT:XW.CONFLICT:XW.END),(t||!this.isHost)&&!1!==this.upime.meetingManager.meetingConfigs.showEndDialog)if(t){if(n)return void this.upime.showWindow(uG,{meetingManager:this.upime.meetingManager});if(i)return void this.upime.showWindow(xj)}else this.upime.showWindow(Ej)},t.prototype.startScreenShare=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this._progressMeetingSubService.startScreenShare()];case 1:return e.sent()||(this.screenSharer=this.upime.localUserInfo.loginName,this.upime.addToast(O("meeting.screen.share.start"))),[2]}}))}))},t.prototype.stopScreenShare=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this._progressMeetingSubService.stopScreenShare()];case 1:return e.sent()||(this.screenSharer=void 0,this.upime.addToast(O("common.you")+" "+O("meeting.screen.share.stop"))),[2]}}))}))},t.prototype.leaveRtc=function(){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.localVideoEnabled&&this._progressMeetingSubService.reportStatusChange(qW.VIDEO,!1),this.localAudioEnabled&&this._progressMeetingSubService.reportStatusChange(qW.AUDIO,!1),this.localScreenVideoEnabled&&this._progressMeetingSubService.reportStatusChange(qW.SCREEN_SHARE,!1),[2,e.prototype.leaveRtc.call(this)]}))}))},t.prototype.mutateOtherPerm=function(e,t,n){return A(this,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return this.isHost||this.isCohost?(this.hostMutatingId=e,[4,this._progressMeetingSubService.mutateOtherPerm(e,t,n)]):[2];case 1:return r.sent()||(i=this.getMeetingPerm(t)||this.remoteMemberStates[e].perm,this.remoteMemberStates[e]=exports.E(exports.E(exports.E(exports.E(exports.E({},this.remoteMemberStates[e]),t===qW.AUDIO&&{audio:n}),t===qW.VIDEO&&{video:n}),t===qW.EDIT&&{editable:n}),{perm:i}),this.remoteMemberStates=exports.E({},this.remoteMemberStates)),this.hostMutatingId="",[2]}}))}))},t.prototype.leaveMeeting=function(e,t){var n;return void 0===e&&(e=!1),void 0===t&&(t=XW.LEAVE),A(this,void 0,void 0,(function(){return D(this,(function(i){switch(i.label){case 0:return this.proMeetingActFrozen=!0,this.scene.disableForceFollow(),this.scene.stopFollowCurrent(),this.upime.meetingManager.staticMeetingActFrozen=!0,e?this._progressMeetingSubService.endMeeting():this._progressMeetingSubService.leaveMeeting(),[4,null===(n=this.externalMediaManager)||void 0===n?void 0:n.destroy()];case 1:return i.sent(),[4,this.leaveRtc()];case 2:return i.sent(),this.destroy(),this.proMeetingActFrozen=!1,this.upime.meetingManager.staticMeetingActFrozen=!1,this.upime.endMeetingMode(this.meetingData.id,e?XW.END:t),this.upime.removeToast(this.cloudRecordStartingToastId),[2]}}))}))},t.prototype.enableSelfEdit=function(e){void 0===e&&(e=!0),this.perm=WW.Edit,this.upime.updateMeetingMode("editor"),this.localMemberState=Object.assign({},this.localMemberState,{perm:WW.Edit}),e&&this._progressMeetingSubService.reportStatusChange(qW.EDIT,!0)},t.prototype.disableSelfEdit=function(e){void 0===e&&(e=!0),this.upime.operationInterrupt(),this.editEnabled=!1,this.upime.updateMeetingMode("viewer"),e&&this._progressMeetingSubService.reportStatusChange(qW.EDIT,!1)},t.prototype.enableSelfComment=function(e){void 0===e&&(e=!0),this.perm=WW.Comment,this.upime.updateMeetingMode("commentor"),this.localMemberState=Object.assign({},this.localMemberState,{perm:WW.Comment}),e&&this._progressMeetingSubService.reportStatusChange(qW.COMMENT,!0)},t.prototype.enableSelfView=function(e){void 0===e&&(e=!0),this.perm=WW.View,this.upime.updateMeetingMode("viewer"),this.localMemberState=Object.assign({},this.localMemberState,{perm:WW.View}),e&&this._progressMeetingSubService.reportStatusChange(qW.VIEW,!0)},t.prototype.changeViewSrc=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return e===this.curViewSrc?[3,2]:[4,this._progressMeetingSubService.changeViewFrom(e)];case 1:i.sent()?this.upime.addToast("授予视野权限失败"):(t=exports.E(exports.E({},this.remoteMemberStates),(n={},n[this.localMemberState.userId]=this.localMemberState,n))[e].userInfo.meetingName,this.upime.addToast(O("meeting.all.following",t),{type:"normal"}),this.curViewSrc=e,e!==this.localMemberState.userId?(e!==this.meetingData.host&&this.mutateOtherPerm(e,qW.EDIT,!0),this.scene.setFollowingUser(this.upime.getUserInfo(e)),this.localMemberState.isForceFollowing&&this._setSelfForceFollow(),this.upime.view.exitImmersivePlay()):(this.localMemberState.isForceFollowing&&this.scene.disableForceFollow(),this.scene.stopFollowCurrent()),this.updateFileHelperDisplay(),this.setVncViewOnlyState()),i.label=2;case 2:return[2]}}))}))},t.prototype.toggleMeetingForceFollow=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.toggleMeetingForceFollow(e)];case 1:return n.sent()||(this.forceFollow=e,this.localMemberState=exports.E(exports.E({},this.localMemberState),{isForceFollowing:e}),this.curViewSrc!==this.upime.localUserInfo.loginName&&(e?this._setSelfForceFollow():this.scene.disableForceFollow()),Object.keys(this.remoteMemberStates).forEach((function(n){t.remoteMemberStates[n]=exports.E(exports.E({},t.remoteMemberStates[n]),{isForceFollowing:e})})),this.remoteMemberStates=exports.E({},this.remoteMemberStates)),[2]}}))}))},t.prototype.toggleUserForceFollow=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.toggleUserForceFollow(e,t)];case 1:return n.sent()||(e===this.upime.localUserInfo.loginName?(this.localMemberState=exports.E(exports.E({},this.localMemberState),{isForceFollowing:t}),t?(this._setSelfForceFollow(),this.curViewSrc!==this.localMemberState.userId&&this.scene.setFollowingUser(this.upime.getUserInfo(this.curViewSrc))):this.scene.disableForceFollow()):(this.remoteMemberStates[e]=exports.E(exports.E({},this.remoteMemberStates[e]),{isForceFollowing:t}),this.remoteMemberStates=exports.E({},this.remoteMemberStates)),t!==this.forceFollow?this.opposeFF=R(R([],this.opposeFF,!0),[e],!1):this.opposeFF=this.opposeFF.filter((function(t){return t!==e}))),[2]}}))}))},t.prototype.kickoutMeeting=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.kickoutMeeting(e,t)];case 1:return n.sent()||(delete this.remoteMemberStates[e],this.remoteMemberStates=exports.E({},this.remoteMemberStates),this.upime.addToast(O("meeting.yichu.success"))),[2]}}))}))},t.prototype.requestMediaPermission=function(e,t){this._progressMeetingSubService.requestMediaPermission(e,t),this.upime.addToast(O("meeting.request.send"))},t.prototype.answerOpenMediaRequest=function(e,t){this._progressMeetingSubService.answerOpenMediaRequest(e,t)},t.prototype.requestVnc=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:if(this.vnsRcmdBuffer.has(e.id))return[2];if(this.vncs.some((function(t){return t.elmId===e.id})))return[2];this.vncs.length>=1&&(t=this.vncs[0],(n=this.upime.elementManager.getElementById(t.elmId))&&this.closeVnc(n)),this.vnsRcmdBuffer.add(e.id),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._progressMeetingSubService.requestVnc(e.id,e.url)];case 2:return(i=o.sent())&&(r=this.getVncViewer(i),this.vncs.push({vncId:i,elmId:e.id,webviewer:r}),e.doStartPreview(r)),[3,4];case 3:return o.sent(),[3,4];case 4:return this.vnsRcmdBuffer.delete(e.id),[2]}}))}))},t.prototype.closeVnc=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:if(this.vnsRcmdBuffer.has(e.id))return[2];if(!(t=this.vncs.find((function(t){return t.elmId===e.id}))))return[3,5];this.vnsRcmdBuffer.add(e.id),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._progressMeetingSubService.closeVnc(t.vncId)];case 2:return 0===n.sent()&&(this.vncs=this.vncs.filter((function(t){return t.elmId!==e.id})),e.doStopPreview()),[3,4];case 3:return n.sent(),[3,4];case 4:this.vnsRcmdBuffer.delete(e.id),n.label=5;case 5:return[2]}}))}))},t.prototype.getVncViewer=function(e){var t=this.upime.createVncViewer(e);return t.setViewOnly(this.curViewSrc!==this.upime.localUserInfo.loginName),t},t.prototype.startElementVnc=function(e,t,n){void 0===n&&(n=!0);var i=this.upime.elementManager.getElementById(t);if(i){var r=this.getVncViewer(e);return i.doStartPreview(r,n),r}},t.prototype.stopElementVnc=function(e){var t=this.upime.elementManager.getElementById(e);t&&t.doStopPreview()},t.prototype.updateFileHelperDisplay=function(){},t.prototype.setVncViewOnlyState=function(){this.isVncHost=this.curViewSrc===this.upime.localUserInfo.loginName;var e=!this.isVncHost;this.vncs.forEach((function(t){var n=t.webviewer;null==n||n.setViewOnly(e)})),this.upime.view.update()},t.prototype.changeTopUser=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.changeTopUser(e,t)];case 1:return n.sent()||(this.topRtcUser=t?e:""),[2]}}))}))},t.prototype.startTimer=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this._progressMeetingSubService.startTimer(e)];case 1:return t=r.sent(),n=t[0],i=t[1],!n&&this.meetingData.timer&&(this.meetingData.timer.uniqueId=i),[2]}}))}))},t.prototype.stopTimer=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this._progressMeetingSubService.stopTimer(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.updateTimer=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.updateTimer(e,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.addTimerTime=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this._progressMeetingSubService.addTimerTime(e,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.setCohost=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this._progressMeetingSubService.setCohost(e)];case 1:return t.sent()||(this.remoteMemberStates[e]&&(this.remoteMemberStates[e].isCohost=!0,this.remoteMemberStates[e].editable=!0,this.remoteMemberStates[e].audio=!0,this.remoteMemberStates[e].perm=WW.Edit,this._progressMeetingSubService.reportStatusChange(qW.EDIT,!0),this._progressMeetingSubService.reportStatusChange(qW.AUDIO,!0),this.remoteMemberStates=exports.E({},this.remoteMemberStates)),this.absentJoiners.find((function(t){return t.loginName===e}))&&(this.absentJoiners=R([],this.absentJoiners,!0)),this.coHosts=[e].concat(this.coHosts),this.syncStaticMeetingCohosts()),[2]}}))}))},t.prototype.cancelCohost=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this._progressMeetingSubService.cancelCohost(e)];case 1:return t.sent()||(this.remoteMemberStates[e]&&(this.remoteMemberStates[e].isCohost=!1,this.remoteMemberStates=exports.E({},this.remoteMemberStates)),this.absentJoiners.find((function(t){return t.loginName===e}))&&(this.absentJoiners=R([],this.absentJoiners,!0)),this.coHosts=this.coHosts.filter((function(t){return t!==e})),this.syncStaticMeetingCohosts()),[2]}}))}))},t.prototype.syncStaticMeetingCohosts=function(){var e=this.meetingData.id,t=this.upime.meetingManager.meetings.filter((function(t){return t.id===e}))[0];t&&(t.coHosts=this.coHosts)},t.prototype.mutateAuxiRtcPerm=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r=this;return D(this,(function(o){switch(o.label){case 0:return this.auxillaryRemoteUserMap?(i=function(e){return A(r,void 0,void 0,(function(){var i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return i=null===(r=this.auxillaryRemoteUserMap)||void 0===r?void 0:r[e],this.isHost&&this.auxillaryRemoteUserMap&&i?[4,this._progressMeetingSubService.mutateAuxiRtcPerm({uniqueId:"".concat(i.userId),perm:t,en:n})]:[2];case 1:return s.sent()||(this.auxillaryRemoteUserMap[e]=exports.E(exports.E(exports.E({},this.auxillaryRemoteUserMap[e]),t===qW.AUDIO&&{audio:n}),t===qW.VIDEO&&{video:n}),this.auxillaryRemoteUserMap=exports.E({},this.auxillaryRemoteUserMap),t===qW.AUDIO&&(null===(o=this.externalMediaManager)||void 0===o||o.muteMediaAudio(e,n)),t===qW.VIDEO&&(null===(a=this.externalMediaManager)||void 0===a||a.muteMediaVideo(e,n))),[2]}}))}))},null!==e?[2,i(e)]:[4,Promise.allSettled(Object.keys(this.auxillaryRemoteUserMap).map((function(e){return i(e)})))]):[2];case 1:return o.sent(),[2]}}))}))},t.prototype.doApplyForHostRole=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.isHost?[2,0]:[4,this._progressMeetingSubService.applyDevicePermission()];case 1:return 0===(e=t.sent())?[2,0]:e===GW.RTC_HOST_LIMIT_REACHED?[2,1]:[2,"apply hostRole faild for uknown reason"]}}))}))},t.prototype.onLocalAudioOpenSuccess=function(){if(this._progressMeetingSubService.reportStatusChange(qW.AUDIO,!0),this.vender===Mt.AGORA){var e=this.rtcIns.localAudioStream;e&&this.publish("onPublishLocalStream",{vendor:Mt.AGORA,type:"audio",stream:e})}},t.prototype.onLocalAudioOpenFail=function(){this._progressMeetingSubService.reportStatusChange(qW.AUDIO,!1)},t.prototype.onLocalAudioCloseSuccess=function(e){void 0===e&&(e=!0),e&&this._progressMeetingSubService.reportStatusChange(qW.AUDIO,!1),this.publish("onUnpublishLocalStream",{type:"audio",vendor:this.vender})},t.prototype.onLocalVideoOpenSuccess=function(){if(this._progressMeetingSubService.reportStatusChange(qW.VIDEO,!0),this.vender===Mt.AGORA){var e=this.rtcIns.localVideoStream;e&&this.publish("onPublishLocalStream",{vendor:Mt.AGORA,type:"video",stream:e})}},t.prototype.onLocalVideoOpenFail=function(){this._progressMeetingSubService.reportStatusChange(qW.VIDEO,!1)},t.prototype.onLocalVideoCloseSuccess=function(e){e&&this._progressMeetingSubService.reportStatusChange(qW.VIDEO,!1),this.publish("onUnpublishLocalStream",{type:"video",vendor:this.vender})},t.prototype.onScreenVideoAndAudioOpenSuccess=function(){this._progressMeetingSubService.reportStatusChange(qW.SCREEN_SHARE,!0),this.startScreenShare()},t.prototype.onScreenVideoAndAudioOpenFail=function(e){this._progressMeetingSubService.reportStatusChange(qW.SCREEN_SHARE,!1),e&&e.includes("PERMISSION_DENIED")&&e.includes("Permission denied by system")&&this.upime.showWindow(_G)},t.prototype.onScreenVideoAndAudioCloseSuccess=function(e){e&&this._progressMeetingSubService.reportStatusChange(qW.SCREEN_SHARE,!1),e&&this.stopScreenShare()},t.prototype.exitFollowGroup=function(){this._progressMeetingSubService.exitFollowGroup()},t.prototype.resumeFollowGroup=function(){this._progressMeetingSubService.resumeFollowGroup()},t.prototype.destroy=function(){var t,n=this;e.prototype.destroy.call(this),this._progressMeetingSubService.close(),null===(t=this.externalMediaManager)||void 0===t||t.destroy(),this.externalMediaManager=null,this.vnsRcmdBuffer.clear(),this.vncs.forEach((function(e){n.stopElementVnc(e.elmId)})),this.upime.view.update(),this._unsubs.forEach((function(e){return e()})),this.presentation.framePlayer.destroy(),this.upime.meetingPresentation=void 0,this.scene.onRemove=void 0,this.scene.remove()},M([rl],t.prototype,"isCohost",void 0),M([rl],t.prototype,"editEnabled",void 0),M([rl],t.prototype,"perm",void 0),M([rl],t.prototype,"userPermApplyList",void 0),M([rl],t.prototype,"auxillaryRemoteUserMap",void 0),M([rl],t.prototype,"forceFollow",void 0),M([rl],t.prototype,"proMeetingActFrozen",void 0),M([rl],t.prototype,"absentJoiners",void 0),M([rl],t.prototype,"planJoinerIds",void 0),M([rl],t.prototype,"involvers",void 0),M([rl],t.prototype,"coHosts",void 0),M([rl],t.prototype,"hostMutatingId",void 0),M([rl],t.prototype,"curViewSrc",void 0),M([rl],t.prototype,"updateStatus",void 0),M([rl],t.prototype,"addTime",void 0),M([rl],t.prototype,"startTimerVar",void 0),M([rl],t.prototype,"stopTimerVar",void 0),M([rl],t.prototype,"cloudRecord",void 0),t}(TG);function AG(t){var n=t.fail,i=t.content,r=W().getUpimeTrans,o=e.useContext(xl).phoneMode,a=i.meetingManager,s=[e.createElement("span",{key:"join",style:{color:"#2e73e5"},onClick:function(){n("cancel"),a.meetingConfigs.handleNoPermissionJoinMeeting&&a.meetingConfigs.handleNoPermissionJoinMeeting()}},r("meeting.end.confirm"))];return o?e.createElement(bV,{className:gV.phoneModal,header:r("meeting.nopermission.join"),footer:s}):e.createElement("div",{className:gV.noPermissionJoinBox},e.createElement("div",{className:gV.headRow},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",{className:gV.wording},r("meeting.nopermission.join"))),e.createElement("div",{className:gV.actionRow},e.createElement("div",{className:gV.btn,onClick:function(){n("cancel"),a.meetingConfigs.handleNoPermissionJoinMeeting&&a.meetingConfigs.handleNoPermissionJoinMeeting()}},r("meeting.end.confirm"))))}function DG(t){var n=t.fail;t.content;var i=W().getUpimeTrans,r=e.useContext(xl).phoneMode,o=[e.createElement("span",{key:"join",style:{color:"#2e73e5"},onClick:function(){n("cancel")}},i("meeting.end.confirm"))];return r?e.createElement(bV,{className:gV.phoneModal,header:i("meeting.already.ended"),footer:o}):e.createElement("div",{className:gV.endModalBox},e.createElement("div",{className:gV.headRow},e.createElement("span",{className:gV.wording},i("meeting.already.ended"))),e.createElement("div",{className:gV.actionRow},e.createElement("div",{className:gV.btn,onClick:function(){n("cancel")}},i("meeting.end.confirm"))))}function RG(t){var n=t.fail,i=W().getUpimeTrans,r=e.useContext(xl).phoneMode,o=[e.createElement("span",{key:"join",style:{color:"#2e73e5"},onClick:function(){n("cancel")}},i("meeting.end.confirm"))];return r?e.createElement(bV,{className:gV.phoneModal,header:i("meeting.already.canceled"),footer:o}):e.createElement("div",{className:gV.endModalBox},e.createElement("div",{className:gV.headRow},e.createElement("span",{className:gV.wording},i("meeting.already.canceled"))),e.createElement("div",{className:gV.actionRow},e.createElement("div",{className:gV.btn,onClick:function(){n("cancel")}},i("meeting.end.confirm"))))}var BG=function(){function e(e,t){var n=this;this.upime=e,this.config=t,this.inMeeting=!1,this.meetingHints=[],this.meetings=[],this.meetingListShown=!1,this.staticMeetingActFrozen=!1,this.meetingChannel=null,this.editingMeetingId="",this.checkJoinMeetingFuncs=[],this._intervalTimer=null,this.waitSyncFinish=new Ks,this._staticMeetingSubService=new vj(this.upime,3,this._staticMeetingMsgHandler.bind(this)),this._onGoingMeetingChecker=function(){var e=n.upime.getCurServerTime(),t=[],i=n.meetingConfigs.startRemindTime||3e5;n.meetings.forEach((function(n){e+i>=n.planStart&&(n.read||t.push(n.id))})),n.meetingHints=t},this.onCancelMeeting=function(e){return A(n,void 0,void 0,(function(){var t=this;return D(this,(function(n){switch(n.label){case 0:return[4,this.waitSyncFinish.result];case 1:return n.sent(),this.upime.isDesktopModal=!0,[4,this.upime.showWindow(bj).finally((function(){t.upime.isDesktopModal=!1}))];case 2:return n.sent()?[4,this._staticMeetingSubService.cancelMeeting(e)]:[3,4];case 3:n.sent()?this.upime.addToast(O("meeting.cancel.failed"),{type:"normal"}):(this.upime.addToast(O("meeting.already.canceled"),{type:"normal"}),this.meetings=this.meetings.filter((function(t){return t.id!==e}))),n.label=4;case 4:return[2]}}))}))},this.onEditMeeting=function(e){n.editingMeetingId=e},this.clearEditingMeeting=function(){n.editingMeetingId=""},this.updateMeeting=function(e){return A(n,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this._staticMeetingSubService.updateMeeting(e)];case 1:return n.sent()?this.upime.addToast(O("meeting.edit.failed"),{type:"normal"}):(this.upime.addToast(O("meeting.edit.success"),{type:"normal"}),(t=this.meetings.find((function(t){return t.id===e.id})))&&(Object.assign(t,e,{read:!1}),this.meetings=R([],this.meetings,!0)),this._evokeMeetingReminder()),this.editingMeetingId="",[2]}}))}))},this.onOpenMeetingQrcode=function(e){var t,i,r,o,a=null!==(t=n.meetings.find((function(t){return t.id===e})))&&void 0!==t?t:(null===(i=n.meetingChannel)||void 0===i?void 0:i.meetingData.id)===e?n.meetingChannel.meetingData:null;a&&(null===(o=(r=n.meetingConfigs).showMeetingQrcode)||void 0===o||o.call(r,a))},this.onCopyMeetingLink=function(e){var t,i,r,o,a=null!==(t=n.meetings.find((function(t){return t.id===e})))&&void 0!==t?t:(null===(i=n.meetingChannel)||void 0===i?void 0:i.meetingData.id)===e?n.meetingChannel.meetingData:null;if(a){var s=null===(o=(r=n.meetingConfigs).getMeetingInvite)||void 0===o?void 0:o.call(r,a);if(s)return void Xd(s,{onCopy:function(e){n.upime.addToast(O("meeting.link.copied"),{type:"normal"}),e.setData("text/plain",s)}})}n.upime.addToast(O("meeting.get.meeting.link.failed"))},this.updateMeetingJoiners=function(e,t){return A(n,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return[4,this._staticMeetingSubService.updateJoiners(e,t)];case 1:return i.sent()?this.upime.addToast(O("meeting.addJoiners.failed"),{type:"normal"}):(this.upime.addToast(O("meeting.addJoiners.success"),{type:"normal"}),(n=this.meetings.find((function(t){return t.id===e})))&&(n.planJoiners=Array.from(new Set(R(R([],n.planJoiners,!0),t,!0))),this.meetings=R([],this.meetings,!0)),this.meetingChannel&&this.meetingChannel.meetingData.id===e&&this.meetingChannel.appendPlanJoiners(t)),[2]}}))}))},this.localUserInfo=e.localUserInfo,this.meetingConfigs=Object.assign({enableCloseReminder:!0,enableInviteInMeeting:!0,enableCohost:!0,showAutoJoinModal:!0},t),e.userManager.enableMeeting&&(this._staticMeetingSubService.open(),this.checkAutoJoin(),this.upime.subscribe("allDataSyncFinished",(function(){n.staticMeetingActFrozen=!1,n.waitSyncFinish.done()})))}return e.prototype.checkAutoJoin=function(){var e;return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h=this;return D(this,(function(f){switch(f.label){case 0:return[4,this.waitSyncFinish.result];case 1:return f.sent(),(t=this.config.autoJoinId)?(n=this.upime.localUserInfo.role===Pt.VISITOR,i="upime_meeting_nick_name_".concat(this.upime.localUserInfo.loginName,"_").concat(this.upime.curRecordId),r=n?null!==(e=localStorage.getItem(i))&&void 0!==e?e:this.upime.localUserInfo.userName:"",this.upime.localUserInfo.role===Pt.RECORD_ASSISTANT&&(r="录屏小助手"),o=function(e){n&&e&&(localStorage.setItem(i,e),h.upime.localUserInfo.nickName=e),h.ignoreMeetingHint(t),h.joinMeeting(t,{addToPlanJoiners:h.config.couldCheckMemberList,nickName:e,ignoreCheck:!0})},[4,this.checkJoinMeeting(t,!0)]):[3,8];case 2:return f.sent()?[4,this._staticMeetingSubService.queryMeeting(t)]:[2];case 3:return a=f.sent(),s=a[0],l=a[1],s?[3,8]:l.status!==zW.PENDING&&l.status!==zW.ON_GOING?[3,7]:this.meetingConfigs.showAutoJoinModal?(c=this.upime.localUserInfo,u=c.loginName,d=c.role,[4,this._staticMeetingSubService.addPlanJoiner(l.id,u,d,r)]):[3,5];case 4:return f.sent(),p=l.status===zW.PENDING&&l.planStart-Date.now()>l.openAhead&&n,this.upime.showWindow(wj,{host:this.upime.getUserInfo(l.host),title:l.title,isVisitor:n,nickName:r,cannotJoin:p,planStart:l.planStart,planEnd:l.planEnd,onConfirm:function(e){o(e)}}),[3,6];case 5:o(r),f.label=6;case 6:return[3,8];case 7:l.status===zW.ENDED?this.upime.showWindow(DG):l.status===zW.CANCELED&&this.upime.showWindow(RG),f.label=8;case 8:return[2]}}))}))},e.prototype._evokeMeetingReminder=function(){this._intervalTimer&&clearInterval(this._intervalTimer),this._onGoingMeetingChecker(),this._intervalTimer=setInterval(this._onGoingMeetingChecker,6e3)},e.prototype.initMeetings=function(e){return A(this,void 0,void 0,(function(){var t,n=this;return D(this,(function(i){switch(i.label){case 0:return[4,this.waitSyncFinish.result];case 1:return i.sent(),this.meetings=e.map((function(e){return exports.E(exports.E({},e),{read:e.id===n.meetingConfigs.autoJoinId})})),this.meetingConfigs.autoJoinMeeting&&this.meetings.length>0?(t=this.meetings[0].id,[4,this.checkJoinMeeting(t,!0)]):[3,4];case 2:return i.sent()?[4,this.joinMeeting(this.meetings[0].id,{ignoreCheck:!0})]:[3,4];case 3:i.sent(),this.meetings[0].read=!0,i.label=4;case 4:return this._evokeMeetingReminder(),[2]}}))}))},e.prototype._staticMeetingMsgHandler=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h;return D(this,(function(f){switch(e.type){case wV.STATIC_MEETINGS_KEY_FRAME:t=e.meetings,this.initMeetings(t);break;case wV.MEETING_STATUS_CHANGE:n=e.meetingId,i=e.status,r=this.meetings.find((function(e){return e.id===n})),r&&(i===zW.ENDED||i===zW.CANCELED?this.meetings=this.meetings.filter((function(e){return e.id!==r.id})):(r.status=i,this.meetings=R([],this.meetings,!0))),this._onGoingMeetingChecker();break;case wV.STATIC_MEETING_CREATED:o=e.meetingData,this.meetingChannel&&this.meetingChannel.meetingData.id===o.id&&(o.read=!0),this.meetings=R(R([],this.meetings,!0),[o],!1),this._onGoingMeetingChecker();break;case wV.STATIC_MEETING_UPDATED:a=e.meetingData,s=this.meetings.find((function(e){return e.id===a.id})),a.planJoiners.includes(this.upime.localUserInfo.loginName)?s?(Object.assign(s,a,{read:!1}),this.meetings=R([],this.meetings,!0)):this.meetings=R(R([],this.meetings,!0),[a],!1):s&&(this.meetings=this.meetings.filter((function(e){return e!==s}))),this._onGoingMeetingChecker();break;case wV.JOINER_UPDATED:l=e.meetingId,c=e.joiners,(u=this.meetings.find((function(e){return e.id===l})))&&(u.planJoiners=Array.from(new Set(R(R([],u.planJoiners,!0),c,!0))),this.meetings=R([],this.meetings,!0)),this.meetingChannel&&this.meetingChannel.meetingData.id===l&&this.meetingChannel.appendPlanJoiners(c);break;case wV.UPDATE_ADVANCE_SETTING:d=e.meetingId,p=e.advanceSetting,h=this.meetings.find((function(e){return e.id===d})),h&&(Object.assign(h,p),this.meetings=R([],this.meetings,!0))}return[2]}))}))},e.prototype.createMeeting=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this.waitSyncFinish.result];case 1:return r.sent(),[4,this._staticMeetingSubService.createMeeting(e)];case 2:return t=r.sent(),n=t[0],i=t[1],n?(this.upime.addToast(O("meeting.reserve.failed"),{type:"normal"}),[2,null]):(this.meetings=R(R([],this.meetings,!0),[i],!1),this._evokeMeetingReminder(),[2,i])}}))}))},e.prototype.queryMeeting=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this._staticMeetingSubService.queryMeeting(e)];case 1:return t=r.sent(),n=t[0],i=t[1],0===n?[2,i]:[2,null]}}))}))},e.prototype.fastMeeting=function(){var e,t,n;return A(this,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return this.upime.mediaPlayController.fakePlay(),this.upime.followManager.stopFollowCurrent(),[4,this.waitSyncFinish.result];case 1:return r.sent(),[4,this.checkJoinMeeting("")];case 2:return r.sent()?(this.staticMeetingActFrozen=!0,[4,null===(e=this.meetingChannel)||void 0===e?void 0:e.leaveMeeting()]):[2];case 3:return r.sent(),[4,this._staticMeetingSubService.fastMeeting()];case 4:return i=r.sent(),this.meetings=this.meetings.concat(exports.E(exports.E({},i[0]),{joined:!0,read:!0})),this.meetingChannel=new MG(this.upime,i[1],this.config,!0),null===(n=(t=this.config).onJoinMeeting)||void 0===n||n.call(t,this.meetingChannel),this.inMeeting=!0,this.staticMeetingActFrozen=!1,this.upime.view.enableImmersivePlaying(!1),this.upime.publish("meetingStateChange",!0),[2]}}))}))},e.prototype.getHistoryMeetingList=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,Qu({title:e},t).result];case 2:if((n=i.sent()).code===Uu.OK)return[2,n.obj];throw n.code}}))}))},e.prototype.deleteMeetingById=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,Zu({id:e},t).result];case 2:if((n=i.sent()).code!==Uu.OK)throw n.code;return[2]}}))}))},e.prototype.detailAudio=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,Ju({id:e},t).result];case 2:if((n=i.sent()).code===Uu.OK)return[2,n.obj];throw n.code}}))}))},e.prototype.detailVideo=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,$u({cname:e},t).result];case 2:if((n=i.sent()).code===Uu.OK)return[2,n.obj];throw n.code}}))}))},e.prototype.downloadAudio=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.upime.getHistoryMeetingServiceToken(),this.upime.getDownloadSign("rtcAudio")])];case 1:return n=a.sent(),i=n[0],r=n[1],[4,ed(exports.E({id:e,fileName:t},r),i).result];case 2:if((o=a.sent()).code===Uu.OK)return[2,o.obj];throw o.code}}))}))},e.prototype.downloadVideo=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.upime.getHistoryMeetingServiceToken(),this.upime.getDownloadSign("rtcAudio")])];case 1:return t=o.sent(),n=t[0],i=t[1],[4,td(exports.E({downloadParams:e},i),n).result];case 2:if((r=o.sent()).code===Uu.OK)return[2,r.obj.data];throw r.code}}))}))},e.prototype.detailJiyao=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,nd({id:e},t).result];case 2:if((n=i.sent()).code===Uu.OK)return[2,n.obj];throw n.code}}))}))},e.prototype.genJiyao=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,id({id:e},t).result];case 2:if((n=i.sent()).code!==Uu.OK)throw n.code;return[2]}}))}))},e.prototype.detailText=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,od({id:e},t).result];case 2:if((n=i.sent()).code===Uu.OK)return[2,n.obj];throw n.code}}))}))},e.prototype.genText=function(e){return A(this,void 0,void 0,(function(){var t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.getHistoryMeetingServiceToken()];case 1:return t=i.sent(),[4,rd({id:e},t).result];case 2:if((n=i.sent()).code!==Uu.OK)throw n.code;return[2]}}))}))},e.prototype.clearUnreadHints=function(){var e=this;this.meetingHints.forEach((function(t){var n=e.meetings.find((function(e){return e.id===t}));n&&(n.read=!0)})),this.meetingHints=[]},e.prototype.joinMeeting=function(e,t){var n,i;return void 0===t&&(t={}),A(this,void 0,void 0,(function(){var r,o,a,s,l,c,u,d;return D(this,(function(p){switch(p.label){case 0:return r=t.addToPlanJoiners,o=t.nickName,a=t.ignoreCheck,(s=a)?[3,2]:[4,this.checkJoinMeeting(e)];case 1:s=p.sent(),p.label=2;case 2:return s?(this.upime.mediaPlayController.fakePlay(),this.upime.followManager.stopFollowCurrent(),[4,this.waitSyncFinish.result]):[2];case 3:return p.sent(),this.staticMeetingActFrozen=!0,this.meetingChannel?[4,this.onLeaveMeeting(this.meetingChannel.meetingData.id)]:[3,5];case 4:p.sent(),p.label=5;case 5:return[4,this._staticMeetingSubService.joinMeeting(e,this.upime.localUserInfo.role,r,o)];case 6:return l=p.sent(),c=l[0],u=l[1],c?c===GW.IN_BLACK_LIST?this.upime.showWindow(AG,{meetingManager:this}):this.upime.addToast(O("meeting.not.exist"),{type:"normal"}):(this.meetingChannel=new MG(this.upime,u,this.config),this.inMeeting=!0,(d=this.meetings.find((function(t){return t.id===e})))&&(d.joined=!0),this.meetings=R([],this.meetings,!0),this.upime.publish("meetingStateChange",!0),null===(i=(n=this.config).onJoinMeeting)||void 0===i||i.call(n,this.meetingChannel),o&&this.upime.sendControlCmd([5,o]),this.upime.view.enableImmersivePlaying(!1)),this.staticMeetingActFrozen=!1,[2]}}))}))},e.prototype.ignoreMeetingHint=function(e){var t=this.meetings.find((function(t){return t.id===e}));t&&(t.read=!0,this._onGoingMeetingChecker())},e.prototype.updateAdvanceSettings=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return[4,this._staticMeetingSubService.updateAdvanceSettings(e,t)];case 1:return 0===i.sent()&&(n=this.meetings.find((function(t){return t.id===e})))&&(Object.assign(n,t),this.meetings=R([],this.meetings,!0)),[2]}}))}))},e.prototype.onLeaveMeeting=function(e){var t,n,i;return A(this,void 0,void 0,(function(){var r;return D(this,(function(o){switch(o.label){case 0:return(r=this.meetings.find((function(t){return t.id===e})))&&(r.joined=!1,this.meetings=R([],this.meetings,!0)),this.inMeeting=!1,null===(n=(t=this.config).onLeaveMeeting)||void 0===n||n.call(t,e),[4,null===(i=this.meetingChannel)||void 0===i?void 0:i.leaveMeeting()];case 1:return o.sent(),this.meetingChannel=null,this.upime.publish("meetingStateChange",!1),[2]}}))}))},e.prototype.checkJoinMeeting=function(e,t){return void 0===t&&(t=!1),A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){switch(r.label){case 0:n=0,i=this.checkJoinMeetingFuncs,r.label=1;case 1:return n<i.length?[4,(0,i[n])(e,t)]:[3,4];case 2:if(!r.sent())return[2,!1];r.label=3;case 3:return n++,[3,1];case 4:return[2,!0]}}))}))},e.prototype.addJoinMeetingChecker=function(e){this.checkJoinMeetingFuncs.includes(e)||this.checkJoinMeetingFuncs.push(e)},e.prototype.removeJoinMeetingChecker=function(e){this.checkJoinMeetingFuncs=this.checkJoinMeetingFuncs.filter((function(t){return t!==e}))},e.prototype.destroy=function(){this._staticMeetingSubService.close(),this.reset(!0)},e.prototype.reset=function(e){var t;void 0===e&&(e=!1);var n=this.meetingChannel;null===(t=this.meetingChannel)||void 0===t||t.leaveMeeting(!1,e?XW.LEAVE:XW.RETRY),this.meetingChannel=null,this.meetings=[],this.meetingHints=[],this._intervalTimer&&clearInterval(this._intervalTimer),n&&this.upime.publish("meetingStateChange",!1),"pending"===this.waitSyncFinish.state&&this.waitSyncFinish.fail("reset"),this.waitSyncFinish=new Ks},M([rl],e.prototype,"inMeeting",void 0),M([rl],e.prototype,"meetingHints",void 0),M([rl],e.prototype,"meetings",void 0),M([rl],e.prototype,"meetingListShown",void 0),M([rl],e.prototype,"staticMeetingActFrozen",void 0),M([rl],e.prototype,"meetingChannel",void 0),M([rl],e.prototype,"editingMeetingId",void 0),M([il],e)}(),LG=function(){function e(e,t,n,i,r,o){var a=this;this.upime=e,this.imgUrl=t,this.width=n,this.height=i,this.position={x:0,y:0},this.scale=1,this.renderer=OG,this.renderKey="template_preview_".concat(Date.now()),this._unsub=e.view.subscribe("viewboxChange",(function(e){a.scale=e.scale})),this.scale=o,this.position=r}return e.prototype.updatePos=function(e){this.position=e},e.prototype.destroy=function(){this._unsub()},e}(),OG=function(t){var n=t.element,i=e.useRef(null),r=e.useState(!1),o=r[0],a=r[1],s=e.useRef(null);return e.useEffect((function(){fetch(n.imgUrl).then((function(e){return e.text()})).then((function(e){var t=i.current;t&&(t.innerHTML=e,t.firstChild.setAttribute("width","100%"),t.firstChild.setAttribute("height","100%"),a(!0))}))}),[]),e.useEffect((function(){var e=function(){var t=i.current,r=n.position,o=r.x,a=r.y;t.style.width="".concat(n.width*n.scale,"px"),t.style.height="".concat(n.height*n.scale,"px"),t.style.transform="translate3d(".concat(o,"px, ").concat(a,"px, 0px)"),s.current=fr(e)};return i.current&&e(),function(){s.current&&mr(s.current)}}),[]),e.createElement("div",{className:"root_3UKyn",ref:i,style:{visibility:o?"visible":"hidden"}})},FG=function(t){function n(n){var i=t.call(this,n)||this;return i.upime=n,i._unsub_xmode=i.upime.subscribe("xmodechange",(function(e){"template"===e?i.listenToEvents(!0):i.listenToEvents(!1)})),i._insertPreviewWidget=null,i._eleInfo=null,i._unsubs=[],i.toastId=void 0,i.onInsertTemplate=function(t,n,r,o){return A(i,void 0,void 0,(function(){return D(this,(function(i){try{this._eleInfo=t,_e.isHoverSupported?(this._insertPreviewWidget=new LG(this.upime,n,r,o,this.upime.userEventManager.mousePosition,this.upime.view.scale),this.upime.view.addDomWidget(this._insertPreviewWidget)):this.toastId=this.upime.addToast(e.createElement(CW,{content:O("template.insert.hint")}),{autoHide:!1,top:16,style:{borderRadius:"100px",paddingLeft:"24px",paddingRight:"24px",zIndex:20}})}catch(e){this.upime.addToast("模板数据读取失败"),this._discardTemplateData(),this.upime.switchMode("select")}return[2]}))}))},i.insertTemplate=function(e){return A(i,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return this._eleInfo?(t=e.position,[4,this.upime.useElementsInfo(this._eleInfo,t)]):[3,2];case 1:r.sent(),n=this.upime.getSelectedElements(),i=Yt(n.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)}))),this.upime.makeBorderInSight(i,{left:90,right:20,top:60,bottom:60}),r.label=2;case 2:return this._discardTemplateData(),[2]}}))}))},i.onMouseMove=function(e){i._insertPreviewWidget&&i._insertPreviewWidget.updatePos(e.globalPosition)},"template"===n.xmode&&i.listenToEvents(!0),i}return P(n,t),n.prototype.listenToEvents=function(e){e?this._unsubs=[this.upime.userEventManager.subscribe("click",this.insertTemplate),this.upime.userEventManager.subscribe("mousemove",this.onMouseMove)]:(this._unsubs.forEach((function(e){return e()})),this._discardTemplateData())},n.prototype._discardTemplateData=function(){this._insertPreviewWidget&&(this._insertPreviewWidget.destroy(),this.upime.view.removeDomWidget(this._insertPreviewWidget),this._insertPreviewWidget=null),this._eleInfo=null,void 0!==this.toastId&&this.upime.removeToast(this.toastId)},n.prototype.reset=function(){this._discardTemplateData()},n.prototype.destroy=function(){this._unsubs.forEach((function(e){return e()})),this._unsub_xmode(),this._discardTemplateData()},n}(zd),zG=Vu("/wbs/nc/saveOrUpdateTemplate");function HG(e,t){var n=t.host,i=N(t,["host"]),r=Object.entries(i).map((function(e){var t=e[0],n=e[1];return"".concat(t,"=").concat(n)})).join("&");return zG(e,{host:n,query:r})}var UG,WG=function(){function e(e){this.upime=e}return e.prototype.saveTemplate=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g;return D(this,(function(y){switch(y.label){case 0:if(i=this.upime.elementManager.getAllElements().filter((function(e){return!1===Cp(e)})),0===i.length)return[2,{code:0,msg:"empty elements"}];if(!(r=t?this.upime.copyBoard():this.upime.copySelected("topLeft",!0,!1,!1)))throw new Error;return a=(o=r).info,s=o.border,l=o.eleList,c=l.filter((function(e){return e.elementType===Za.DOCUMENT||e.elementType===Za.IMAGE})).map((function(e){return e.fileId})).filter((function(e){return!!e})),a.forEach((function(e){e.elementType===Za.FRAME&&(e.data.hide=!1,e.data.unFrozenRoles=null),e.elementType===Za.STICKER&&(e.data.isPrivate=!1)})),u=this.upime.genFileName("template"),d="新模板",p="",n&&(d=n.title,p=n.description,h=n.boardId?JSON.stringify({type:n.type,subjectId:n.subjectId,boardId:n.boardId}):JSON.stringify({type:n.type,subjectId:n.subjectId})),[4,Promise.all([this._prepareTemplateJson(a,u),this._prepareTemplateCover(l,s,u)])];case 1:if(f=y.sent(),m=f[0],v=f[1],!m||!v.imageOssPath||!v.svgOssPath)throw new Error("missing required file path value");return[4,this.upime.getDownloadSign("templateCreate")];case 2:return g=y.sent(),[4,HG(exports.E({title:d,description:p,width:v.width,height:v.height,dataOssPath:m,imgOssPath:v.imageOssPath.path,svgOssPath:v.svgOssPath.path,fileIds:c,id:null==n?void 0:n.sdkTemplateRecordId,extInfo:h},g),e).result];case 3:if(y.sent().code)throw new Error("failed to sync data to board mng service");return[2]}}))}))},e.prototype.getTemplateData=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return t=new Ks,[4,this.upime.getFileInfo(e)];case 1:return n=r.sent().url,(i=new XMLHttpRequest).open("GET",n),i.responseType="json",i.onload=function(){200===i.status?t.done(i.response):t.fail(new Error)},i.onerror=function(){t.fail(new Error)},i.send(),[2,t.result]}}))}))},e.prototype.getTemplateCover=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d;return D(this,(function(p){switch(p.label){case 0:if(t=this.upime.elementManager.getAllElements().filter((function(e){return!1===Cp(e)})),0===t.length)return[2,{width:0,height:0}];if(!(n=e?this.upime.copyBoard():this.upime.copySelected("topLeft",!0,!1)))throw new Error;return r=(i=n).border,o=i.eleList,a=this.upime.genFileName("template"),[4,this._prepareTemplateCover(o,r,a)];case 1:return s=p.sent(),l=s.width,c=s.height,u=s.imageOssPath,d=s.svgOssPath,[2,{width:l,height:c,imageOssPath:null==u?void 0:u.url,svgOssPath:null==d?void 0:d.url}]}}))}))},e.prototype._prepareTemplateJson=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return n=new Blob([JSON.stringify(e)],{type:"application/json"}),i=new File([n],"".concat(t,".json"),{lastModified:Date.now()}),[4,this.upime.saveFile(1,{file:i,ext:"json",fakeName:"".concat(t,"_data.json"),fileType:"template"})];case 1:return r=o.sent(),[4,this.upime.getFileInfo(r)];case 2:return[2,o.sent().ossPath]}}))}))},e.prototype._prepareTemplateCover=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I;return D(this,(function(P){switch(P.label){case 0:return i=t.right-t.left,r=t.bottom-t.top,this.upime.view.scale,o=i,a=r,s=1,l=1e3,i>=r?(o=l,a=l*r/i,s=l/i):(a=l,o=l*i/r,s=l/r),c=[],u=this.upime.view.elementsRoot,d={refSystem:u,children:[]},p=function(e){var t=e.parentRefSystem;if(t){var n=function(e){if(e===u)return d;var t,i=e.parentRefSystem;if(i&&(t=i===u?d:n(i))){var r=t.children.find((function(t){return t.refSystem===e}));return r||(r={refSystem:e,children:[]},t.children.push(r),r)}},i=n(t);i&&i.children.push(e)}},e.forEach((function(e){e.elementType===Za.FRAME?c.push(e):p(e)})),(h=function(e){e.children.forEach((function(e){e.refSystem&&h(e)})),e.children.sort((function(e,t){return Hs(e.refSystem||e,t.refSystem||t)}))})(d),[4,Xf({upime:this.upime,frames:c,renderTree:d,viewbox:exports.E(exports.E({},t),{scale:s}),size:{width:o,height:a}})];case 1:return f=P.sent(),m=K(f),v=new File([m],"".concat(n,".png"),{lastModified:Date.now()}),[4,Yf({upime:this.upime,frames:c,renderTree:d,viewbox:exports.E(exports.E({},t),{scale:1}),timeout:1e4,size:{width:i,height:r}})];case 2:return g=P.sent(),y=Y(g),b=new File([y],"".concat(n,".svg"),{lastModified:Date.now()}),E=this.upime.saveFile(1,{file:v,ext:"png",fakeName:"".concat(n,"_cover.png")}),x=this.upime.saveFile(1,{file:b,ext:"svg",fakeName:"".concat(n,"_cover.svg")}),[4,Promise.all([E,x])];case 3:return w=P.sent(),C=w[0],S=w[1],[4,this.upime.getFileInfo(C)];case 4:return k=P.sent(),[4,this.upime.getFileInfo(S)];case 5:return _=P.sent(),T={path:k.ossPath,url:k.url},I={path:_.ossPath,url:_.url},[2,{imageOssPath:T,svgOssPath:I,width:i,height:r}]}}))}))},e}(),VG=function(e){function t(t){var n=e.call(this,t)||this;return n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"eraser"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),"eraser"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n,i=this.upime,r=void 0,o=[this.upime.userEventManager.subscribe("moveto",(function(e){var o=e.isStart,a=e.isEnd,s=void 0!==a&&a,l=e.position,c=e.prePosition;if("left"===e.connectType||"touch"===e.connectType){if(o&&(n=new lh(i.view),i.view.addAssistWidget(n),n.addPoint(c)),!bn(c,l)){n.addPoint(l);var u=8/i.view.scale,d=[],p=function(e){var t=e.refSystem,n=e.children,i=t.globalTransform,r=u/i.currentScale,a=i.applyInverse(c),s=i.applyInverse(l);n.forEach((function(e){e.refSystem?!e.refSystem.unavailable&&p(e):function(e){if(e.elementType===Za.LINE&&!e.deleted&&!e.locked&&!e.frozedGroup){var t=e,n=t.position,i=t.path,l=t.lineWidth,c=t.scale,u=(r+l*c)/2,d=jt(s.x,a.x),p=d[0],h=d[1],f=jt(s.y,a.y),m=f[0],v=f[1],g={left:p-u,top:m-u,right:h+u,bottom:v+u};if(!t.checkVisibleInRS(g))return!1;var y=a,b=s;if(t.rotate){var E=Lt(t.getBorderBox());y=an(y,-t.rotate,E),b=an(b,-t.rotate,E)}y=xn(y,n),b=xn(b,n);var x=$t(xn(b,y));0!==x&&(b=an(b,180*-x/Math.PI,y));var w={left:p=y.x,top:m=y.y-u,right:h=b.x,bottom:v=y.y+u},C={x:0,y:0};if(0!==x&&(C=an(C,180*-x/Math.PI,y)),Ot(C,w))return!0;for(var S=0;S<i.length;S+=4){var k={x:i[S+2]*c,y:i[S+3]*c};if(Ot(k=an(k,180*-x/Math.PI,y),w))return!0;var _={x:i[S]*c,y:i[S+1]*c};if(_=an(_,180*-x/Math.PI,y),o&&ln(C,_,k,y)<u)return!0;if(ln(C,_,k,b)<u)return!0;if(0===Pn({x:p,y:m},{x:p,y:v},C,_,k))return!0;if(0===Pn({x:p,y:v},{x:h,y:v},C,_,k))return!0;if(0===Pn({x:h,y:v},{x:h,y:m},C,_,k))return!0;if(0===Pn({x:h,y:m},{x:p,y:m},C,_,k))return!0;C=k}}return!1}(e)&&d.push(e)}))};if(p(t.upime.view.renderingTree),d.length){r||(r=i.createOperation());for(var h=i.createLock(d.map((function(e){return e.id}))),f=0,m=d;f<m.length;f++){var v=m[f];if(new gE(i,v).doDelete(r),v.groupId){var g=v.group;r.update(v,{groupId:null}),1===(null==g?void 0:g.members.length)&&r.update(g.members[0],{groupId:null})}}r.sync(),i.clearLock(h)}}s&&(n&&i.view.removeAssistWidget(n),r=void 0)}})),this.upime.userEventManager.subscribe("click",(function(e){return function(e){"left"===e.connectType||e.connectType}(e)}))];this.unsub_move=function(){return o.forEach((function(e){n&&i.view.removeAssistWidget(n),e()}))}}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd),jG=function(){function e(){this.isPrepare=!1,this.videoDomPool=[],this.audioDomPool=[];for(var e=0;e<10;e++){var t=document.createElement("video");t.crossOrigin="",this.videoDomPool.push(t);var n=document.createElement("audio");n.crossOrigin="",this.audioDomPool.push(n)}}return e.prototype.applyVideoResource=function(){return this.videoDomPool.shift()},e.prototype.applyAudioResource=function(){return this.audioDomPool.shift()},e.prototype.releaseVideoResource=function(e){e.src="",this.videoDomPool.push(e)},e.prototype.releaseAudioResource=function(e){e.src="",this.audioDomPool.push(e)},e.prototype.prepare=function(){this.isPrepare||(this.videoDomPool.forEach((function(e){e.play(),e.pause()})),this.audioDomPool.forEach((function(e){e.play(),e.pause()})),this.isPrepare=!0)},e}(),GG=new jG;GG.prepare.bind(GG);var qG=function(e){function t(t){var n=e.call(this,t)||this;return n.playingVideoElements=[],n.playingAudioElements=[],n.fakePlayed=!1,n}return P(t,e),t.prototype.applyVideoElement=function(e){for(;this.playingVideoElements.length>=2;)this.playingVideoElements.shift().finishPlay();return this.playingVideoElements.push(e),GG.applyVideoResource()},t.prototype.applyAudioElement=function(e){for(;this.playingAudioElements.length>=2;)this.playingAudioElements.shift().finishPlay();return this.playingAudioElements.push(e),GG.applyAudioResource()},t.prototype.applyTimerElement=function(){return GG.applyAudioResource()},t.prototype.applyMediaDom=function(e){return"audio"===e?GG.applyAudioResource():GG.applyVideoResource()},t.prototype.releaseVideoElement=function(e){GG.releaseVideoResource(e)},t.prototype.releaseAudioElement=function(e){GG.releaseAudioResource(e)},t.prototype.releaseTimerElement=function(e){GG.releaseAudioResource(e)},t.prototype.videoPlayFinished=function(e){this.playingVideoElements=this.playingVideoElements.filter((function(t){return t!==e}))},t.prototype.audioPlayFinished=function(e){this.playingAudioElements=this.playingAudioElements.filter((function(t){return t!==e}))},t.prototype.finishOne=function(e){e.elementType===Za.AUDIO?this.playingAudioElements=this.playingAudioElements.filter((function(t){return e===t&&t.finishPlay(),e!==t})):this.playingVideoElements=this.playingVideoElements.filter((function(t){return e===t&&t.finishPlay(),e!==t}))},t.prototype.finishAll=function(){this.playingVideoElements.forEach((function(e){return e.finishPlay()})),this.playingVideoElements.length=0,this.playingAudioElements.forEach((function(e){return e.finishPlay()})),this.playingAudioElements.length=0},t.prototype.fakePlay=function(){GG.prepare()},t.prototype.destroy=function(){},t}(zd),KG=function(e){var t=e.element,n=js.value.viewbox,i=n.left,r=n.top,o=n.right,a=n.bottom,s=n.scale,l=t.position,c=t.size,u=l.x,d=l.y;u=(u-i)*s,d=(d-r)*s;var p=c.width*s,h=c.height*s;p<20&&(p=20),h<20&&(h=20);var f=(o-i)*s,m=(a-r)*s;Ma((function(e){var t=e.context,n=new Path2D,i=new Path2D;i.rect(0,0,f,m);var r=new Path2D;r.rect(u,d,p,h),n.addPath(i),n.addPath(r),t.save(),t.clip(n,"evenodd"),t.fillStyle="#000000",t.globalAlpha=.3,t.fill(i),t.globalAlpha=1;var o=new Path2D;o.rect(u-5,d-5,20,20),o.rect(u+p-15,d-5,20,20),o.rect(u-5,d+h-15,20,20),o.rect(u+p-15,d+h-15,20,20),t.fill(o),t.restore()}))},YG=function(){function e(e,t,n){this.upime=e,this.size={width:0,height:0},this.position={x:0,y:0},this.renderer=KG,this.renderKey="view_picker",this.unsubs=null,this.originalBorder={left:0,top:0,right:0,bottom:0},this.relation=null,this.size=t,this.position=n,this.listenMoveto(),this.originalBorder=this.getBorderBox()}return e.prototype.onDestroy=function(){var e;null===(e=this.unsubs)||void 0===e||e.call(this)},e.prototype.listenMoveto=function(){var e=this,t=[this.upime.userEventManager.subscribe("moveto",(function(t){var n,i,r=t.isStart,o=t.isEnd,a=t.position,s=t.startPosition;if(r&&(e.relation=e.checkSelectRelation(s),e.originalBorder=e.getBorderBox()),e.relation){var l=null===(i=null===(n=e.relation.metaData)||void 0===n?void 0:n.resizeData)||void 0===i?void 0:i.direction;if(!l){if("right"===t.connectType)return;var c=e.position,u=t.globalPosition,d=t.preGlobalPosition,p=e.upime.view,h=(u.x-d.x)/p.scale,f=(u.y-d.y)/p.scale;return e.position={x:c.x+h,y:c.y+f},e.originalBorder=e.getBorderBox(),void e.upime.view.update()}if("left"===t.connectType||"touch"===t.connectType){var m=Gt(e.originalBorder,s,a,l,{keepRatio:!1,minSize:20,noExtend:!0});e.size={width:m.right-m.left,height:m.bottom-m.top},e.position={x:m.left,y:m.top},e.upime.view.update(),o&&(e.originalBorder=e.getBorderBox())}}else e.dealMove(t)})),this.upime.userEventManager.subscribe("mousemove",(function(t){var n,i;if(!t.connected){var r=e.checkSelectRelation(t.position);if(r){var o=null===(i=null===(n=r.metaData)||void 0===n?void 0:n.resizeData)||void 0===i?void 0:i.direction;if(o){var a="pointer";switch(o){case"ne":case"sw":a="nesw-resize";break;case"nw":case"se":a="nwse-resize"}e.upime.view.setCursor(a,e)}else e.upime.view.setCursor("pointer",e)}else e.upime.view.setCursor(Vd(),e)}}))];this.unsubs=function(){t.forEach((function(e){return e()})),e.upime.view.setCursor("",e)}},e.prototype.dealMove=function(e){var t=e.globalPosition,n=e.preGlobalPosition,i=this.upime.view,r=i.x-(t.x-n.x)/i.scale,o=i.y-(t.y-n.y)/i.scale;this.upime.setViewPosScale(r,o)},e.prototype.getBorderBox=function(){return Bt({x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height})},e.prototype.checkSelectRelation=function(e){var t=8/this.upime.view.scale,n=this.getBorderBox();if(Ot(e,n,t)){var i=Wt(e,n,8/this.upime.view.scale),r={transparent:!1,metric:-1};return i&&(r.metaData={resizeData:{direction:i,originBorder:n}}),r}return null},M([rl],e.prototype,"size",void 0),M([rl],e.prototype,"position",void 0),M([il],e)}(),XG="button_2FLul",QG=function(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=i,a=o.finishSideEffect,s=o.viewPicker,l=o.upime;return e.useEffect((function(){var e=l.registerHotKey({key:"Escape"},(function(){n(null)}));return function(){e()}}),[]),e.createElement("div",{className:"root_3a9wT"},e.createElement("div",{className:"text_V-ry3"},e.createElement("span",null,r("init.viewbox.pick.title")),e.createElement("span",null,r("init.viewbox.pick.desc"))),e.createElement("div",{className:"actions_3o6w6"},e.createElement(ul,{type:"secondary",className:XG,onClick:function(){a(),n(null)}},r("common.cancel")),e.createElement(ul,{type:"primary",className:XG,onClick:function(){a(),n(s.getBorderBox())}},r("common.finish"))))},ZG=function(e){function t(t){var n=e.call(this,t)||this;return n.rows=3,n.cols=3,n._unsub=null,n._unsub_xmode=n.upime.subscribe("xmodechange",(function(e){var t;"table"===e?n._listenEvt(!0):"select"===e?n._listenEvt(!1):null===(t=n._unsub)||void 0===t||t.call(n)})),n.insertTableAt=function(e){var t=n.rows,i=n.cols,r=n.upime.createOperation(),o=n.upime.newMaxZindex(),a=Array(t*i).fill(null).map((function(e,t){return exports.E(exports.E({},AE({ha:"left"})),{rId:"".concat(t/i|0),cId:"".concat(t%i)})})),s={position:e.position,zIndex:o,name:O("table.title"),rows:t,cols:i,cells:a,fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,size:{width:256*n.cols,height:72*n.rows},rotate:0,scale:1,rowHeights:Array(t).fill(72),rowWidths:Array(i).fill(256),meshColor:9540508,color:1710618,hasBg:!0,bgColor:je[0],bgOpacity:1,va:"middle",ha:"left",focusedCellsIdx:null},l=r.create(Za.TABLE,s);r.sync(),n.upime.selectElement(l),n.rows=3,n.cols=3,n.upime.switchMode("select")},n._unsub_ele_update=n.upime.subscribe("elementsUpdated",(function(e){var t=n.upime.view.connectedRichEditor;if(t){var i=t.element;if(i.elementType===Za.GRID_TEXT&&(i.elementType!==Za.GRID_TEXT||i.draft)){var r=i.position,o=r.parentId,a=r.rowId,s=r.columnId;e.some((function(e){if(e.element.elementType===Za.GRID_TEXT){var t=e.element.position,i=t.parentId,r=t.rowId,l=t.columnId;if(i===o&&r===a&&l===s)return n.upime.view.clearConnectedRichEditor(),!0}return!1}))}}})),"table"===t.xmode&&n._listenEvt(!0),n}return P(t,e),t.prototype.setTableInsertDimensions=function(e,t){this.rows=e,this.cols=t},t.prototype._listenEvt=function(e){var t;e?this._unsub=this.upime.userEventManager.subscribe("click",this.insertTableAt):null===(t=this._unsub)||void 0===t||t.call(this)},t.prototype.destroy=function(){var e;this._unsub_xmode(),null===(e=this._unsub)||void 0===e||e.call(this),this._unsub_ele_update()},t}(zd),JG=function(){function e(e){var t=this;this.element=e,this.renderer=gM,this.renderKey="MEDIA_ctrl_"+e.id,this._unsub=this.element.upime.subscribe("elementDeleted",(function(n){n===e&&t.element.upime.clearFileHelperWidget()}))}return e.prototype.onDestroy=function(){this._unsub()},e}(),$G=20,eq=function(e){function t(n,i,r){var o=e.call(this)||this;return o.user=n,o.upime=r,o.renderer=tq,o.positions=[],o.lastPos=null,o.renderKey="laser_".concat(n.loginName,"_").concat(i),t.laserImg.loaded||er(t.laserImg),o}return P(t,e),Object.defineProperty(t.prototype,"loaded",{get:function(){return""!==this.user.userName},enumerable:!1,configurable:!0}),t.prototype.updatePositions=function(e){this.positions.length>1e3?this.positions=e:this.positions=this.positions.concat(e),this.upime.view.updateWidgetCvs()},t.prototype.getNextPos=function(){var e=this.positions.length/2;if(e){var t=void 0,n=void 0;return e>1?e%2?(t=this.positions[e-1],n=this.positions[e],this.positions.splice(0,e+1)):(t=this.positions[e],n=this.positions[e+1],this.positions.splice(0,e+2)):(t=this.positions[0],n=this.positions[1],this.positions=[]),{x:t,y:n}}return null},t.laserImg=tr($o("laser_pen.png")),t}(el),tq=function(e){var t=e.viewbox,n=e.upime,i=e.element,r=js.value,o=r.renderApp,a=r.addLoadingSource,s=i.user,l=i.getNextPos();l&&(null==o||o(0,null),i.lastPos=l);var c=null!=l?l:i.lastPos;if(!c||!Ot(c,t))return null;var u=n.view.getScreenPosition(c);if(fa({x:u.x,y:u.y}),Oa({x:0,y:0,width:26,height:26,src:eq.laserImg}),s.userName){var d=i.useMemo("textData",(function(){var e={text:s.userName,fontSize:12,fontFamily:He,textWidth:58,lineHeight:20,lineClamp:1,textOverflow:"ellipse"},t=Da(e);return e.metrics=t,{textData:e,drawRect:function(e){var n=e.context;n.beginPath(),n.save(),n.lineWidth=.1,n.strokeStyle="#fac711",n.clearRect(26,26,t.width+16,$G),n.moveTo(34,26),n.lineTo(8+t.width+26,26),n.arcTo(16+t.width+26,26,16+t.width+26,36,8),n.arcTo(16+t.width+26,46,8+t.width+26,46,8),n.lineTo(34,46),n.arcTo(26,46,26,36,8),n.arcTo(26,26,34,26,8),n.closePath(),n.fillStyle="#fac711",n.fill(),n.restore()}}}),[s.userName]),p=d.textData;Ma(d.drawRect),Ra(p,{x:34,y:26,fill:"#0C1024"})}else null==a||a(i);ma()},nq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case os.START_REPORT_POS:case os.STOP_REPORT_POS:return{type:i=t[0]};case os.POS_UPDATE:i=t[0];var n=t[1];return{type:i,loginName:n[0],connectionId:n[1],positions:t[2]};case os.LASER_ENDED:var i=t[0],r=t[1];return{type:i,loginName:r[0],connectionId:r[1]}}},t.prototype.updateLaserPos=function(e){this.sendSCmd(as.UPDATE_LASER_POS,e)},t.prototype.stopReportLaserPen=function(){this.sendSCmd(as.END_USE_LASER)},t}(Sp),iq=function(){function e(e){var t=this;this.upime=e,this._pens={},this._localLaserEnabled=!1,this._shouldReportLaserPos=!1,this._moveSub=null,this._laserPosBuffer=[],this._reportPosTimer=null,this._shouldReceiveLaserInfo=!1,this._localPen=null,this._laserServiceHandler=function(e){var n;switch(e.type){case os.START_REPORT_POS:t._enableReportPosTimer();break;case os.STOP_REPORT_POS:t._disableReportPosTimer();break;case os.POS_UPDATE:if(!t._shouldReceiveLaserInfo)return;var i=e.connectionId,r=e.loginName,o=e.positions,a=null===(n=t._pens[r])||void 0===n?void 0:n[i];a||(a=t._initLaserPen(r,i)),a.updatePositions(o);break;case os.LASER_ENDED:r=e.loginName,i=e.connectionId,t.removeLaserPen(r,i)}},this._laserService=new nq(e,5,this._laserServiceHandler),this._laserService.open(),this._xmodeSub=this.upime.subscribe("xmodechange",(function(e){var n="laser"===e;t._localLaserEnabled&&!n&&t._laserService.stopReportLaserPen(),t._localLaserEnabled="laser"===e,t._listenMouseMove("laser"===e)}))}return e.prototype.startReceiveLaserInfo=function(){this._shouldReceiveLaserInfo=!0},e.prototype.stopReceiveLaserInfo=function(){this._shouldReceiveLaserInfo=!1},e.prototype._listenMouseMove=function(e){var t,n=this,i=function(e,t){void 0===t&&(t={x:0,y:0});var i=e.position.x?e.position.x+t.x:0,r=e.position.y?e.position.y+t.y:0;if(n._localLaserEnabled&&n._shouldReportLaserPos)if(n._laserPosBuffer.length){var o=n._laserPosBuffer[n._laserPosBuffer.length-2],a=n._laserPosBuffer[n._laserPosBuffer.length-1];o===i&&a===r||n._laserPosBuffer.push(i,r)}else n._laserPosBuffer.push(i,r);n._localPen&&n._localPen.updatePositions([i,r])};e?this._moveSub=[this.upime.userEventManager.subscribe("mousemove",(function(e){return _e.isHoverSupported&&i(e)})),this.upime.userEventManager.subscribe("moveto",(function(e){if("touch"===e.connectType){if(e.isStart&&n._initLocalPen(),e.isEnd){if(!n._localPen)return;return n._removeLocalPen(),n._laserService.stopReportLaserPen(),void(n._laserPosBuffer=[])}var t=-60/n.upime.view.scale;i(e,{x:0,y:t})}}))]:(null===(t=this._moveSub)||void 0===t||t.forEach((function(e){return e()})),this._moveSub=null,this._removeLocalPen())},e.prototype.hasPen=function(e){return this._pens[e]&&!!Object.values(this._pens[e]).length},e.prototype._enableReportPosTimer=function(){var e=this;this._shouldReportLaserPos=!0,this._reportPosTimer=setInterval((function(){e._laserPosBuffer.length&&(e._laserService.updateLaserPos(e._laserPosBuffer),e._laserPosBuffer=[])}),40)},e.prototype._disableReportPosTimer=function(){this._shouldReportLaserPos=!1,this._reportPosTimer&&clearInterval(this._reportPosTimer),this._reportPosTimer=null},e.prototype._initLaserPen=function(e,t){var n=this.upime.getUserInfo(e),i=new eq(n,t,this.upime);return this._pens[e]||(this._pens[e]={}),this._pens[e][t]=i,this.upime.view.addCanvasWidget(i),this.upime.view.updateWidgetCvs(),i},e.prototype._removeLocalPen=function(){this._localPen&&this.upime.view.removeCanvasWidget(this._localPen),this._localPen=null},e.prototype._initLocalPen=function(){this._localPen||(this._localPen=new eq(this.upime.localUserInfo,"local",this.upime),this.upime.view.addCanvasWidget(this._localPen),this.upime.view.updateWidgetCvs())},e.prototype.removeLaserPen=function(e,t){var n=this;if(this._pens[e]){if(t){var i=this._pens[e][t];this.upime.view.removeCanvasWidget(i),delete this._pens[e][t]}else Object.values(this._pens[e]).forEach((function(e){return n.upime.view.removeCanvasWidget(e)})),delete this._pens[e];setTimeout((function(){return n.upime.view.updateWidgetCvs()}))}},e.prototype.reset=function(){var e=this;Object.values(this._pens).forEach((function(t){return Object.values(t).forEach((function(t){e.upime.view.removeCanvasWidget(t)}))})),this._removeLocalPen(),this._pens={},this.upime.view.updateWidgetCvs()},e.prototype.destroy=function(){var e;this.reset(),null===(e=this._moveSub)||void 0===e||e.forEach((function(e){return e()})),this._xmodeSub()},e}(),rq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b=e;switch(b[0]){case ss.CALL_FOR_FOLLOW:return{type:_=b[0],hostId:b[1]};case ss.FOLLOWER_IN:case ss.FOLLOWER_OUT:return{type:_=b[0],userId:T=b[1]};case ss.START_REPORT_DATA:case ss.END_REPORT_DATA:return{type:_=b[0]};case ss.SYNC_FOLLOW_DATA:_=b[0];var E=b[1],x=(T=E[0],E[1]),w=b[2],C=b.slice(3),S={};switch(w){case cs.ALL:S={viewData:C[0],commentData:C[1],docData:(null!==(s=C[2])&&void 0!==s?s:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),audioData:(null!==(l=C[3])&&void 0!==l?l:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),videoData:(null!==(c=C[4])&&void 0!==c?c:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),timerData:(null!==(u=C[5])&&void 0!==u?u:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),framePlayData:{frameId:C[6]?C[6][0]:null,fileId:C[6]?C[6][1]:null,tempFileId:C[6]?C[6][2]:null},ispringPptData:(null!==(d=C[7])&&void 0!==d?d:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),customData:(null!==(p=C[8])&&void 0!==p?p:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{})};break;case cs.VIEW:S={viewData:C[0]};break;case cs.COMMENT:S={commentData:C[0]};break;case cs.DOC:S={docData:(t={},t[(k=C[0])[0]]=k[1],t)};break;case cs.AUDIO:S={audioData:(n={},n[(k=C[0])[0]]=k[1],n)};break;case cs.VIDEO:S={videoData:(i={},i[(k=C[0])[0]]=k[1],i)};break;case cs.TIMER:S={timerData:(r={},r[(k=C[0])[0]]=k[1],r)};break;case cs.FRAMEPLAYER:S={framePlayData:{frameId:(k=C[0])[0],fileId:k[1],tempFileId:k[2]}};break;case cs.ISPRINGPPT:S={ispringPptData:(o={},o[(k=C[0])[0]]=k[1],o)};break;case cs.CUSTOM:var k;S={customData:(a={},a[(k=C[0])[0]]=k[1],a)}}return{type:_,data:S,dataType:w,userId:T,connectionId:x};case ss.KEY_FRAME:return{type:_=b[0],userIds:b[1]};case ss.REQUEST_VIEW_ONCE:return{type:_=b[0],connId:b[1]};case ss.INFORM_USER_VIEW_ONCE:var _=b[0],T=b[1];return b[2],S={viewData:(C=b.slice(3))[0],commentData:C[1],docData:(null!==(h=C[2])&&void 0!==h?h:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),audioData:(null!==(f=C[3])&&void 0!==f?f:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),videoData:(null!==(m=C[4])&&void 0!==m?m:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),timerData:(null!==(v=C[5])&&void 0!==v?v:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),framePlayData:{frameId:C[6]?C[6][0]:null,fileId:C[6]?C[6][1]:null,tempFileId:C[6]?C[6][2]:null},ispringPptData:(null!==(g=C[7])&&void 0!==g?g:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{}),customData:(null!==(y=C[8])&&void 0!==y?y:[]).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{})},{type:_,userId:T,data:S}}},t.prototype.callForFollow=function(e){this.sendSCmd(ls.CALL_FOR_FOLLOW,e)},t.prototype.followOther=function(e,t){t?this.sendSCmd(ls.START_FOLLOW,e,t):this.sendSCmd(ls.START_FOLLOW,e)},t.prototype.stopFollowOther=function(e,t){this.sendSCmd(ls.END_FOLLOW,e,t)},t.prototype.reportAllInfo=function(e){var t=e.viewData,n=e.commentData,i=e.docData,r=e.audioData,o=e.videoData,a=e.timerData,s=e.framePlayData,l=e.ispringPptData,c=e.customData;this.sendSCmd(ls.REPORT_SYNC_DATA,cs.ALL,t,n,i,r,o,a,s,l,c)},t.prototype.reportData=function(e){var t=e.type,n=e.data;this.sendSCmd(ls.REPORT_SYNC_DATA,t,n)},t.prototype.requestUserView=function(e){this.sendSCmd(ls.REQUEST_USER_VIEW_ONCE,e)},t.prototype.reportViewToUserOnce=function(e,t){this.sendSCmd.apply(this,R([ls.REPORT_VIEW_ONCE,e,cs.ALL],t,!1))},t}(Sp),oq="button_2YWdr",aq=function(t){var n=t.success,i=t.content,r=i.user,o=i.abortSignal,a=e.useContext(xl).phoneMode;al(r),e.useEffect((function(){o.then((function(){n(!1)}))}),[o]);var s=W().getUpimeTrans;return e.useEffect((function(){return function(){n(!1)}}),[]),e.createElement("div",{className:j("notiRoot_1q1nJ",a&&"phoneNotiRoot_3Zpyd")},e.createElement(ml,{url:r.avatarUrl,shape:"circle",className:"avatar_AY6_-"}),!a&&e.createElement("span",{className:"name_2qg-Y"},r.userName),e.createElement("span",null," ",s("follow.call.for.follow")),e.createElement(ul,{type:"primary",className:j(oq,"confirm_1twFQ"),onClick:function(){n(!0)}},s("follow.call.for.follow.confirm")),e.createElement(ul,{type:"text",className:j(oq,"reject_2MA5R"),onClick:function(){n(!1)}},s("follow.call.for.follow.reject")))},sq=function(){function e(e,t){var n=this;this.upime=e,this.sdSocketClient=t,this.followingUser=null,this.forcedFollowing=!1,this.forcedFollowHint="",this.followers=[],this._unsubs=[],this._shouldSyncData=!1,this._updateViewUnsub=null,this._lastFollowNotiInfo=null,this.followingRect=null,this.customGroups={},this.stickyFollowing=!1,this.isSilent=!1,this.sdUserViewReqMap={},this._lastFollowData={},this._subServiceHandler=function(e){return A(n,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A,B,L,O,F,z,H,U,W,V,j,G,q,K=this;return D(this,(function(D){switch(D.label){case 0:if(t=e.type,this.sdSocketClient)return t===ss.INFORM_USER_VIEW_ONCE&&(d=e.userId,u=e.data,(n=this.sdUserViewReqMap[d])&&(n.done(u),delete this.sdUserViewReqMap[d])),[2];switch(t){case ss.CALL_FOR_FOLLOW:return[3,1];case ss.FOLLOWER_IN:return[3,3];case ss.FOLLOWER_OUT:return[3,4];case ss.START_REPORT_DATA:return[3,5];case ss.END_REPORT_DATA:return[3,6];case ss.SYNC_FOLLOW_DATA:return[3,7];case ss.KEY_FRAME:return[3,8];case ss.REQUEST_VIEW_ONCE:return[3,9]}return[3,10];case 1:return this.upime.standardPresentation||this.followGroup||this.upime.shareAssistantManager?[3,10]:(this.clearFollowNotification(),i=e.hostId,r=null,o=new Promise((function(e){return r=e})),this._lastFollowNotiInfo={loginName:i,abort:r},[4,this.upime.showWindow(aq,{user:this.upime.getUserInfo(i),abortSignal:o},!0)]);case 2:return a=D.sent(),this._lastFollowNotiInfo=null,a&&(this.upime.operationInterrupt(),l=this.upime.getUserInfo(i),this.startFollowOther(l)),[3,10];case 3:return s=e.userId,l=this.upime.userManager.getUser(s),this.followers.includes(l)||(this.followers=R(R([],this.followers,!0),[l],!1)),[3,10];case 4:return c=e.userId,this.followers=this.followers.filter((function(e){return e.loginName!==c})),[3,10];case 5:return this._setupReport(),[3,10];case 6:return this._shouldSyncData=!1,null===(G=this._updateViewUnsub)||void 0===G||G.call(this),this._updateViewUnsub=null,[3,10];case 7:if(u=e.data,d=e.userId,p=e.connectionId,h=e.dataType,this.followGroup){if(!this.followGroup.checkFollowAction(d,p))return[2]}else if(this.stickyFollowing&&!this.followingUser&&this.upime.userManager.hasUser(d)&&(this.upime.operationInterrupt(),f=this.upime.userManager.getUser(d),this.setFollowingUser(f)),d!==(null===(q=this.followingUser)||void 0===q?void 0:q.loginName))return[2];if(m=u.viewData,v=u.commentData,g=u.docData,y=u.audioData,b=u.videoData,E=u.timerData,x=u.framePlayData,w=u.ispringPptData,C=u.customData,m&&(this.followingUser&&this._dealViewChange(m),this._lastFollowData.viewData=m),v&&(h===cs.ALL&&this.upime.collapseComments(),this.followingUser&&this._dealCommentChange(v),this._lastFollowData.commentData=v),E&&(this.followingUser&&this._dealTimerChange(E),this._lastFollowData.timerData=exports.E(exports.E({},this._lastFollowData.timerData),E)),g&&(this.followingUser&&this._dealDocChange(g),this._lastFollowData.docData=exports.E(exports.E({},this._lastFollowData.docData),g)),x&&(this.followingUser&&this._dealFramePlayerState(x),this._lastFollowData.framePlayData=exports.E({},x)),y&&(this.followingUser&&this._dealMediaStateChange(y,h===cs.ALL,(function(){return K.upime.elementManager.getAvailableElements((function(e){return e.elementType===Za.AUDIO}))})),h===cs.ALL?this._lastFollowData.audioData=y:(S=exports.E(exports.E({},this._lastFollowData.audioData),y),Object.keys(S).length>2&&(S=Object.entries(S).sort((function(e,t){return t[1].timestamp-e[1].timestamp})).slice(0,2).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{})),this._lastFollowData.audioData=S)),b&&(this.followingUser&&this._dealMediaStateChange(b,h===cs.ALL,(function(){return K.upime.elementManager.getAvailableElements((function(e){return e.elementType===Za.VIDEO}))})),h===cs.ALL?this._lastFollowData.videoData=b:(k=exports.E(exports.E({},this._lastFollowData.videoData),b),Object.keys(k).length>2&&(k=Object.entries(k).sort((function(e,t){return t[1].timestamp-e[1].timestamp})).slice(0,2).reduce((function(e,t){var n;return exports.E(exports.E({},e),((n={})[t[0]]=t[1],n))}),{})),this._lastFollowData.videoData=k)),w)if(this.followingUser&&this.dealPptStateChange(w,h===cs.ALL),h===cs.ALL)this._lastFollowData.ispringPptData=w;else{for(P in _=this._lastFollowData.ispringPptData||{},I={},w)_[P]?I[P]=exports.E(exports.E({},_[P]),w[P]):I[P]=w[P];this._lastFollowData.ispringPptData=I}if(C)if(this.followingUser&&this.dealCustomStateChange(C,h===cs.ALL),h===cs.ALL)this._lastFollowData.customData=C;else{for(P in T=this._lastFollowData.customData||{},I={},C)T[P]?I[P]=exports.E(exports.E({},T[P]),C[P]):I[P]=C[P];this._lastFollowData.customData=I}return this.isSilent&&this.stickyFollowing&&(this.isSilent=!1,this.updateFollowingUser(null),this.followingRect=null),this.upime.updateView(),[3,10];case 8:return N=e.userIds,this.followers=N.map((function(e){return K.upime.getUserInfo(e)})),this._setupReport(),[3,10];case 9:return M=e.connId,A=this.prepareAllInfo(),B=A.viewData,L=A.commentData,O=A.docData,F=A.audioData,z=A.videoData,H=A.timerData,U=A.framePlayData,W=A.ispringPptData,V=A.customData,j=[B,L,O,F,z,H,U,W,V],this._followSubService.reportViewToUserOnce(M,j),[3,10];case 10:return[2]}}))}))},this._followSubService=new rq(e,4,this._subServiceHandler,this.sdSocketClient),this._followSubService.open(),this._unsubs=[]}return e.prototype.updateFollowingUser=function(e){this.followingUser&&this.upime.usersCursorsManager.removeForceDisplayUser(this.followingUser.loginName),e&&this.upime.usersCursorsManager.addForceDisplayUser(e.loginName),this.followingUser=e},Object.defineProperty(e.prototype,"shouldSync",{get:function(){var e;return(!!this.followers.length||(null===(e=this.followGroup)||void 0===e?void 0:e.isViewSrc()))&&!this.followingUser&&this._shouldSyncData},enumerable:!1,configurable:!0}),e.prototype._dealViewChange=function(e){var t={x:e[0],y:e[1],width:e[2],height:e[3]};this.followingRect=t,this.upime.setViewRect(t,!0)},e.prototype._dealCommentChange=function(e){var t=e[0],n=e[1];this.upime.elementManager.openCommentById(t,n)},e.prototype._dealTimerChange=function(e){var t=this;Object.entries(e).forEach((function(e){var n=e[0],i=e[1],r=t.upime.elementManager.getElementById(n);r&&r.useServerTimerStatus(i)}))},e.prototype._dealDocChange=function(e){var t=this;Object.entries(e).forEach((function(e){var n=e[0],i=e[1].currentPage,r=t.upime.elementManager.getElementById(n);r&&(r.currentPage=i)}))},e.prototype._dealFramePlayerState=function(e){var t;null===(t=this.upime.currentPresentation)||void 0===t||t.dealPlayerState(e)},e.prototype._dealMediaStateChange=function(e,t,n){var i=this;n().forEach((function(n){t&&!e[n.id]&&i.upime.mediaPlayController.finishOne(n),e[n.id]&&n.useServerMediaStatus(e[n.id])}))},e.prototype.dealPptStateChange=function(e,t){var n=this,i=[],r=this.upime.elementManager.getAvailableElements((function(e){return e.elementType===Za.DOCUMENT&&5===e.fileType}));r.forEach((function(r){e[r.id]?i.push(r):t&&n.upime.cancelPreviewPpt(r)})),i.forEach((function(t){t.useServerPptState(e[t.id])}))},e.prototype.dealCustomStateChange=function(e,t){for(var n in e){var i=this.customGroups[n];i&&i.dealStateChange(e[n],t)}},e.prototype.setFollowingUser=function(e){var t=this;this.upime.clearSelect(),this.updateFollowingUser(e);var n=this._lastFollowData,i=n.viewData,r=n.commentData,o=n.docData,a=n.videoData,s=n.audioData,l=n.timerData,c=n.framePlayData,u=n.ispringPptData,d=n.customData;i&&this._dealViewChange(i),r&&(this.upime.collapseComments(),this._dealCommentChange(r)),l&&e.online&&(this.followGroup&&!this.followGroup.checkFollowAction(e.loginName)||this._dealTimerChange(l)),o&&this._dealDocChange(o),c&&this._dealFramePlayerState(c),a&&this._dealMediaStateChange(a,!0,(function(){return t.upime.elementManager.getAvailableElements((function(e){return e.elementType===Za.VIDEO}))})),s&&this._dealMediaStateChange(s,!0,(function(){return t.upime.elementManager.getAvailableElements((function(e){return e.elementType===Za.AUDIO}))})),u&&this.dealPptStateChange(u,!0),d&&this.dealCustomStateChange(d,!0)},e.prototype.callForFollow=function(e){this._followSubService.callForFollow(e.map((function(e){return e.loginName})))},e.prototype.startFollowOther=function(e,t){void 0===t&&(t={}),this.upime.online&&(this.followingUser===e&&(null==t?void 0:t.connId)===this.lastConId||(this.upime.clearSelect(),this.upime.mediaPlayController.fakePlay(),this.followingUser&&this.endFollowOther(this.followingUser),this.doStartFollowOther(e,t)))},e.prototype.doStartFollowOther=function(e,t){this.updateFollowingUser(e),this.connId=null==t?void 0:t.connId,this.stickyFollowing=!!(null==t?void 0:t.isStricky),this.lastConId=null==t?void 0:t.connId,this._followSubService.followOther(e.loginName,null==t?void 0:t.connId),this.upime.laserManager.startReceiveLaserInfo(),this.upime.publish("startFollowOther",e),(null==t?void 0:t.isStricky)&&(null==t?void 0:t.isSilent)&&(this.updateFollowingUser(null),this.followingRect=null,this.isSilent=!0)},e.prototype.stopFollowCurrent=function(){var e;this.forcedFollowing||this.followingUser&&(this.stickyFollowing||this.followGroup?(this.updateFollowingUser(null),this.followingRect=null):this.endFollowOther(this.followingUser),null===(e=this.onStopFollowCurrent)||void 0===e||e.call(this))},e.prototype.endFollowOther=function(e){this.doEndFollowOther(e)},e.prototype.doEndFollowOther=function(e){this.updateFollowingUser(null),this.followingRect=null,this._followSubService.stopFollowOther(e.loginName,this.connId),this.followers.length&&this.reportAllInfo(),this.upime.laserManager.stopReceiveLaserInfo(),this.upime.laserManager.reset(),this.upime.elementManager.getAllElements().filter((function(e){return e.elementType===Za.TIMER})).forEach((function(e){e.endFollowOther()})),this.upime.publish("endFollowOther",e)},e.prototype._setupReport=function(){var e=this;this._shouldSyncData=!0,this.reportAllInfo(),this._updateViewUnsub||(this._updateViewUnsub=this.upime.view.subscribe("viewboxChange",_t.throttle((function(){if(e.shouldSync){var t=e.upime.view,n=t.x,i=t.y,r=t.width,o=t.height;e._followSubService.reportData({type:cs.VIEW,data:[n,i,r,o]})}}),40)))},e.prototype.prepareAllInfo=function(){var e,t=this,n=this.upime.view,i=n.x,r=n.y,o=n.width,a=n.height,s=null;this.upime.elementManager.getAllComments().find((function(e){var t=e.expanded;return t&&(s=[e.id,!0]),t}));var l=[],c=[],u=[],d=[];this.upime.elementManager.getAllElements().forEach((function(e){if(e.elementType===Za.DOCUMENT&&(n=e).totalPage>1&&2!==n.mode&&l.push([n.id,{currentPage:n.currentPage}]),e.elementType===Za.TIMER){var n=e,i=Date.now()-n.millTime;d.push([n.id,{currentTime:1e3*n.currentTime,status:n.status,timestamp:t.upime.getCurServerTime()-i}])}e.elementType===Za.AUDIO&&(n=e).mediaPlayer.isPlaying&&c.push([n.id,{playing:n.mediaPlayer.isPlaying,currentTime:1e3*n.mediaPlayer.currentTime,speed:n.mediaPlayer.playbackRate,timestamp:t.upime.getCurServerTime(),loop:n.loop,skipMarkPoint:n.skipMarkPoint}]),e.elementType===Za.VIDEO&&(n=e).allowedPlay&&n.mediaPlayer.dom&&u.push([n.id,{playing:!!n.mediaPlayer.isPlaying,currentTime:1e3*n.mediaPlayer.currentTime,speed:n.mediaPlayer.playbackRate,timestamp:t.upime.getCurServerTime(),loop:n.loop,skipMarkPoint:n.skipMarkPoint}])}));var p=[null,null,null];if(void 0!==(null===(e=this.upime.currentPresentation)||void 0===e?void 0:e.framePlayer)){var h=this.upime.currentPresentation.framePlayer,f=h.currentFrame,m=h.currentFile,v=h.tempFile;p=[(null==f?void 0:f.id)||null,(null==m?void 0:m.id)||null,(null==v?void 0:v.id)||null]}var g=[];this.upime.pptPlayerManager.getPptPlayers().forEach((function(e){var t=e.pptPlayer;if(t){var n={page:t.pptPage,step:t.pptAction,trigger:e.lastTrigger||null,media:e.extraMedia?e.extraMedia.getCurrentState():null};g.push([e.id,n])}}));var y=[];for(var b in this.customGroups)y.push([b,this.customGroups[b].getFullState()]);return{viewData:[i,r,o,a],commentData:s,docData:l,audioData:c,videoData:u,timerData:d,framePlayData:p,ispringPptData:g,customData:y}},e.prototype.reportAllInfo=function(){var e=this.prepareAllInfo();this._followSubService.reportAllInfo(e)},e.prototype.reset=function(){var e;this.followingRect=null,this.followers=[],this.updateFollowingUser(null),this.clearFollowNotification(),null===(e=this._updateViewUnsub)||void 0===e||e.call(this),this._updateViewUnsub=null,this.disableForceFollow()},e.prototype.clearFollowNotification=function(e){!this._lastFollowNotiInfo||e&&e!==this._lastFollowNotiInfo.loginName||(this._lastFollowNotiInfo.abort(),this._lastFollowNotiInfo=null)},e.prototype.syncMediaStatus=function(e,t){this.followingUser&&this.stopFollowCurrent(),this.shouldSync&&this._followSubService.reportData({type:e.elementType===Za.AUDIO?cs.AUDIO:cs.VIDEO,data:[e.id,t]})},e.prototype.syncTimerStatus=function(e,t){this.shouldSync&&this._followSubService.reportData({type:cs.TIMER,data:[e.id,t]})},e.prototype.syncFramePlayer=function(e){if(this.followingUser&&this.stopFollowCurrent(),this.shouldSync){var t=e.currentFrame,n=e.currentFile,i=e.tempFile;this._followSubService.reportData({type:cs.FRAMEPLAYER,data:[(null==t?void 0:t.id)||null,(null==n?void 0:n.id)||null,(null==i?void 0:i.id)||null]})}},e.prototype.syncCommentStatus=function(e){this.shouldSync&&this._followSubService.reportData({type:cs.COMMENT,data:[e.id,e.expanded]})},e.prototype.syncDocStatus=function(e){this.followingUser&&this.stopFollowCurrent(),this.shouldSync&&this._followSubService.reportData({type:cs.DOC,data:[e.id,{currentPage:e.currentPage}]})},e.prototype.syncIspringPptStatus=function(e,t){this.followingUser&&this.stopFollowCurrent(),this.shouldSync&&this._followSubService.reportData({type:cs.ISPRINGPPT,data:[e,t]})},e.prototype.syncCustomState=function(e,t){this.followingUser&&this.stopFollowCurrent(),this.shouldSync&&this._followSubService.reportData({type:cs.CUSTOM,data:[e,t]})},e.prototype.enableForceFollow=function(e){this.forcedFollowHint=e,this.doEanbleForceFollow(e)},e.prototype.doEanbleForceFollow=function(e){this.forcedFollowing=!0,this.upime.viewLocked=!0,this.upime.viewLockedHintMsg=e},e.prototype.disableForceFollow=function(){this.doDisableForceFollow()},e.prototype.doDisableForceFollow=function(){this.forcedFollowing=!1,this.upime.viewLocked=!1,this.upime.viewLockedHintMsg=null},e.prototype.addCustomStateGroup=function(e,t){this.customGroups[t]=e},e.prototype.requestUserViewOnce=function(e){var t=this;if(this.sdUserViewReqMap[e])return this.sdUserViewReqMap[e].result;this._followSubService.requestUserView(e);var n=new Ks;return this.sdUserViewReqMap[e]=n,setTimeout((function(){n.done(null),delete t.sdUserViewReqMap[e]}),2e3),n.result},e.prototype.createFollowDomain=function(){},e.prototype.releaseFollowDomain=function(e){},e.prototype.destroy=function(){this.reset(),this._unsubs.forEach((function(e){return e()}))},M([rl],e.prototype,"followingUser",void 0),M([rl],e.prototype,"forcedFollowing",void 0),M([rl],e.prototype,"followers",void 0),M([il],e)}(),lq="root_1fVAj",cq="title_1x5_x",uq="actions_1nEwf",dq="button_2_uVC",pq="cancel_1Z1xD",hq=function(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans,a=r,s=a.isCreate,l=a.defaultV,c=e.useState(l),u=c[0],d=c[1],p=e.useRef(null);return e.useEffect((function(){var e=p.current;null==e||e.focus(),s&&(null==e||e.setSelectionRange(0,e.value.length))}),[]),e.createElement("div",{className:lq},e.createElement(hl,{icon:"guanbi",className:"closeIcon_3q-pJ",onClick:function(){return i("cancel")}}),e.createElement("span",{className:cq},o(s?"version.new":"version.update")),e.createElement("div",{className:"inputBlock_Nsk1w"},e.createElement("span",null,o("version.name")),e.createElement("input",{value:u,onChange:function(e){return d(e.target.value)},ref:p,maxLength:50})),e.createElement("div",{className:uq},e.createElement(ul,{className:j(dq,pq),type:"secondary",onClick:function(){return i("cancel")}},o("common.cancel")),e.createElement(ul,{className:dq,type:"primary",disabled:!u,onClick:function(){return n(u)}},o("common.confirm"))))},fq=function(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans,a=r.text;return e.createElement("div",{className:j(lq,"small_1PfTl")},e.createElement("div",{className:"header_2zo2Z"},e.createElement(hl,{icon:"qingchu"}),e.createElement("span",{className:cq},o("version.delete"))),e.createElement("span",{className:"content_Fn6Dp"},o("version.delete.text.prefix"),e.createElement("em",null," ".concat(a," ")),o("version.delete.text.suffix")),e.createElement("div",{className:uq},e.createElement(ul,{className:j(dq,pq),type:"secondary",onClick:function(){return i("cancel")}},o("common.cancel")),e.createElement(ul,{className:dq,type:"danger",onClick:function(){return n()}},o("common.delete"))))},mq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case ds.NEW_ACTIVITY:return{type:t[0],data:t[1]};case ds.REVERTED_ACTIVITY:return{type:t[0],uniqueId:t[1],userId:t[2]};case ds.DELETE_ACTIVITY:return{type:t[0],uniqueId:t[1]}}},t.prototype.subscribe=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(ps.SUBSCRIBE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.unsubscribe=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(ps.UNSUBSCRIBE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.fetchActivities=function(e,t){return void 0===t&&(t=30),A(this,void 0,void 0,(function(){var n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return[4,this.sendRCmd(ps.FETCH_ACTIVITY,e||"",t)];case 1:return n=a.sent(),i=n[0],r=n[1],o=n[2],[2,{res:i,ended:r,data:o}]}}))}))},t.prototype.revertRecord=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(ps.REVERT_ITEM,e)];case 1:return[2,t.sent()[0]]}}))}))},t}(Sp),vq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case hs.VERSION_UPDATE:return{type:t[0],data:t[1]};case hs.VERSION_NAME_UPDATE:return{type:t[0],id:t[1],desc:t[2]}}},t.prototype.subscribe=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(fs.SUBSCRIBE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.unsubscribe=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.sendRCmd(fs.UNSUBSCRIBE)];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.addNewVersion=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(fs.NEW_VERSION,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.updateVersion=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(fs.UPDATE_NAME,e,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.deleteVersion=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(fs.DELETE,e)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.restoreTo=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(fs.RESTORE,e)];case 1:return[2,t.sent()[0]]}}))}))},t}(Sp),gq=function(){function e(e,t){var n=this;this.upime=e,this.activities=[],this.hasFetchedAllAct=!1,this.fetchingActivities=!1,this._activityMap={},this.versions=[],this._createVerTimer=null,this._actSubServiceHandler=function(e){switch(e.type){case ds.NEW_ACTIVITY:e.data.forEach((function(e){var t=e.auxiliaryId,i=n._activityMap[t];if(e.eventType===us.DELETE&&e.elmTypes.every((function(e){return e===Za.GRID_TEXT}))&&(e.unRevertable=!0),i){var r=n.activities.findIndex((function(e){return e===i}));-1!==r&&n.activities.splice(r,1)}n.activities.unshift(e),n.activities=R([],n.activities,!0),n._activityMap[t]=e}));break;case ds.REVERTED_ACTIVITY:var t=e.uniqueId,i=e.userId,r=n.activities.find((function(e){return e.uniqueId===t}));r&&(r.userId===i?n.activities=n.activities.filter((function(e){return e!==r})):(r.reverted=!0,n.activities=R([],n.activities,!0)));break;case ds.DELETE_ACTIVITY:var o=e.uniqueId;n.activities=n.activities.filter((function(e){return e.uniqueId!==o}))}},this.fetchMoreRecord=function(e){return void 0===e&&(e=0),A(n,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c=this;return D(this,(function(u){switch(u.label){case 0:return this.hasFetchedAllAct||this.fetchingActivities?[2]:(this.fetchingActivities=!0,t=e||this.activities.length-1,n=null===(l=this.activities[t])||void 0===l?void 0:l.uniqueId,[4,this._activitySubService.fetchActivities(n)]);case 1:return i=u.sent(),r=i.res,o=i.ended,a=i.data,!r&&t>=1?(this.fetchingActivities=!1,[4,this.fetchMoreRecord(t-1)]):[3,3];case 2:return u.sent(),[3,4];case 3:this.hasFetchedAllAct=o,s=R([],this.activities,!0),a.forEach((function(e){var t=e.uniqueId;c.activities.find((function(e){return e.uniqueId===t}))||(s.push(e),e.elmTypes.every((function(e){return e===Za.GRID_TEXT}))&&(e.unRevertable=!0),c._activityMap[e.auxiliaryId]=e)})),this.activities=s,this.fetchingActivities=!1,u.label=4;case 4:return[2]}}))}))},this.revertAct=function(e){return A(n,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u=this;return D(this,(function(d){switch(d.label){case 0:t=this.upime,n=t.createOperation(),i=!1,r=[],o=new Set,a=function(a){var l,c,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A;return D(this,(function(D){switch(D.label){case 0:return l=e.elmIds[a],c=e.elmTypes[a],l&&c?(d=t.elementManager.getElementById(l))?(p=zs(d,c),[3,3]):[3,1]:(i=!0,[2,"break"]);case 1:return[4,t.getAllElementInfoById(l)];case 2:h=D.sent(),p=h.data,s.upime.addElementInfo(l,h.info),D.label=3;case 3:if(c===Za.MINDMAP_LINE&&(f=p.startElementId)&&o.add(f),c===Za.CONNECTIONLINE||c===Za.MINDMAP_LINE){if(f=(y=p).startElementId,m=y.endElementId,f&&(!(v=t.elementManager.getElementById(f))||v.deleted)&&!e.elmIds.includes(f))return i=!0,[2,"break"];if(m&&(!(g=t.elementManager.getElementById(m))||g.deleted)&&!e.elmIds.includes(m))return i=!0,[2,"break"]}return(c!==Za.CARD||!(y=p).kanbanId||(b=s.upime.elementManager.getElementById(y.kanbanId))&&!b.deleted||e.elmIds.includes(y.kanbanId))&&(c!==Za.COMMENT||!(E=p.attached)||(x=t.elementManager.getElementById(E))&&!x.deleted||e.elmIds.includes(E))?(p.position.parentType&&(w=p.position.parentId,C=!1,S=t.elementManager.getElementById(w),k=!!S&&!S.deleted,_=e.elmIds.includes(w),k||_?k&&(p.position.parentType===Za.VIDEO&&(T=p.position.mediaTime,S.markPoints.find((function(e){return e.mediaTime===T}))||(C=!0)),p.position.parentType===Za.TABLE&&(I=p.position,P=I.rowId,N=I.columnId,S.cells.find((function(e){return e.cId===N&&e.rId===P}))||(C=!0))):C=!0,C&&(M=t.view.getViewbox(),A={x:(M.right+M.left)/2,y:(M.bottom+M.top)/2},p.position=A)),r.push({order:[Za.CONNECTIONLINE,Za.MINDMAP_LINE].includes(c)||p.position.parentType?1:0,cb:function(){if(c!==Za.KANBAN)if(c!==Za.CARD)n.create(c,exports.E(exports.E({},p),{deleted:!1}),{id:l,isRevert:!0});else{if(d&&d.isGhost)return;var e=p;if(!e.kanbanId)return void u.upime.kanbanManager.updateCard(l,exports.E(exports.E({},p),{deleted:!1}),{kanbanId:"",index:0});var t=u.upime.elementManager.getElementById(e.kanbanId);if(t){var i=t.cards.findIndex((function(e){return e===l}));-1===i?u.upime.kanbanManager.updateCard(l,exports.E(exports.E({},p),{deleted:!1}),{kanbanId:null,index:-1},{kanbanId:t.id,index:t.cards.length}):u.upime.kanbanManager.updateCard(l,exports.E(exports.E({},p),{deleted:!1}),{kanbanId:t.id,index:i})}}else u.upime.kanbanManager.createKanban(exports.E(exports.E({},p),{deleted:!1,id:l}))}}),[2]):(i=!0,[2,"break"])}}))},s=this,l=0,d.label=1;case 1:return l<e.elmIds.length?[5,a(l)]:[3,4];case 2:if("break"===d.sent())return[3,4];d.label=3;case 3:return l++,[3,1];case 4:return i?(this.upime.addToast(O("history.activity.restore.forbidden")),n.cancelCreate(),[2]):[4,this._activitySubService.revertRecord(e.uniqueId)];case 5:return d.sent()?(r.sort((function(e,t){return e.order-t.order})).forEach((function(e){return(0,e.cb)()})),c=new Set,o.forEach((function(e){var t,i=null===(t=u.upime.elementManager.getElementById(e))||void 0===t?void 0:t.root;i&&(c.has(i)||(c.add(i),i.onAlignTheTree(n)))})),n.sync(),this.showActEles(e),e.userId===this.upime.localUserInfo.loginName?this.activities=this.activities.filter((function(t){return t!==e})):(e.reverted=!0,this.activities=R([],this.activities,!0)),[2]):(this.upime.addToast("恢复历史记录失败"),[2])}}))}))},this._verSubServiceHandler=function(e){switch(e.type){case hs.VERSION_UPDATE:var t=e.data,i=n.versions.find((function(e){return e.id===t.id}));i?Object.assign(i,t):n.versions.unshift(t),n.versions=R([],n.versions,!0);break;case hs.VERSION_NAME_UPDATE:var r=e.id,o=e.desc;i=n.versions.find((function(e){return e.id===r})),i&&(i.description=o,n.versions=R([],n.versions,!0))}},this.restoreToVersion=function(e){return A(n,void 0,void 0,(function(){return D(this,(function(t){return[2,this._versionSubService.restoreTo(e)]}))}))},this._activitySubService=new mq(e,6,this._actSubServiceHandler),this._versionSubService=new vq(e,7,this._verSubServiceHandler),this.config=t}return e.prototype.initActivity=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this._activitySubService.open()];case 1:return e.sent(),[4,this._activitySubService.subscribe()];case 2:return e.sent()||this.upime.addToast("启用操作历史功能失败"),[2]}}))}))},e.prototype.showActEles=function(e){var t=this.upime.elementManager.getElementById(e.elmIds[0]);(null==t?void 0:t.elementType)===Za.MINDMAP_NODE&&t.isMindmapNodeHideByCollapsed&&(t=t.seekUnHideParent()),t&&!t.deleted&&(t.elementType===Za.COMMENT?this.upime.slideViewToComment(t):this.upime.showElement(t))},e.prototype.initVersion=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this._versionSubService.open()];case 1:return t.sent(),[4,this._versionSubService.subscribe()];case 2:return(e=t.sent())&&Array.isArray(e)?this.versions=e:this.upime.addToast("启用版本功能失败"),[2]}}))}))},e.prototype.addNewVersion=function(){return A(this,void 0,void 0,(function(){var e,t,n,i=this;return D(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this._createVerTimer?(this.upime.addToast(O("version.new.throttle"),{type:"normal"}),[2]):(e=this.upime.getCurServerTime(),[4,this.upime.showWindow(hq,{defaultV:"".concat(jI(e)," ").concat(O("version.label")),isCreate:!0},!1,!0)]);case 1:return t=r.sent(),[4,this._versionSubService.addNewVersion(t)];case 2:return(n=r.sent())?(this.versions.unshift(n),this.versions=R([],this.versions,!0),this._createVerTimer=setTimeout((function(){i._createVerTimer=null}),6e4),this.upime.addToast(O("version.create.success"),{type:"normal"})):this.upime.addToast("新增版本失败"),[3,4];case 3:return r.sent(),[2];case 4:return[2]}}))}))},e.prototype.updateVersion=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.upime.showWindow(hq,{defaultV:t,isCreate:!1},!1,!0)];case 1:return n=i.sent(),[4,this._versionSubService.updateVersion(e.id,n)];case 2:return i.sent()?(e.description=n,this.versions=R([],this.versions,!0),this.upime.addToast(O("version.update.success"),{type:"normal"})):this.upime.addToast("编辑版本名称失败"),[3,4];case 3:return i.sent(),[2];case 4:return[2]}}))}))},e.prototype.deleteVersion=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.upime.showWindow(fq,{text:e.description},!1,!0)];case 1:return t.sent(),[4,this._versionSubService.deleteVersion(e.id)];case 2:return t.sent()?(this.upime.addToast(O("version.delete.success"),{type:"normal"}),this.versions=this.versions.filter((function(t){return t!==e}))):this.upime.addToast("删除版本失败"),[3,4];case 3:return t.sent(),[2];case 4:return[2]}}))}))},e.prototype.reset=function(){this.resetActivity(),this.resetVersion()},e.prototype.resetActivity=function(){this._activitySubService.unsubscribe(),this._activitySubService.close(),this.activities=[],this.hasFetchedAllAct=!1,this.fetchingActivities=!1},e.prototype.resetVersion=function(){this._versionSubService.unsubscribe(),this._versionSubService.close(),this.versions=[]},e.prototype.updateConfig=function(e){this.config=e},e.prototype.destroy=function(){this.reset()},M([rl],e.prototype,"activities",void 0),M([rl],e.prototype,"versions",void 0),M([il],e)}(),yq=function(e,t,n){this.position=e,this.onCommit=t,this.onCancel=n,this.renderer=bq,this.renderKey="`insert-webpage`"},bq=function(t){var n,i=t.element,r=t.viewbox,o=i.position,a=i.onCommit,s=i.onCancel,l=(o.x-r.left)*r.scale,c=(o.y-r.top)*r.scale,u=e.useState(!1),d=u[0],p=u[1],h=e.useRef(null),f=e.useRef(null),m=e.useRef(null),v=W().getUpimeTrans;function g(){var e=f.current.value.trim();if(ve(e))return e;var t=ge(e);return!!me(t)&&t}function y(e){null==e||e.stopPropagation();var t=g();p(!t),t&&a(t)}e.useEffect((function(){var e=f.current;return e.focus(),e.addEventListener("keydown",(function(e){e.defaultPrevented||e.isComposing||"Enter"!==e.key||y()})),gh((function(){s()}),{skipElements:[h.current],quick:!0})}),[]);var b=e.useState(""),E=b[0],x=b[1],w=(null!==(n=e.useContext(xl).upime.userManager.userAccessHint)&&void 0!==n?n:{}).WebPageHelp;return e.createElement("div",{className:"border_3oKqY",style:{left:l,top:c},ref:h,onClick:function(e){var t=e.target,n=m.current;if(!n||t!==n&&!V(n,t)){var i=f.current;if(i&&e.target!==i){var r=g();p(!r)}}}},e.createElement("div",{className:"header_172-b"},v("webpage.insert.title"),e.createElement("div",{className:"close_L0kpy",onClick:function(e){e.stopPropagation(),s()}},e.createElement(hl,{icon:"guanbi"}))),e.createElement("div",{className:"content_3tNxg"},e.createElement("input",{value:E,onChange:function(e){x(e.target.value)},className:j("input__gVok",d&&"error_2rKvs",!E&&"empty_cDwNE"),ref:f,placeholder:v("webpage.insert.placeholder")}),E&&e.createElement("div",{className:"clearInput_3wLCs",onClick:function(){var e;x(""),null===(e=f.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"})),e.createElement("div",{className:"commit_btn_2y3bA",onClick:y},v("common.confirm"))),e.createElement("div",{className:"error_msg_10zjs"},d?v("webpage.insert.error"):""),e.createElement("div",{ref:m},w&&e.createElement(w,null)))},Eq=function(e){function t(t){var n=e.call(this,t)||this;return n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"insert-webpage"===e?n.waitClick(!0):n.waitClick(!1)})),n.prepareUrl=function(e){n.upime.switchMode("select");var t=new yq(e.position,(function(i){n.upime.view.removeDomWidget(t),n.insertWebpage(e.position,{url:i})}),(function(){n.upime.view.removeDomWidget(t)}));n.upime.view.addDomWidget(t)},n.insertWebpage=function(e,t){var i=t.url,r=t.customName,o=t.verticalPos,a=void 0===o?"center":o,s=t.horizPos,l=void 0===s?"center":s,c=t.currentOp;return A(n,void 0,void 0,(function(){function t(e){return new Promise((function(t,n){var i=window.setTimeout((function(){n("img load timeout")}),1e4),r=document.createElement("img");r.onload=function(){clearTimeout(i),t({width:r.naturalWidth,height:r.naturalHeight})},r.onerror=function(){clearTimeout(i),n("img load error")},r.src=e}))}var n,o,s,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P,N,M,A,R;return D(this,(function(D){switch(D.label){case 0:return n=this.parseUrl(i),o=n.src,s=n.iframeHtmlTags,u=this.upime,d=c||this.upime.createOperation(),p=Xe,h=1/this.upime.view.scale,f=.5*p.width*h,m=.5*p.height*h,v=e.x,g=e.y,"center"===l&&(v-=f),"center"===a&&(g-=m),y={x:v,y:g},b={zIndex:u.newMaxZindex(),size:p,scale:h,position:y,name:r||o,title:"",coverFileId:"",url:o,coverSize:{width:0,height:0},status:1,description:"",iframeHtmlTags:s},E=d.create(Za.WEBPAGE,b),this.findAndSetParent(d,E),x=this.upime.createLock([E.id]),d.sync(),u.clearLock(x),u.selectElement(E),[4,Md({uri:o}).result];case 1:if(w=D.sent(),C=w.code,S=w.obj,0!==C)return[3,7];if(k=S.title,_=S.description,!(T=S.coverData))return[3,6];I=decodeURIComponent(T),D.label=2;case 2:return D.trys.push([2,5,,6]),[4,t(I)];case 3:return P=D.sent(),N=K(I),M="".concat(this.upime.genFileName(E.id),"_cover.png"),N.name=M,N.lastModifiedDate=Date.now(),A=N,[4,this.upime.saveFile(2,{file:A,ext:"png",fakeName:M})];case 4:return R=D.sent(),d.update(E,{coverFileId:R,coverSize:P}),[3,6];case 5:return D.sent(),[3,6];case 6:return d.update(E,{status:0,title:k,name:r||k||i,description:_}),d.sync(),[3,8];case 7:d.update(E,{status:0,name:o}),d.sync(),D.label=8;case 8:return[2]}}))}))},"insert-webpage"===t.xmode&&n.waitClick(!0),n}return P(t,e),t.prototype.waitClick=function(e){var t=this;if(this.unsub_click&&this.unsub_click(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.prepareUrl(e)}))];this.unsub_click=function(){return n.forEach((function(e){return e()}))}}},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_click;void 0!==e&&e()},t.prototype.parseUrl=function(e){if(ve(e)){for(var t=(new DOMParser).parseFromString(e,"text/html").body.firstChild,n=t.attributes,i={},r=0;r<n.length;r++){var o=n.item(r);o&&"src"!==o.name&&(i[o.name]=o.value)}return{src:ge(t.src),iframeHtmlTags:i}}return{src:e,iframeHtmlTags:null}},t}(zd),xq=function(e){function t(t){var n=e.call(this,t)||this;return n.duration=300,n.unsub_xmode=n.upime.subscribe("xmodechange",(function(e){"timer"===e?n.listenMoveto(!0):n.listenMoveto(!1)})),n.insertTimer=function(e,t){var i=n.upime,r=n.upime.createOperation(),o=Ye,a=1*o.width*.5,s=1*o.height*.5,l={x:e.position.x-a,y:e.position.y-s},c={zIndex:i.newMaxZindex(),size:o,position:l,duration:n.duration,currentTime:n.duration,status:"ready",editing:0===n.duration,selected:!0},u=r.create(Za.TIMER,c);return n.findAndSetParent(r,u),r.sync(),i.switchMode("select"),u},"timer"===t.xmode&&n.listenMoveto(!0),n}return P(t,e),t.prototype.listenMoveto=function(e){var t=this;if(this.unsub_move&&this.unsub_move(),e){var n=[this.upime.userEventManager.subscribe("click",(function(e){return t.insertTimer(e)}))];this.unsub_move=function(){return n.forEach((function(e){return e()}))}}},t.prototype.setDuration=function(e){this.duration=e},t.prototype.destroy=function(){this.unsub_xmode();var e=this.unsub_move;void 0!==e&&e()},t}(zd),wq=function(){function e(e,t,n){var i=this;void 0===n&&(n=Qe),this.upime=e,this.parent_connected=!1,this.active=!1,this.iframe=document.createElement("iframe"),this._noPointerEvent=!0,this.viewOnly=!1,this.active=!1,this.iframe.classList.add("webviewer_iframe_2xkBo",jN),this.iframe.style.width=n.width+"px",this.iframe.style.height=n.height+"px",this.iframe.onload=function(){i.onload()},this.setIframeSrc(t),this.unsubs=[e.userEventManager.subscribe("connected",(function(e){e?(i.parent_connected=!0,i.noPointerEvent=!0,i.iframe.blur()):(i.parent_connected=!1,i.updatePointerEventStatus())}))]}return Object.defineProperty(e.prototype,"noPointerEvent",{get:function(){return this._noPointerEvent},set:function(e){this._noPointerEvent=e,e?this.iframe.classList.add(jN):this.iframe.classList.remove(jN)},enumerable:!1,configurable:!0}),e.prototype.updatePointerEventStatus=function(){this.noPointerEvent=this.parent_connected||this.viewOnly||!this.active},e.prototype.setIframeSrc=function(e){this.iframe.src=e},e.prototype.setIframeAttr=function(e){var t=this;e&&Object.entries(e).forEach((function(e){var n=e[0],i=e[1];try{t.iframe.setAttribute(n,i)}catch(e){}}))},e.prototype.onload=function(){},e.prototype.setViewOnly=function(e){this.viewOnly=e,this.parent_connected||this.updatePointerEventStatus()},e.prototype.focus=function(){this.active=!0,this.updatePointerEventStatus()},e.prototype.blur=function(){this.iframe.blur(),this.active=!1,this.updatePointerEventStatus()},e.prototype.attachParent=function(e){this.parentNode=e,e.appendChild(this.iframe)},e.prototype.destroy=function(){var e;null===(e=this.parentNode)||void 0===e||e.removeChild(this.iframe),this.iframe.onload=null,this.iframe.src="",this.parentNode=void 0,this.unsubs.forEach((function(e){return e()}))},e}(),Cq=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.loaded=!1,i.loadingWork=new Ks,i.dealMessage=function(e){return A(i,void 0,void 0,(function(){var t,n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:if(e.source!==this.iframe.contentWindow||!e.data)return[2];switch(t=e.data,n=t.name,i=t.value,n){case"askClipboard":return[3,1];case"gotClipboard":return[3,9];case"connected":return[3,10];case"disconnected":return[3,11]}return[3,12];case 1:return l.trys.push([1,7,,8]),[4,navigator.permissions.query({name:"clipboard-read"})];case 2:return"denied"===l.sent().state?[2]:[4,navigator.clipboard.read()];case 3:return(r=l.sent()).length?[4,r[0].getType("text/plain")]:[3,6];case 4:return[4,l.sent().text()];case 5:o=l.sent(),this.sendMesg("clipboard",o),l.label=6;case 6:return[3,8];case 7:return l.sent(),[3,8];case 8:return[3,12];case 9:return Xd(i,{onCopy:function(e){e.setData("text/plain",i)}}),[3,12];case 10:return null===(a=this.onconnect)||void 0===a||a.call(this),[3,12];case 11:return null===(s=this.ondisconnect)||void 0===s||s.call(this),[3,12];case 12:return[2]}}))}))},window.addEventListener("message",i.dealMessage),i}return P(t,e),t.prototype.onload=function(){this.loaded=!0,this.loadingWork.done()},t.prototype.sendMesg=function(e,t){var n;return A(this,void 0,void 0,(function(){return D(this,(function(i){switch(i.label){case 0:return this.loaded?[3,2]:[4,this.loadingWork.result];case 1:i.sent(),i.label=2;case 2:return null===(n=this.iframe.contentWindow)||void 0===n||n.postMessage({name:e,value:t},"*"),[2]}}))}))},t.prototype.connect=function(e,t,n){this.sendMesg("connect",{host:e,port:t,password:n})},t.prototype.setViewOnly=function(t){this.sendMesg("viewOnly",t),e.prototype.setViewOnly.call(this,t)},t.prototype.destroy=function(){var t;window.removeEventListener("message",this.dealMessage),this.sendMesg("disconnect"),null===(t=this.ondisconnect)||void 0===t||t.call(this),this.onconnect=this.ondisconnect=void 0,e.prototype.destroy.call(this)},t}(wq),Sq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype.setIframeSrc=function(e){this.checkTypeAndLoad(e)},t.prototype.checkTypeAndLoad=function(e){var t;return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return[4,this.upime.userManager.checkWebpageType(e)];case 1:return"iframe"===(n=i.sent())?this.iframe.src=e:"vnc"===n&&(null===(t=this.fallbackToVnc)||void 0===t||t.call(this)),[2]}}))}))},t}(wq),kq=function(e){function t(t){var n=e.call(this,t)||this;return n.webpages=[],n}return P(t,e),t.prototype.requestPreview=function(e){var t=this,n=this.webpages;n.includes(e)||n.push(e),n.length>1&&n.shift().doStopPreview();var i=new Sq(this.upime,e.url);e.doStartPreview(i),i.fallbackToVnc=function(){return A(t,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.upime.requestLocalVnc(e)];case 1:return(t=n.sent())&&(e.doStopPreview(),e.tempVncView=t,e.doStartPreview(t)),[2]}}))}))}},t.prototype.cancelPreview=function(e){this.webpages=this.webpages.filter((function(t){return t!==e})),e.doStopPreview()},t.prototype.finishAll=function(){this.webpages.forEach((function(e){return e.doStopPreview()})),this.webpages=[]},t.prototype.destroy=function(){this.finishAll()},t}(zd);!function(e){e[e.QUERY_SERVER_INFO=0]="QUERY_SERVER_INFO",e[e.REPORT_LINK_STATE=1]="REPORT_LINK_STATE",e[e.REQUEST_SINGLE_VNC=2]="REQUEST_SINGLE_VNC",e[e.CLOSE_SINGLE_VNC=3]="CLOSE_SINGLE_VNC"}(UG||(UG={}));var _q,Tq=function(){function e(e){this.upime=e,this.vncIdMap={},this.vncService=new Iq(e,8,ce)}return e.prototype.getVncServerInfo=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this.vncService.getVncServerInfo(e)];case 1:return t=r.sent(),n=t[0],i=t[1],n?[2,null]:[2,i]}}))}))},e.prototype.reportLinkState=function(e,t){return this.vncService.reportLinkState(e,t)},e.prototype.createViewer=function(e){var t=this,n="www"===Ce?"https://infi.cn/static/infi-cloud-server/":"https://".concat(Ce,".plaso.cn/static/infi-novnc/"),i=new Cq(this.upime,n);return i.onconnect=function(){t.reportLinkState(e,!0)},i.ondisconnect=function(){t.reportLinkState(e,!1)},this.getVncServerInfo(e).then((function(e){if(e){var t=e.host,n=e.port,r=e.pwd;i.connect(t,n,r)}})),i},e.prototype.requestSingleView=function(e){return A(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:return[4,this.vncService.requestSingleVnc(e)];case 1:return t=r.sent(),n=t[0],i=t[1],0===n?(this.vncIdMap[e.id]=i,[2,this.createViewer(i)]):[2,null]}}))}))},e.prototype.closeSingleView=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.vncIdMap[e.id]&&delete this.vncIdMap[e.id],[2]}))}))},e}(),Iq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){},t.prototype.getVncServerInfo=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(UG.QUERY_SERVER_INFO,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.requestSingleVnc=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.sendRCmd(UG.REQUEST_SINGLE_VNC,e.id,e.url)]}))}))},t.prototype.closeSingleVnc=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.sendRCmd(UG.CLOSE_SINGLE_VNC,e)]}))}))},t.prototype.reportLinkState=function(e,t){this.sendRCmd(UG.REPORT_LINK_STATE,e,t?1:0)},t}(Sp),Pq=PU.exports.HmacSHA1;function Nq(e,t,n,i){var r=t.uploadFile,o=r.file,a=r.fakeName,s=t.acl,l=void 0===s?"public-read":s;return A(this,void 0,void 0,(function(){var t,r,s,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_,T,I,P;return D(this,(function(N){switch(N.label){case 0:return t=e.accessKeyId,r=e.accessKeySecret,s=e.stsToken,c=e.provider,u=e.bucket,d=e.host,p=e.uploadPath,h=o.type,f="".concat(p.endsWith("/")?p:p+"/").concat(a),m="/".concat(u,"/").concat(f),v=(new Date).toUTCString(),y=function(e){for(var t=Object.keys(e).sort(),n="",i=0;i<t.length;i++){var r=t[i],o=e[r];n+="".concat(r.toLowerCase(),":").concat(o,"\n")}return n}(g={"x-oss-security-token":s,"x-oss-object-acl":l,"x-oss-date":v}),b=function(e){var t=e.params,n=e.path,i=[];if(t)for(var r=Object.keys(t).sort(),o=0;o<r.length;o++){var a=r[o],s=t[a];i.push("".concat(a,"=").concat(encodeURIComponent(s)))}return n+(i.length>0?"?".concat(i.join("&")):"")}({path:m}),E=h,x="PUT\n".concat("","\n").concat(E,"\n").concat(v,"\n").concat(y).concat(b),w=NU.stringify(Pq(x,r)),C="".concat(c," ").concat(t,":").concat(w),S=exports.E({authorization:C,"Content-Type":E},g),k=new Ks,_="https://".concat(d,"/").concat(f),[4,Z(o)];case 1:for(P in T=N.sent(),(I=new XMLHttpRequest).open("PUT",_),S)I.setRequestHeader(P,S[P]);return I.onloadend=function(){200==I.status?k.done({code:0,obj:{url:_,path:f}}):k.fail("upload file to oss failed: ".concat(I.status))},n&&I.upload.addEventListener("progress",(function(e){var t=o.size;if(e.loaded<=t){var i=Math.round(e.loaded/t*100);n(i)}e.loaded==e.total&&n(100)})),null==i||i.then((function(){I.abort()})),I.send(T),[2,k.result]}}))}))}var Mq,Aq,Dq,Rq=function(){function e(e,t){this.webSocketHandler=e,this.upime=t,this.fileTokenRequest=null,this.fileToken=null,this.fileInfoService=new wd,this.ossTokenRequestBuffer=new Map,this.ossTokenBuffer=new Map}return e.prototype.getOssToken=function(e){var t=this,n=this.ossTokenBuffer.get(e);if(n&&Date.now()<n.expire-3e5)return Promise.resolve(n);var i=this.ossTokenRequestBuffer.get(e);return i||(i=this.webSocketHandler.sendRequest(1,e).then((function(n){var i=n[0],r=i.host,o=i.bucket,a=i.region,s=i.domain;return r||(i.host="".concat(o,".").concat(a,".").concat(null!=s?s:"aliyuncs.com")),t.ossTokenBuffer.set(e,i),i})).finally((function(){t.ossTokenRequestBuffer.delete(e)}))),this.ossTokenRequestBuffer.set(e,i),i},e.prototype.upload2OssBySdk=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y;return D(this,(function(b){switch(b.label){case 0:return[4,this.getOssToken(t)];case 1:return i=b.sent(),r=i.accessKeyId,o=i.accessKeySecret,a=i.stsToken,s=i.bucket,l=i.host,c=i.region,u=i.uploadPath,d=e.fakeName,p=e.file,h="/".concat(u.endsWith("/")?u:u+"/").concat(d),[4,A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return _q?[2,_q]:[4,import("ali-oss")];case 1:return[2,_q=e.sent().default]}}))}))];case 2:return f=b.sent(),m=new f({region:c,accessKeyId:r,accessKeySecret:o,stsToken:a,bucket:s,secure:!0,endpoint:l,cname:!0}),g={progress:function(e,t,i){null==n||n(Math.floor(100*e))},parallel:4,partSize:10485760,headers:v={"x-oss-object-acl":"public-read"},mime:p.type},p.size<104857600?[4,m.put(h,p,{headers:v})]:[3,4];case 3:return y=b.sent(),[3,6];case 4:return[4,m.multipartUpload(h,p,g)];case 5:y=b.sent(),b.label=6;case 6:return[2,y]}}))}))},e.prototype.uploadImageByUrl=function(e,t,n,i){this.webSocketHandler.sendControlCmd([23,n,i,t,e])},e.prototype.uploadDocByUrl=function(e,t,n,i,r){this.webSocketHandler.sendControlCmd([24,i,r,t,e,n])},e.prototype.uploadVideoByUrl=function(e,t,n,i){this.webSocketHandler.sendControlCmd([25,n,i,t,e])},e.prototype.uploadAudioByUrl=function(e,t,n,i){this.webSocketHandler.sendControlCmd([26,n,i,t,e])},e.prototype.uploadToOss=function(e,t){return void 0===t&&(t=1),A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.getOssToken(t)];case 1:return[4,Nq(i.sent(),{uploadFile:e})];case 2:return 0===(n=i.sent()).code?[2,n.obj]:[3,4];case 3:throw i.sent();case 4:return[2]}}))}))},e.prototype.getMinioPresignedUrl=function(e,t){return void 0===t&&(t=1),A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.webSocketHandler.sendRequest(1e3,t,e)];case 1:return[2,n.sent()[0]]}}))}))},e.prototype.saveFileInfo=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c;return D(this,(function(u){switch(u.label){case 0:return[4,this.getFileToken()];case 1:return i=u.sent(),r=i.host,o=i.query,a=t.file,s=t.ext,l=t.fileType,[4,qu({appId:e,fileType:null!=l?l:s,fileSize:a.size,fileName:a.name,ossPath:n},{host:r,query:o}).result];case 2:if((c=u.sent()).code===Uu.OK)return[2,c.obj.id];throw new Error("no fileid")}}))}))},e.prototype.saveFile=function(e,t,n,i,r){return A(this,void 0,void 0,(function(){var r,o;return D(this,(function(a){switch(a.label){case 0:return a.trys.push([0,9,,10]),Ce!==de.PRIVATE?[3,5]:[4,this.getMinioPresignedUrl(n.fakeName,t)];case 1:return r=a.sent(),[4,fetch(r.uploadUrl,{method:"PUT",body:n.file})];case 2:return 200!==a.sent().status?[3,4]:[4,this.saveFileInfo(e,n,r.ossPath)];case 3:case 7:return[2,a.sent()];case 4:return[3,8];case 5:return[4,this.upload2OssBySdk(n,t,i)];case 6:return 200!==(o=a.sent()).res.status?[3,8]:[4,this.saveFileInfo(e,n,o.name)];case 8:return[3,10];case 9:throw a.sent();case 10:return[2,""]}}))}))},e.prototype.parsePpt=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return t=o.sent(),n=t.host,i=t.query,[4,Ku({fileId:e},{host:n,query:i}).result];case 2:return(r=o.sent()).code===Uu.OK?[2,r.obj]:[2,null]}}))}))},e.prototype.transcodeMedia=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return t=o.sent(),n=t.host,i=t.query,[4,Yu({fileId:e},{host:n,query:i}).result];case 2:return(r=o.sent()).code===Uu.OK?[2,r.obj]:[2,null]}}))}))},e.prototype.getTableDataByExcel=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getFileToken()];case 1:return t=o.sent(),n=t.host,i=t.query,[4,cd({ossPath:e},{host:n,query:i}).result];case 2:if((r=o.sent()).code===Uu.OK)return[2,r.obj];if(r.code===Uu.OVER_LIMIT)throw new Error(r.code+"");return[2,null]}}))}))},e.prototype.exportTable2Excel=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c;return D(this,(function(u){switch(u.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign("exportExcel")])];case 1:return n=u.sent(),i=n[0],r=n[1],o=i.host,a=i.query,[4,ud(exports.E({data:e,fileName:t},r),{host:o,query:a}).result];case 2:return(s=u.sent()).code===Uu.OK&&(l=s.obj.ossPath,(c=document.createElement("a")).href=l,c.target="_blank",c.click()),[2]}}))}))},e.prototype.exportFrame2Ppt=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u;return D(this,(function(d){switch(d.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign("exportPPT")])];case 1:return n=d.sent(),i=n[0],r=n[1],o=i.host,a=i.query,[4,dd(exports.E({data:e,fileName:t},r),{host:o,query:a}).result];case 2:if(s=d.sent(),(l=JSON.parse(s)).code!==Uu.OK)throw new Error("request failed: ".concat(l.code));return c=l.obj.ossPath,(u=document.createElement("a")).href=c,u.target="_blank",u.click(),[2]}}))}))},e.prototype.exportVotingResult2Excel=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign("exportVote")])];case 1:return e.sent(),[2]}}))}))},e.prototype.getFileToken=function(){var e=this,t=this.fileToken;if(t&&Date.now()<t.expire-3e5)return Promise.resolve(t);var n=this.fileTokenRequest;return n||(n=this.webSocketHandler.sendRequest(4).then((function(t){var n=t[0],i=n.host,r=N(n,["host"]),o=[];for(var a in r)o.push("".concat(a,"=").concat(r[a]));var s=o.join("&"),l=exports.E({host:i,query:s},r);return e.fileToken=l,l})).finally((function(){e.fileTokenRequest=null})),this.fileTokenRequest=n),n},e.prototype.downloadOssFile=function(e,t){return A(this,void 0,void 0,(function(){var n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return[4,this.getFileInfo(e)];case 1:return n=l.sent(),i=n.url,r=n.fileType,o=document.createElement("a"),[4,X(i)];case 2:return a=l.sent(),t=t.trim(),s=t.indexOf("."),o.href=window.URL.createObjectURL(a),o.download="".concat(-1===s?t:t.substring(0,s),".").concat(r),o.target="_blank",o.click(),[2]}}))}))},e.prototype.getFileInfo=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return[4,this.getFileToken()];case 1:return t=s.sent(),n=t.host,i=t.query,[4,this.fileInfoService.request({id:e},{host:n,query:i})];case 2:return r=s.sent(),[4,this.getOssToken(2)];case 3:return o=s.sent(),a="https://".concat(o.host,"/").concat(r.ossPath),Ce===de.PRIVATE?[2,exports.E({url:"".concat(o.host,"/").concat(o.bucket,"/").concat(r.ossPath)},r)]:[2,exports.E({url:a},r)]}}))}))},e.prototype.getDownloadSign=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.upime?[2,this.upime.getDownloadSign(e)]:[2,{}]}))}))},e.prototype.getFileDownloadUrl=function(e,t,n){return void 0===n&&(n=!1),A(this,void 0,void 0,(function(){var i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign(n?"imageDownload":"download")])];case 1:return i=l.sent(),r=i[0],o=i[1],a=r.host,s=r.query,[4,this.fileInfoService.requestFileUrl({id:e,fileName:t},{host:a,query:s},o)];case 2:return[2,l.sent()]}}))}))},e.prototype.getFilesZipDownloadUrl=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c;return D(this,(function(u){switch(u.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign("download")])];case 1:return i=u.sent(),r=i[0],o=i[1],a=r.host,s=r.query,[4,sd(exports.E({fileName:t,fileInfos:e,maxFileSize:n},o),{host:a,query:s}).result];case 2:if(l=u.sent(),(c=JSON.parse(l)).code!==Uu.OK)throw new Error("request failed: ".concat(c.code));return[2,c.obj]}}))}))},e.prototype.svgToPdf=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d;return D(this,(function(p){switch(p.label){case 0:return[4,Promise.all([this.getFileToken(),this.getDownloadSign("svg2pdf")])];case 1:for(i=p.sent(),r=i[0],o=i[1],a=r.host,s=r.query,(l=new FormData).append("totalPage",e.length+""),l.append("pageSizes",JSON.stringify(t)),c=0;c<e.length;c++)l.append("page".concat(c+1),e[c]);for(u in o)l.append(u,o[u]);return n&&Object.entries(n).forEach((function(e){var t=e[0],n=e[1];l.append(t,JSON.stringify(n))})),[4,Gu(l,{host:a,query:s}).result];case 2:if((d=p.sent()).code===Uu.OK)return[2,d.obj.pdfUrl];throw d.code}}))}))},e}(),Bq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.port=0,t}return P(t,e),t}(Ks),Lq=function(){function e(e){this.serverUpime=e,this.terminalId="",this.requestId=1,this.subServiceManager=new kp,this.requestMap=new Map,this.ackCallbacksMap=new Map,this.localSeq=1,this.localElementId=0,this.serverTimeDelta=0,this._connectId=""}return Object.defineProperty(e.prototype,"idPrefix",{get:function(){return this.terminalId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectId",{get:function(){return this._connectId},enumerable:!1,configurable:!0}),e.prototype.genLocalSeq=function(){return this.localSeq++},e.prototype.genID=function(e){return"".concat(e,"_").concat(this.idPrefix,"_").concat(this.localElementId++)},Object.defineProperty(e.prototype,"socketClient",{get:function(){return this.serverUpime.socketClient},enumerable:!1,configurable:!0}),e.prototype.getCurServerTime=function(){return new Date(Date.now()+this.serverTimeDelta).getTime()},e.prototype.sendControlCmd=function(e){var t;null===(t=this.socketClient)||void 0===t||t.sendControlCmd(e)},e.prototype.sendRCmd=function(e,t){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=this.requestId++;null===(n=this.socketClient)||void 0===n||n.sendRequestCmd(R([e,o,t],i,!0));var a=new Bq;return a.port=e,this.requestMap.set(o,a),a.result},e.prototype.sendSCmd=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];null===(t=this.socketClient)||void 0===t||t.sendServiceCmd(R([e],n,!0))},e.prototype.sendRequest=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.sendRCmd.apply(this,R([0,e],t,!1))},e.prototype.dealControlCmd=function(e){var t,n,i;return A(this,void 0,void 0,(function(){var r,o,a,s,l,c;return D(this,(function(u){switch(e[0]){case 1:r=e[3],o=e[4],this.terminalId||(this.terminalId=o),this._connectId=r,null===(n=(t=this.serverUpime).onWSLoggedIn)||void 0===n||n.call(t,{connectId:r});break;case 3:null===(i=this.socketClient)||void 0===i||i.forceReconnect();break;case 4:a=Date.now(),s=e[1],l=e[2],c=e[3],this.serverTimeDelta=c+(a-s-(c-l))/2-a|0}return[2]}))}))},e.prototype.genOtVersion=function(e){return"".concat(e,"_").concat(this.idPrefix)},e.prototype.dealDataCmd=function(e){var t=Rs(e);return this.dealServerAction(t),t},e.prototype.dealServerAction=function(e){"ack"===e.type&&this.dealAck(e)},e.prototype.dealAck=function(e){var t=e.seq,n=this.ackCallbacksMap.get(t);n&&(n.forEach((function(e){return e(t)})),this.ackCallbacksMap.delete(t))},e.prototype.dealResponseCmd=function(e){var t=e[0],n=e.slice(1),i=this.requestMap.get(t);i&&(i.done(n),this.requestMap.delete(t))},e.prototype.dealSubServiceCmd=function(e){this.subServiceManager.dealSCmd(e)},e.prototype.clearSubserviceRequest=function(e){var t=this;Array.from(this.requestMap).forEach((function(n){var i=n[0],r=n[1];r.port===e&&(r.fail("subservice closed"),t.requestMap.delete(i))}))},e.prototype.waitAck=function(e,t){var n=this.ackCallbacksMap.get(e);n||(n=[],this.ackCallbacksMap.set(e,n)),n.push(t)},e.prototype.unWaitAck=function(e,t){var n=this.ackCallbacksMap.get(e);n&&((n=n.filter((function(e){return e!==t}))).length?this.ackCallbacksMap.set(e,n):this.ackCallbacksMap.delete(e))},e.prototype.reset=function(){this.resetConnect(),this.resetElementData()},e.prototype.resetConnect=function(){this.requestMap.forEach((function(e){return e.fail("reset Data")})),this.requestMap.clear()},e.prototype.resetElementData=function(){this.ackCallbacksMap.clear()},e}(),Oq=function(){function e(e){this.upime=e,this.timers=new Map,this.followingOther=!1}return e.prototype.update=function(e){var t=this.timers.get(e.id);if(t)for(var n in e)t[n]=e[n];else this.timers.set(e.id,e)},e.prototype.getTimerById=function(e){return this.timers.get(e)},e.prototype.resetData=function(){this.followingOther&&this.timers.forEach((function(e){"timing"===e.status?e.status="pause":"timeout"===e.status&&(e.status="ready")}))},e.prototype.reserveFollowingStatus=function(){this.followingOther=!!this.upime.followManager.followingUser},e}(),Fq=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.loadingWork=new Ks,r.loaded=!1,r.status=0,r.pptDir="",r.pptPage=0,r.pptAction=0,r.steps=0,r.totalPages=0,r.canPrev=!1,r.canNext=!1,r.clickDivs=[],r.viewSize={width:0,height:0},r.dealMessage=function(e){return A(r,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c=this;return D(this,(function(u){if(e.source!==this.iframe.contentWindow||!e.data)return[2];switch((t=e.data).name){case"pptReady":this.status=1,this.playPpt();break;case"pptLoaded":i=t.state,this.status=3,this.onPptLoad(i),this.dispatchClick(0,0),this.dealPptStateChange(exports.E(exports.E({},i),{active:!1})),this.tempTriggerId&&(n=this.tempTriggerId,setTimeout((function(){c.clickTrigger(n,!1)}),200),delete this.tempTriggerId),this.loadingWork.done();break;case"pptAction":i=t.state,this.dealPptStateChange(i);break;case"reportInteractData":r=t.clickDivs,o=t.viewSize,this.clickDivs=r,this.viewSize=o;break;case"triggerPlaying":1===(a=t.trigger).actionType?null===(s=this.onTriggerClick)||void 0===s||s.call(this,a.actionValue):2===a.actionType&&(null===(l=this.onMediaClick)||void 0===l||l.call(this,a.actionId,a.mediaUrl))}return[2]}))}))},r.prev=function(){r.pptPage<=0&&r.pptAction<=0||r.sendMesg("prev")},r.next=function(){r.pptPage>=r.totalPages-1&&r.pptAction>=r.steps||r.sendMesg("next")},window.addEventListener("message",r.dealMessage),r}return P(t,e),t.prototype.playPpt=function(){this.pptDir&&1===this.status&&(this.status=2,this.sendMesg("playFile",{fileInfo:this.pptDir,startPage:this.pptPage,startStep:this.pptAction}))},t.prototype.onPptLoad=function(e){this.totalPages=e.totalPages,this.iframe.blur()},t.prototype.dealPptStateChange=function(e){var t,n=e.page,i=e.action,r=e.totalPages,o=e.steps;this.pptPage=n,this.pptAction=i,this.steps=o,this.canPrev=n>0||i>0,this.canNext=n<r-1||i<o,null===(t=this.onPptStateChange)||void 0===t||t.call(this,e)},t.prototype.openFile=function(e,t,n){this.pptDir=e,void 0!==t&&void 0!==n&&(this.pptPage=t,this.pptAction=n),this.playPpt()},t.prototype.setPageStep=function(e,t,n){void 0===n&&(n=!0),this.pptPage=e,this.pptAction=t,this.sendMesg("seek",{page:e,action:t,active:n})},t.prototype.refreshInteractData=function(){this.sendMesg("refreshInteractData")},t.prototype.clickTrigger=function(e,t){void 0===t&&(t=!1),this.status<3?this.tempTriggerId=e:this.sendMesg("playTrigger",{triggerId:e,active:t})},t.prototype.dispatchClick=function(e,t){this.iframe.click(),this.sendMesg("dispatchClick",{x:e,y:t})},t.prototype.sendMesg=function(e,t){var n;return A(this,void 0,void 0,(function(){return D(this,(function(i){return this.status<1||null===(n=this.iframe.contentWindow)||void 0===n||n.postMessage({name:e,value:t},"*"),[2]}))}))},t}(wq),zq=function(e){function t(t){var n=e.call(this,t)||this;return n.pptPlayerAddr="https://board-infi.oss-cn-hangzhou.aliyuncs.com/infinite_wb/web/ppt/index.html",n.ppts=[],n}return P(t,e),t.prototype.getPptPlayers=function(){return this.ppts},t.prototype.requestPreview=function(e){var t=this.ppts;if(!t.includes(e)){t.push(e),t.length>1&&t.shift().doStopPreview();var n={width:Qe.width,height:Qe.height},i=e.size;n.width=n.height*i.width/i.height;var r=new Fq(this.upime,this.pptPlayerAddr+"?static=1",n);e.doStartPreview(r)}},t.prototype.cancelPreview=function(e){this.ppts=this.ppts.filter((function(t){return t!==e})),e.doStopPreview()},t.prototype.finishAll=function(){this.ppts.forEach((function(e){return e.doStopPreview()})),this.ppts=[]},t.prototype.destroy=function(){this.finishAll()},t}(zd);!function(e){e[e.CARD=1]="CARD"}(Mq||(Mq={})),function(e){e[e.BASE_VERSION=0]="BASE_VERSION",e[e.CARDS=1]="CARDS",e[e.ACK=2]="ACK"}(Aq||(Aq={})),function(e){e[e.KANBAN=1]="KANBAN",e[e.CARD=0]="CARD"}(Dq||(Dq={}));var Hq,Uq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){return e},t}(Sp),Wq=function(){function e(e,t){this.upime=e,this.redoUndo=t,this.relativeElements=[],this.updateGroup=[],this.relativeKanbanIds=new Set}return e.prototype.onRelease=function(){this.upime.kanbanManager.updateRedoUndo(this)},e.prototype.getRevertOperation=function(){var t=new e(this.upime,"redo"===this.redoUndo?"undo":"redo");return"undo"===this.redoUndo?this.upime.kanbanManager.undo(this,t):this.upime.kanbanManager.redo(this,t),t},e}(),Vq=function(e,t){return t.forEach((function(t){e[t]&&"string"==typeof e[t]&&(e[t]=e[t]+"_sd")})),e},jq=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.upime=t,i.config=n;var r=t;return i.websocketHelper=new Lq({socketClient:i}),i.kanbanManager=new Gq(r,i),i.followManager=new sq(r,i),i}return P(t,e),t.prototype.dealDataCmd=function(e){var t=this.websocketHelper.dealDataCmd(e),n=this.upime,i=function(e,t){Vq(t,["frameId","groupId","frozedGroupId"]);var n=t.position;if((null==n?void 0:n.parentType)&&Vq(n,["parentId"]),e===Za.CONNECTIONLINE&&Vq(t,["startElementId","endElementId"]),e===Za.MINDMAP_LINE&&Vq(t,["startElementId","endElementId"]),e===Za.CARD&&Vq(t,["kanbanId"]),e===Za.KANBAN){var i=t;i.cards&&(i.cards=i.cards.map((function(e){return e+"_sd"})))}},r=function(e){var t=e.data,n=e.elementType;return Vq(e,["id"]),i(n,t),e};switch(t.type){case"keyFrame":t.actions.forEach((function(e){n.dealCreatedAction(r(e))}));break;case"ack":break;case"created":n.dealCreatedAction(r(t));break;case"updated":t.updates.forEach((function(e){var t=e.update,n=e.elementType;Vq(e,["id"]),i(n,t)})),n.dealUpdatedAction(t);break;case"locked":Vq(t,["lockId"]),t.ids=t.ids.map((function(e){return"".concat(e).concat("_sd")})),n.dealServerLock(t);break;case"unlocked":Vq(t,["lockId"]),n.dealServerUnlock(t)}},t.prototype.dealMessage=function(e){var t=e.data;this.config.crypto&&(t=this.config.crypto.decrypt(t)),this.resetRecvHBTimer();var n=t.charAt(0);if("["===n)return this.dealDataCmd(JSON.parse(t));t=t.substring(1);var i=JSON.parse(t);switch(n){case"c":12===i[0]?2===i[1]||this.sendHeartbeat(i):3===i[0]&&this.forceReconnect();break;case"s":this.websocketHelper.subServiceManager.dealSCmd(i)}},t.prototype.requestUserViewOnce=function(e){return this.followManager.requestUserViewOnce(e)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.followManager.destroy()},t}(Bd),Gq=function(){function e(e,t){var n=this;this.upime=e,this.sdSocketClient=t,this.ready=!1,this.baseVersion=0,this.waitingActionList=[],this.localActionList=[],this.operationActionList=[],this.operationActionBin=[],this.ghostCards=new Set,this.kanbanServiceHandler=function(e){var t,i=e[0],r=e[1];if(i===Aq.ACK)n.baseVersion++;else{if(i!==Aq.BASE_VERSION&&n.baseVersion+1!==r&&!n.upime.isSyncing)return void(null===(t=n.socketClient)||void 0===t||t.forceReconnect());n.baseVersion=r}switch(i){case Aq.ACK:n.ready&&n.sendAction();break;case Aq.CARDS:var o=e[2];n.ready&&(n.dealShadowConnectionCase(o),n.dealServerActions(o));break;case Aq.BASE_VERSION:n.ready=!0}},this.currentOp=null,this.showingHideByFilter=!1,this.kanbanSubService=new Uq(e,10,this.kanbanServiceHandler,t),this.kanbanSubService.open()}return Object.defineProperty(e.prototype,"socketClient",{get:function(){var e;return null!==(e=this.sdSocketClient)&&void 0!==e?e:this.upime.socketClient},enumerable:!1,configurable:!0}),e.prototype.addGhostCard=function(e){this.ghostCards.add(e)},e.prototype.removeGhostCard=function(e){this.ghostCards.delete(e)},e.prototype.getAllGhostCards=function(){return Array.from(this.ghostCards)},e.prototype.dealShadowConnectionCase=function(e){this.sdSocketClient&&e.forEach((function(e){if(Vq(e,["id"]),e.otType===Dq.KANBAN){var t=e.update;Vq(t,["id"]),t.cards&&(t.cards=t.cards.map((function(e){return e.endsWith("_sd")?e:e+"_sd"})))}if(e.otType===Dq.CARD){var n=e.targetAttr,i=e.targetPosition,r=e.originPosition;n&&(Vq(n,["kanbanId","frameId","groupId","frozedGroupId"]),Vq(n,["id"])),i&&Vq(i,["kanbanId"]),r&&Vq(r,["kanbanId"])}}))},e.prototype.sendAction=function(){var e=this;if(this.waitingActionList=[],this.localActionList.length){var t=this.localActionList.filter((function(e){return e.otType===Dq.KANBAN||!e._depose})),n=t.map((function(t){if(t.otType===Dq.KANBAN)return{otType:Dq.KANBAN,id:t.id,update:t.update};var n={otType:Dq.CARD,id:t.id,originPosition:t.originPosition,targetPosition:t.targetPosition,targetAttr:t.targetAttr};if(!e.upime.kanbanConfig.silentAddUser&&!t._noReportNewUser){var i=e.findUsers(t._dataSnapshot),r=e.findUsers(t.targetAttr).filter((function(e){return!i.includes(e)}));r.length&&(n.newUsers=r)}return n}));this.ready&&!this.upime.isSyncing&&this.kanbanSubService.sendSCmd(Mq.CARD,this.baseVersion,n),this.waitingActionList=R([],t,!0),this.localActionList=[]}},e.prototype.onCardChange=function(e){var t;(t=this.localActionList).push.apply(t,e),0===this.waitingActionList.length&&this.sendAction()},e.prototype.dealServerActions=function(e){var t=this;e.forEach((function(e){var n=e.info;if(n&&t.upime.addElementInfo(e.id,n),e.otType===Dq.KANBAN)return t.waitingActionList.forEach((function(n){t.mergeTwoActionKanban(n,e)})),t.localActionList.forEach((function(n){t.mergeTwoActionKanban(n,e)})),void(e.update.deleted&&t.rollback(e.id));t.waitingActionList.forEach((function(n){t.transformEachother(n,e)})),t.localActionList.forEach((function(n){t.transformEachother(n,e)}));var i=_t.cloneDeep(e);t.operationActionList.forEach((function(e){t.transformEachother(e,i)}));var r=_t.cloneDeep(e);t.operationActionBin.forEach((function(e){t.transformEachother(e,r)}))})),e.forEach((function(e){return t.dealAction(e,!0)})),this.upime.updateView()},e.prototype.transformEachother=function(e,t){e.otType!==Dq.KANBAN&&t.otType!==Dq.KANBAN&&(this.mergeTwoActionCards(e,t),this.doTransform(e,t))},e.prototype.doTransform=function(e,t){if(t.targetPosition&&e.targetPosition){if(e.id===t.id)return e.originPosition=_t.cloneDeep(t.targetPosition),void(t.targetPosition=void 0);e.originPosition.kanbanId===t.originPosition.kanbanId&&(e.originPosition.index>t.originPosition.index?e.originPosition.index-=1:e.originPosition.index<t.originPosition.index&&(t.originPosition.index-=1)),e.originPosition.kanbanId===t.targetPosition.kanbanId&&(e.originPosition.index>=t.targetPosition.index?e.originPosition.index+=1:t.targetPosition.index-=1),e.targetPosition.kanbanId===t.originPosition.kanbanId&&(e.targetPosition.index>t.originPosition.index?e.targetPosition.index-=1:t.originPosition.index+=1),e.targetPosition.kanbanId===t.targetPosition.kanbanId&&(e.targetPosition.index>=t.targetPosition.index?e.targetPosition.index+=1:t.targetPosition.index+=1)}},e.prototype.mergeTwoActionCards=function(e,t){if(e.otType!==Dq.KANBAN&&t.otType!==Dq.KANBAN&&e.id===t.id){var n=e.targetAttr,i=t.targetAttr;n&&i&&(Object.keys(n).forEach((function(e){i[e]=n[e]})),i.deleted&&(e._depose=!0))}},e.prototype.mergeTwoActionKanban=function(e,t){e.otType===Dq.KANBAN&&t.otType===Dq.KANBAN&&e.id===t.id&&Object.keys(e.update).forEach((function(n){t.update[n]=e.update[n]}))},e.prototype.createCard=function(e,t){this.upime.followManager.stopFollowCurrent();var n={otType:Dq.CARD,id:e.id,targetAttr:e,originPosition:{kanbanId:null,index:0},targetPosition:t,_dataSnapshot:{deleted:!0}};this.onCardChange([n]),this.dealAction(n,!1),this.createOp(n);var i=this.upime.elementManager.getElementById(n.id);return i.isHideByFilter&&this.tellIsHideByFilter(),i},e.prototype.restoreCard=function(e,t){var n={otType:Dq.CARD,id:e.id,targetAttr:e,originPosition:t,_dataSnapshot:{deleted:!0},_noReportNewUser:!0};return this.onCardChange([n]),this.dealAction(n,!1),this.createOp(n),this.upime.elementManager.getElementById(n.id)},e.prototype.deleteCard=function(e,t){var n={otType:Dq.CARD,id:e,targetAttr:{deleted:!0},originPosition:t,targetPosition:{kanbanId:null,index:0},_dataSnapshot:{deleted:!1}};this.createOp(n),this.onCardChange([n]),this.dealAction(n,!1)},e.prototype.updateCard=function(e,t,n,i){var r={otType:Dq.CARD,id:e,targetAttr:t,originPosition:n,targetPosition:i,_dataSnapshot:this.getCardSnapshot(e,t)};this.createOp(r),this.onCardChange([r]),this.dealAction(r,!1),this.upime.updateElementInfo(e,{updateTime:+new Date/1e3,editor:this.upime.localUserInfo.loginName})},e.prototype.createKanban=function(e){var t={otType:Dq.KANBAN,id:e.id,update:e,_dataSnapshot:{deleted:!0}};return this.onCardChange([t]),this.dealAction(t,!1),this.createOp(t),this.upime.elementManager.getElementById(e.id)},e.prototype.updateKanban=function(e,t){var n={otType:Dq.KANBAN,id:e.id,update:t,_dataSnapshot:this.getKanbanSnapshot(e,t)};this.onCardChange([n]),this.dealAction(n,!1),this.createOp(n)},e.prototype.getCurrentOp=function(){var e=this;return this.currentOp||(this.currentOp=new Wq(this.upime,"undo"),fr((function(){e.currentOp=null}))),this.currentOp},e.prototype.createOp=function(e){var t,n,i=this.getCurrentOp();if(e.otType!==Dq.KANBAN){var r=e.originPosition.kanbanId||(null===(t=e.targetPosition)||void 0===t?void 0:t.kanbanId);if(!r)return;if(!this.upime.elementManager.getElementById(r))return;e.originPosition.kanbanId&&i.relativeKanbanIds.add(e.originPosition.kanbanId),(null===(n=e.targetPosition)||void 0===n?void 0:n.kanbanId)&&i.relativeKanbanIds.add(e.targetPosition.kanbanId),this.upime.opManager.hasOp(i)||this.upime.opManager.insertAnyOperation(i),this.operationActionList.unshift(exports.E(exports.E({},this.getReverseAction(e,e.targetAttr)),{linkOp:i}))}else{if(!this.upime.elementManager.getElementById(e.id))return;i.relativeKanbanIds.add(e.id),this.upime.opManager.hasOp(i)||this.upime.opManager.insertAnyOperation(i),this.operationActionList.unshift(exports.E(exports.E({},this.getReverseAction(e,e.update)),{linkOp:i}))}},e.prototype.dealAction=function(e,t){e.otType!==Dq.KANBAN?(void 0===this.upime.elementManager.getElementById(e.id)?this.dealCreateCard(e):this.dealUpdateCard(e),this.dealIndex(e)):void 0===this.upime.elementManager.getElementById(e.id)?this.dealCreateKanban(e,t):this.dealUpdateKanban(e)},e.prototype.dealCreateCard=function(e){var t={type:"created",info:{addTime:Date.now()/1e3,creator:this.upime.localUserInfo.loginName,editor:"",updateTime:0},elementType:Za.CARD,id:e.id,data:e.targetAttr,serverVersion:this.upime.serverVersion};this.upime.dealCreatedAction(t)},e.prototype.dealUpdateCard=function(e){var t;if(e.targetAttr){var n=this.upime.elementManager.getElementById(e.id);if(n){var i=[],r=null===(t=n.pareantKanban)||void 0===t?void 0:t.id;if(n.pareantKanban&&n.pareantKanban.grids.forEach((function(e,t){var r=e.cards.findIndex((function(e){return e.id===n.id}));r>-1&&i.push([t,r])})),this.upime.elementManager.updateElement(n,e.targetAttr),this.upime.publish("elementsUpdated",[{element:n,update:e.targetAttr}]),n.pareantKanban){var o=n.pareantKanban,a=function(){var e;if(o===n.pareantKanban){var t=[];n.pareantKanban&&n.pareantKanban.grids.forEach((function(e,i){var r=e.cards.findIndex((function(e){return e.id===n.id}));r>-1&&t.push([i,r])})),r===(null===(e=n.pareantKanban)||void 0===e?void 0:e.id)&&(t=t.filter((function(e){return i.every((function(t){return t[0]!==e[0]||t[1]!==e[1]}))}))),t.forEach((function(e){var t;null===(t=n.pareantKanban)||void 0===t||t.animateCtrl.start({col:e[0],cardId:n.id})}))}};e.targetPosition?n.pareantKanban.onUpdateGroupCBOnceList.push(a):a()}}}},e.prototype.dealCreateKanban=function(e,t){var n={type:"created",info:{addTime:Date.now()/1e3,creator:this.upime.localUserInfo.loginName,editor:"",updateTime:0},elementType:Za.KANBAN,id:e.id,data:e.update,serverVersion:this.upime.serverVersion};if(this.upime.dealCreatedAction(n),!t){var i=this.upime.elementManager.getElementById(e.id),r=this.upime.findFrame(i);r&&this.updateKanban(i,{frameId:r.id})}},e.prototype.dealUpdateKanban=function(e){var t=this.upime.elementManager.getElementById(e.id);t&&(this.upime.elementManager.updateElement(t,e.update),this.upime.publish("elementsUpdated",[{element:t,update:e.update}]),e.update.deleted&&this.grepRedoUndo(e.id))},e.prototype.grepRedoUndo=function(e){var t=this.operationActionList.findIndex((function(t){return t.linkOp.relativeKanbanIds.has(e)})),n=this.operationActionBin.findIndex((function(t){return t.linkOp.relativeKanbanIds.has(e)})),i=R(R([],this.operationActionList.slice(t),!0),this.operationActionBin.slice(n),!0),r=new Set(i.map((function(e){return e.linkOp})));this.upime.opManager.grepOperationList((function(e){return!(e instanceof Wq&&r.has(e))}))},e.prototype.dealIndex=function(e){var t=[];if(e.originPosition.kanbanId){var n=this.upime.elementManager.getElementById(e.originPosition.kanbanId);n&&(e.targetPosition&&((i=R([],n.cards,!0)).splice(e.originPosition.index,1),n.updateCards(i)),t.push(n))}if(e.targetPosition){if(e.targetPosition.kanbanId){var i,r=this.upime.elementManager.getElementById(e.targetPosition.kanbanId);r&&((i=R([],r.cards,!0)).splice(e.targetPosition.index,0,e.id),r.updateCards(i),t.push(r))}t.forEach((function(e){return e.updateGroup()}))}},e.prototype.undo=function(e,t){var n=this,i=this.operationActionList.filter((function(t){return t.linkOp===e}));i.forEach((function(e){var i=e.otType===Dq.KANBAN?n.getReverseAction(e,e.update):n.getReverseAction(e,e.targetAttr);n.operationActionBin.unshift(exports.E(exports.E({},i),{linkOp:t}))})),this.onCardChange(i),i.forEach((function(e){n.dealAction(e,!1)})),this.upime.updateView()},e.prototype.redo=function(e,t){var n=this,i=this.operationActionBin.filter((function(t){return t.linkOp===e}));i.forEach((function(e){var i=e.otType===Dq.KANBAN?n.getReverseAction(e,e.update):n.getReverseAction(e,e.targetAttr);n.operationActionList.unshift(exports.E(exports.E({},i),{linkOp:t}))})),this.onCardChange(i),i.forEach((function(e){n.dealAction(e,!1)})),this.upime.updateView()},e.prototype.getCardSnapshot=function(e,t){var n=this.upime.elementManager.getElementById(e);if(!n)return{};var i={};return Object.keys(t).forEach((function(e){i[e]=_t.cloneDeep(n[e])})),i},e.prototype.getKanbanSnapshot=function(e,t){var n={};return Object.keys(t).forEach((function(t){n[t]=_t.cloneDeep(e[t])})),n},e.prototype.getReverseAction=function(e,t){var n;if(e.otType!==Dq.KANBAN){var i=e.targetPosition?_t.cloneDeep(e.originPosition):void 0,r=e.targetPosition?_t.cloneDeep(e.targetPosition):_t.cloneDeep(e.originPosition),o=e._dataSnapshot;if(!o)return;var a={};t&&Object.keys(t).forEach((function(e){"deleted"!==e&&o.hasOwnProperty(e)&&(a[e]=_t.cloneDeep(o[e]))})),null===e.originPosition.kanbanId&&(a.deleted=!0),null===(null===(n=e.targetPosition)||void 0===n?void 0:n.kanbanId)&&(a.deleted=!1);var s={otType:Dq.CARD,id:e.id,originPosition:r,targetPosition:i,_dataSnapshot:t?_t.cloneDeep(t):{}};return Object.keys(a).length&&(s.targetAttr=a),s}var l=e.update,c=e._dataSnapshot;if(c){var u={};return t&&Object.keys(t).forEach((function(e){"deleted"===e?u.deleted=!l.deleted:c.hasOwnProperty(e)&&(u[e]=_t.cloneDeep(c[e]))})),{otType:Dq.KANBAN,id:e.id,update:u,_dataSnapshot:t?_t.cloneDeep(t):{}}}},e.prototype.updateRedoUndo=function(e){this.operationActionList=this.operationActionList.filter((function(t){return t.linkOp!==e})),this.operationActionBin=this.operationActionBin.filter((function(t){return t.linkOp!==e}))},e.prototype.rollback=function(e){var t=this;return this.checkActionListRelationToKanban(this.waitingActionList,e)?(R(R([],this.waitingActionList,!0),this.localActionList,!0).reverse().forEach((function(e){var n=e.otType===Dq.KANBAN?t.getReverseAction(e,e.update):t.getReverseAction(e,e.targetAttr);t.dealAction(n,!1)})),this.localActionList=[],this.waitingActionList=[],void this.clearRedoUndo()):this.checkActionListRelationToKanban(this.localActionList,e)?(this.localActionList.reverse().forEach((function(e){var n=e.otType===Dq.KANBAN?t.getReverseAction(e,e.update):t.getReverseAction(e,e.targetAttr);t.dealAction(n,!1)})),this.localActionList=[],void this.clearRedoUndo()):void 0},e.prototype.clearRedoUndo=function(){this.upime.opManager.grepOperationList((function(t){return t instanceof e}))},e.prototype.checkActionListRelationToKanban=function(e,t){return e.some((function(e){var n;return e.otType!==Dq.KANBAN&&(e.originPosition.kanbanId===t||(null===(n=e.targetPosition)||void 0===n?void 0:n.kanbanId)===t)}))},e.prototype.findUsers=function(e){var t,n=new Set;return null===(t=null==e?void 0:e.values)||void 0===t||t.forEach((function(e){e.type===gB.userList&&e.value.forEach((function(e){return n.add(e)}))})),Array.from(n)},e.prototype.tellIsHideByFilter=function(){var e=this;this.showingHideByFilter||(this.showingHideByFilter=!0,this.upime.addToast(O("kanban.hide.tip"),{removedCB:function(){}}),fr((function(){e.showingHideByFilter=!1})))},e.prototype.beforeIncrementalUpdate=function(e){},e.prototype.afterIncrementalUpdate=function(){this.localActionList=R(R([],this.waitingActionList,!0),this.localActionList,!0),this.sendAction()},e}(),qq=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=2989040,t}return P(t,e),t.prototype.setColor=function(e){this.color=e},t.prototype.destroy=function(){},t}(zd),Kq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){return e},t.prototype.sendSCmd=function(t){e.prototype.sendSCmd.apply(this,R([t[0]],t.slice(1),!1))},t.prototype.sendRCmd=function(t){return e.prototype.sendRCmd.apply(this,R([t[0]],t.slice(1),!1))},t}(Sp),Yq=function(){function e(e,t,n){this.upime=e,this.shareId=t,this.onDestory=n,this.type="assistant",this.shareGroupList=[],this.shareServiceHandler=this.shareServiceHandler.bind(this),this.shareSubService=new Kq(e,14,this.shareServiceHandler),this.shareSubService.open(),this.subscribe()}return e.prototype.subscribe=function(){var e=this;this.unsubscribe=this.upime.subscribe("endFollowOther",(function(t){e.sharer&&t.loginName!==e.sharer.userId&&e.followSharer(!0)}))},e.prototype.shareServiceHandler=function(e){switch(e[0]){case 1:var t=e[2];this.shareGroupList.every((function(e){return e.userId!==t.userId}))&&(this.shareGroupList.push(t),1===t.role&&this.followAll());break;case 2:var n=e[2];this.shareGroupList=this.shareGroupList.filter((function(e){return e.userId!==n}));break;case 4:var i=e[2],r=this.shareGroupList.findIndex((function(e){return e.userId===i.userId}));r>=0&&(this.shareGroupList[r]=i),this.followAll();break;case 3:this.destory()}},e.prototype.join=function(){var e=this,t=[1,this.shareId,2];this.shareSubService.sendRCmd(t).then((function(t){var n=t,i=0===n[n.length-2],r=n[n.length-1];i?(e.shareGroupList=r,e.followAll()):e.destory()}))},e.prototype.leave=function(){var e=[2,this.shareId];this.shareSubService.sendSCmd(e)},Object.defineProperty(e.prototype,"sharer",{get:function(){return this.shareGroupList.find((function(e){return 1===e.role}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followMeetingId",{get:function(){var e;return null===(e=this.sharer)||void 0===e?void 0:e.meeting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentMeetingId",{get:function(){var e;return this.upime.meetingMode?null===(e=this.upime.meetingManager.meetingChannel)||void 0===e?void 0:e.meetingData.id:void 0},enumerable:!1,configurable:!0}),e.prototype.destory=function(){var e;null===(e=this.unsubscribe)||void 0===e||e.call(this),this.shareSubService.close(),this.onDestory()},e.prototype.followAll=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,this.followMeeting()];case 1:return e.sent(),this.followSharer(),[2]}}))}))},e.prototype.followSharer=function(e){if(!this.currentMeetingId){var t=this.sharer,n=(null==t?void 0:t.follow)||(null==t?void 0:t.userId);if(n!==this.upime.localUserInfo.loginName&&n&&this.upime.userManager.hasUser(n)){var i=this.upime.userManager.getUser(n),r=i.loginName===(null==t?void 0:t.userId)?null==t?void 0:t.connId:void 0,o=n===(null==t?void 0:t.userId);this.upime.followManager.startFollowOther(i,{connId:r,isStricky:o,isSilent:e})}}},e.prototype.followMeeting=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this.currentMeetingId||!this.followMeetingId?[3,2]:[4,this.joinMetting(this.followMeetingId)];case 1:case 3:return e.sent(),[2];case 2:return!this.currentMeetingId||this.followMeetingId?[3,4]:[4,this.leaveMetting()];case 4:return[2]}}))}))},e.prototype.joinMetting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return(t=this.upime.meetingManager.meetingConfigs.preCheckMeetingAccessibility)?[4,t(void 0,e)]:[3,2];case 1:if(!n.sent())return[2];n.label=2;case 2:return this.upime.clearRightSlidePanelGuard(),this.upime.meetingManager.ignoreMeetingHint(e),[2,this.upime.meetingManager.joinMeeting(e)]}}))}))},e.prototype.leaveMetting=function(){var e;return null===(e=this.upime.meetingManager.meetingChannel)||void 0===e?void 0:e.leaveMeeting()},e}(),Xq=function(){function e(e,t,n){this.upime=e,this.shareId=t,this.onDestory=n,this.type="sharer",this.shareGroupList=[],this.shareServiceHandler=this.shareServiceHandler.bind(this),this.shareSubService=new Kq(e,14,this.shareServiceHandler),this.shareSubService.open()}return e.prototype.shareServiceHandler=function(e){switch(e[0]){case 1:var t=e[2];this.shareGroupList.every((function(e){return e.userId!==t.userId}))&&this.shareGroupList.push(t);break;case 2:var n=e[2];this.shareGroupList=this.shareGroupList.filter((function(e){return e.userId!==n}));break;case 3:this.destory()}},e.prototype.destory=function(){this.shareSubService.close(),this.onDestory()},e.prototype.join=function(){var e=this,t=[1,this.shareId,1];this.shareSubService.sendRCmd(t).then((function(t){var n=t,i=0===n[n.length-2],r=n[n.length-1];i?e.shareGroupList=r:e.destory()}))},e.prototype.stopShare=function(){var e=[3,this.shareId];this.shareSubService.sendSCmd(e),this.destory()},e}(),Qq=function(){function e(e,t){this.upime=e,this.mainScene=t,this.scenes=[],this.scenes.push(t),t.manager=this,this.activedScene=t,this.unsubUserEvent=this.subscrieUserEvt()}return e.prototype.subscrieUserEvt=function(){var e=this,t=[this.upime.userEventManager.subscribe("moveto",(function(t){var n,i;null===(i=(n=e.activedScene).onMoveToEvt)||void 0===i||i.call(n,t)})),this.upime.userEventManager.subscribe("mousemove",(function(t){var n,i;null===(i=(n=e.activedScene).onMoveEvt)||void 0===i||i.call(n,t)})),this.upime.userEventManager.subscribe("click",(function(t){var n,i;null===(i=(n=e.activedScene).onClickEvt)||void 0===i||i.call(n,t)}))];return function(){t.forEach((function(e){return e()}))}},e.prototype._removeScene=function(e){this.scenes=this.scenes.filter((function(t){return t!==e})),e.manager=void 0},e.prototype.addScene=function(e){this.scenes.includes(e)||(this.scenes.push(e),e.manager=this,e.sceneAdd());var t=this.activedScene;t!==e&&(!t.onlyActive||e.onlyActive)&&(this.activedScene=e,t.sceneInactive(),t.onlyActive&&(this._removeScene(t),t.SceneRemove()),e.sceneActive())},e.prototype.removeScene=function(e){if(e!==this.mainScene&&this.scenes.includes(e)){this._removeScene(e);var t=!1;if(e===this.activedScene){for(var n=this.scenes.length-1;n>=0;n--)if(this.scenes[n]!==e){this.activedScene=this.scenes[n],t=!0;break}e.sceneInactive()}e.SceneRemove(),t&&this.activedScene.sceneActive()}},e.prototype.setActiveScene=function(e){if(e!==this.activedScene&&this.scenes.includes(e)){var t=this.activedScene;this.activedScene=e,t.sceneInactive(),t.onlyActive&&(this._removeScene(e),t.SceneRemove()),e.sceneActive()}},e.prototype.destroy=function(){this.unsubUserEvent()},e}();!function(e){e[e.View=1]="View",e[e.Comment=2]="Comment",e[e.Edit=3]="Edit"}(Hq||(Hq={}));var Zq,Jq=function(){function e(e){this.upime=e,this.perms=[]}return Object.defineProperty(e.prototype,"editable",{get:function(){var e;return(null===(e=this.curPerm())||void 0===e?void 0:e.perm)===Hq.Edit},enumerable:!1,configurable:!0}),e.prototype.curPerm=function(){return 0===this.perms.length?null:this.perms[this.perms.length-1]},e.prototype.addPerm=function(e){this.perms=R(R([],this.perms,!0),[e],!1)},e.prototype.changePerm=function(e){var t=this.perms.find((function(t){return t.pluginId===e.pluginId}));t&&(t.perm=e.perm,this.perms=R([],this.perms,!0))},e.prototype.removePerm=function(e){this.perms=this.perms.filter((function(t){return t.pluginId!==e}))},e}(),$q=function(){function e(e){var t,n,i,r,o,a,s=this;this.linkSpan=document.createElement("span"),this.useKeyboard=!0,this.isDesktopModal=!1,this.online=!1,this.prexmode="hand",this.xmode="hand",this.xmodeLocked=!1,this.editable=!1,this.viewLocked=!1,this.viewLockedHintMsg=null,this.shapeType=Ka.RECT,this.view=new Tu(this),this.eventManager=new ro,this.userEventManager=new Fd(this.view),this.uiController=new Tc(this),this.mainScene=new IG(this,"main"),this.sceneManager=new Qq(this,this.mainScene),this.elementManager=new OU(this),this.timerManager=new Oq(this),this.framesListManager=new jM(this),this.templateManager=new WG(this),this.lineDrawer=new wx(this),this.selectController=new FU(this),this.stickerCtrl=new jU(this),this.connectionLineCtrl=new gx(this),this.shapeDrawer=new ix(this),this.textController=new zU(this),this.copyPasteCtrl=new LH(this),this.viewCtrl=new Gd(this),this.uploadControl=new WU(this),this.exportingPdf=!1,this.leftSideBarType=null,this.asyncUpdates=[],this.opManager=new QU(this),this.localLocks=[],this.serverLocks=[],this.mindMapController=new DF(this),this.mediaPlayController=new qG(this),this.localViewerManager=new kq(this),this.vncManager=new Tq(this),this.pptPlayerManager=new zq(this),this.frameDrawer=new HU(this),this.commentCtrl=new kW(this),this.timerCtrl=new xq(this),this.kanbanCtrl=new OL(this),this.templateCtrl=new FG(this),this.eraseCtrl=new VG(this),this.tableCtrl=new ZG(this),this.webpageCtrl=new Eq(this),this.CustomImageCtrl=new GU(this),this.websocketHelper=new Lq(this),this.graphicCtrl=new ex(this),this.fileHelper=new Rq(this.websocketHelper,this),this.aiServerHelper=new Td(this,this.fileHelper.getFileToken.bind(this.fileHelper)),this.cardCtrl=new qq(this),this.subServiceManager=this.websocketHelper.subServiceManager,this.bigDocManager=new CH(this),this.simpleController=new Hd(this),this.controllers=[this.viewCtrl,this.lineDrawer,this.selectController,this.stickerCtrl,this.connectionLineCtrl,this.shapeDrawer,this.textController,this.frameDrawer,this.copyPasteCtrl,this.uploadControl,this.mindMapController,this.commentCtrl,this.templateCtrl,this.eraseCtrl,this.tableCtrl,this.webpageCtrl,this.CustomImageCtrl,this.localViewerManager,this.pptPlayerManager,this.timerCtrl,this.cardCtrl,this.kanbanCtrl,this.bigDocManager,this.graphicCtrl,this.simpleController],this.boardOssPath="",this.boardQueryObj={},this.boardMngTokenReq=null,this.boardMngToken=null,this.historyMeetingTokenReq=null,this.historyMeetingToken=null,this.screenPlayMode=!1,this.fullscreenMode=!1,this.hideToolbar=!1,this.hideControls=!1,this.elementMap=new eW(this.view),this.elementInfoMap=new Map,this.keyFramesLoaded=!1,this._uploadReqMap={},this.commentManager=new _W(this),this.rightSlidePanelType=null,this.rightSlidePanelGuard=null,this.meetingMode=null,this.curRtcChannel=null,this.workMode="",this._reconnectToastId=null,this.syncingToastId=null,this.viewPickWidget=null,this._recordId="",this.frameExporters=new Set,this.filesZipDownloaders=new Set,this._fileHelperWidget=null,this.toolbarOpened=!1,this.t_timerOpened=!1,this.t_timerActive=!1,this.isUsingAi=!1,this.mentionListOpenedPhone=!1,this.kanbanManager=new Gq(this),this.plugins=[],this.pluginManager=new Jq(this),this.titleBarMinWidth=0,this.titleBarCanExpand=!0,this.customFoldableTools=[],this.customToolIndex={},this.graphicConfig={},this.kanbanConfig={},this.candidateListCache=[],this.videoGuide=null,this.uploadManager=null,this.unSyncedMarkPointLists=new Set,this.serverVersion=-1,this.isSyncing=!1,this.isSyncingUI=!1,this.syncingStartTime=0,this.connectSeq=-1,this.aiCountInPackage=0,this.aiCountOutPackage=0,this.latestUsedTool=null,this.onReady=function(){return A(s,void 0,void 0,(function(){var e,t,n;return D(this,(function(i){switch(i.label){case 0:return[4,this.loadedJS];case 1:return i.sent(),this.online=!0,this.uiController.ready=!0,this.sendControlCmd([1,this.localUserInfo.userName,"4.6.26",this.terminalId]),this.sendControlCmd([21,this.serverVersion]),this.sendControlCmd([4,Date.now()]),((null===(e=this.config.userPreference)||void 0===e?void 0:e.showOthersCursorByDefault)||this.usersCursorsManager.active)&&!this.phoneMode&&this.usersCursorsManager.showCursors(!0),0===this.connectSeq&&this.initTemplateId&&this.dealInitTemplate(this.initTemplateId.templateId,this.initTemplateId.select,this.initTemplateId.show),null===(t=this.shareAssistantManager)||void 0===t||t.join(),null===(n=this.shareSharerManager)||void 0===n||n.join(),[2]}}))}))},this.syncStart=function(){s.connectSeq++,s.isSyncing=!0,s.isSyncingUI=!0,s.syncingStartTime=performance.now(),s.operationInterrupt(),s.switchMode("hand"),s.setEditable(!1)},this.syncFinished=function(e){s.isSyncing=!1,s.updateServerVersion(e),s.publish("allDataSyncFinished",void 0),s.publish("sdkAction",{type:"resourceReady"});var t=function(){s.syncingToastId&&(s.removeToast(s.syncingToastId),s.addToast(O("network.reconnect.syncFinished"),{type:"normal"})),s.setEditable(s.userManager.editable),s.editable&&(s.phoneMode?s.switchMode("view"):s.switchMode("select")),s.isSyncingUI=!1},n=performance.now()-s.syncingStartTime;s.connectSeq>0&&n<3e3?s.syncFinishedTimer=window.setTimeout(t,3e3-n):t()},this.startFullscreen=function(){s.fullscreenMode=!0,s.uiController.openRightSide(!1),s.publish("fullscreenModeChange",!0),ee(!0,s.onFullScreenChange),_c("cv_fullscreen")},this.endFullScreen=function(e){s.fullscreenMode=!1,s.hideToolbar=!1,s.publish("fullscreenModeChange",!1),ee(!1,s.onFullScreenChange);var t="点击退出";"esc"===e&&(t="按ESC退出"),_c("cv_exitfullscreen",{action:t})},this.maxZindex=0,this.minZindex=0,this._addUploadRecord=function(){var e,t=Date.now()+"";return s.config.boardInBusyCB&&!Object.keys(s._uploadReqMap).length&&s.config.boardInBusyCB(((e={})[wt.Uploading]=!0,e)),s._uploadReqMap[t]=!0,t},this._removeUploadRecord=function(e){var t;delete s._uploadReqMap[e],s.config.boardInBusyCB&&!Object.keys(s._uploadReqMap).length&&s.config.boardInBusyCB(((t={})[wt.Uploading]=!1,t))},this.getServerUrl=function(){return A(s,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,l,c,u,d,p,h=this;return D(this,(function(f){switch(f.label){case 0:return e=this.config,t=e.query,n=e.getBoardQuery,i=e.serverAddr,t?(r=t,[3,4]):[3,1];case 1:return n?[4,n()]:[3,3];case 2:return r=f.sent(),[3,4];case 3:throw new Error("Query is necessary bu no privided");case 4:return r.split("&").forEach((function(e){var t=e.split("="),n=t[0],i=t[1];h.boardQueryObj[n]=i})),[4,Nd("",{query:r,headers:(p={},p["Client-Time"]=Date.now().toString(),p)}).result];case 5:if((o=f.sent()).code===vd.OK)return a=o.obj,s=a.host,l=a.port,c=a.query,u=a.protocol,d=void 0===u?"wss":u,[2,"".concat(i||d+"://"+s+":"+l,"?").concat(c)];throw this.addToast(function(e){var t;return"".concat(O("license.error.code.prefix")," ").concat(null!==(t=O("license.error.code.".concat(e)))&&void 0!==t?t:O("license.error.code.unknown"))}(o.code)),new Error("Code error:"+o.code)}}))}))},this.zoomViewBy=function(e){s.viewCtrl.zoomViewBy(e)},this.resetZoom=function(){s.viewCtrl.restoreView()},this.insertFiles=function(e,t){s.uploadControl.insertFiles(e,t)},this.insertImage=function(e,t,n,i,r){return A(s,void 0,void 0,(function(){return D(this,(function(o){switch(o.label){case 0:return[4,this.uploadControl.insertImage(e,t,n,i,r)];case 1:return[2,o.sent()]}}))}))},this.onInsertTemplate=function(){return A(s,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.getTemplate?(this.templateCtrl.reset(),[4,this.getTemplate()]):[2];case 1:return null===(e=t.sent())?(this.switchToPrevXmode(),[2]):(this.doInsertTemplate(e),[2])}}))}))},this.setStickerStyle=function(e){s.stickerCtrl.setStyle(e)},this.setTimerDuration=function(e){s.timerCtrl.setDuration(e)},this.insertFrameAt=function(e,t){return s.frameDrawer.insertFrameAt(e,t)},this.toggleSinglePickMode=function(e){e?(s.switchMode("pick-single-element"),s.hideAllControls(!0)):(s.switchMode(s.prexmode),s.hideAllControls(!1))},this.toggleLeftPanel=function(e){void 0===e&&(e="frame");var t={frame:Et.FrameList,history:Et.History,graphic:Et.Graphic}[e];"frame"===e&&(s.uiController.leftSideOpened&&s.leftSideBarType===t?_c("cv_sidebar",{is_open:"收起"}):_c("cv_sidebar",{is_open:"展开"})),s.currentCustomTool=void 0,s.uiController.leftSideOpened?s.leftSideBarType!==t?s.leftSideBarType=t:(s.uiController.openLeftSide(!1),setTimeout((function(){s.leftSideBarType=null}),300)):(s.leftSideBarType=t,s.uiController.openLeftSide(!0))},this.showPhoneDrawer=function(e,t,n){return s.uiController.showPhoneDrawer(e,t,n)},this.readClipboardData=function(){return s.copyPasteCtrl.readClipboardData()},this.insertShapeAt=function(e,t,n,i){return t&&s.switchShape(t),s.shapeDrawer.insertShapeAt(e,n,i)},this.setDirectMoveTarget=function(e){s.selectController.setDirectMoveTarget(e)},this.clearDirectMoveTarget=function(){s.selectController.clearDirectMoveTarget()},this.onWSLoggedIn=function(e){var t=e.connectId;s.publish("sdkAction",{type:"connectInfoUpdated",payload:{loginName:s.localUserInfo.loginName,connectId:t}})},this.config=e,this.customFoldableTools=e.customFoldableTools,this.customBottomRightTools=e.customBottomRightTools,this.onFullScreenChange=e.onFullScreenChange,this.loadedJS=Promise.all([nW("base64Images",[we+"image_v1.2.js"]),nW("recorderjs",[we+"recorder.js"]),df.loadAll(),RW()]);var l=new YU(this,null!==(t=e.userPreference)&&void 0!==t?t:{},e.userType,null!==(n=e.userAccessHint)&&void 0!==n?n:{});this.beforeUpload=e.beforeUpload;var c=new qU(e.loginName);if(c.userName=e.userName,c.userType=e.userType,c.role=e.role,c.avatarUrl=e.avatarUrl||"",e.showLearningCenterByDefault&&this.uiController.openRightSide(!0),e.operationGuide&&!this.phoneMode&&this.uiController.startOperationGuide(e.operationGuide),(null===(i=e.userPreference)||void 0===i?void 0:i.defaultDrawStyles)&&this.lineDrawer.initDrawStyles(null===(r=e.userPreference)||void 0===r?void 0:r.defaultDrawStyles),this.localUserInfo=c,l.addLocalUser(c),this.userManager=l,this.meetingManager=new BG(this,e.meetingConfigs||{}),this.followManager=new sq(this),this.laserManager=new iq(this),this.historyManager=new gq(this,e.historyConfigs||{activityDuration:0,versionDuration:0,onRestoreToVersion:function(){return Promise.resolve()},UpgradeHintCmp:function(){return null}}),this.usersCursorsManager=new xW(this),e.getUserInfo&&(this.getExtraUserInfo=e.getUserInfo),e.getTemplate&&(this.getTemplate=e.getTemplate),this.editable||this.view.setCursor(Wd(),this),this.view.viewGridType=null!==(a=null===(o=e.userPreference)||void 0===o?void 0:o.gridType)&&void 0!==a?a:qa.LINE,this.clearMainHotKeys=this.listenMainHotKeys(),this.gotoLink=function(t){e.gotoLink?e.gotoLink(t):window.open(t)},this.getElementLink=e.getElementLink,this.initTemplateId="string"==typeof e.initTemplateId?{templateId:e.initTemplateId}:e.initTemplateId,this.customTemplate=e.customTemplate,this.handleBackAndOpenTemplateModal=e.handleBackAndOpenTemplateModal,this.handleTemplateUpgradeModalOpen=e.handleTemplateUpgradeModalOpen,this.handleCoHostUpgradeModalOpen=e.handleCoHostUpgradeModalOpen,this.canExportFrameAsHighQualityPDF=e.canExportFrameAsHighQualityPDF,this.handleExportFrameAsHighQualityPDF=e.handleExportFrameAsHighQualityPDF,this.canExportFrameAsPowerPoint=e.canExportFrameAsPowerPoint,this.handleExportFrameAsPowerPoint=e.handleExportFrameAsPowerPoint,this.canExportFrameAsImage=e.canExportFrameAsImage,this.handleExportFrameAsImage=e.handleExportFrameAsImage,this.customToolIndex=exports.E({},e.tools),this.graphicConfig=exports.E({},e.graphicConfig),this.graphicCtrl.updateConfig(),this.kanbanConfig=exports.E({},e.kanbanConfig),this.dealWaterMark(),this.getCandidate(),e.shareConfig&&e.shareConfig.shareId){var u=e.shareConfig,d=u.role,p=u.shareId,h=u.onEnd;2===d?this.shareAssistantManager=new Yq(this,p,(function(){s.shareAssistantManager=void 0,h()})):this.shareSharerManager=new Xq(this,p,(function(){s.shareSharerManager=void 0,h()}))}this._board_debugger_={countAll:function(){var e=["总计","线","帧框","文本","图形","连接线","图片","贴纸","文档","脑图节点","脑图连接线","标注"],t=new Array(e.length).fill(0);s.elementManager.getAllElements().forEach((function(e){t[e.elementType]++,t[0]++})),s.elementManager.getAllComments().forEach((function(e){t[e.elementType]++,t[0]++})),e.forEach((function(e,n){"".concat(e,": ").concat(t[n]," \n")}))},selectAll:function(){return s.selectAll()},deleteAll:function(){return s.deleteAll()},showElements:function(){},clearAllInfo:function(){return s.sendControlCmd([1e4])},upime:this},"production"!==process.env.NODE_ENV&&(window._board_debugger_=this._board_debugger_,window._test_=this)}return e.prototype.setEditable=function(e){e!==this.editable&&(this.editable=e,e||this.opManager.resetData(),this.publish("editableChange",e))},Object.defineProperty(e.prototype,"currentScene",{get:function(){return this.sceneManager.activedScene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPresentation",{get:function(){var e;return null!==(e=this.standardPresentation)&&void 0!==e?e:this.meetingPresentation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastFrame",{get:function(){if(this.lastSelectedFrame&&!this.lastSelectedFrame.deleted)return this.lastSelectedFrame},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"customImageEvent",{get:function(){return this.CustomImageCtrl.customImageEvent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoResize",{get:function(){return this.config.autoResize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curRecordId",{get:function(){return this._recordId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"phoneMode",{get:function(){return this.config.displayMode?"phone"===this.config.displayMode:!!this.config.phoneMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bigScreenMode",{get:function(){return"bigScreen"===this.config.displayMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chatgptConfig",{get:function(){return this.config.chatgptConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"privateDeployConfig",{get:function(){return this.config.privateDeployConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighResolution",{get:function(){var e=this.view,t=e.viewWidth,n=e.viewHeight;return Math.max(t,n)*window.devicePixelRatio>=3e3},enumerable:!1,configurable:!0}),e.prototype.addFrameExporter=function(e){this.frameExporters=new Set(this.frameExporters.add(e))},e.prototype.removeFrameExporter=function(e){this.frameExporters.delete(e),this.frameExporters=new Set(this.frameExporters)},e.prototype.addFilesZipDownloader=function(e){this.filesZipDownloaders=new Set(this.filesZipDownloaders.add(e))},e.prototype.removeFilesZipDownloader=function(e){this.filesZipDownloaders.delete(e),this.filesZipDownloaders=new Set(this.filesZipDownloaders)},Object.defineProperty(e.prototype,"leftSideOpened",{get:function(){return this.uiController.leftSideOpened},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryBoardInfo",{get:function(){return this.config.queryBoardInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return exports.E({enable:!0,imageEnable:!0},this.config.downloadConfig)},enumerable:!1,configurable:!0}),e.prototype.getDownloadSign=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return this.downloadConfig.preCheck?[4,this.downloadConfig.preCheck(e)]:[2,{}];case 1:return[2,t.sent()]}}))}))},Object.defineProperty(e.prototype,"terminalId",{get:function(){return this.websocketHelper.terminalId},enumerable:!1,configurable:!0}),e.prototype.addCustomFoldableTool=function(e){this.customFoldableTools=R(R([],this.customFoldableTools||[],!0),[e],!1)},e.prototype.mutateCustomFoldableTool=function(e,t){if(this.customFoldableTools){var n=this.customFoldableTools.find((function(t){return t.key===e}));n&&(Object.keys(t).forEach((function(e){n[e]=t[e]})),this.customFoldableTools=R([],this.customFoldableTools,!0))}},e.prototype.insertImageByUrl=function(e,t){this.uploadControl.insertImageByUrl(e,t)},e.prototype.insertDocumentByUrl=function(e,t,n){this.uploadControl.insertDocumentByUrl(e,t,n)},e.prototype.insertVideoByUrl=function(e,t){this.uploadControl.insertVideoByUrl(e,t)},e.prototype.insertAudioByUrl=function(e,t){this.uploadControl.insertAudioByUrl(e,t)},e.prototype.genID=function(e){return this.websocketHelper.genID(e)},e.prototype.getConnectId=function(){return this.websocketHelper.connectId},e.prototype.genLocalSeq=function(){return this.websocketHelper.genLocalSeq()},e.prototype.updateServerVersion=function(e){void 0!==e&&this.isSyncing||(this.serverVersion=e)},e.prototype.checkPreventUnload=function(){if(this.connectSeq<0)return!1;if(this.isSyncingUI)return this.connectSeq>0;if(!this.online){if(this.asyncUpdates.length)return!0;if(this.kanbanManager.waitingActionList.length)return!0;if(this.bigDocManager.unAckedDocs.length)return!0;if(this.framesListManager.localActions.length)return!0}return!1},e.prototype.beforeIncrementalUpdate=function(e){var t=this,n=this.asyncUpdates,i=[],r=[];this.asyncUpdates=[],n.forEach((function(n){var o=n.seq,a=n.group;o<=e?t.asyncUpdates.push(n):a.forEach((function(e){if(function(e){return e.isCreate||!1}(e))r.push(e);else{var t=e.element,n=e.update,o=r.find((function(e){return e.element===t}));o?o.update=Ls(o.update,n):(o=i.find((function(e){return e.element===t})))?(o.update=Ls(o.update,n),e.localOtActions&&e.localOtActions.forEach((function(e){EN(o,e.localOt,e.property)}))):i.push(e)}}))})),i.forEach((function(e){return delete e.update.prevFrameId})),r.forEach((function(e){return delete e.update.prevFrameId})),this.unSentUpdates=i,this.unSentCreates=r,this.kanbanManager.beforeIncrementalUpdate(e),this.bigDocManager.beforeIncrementalUpdate(e),this.framesListManager.beforeIncrementalUpdate(e)},e.prototype.afterIncrementalUpdate=function(){var e=this;if(this.unSentCreates&&(this.unSentCreates.forEach((function(t){var n=e.genLocalSeq();t.seq=n,e.addAsyncUpdates(n,[t]),e.recordAction(xN(t))})),this.unSentCreates=void 0),this.unSentUpdates&&this.unSentUpdates.length){var t=this.genLocalSeq();this.addAsyncUpdates(t,this.unSentUpdates),this.recordAction(wN(this.unSentUpdates,t)),this.unSentUpdates=[]}this.kanbanManager.afterIncrementalUpdate(),this.bigDocManager.afterIncrementalUpdate(),this.unSyncedMarkPointLists.forEach((function(e){e.reSendLocalActions()})),this.framesListManager.afterIncrementalUpdate()},e.prototype.clearPptPlayers=function(){this.pptPlayerManager.finishAll()},e.prototype.requestPreviewPpt=function(e){this.pptPlayerManager.requestPreview(e)},e.prototype.cancelPreviewPpt=function(e){this.pptPlayerManager.cancelPreview(e)},e.prototype.clearLocalWebViewers=function(){this.localViewerManager.finishAll()},e.prototype.requestPreviewWebpage=function(e){this.curMeetingChannel?this.curMeetingChannel.requestVnc(e):this.localViewerManager.requestPreview(e)},e.prototype.cancelPreviewWebpage=function(e){this.curMeetingChannel?this.curMeetingChannel.closeVnc(e):this.localViewerManager.cancelPreview(e)},e.prototype.requestLocalVnc=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.vncManager.requestSingleView(e)]}))}))},e.prototype.closeLocalVnc=function(e){return this.vncManager.closeSingleView(e)},e.prototype.createVncViewer=function(e){return this.vncManager.createViewer(e)},e.prototype.applyVideoElement=function(e){return this.mediaPlayController.applyVideoElement(e)},e.prototype.applyAudioElement=function(e){return this.mediaPlayController.applyAudioElement(e)},e.prototype.applyTimerElement=function(){return this.mediaPlayController.applyTimerElement()},e.prototype.applyMediaDom=function(e){return this.mediaPlayController.applyMediaDom(e)},e.prototype.releaseVideoElement=function(e){this.mediaPlayController.releaseVideoElement(e)},e.prototype.releaseAudioElement=function(e){this.mediaPlayController.releaseAudioElement(e)},e.prototype.releaseTimerElement=function(e){this.mediaPlayController.releaseTimerElement(e)},e.prototype.videoPlayFinished=function(e){this.mediaPlayController.videoPlayFinished(e)},e.prototype.audioPlayFinished=function(e){this.mediaPlayController.audioPlayFinished(e)},e.prototype.finishAllMedias=function(){this.mediaPlayController.finishAll()},Object.defineProperty(e.prototype,"watermarkUrl",{get:function(){return this.config.watermarkUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curConnectionLineConfig",{get:function(){return this.connectionLineCtrl.curLineConfig},enumerable:!1,configurable:!0}),e.prototype.showWindow=function(e,t,n,i,r,o){return this.uiController.showWindow(e,t,n,i,r,o)},e.prototype.removeWindow=function(e){this.uiController.removeWindow(e)},e.prototype.setAnchorElement=function(e){var t=e.indexOf("?");e=e.substring(0,t),this.anchorElementId=e,this.keyFramesLoaded&&this.moveToAnchorElement(e)},e.prototype.moveToAnchorElement=function(e){var t,n=this,i=this.elementManager.getElementByOriginId(e)||this.elementManager.getElementById(e);if(!i)return bF(this),void(this.anchorElementId=void 0);(null===(t=i)||void 0===t?void 0:t.isMindmapNodeHideByCollapsed)&&(i=i.seekUnHideParent()),i&&!i.deleted&&(i.elementType!==Za.COMMENT?this.phoneMode?this.showElement(i,{left:40,top:80,bottom:80,right:40}):this.showElement(i,{left:90,right:20,top:60,bottom:60}):this.slideViewToComment(i).then((function(){n.expandComment(i)}))),this.anchorElementId=void 0},e.prototype.listenMainHotKeys=function(){var e=this,t=function(t){"="===t.key?e.zoomViewBy(.1):"-"===t.key?e.zoomViewBy(-.1):"0"===t.key&&e.resetZoom()},n=function(){return null},i=function(){var t,n=e.getSelectedElements();if(1!==n.length)return!0;if(n[0].elementType===Za.TIMER)return!0;var i=null===(t=document.activeElement)||void 0===t?void 0:t.tagName.toUpperCase();return"INPUT"!==i&&"TEXTAREA"!==i};function r(e){return{key:e,ctrlKey:!1,shiftKey:!1,altKey:!1,connected:!1,filter:i,i:!0}}var o=function(){return"picking-view"!==e.xmode&&!e.exportingPdf},a=function(t,n,i){o()&&(e.editable||e.userManager.commentOnlyMode&&"comment"===t)&&(n&&_c(n),e.publish("openToolbar",{xmode:t,subType:i}))},s=[this.registerHotKey({key:"ArrowUp"},(function(t){var n=e.currentPresentation;void 0!==n?n.handlePrev("ArrowUp"):e.getSelectedElements().length?!t.connected&&!e.viewCtrl.movingView&&e.editable&&e.selectController.arrowKeyDownHandler("ArrowUp",t):!t.connected&&!t.originEvent.metaKey&&e.viewCtrl.arrowKeyDownHandler("ArrowUp")})),this.registerHotKey({key:"ArrowDown"},(function(t){var n=e.currentPresentation;void 0!==n?n.handleNext("ArrowDown"):e.getSelectedElements().length?!t.connected&&!e.viewCtrl.movingView&&e.editable&&e.selectController.arrowKeyDownHandler("ArrowDown",t):!t.connected&&!t.originEvent.metaKey&&e.viewCtrl.arrowKeyDownHandler("ArrowDown")})),this.registerHotKey({key:"ArrowLeft"},(function(t){var n=e.currentPresentation;void 0!==n?n.handlePrev("ArrowLeft"):e.getSelectedElements().length?!t.connected&&!e.viewCtrl.movingView&&e.editable&&e.selectController.arrowKeyDownHandler("ArrowLeft",t):!t.connected&&!t.originEvent.metaKey&&e.viewCtrl.arrowKeyDownHandler("ArrowLeft")})),this.registerHotKey({key:"ArrowRight"},(function(t){var n=e.currentPresentation;void 0!==n?n.handleNext("ArrowRight"):e.getSelectedElements().length?!t.connected&&!e.viewCtrl.movingView&&e.editable&&e.selectController.arrowKeyDownHandler("ArrowRight",t):!t.connected&&!t.originEvent.metaKey&&e.viewCtrl.arrowKeyDownHandler("ArrowRight")})),this.registerHotKey({key:"PageUp"},(function(t){var n;null===(n=e.currentPresentation)||void 0===n||n.handlePrev("PageUp")})),this.registerHotKey({key:"PageDown"},(function(t){var n;null===(n=e.currentPresentation)||void 0===n||n.handleNext("PageDown")})),this.registerHotKey({key:" "},(function(t){var n;null===(n=e.standardPresentation)||void 0===n||n.handleNext("Space")})),this.registerKeyup(["ArrowUp","ArrowLeft","ArrowRight","ArrowDown"],(function(t){e.viewCtrl.arrowKeyUpHandler(t.key),e.selectController.arrowKeyUpHandler(t.key,t.altKey,t.shiftKey)})),this.registerHotKey({key:"Escape",connected:!1},(function(t){e.exportingPdf&&(e.exportingPdf=!1),"picking-view"===e.xmode&&(e.exportImageDrawer&&e.setExportView(!1),e.switchToPrevXmode()),"select"===e.xmode?(e.selectController.clearEditor(),e.currentCustomTool=void 0):"comment"===e.xmode?e.commentCtrl.handleEsc():"hand"!==e.xmode&&e.switchMode("select"),e.collapseComments()})),this.registerHotKey({key:"a",connected:!1,ctrlKey:!0},(function(){e.editable&&("select"!==e.xmode&&e.switchMode("select"),e.selectAllAvailableEles())})),this.registerHotKey({key:"d",ctrlKey:!0},(function(){e.editable&&e.selectController.cloneSelectedEles()})),this.registerHotKey({key:"s",ctrlKey:!0,i:!0},(function(){e.editable&&e.addToast(O("save.board.hint"),{type:"normal"})})),this.registerHotKey({key:"f",ctrlKey:!0},(function(){o()&&e.publish("onSearchElement",void 0)})),this.registerHotKey({key:"=",ctrlKey:!0},t),this.registerHotKey({key:"-",ctrlKey:!0},t),this.registerHotKey({key:"_",ctrlKey:!0},n),this.registerHotKey({key:"+",ctrlKey:!0},n),this.registerHotKey({key:"0",ctrlKey:!0},t),this.registerHotKey({key:"g",ctrlKey:!0},(function(){e.selectController.groupElement(!0)})),this.registerHotKey({key:"g",ctrlKey:!0,shiftKey:!0,i:!0},(function(){e.selectController.groupElement(!1)})),this.registerHotKey({key:"l",ctrlKey:!0,shiftKey:!0,i:!0},(function(){e.selectController.lockElement()})),this.registerHotKey({key:"h",ctrlKey:!0,shiftKey:!0,i:!0},(function(){e.selectController.toggleHideFrame()})),this.registerHotKey({key:"u",ctrlKey:!0},n),this.registerHotKey({key:"\\",ctrlKey:!0},(function(){e.hideToolbar=!e.hideToolbar})),this.registerHotKey(r("t"),(function(){return a("text","cv_text_shortcuts")})),this.registerHotKey(r("s"),(function(){return a("shape","cv_shape_shortcuts")})),this.registerHotKey(r("r"),(function(){return a("shape","cv_rectangle_shortcuts",Ka.RECT)})),this.registerHotKey(r("o"),(function(){return a("shape","cv_oval_shortcuts",Ka.ELLIPSE)})),this.registerHotKey(r("n"),(function(){return a("sticker","cv_stickynote_shortcuts")})),this.registerHotKey(r("l"),(function(){return a("connection-line","cv_line_shortcuts")})),this.registerHotKey(r("p"),(function(){return a("draw","cv_pen_shortcuts")})),this.registerHotKey(r("e"),(function(){return a("eraser","cv_pen_shortcuts","eraser")})),this.registerHotKey(r("c"),(function(){return a("comment","cv_comment_shortcuts")})),this.registerHotKey(r("f"),(function(){return a("frame","cv_frame_shortcuts")})),this.registerHotKey(r("m"),(function(){return a("mind-map","cv_mindmap_shortcuts")})),this.registerHotKey(r("v"),(function(){o()&&(_c("select"===e.xmode?"cv_view_shortcuts":"cv_select_shortcuts"),e.toggleSelectAndViewMode())}))];return this.userManager.enableDocument&&s.push(this.registerHotKey(r("d"),(function(){return a("bigDoc","cv_document")}))),function(){s.forEach((function(e){return e()}))}},e.prototype.addSdkPluginCmp=function(e,t,n){return this.uiController.addSdkPluginCmp(e,t,n)},e.prototype.removeSdkPluginCmp=function(e){return this.uiController.removeSdkPluginCmp(e)},e.prototype.addToast=function(e,t){return this.uiController.addToast(e,t)},e.prototype.updateOrAddToastContent=function(e,t,n){return this.uiController.updateOrAddToastContent(e,t,n)},e.prototype.removeToast=function(e){return this.uiController.removeToast(e)},e.prototype.showBottomCtrls=function(e){return this.uiController.showBottomCtrl(e)},e.prototype.showBtmMeetingCtrl=function(e){return this.uiController.showBtmMeetingCtrl(e)},e.prototype.keepBorderInSight=function(e){this.viewCtrl.keepBorderInSight(e)},e.prototype.onFrameSelected=function(e){this.lastSelectedFrame=e,this.publish("frameSelected",e)},e.prototype.changeSelectFrame=function(e){this.lastSelectedFrame=e,this.publish("SelectedFrameChanged",e)},e.prototype.displayFrame=function(e,t){var n;void 0!==(null===(n=this.currentPresentation)||void 0===n?void 0:n.framePlayer)?this.currentPresentation.framePlayer.playFrame(e):(t?this.showElement(e,{left:16,top:16,bottom:16,right:16,duration:500}):this.showElement(e,{left:8,top:8,bottom:8,right:8,duration:500}),e!==this.lastFrame&&this.onFrameSelected(e))},e.prototype.displayDocument=function(e){void 0!==this.meetingPresentation?this.meetingPresentation.framePlayer.playDocument(e):_e.isPhone?this.showElement(e,{left:16,top:16,bottom:16,right:16,duration:500}):this.startPresentation(e)},e.prototype.displayMedia=function(e){void 0!==this.meetingPresentation?this.meetingPresentation.framePlayer.playMedia(e):_e.isPhone?this.showElement(e,{left:16,top:16,bottom:16,right:16,duration:500}):this.startPresentation(e)},e.prototype.startPresentation=function(e){var t,n=e;void 0===n&&(n=null!==(t=this.lastFrame)&&void 0!==t?t:this.elementManager.sequentialFrames[0]),n&&(this.publish("sdkAction",{type:"presentationStateChange",payload:{state:!0}}),this.view.enableImmersivePlaying(!0),this.followManager.stopFollowCurrent(),void 0===this.standardPresentation?this.standardPresentation=new lW(this,n):(this.standardPresentation.changePlayElement(n),this.publish("standardPresentationChangeElement",void 0)),this.clearSelect(),this.rightSlidePanelType=null,this.currentCustomTool=void 0,this.uiController.openLeftSide(!1),this.uiController.openRightSide(!1),this.uiController.removeAllWindows(),this.usersCursorsManager.hideCursors(),this.hideToolbar=!1,this.switchMode("view"))},e.prototype.endPresentation=function(){var e;null===(e=this.standardPresentation)||void 0===e||e.destroy(),this.standardPresentation=void 0,this.switchMode("select"),this.currentCustomTool=void 0,this.clearSelect(),this.usersCursorsManager.restoreCursors(),this.publish("sdkAction",{type:"presentationStateChange",payload:{state:!1}})},e.prototype.createUserCursorService=function(e,t){return new wW(this,e,t)},e.prototype.dealSubServiceCmd=function(e){this.subServiceManager.dealSCmd(e)},e.prototype.dealResponseCmd=function(e){return this.websocketHelper.dealResponseCmd(e)},e.prototype.sendControlCmd=function(e){var t;null===(t=this.socketClient)||void 0===t||t.sendControlCmd(e)},e.prototype.updateView=function(e){this.view.update(e)},e.prototype.updateMapPicture=function(){this.elementMap.update()},e.prototype.updateWidgetCvs=function(){this.view.updateWidgetCvs()},e.prototype.updateElement=function(e,t){new e.editorType(this,e).updateProperty(t),this.view.update()},e.prototype.deleteElement=function(e){var t,n;(null!==(n=null===(t=this.selectController.currentEditor)||void 0===t?void 0:t.getElements())&&void 0!==n?n:[]).includes(e)&&this.selectController.clearSelect(),new e.editorType(this,e).delete(),this.view.update()},e.prototype.createMindMapConnectablePoints=function(e){this.mindMapController.createMindMapConnectablePoints(e)},e.prototype.clearPoints=function(){this.mindMapController.clearPoints()},e.prototype.selectAll=function(){var e=this.elementManager.getAllElements();if(e.length){this.selectElements(e);var t=e.map((function(e){return e.getBorderBox()})),n=Yt(t);this.makeBorderInSight(n,{left:90,right:20,top:60,bottom:60})}},e.prototype.deleteAll=function(){this.selectAll(),this.deleteSelected()},e.prototype.operationInterrupt=function(){this.userEventManager.stopCurrentEvt(),this.clearSelect()},e.prototype.linkHover=function(e,t,n){e?(this.linkSpan.className=j($U.goToLinkToolTip),this.linkSpan.style.left="".concat(t.x-20,"px"),this.linkSpan.style.top="".concat(t.y+50,"px"),this.linkSpan.innerHTML=n,document.body.appendChild(this.linkSpan)):document.body.contains(this.linkSpan)&&document.body.removeChild(this.linkSpan)},e.prototype.addCtrlWidget=function(e){this.selectController.addCtrlWidget(e)},e.prototype.removeCtrlWidget=function(e){this.selectController.removeCtrlWidget(e)},e.prototype.setExportView=function(e){var t;e?this.exportImageDrawer=new XU(this):(null===(t=this.exportImageDrawer)||void 0===t||t.destroy(),this.exportImageDrawer=void 0)},e.prototype.setExportPdf=function(e){this.exportingPdf=!!e},e.prototype.deleteAsyncUpdates=function(e){this.asyncUpdates=this.asyncUpdates.filter((function(t){return t.seq!==e}))},e.prototype.addAsyncUpdates=function(e,t){this.asyncUpdates.push({seq:e,group:t})},e.prototype.copySelected=function(e,t,n,i,r){return this.copyPasteCtrl.copyElements(e,t,n,i,r)},e.prototype.copyBoard=function(){var e=this.elementManager.getAllElements().filter((function(e){return!1===Cp(e)}));this.selectElements(e);var t=this.copyPasteCtrl.copyElements("topLeft",!0,!1,!1,!1);return this.clearSelect(),t},e.prototype.useElementsInfo=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){switch(i.label){case 0:return[4,this.copyPasteCtrl.useEleInfo(e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.deleteSelected=function(){this.selectController.deleteElements()},e.prototype.deleteSelectedTableRowCols=function(){this.selectController.deleteSelectedTableRowCols()},e.prototype.getSelectedElements=function(){return this.selectController.getSelectedElements()},e.prototype.registerHotKey=function(e,t,n){return this.userEventManager.registerHotKey(e,t,n)},e.prototype.registerKeyup=function(e,t){return this.userEventManager.registerKeyup(e,t)},e.prototype.selectElement=function(e){return"select"!==this.xmode&&"hand"!==this.xmode&&this.switchMode("select"),e.stable?new e.editorType(this,e):this.selectController.directSelect([e])},e.prototype.selectElements=function(e){return"select"!==this.xmode&&"hand"!==this.xmode&&this.switchMode("select"),this.selectController.directSelect(e)},e.prototype.updateBorderBox=function(){return this.selectController.updateBorderBox()},e.prototype.clearSelect=function(){this.selectController.clearSelect()},e.prototype.dealMove=function(e){this.viewCtrl.dealMove(e)},e.prototype.switchEditor=function(e){this.selectController.switchEditor(e)},e.prototype.hideEditor=function(){this.selectController.hideEditor()},e.prototype.updateTextConfig=function(e){this.textController.textConfig(e)},e.prototype.updateShapeStyle=function(e,t){this.shapeDrawer.shapeStyle(e,t)},e.prototype.updateShapeParent=function(e,t){this.shapeDrawer.findAndSetParent(e,t)},e.prototype.updateElementParent=function(e,t){this.simpleController.findAndSetParent(e,t)},e.prototype.updateConnectionLineConfig=function(e){this.connectionLineCtrl.lineConfig(e)},e.prototype.drawConnectionLine=function(e,t,n){this.connectionLineCtrl.drawConnectionLine(e,t,n)},e.prototype.insertMindMapNode=function(e,t,n,i){return this.mindMapController.createChildNode(e,t,n,i)},e.prototype.genPickWidgetUpdateFromElement=function(e,t,n){switch(t){case Za.TEXT:return this.textController.genPickWidgetUpdateFromElement(e);case Za.STICKER:return this.stickerCtrl.genPickWidgetUpdateFromElement(e,n.stickerType);case Za.SHAPE:return this.shapeDrawer.genPickWidgetUpdateFromElement(e,n.shapeType);case Za.GRAPHIC:return this.graphicCtrl.genPickWidgetUpdateFromElement(e,n.categoryId,n.graphicId)}},e.prototype.newMaxZindex=function(){return++this.maxZindex},e.prototype.newMinZindex=function(){return--this.minZindex},e.prototype.updateMaxMinZindex=function(e){e>this.maxZindex?this.maxZindex=e:e<this.minZindex&&(this.minZindex=e)},e.prototype.sendRCmd=function(e,t){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return(n=this.websocketHelper).sendRCmd.apply(n,R([e,t],i,!1))},e.prototype.sendSCmd=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];null===(t=this.socketClient)||void 0===t||t.sendServiceCmd(R([e],n,!0))},e.prototype.sendRequest=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.sendRCmd.apply(this,R([0,e],t,!1))},e.prototype.getBoardMngServiceToken=function(){var e=this;return this.boardMngToken&&Date.now()<this.boardMngToken.expire-3e5?Promise.resolve(this.boardMngToken):(this.boardMngTokenReq||(this.boardMngTokenReq=this.sendRequest(7).then((function(t){var n=t[0];return e.boardMngToken=n,n})).finally((function(){e.boardMngTokenReq=null}))),this.boardMngTokenReq)},e.prototype.getHistoryMeetingServiceToken=function(){var e=this;return this.historyMeetingToken&&Date.now()<this.historyMeetingToken.expire-3e5?Promise.resolve(this.historyMeetingToken):(this.historyMeetingTokenReq||(this.historyMeetingTokenReq=this.sendRequest(10).then((function(t){var n=t[0];return e.historyMeetingToken=n,n})).finally((function(){e.historyMeetingTokenReq=null}))),this.historyMeetingTokenReq)},e.prototype.svgToPdf=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){return[2,this.fileHelper.svgToPdf(e,t,n)]}))}))},e.prototype.stopAi=function(){var e;this.isUsingAi&&(this.isUsingAi=!1,null===(e=this.aiAborter)||void 0===e||e.call(this),this.aiAborter=void 0)},e.prototype.onAiGenerteEnd=function(){this.isUsingAi=!1,this.aiAborter=void 0},e.prototype.points2Shape=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.aiServerHelper.points2Shape(e)]}))}))},e.prototype.uploadToOss=function(e,t){return void 0===t&&(t=1),A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:n=this._addUploadRecord(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.fileHelper.uploadToOss(e,t)];case 2:return[2,i.sent()];case 3:throw i.sent();case 4:return this._removeUploadRecord(n),[7];case 5:return[2]}}))}))},e.prototype.uploadToOssBySdk=function(e,t){return void 0===t&&(t=1),A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:n=this._addUploadRecord(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.fileHelper.upload2OssBySdk(e,t)];case 2:return[2,i.sent()];case 3:throw i.sent();case 4:return this._removeUploadRecord(n),[7];case 5:return[2]}}))}))},e.prototype.saveFile=function(e,t,n,i){return A(this,void 0,void 0,(function(){var r;return D(this,(function(o){switch(o.label){case 0:r=this._addUploadRecord(),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.fileHelper.saveFile(this.boardQueryObj.appId||"",e,t,n,i)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return this._removeUploadRecord(r),[7];case 5:return[2]}}))}))},e.prototype.parseIspringPpt=function(e){return this.fileHelper.parsePpt(e)},e.prototype.transcodeMedia=function(e){return this.fileHelper.transcodeMedia(e)},e.prototype.getTableDataByExcel=function(e){return this.fileHelper.getTableDataByExcel(e)},e.prototype.getFileInfo=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.fileHelper.getFileInfo(e)]}))}))},e.prototype.dealControlCmd=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h=this;return D(this,(function(f){switch(this.websocketHelper.dealControlCmd(e),e[0]){case 1004:t=e[1],n=this.userManager,i=[],t.forEach((function(e){var t=e[0],r=e[1],o=e[2],a=e[5],s=e[6];if(t!==h.localUserInfo.loginName){var l=n.getUser(t);l.userName=r,l.userType=o,l.nickNamePinyin=a,l.nickNamePinyinAbbreviation=s,l.online=!0,n.onlineUsers.includes(l)||n.onlineUsers.push(l),i.push(l)}})),n.onlineUsers=R([],n.onlineUsers,!0),this.publish("sdkAction",{type:"usersEvent",payload:{changedUsers:i,otherUsers:n.onlineUsers}});break;case 2:r=e[1],this.followManager.clearFollowNotification(r),o=this.userManager,(u=o.getUser(r)).online=!1,o.onlineUsers=o.onlineUsers.filter((function(e){return e.online})),this.publish("sdkAction",{type:"usersEvent",payload:{changedUsers:[u],otherUsers:o.onlineUsers}}),this.usersCursorsManager.removeUserCursor(r);break;case 22:this.pptPlayerManager.pptPlayerAddr=e[1].pptPlayAddr;break;case 5:a=e[1],s=e[2],l=e[3],c=e[4],(u=this.userManager.getUser(a)).userName=s,u.nickNamePinyin=l,u.nickNamePinyinAbbreviation=c,this.publish("updatedUserInfo",u),this.usersCursorsManager.updateCursorUserName(a,s);break;case 27:this.syncFinished(e[1]);break;case 28:(d=e[1])===$a.start?(p=e[2],this.beforeIncrementalUpdate(p)):d===$a.end?(this.syncFinished(e[2]),this.afterIncrementalUpdate()):d===$a.error&&this.resetElementData()}return[2]}))}))},e.prototype.createLock=function(e){var t={ids:e,acked:!1,released:!1,seq:this.genLocalSeq(),lockId:this.genLockId()};return this.localLocks.push(t),this.recordAction(exports.E({type:"lock"},t)),t},e.prototype.clearLock=function(e){e.released=!0,this.localLocks=this.localLocks.filter((function(e){return!e.released||!e.acked})),this.recordAction({type:"unlock",lockId:e.lockId,seq:this.genLocalSeq()}),this.elementManager.refreshFrameCover()},e.prototype.createOperation=function(){return this.opManager.create()},e.prototype.deleteOperation=function(e){this.opManager.delete(e)},e.prototype.undoOperation=function(){this.opManager.undo()},e.prototype.redoOperation=function(){this.opManager.redo()},e.prototype.addElementInfo=function(e,t){var n=t.creator,i=t.addTime,r=t.editor,o=void 0===r?n:r,a=t.updateTime,s=void 0===a?i:a,l=this.elementInfoMap.get(e);l||(l={},this.elementInfoMap.set(e,l)),Object.assign(l,{creator:n,addTime:i,editor:o,updateTime:s})},e.prototype.updateElementInfo=function(e,t){var n=t.editor,i=t.updateTime,r=this.elementInfoMap.get(e);r&&Object.assign(r,{editor:n,updateTime:i})},e.prototype.getElementInfo=function(e){var t=this.elementInfoMap.get(e);return{creator:t&&t.creator!==this.localUserInfo.loginName&&this.userManager.getUser(t.creator)||this.localUserInfo,editor:t&&t.editor!==this.localUserInfo.loginName&&this.userManager.getUser(t.editor)||this.localUserInfo,addTimeStr:zI(t?1e3*t.addTime:Date.now()),updateTimeStr:zI(t?1e3*t.updateTime:Date.now()),item:t}},e.prototype.dealDataCmd=function(e){var t=this.websocketHelper.dealDataCmd(e);this.dealServerAction(t)},e.prototype.getAllElementInfoById=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRequest(8,e)];case 1:return[2,Rs(t.sent()[0])]}}))}))},e.prototype.getLocalTimerById=function(e){return this.timerManager.getTimerById(e)},e.prototype.dealServerAction=function(e){var t=this;switch(e.type){case"keyFrame":var n=Object.keys(e.actions.reduce((function(e,t){return t.elementType===Za.STICKER&&!t.data.deleted&&t.data.showAuthor&&(e[t.info.creator]||(e[t.info.creator]=!0)),e}),{}));n.length&&this.userManager.loadUsers(n),e.actions.forEach((function(e){return t.dealCreatedAction(e)})),e.ended&&(this.elementManager.refreshFrameCover(),this.anchorElementId&&this.moveToAnchorElement(this.anchorElementId),this.keyFramesLoaded=!0,this.config.showAerialViewByDefault&&this.showAerialView(),this.config.showLastEditElement&&this.showLastEditElement(),this.getAllComments().forEach((function(e){var n=t.elementManager.getElementById(e.attached);n&&(t.elementManager.addElementAttachedComment(n,e),e.attachedElement=n)})),this.publish("sdkAction",{type:"keyFrameLoaded",payload:null}));break;case"ack":this.dealAck(e),this.updateServerVersion(e.serverVersion);break;case"created":this.dealCreatedAction(e),this.updateServerVersion(e.serverVersion);break;case"updated":this.dealUpdatedAction(e),this.updateServerVersion(e.serverVersion);break;case"locked":this.dealServerLock(e);break;case"unlocked":this.dealServerUnlock(e);break;case"frameIdList":this.framesListManager.init(e.ids);break;case"backgrounds":e.data.forEach((function(e){t.dealBackgroundData(e.data)}));break;case"background":this.dealBackgroundData(e.data),this.updateServerVersion(e.serverVersion);break;case"incrementalUpdate":e.data.forEach((function(e){"created"===e.type?t.dealCreatedAction(e):"updated"===e.type?t.dealUpdatedAction(e):"background"===e.type&&t.dealBackgroundData(e.data)}))}},e.prototype.dealCreatedAction=function(e){var t,n=e.info,i=e.id,r=e.elementType,o=e.data,a=null!==(t=this.elementManager.getElementById(i))&&void 0!==t?t:this.elementManager.genElement(r,i);if(a){if(void 0===o.deleted&&(o.deleted=!1),r===Za.TIMER){var s=this.getLocalTimerById(i);s&&(s.currentTime&&(o.currentTime=s.currentTime),s.status&&(o.status=s.status))}this.elementManager.updateElement(a,o,{isServerUpdate:!0,isServerCreate:!0}),this.serverLocks.some((function(e){return e.ids.includes(a.id)}))&&(a.locked=!0),this.addElementInfo(i,n),this.publish("elementsUpdated",[{element:a,update:o}])}},e.prototype.dealUpdatedAction=function(e){var t=this,n=[];e.updates.forEach((function(i){var r=i.id,o=i.update,a=i.elementType,s=!1;o=exports.E({},o);var l=t.elementManager.getElementById(r);(l||(l=t.elementManager.genElement(a,r)))&&(t.asyncUpdates.forEach((function(e){e.group.forEach((function(e){var t=e.element,n=e.update;if(t.id===r){s=!0;var i=o.cps;o.prevFrameId;var a=N(o,["cps","prevFrameId"]),l=n.cps;for(var c in i&&l&&(o.cps=i.filter((function(e){return l.findIndex((function(t){return t[0]===e[0]}))<0})),o.cps.length||delete o.cps),a)void 0!==n[c]&&delete o[c]}}))})),Object.keys(o).length>0&&t.unSentUpdates&&t.unSentUpdates.forEach((function(e){var t=e.element,n=e.update;if(t.id===r){s=!0;var i=o,a=i.cps;i.prevFrameId;var l=i.weakOt,c=N(i,["cps","prevFrameId","weakOt"]),u=n.cps;if(a&&u){var d=[];o.cps=a.filter((function(e){return"weakOt"===e[1]?(d.push({name:e[0],data:e[2]}),!0):u.findIndex((function(t){return t[0]===e[0]}))<0})),e.localOtActions&&d.length&&(e.localOtActions=e.localOtActions.filter((function(e){var t,i,r=e.localOt,o=e.property;if(o){var a=d.find((function(e){return e.name===o.name}));if(!a)return!0;var s={version:a.data.baseVersion||"",baseVersion:(null===(t=o.richTextClient)||void 0===t?void 0:t.version)||(null===(i=o.tempData)||void 0===i?void 0:i.version)||"",content:r.reverseOpList};return o.updateData(s),n.cps&&(n.cps=n.cps.filter((function(e){return e[0]!==o.name})),0===n.cps.length&&delete n.cps),!1}return!0})),0===e.localOtActions.length&&(e.localOtActions=void 0)),o.cps.length||delete o.cps}for(var p in l&&n.weakOt&&(e.localOtActions&&(e.localOtActions=e.localOtActions.filter((function(e){var n,i,r=e.localOt;if(!e.property&&t.richTextClient){var o={version:l.baseVersion,baseVersion:t.richTextClient.version,content:r.reverseOpList};return null===(i=(n=t.richTextClient).dealWeakOt)||void 0===i||i.call(n,o),!1}return!0})),0===e.localOtActions.length&&(e.localOtActions=void 0)),delete n.weakOt),c)void 0!==n[p]&&delete o[p]}})),s||t.updateElementInfo(r,e.info),(!s||Object.keys(o).length>0)&&(t.opManager.elementModified(r),t.elementManager.updateElement(l,o,{isServerUpdate:!0}),n.push({element:l,update:o})))})),n.length&&this.publish("elementsUpdated",n)},e.prototype.dealAck=function(e){var t=e.seq;this.asyncUpdates=this.asyncUpdates.filter((function(e){return e.seq!==t}));var n=this.localLocks.find((function(e){return e.seq===t}));n&&(n.acked=!0,this.localLocks=this.localLocks.filter((function(e){return!e.acked||!e.released})));var i=this.framesListManager.localActions.find((function(e){return e.seq===t}));i&&this.framesListManager.dealLocalSequenceChangeAck(i)},e.prototype.dealServerLock=function(e){for(var t=e.ids,n=e.info,i=e.lockId,r=function(e){if(!e.acked&&t.some((function(t){return e.ids.includes(t)})))return{value:void 0}},o=0,a=this.localLocks;o<a.length;o++){var s=r(a[o]);if("object"==typeof s)return s.value}for(var l=function(e){e.acked&&t.some((function(t){return e.ids.includes(t)}))&&c.clearLock(e)},c=this,u=0,d=this.localLocks;u<d.length;u++)l(d[u]);var p=n.editor===this.localUserInfo.loginName?this.localUserInfo:this.userManager.getUser(n.editor);this.serverLocks.push(new JU(this,i,p,t)),this.view.locks=R([],this.serverLocks,!0),this.view.update();for(var h=0,f=t;h<f.length;h++){var m=f[h],v=this.elementManager.getElementById(m);v&&(v.locked=!0)}this.publish("elementsLocked",t)},e.prototype.dealServerUnlock=function(e){var t=e.lockId,n=this.serverLocks.find((function(e){return e.lockId===t}));if(n){for(var i=function(e){var t=r.elementManager.getElementById(e);if(!t)return"continue";t.locked=r.serverLocks.some((function(t){return t!==n&&t.ids.includes(e)}))},r=this,o=0,a=n.ids;o<a.length;o++)i(a[o]);this.publish("elementsUnlocked",n.ids),n.destroy()}this.serverLocks=this.serverLocks.filter((function(e){return e.lockId!==t})),this.view.locks=this.serverLocks,this.view.update(),this.elementManager.refreshFrameCover()},e.prototype.dealBackgroundData=function(e){this.view.bgRender.addBgImageData(e)},e.prototype.dealInitTemplate=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!0),A(this,void 0,void 0,(function(){var i,r,o;return D(this,(function(a){switch(a.label){case 0:return[4,this.templateManager.getTemplateData(e)];case 1:return i=a.sent(),[4,this.copyPasteCtrl.useEleInfo(i,{x:0,y:0})];case 2:return a.sent(),this.initTemplateId=void 0,r=this.getSelectedElements(),t||this.clearSelect(),n&&(o=Yt(r.map((function(e){var t=e.getBorderBox();return Sn(t,t.rotate||0)}))),this.makeBorderCenter(o,{left:90,right:20,top:60,bottom:60})),[2]}}))}))},e.prototype.dealLocalAction=function(e,t){t&&this.recordAction(e)},e.prototype.recordAction=function(e){var t,n=this;"create"===e.type?e.isRevert?this.updateElementInfo(e.id,{editor:this.localUserInfo.loginName,updateTime:Math.floor(Date.now()/1e3)}):this.addElementInfo(e.id,{creator:this.localUserInfo.loginName,addTime:Math.floor(Date.now()/1e3)}):"update"===e.type&&e.updates.map((function(e){var t=e.id;n.updateElementInfo(t,{editor:n.localUserInfo.loginName,updateTime:Math.floor(Date.now()/1e3)})}));var i=Bs(e);null===(t=this.socketClient)||void 0===t||t.sendDataCmd(i)},e.prototype.genLockId=function(){return this.genID("l")},e.prototype.genOtVersion=function(e){return this.websocketHelper.genOtVersion(e)},e.prototype.genFileName=function(e){return"".concat(this.boardQueryObj.loginName||"","_").concat(e,"_").concat(Date.now())},e.prototype.subscribe=function(e,t){return this.eventManager.subscribe(e,t)},e.prototype.once=function(e,t){return this.eventManager.once(e,t)},e.prototype.publish=function(e,t){return this.eventManager.publish(e,t)},e.prototype.launchApp=function(e){var t=this,n=this.view;n.setViewSize(e.offsetWidth,e.offsetHeight);var i=this.config,r=i.viewRect,o=i.recordView;r&&this.view.setViewRect(r);var a=this.userEventManager.bindDom(e),s=Od((function(){n.viewWidth===e.offsetWidth&&n.viewHeight===e.offsetHeight||(n.setViewSize(e.offsetWidth,e.offsetHeight),t.followManager.followingRect&&n.setViewRect(t.followManager.followingRect,!0),t.publish("boardResized",!0),t.fullscreenMode&&(J()||t.endFullScreen("esc")))}),this),l=function(){var e=t.view;return{x:e.x,y:e.y,width:e.width,height:e.height}},c=o?window.setInterval((function(){o(l())}),6e4):void 0;this.connectServer(),this.config.getShadowBoardQuery&&this.connectShadowServer();var u=function(e){o&&o(l()),t.checkPreventUnload()&&(e.returnValue="alert")};window.addEventListener("beforeunload",u);var d=function(){var e="visible"===document.visibilityState;t.publish("visibilitychange",e),t.socketClient&&(t.socketClient.autoReconnect=e),t.sdSocketClient&&(t.sdSocketClient.autoReconnect=e)},p=function(){t.publish("visibilitychange",!1),t.socketClient&&(t.socketClient.autoReconnect=!1),t.sdSocketClient&&(t.sdSocketClient.autoReconnect=!1)};return document.addEventListener("visibilitychange",d),window.addEventListener("pagehide",p),function(){a(),s(),window.removeEventListener("beforeunload",u),o&&(clearInterval(c),o(l())),document.removeEventListener("visibilitychange",d),window.removeEventListener("pagehide",p)}},e.prototype.setDrawLingStyle=function(e){this.lineDrawer.setStyle(e)},e.prototype.insertTemplate=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.editable&&e&&(this.operationInterrupt(),this.switchMode("template"),this.doInsertTemplate(e),this.updateView()),[2]}))}))},e.prototype.doInsertTemplate=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a;return D(this,(function(s){switch(s.label){case 0:return e?(t=e.dataId,n=e.coverId,i=e.width,r=e.height,t?[3,1]:(this.addToast("模板数据读取失败"),this.switchToPrevXmode(),[3,4])):[2];case 1:return[4,this.templateManager.getTemplateData(t)];case 2:return o=s.sent(),[4,this.getFileInfo(n)];case 3:a=s.sent().url,this.templateCtrl.onInsertTemplate(o,a,i,r),s.label=4;case 4:return[2]}}))}))},e.prototype.connectServer=function(){return A(this,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,l,c,u=this;return D(this,(function(d){switch(d.label){case 0:e=this.userManager.enableIncrementalUpdate,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this.getServerUrl()];case 2:return t=d.sent(),n=this.boardQueryObj,i=n.crypto,r=n.appId,o=n.recordId,this._recordId=null!=o?o:"",a="1"===i?AU("".concat(r,"_").concat(o)):void 0,l=new Bd(this,{url:t,crypto:a,refreshUrl:this.getServerUrl,onconnected:function(){u.syncStart(),u.onReady()},onforcereconnect:function(){e=!1},onClosed:function(){var t;clearTimeout(s),clearTimeout(u.syncFinishedTimer),u.syncingToastId&&u.removeToast(u.syncingToastId),null!==u._reconnectToastId||l.destroyed||(u._reconnectToastId=u.addToast(O("network.reconnect.start"),{type:"normal",autoHide:!1,removedCB:function(){u._reconnectToastId=null}})),!1===e&&(u.operationInterrupt(),u.switchMode("hand"),u.setEditable(!1)),u.online=!1,u.userManager.onlineUsers=[],u.publish("sdkAction",{type:"usersEvent",payload:{otherUsers:[]}}),u.usersCursorsManager.stopSendCursorPostion(),u.usersCursorsManager.resetCursors(),u.meetingManager.reset(),u.timerManager.reserveFollowingStatus(),u.followManager.reset(),u.laserManager.reset(),null===(t=u.shareAssistantManager)||void 0===t||t.followAll()},onreconnected:function(){var t;u.syncStart(),null!==u._reconnectToastId&&u.removeToast(u._reconnectToastId),u.syncingToastId=u.addToast(O("network.reconnect.connected"),{type:"normal",autoHide:!1,removedCB:function(){u.syncingToastId=null}}),u.resetConnect(),!1===e&&(u.resetElementData(),null===(t=u.sdSocketClient)||void 0===t||t.forceReconnect(),e=u.userManager.enableIncrementalUpdate),s=window.setTimeout(u.onReady,2e3)}}),this.socketClient=l,this.socketClient.autoReconnect="visible"===document.visibilityState,[3,4];case 3:return c=d.sent(),this.addToast(O("network.reconnect.failed"),{type:"normal",autoHide:!1}),this.uiController.errorMesg=String(c),[3,4];case 4:return[2]}}))}))},e.prototype.connectShadowServer=function(){return A(this,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,l,c=this;return D(this,(function(u){switch(u.label){case 0:e={},t=function(){return A(c,void 0,void 0,(function(){var t,n,i,r,o,a,s;return D(this,(function(l){switch(l.label){case 0:if(!this.config.getShadowBoardQuery)throw new Error("getShadowBoardQuery is undefined");return[4,this.config.getShadowBoardQuery()];case 1:return(t=l.sent()).split("&").forEach((function(t){var n=t.split("="),i=n[0],r=n[1];e[i]=r})),[4,Nd("",{query:t}).result];case 2:if((n=l.sent()).code!==vd.OK)throw new Error("failed to retrieve shadow board ws server address");return i=n.obj,r=i.host,o=i.port,a=i.query,s=i.protocol,[2,"".concat((void 0===s?"wss":s)+"://"+r+":"+o,"?").concat(a)]}}))}))},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,t()];case 2:return n=u.sent(),i=e.crypto,r=e.appId,o=e.recordId,a="1"===i?AU("".concat(r,"_").concat(o)):void 0,l=function(){var e,t;null===(e=c.sdSocketClient)||void 0===e||e.sendControlCmd([1,c.localUserInfo.userName,"4.6.26",""]),null===(t=c.sdSocketClient)||void 0===t||t.sendControlCmd([21,-1])},this.sdSocketClient=new jq(this,{url:n,crypto:a,onconnected:l,onstartreconnect:function(){clearTimeout(s)},refreshUrl:t,onreconnected:function(){c.elementManager.clearShadowEles(),s=window.setTimeout(l,2e3)}}),this.sdSocketClient.autoReconnect="visible"===document.visibilityState,[3,4];case 3:return u.sent(),this.addToast(O("shadow.network.reconnect.failed"),{type:"normal"}),[3,4];case 4:return[2]}}))}))},e.prototype.resetConnect=function(){this.mediaPlayController.finishAll(),this.localViewerManager.finishAll(),this.pptPlayerManager.finishAll(),this.timerManager.resetData(),this.meetingManager.reset(),this.serverLocks=[],this.localLocks=[],this.view.locks=[],this.opManager.resetData(),this.websocketHelper.resetConnect()},e.prototype.resetElementData=function(){this.serverVersion=-1,this.maxZindex=0,this.minZindex=0,this.bigDocManager.resetData(),this.elementManager.resetData(),this.view.resetData(),this.clearFileHelperWidget(),this.websocketHelper.resetElementData(),this.unSyncedMarkPointLists=new Set,this.keyFramesLoaded=!1},e.prototype.clearSubserviceRequest=function(e){this.websocketHelper.clearSubserviceRequest(e)},e.prototype.lockXMode=function(e){this.xmodeLocked=e},e.prototype.switchMode=function(e){if(!this.xmodeLocked&&(this.editable||"none"===e||(this.userManager.commentOnlyMode||"commentor"===this.meetingMode)&&["hand","comment"].includes(e)||(e="hand"),e!==this.xmode)){this.prexmode=this.xmode,this.xmode=e;var t=this.view;switch(e){case"pick-single-element":case"hand":case"view":t.setCursor(Wd(),this);break;case"draw":t.setCursor("url(".concat($o("pen.png"),") 5 20, default"),this);break;case"eraser":t.setCursor("url(".concat($o("eraser_cursor.png"),") 8 18, default"),this);break;case"text":t.setCursor("text",this);break;case"comment":t.setCursor("url(".concat($o("mark_cursor.png"),") 12 22, default"),this);break;case"laser":t.setCursor(jd(),this);break;case"sticker":t.setCursor("url(".concat($o("sticker.png"),") 0 20, default"),this);break;case"frame":case"shape":case"connection-line":t.setCursor(Ud(),this);break;case"mind-map":t.setCursor("url(".concat($o("mind_map_cursor.png"),") 0 0, default"),this);break;case"table":t.setCursor("url(".concat($o("cursor_table.png"),") 2 4, default"),this);break;case"insert-webpage":t.setCursor("url(".concat($o("webpage.png"),") 2 4, default"),this);break;case"timer":t.setCursor("url(".concat($o("timer.png"),") 2 4, default"),this);break;case"kanban":t.setCursor("url(".concat($o("kanban.png"),") 2 4, default"),this);break;case"bigDoc":t.setCursor("url(".concat($o("bigdoc.png"),") 2 4, default"),this);break;default:t.setCursor("",this)}this.publish("xmodechange",e)}},e.prototype.switchShape=function(e){this.shapeType=e},e.prototype.log=function(){},e.prototype.error=function(){},e.prototype.showElement=function(e,t){var n;return void 0===t&&(t={}),A(this,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return[4,this.beforeMoveToElement(e)];case 1:return r.sent(),i=e.getGlobalBox(),Fu(e)&&e.isHideByFilter&&(i=(null===(n=e.pareantKanban)||void 0===n?void 0:n.getGlobalBox())||i,this.editable?this.addToast(O("kanban.setting.filter.tip")):this.addToast(O("kanban.setting.filter.noauth"))),t.extraTop&&(i=exports.E(exports.E({},i),{top:i.top-t.extraTop})),i=Sn(i,i.rotate||0),[2,this.viewCtrl.makeBorderCenter(i,t)]}}))}))},e.prototype.maximizeElement=function(e,t){void 0===t&&(t={});var n=(e.titleHeight||0)*e.scale*e.globalTransform.currentScale;return this.showElement(e,exports.E({left:8,right:8,top:8,bottom:8,extraTop:-n},t))},e.prototype.makeBorderCenter=function(e,t){return void 0===t&&(t={}),this.viewCtrl.makeBorderCenter(e,t)},e.prototype.makeBorderInSight=function(e,t){void 0===t&&(t={}),this.viewCtrl.makeBorderInSight(e,t)},e.prototype.makeBorderXInSight=function(e,t){this.viewCtrl.makeBorderXInSight(e,t)},e.prototype.makeBorderFixedSizeInSight=function(e,t){this.viewCtrl.makeBorderFixedSizeInSight(e,t)},e.prototype.getAllUsers=function(){return R([this.localUserInfo],this.userManager.onlineUsers,!0)},e.prototype.registerFrameCover=function(e,t,n){return this.elementManager.registerFrameCover(e,t,n)},e.prototype.insertNewFrame=function(e,t){this.followManager.stopFollowCurrent(),this.frameDrawer.insertFrame(e,t||this.elementManager.sequentialFrames[this.elementManager.sequentialFrames.length-1])},e.prototype.getRightMostElement=function(e){return this.elementManager.getRightMostElement(e)},e.prototype.getAllFrames=function(){return this.elementManager.getFrames()},e.prototype.createCommentService=function(e,t){return new TW(this,e,t)},e.prototype.saveComment=function(){var e=this.elementManager.getComments((function(e){return e.expanded&&e.dirty}));return e.length?(e.forEach((function(e){e.onFinishDraft(!0),e.expanded=!1})),this.updateView(),!0):!!this.commentCtrl.curUnsavedDraft&&(this.commentCtrl.onFinishDraft(),this.updateView(),!0)},e.prototype.collapseComments=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var n=this.elementManager.collapseComments(e,t);return n.forEach((function(e){return e.dealSelfOpenClose()})),n.length},e.prototype.getUserInfo=function(e){return this.userManager.getUser(e)},e.prototype.getCommentDestination=function(e){return this.elementManager.getCommentDestination(e)},e.prototype.expandComment=function(e){e.expanded||(!e.empty&&e.visible&&this.elementManager.openComment(e),e.dealSelfOpenClose())},e.prototype.getAllComments=function(e){return this.elementManager.getAllComments(e)},e.prototype.switchRightSlidePanel=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r;return D(this,(function(o){switch(o.label){case 0:return i=!0,this.rightSlidePanelGuard?[4,this.showWindow(this.rightSlidePanelGuard)]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return i&&(e===BW.extensionList?(r=n||(null==t?void 0:t.toolPanelProps),void 0===t||this.rightSlidePanelType===e&&this.currentCustomFoldableTool===t&&this.currentCustomFoldableTool.toolPanelProps===r?this.rightSlidePanelType=null:this.rightSlidePanelType=e,void 0!==t&&(t.toolPanelProps=r),this.currentCustomFoldableTool=t,this.publish("currentCustomFoldableToolUpdated",void 0)):this.rightSlidePanelType===e?this.rightSlidePanelType=null:this.rightSlidePanelType=e,this.clearRightSlidePanelGuard()),[2]}}))}))},e.prototype.switchRightSlideExtension=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){return t&&this.rightSlidePanelType===BW.extensionList&&this.currentCustomFoldableTool===e&&e.toolPanelProps===n?[2]:!0!==t?[2,this.switchRightSlidePanel(BW.extensionList,e,e.toolPanelProps)]:[2,this.switchRightSlidePanel(BW.extensionList,e,n)]}))}))},e.prototype.addRightSlidePanelGuard=function(e){this.rightSlidePanelGuard=e},e.prototype.clearRightSlidePanelGuard=function(){this.rightSlidePanelGuard=null},e.prototype.beforeMoveToElement=function(e){return A(this,void 0,void 0,(function(){var t=this;return D(this,(function(n){return[2,new Promise((function(n){var i=e.position;if(i.parentType!==Za.DOCUMENT){if(i.parentType===Za.VIDEO){a=i.parentId;var r=i.mediaTime,o=t.elementManager.getElementById(a);o&&o.setCurrentTime(r/1e3)}n()}else{var a=i.parentId,s=i.pageId,l=t.elementManager.getElementById(a);l&&l.turnPageTo(s,n)}}))]}))}))},e.prototype.slideViewToComment=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return(t=e.attached?this.elementManager.getElementById(e.attached):null)?[4,this.beforeMoveToElement(t)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,this.beforeMoveToElement(e)];case 3:a.sent(),a.label=4;case 4:return n=e.getGlobalPosition(),i=n.x,r=n.y,o=this.view.scale,[2,this.viewCtrl.slideViewTo(i-this.view.viewWidth/o/2,r-(this.view.viewHeight/2-230)/o,this.view.scale,{duration:500})]}}))}))},e.prototype.getTopmostCommentByPos=function(e){return this.selectController.getTopmostComment(e)},e.prototype.showAerialView=function(){var e=R(R([],this.elementManager.getAllElements(),!0),this.elementManager.getAllElements(),!0);if(!e.length)return Promise.resolve();var t=this.view,n=t.viewWidth,i=t.viewHeight,r=Yt(e.map((function(e){return e.getGlobalBox()})));if(qt(r,this.view.getViewbox()))return Promise.resolve();var o=r.right-r.left,a=r.bottom-r.top,s=100*n,l=100*i,c=(r.right+r.left)/2,u=(r.bottom+r.top)/2;return o>s&&(r.left=c-s/2,r.right=c+s/2),a>l&&(r.top=u-l/2,r.bottom=u+l/2),this.viewCtrl.makeBorderCenter(r,{duration:800})},e.prototype.startMeetingMode=function(e){var t;this.config.boardInBusyCB&&this.config.boardInBusyCB(((t={})[wt.InMeeting]=!0,t)),this.clearSelect(),this.switchMode("select"),this.currentCustomTool=void 0,this.standardPresentation&&this.endPresentation(),this.meetingMode=e,this.rightSlidePanelType=null,this.uiController.openLeftSide(!1),this.uiController.openRightSide(!1),this.uiController.openRightSubSlide(!1)},e.prototype.updateMeetingMode=function(e){this.meetingMode=e,this.setEditable("editor"===e),this.editable?this.switchMode("select"):this.switchMode("hand"),this.currentCustomTool=void 0},e.prototype.addPluginPerm=function(e){this.pluginManager.addPerm(e),this.setEditable(this.pluginManager.editable),this.editable?this.switchMode("select"):this.switchMode("hand")},e.prototype.removePluginPerm=function(e){var t=this.pluginManager.curPerm();this.pluginManager.removePerm(e),(null==t?void 0:t.pluginId)===e&&(this.pluginManager.curPerm()?(this.setEditable(this.pluginManager.editable),this.editable?this.switchMode("select"):this.switchMode("hand")):(this.setEditable(this.userManager.editable&&this.online),this.switchMode(this.online&&this.userManager.editable?"select":"hand")))},e.prototype.endMeetingMode=function(e,t){var n,i,r;null!=this.meetingMode&&(this.config.boardInBusyCB&&this.config.boardInBusyCB(((n={})[wt.InMeeting]=!1,n)),this.meetingManager.onLeaveMeeting(e),this.meetingMode=null,this.online&&(this.setEditable(this.userManager.editable),this.switchMode(this.userManager.editable?"select":"hand")),null===(r=null===(i=this.config.meetingConfigs)||void 0===i?void 0:i.didLeaveMeeting)||void 0===r||r.call(i,t),this.currentCustomTool=void 0,this.closePhoneDrawer())},Object.defineProperty(e.prototype,"curMeetingChannel",{get:function(){return this.meetingManager.meetingChannel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceHelpLink",{get:function(){return this.config.deviceHelpLink},enumerable:!1,configurable:!0}),e.prototype.getCurServerTime=function(){return this.websocketHelper.getCurServerTime()},e.prototype.archiveSelectedElements=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,this.handleCustomTemplateModal(!1)];case 1:return(e=n.sent())?[4,this.getBoardMngServiceToken()]:[2];case 2:return t=n.sent(),[4,this.templateManager.saveTemplate(t,!1,e)];case 3:return n.sent(),this.addToast(O("template.save.success"),{type:"normal"}),[3,5];case 4:return n.sent(),this.addToast(O("template.save.fail"),{type:"normal"}),[3,5];case 5:return[2]}}))}))},e.prototype.handleCustomTemplateModal=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return this.config.handleCustomTemplateModal?[4,this.templateManager.getTemplateCover(e)]:[3,3];case 1:return t=n.sent(),[4,this.config.handleCustomTemplateModal(t)];case 2:return[2,n.sent()];case 3:return[2,null]}}))}))},e.prototype.handleClickCustomTemplate=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),0===this.elementManager.getAllElements().length?(this.addToast(O("template.save.empty")),[2]):[4,this.handleCustomTemplateModal(!0)];case 1:return(e=n.sent())?[4,this.getBoardMngServiceToken()]:[2];case 2:return t=n.sent(),[4,this.templateManager.saveTemplate(t,!0,e)];case 3:return n.sent(),this.addToast(O("template.save.success"),{type:"normal"}),[3,5];case 4:return n.sent(),this.addToast(O("template.save.fail"),{type:"normal"}),[3,5];case 5:return[2]}}))}))},e.prototype.saveTemplateInTemplateMode=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:return[4,this.getBoardMngServiceToken()];case 1:return t=o.sent(),n=this.customTemplate,i=n.sdkTemplateRecordId,r=n.boardId,[4,this.templateManager.saveTemplate(t,!0,exports.E({sdkTemplateRecordId:i,boardId:r},e))];case 2:return[2,o.sent()]}}))}))},Object.defineProperty(e.prototype,"getMentionCandidate",{get:function(){return this.config.getMentionCandidate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getMentionGroupAndCandidate",{get:function(){return this.config.getMentionGroupAndCandidate},enumerable:!1,configurable:!0}),e.prototype.getAllUsersInMention=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return e=[],this.getMentionCandidate?[4,this.getMentionCandidate()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return this.getMentionGroupAndCandidate?[4,this.getMentionGroupAndCandidate()]:[3,4];case 3:e=t.sent().users,t.label=4;case 4:return[2,e]}}))}))},e.prototype.selectAllAvailableEles=function(){this.clearSelect();var e=this.view.viewClip;if(e){var t=Bt(e.rect),n=this.selectController.selectElementsInBorder(t,{selectCross:!0});return n.forEach((function(e){return e.showSelected=!1})),void(n.length&&this.selectElements(n))}var i=R(R([],this.elementManager.getAvailableElements((function(e){return(e.elementType!==Za.STICKER||!e.hideForPrivate())&&(e.elementType!==Za.CARD||!e.kanbanId)&&(e.elementType!==Za.MINDMAP_NODE||!e.isMindmapNodeHideByCollapsed)&&e.elementType!==Za.GRID_TEXT&&e.mounted&&!e.stable&&!e.frozedGroup})),!0),this.elementManager.getAvailableFrames((function(e){return!e.frozedGroup&&!e.stable})),!0);i.length&&this.selectElements(i)},e.prototype.cloneSelectedEles=function(){this.editable&&this.selectController.cloneSelectedEles()},e.prototype.getCurrentPenType=function(){return this.lineDrawer.penType},e.prototype.setCurPenType=function(e){this.lineDrawer.penType=e},e.prototype.getDrawPens=function(){return this.lineDrawer.pens},e.prototype.setPenStyles=function(e,t,n){this.lineDrawer.setPenStyles(e,t,n)},e.prototype.setDraftCommentColor=function(e){this.commentCtrl.setDraftCommentColor(e)},e.prototype.getDrawPenTypeIndex=function(e){return this.lineDrawer.curPenTypeIndex[e]},e.prototype.setDrawPenTypeIndex=function(e,t){this.lineDrawer.setCurPenTypeIndex(e,t)},Object.defineProperty(e.prototype,"previewExternalFile",{get:function(){return this.config.onPreviewExternalFile},enumerable:!1,configurable:!0}),e.prototype.createCommentOnElement=function(e,t){this.commentCtrl.createCommentOnElement(e,t)},e.prototype.hideAllControls=function(e){this.hideControls=e,this.publish("hideAllCtrlUI",e)},e.prototype.createFrameFromElements=function(e){this.frameDrawer.createFrameFromElements(e)},e.prototype.showLastEditElement=function(){var e=this,t=0,n=null;if(this.elementManager.getAllElements().forEach((function(i){if(!i.deleted){var r=e.elementInfoMap.get(i.id);r&&r.updateTime>t&&(n=i,t=r.updateTime)}})),n){var i=Lt(n.getBorderBox()),r=i.x,o=i.y,a={left:r-this.view.viewWidth/2,right:r+this.view.viewWidth/2,top:o-this.view.viewHeight/2,bottom:o+this.view.viewHeight/2};this.viewCtrl.makeBorderCenter(a,{duration:500})}},e.prototype.downloadOssFile=function(e,t,n,i,r){var o;return void 0===n&&(n=!1),A(this,void 0,void 0,(function(){var a,s;return D(this,(function(l){switch(l.label){case 0:return[4,this.fileHelper.getFileDownloadUrl(e,t,n)];case 1:return a=l.sent(),!_e.desktop&&n?(null===(o=this.previewExternalFile)||void 0===o||o.call(this,{name:t,fileId:e,ext:a.fileType,width:i.width/r,height:i.height/r},a.downloadUrl),[2]):((s=document.createElement("a")).href=a.downloadUrl,_e.desktop?s.target="_blank":s.target="_self",s.click(),[2])}}))}))},e.prototype.downloadOssFilesByZip=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){switch(i.label){case 0:return[4,this.fileHelper.getFilesZipDownloadUrl(e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.updateViewGridType=function(e){this.view.viewGridType=e,this.updateView()},e.prototype.enableViewPicker=function(e,t,n){void 0===n&&(n=!0),n&&this.switchMode("picking-view"),this.viewPickWidget||(this.viewPickWidget=new YG(this,e,t),this.view.addAssistWidget(this.viewPickWidget),this.hideAllControls(!0))},e.prototype.disableViewPicker=function(){this.viewPickWidget&&(this.viewPickWidget.onDestroy(),this.view.removeAssistWidget(this.viewPickWidget),this.viewPickWidget=null,this.hideAllControls(!1))},e.prototype.onPickingBoardView=function(){var e=this,t=this.view,n=t.viewWidth,i=t.viewHeight,r=t.scale,o={width:.67*n/r,height:.72*i/r},a=this.view.getAbsolutePosition({x:.33*n/2,y:.28*i/2});return this.enableViewPicker(o,a),this.showWindow(QG,{viewPicker:this.viewPickWidget,finishSideEffect:function(){return e.switchToPrevXmode()},upime:this},!0)},e.prototype.switchToPrevXmode=function(){this.switchMode(this.prexmode)},e.prototype.insertTextAt=function(e,t){return this.textController.insertText(e,t)},e.prototype.insertStickerAt=function(e,t,n){return this.stickerCtrl.insertSticker({position:e},t,n)},e.prototype.insertCommentAt=function(e){this.commentCtrl.insertComment(e)},e.prototype.insertWebpageAt=function(e,t){this.webpageCtrl.insertWebpage(e,t)},e.prototype.enableColorPickerPopup=function(e){return this.showWindow(qb,e,!0)},e.prototype.setTableInsertDimensions=function(e,t){this.tableCtrl.setTableInsertDimensions(e,t)},e.prototype.forceUpdateLockBox=function(e){for(var t=0,n=this.view.locks;t<n.length;t++){var i=n[t];if(i.ids.includes(e)){i.updateBorderBox();break}}},e.prototype.slideViewTo=function(e,t,n,i){this.viewCtrl.slideViewTo(e,t,n,{duration:i})},e.prototype.checkFocusTableCell=function(){var e=this.selectController.currentEditor;return e&&e instanceof FR&&e.element.focusingCell?e.element:null},e.prototype.onReadClipboard=function(e){return this.copyPasteCtrl.readFromClipboard(e)},e.prototype.enableFileHelperWidget=function(e){if(e.elementType===Za.VIDEO||e.elementType===Za.AUDIO||e.elementType===Za.DOCUMENT){if(this.clearFileHelperWidget(),e.elementType===Za.DOCUMENT){var t=e;this._fileHelperWidget=new kM(t),5===t.fileType&&t.startPreview()}else this._fileHelperWidget=new JG(e);this.view.addDomWidget(this._fileHelperWidget),this.updateView()}},e.prototype.clearFileHelperWidget=function(){this._fileHelperWidget&&(this.view.removeDomWidget(this._fileHelperWidget),this._fileHelperWidget=null)},e.prototype.clearDocumentFileHelper=function(){this._fileHelperWidget&&this._fileHelperWidget instanceof kM&&(this.view.removeDomWidget(this._fileHelperWidget),this._fileHelperWidget=null)},e.prototype.waitAck=function(e,t){this.websocketHelper.waitAck(e,t)},e.prototype.unWaitAck=function(e,t){this.websocketHelper.unWaitAck(e,t)},e.prototype.setLeftSideBarType=function(e){this.leftSideBarType=e},e.prototype.nextTick=function(e){return this.view.nextTick(e)},e.prototype.closePhoneDrawer=function(){return this.uiController.closePhoneDrawer()},e.prototype.getPhoneDrawer=function(){return this.uiController.getPhoneDrawer()},e.prototype.startUserGuide=function(e){return this.uiController.startUserGuide(e)},e.prototype.readClipboardDataFromClipboardEvent=function(e){return this.copyPasteCtrl.readClipboardDataFromClipboardEvent(e)},e.prototype.destroy=function(){var e,t;null===(e=this.socketClient)||void 0===e||e.destroy(),null===(t=this.sdSocketClient)||void 0===t||t.destroy(),this.controllers.forEach((function(e){return e.destroy()})),this.elementManager.destroy(),this.framesListManager.destroy(),this.clearMainHotKeys(),this.usersCursorsManager.destroy(),this.commentManager.destroy(),this.meetingManager.destroy(),this.followManager.destroy(),this.laserManager.destroy(),this.historyManager.destroy(),window._board_debugger_===this._board_debugger_&&(window._board_debugger_=void 0),this.plugins.forEach((function(e){return e.destroy()})),this.view.destroy()},e.prototype.setMindmapInsertType=function(e,t,n){this.mindMapController.setDefaultInsertState(e,t,n)},e.prototype.getCurrentStickerStyle=function(){return this.stickerCtrl.getCurrentStyle()},e.prototype.insertMindmapAt=function(e,t){return this.mindMapController.insertMindMap({position:e},t)},e.prototype.toggleSelectAndViewMode=function(e){if(e)return"view"===e&&this.editable&&this.switchMode("view"),void("select"===e&&this.switchMode("select"));"select"===this.xmode&&this.editable?this.switchMode("view"):this.switchMode("select")},e.prototype.getInitCardColor=function(){return this.cardCtrl.color},e.prototype.setInitCardColor=function(e){this.cardCtrl.color=e},e.prototype.findFrame=function(e,t){return this.kanbanCtrl.findFrame(e,t)},e.prototype.getFileToken=function(){return this.fileHelper.getFileToken()},e.prototype.loadSdkPlugin=function(e,t,n){var i=new e(this);return null==t||t(i),i.init(n),this.plugins.push(i),i},e.prototype.getSdkPlugin=function(e){return this.plugins.find((function(t){return t.pluginId===e}))},e.prototype.startPickElement=function(e,t){var n=this;this.toggleSinglePickMode(!0),t&&(this.selectController.singlePickFilter=t);var i=!1,r=this.subscribe("singleElementPicked",(function(t){!0===e(t)||(i=!0,n.toggleSinglePickMode(!1),r())}));return function(){i||(n.toggleSinglePickMode(!1),r())}},e.prototype.getFrameContent=function(e){return{info:this.copyPasteCtrl.getElementsData([e],{align:"topLeft"}).info,size:e.size,frameId:e.id}},e.prototype.export2Excel=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){return t=this.copyPasteCtrl.getElementsData([e],{align:"topLeft"}).info,this.fileHelper.exportTable2Excel(t,e.name),[2]}))}))},e.prototype.exportFrame2Ppt=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.fileHelper.exportFrame2Ppt(e,t)];case 1:return n.sent(),[2]}}))}))},e.prototype.insertFrameContent=function(e,t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),A(this,void 0,void 0,(function(){var r,o,a;return D(this,(function(s){switch(s.label){case 0:return[4,this.copyPasteCtrl.useEleInfo(e,t,{autoSelect:n,scaleView:i})];case 1:for(r=s.sent(),a=0;a<r.length;a++)if(r[a].elementType===Za.FRAME){o=r[a];break}return[2,[o,r]]}}))}))},e.prototype.calcEmptyFrameArea=function(e){return this.frameDrawer.calcEmptyFrameArea(e)},e.prototype.setViewClip=function(e){this.view.viewClip=e,this.view.update()},e.prototype.clearViewClip=function(){this.view.viewClip=null,this.view.update()},e.prototype.addViewSection=function(e){this.view.viewSections.includes(e)||this.view.viewSections.push(e),this.view.update()},e.prototype.removeViewSection=function(e){this.view.viewSections=this.view.viewSections.filter((function(t){return t!==e})),this.view.update()},e.prototype.clearViewSection=function(){this.view.viewSections=[],this.view.update()},e.prototype.createSubService=function(e,t,n){return new e(this,t,n)},e.prototype.dealWaterMark=function(){var e=this;if(this.config.watermarkSettings){var t=this.config.watermarkSettings,n=t.text,i=t.isGlobal,r=t.affectExport,o=tr("data:image/svg+xml,"+encodeURIComponent(function(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg"),i=document.createElementNS(e,"text"),r=-15*Math.PI/180,o=document.createElement("span");o.textContent=n,o.style.fontSize="".concat(12,"px"),o.style.lineHeight="".concat(15,"px"),o.style.fontFamily="sans-serif",o.style.position="absolute",o.style.opacity="0",document.body.appendChild(o);var a=o.offsetWidth,s=o.offsetHeight;document.body.removeChild(o);var l=Math.abs(a*Math.cos(r))+Math.abs(s*Math.sin(r))+100,c=Math.abs(a*Math.sin(r))+Math.abs(s*Math.cos(r))+100;return t.setAttribute("width",l+"px"),t.setAttribute("height",c+"px"),t.setAttribute("xmlns",e),t.setAttribute("viewBox","0 0 ".concat(Math.ceil(l)," ").concat(Math.ceil(c))),i.textContent=n,i.setAttribute("font-size","".concat(12,"px")),i.setAttribute("line-height","".concat(15,"px")),i.setAttribute("fill","rgba(0, 0, 0, 0.1)"),i.setAttribute("text-anchor","middle"),i.setAttribute("x",l/2+"px"),i.setAttribute("y",c/2+"px"),i.setAttribute("transform","rotate(".concat(-15," ").concat(l/2," ").concat(c/2,")")),t.appendChild(i),t}().outerHTML));er(o,(function(){e.watermark={src:o,isGlobal:null==i||i,affectExport:null==r||r},e.view.update()}))}},e.prototype.exportPdfFromDocumentElement=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return(n=this.elementManager.getElementById(e))?[4,new cm(this).exportPdfFromDocumentElement(n,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype.getElementsMetaData=function(){return this.elementManager.getAllElements().map((function(e){return{id:e.id,elementType:e.elementType,position:{x:e.position.x,y:e.position.y},size:{width:e.size.width,height:e.size.height+(e.elementType===Za.DOCUMENT?e.titleHeight:0)},scale:e.scale}}))},Object.defineProperty(e.prototype,"displayedViewScale",{get:function(){return this.viewCtrl.displayedViewScale},enumerable:!1,configurable:!0}),e.prototype.setViewRect=function(e,t){void 0===t&&(t=!1),this.viewCtrl.setViewRect(e,t)},e.prototype.setViewPosScale=function(e,t,n){this.viewCtrl.setViewPosScale(e,t,n)},e.prototype.focusBorderBox=function(e){return this.followManager.forcedFollowing?(this.clearFocusedBorderBox(),2):(this.followManager.followingUser&&this.followManager.stopFollowCurrent(),this.viewCtrl.adaptFocusBorderBox(e))},e.prototype.clearFocusedBorderBox=function(){this.viewCtrl.clearFocusedBorderBox()},e.prototype.getCandidate=function(){var e=this,t=this.getMentionCandidate||this.getMentionGroupAndCandidate;null==t||t().then((function(t){return e.candidateListCache=t}))},e.prototype.addShare=function(e,t){var n=this;if(this.shareSharerManager&&this.shareSharerManager.shareId!=e)throw new Error("shareId is not match");if(this.shareAssistantManager)throw new Error("投屏助手不可投屏");this.shareSharerManager||(this.shareSharerManager=new Xq(this,e,(function(){n.shareSharerManager=void 0,t()})),this.shareSharerManager.join())},e.prototype.stopShare=function(){var e;null===(e=this.shareSharerManager)||void 0===e||e.stopShare()},e.prototype.requestShadowUserViewData=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return this.sdSocketClient?[2,this.sdSocketClient.requestUserViewOnce(e)]:[2,null]}))}))},e.prototype.getGraphicLib=function(){return this.graphicCtrl.getGraphicLib()},e.prototype.getGraphicLibSync=function(){return this.graphicCtrl.getGraphicLibSync()},e.prototype.getGraphicColorByCategory=function(e){return this.graphicCtrl.getGraphicColorByCategory(e)},e.prototype.setGraphicColorByCategory=function(e,t){return this.graphicCtrl.setGraphicColorByCategory(e,t)},e.prototype.getGraphicStyleByCategory=function(e){return this.graphicCtrl.getGraphicStyleByCategory(e)},e.prototype.setGraphicStyleByCategory=function(e,t){return this.graphicCtrl.setGraphicStyleByCategory(e,t)},e.prototype.getGraphicLastColorByCategory=function(e){return this.graphicCtrl.getGraphicLastColorByCategory(e)},e.prototype.setGraphicLastColorByCategory=function(e,t){this.graphicCtrl.setGraphicLastColorByCategory(e,t)},e.prototype.forceFollowUser=function(e){var t=e.loginName,n=e.connectId,i=e.forceFollowHintMsg,r=this.userManager.getUser(t);this.mainScene.enableForceFollow(i),this.mainScene.startFollowOther(r,{connId:n})},e.prototype.stopCurForceFollowing=function(){this.mainScene.disableForceFollow(),this.mainScene.stopFollowCurrent()},e.prototype.requestElesDataByRecordId=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l;return D(this,(function(c){switch(c.label){case 0:return[4,this.sendRequest(998,e)];case 1:return 1===(t=c.sent())[0]?[2,null]:(n=t[0],i=n[0],r=n[1],o=n[2],a=n[3],s=t[1],l={left:o,right:o+i,top:a,bottom:a+r},s.length?[2,{data:AU(this.boardQueryObj.appId).encrypt(JSON.stringify(s)),borderBox:l}]:[2,{data:"",borderBox:l}])}}))}))},e.prototype.useRawElesData=function(e,t,n){if(!e)return!1;var i=AU(this.boardQueryObj.appId);try{var r=JSON.parse(i.decrypt(e));if(!Array.isArray(r))throw new Error;var o=n.x-t.left,a=n.y-t.top;return this.copyPasteCtrl.useRawElesData(r,{x:o,y:a}),!0}catch(e){return!1}},e.prototype.getLang=function(){return this.config.lang},e.prototype.insertBigDocAt=function(e,t){return this.bigDocManager.insertBigDocAt(e,t)},e.prototype.getAICount=function(){var e;return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,null===(e=this.chatgptConfig)||void 0===e?void 0:e.preCheckCredits()];case 1:return[2,t.sent()]}}))}))},e.prototype.freshAiCount=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.getAICount()];case 1:return(e=t.sent())&&(this.aiCountInPackage=e.inPackageRemain,this.aiCountOutPackage=e.outPackageRemain),[2,e]}}))}))},e.prototype.minusCurrentAiCount=function(e){void 0===e&&(e=1);var t=this.aiCountInPackage,n=this.aiCountOutPackage;if(t+n<e)return!1;var i=Math.min(t,e);return t-=i,n-=e-i,this.aiCountInPackage=t,this.aiCountOutPackage=n,!0},M([rl],e.prototype,"online",void 0),M([rl],e.prototype,"xmode",void 0),M([rl],e.prototype,"editable",void 0),M([rl],e.prototype,"viewLocked",void 0),M([rl],e.prototype,"currentCustomTool",void 0),M([rl],e.prototype,"currentCustomFoldableTool",void 0),M([rl],e.prototype,"exportImageDrawer",void 0),M([rl],e.prototype,"exportingPdf",void 0),M([rl],e.prototype,"leftSideBarType",void 0),M([rl],e.prototype,"standardPresentation",void 0),M([rl],e.prototype,"meetingPresentation",void 0),M([rl],e.prototype,"screenPlayMode",void 0),M([rl],e.prototype,"fullscreenMode",void 0),M([rl],e.prototype,"hideToolbar",void 0),M([rl],e.prototype,"hideControls",void 0),M([rl],e.prototype,"rightSlidePanelType",void 0),M([rl],e.prototype,"rightSlidePanelGuard",void 0),M([rl],e.prototype,"meetingMode",void 0),M([rl],e.prototype,"curRtcChannel",void 0),M([rl],e.prototype,"frameExporters",void 0),M([rl],e.prototype,"filesZipDownloaders",void 0),M([rl],e.prototype,"t_timerActive",void 0),M([rl],e.prototype,"isUsingAi",void 0),M([rl],e.prototype,"mentionListOpenedPhone",void 0),M([rl],e.prototype,"titleBarMinWidth",void 0),M([rl],e.prototype,"titleBarCanExpand",void 0),M([rl],e.prototype,"customFoldableTools",void 0),M([rl],e.prototype,"customBottomRightTools",void 0),M([rl],e.prototype,"videoGuide",void 0),M([rl],e.prototype,"aiCountInPackage",void 0),M([rl],e.prototype,"aiCountOutPackage",void 0),M([rl],e.prototype,"latestUsedTool",void 0),M([il],e)}(),eK={iconWrap:"iconWrap_3GEPj",rotate90:"rotate90_1DR1n",disable:"disable_1lzsx",iconWrapActive:"iconWrapActive_28duN",forceColor:"forceColor_2oSMi",toolbar:"toolbar_1Y3X_",simpleToolbar:"simpleToolbar_3QPoQ",toolCenter:"toolCenter_Pw7tw",horizMode:"horizMode_2W6cT",selectTool:"selectTool_1NBmR",moreApps:"moreApps_4PfYv",moreAppBtnCon:"moreAppBtnCon_38AtV",tool:"tool_2bEen",toolbarBottomWrap:"toolbarBottomWrap_2tfDT",toolbarBottomVerticalMode:"toolbarBottomVerticalMode_2S8ht",toolbarBottomHorizontalMode:"toolbarBottomHorizontalMode_3BjBb",moreAppBtnConDisable:"moreAppBtnConDisable_1bD2p",moreAppHorizMode:"moreAppHorizMode_3f3dE",waiting:"waiting_2-djy",active:"active_385f2",toolCenterHorizMode:"toolCenterHorizMode_RgNkQ",shortcutContainer:"shortcutContainer_3J1vW",shortcutBox:"shortcutBox_FMnYP",dragableWrapper:"dragableWrapper_X-HBJ",dragHorizMode:"dragHorizMode_1dj5f",fakeIcon:"fakeIcon_3xaPw",ani:"ani_IKyBk",draggingIconContainer:"draggingIconContainer_UHpoY",penItemEditWrapper:"penItemEditWrapper_2pFCr",penItemEditWrapperVerMode:"penItemEditWrapperVerMode_x2Xsy",penItemEditContainer:"penItemEditContainer_1IkQ5",penItemEditContainerVerMode:"penItemEditContainerVerMode_3gZAK",penItemOutter:"penItemOutter_1Jf2h",selectedTipIcon:"selectedTipIcon_Op2va"},tK="pannel_25jDo",nK="iconWrap_2Unj9",iK="divider_BTNNe",rK="icon_3ZJpa",oK="item_18TMg",aK="type_bLowo",sK="active_ZAwwb",lK="widthPannel_1M8IU",cK="tickSliderContainer_33qP-",uK="tickSlider_3cJdB",dK="sliderValue_2BFB2",pK="colorPalette_27jhk",hK=e.createContext({}),fK=e.createContext({}),mK=e.createContext({}),vK=_e.isTouchSupported?8:4,gK=function(t,n,i,r){var o=e.useRef(null),a=e.useRef({connected:!1,initPos:{x:0,y:0}}),s=function(e){var n=a.current;if(n.connected){var o=n.initPos;if(Math.sqrt(Math.pow(e.pageX-o.x,2)+Math.pow(e.pageY-o.y,2))>=vK){i(e,t.view.getAbsolutePosition({x:e.pageX,y:e.pageY})),n.connected=!1,r();var l=function(){document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",l),setTimeout((function(){return t.clearDirectMoveTarget()}))};document.addEventListener("pointerup",l)}}},l=function(e){var n=a.current;if(n.connected)if(1===e.touches.length){var s=n.initPos,c=e.touches[0];if(Math.sqrt(Math.pow(c.pageX-s.x,2)+Math.pow(c.pageY-s.y,2))>=vK){i(e,t.view.getAbsolutePosition({x:c.pageX,y:c.pageY})),n.connected=!1;var u=o.current;u&&(u.style.display="none");var d=function(){r(),document.removeEventListener("touchmove",l),document.removeEventListener("touchend",d),setTimeout((function(){return t.clearDirectMoveTarget()}))};document.addEventListener("touchend",d)}}else n.connected=!1};return e.useEffect((function(){_e.isTouchSupported?document.addEventListener("touchmove",l):document.addEventListener("pointermove",s)}),[]),{rootRef:o,dragData:a,handlePointerDown:function(e,t){a.current={connected:!0,initPos:{x:e.pageX,y:e.pageY}},n(t)},handleTouchStart:function(e,t){1===e.touches.length&&(a.current={connected:!0,initPos:{x:e.touches[0].pageX,y:e.touches[0].pageY}},n(t))}}},yK=[{type:Ka.RECT,name:"矩形",icon:"juxing"},{type:Ka.ROUNDRECT,name:"圆角矩形",icon:"yuanjiaojuxing"},{type:Ka.ELLIPSE,name:"椭圆",icon:"yuanxing"},{type:Ka.TRIANGLE,name:"三角形",icon:"sanjiaoxing"},{type:Ka.DIAMOND,name:"菱形",icon:"lingxing"},{type:Ka.PARALLELOGRAM,name:"平行四边形",icon:"pinghangsibianxing"},{type:Ka.BIG_RIGHT_ARROW,name:"大箭头",icon:"dajiantou"},{type:Ka.BARREL,name:"数据库",icon:"shujuku"},{type:Ka.DOCUMENT,name:"文档",icon:"wendang"}],bK="zhixianjiantou",EK=_e.desktop?12:15,xK=120/EK,wK=Math.max(2,window.devicePixelRatio),CK=e.forwardRef((function(t,n){var i=t.indexes,r=W().getUpimeTrans,o=e.useState({});o[0];var a=o[1];return e.useImperativeHandle(n,(function(){return{refresh:function(){return a({})}}})),e.createElement("div",{className:"hint_27GTW"},e.createElement("span",null,r("common.insert")),e.createElement("span",null,"".concat(i.current[0]," x ").concat(i.current[1])),e.createElement("span",null,r("table.label")))}));!function(e){e[e.Data=1]="Data"}(Zq||(Zq={}));var SK=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e[0];if(t===Zq.Data)return{type:t,elemInfo:e[1]}},t.prototype.empty=function(){},t}(Sp),kK=function(){function e(e){this.upime=e,this.elemInfoList=[],this.userElementsMap=new Map,this.uploadSubService=e.createSubService(SK,16,this),this.uploadSubService.open()}return e.prototype.handleCmd=function(e){if(e.type===Zq.Data){var t=e.elemInfo;this.elemInfoList.push(t)}},e.prototype.layoutElements=function(){var e=this;if(0!==this.elemInfoList.length){this.elemInfoList.forEach((function(t){var n,i=t.elemId,r=e,o=r.upime,a=r.userElementsMap,s=o.getElementInfo(i),l=o.elementManager.getElementById(i);if(l){var c=s.creator.loginName;a.has(c)?null===(n=a.get(c))||void 0===n||n.push(l):a.set(c,[l])}}));var t=[],n=[];this.userElementsMap.forEach((function(e,i){e.forEach((function(e){e&&(e.elementType===Za.DOCUMENT||e.elementType===Za.IMAGE||e.elementType===Za.AUDIO||e.elementType===Za.VIDEO?t.push(e):e.elementType===Za.STICKER&&n.push(e))}))}));var i=this.upime.view.getViewbox(),r=this.upime.view.scale,o={x:(i.left+i.right)/2,y:(i.top+i.bottom)/2},a=t.length,s=n.length,l=Math.min(a,9);a>0?(o.x-=Op/r/2,o.y-=Fp/r/2):s>0&&(o.x-=108/r/2,o.y-=108/r/2),_K(t,n,o,this.upime,l,r);var c=R(R([],t,!0),n,!0),u=c.map((function(e){return e.getBorderBox()})),d=Yt(u),p=this.upime.view.viewClip;if(p){if(!qt(d,p.borderBox)){var h=function(e,t){var n=(t.right-t.left)/2,i=(t.bottom-t.top)/2,r=e.right-e.left,o=e.bottom-e.top,a=1;return r>n&&(o*=a=n/r),o>i&&(r*=a*=i/o),a}(d,p.borderBox),f={x:p.x+p.width/2,y:p.y+p.height/2};_K(t,n,f,this.upime,l,r,Math.min(h,1))}this.upime.makeBorderCenter(p.borderBox,{left:90,right:20,top:60,bottom:60})}else this.upime.makeBorderInSight(d,{left:90,right:20,top:60,bottom:60});this.upime.selectElements(c)}},e.prototype.destroy=function(){this.uploadSubService.close()},e}();function _K(e,t,n,i,r,o,a){void 0===a&&(a=1);var s=n;e.forEach((function(e,t){i.updateElement(e,{position:s,scale:e.scale*a}),s=(t+1)%9==0?{x:n.x,y:s.y+(Fp+20)*a/o}:{x:s.x+(Op+20)*a/o,y:s.y}})),s={x:n.x+r*((Op+20)*a/o),y:n.y},t.forEach((function(e,t){i.updateElement(e,{position:s,scale:e.scale*a}),s=(t+1)%9==0?{x:n.x+r*((Op+20)*a/o),y:s.y+133*a/o}:{x:s.x+128*a/o,y:s.y}}))}var TK,IK,PK,NK="PDF/Word/PPT/",MK={image:".jpg, .jpeg, .png, .gif, .bmp, .svg, .webp",file:".pdf, .doc, .docx, .xls, .xlsx, .csv, .ppt, .pptx, .jpg, .jpeg, .png, .gif, .bmp, .svg, .webp, .mp4, .mp3, .mov, .wav",ispringppt:".ppt, .pptx"};Ce===de.PRIVATE&&(MK.file=".pdf, .xls, .xlsx, .csv, .jpg, .jpeg, .png, .gif, .bmp, .svg, .webp, .mp4, .mp3, .mov, .wav",NK="PDF/"),function(e){e.NONE="none",e.SHAPES="shapes",e.UPLOAD="upload",e.STICKER="sticker",e.DRAW="draw",e.FRAME="frame",e.CONNECT_LINE="connect_line",e.TABLE="table",e.TIMER="timer",e.MINDMAP="mind_map",e.TEXT="text",e.COMMENT="comment"}(PK||(PK={}));var AK,DK,RK=((TK={})[PK.DRAW]=351,TK[PK.SHAPES]=220,TK[PK.STICKER]=544,TK[PK.UPLOAD]=355,TK[PK.FRAME]=148,TK[PK.CONNECT_LINE]=216,TK);!function(e){e.NONE="none",e.SELECT_VIEW="select_view",e.SHAPES="shapes",e.UPLOAD="upload",e.STICKER="sticker",e.DRAW="draw",e.FRAME="frame",e.CONNECT_LINE="connect_line",e.TABLE="table",e.TIMER="timer",e.MINDMAP="mind_map",e.COMMENT="comment",e.TEMPLATE="template",e.TEXT="text",e.PEN="pen",e.WEBPAGE="webpage",e.CUSTOMIZED_STICKER="customized_sticker",e.KANBAN="kanban",e.BIGDOC="bigdoc"}(AK||(AK={})),function(e){e.pen="10001",e.markPen="10002",e.smartPen="10003",e.eraser="10004",e.shape="10005"}(DK||(DK={}));var BK=((IK={})[DK.pen]=Ya.NORMAL,IK[DK.markPen]=Ya.MARK,IK[DK.smartPen]=Ya.SMART,IK),LK=new Map([[PK.SHAPES,function(t){var n=t.upime,i=t.close,r=W().getUpimeTrans;function o(e){_c("cv_shape_use",{shapeName:e})}var a=e.useContext(hK).switchShapeType,s=e.useRef(Ka.RECT),l=gK(n,(function(e){o(e.name),s.current=e.type}),(function(e,t){var i=s.current;a(i),u.current.connected=!1;var r=n.insertShapeAt(t,i,!1);n.setDirectMoveTarget(r),n.userEventManager.forceTriggerPressEvt(e instanceof MouseEvent?"mouse":"touch",e)||n.clearDirectMoveTarget()}),i),c=l.rootRef,u=l.dragData,d=l.handlePointerDown,p=l.handleTouchStart;return e.createElement("div",{className:j(tK,"shapePannel_19HX4"),style:{height:"".concat(n.userManager.enableGraphic?220:156,"px")},onClick:function(e){return e.stopPropagation()},ref:c},yK.map((function(t){return e.createElement("div",{key:t.name,className:"shape_3Ic52",onClick:function(){o(t.name),u.current.connected=!1,a(t.type),n.switchShape(t.type),i()},onPointerDown:function(e){return d(e,t)},onTouchStart:function(e){return p(e,t)}},e.createElement("div",{className:j(nK)},e.createElement(hl,{icon:t.icon})))})),n.userManager.enableGraphic&&e.createElement(e.Fragment,null,e.createElement("div",{className:"moreIconBtn_35upA",onClick:function(){var e=n.uiController.leftSideOpened,t=n.leftSideBarType;if(e&&t===Et.Graphic)return n.switchMode("select"),void i();n.toggleLeftPanel("graphic"),n.switchMode("select"),i()}},r("shape.panel.addmore")),e.createElement("div",{className:"moreIconBtnTip_3MfXC"},r("shape.panel.addmore.tip"))))}],[PK.UPLOAD,function(t){var n=t.upime,i=t.close,r=W().getUpimeTrans,o=e.useContext(hK).customizedUploader;function a(e){iU(MK[e],!0,(function(t){n.insertFiles(t,{ispringppt:"ispringppt"===e})})),i()}return e.createElement("div",{className:j(tK,"uploadFileTypeSeletor_29BDm"),onClick:function(e){return e.stopPropagation()}},_e.desktop&&e.createElement("div",{className:"explain_1DicM"},r("toolbar.upload.explain")),e.createElement("ul",null,e.createElement("li",{onClick:function(){_c("cv_upload_img"),a("image")}},e.createElement("h1",null,e.createElement(hl,{icon:"tupian",className:rK})," ",r("toolbar.upload.image")),e.createElement("p",null,r("toolbar.upload.supportType")+"JPEG/JPG/PNG/GIF")),e.createElement("li",{onClick:function(){_c("cv_upload_file"),a("file")}},e.createElement("h1",null,e.createElement(hl,{icon:"wenjian",className:rK})," ",r("toolbar.upload.file")),e.createElement("p",null,r("toolbar.upload.supportType")+NK+r("common.upload.auvi"))),o&&o.loaders&&e.createElement(e.Fragment,null,e.createElement("div",{className:iK}),o.loaders.map((function(t){var r=t.icon,a=t.mainText,s=t.desc,l=t.key;return e.createElement("li",{key:a,onClick:function(){n.uploadManager=new kK(n),o.onUploadTrigger(l,i,(function(){var e,t;null===(e=n.uploadManager)||void 0===e||e.layoutElements(),null===(t=n.uploadManager)||void 0===t||t.destroy(),n.uploadManager=null}))}},e.createElement("h1",null,e.createElement(hl,{icon:r,className:rK})," ",a),e.createElement("p",null,s))}))),n.userManager.dynamicPPT?e.createElement(e.Fragment,null,e.createElement("div",{className:iK}),e.createElement("li",{onClick:function(){_c("cv_upload_dynamicppt"),a("ispringppt")}},e.createElement("h1",null,e.createElement(hl,{icon:"dongtaippt",className:rK})," ",r("toolbar.upload.dongtaippt")),e.createElement("p",null,r("toolbar.upload.supportType")+r("toolbar.upload.dongtaippt.desc")))):null))}],[PK.STICKER,function(t){var n=t.upime,i=t.close,r=t.direction,o=void 0===r?"vertical":r;function a(e){_c("cv_stickynote_use",{color:pr(e)})}function s(e,t){void 0===t&&(t=!1),a(e),u.current.connected=!1,n.setStickerStyle({bgColor:e,isPrivate:t}),i()}var l=gK(n,(function(e){var t=e.color,i=e.isPrivate;a(t),n.setStickerStyle({bgColor:t,isPrivate:i})}),(function(e,t){u.current.connected=!1;var i=n.insertStickerAt(t,!1);n.setDirectMoveTarget(i),n.userEventManager.forceTriggerPressEvt(e instanceof MouseEvent?"mouse":"touch",e)||n.clearDirectMoveTarget()}),i),c=l.rootRef,u=l.dragData,d=l.handlePointerDown,p=l.handleTouchStart,h=W().getUpimeTrans;return e.createElement("div",{className:j(tK,"stickerPannel_197ds","horiz"===o&&"stickerPannelHorizMode_2vwOV"),onClick:function(e){return e.stopPropagation()},ref:c},Ge.map((function(t,n){var i=n===Ge.length-1;return e.createElement("div",{className:"colorPannel_3gD_9",key:t,onClick:s.bind(null,t,i),onPointerDown:function(e){return d(e,{color:t,isPrivate:i})},onTouchStart:function(e){return p(e,{color:t,isPrivate:i})}},n===Ge.length-1?e.createElement(Dl,{content:h("sticker.private.hovertip"),placement:"horiz"===o?"top":"right"},e.createElement("div",{className:oK,style:{backgroundColor:pr(t)}},e.createElement("div",{className:"private_icon_qMXi4",style:{backgroundImage:"url(".concat($o("private_sticker_icon.png"),")")}}))):e.createElement("div",{className:oK,style:{backgroundColor:pr(t)}}))})))}],[PK.DRAW,function(t){var n,i,r=t.upime,o=t.enablePanelPopupAutoHide,a=t.disablePanelPopupAutoHide,s=t.direction,l=void 0===s?"vertical":s,c=r.getCurrentPenType(),u=W().getUpimeTrans,d=e.useState(r.getDrawPens()[c]),p=d[0],h=d[1],f=e.useState(r.getDrawPenTypeIndex(r.getCurrentPenType())),m=f[0],v=f[1],g=e.useContext(hK).switchPenType,y=e.useState(!1),b=y[0],E=y[1],x=e.useState(p[m]),w=x[0],C=x[1],S=e.useRef(w);e.useEffect((function(){v(r.getDrawPenTypeIndex(r.getCurrentPenType())),h(R([],r.getDrawPens()[c],!0))}),[c]),e.useEffect((function(){r.setDrawLingStyle(p[m]),S.current=p[m],C(p[m])}),[p,c,m]);var k=e.useCallback((function(e){e!==m?(r.setDrawPenTypeIndex(c,e),v(e),C(exports.E({},r.getDrawPens()[c][m])),E(!1)):E(!b)}),[c,m,b]),_=e.useCallback((function(e){r.setPenStyles(c,m,{lineColor:e}),S.current.lineColor=e,C(exports.E({},S.current)),h(R([],r.getDrawPens()[c],!0))}),[c,m]),T=e.useCallback((function(e){var t=30*e;r.setPenStyles(c,m,{lineWidth:t}),S.current.lineWidth=t,h(R([],r.getDrawPens()[c],!0))}),[c,m]),I=e.useCallback((function(e){r.setPenStyles(c,m,{lineOpacity:e}),S.current.lineOpacity=e,h(R([],r.getDrawPens()[c],!0))}),[c,m]),P=function(e){null!==e&&_(e)};function N(e){_c("cv_pen_use",{type:e})}return e.createElement("div",{className:j(tK,"drawPannel_2cV-B","horiz"===l&&"drawPannelHorizMode_34VXK")},e.createElement("div",{className:j("drawTools_3BZgF")},e.createElement(Dl,{placement:"right",content:u("toolbar.pen")},e.createElement("div",{className:j(nK),onClick:function(e){e.stopPropagation(),g(Ya.NORMAL),N("pen")}},e.createElement(hl,{icon:"huabi",className:j(aK,"eraser"!==r.xmode&&"laser"!==r.xmode&&c===Ya.NORMAL&&sK)}))),e.createElement(Dl,{placement:"right",content:u("toolbar.markPen")},e.createElement("div",{className:j(nK),onClick:function(e){e.stopPropagation(),g(Ya.MARK),N("markPen")}},e.createElement(hl,{icon:"yingguangbi",className:j(aK,"eraser"!==r.xmode&&"laser"!==r.xmode&&c===Ya.MARK&&sK)}))),e.createElement(Dl,{placement:"right",content:u("toolbar.smartDraw")},e.createElement("div",{className:j(nK),onClick:function(e){e.stopPropagation(),g(Ya.SMART),N("smartdraw")}},e.createElement(hl,{icon:"zhinengtuhang",className:j(aK,"eraser"!==r.xmode&&"laser"!==r.xmode&&c===Ya.SMART&&sK)}))),e.createElement(Dl,{placement:"right",content:u("toolbar.xiangpica")},e.createElement("div",{className:j(nK),onClick:function(e){e.stopPropagation(),E(!1),r.switchMode("eraser"),N("xiangpica")}},e.createElement(hl,{icon:"xiangpica",className:j(aK,"eraser"===r.xmode&&sK)})))),"eraser"!==r.xmode&&"laser"!==r.xmode?e.createElement(e.Fragment,null,e.createElement("div",{className:iK}),e.createElement("div",{className:"penList_2cm5b",onClick:function(e){return e.stopPropagation()}},p.map((function(t){return e.createElement("div",{key:t.id,className:j("horiz"===l&&"penHorizMode_hmRk0",nK,m===t.id&&"iconWrapActive__31Js")},e.createElement("div",{className:j("penWrapper_dQkA6",m===t.id&&sK),onClick:k.bind(null,t.id)},e.createElement("div",{className:"pen_3WnXo",style:{backgroundColor:hr(t.lineColor,t.lineOpacity),width:"".concat(Math.max(1,.9*t.lineWidth),"px"),height:"".concat(Math.max(1,.9*t.lineWidth),"px")}},e.createElement("div",{className:"colorBorder_2bBCx"}))),m===t.id&&e.createElement(hl,{icon:"huabijiaobiao",className:j("selectedTipIcon_GNZzc")}))})))):null,b&&e.createElement("div",{className:j("propsList_2XjxD",Ml.show_scale,"horiz"===l?Ml.top:Ml.right,"horiz"===l&&"penDetailHorizMode_1ASVZ"),onClick:function(e){e.stopPropagation()}},e.createElement("div",{className:lK},e.createElement(nE,{defaultValue:w.lineWidth/28,key:"".concat(c,"_").concat(w.id),onChanged:T}),e.createElement("p",null,u("toolbar.lineWidth"))),c===Ya.MARK&&e.createElement("div",{className:j(cK)},e.createElement(bc,{className:uK,onChanged:I,defaultValue:null!==(n=w.lineOpacity)&&void 0!==n?n:.5}),e.createElement("span",null,u("element.opacity")),e.createElement("span",{className:dK},"".concat(100*(null!==(i=w.lineOpacity)&&void 0!==i?i:.5),"%"))),e.createElement(Yb,{colorPalettes:r.userManager.userPalette,onChanged:P,defaultValue:w.lineColor,colorPickerConfig:{closeSideEffect:o,openSideEffect:a,onColorPickerChange:P},className:pK,toggleParentAutoHide:function(e){e?o():a()}})))}],[PK.FRAME,function(t){var n=t.upime,i=t.close;function r(e){_c("cv_frame_use",{type:e})}var o=e.useRef("custom"),a=gK(n,(function(e){r(e),o.current=e}),(function(e,t){l.current.connected=!1;var i=n.insertFrameAt(o.current,t);n.setDirectMoveTarget(i),n.userEventManager.forceTriggerPressEvt(e instanceof MouseEvent?"mouse":"touch",e)||n.clearDirectMoveTarget()}),i),s=a.rootRef,l=a.dragData,c=a.handlePointerDown,u=a.handleTouchStart;return e.createElement("div",{ref:s},e.createElement(RM,{onSelectRatio:function(e){l.current.connected=!1,r(e),i(),"custom"!==e&&(n.insertNewFrame(e),n.switchMode("select"))},classNames:[tK],onPointerDown:c,onTouchStart:u}))}],[PK.CONNECT_LINE,function(t){var n=t.upime,i=t.close,r=t.refreshSrcCB,o=t.direction,a=function(e){var t={};switch(e){case 1:bK="zhixian-new",t={lineType:1,startArrow:0,endArrow:0};break;case 2:bK="zhixianjiantou",t={lineType:1,startArrow:0};break;case 3:bK="zhexian-new",t={lineType:2,startArrow:0};break;case 4:bK="quxianjiantou",t={lineType:3,startArrow:0};break;case 5:bK="fat-arrow",t={lineType:4,startArrow:0,endArrow:0}}1!==e&&5!==e&&0===n.curConnectionLineConfig.endArrow&&(t.endArrow=1),_c("cv_line_use",{type:bK}),n.updateConnectionLineConfig(t),null==r||r(),i()};return e.createElement("div",{className:j(tK,"connectLinePanel_2Hkc8","horiz"===o&&"connectLineHorizMode_3wKPD")},e.createElement("div",{className:j(nK),onClick:function(){return a(1)}},e.createElement(hl,{icon:"zhixian-new",className:oK})),e.createElement("div",{className:j(nK),onClick:function(){return a(2)}},e.createElement(hl,{icon:"zhixianjiantou",className:oK})),e.createElement("div",{className:j(nK),onClick:function(){return a(3)}},e.createElement(hl,{icon:"zhexian-new",className:oK})),e.createElement("div",{className:j(nK),onClick:function(){return a(4)}},e.createElement(hl,{icon:"quxianjiantou",className:oK})),e.createElement("div",{className:j(nK),onClick:function(){return a(5)}},e.createElement(hl,{icon:"fat-arrow",className:oK})))}],[PK.TABLE,function(t){var n=t.upime,i=t.close,r=e.useRef([1,1]),o=e.useRef(null),a=e.useRef({left:0,right:0,bottom:0,top:0}),s=e.useRef(null),l=e.useRef(null),c=e.useRef(!1);e.useEffect((function(){var e=setTimeout((function(){o.current&&(a.current=o.current.getBoundingClientRect(),e=null)}),500);return function(){e&&clearTimeout(e)}}),[]);var u=function(e,t){var n;if(Ot({x:e,y:t},a.current)){var i=Mn(1,Math.ceil((t-a.current.top-15)/EK),xK),o=Mn(1,Math.ceil((e-a.current.left-15)/EK),xK),s=r.current,c=s[0],u=s[1];c===i&&u===o||(r.current=[i,o],d(),null===(n=l.current)||void 0===n||n.refresh())}},d=function(){var e=s.current;if(e){e.save(),e.scale(wK,wK),e.clearRect(0,0,120,120),e.lineWidth=1,e.strokeStyle="#cccccc",e.clearRect(0,0,120,120),e.beginPath();for(var t=0;t<=120;t+=EK)e.moveTo(0,t),e.lineTo(120,t),e.moveTo(t,0),e.lineTo(t,120);e.stroke(),e.beginPath(),e.strokeStyle="#2E73E5";var n=r.current,i=n[0],o=n[1];for(t=0;t<=i;t++)e.moveTo(0,t*EK),e.lineTo(o*EK,t*EK);for(var a=0;a<=o;a++)e.moveTo(a*EK,0),e.lineTo(a*EK,i*EK);e.stroke(),e.restore()}},p=function(){var e=r.current,t=e[0],o=e[1];_c("cv_table_use",{size:"".concat(t," x ").concat(o)}),n.setTableInsertDimensions(t,o),i()};return e.useEffect((function(){d()}),[]),e.createElement("div",{className:j(tK,"tablePanel_2LPmx"),onClick:p,onPointerMove:function(e){_e.isTouchSupported||u(e.pageX,e.pageY)},onTouchMove:function(e){if(_e.isTouchSupported){var t=e.touches;if(!(t.length>1)){var n=t[0].pageX,i=t[0].pageY;if(u(n,i),!c.current){c.current=!0;var r=function(){p(),document.removeEventListener("touchend",r)};document.addEventListener("touchend",r)}}}},ref:o},e.createElement("canvas",{style:{height:120,width:120},ref:function(e){var t=null==e?void 0:e.getContext("2d");t&&(s.current=t)},width:120*wK,height:120*wK}),e.createElement(CK,{indexes:r,ref:l}))}],[PK.TIMER,function(t){var n=t.upime,i=t.close,r=W().getUpimeTrans,o=[{duration:300,desc:r("timer.5m")},{duration:900,desc:r("timer.15m")},{duration:1800,desc:r("timer.30m")},{duration:0,desc:r("timer.custom")}];return e.createElement("div",{className:j(tK,"timerPanelSelector_TWSIQ"),onClick:function(e){return e.stopPropagation()}},e.createElement("ul",null,o.map((function(t){return e.createElement("li",{key:t.duration,onClick:function(){return function(e){n.setTimerDuration(e),_c("cv_timer_use",{duration:e}),i()}(t.duration)}},t.desc)}))))}],[PK.MINDMAP,function(t){var n=t.upime,i=t.close,r=[{icon:"morencemianzhankaihuxian",layout:Xa.HORIZONTAL,theme:Qa.COLORBRANCH,childCount:3},{icon:"morencemianzhankaizhixian",layout:Xa.VERTICAL,theme:Qa.COLORBRANCH,childCount:3},{icon:"morenxiangxiazhankaihuxian",layout:Xa.HORIZONTAL,theme:Qa.LITE,childCount:3},{icon:"morenxiangxiazhankaizhixian",layout:Xa.VERTICAL,theme:Qa.LITE,childCount:3}],o=gK(n,(function(e){n.setMindmapInsertType(e.layout,e.theme,e.childCount)}),(function(e,t){s.current.connected=!1;var i=n.insertMindmapAt(t,!1);n.setDirectMoveTarget(i),n.userEventManager.forceTriggerPressEvt(e instanceof MouseEvent?"mouse":"touch",e)||n.clearDirectMoveTarget()}),i),a=o.rootRef,s=o.dragData,l=o.handlePointerDown,c=o.handleTouchStart;return e.createElement("div",{className:j(tK,"mindmapSelector_3K9I8"),onClick:function(e){return e.stopPropagation()},ref:a},r.map((function(t,r){return e.createElement("div",{key:r,className:j(nK),onClick:function(){return function(e){s.current.connected=!1,i(),n.setMindmapInsertType(e.layout,e.theme,e.childCount)}(t)},onPointerDown:function(e){return l(e,t)},onTouchStart:function(e){return c(e,t)}},e.createElement(hl,{icon:t.icon}))})))}]]),OK=function(t){var n,i,r=t.rootRef,o=t.children,a=t.direction,s=void 0===a?"vertical":a,l=e.useRef(null),c=e.useContext(Ic).rootContainer,u=e.useState(0),d=u[0],p=u[1],h=e.useContext(xl).upime;function f(){if("vertical"===s){var e=c.current,t=r.current,n=l.current;if(!e||!t||!n)return;var i=e.getBoundingClientRect(),o=i.top+64,a=i.bottom-56,u=t.getBoundingClientRect(),d=n.getBoundingClientRect().height,h=u.bottom-28,f={top:h-d/2,bottom:h+d/2},m=20-d/2-40;f.top<o&&(m+=o-f.top,f.bottom+=o-f.top),f.bottom>a&&(m-=f.bottom-a),p(m)}}i=f,e.useEffect((function(){if(n.current){var e=new ResizeObserver(i);return e.observe(n.current),function(){e.disconnect()}}}),[(n=l).current]),e.useEffect((function(){return Od((function(){return setTimeout(f,250)}),h)}),[]);var m={};return"vertical"===s&&(m.top="".concat(d,"px")),e.createElement("div",{className:j("toolWrapper_2khTd","horiz"===s&&"toolWrapperHorizMode_2FWN2"),ref:l,style:m},o)};function FK(){var t=e.useContext(Ic).rootContainer,n=e.useContext(xl).upime,i=e.useState(0),r=i[0],o=i[1];return e.useEffect((function(){var e=function(){var e=t.current;if(e){var n=e.getBoundingClientRect(),i=n.top+64,r=n.bottom-56;o(r-i)}};return e(),Od((function(){return setTimeout(e,250)}),n)}),[]),r}var zK=["eraser","connection-line","draw","shape","text","frame","sticker","mind-map","comment"];function HK(t,n,i,r){void 0===r&&(r="vertical");var o=e.useRef(0);function a(){window.clearTimeout(o.current)}return e.useEffect((function(){function e(){a()}window.addEventListener("mousedown",e);var n=t.subscribe("openToolbar",(function(e){var n=e.xmode;zK.includes(n)&&(window.clearTimeout(o.current),t.videoGuide=null)}));return function(){window.removeEventListener("mousedown",e),n()}}),[]),{onMouseEnter:function(){"horiz"===r||_e.isTouchSupported||t.bigScreenMode||n.id!==AK.BIGDOC&&(o.current=window.setTimeout((function(){if(i){var e=i.getBoundingClientRect();t.videoGuide={src:n.videoGuideSrc||"",coverSrc:n.videoGuideCoverSrc||"",position:{x:e.right+13,y:e.top-73},desc:n.name}}}),1e3))},onMouseLeave:function(){"horiz"===r||_e.isTouchSupported||t.bigScreenMode||n.id!==AK.BIGDOC&&window.clearTimeout(o.current)},clearTimer:a}}var UK=e.forwardRef((function(t,n){var i=t.upime,r=t.items,o=t.rootRef,a=t.close,s=t.handleToolClick,l=t.refreshSrcCB,c=t.enablePanelPopupAutoHide,u=t.disablePanelPopupAutoHide,d=t.direction,p=void 0===d?"vertical":d,h=e.useState(null),f=h[0],m=h[1];e.useImperativeHandle(n,(function(){return{setSelectedItem:m}}));var v=FK();return e.createElement(OK,{rootRef:o,direction:p},e.createElement("div",{className:"rootWrapper_3e8wh",style:{maxHeight:"".concat(v,"px")}},e.createElement("div",{className:j("root_3ObWk",f?"panelItem_3NDGh":"defaultRect_DHmy5")},f?e.createElement(f.panel,{upime:i,refreshSrcCB:l,enablePanelPopupAutoHide:c,disablePanelPopupAutoHide:u,close:a}):r.map((function(t){return e.createElement(WK,{key:t.id,upime:i,item:t,direction:p,handleToolClick:s,setSelectedItem:m,close:a})})))))}));function WK(t){var n=t.upime,i=t.item,r=t.direction,o=t.handleToolClick,a=t.setSelectedItem,s=t.close,l=e.useRef(null),c=HK(n,i,l.current,r),u=c.onMouseEnter,d=c.onMouseLeave,p=c.clearTimer;return e.createElement("div",{key:i.name,className:j("item_1Whfa","shortcutrow_2XKCk",i.enabled||n.editable?"":"disable_3Jtbj"),onClick:function(e){e.stopPropagation(),o(i),n.videoGuide=null,p();var t=i.pannelType&&LK.get(i.pannelType)||i.pannel;t?a(exports.E(exports.E({},i),{panel:t})):s()},ref:l,onMouseEnter:u,onMouseLeave:d},e.createElement(hl,{icon:i.icon}),e.createElement("span",null," ",i.name," "),i.shortcut&&_e.desktop&&e.createElement("div",{className:"shortcutBox_bH9Ry"}," ",i.shortcut," "))}var VK="name_2OO3g",jK="content_iUra0",GK="panel_content_item_img_1rYlC",qK="drag_item_7DVXN",KK=e.forwardRef((function(t,n){var i=t.prefix,r=t.allowClear,o=void 0!==r&&r;t.className;var a=t.containerRef,s=N(t,["prefix","allowClear","className","containerRef"]),l=e.useRef(null),c=e.useState(!1),u=c[0],d=c[1],p=e.useState(!t.value),h=p[0],f=p[1];e.useImperativeHandle(n,(function(){return l.current})),e.useEffect((function(){var e=l.current,t=function(){d(!0)},n=function(){d(!1)},i=function(){var e;f(!(null===(e=l.current)||void 0===e?void 0:e.value))};return null==e||e.addEventListener("input",i),null==e||e.addEventListener("focus",t),null==e||e.addEventListener("blur",n),function(){null==e||e.removeEventListener("focus",t),null==e||e.addEventListener("input",i),null==e||e.removeEventListener("blur",n)}}),[]);var m=e.createElement("span",{className:"clearIcon_1_iz6",onPointerDown:function(e){return e.preventDefault()},onClick:function(e){l.current&&(l.current.value="",l.current.focus(),function(e,t,n,i){if(n){var r=t;0,n(r)}}(l.current,e,t.onChange)),f(!0)}},e.createElement(hl,{icon:"qingchu"}));return e.createElement("div",{className:j("input_container_X-CMN",t.className,u&&"input_container_active_eA8wb"),ref:a},i&&e.createElement("span",{className:"input_prefix_xVns0"},i),e.createElement("input",exports.E({},s,{ref:l})),o&&!h&&m)})),YK=e.forwardRef((function(n,i){var r=n||{},o=r.rootContainer,a=r.onFinishSelect,s=r.children,l=r.dragRender,c=r.className,u=r.onStartDrag,d=r.onEndDrag,p=e.useRef(null),h=e.useRef(),f=e.useRef(null),m=e.useState(),v=m[0],g=m[1],y=e.useRef({isConnected:!1,position:{x:0,y:0},isDragging:!1,originPos:{x:0,y:0},pointerId:null}),b=function(){if(h.current=void 0,g(null),f.current=null,y.current.isConnected=!1,y.current.isDragging=!1,y.current.pointerId=null,p.current){var e=p.current.getElementsByClassName("drag_content_item_active");[].forEach.call(e,(function(e){e.classList.remove("drag_content_item_active")}))}},E=function(e,t){var n,i=t||(null===(n=h.current)||void 0===n?void 0:n.id);void 0!==i&&h.current&&(g({position:e||y.current.position,id:i}),h.current.isShow=!0,h.current.force=!1)},x=function(e){g(null),h.current&&(h.current.isShow=!1,h.current=exports.E(exports.E({},h.current),e||{}))},w=e.useRef(0),C=function(e){if(e.classList.contains("drag_content_item")&&e.dataset.id&&(h.current={id:e.dataset.id,isShow:!1},p.current)){var t=p.current.getElementsByClassName("drag_content_item_active");[].forEach.call(t,(function(e){e.classList.remove("drag_content_item_active")})),e.classList.add("drag_content_item_active")}};return e.useEffect((function(){var e,t=function(e){var t=e.target;y.current.isConnected=!0,y.current.isDragging=!1,y.current.originPos={x:e.pageX,y:e.pageY},y.current.pointerId=e.pointerId,y.current.position={x:e.pageX,y:e.pageY},_e.isHoverSupported?C(t):function(e){w.current=window.setTimeout((function(){y.current.isConnected&&!1===y.current.isDragging&&(u&&u(),C(e.target))}),500)}(e)},n=function(e,t,n){if(y.current.position={x:e,y:t},o&&null!=o.current){var i=o.current.getBoundingClientRect(),r=i.left,a=i.top,s={left:r,right:i.right,top:a,bottom:i.bottom};if(f.current&&(Ot({x:e,y:t},s)?f.current.style.zIndex="100":f.current.style.zIndex="1"),!y.current.isDragging){var l=y.current.pointerId,c=!0;null!==l&&l!==n&&(c=!1),y.current.isConnected||(c=!1);var u=t-y.current.originPos.y,d=_e.isTouchSupported?8:4;Math.abs(u)>d&&(y.current.isDragging=c)}!h.current||!h.current.isShow&&(h.current.force||Ot({x:e,y:t},s)&&!y.current.isDragging)||E(y.current.position)}},i=function(e){n(e.pageX,e.pageY,e.pointerId)},r=function(e){n(e.touches[0].pageX,e.touches[0].pageY,y.current.pointerId||0)},s=function(e,t,n){_e.isHoverSupported||(d&&d(),clearTimeout(w.current)),y.current.position={x:e,y:t};var i=!1;if(o&&o.current){var r=o.current.getBoundingClientRect(),s=r.left,l=r.top,c=r.right,u=r.bottom;i=Ot(y.current.position,{left:s,right:c,top:l,bottom:u})}y.current.isDragging?(!i&&a&&h.current&&a(h.current.id,y.current.position),b()):!i&&a&&h.current?(a(h.current.id,y.current.position),b()):f.current?b():(_e.isHoverSupported||C(n),y.current.isConnected=!1,y.current.isDragging=!1,y.current.pointerId=null,x())},l=function(e){s(e.pageX,e.pageY,e.target)},c=function(e){s(y.current.position.x,y.current.position.y,e.target)};return null===(e=p.current)||void 0===e||e.addEventListener("pointerdown",t),document.addEventListener("pointerup",l),document.addEventListener("pointermove",i),document.addEventListener("touchmove",r),document.addEventListener("pointercancel",i),document.addEventListener("touchcancel",c),document.addEventListener("touchend",c),function(){var e;null===(e=p.current)||void 0===e||e.removeEventListener("pointerdown",t),document.removeEventListener("pointerup",l),document.removeEventListener("pointermove",i),document.removeEventListener("touchmove",r),document.removeEventListener("pointercancel",i),document.removeEventListener("touchcancel",c),document.removeEventListener("touchend",c)}}),[a]),e.useImperativeHandle(i,(function(){return{destroyDrag:b,showDragElement:E,hideDragElement:x}})),e.useEffect((function(){b()}),[]),e.createElement("div",{className:j("drag_container_1ymFX",c),ref:p},s,v?t.createPortal(e.createElement("div",{className:"drag_element_-Xwha",id:"drag-element",ref:f},l(v)),document.body):null)}));function XK(t){var n=t.children,i=t.id,r=t.className;return e.createElement("div",{className:j("drag_content_item",r),"data-id":i},n)}var QK=e.memo((function(t){var n=this,i=t.data,r=t.recent,o=t.rootContainer,a=t.dragEventRef,s=t.updateHistory,l=e.useContext(fK).insertImage,c=e.useContext(xl).upime,u=W().getUpimeTrans,d=e.useMemo((function(){return i.map((function(e){return e.list})).flat()}),[i]);function p(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,fetch(e).then((function(e){return e.text()})).then((function(e){return e}))]}))}))}var h=e.useRef(null);return e.createElement(YK,{dragRender:function(t){var n=d.find((function(e){return"icon_"+e.iconId===t.id}));return n?e.createElement("img",{src:n.url,style:{transform:"translate(".concat(t.position.x-n.width/2,"px,").concat(t.position.y-n.height/2,"px)"),width:n.width,height:n.height,touchAction:"none"}}):null},rootContainer:o,onFinishSelect:function(e,t){return A(n,void 0,void 0,(function(){var i,r,o,a;return D(this,(function(u){switch(u.label){case 0:return"svg"!==(null==(i=d.find((function(t){return"icon_"+t.iconId===e})))?void 0:i.type)?[3,3]:(r=i.svg)||!i.url?[3,2]:[4,p(i.url)];case 1:r=u.sent(),u.label=2;case 2:return r?(o=new Blob([r],{type:"image/svg+xml"}),a=new File([o],"".concat(i.name,".").concat(i.type),{lastModified:Date.now(),type:"image/svg+xml"}),_c("cv_sticker_use",{sticker:e}),h=i.iconId,A(n,void 0,void 0,(function(){var e,t,n;return D(this,(function(i){switch(i.label){case 0:return[4,c.getFileToken()];case 1:return e=i.sent(),t=e.host,n=e.query,[4,fd({userId:c.localUserInfo.loginName,iconId:h},{host:t,query:n}).result];case 2:return i.sent(),s(),[2]}}))})),[2,l&&l({file:a,position:t,size:{width:i.width,height:i.height},fileId:i.fileId})]):[2,!1];case 3:return[2]}var h}))}))},onStartDrag:function(){h.current.style.touchAction="none",h.current.style.overflow="hidden"},onEndDrag:function(){h.current.style.touchAction="unset",h.current.style.overflow="auto"},ref:a},e.createElement("div",{className:"panel_content_28GpE",ref:h},r.length>0&&e.createElement("div",null,e.createElement("div",{className:VK},u("toolbar.customizedSticker.recent")),e.createElement("div",{className:jK},r.map((function(t){return e.createElement(Dl,{placement:"bottom",content:t.name,key:t.iconId},e.createElement(XK,{id:"icon_"+t.iconId,className:qK},e.createElement("img",{src:t.url,loading:"lazy",className:GK})))})))),i.length>0&&i.map((function(t){var n=t.license,i=t.list,r=t.categoryName,o=t.categoryId;return e.createElement("div",{key:o},e.createElement("div",{className:VK},r),e.createElement("div",{className:jK},i.length>0&&i.map((function(t){return e.createElement(Dl,{placement:"bottom",content:t.name,key:t.iconId},e.createElement(XK,{id:"icon_"+t.iconId,className:qK},e.createElement("img",{src:t.url,loading:"lazy",className:GK})))}))),e.createElement("div",{className:"license_SGUqq"},n&&n.name?e.createElement("div",{className:"panel_footer_96K0E"},e.createElement("span",{className:"source_1c7CY"},u("toolbar.customizedSticker.source",n.name)),e.createElement("a",{href:n.url,target:"_blank",rel:"noreferrer"},u("toolbar.customizedSticker.license"))):null))}))))})),ZK=e.forwardRef((function(t,n){var i=this,r=t||{},o=r.close,a=r.direction,s=void 0===a?"vertical":a,l=e.useState([]),c=l[0],u=l[1],d=e.useState([]),p=d[0],h=d[1],f=e.useRef(null),m=e.useContext(xl).upime,v=e.useRef(null),g=W().getUpimeTrans,y=function(e){return A(i,void 0,void 0,(function(){var t,n,i,r,o;return D(this,(function(a){switch(a.label){case 0:return[4,m.getFileToken()];case 1:return t=a.sent(),n=t.host,i=t.query,r=m.localUserInfo.loginName,[4,Promise.all([hd({name:e,len:8,userId:r},{host:n,query:i}).result,pd({name:e},{host:n,query:i}).result])];case 2:return(o=a.sent())[0]&&o[0].code===Uu.OK&&h(o[0].obj.data),o[1]&&o[1].code===Uu.OK&&u(o[1].obj.data),[2]}}))}))};e.useEffect((function(){y("")}),[]);var b=e.useMemo((function(){return e.createElement(hl,{icon:"sousuo",className:"searchIcon_HdLqd"})}),[]),E=function(){return A(i,void 0,void 0,(function(){var e,t;return D(this,(function(n){return e=(null===(t=f.current)||void 0===t?void 0:t.value)||"",y(e||""),[2]}))}))},x=te(E,100),w=FK();return e.createElement("div",{className:j("sticker_panel_3yHq8","horiz"===s&&"sticker_panel_horiz_mode_2cL_Z"),ref:v,style:{maxHeight:"".concat(w,"px")},onMouseMove:function(e){e.stopPropagation()}},e.createElement("div",{className:"panel_header_2ua8w"},e.createElement("span",{className:"title_HFb-s"},g("toolbar.customizedSticker")),e.createElement("span",{onClick:function(){return null==o?void 0:o()},className:"closeIcon_1ybuV"},e.createElement(hl,{icon:"guanbi"}))),e.createElement(KK,{prefix:b,placeholder:g("toolbar.customizedSticker.placeholder"),className:"panel_search_H3ywN",allowClear:!0,ref:f,onChange:x,onKeyDown:function(e){var t;"Enter"===e.key&&(e.preventDefault(),E(),null===(t=f.current)||void 0===t||t.blur())}}),c.length>0?e.createElement(QK,{data:c,recent:p,rootContainer:v,dragEventRef:n,updateHistory:E}):e.createElement("span",{className:"empty_26jN7"},g("toolbar.customizedSticker.empty")))})),JK=function(t){var n=t.content,i=t.shortcut;return e.createElement("div",{className:eK.shortcutContainer},e.createElement("div",null,n),i&&e.createElement("div",{className:eK.shortcutBox},i))};function $K(t){var n,i,r=t.upime,o=t.tool,a=t.setDisablePopAutoHide,s=t.setHide,l=t.direction,c=void 0===l?"vertical":l,u=BK[o.id],d=r.getDrawPens()[u][0],p=e.useContext(hK).switchPenType,h=W().getUpimeTrans,f=r.getCurrentPenType(),m="draw"===r.xmode&&f===u,v=e.useState(!1),g=v[0],y=v[1],b=e.useReducer((function(e){return e+1}),0);b[0];var E=b[1],x=e.useRef(null);function w(){r.setDrawLingStyle(r.getDrawPens()[u][0]),E()}e.useEffect((function(){var e=x.current;if(g&&e){var t=!1;return document.addEventListener("pointerdown",n),document.addEventListener("pointerup",i),function(){document.removeEventListener("pointerdown",n),document.removeEventListener("pointerup",i)}}function n(n){var i=document.getElementById("upime-color-picker");if(e){if(V(e,n.target))return;if(i&&V(i,n.target))return}t=!0}function i(){t&&y(!1),t=!1}}),[g,x.current]),e.useEffect((function(){!m&&g&&y(!1)}),[m]);var C=function(e){var t;null!==e&&(t=e,r.setPenStyles(u,0,{lineColor:t}),w())};function S(){a(!1)}function k(){a(!0)}return e.createElement("div",{ref:x,className:eK.penItemOutter},e.createElement(Dl,{key:o.id,content:o.name,renderData:{fun:JK,data:{content:o.name,shortcut:o.shortcut}},placement:"horiz"===c?"top":"right",extraDistance:3},e.createElement("div",{className:j(eK.tool,eK.iconWrap,m&&eK.iconWrapActive,m&&eK.forceColor,o.enabled||r.editable?"":eK.disable),onClick:function(e){e.stopPropagation(),function(){if(m)y(!g);else{s(!0),p(u);var e=r.getDrawPens()[u][0];r.setDrawLingStyle(e)}}()}},e.createElement(hl,{icon:o.icon,size:24}),m&&e.createElement(hl,{icon:"huabijiaobiao",className:j(eK.selectedTipIcon)}))),g&&e.createElement("div",{className:j(eK.penItemEditWrapper,"vertical"===c&&eK.penItemEditWrapperVerMode,Ml.show_scale,"horiz"===c?Ml.top:Ml.right)},e.createElement("div",{className:j(eK.penItemEditContainer,"vertical"===c&&eK.penItemEditContainerVerMode),onClick:function(e){e.stopPropagation()}},e.createElement("div",{className:lK},e.createElement(nE,{defaultValue:d.lineWidth/28,onChanged:function(e){r.setPenStyles(u,0,{lineWidth:30*e}),w()}}),e.createElement("p",null,h("toolbar.lineWidth"))),u===Ya.MARK&&e.createElement("div",{className:j(cK)},e.createElement(bc,{className:uK,onChanged:function(e){r.setPenStyles(u,0,{lineOpacity:e}),w()},defaultValue:null!==(n=d.lineOpacity)&&void 0!==n?n:.5}),e.createElement("span",null,h("element.opacity")),e.createElement("span",{className:dK},"".concat(100*(null!==(i=d.lineOpacity)&&void 0!==i?i:.5),"%"))),e.createElement(Yb,{colorPalettes:r.userManager.userPalette,onChanged:C,defaultValue:d.lineColor,colorPickerConfig:{closeSideEffect:S,openSideEffect:k,onColorPickerChange:C},className:pK,toggleParentAutoHide:function(e){e?S():k()}}))))}var eY=[AK.TEMPLATE,AK.STICKER,AK.TEXT,AK.SHAPES,AK.CONNECT_LINE,AK.COMMENT,AK.PEN,AK.FRAME,AK.UPLOAD,AK.MINDMAP],tY=[AK.KANBAN,AK.BIGDOC,AK.TABLE,AK.WEBPAGE,AK.CUSTOMIZED_STICKER,AK.TIMER];function nY(t){var n=t.upime,i=t.customizedUploader,r=t.hidden,o=t.allCustomTools,a=t.toolBarList,s=t.toolBoxList,l=void 0===s?[]:s,c=t.isSimple,u=t.onlyComment,d=t.useToolBox,p=void 0!==d&&d,h=t.direction,f=void 0===h?"vertical":h,m=e.useContext(Ic).ready,v=e.useState(null),g=v[0],y=v[1],b=e.useState(Ya.NORMAL),E=b[0],x=b[1],w=e.useState({})[1],C=e.useState(!1),S=C[0],k=C[1],_=e.useRef({toolInfo:null}),T=e.useRef(null),I=e.useState(0),P=I[0],N=I[1];al(n,["xmode","editable","meetingMode","viewLocked","currentCustomTool","presentation"]);var M=function(e){e.umengEvtId&&_c(e.umengEvtId,{in_meeting:null===n.meetingMode?"否":"是"});var t=e.xmode,i=e.tool;if(e===j&&("select"===t&&"select"===n.xmode||"view"===t&&"view"===n.xmode))n.toggleSelectAndViewMode();else{switch("string"==typeof t&&n.switchMode(t),i){case"template":!function(){A(this,void 0,void 0,(function(){return D(this,(function(e){return n.onInsertTemplate(),[2]}))}))}();break;case"pen":"eraser"!==n.xmode&&"draw"!==n.xmode&&n.switchMode("draw");break;case"customImage":var r=_.current.toolInfo;n.currentCustomTool=o.find((function(t){return t.key===e.key})),r&&r.key===e.key&&(n.currentCustomTool=void 0,_.current.toolInfo=null)}"customImage"!==i&&(n.currentCustomTool=void 0),T.current=e,!1===n.bigScreenMode&&e.id!==AK.SELECT_VIEW&&-1===ee.findIndex((function(t){return t.id===e.id}))&&(n.latestUsedTool=e,q())}};e.useEffect((function(){null!==n.meetingMode&&"editor"!==n.meetingMode&&(n.latestUsedTool=null)}),[n.meetingMode]),e.useEffect((function(){"select"!==n.xmode&&(n.currentCustomTool=void 0)}),[n.xmode]);var B=W().getUpimeTrans,L=e.useRef(!1),O=yh(!0,{checkSkip:function(){var e;return L.current||!1===(null===(e=T.current)||void 0===e?void 0:e.autoHide)}}),F=O.hide,z=O.toggleHide,H=O.setHide,U=O.skipRef,V=e.useRef(null);e.useEffect((function(){return n.subscribe("openToolbar",(function(e){var t,i,o=e.xmode,s=e.subType,c=R(R([],a,!0),l,!0).find((function(e){return Array.isArray(e.xmode)?e.xmode.includes(o):e.xmode===o}));if(void 0!==c){var u=R(R([],te,!0),l,!0).some((function(e){return e.id===c.id}));if(r||n.hideToolbar||"shape"===o&&void 0!==s)M(c),"shape"===o&&document.body.click();else if(u){F&&document.body.click();var d=c.pannelType&&LK.get(c.pannelType)||c.pannel;F&&d&&("eraser"!==o&&"draw"!==o||n.switchMode("draw"),H(!1)),d&&(null===(i=V.current)||void 0===i||i.setSelectedItem(exports.E(exports.E({},c),{panel:d}))),M(c)}else{("string"==typeof c.xmode?c.xmode===n.xmode:null===(t=c.xmode)||void 0===t?void 0:t.includes(n.xmode))&&document.body.click();var p="string"==typeof c.xmode?c.xmode:c.tool,h="toolbar_".concat(p),f=document.getElementById(h);f&&f.click()}s?"eraser"===s?(n.switchMode("eraser"),_c("cv_pen_use",{type:"xiangpica"})):"shape"===o&&(J(s),n.switchShape(s)):"draw"===o&&"eraser"===n.xmode&&n.switchMode("draw")}}))}),[a,P,r,V.current]),e.useEffect((function(){if(!F)return n.registerHotKey({key:"Escape"},(function(){F||H(!0)}))}),[F]);var j=u||"commentor"===n.meetingMode?{id:AK.SELECT_VIEW,xmode:"hand",name:B("toolbar.selectAndViewMode"),icon:"hand-mode",enabled:!0,shortcut:"V"}:"view"===n.xmode?{id:AK.SELECT_VIEW,xmode:"view",name:B("toolbar.selectAndViewMode"),icon:"hand-mode",umengEvtId:"cv_view",shortcut:"V"}:{id:AK.SELECT_VIEW,xmode:"select",name:B("toolbar.selectAndViewMode"),icon:"xuanze",umengEvtId:"cv_select",shortcut:"V"},G=e.useRef(0);function q(){var e=0,t=n.latestUsedTool;!0==(null!==t&&-1===ee.findIndex((function(e){return e.id===t.id})))&&(e=55);var i=88+e,r="horiz"===f?16:10;if(u)"horiz"===f?X.current.style.removeProperty("width"):X.current.style.removeProperty("height");else if(n.bigScreenMode){var o=iY().length;if(P!==o+2){if("horiz"===f){var s=40*(o+2)-2+r;X.current.style.width="".concat(s,"px")}else s=40*(o+2)-2+r,X.current.style.height="".concat(s,"px");N(o+2)}}else{var l=40*(a.length+1)-2+r;l+=e,p&&(l+=40);var d=Y.viewHeight-64-96-88,h=Y.viewWidth-88-680,m="horiz"===f?h:d;if(c){var v=200+r-2;v+=e;var g=Math.min(v,l);if(m>g)return"horiz"===f?X.current.style.width="".concat(g,"px"):X.current.style.height="".concat(g,"px"),void(v<l?5!==G.current&&N(5):N(a.length+1))}var y=a.length+1;p&&(y+=1),m<i?(m=i,y=2):m>=l?m=l:(m=40*(y=Math.floor((m-r+2-e)/40))-2+r,m+=e),"horiz"===f?X.current.style.width="".concat(m,"px"):X.current.style.height="".concat(m,"px"),G.current!==y&&N(y)}}G.current=P;var K=e.useRef(q);e.useEffect((function(){K.current=q}),[q]);var Y=n.view,X=e.useRef(),Q=e.useRef();e.useEffect((function(){var e=Od((function(){K.current()}),n);return K.current(),function(){e()}}),[a,a.length,n.latestUsedTool,P]);var Z=e.useCallback((function(e){n.setCurPenType(e),n.switchMode("draw"),x(e)}),[]);function J(e){y(e)}var $=e.useMemo((function(){var e=u||"commentor"===n.meetingMode;return n.bigScreenMode&&!e?{displayedItems:iY(),collapsedItems:a}:n.userManager.commentOnlyMode&&!n.editable||!(p||P-1<a.length)?{displayedItems:a,collapsedItems:[]}:{displayedItems:a.slice(0,P-2),collapsedItems:a.slice(P-2)}}),[a,P,n.bigScreenMode]),ee=$.displayedItems,te=$.collapsedItems;e.useEffect((function(){te.length||F||p||H(!0)}),[te,F]),e.useEffect((function(){!n.editable&&(null==i||i.onCloseUpload())}),[n.editable]);var ne=e.useRef(0),ie=e.useRef(!1),re=function(){n.toolbarOpened=ne.current>0||ie.current};return e.useEffect((function(){ie.current=!F,re()}),[F]),{switchShapeType:J,switchPenType:Z,ready:m,toolRef:X,tool:j,setHide:H,handleToolClick:function(e){M(e)},toolCenterRef:Q,collapsedItems:te,skipRef:U,getUpimeTrans:B,toggleHide:z,hide:F,secondaryPanelCmp:V,refreshToolbar:function(){w({})},disableExpandAutoHide:function(){L.current=!0},enableExpandAutoHide:function(){L.current=!1},displayedItems:ee,curPenType:E,disablePopAutoHide:S,curShapeType:g,subPanelRendering:function(e){e?ne.current++:ne.current--,re()},calcRect:function(e,t){var n,i;if("vertical"===f){var r=null!==(i=null===(n=X.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==i?i:new DOMRect,o=e.height,a=r.height+88,s=r.top+a,l=r.top+(a-o)/2;return a>o&&((l+=t.top-r.top-a/2+t.height/2)<r.top?l=r.top:l+o>s&&(l=s-o)),exports.E(exports.E({},t),{top:l,height:e.height})}return t},setDisablePopAutoHide:k,curCloseTool:_,extraToolBarItemCount:n.bigScreenMode?iY().length:0}}function iY(){var e={id:DK.pen,xmode:"draw",name:O("toolbar.pen"),icon:"huabi",dragLock:!0,render:$K},t={id:DK.markPen,xmode:"draw",name:O("toolbar.markPen"),icon:"yingguangbi",dragLock:!0,render:$K},n={id:DK.smartPen,xmode:"draw",name:O("toolbar.smartDraw"),icon:"zhinengtuhang",dragLock:!0,render:$K},i={id:DK.eraser,xmode:"eraser",name:O("toolbar.xiangpica"),icon:"xiangpica",dragLock:!0},r={id:AK.SHAPES,xmode:"shape",name:O("toolbar.shape"),pannelType:PK.SHAPES,icon:"xingzhuang",dragLock:!0};return AK.PEN,O("toolbar.pen"),PK.DRAW,[e,t,n,i,r]}function rY(e){return{id:"".concat("custom_").concat(e.id),key:"".concat("custom_").concat(e.key),xmode:"select",tool:"customImage",name:e.name,pannel:e.pannel,icon:e.icon,autoHide:e.autoHide,umengEvtId:e.umengEvtId}}function oY(e,t,n){var i=e.y-t.top,r=Math.floor(i/n);return i<r*n+n/2||r++,r}var aY={toolBox:"toolBox_3ub1T",boxHead:"boxHead_zeAc4",boxHeadTitle:"boxHeadTitle_32Wb4",boxHeadTip:"boxHeadTip_1-fTD",boxContent:"boxContent_2BDHb",toolBarInBox:"toolBarInBox_2ABkM",toolBoxPart:"toolBoxPart_189dk",item:"item_3xDWh",disable:"disable_1mOb7",tudingContainer:"tudingContainer_1KXIO",tuding:"tuding_IYhHj",showInHover:"showInHover_2MflK",appContainer:"appContainer_3VaRZ",emptyContainer:"emptyContainer_1TYjG",dragableWrapper:"dragableWrapper_UUM3o",ani:"ani_A38CR"},sY=e.forwardRef((function(t,n){var i=t.upime,r=t.items,o=t.toolBoxList,a=t.rootRef,s=t.close,l=t.curCloseTool,c=t.handleToolClick,u=t.refreshSrcCB,d=t.enablePanelPopupAutoHide,p=t.disablePanelPopupAutoHide,h=t.toToolBox,f=t.toToolBar,m=t.draggingTarget,v=t.startDrag,g=t.direction,y=e.useState(null),b=y[0],E=y[1];e.useImperativeHandle(n,(function(){return{setSelectedItem:E}}));var x=FK(),w="horiz"===g?540:x;return e.createElement(OK,{rootRef:a,direction:g},e.createElement("div",{className:aY.toolBoxContainer,style:{maxHeight:"".concat(w,"px")}},b?e.createElement(b.panel,{upime:i,refreshSrcCB:u,enablePanelPopupAutoHide:d,disablePanelPopupAutoHide:p,close:function(){s(),l.current.toolInfo=b,c(b)},direction:g}):e.createElement(lY,{maxHeight:w,handleToolClick:c,collapsedItems:r,toolBoxList:o,setSelectedItem:E,close:s,toToolBox:h,toToolBar:f,draggingTarget:m,startDrag:v})))})),lY=function(t){var n=t.toToolBar,i=t.toToolBox,r=t.collapsedItems,o=t.toolBoxList,a=t.handleToolClick,s=t.maxHeight,l=t.setSelectedItem,c=t.close,u=t.draggingTarget,d=t.startDrag,p=W().getUpimeTrans,h=e.useContext(mK).toolScrollRef,f=e.useContext(xl).upime,m=f.userManager.userAccessHint;return e.createElement("div",{className:aY.toolBox,style:{maxHeight:"".concat(s,"px")}},e.createElement("div",{className:aY.boxHead},e.createElement("div",{className:aY.boxHeadTitle},e.createElement("b",null,p("tool.box.title"))),e.createElement("div",{className:aY.boxHeadTip},p(f.bigScreenMode?"tool.box.title.tip.tiny":"tool.box.title.tip"))),e.createElement("div",{className:aY.boxContent,ref:h},r.length>0&&e.createElement(cY,{items:r,handleToolClick:a,setSelectedItem:l,close:c,toToolBar:n,toToolBox:i,draggingTarget:u,startDrag:d}),e.createElement(uY,{items:o,handleToolClick:a,setSelectedItem:l,close:c,toToolBar:n,toToolBox:i,draggingTarget:u,startDrag:d}),m.AppCenter&&e.createElement("div",{className:aY.appContainer},e.createElement(m.AppCenter,null))))},cY=function(t){var n=t.items,i=t.handleToolClick,r=t.setSelectedItem,o=t.close;t.toToolBar;var a=t.toToolBox,s=t.draggingTarget,l=t.startDrag,c=W().getUpimeTrans,u=e.useContext(mK).toolBoxBarRef,d=n.reduce((function(e,t,n){var i;return exports.E(exports.E({},e),((i={})[t.id]=n,i))}),{}),p=R([],n,!0);p.sort((function(e,t){return e.id>t.id?1:-1}));var h=44*p.length+12;return e.createElement("div",{className:aY.toolBarInBox,style:{height:"".concat(h,"px")},ref:u},p.map((function(t){return e.createElement(dY,{key:t.id,draggingTarget:s,tool:t,index:d[t.id],startDrag:l},e.createElement(pY,{item:t,handleToolClick:i,setSelectedItem:r,close:o,iconTip:c("tool.box.unpin.tool"),onChangeInBox:function(){return a(t)},draggingTarget:s}))})))},uY=function(t){var n=t.items,i=t.handleToolClick,r=t.setSelectedItem,o=t.close,a=t.toToolBar;t.toToolBox;var s=t.draggingTarget,l=t.startDrag,c=W().getUpimeTrans,u=e.useContext(mK).toolBoxRef,d=n.reduce((function(e,t,n){var i;return exports.E(exports.E({},e),((i={})[t.id]=n,i))}),{}),p=R([],n,!0);p.sort((function(e,t){return e.id>t.id?1:-1}));var h=0===n.length?"unset":"".concat(44*p.length,"px");return e.createElement("div",{className:j(aY.toolBarInBox,aY.toolBoxPart),style:{height:h},ref:u},p.map((function(t){return e.createElement(dY,{key:t.id,draggingTarget:s,tool:t,index:d[t.id],startDrag:l},e.createElement(pY,{item:t,handleToolClick:i,setSelectedItem:r,close:o,iconShowInHover:!0,iconTip:c("tool.box.pin.tool"),onChangeInBox:function(){return a(t)},draggingTarget:s}))})),0===n.length&&e.createElement("div",{className:aY.emptyContainer},c("tool.box.empty.tip")))},dY=function(t){var n=t.index,i=t.startDrag,r=t.tool,o=t.children,a=t.draggingTarget,s=e.useRef(null),l=e.useRef(null);function c(){s.current=null}var u=e.useRef(null);function d(){u.current&&(clearTimeout(u.current),u.current=null)}e.useEffect((function(){return function(){u.current&&clearTimeout(u.current)}}),[]);var p=44*n;return e.createElement("div",{ref:l,onMouseDown:function(e){s.current={x:e.clientX,y:e.clientY}},onPointerMove:function(e){var t;if(s.current){var n=s.current,o=n.x,a=n.y;if(Math.sqrt(Math.pow(e.clientX-o,2)+Math.pow(e.clientY-a,2))>vK){var c=null===(t=l.current)||void 0===t?void 0:t.getBoundingClientRect();if(c){var u={x:s.current.x-c.left-8,y:s.current.y-c.top};i(r,u),s.current=null}}}},onPointerLeave:c,onPointerUp:c,onTouchStart:function(e){if(1===e.touches.length){var t={x:e.touches[0].clientX,y:e.touches[0].clientY};u.current&&clearTimeout(u.current),u.current=window.setTimeout((function(){var e;s.current=t;var n=null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect();if(n){var o={x:s.current.x-n.left-8,y:s.current.y-n.top};i(r,o),s.current=null}}),500)}},onTouchCancel:d,onTouchEnd:d,onTouchMove:d,className:j(aY.dragableWrapper,a&&r.id!==(null==a?void 0:a.id)&&aY.ani),style:{top:"".concat(p,"px")}},o)},pY=function(t){var n=t.item,i=t.handleToolClick,r=t.setSelectedItem,o=t.close,a=t.iconTip,s=t.onChangeInBox,l=t.iconShowInHover,c=void 0!==l&&l,u=t.draggingTarget,d=e.useContext(xl).upime,p=e.useRef(null),h=HK(d,n,p.current),f=h.onMouseEnter,m=h.onMouseLeave,v=h.clearTimer;return e.createElement("div",{className:j(aY.item,n.enabled||d.editable?"":aY.disable),style:{opacity:(null==u?void 0:u.id)===n.id?.2:1},onClick:function(e){if(v(),e.stopPropagation(),!u){i(n);var t=n.pannelType&&LK.get(n.pannelType)||n.pannel;t?r(exports.E(exports.E({},n),{panel:t})):o()}},ref:p,onMouseEnter:f,onMouseLeave:m},e.createElement(hl,{icon:n.icon}),e.createElement("span",null," ",n.name," "),(_e.desktop||!c)&&e.createElement("div",{className:aY.tudingContainer},e.createElement(Dl,{content:a,placement:"top"},e.createElement("div",{className:j(aY.tuding,c&&aY.showInHover),onClick:function(e){e.stopPropagation(),e.preventDefault(),u||s()}},e.createElement(hl,{icon:"tuding",size:20})))))},hY=function(t){var n=t.children,i=t.className;return e.createElement("div",{className:j("latestUsedToolWrap_3ESOC",i)},e.createElement("div",{className:"divider_1uhLp"}),e.createElement("div",{className:"childrenWrap_1EaL-"},n))};function fY(t){var n=t.upime,i=t.customTools,r=t.customizedUploader,o=t.hidden,a=t.direction,s=n.latestUsedTool;al(n,["latestUsedTool"]);var l=function(t){var n=t.upime,i=t.customTools,r=n.userManager,o=e.useContext(Ic).extensionConfigs,a=void 0!==n.standardPresentation||null!==n.meetingMode,s=r.commentOnlyMode&&!n.editable&&!n.meetingMode&&!n.pluginManager.curPerm(),l=e.useReducer((function(e){return e+1}),0)[1],c=e.useMemo((function(){var e=i?R([],i,!0):[],t=(null==i?void 0:i.map(rY))||[],r={commentItem:{id:AK.COMMENT,xmode:"comment",name:O("toolbar.comment"),icon:"chuangjianpizhu",umengEvtId:"cv_comment",videoGuideSrc:$o("tool/video/tooltip_annotations.mp4"),videoGuideCoverSrc:$o("tool/tooltip_annotations.jpg"),shortcut:"C"},templateItem:{id:AK.TEMPLATE,tool:"template",name:O("toolbar.template"),icon:"moban",xmode:"template",videoGuideSrc:$o("tool/video/tooltip_template.mp4"),videoGuideCoverSrc:$o("tool/tooltip_template.jpg"),umengEvtId:"cv_template"},stickerItem:{id:AK.STICKER,xmode:"sticker",name:O("toolbar.sticker"),icon:"bianqian",pannelType:PK.STICKER,umengEvtId:"cv_stickynote",videoGuideSrc:$o("tool/video/tooltip_sticky.mp4"),videoGuideCoverSrc:$o("tool/tooltip_sticky.jpg"),shortcut:"N"},shapeItem:{id:AK.SHAPES,xmode:"shape",name:O("toolbar.shape"),pannelType:PK.SHAPES,icon:"xingzhuang",umengEvtId:"cv_shape",videoGuideSrc:$o("tool/video/tooltip_flow.mp4"),videoGuideCoverSrc:$o("tool/tooltip_flow.jpg"),shortcut:"S"},textItem:{id:AK.TEXT,xmode:"text",name:O("toolbar.text"),icon:"wenben",umengEvtId:"cv_text",videoGuideSrc:$o("tool/video/tooltip_text.mp4"),videoGuideCoverSrc:$o("tool/tooltip_text.jpg"),shortcut:"T"},connectLineItem:{id:AK.CONNECT_LINE,xmode:"connection-line",name:O("toolbar.connectLine"),icon:"lianjiexian-8khgj6jg",pannelType:PK.CONNECT_LINE,umengEvtId:"cv_line",videoGuideSrc:$o("tool/video/tooltip_connect_line.mp4"),videoGuideCoverSrc:$o("tool/tooltip_connect_line.jpg"),shortcut:"L"},penItem:{id:AK.PEN,xmode:["draw","eraser"],tool:"pen",name:O("toolbar.pen"),icon:"huabi",pannelType:PK.DRAW,expandPanelOverflow:!0,umengEvtId:"cv_pen",videoGuideSrc:$o("tool/video/tooltip_pan.mp4"),videoGuideCoverSrc:$o("tool/tooltip_pan.jpg"),shortcut:"P"},frameItem:{id:AK.FRAME,xmode:"frame",name:O("toolbar.frame"),icon:"huaban",pannelType:PK.FRAME,umengEvtId:"cv_frame",videoGuideSrc:$o("tool/video/tooltip_frame.mp4"),videoGuideCoverSrc:$o("tool/tooltip_frame.jpg"),shortcut:"F"},mindMapItem:{id:AK.MINDMAP,xmode:"mind-map",name:O("toolbar.mindmap"),icon:"siweidaotu",pannelType:PK.MINDMAP,umengEvtId:"cv_mindmap",videoGuideSrc:$o("tool/video/tooltip_mind.mp4"),videoGuideCoverSrc:$o("tool/tooltip_mind.jpg"),shortcut:"M"},tableItem:{id:AK.TABLE,xmode:"table",name:O("table.label"),icon:"biaoge",pannelType:PK.TABLE,videoGuideSrc:$o("tool/video/tooltip_table.mp4"),videoGuideCoverSrc:$o("tool/tooltip_table.jpg"),umengEvtId:"cv_table"},uploadItem:{id:AK.UPLOAD,tool:"upload",name:O("toolbar.upload"),icon:"shangchuan",pannelType:PK.UPLOAD,videoGuideSrc:$o("tool/video/tooltip_upload.mp4"),videoGuideCoverSrc:$o("tool/tooltip_upload.jpg"),umengEvtId:"cv_upload"},webpageItem:{id:AK.WEBPAGE,xmode:"insert-webpage",name:O("webpage.insert.title"),icon:"neiqianwangye",videoGuideSrc:$o("tool/video/tooltip_webpage.mp4"),videoGuideCoverSrc:$o("tool/tooltip_webpage.jpg"),umengEvtId:"cv_embedweb"},customStickerItem:{id:AK.CUSTOMIZED_STICKER,key:"customizedSticker",xmode:"select",tool:"customImage",name:O("toolbar.customizedSticker"),pannel:ZK,icon:"tiezhi",umengEvtId:"cv_sticker",videoGuideSrc:$o("tool/video/tooltip_svg.mp4"),videoGuideCoverSrc:$o("tool/tooltip_svg.jpg"),autoHide:!1},timerItem:{id:AK.TIMER,xmode:"timer",name:O("toolbar.timer"),icon:"jishiqi",pannelType:PK.TIMER,videoGuideSrc:$o("tool/video/tooltip_timer.mp4"),videoGuideCoverSrc:$o("tool/tooltip_timer.jpg"),umengEvtId:"cv_timer"},kanbanItem:{id:AK.KANBAN,xmode:"kanban",name:O("kanban.label"),icon:"kanban",videoGuideSrc:$o("tool/video/tooltip_kanban.mp4"),videoGuideCoverSrc:$o("tool/tooltip_kanban.jpg"),umengEvtId:"cv_kanban"},documentItem:{id:AK.BIGDOC,xmode:"bigDoc",name:O("toolbar.bigDoc"),icon:"wendangyuansu",videoGuideSrc:"",videoGuideCoverSrc:"",umengEvtId:"cv_document"}},l=r.commentItem,c=r.templateItem,u=r.stickerItem,d=r.shapeItem,p=r.textItem,h=r.connectLineItem,f=r.penItem,m=r.frameItem,v=r.mindMapItem,g=r.tableItem,y=r.uploadItem,b=r.webpageItem,E=r.customStickerItem,x=r.timerItem,w=r.kanbanItem,C=r.documentItem;if(s||"commentor"===n.meetingMode)return l.enabled=!0,{toolList:[l],toolBarList:[l],toolBoxList:[],customToolList:e};var S=a?[u,f,l,c,d,p,h,m,v,g,w,y,b,E,x,C]:[c,u,d,p,h,f,l,m,v,g,w,y,b,E,x,C],k=[];n.userManager.enableWebpage||k.push(b);var _=o.sticker,T=o.template,I=o.toolbarConfig;(null==_?void 0:_.enabled)?e.push(exports.E(exports.E({},E),{height:560})):k.push(E),(null==T?void 0:T.enabled)||k.push(c),n.userManager.enableTimer||k.push(x),n.userManager.enableKanban||k.push(w),n.userManager.enableDocument||k.push(C),I&&S.forEach((function(e){I[e.id]||k.push(e)})),S=R(R([],S=S.filter((function(e){return!k.includes(e)})),!0),t,!0);var P,N=[],M=[];function A(e,t){e.forEach((function(e){var n=S.find((function(t){return t.id===e}));if(void 0!==n){var i=t===N?M:N;t.includes(n)||i.includes(n)||t.push(n)}}))}return A(n.customToolIndex.toolBar||[],N),A(n.customToolIndex.toolBox||[],M),A(eY,N),A(tY,M),A((P=S.filter((function(e){return!N.some((function(t){return t===e}))&&!M.some((function(t){return t===e}))})),P.map((function(e){return e.id}))),M),{toolList:S,toolBarList:N,toolBoxList:M,customToolList:e}}),[n.meetingMode,n.editable,n.viewLocked,i,n.standardPresentation,o,n.customToolIndex.toolBar,n.customToolIndex.toolBox,L]),u=c.toolList,d=c.toolBarList,p=c.toolBoxList,h=c.customToolList;return{toolList:u,toolBarList:d,toolBoxList:p,isSimple:a,onlyComment:s,customToolList:h,freshFunctionList:l}}({upime:n,customTools:i}),c=l.toolList,u=l.customToolList,d=l.toolBarList,p=l.toolBoxList,h=l.isSimple,f=l.onlyComment,m=l.freshFunctionList;return h||f?e.createElement(mY,{upime:n,allCustomTools:u,toolList:c,customizedUploader:r,hidden:o,isSimple:h,onlyComment:f,direction:a,latestUsedTool:s}):e.createElement(vY,{upime:n,allCustomTools:u,toolBarList:d,toolBoxList:p,customizedUploader:r,hidden:o,isSimple:h,onlyComment:f,freshFunctionList:m,direction:a,latestUsedTool:s})}function mY(t){var n,i=t.upime,r=t.customizedUploader,o=t.hidden,a=t.allCustomTools,s=t.toolList,l=t.isSimple,c=t.onlyComment,u=t.direction,d=void 0===u?"vertical":u,p=t.latestUsedTool,h=nY({upime:i,customizedUploader:r,hidden:o,allCustomTools:a,toolBarList:s,isSimple:l,onlyComment:c,direction:d}),f=h.switchShapeType,m=h.switchPenType,v=h.ready,g=h.toolRef,y=h.tool,b=h.setHide,E=h.handleToolClick,x=h.toolCenterRef,w=h.collapsedItems,C=h.skipRef,S=h.toggleHide,k=h.hide,_=h.secondaryPanelCmp,T=h.refreshToolbar,I=h.disableExpandAutoHide,P=h.enableExpandAutoHide,N=h.displayedItems,M=h.curPenType,A=h.disablePopAutoHide,D=h.curShapeType,R=h.subPanelRendering,B=h.calcRect,L=h.setDisablePopAutoHide,O=h.curCloseTool,F=null!==(n=null==p?void 0:p.render)&&void 0!==n?n:EY,z=null!==p&&void 0===N.find((function(e){return e.id===p.id}));return e.createElement(hK.Provider,{value:{switchShapeType:f,switchPenType:m,customizedUploader:r}},e.createElement(fK.Provider,{value:i.customImageEvent},e.createElement("div",{className:j(eK.toolbar,eK.simpleToolbar,"horiz"===d&&eK.horizMode,v?"":eK.waiting),ref:g},e.createElement(gY,{tool:y,upime:i,setHide:b,handleToolClick:E,direction:d}),e.createElement("div",{className:j(eK.toolCenter,"horiz"===d&&eK.toolCenterHorizMode),ref:x},N.map((function(t){var n=t.render||EY;return e.createElement(n,{key:t.id,tool:t,curShapeType:D,curPenType:M,upime:i,refreshToolbar:T,allCustomTools:a,setDisablePopAutoHide:L,subPanelRendering:R,disablePopAutoHide:A,setHide:b,handleToolClick:E,calcRect:B,curCloseTool:O,direction:d})}))),(!0===z||!!w.length)&&e.createElement("div",{className:j(eK.toolbarBottomWrap,"horiz"===d&&eK.toolbarBottomHorizontalMode,"vertical"===d&&eK.toolbarBottomVerticalMode)},null!==p&&!0===z&&e.createElement(hY,null,e.createElement(F,{key:p.id,tool:p,curShapeType:D,curPenType:M,upime:i,refreshToolbar:T,allCustomTools:a,setDisablePopAutoHide:L,subPanelRendering:R,disablePopAutoHide:A,setHide:b,handleToolClick:E,calcRect:B,curCloseTool:O,direction:d})),!!w.length&&e.createElement(e.Fragment,null,e.createElement("div",{className:j(eK.moreApps,"horiz"===d?eK.moreAppHorizMode:""),ref:C},e.createElement(xY,{upime:i,toggleHide:S,direction:d}),!k&&e.createElement(UK,{ref:_,upime:i,items:w,rootRef:g,close:function(){return b(!0)},refreshSrcCB:T,disablePanelPopupAutoHide:I,enablePanelPopupAutoHide:P,handleToolClick:E,direction:d})))))))}function vY(t){var n,i=t.upime,r=t.customizedUploader,o=t.hidden,a=t.allCustomTools,s=t.toolBarList,l=t.toolBoxList,c=t.isSimple,u=t.onlyComment,d=t.freshFunctionList,p=t.direction,h=void 0===p?"vertical":p,f=t.latestUsedTool,m=nY({upime:i,customizedUploader:r,hidden:o,allCustomTools:a,toolBarList:s,toolBoxList:l,isSimple:c,onlyComment:u,useToolBox:!0,direction:h}),v=m.switchShapeType,g=m.switchPenType,y=m.ready,b=m.toolRef,E=m.tool,x=m.setHide,w=m.handleToolClick,C=m.toolCenterRef,S=m.collapsedItems,k=m.skipRef,_=m.toggleHide,T=m.hide,I=m.secondaryPanelCmp,P=m.refreshToolbar,N=m.disableExpandAutoHide,M=m.enableExpandAutoHide,A=m.displayedItems,D=m.curPenType,B=m.disablePopAutoHide,L=m.curShapeType,O=m.subPanelRendering,F=m.calcRect,z=m.setDisablePopAutoHide,H=m.curCloseTool,U=m.extraToolBarItemCount,W=e.useRef(null),V=e.useRef(null),G=e.useRef(null);function q(){var e=i.customToolIndex.saveCustomToolIndex;e&&e({toolBar:i.customToolIndex.toolBar||[],toolBox:i.customToolIndex.toolBox||[]})}var K=function(t){var n=t.toolBarRef,i=t.displayedItems,r=t.collapsedItems,o=t.toolBarList,a=t.toolBoxList,s=t.onFresh,l=t.boxRefs,c=t.saveIndex,u=t.direction,d=void 0===u?"vertical":u,p=t.extraToolBarItemCount,h=void 0===p?0:p,f=e.useState(null),m=f[0],v=f[1],g=e.useState(null),y=g[0],b=g[1],E=function(){var t=e.useState({x:0,y:0}),n=t[0],i=t[1],r=e.useState(!1),o=r[0],a=r[1];return e.useEffect((function(){if(o){var e=null;return document.addEventListener("mousemove",t),document.addEventListener("touchmove",a),function(){r(),document.removeEventListener("mousemove",t),document.removeEventListener("touchmove",a)}}function t(e){i({x:e.clientX,y:e.clientY})}function n(e){var t=e;t.preventDefault(),i({x:t.touches[0].clientX,y:t.touches[0].clientY})}function r(){e&&(e.removeEventListener("touchmove",n),e.removeEventListener("touchend",r),e.removeEventListener("touchcancel",r)),e=null}function a(t){t.preventDefault(),t.target&&(t.target!==e&&r(),e=t.target,t.target.addEventListener("touchmove",n),t.target.addEventListener("touchend",r),t.target.addEventListener("touchcancel",r),e||i({x:t.touches[0].clientX,y:t.touches[0].clientY}))}}),[o]),{position:n,start:function(){a(!0)},stop:function(){a(!1),i({x:0,y:0})}}}(),x=E.position,w=E.start,C=E.stop,S=e.useContext(xl).upime,k=e.useState({left:0,right:0,top:0,bottom:0}),_=k[0],T=k[1];function I(){var e,t=null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect();void 0!==t&&T({left:t.left,top:t.top,right:t.right,bottom:t.bottom})}e.useEffect(I,[i.length,n.current]);var P=e.useState({left:0,right:0,top:0,bottom:0}),N=P[0],M=P[1];function A(){var e,t=l.toolScrollRef.current,n=(null==t?void 0:t.scrollTop)||0,i=null===(e=l.toolBoxBarRef.current)||void 0===e?void 0:e.getBoundingClientRect();i&&M({left:i.left,top:i.top+n,right:i.left+i.width,bottom:i.top+i.height+n})}e.useEffect(A,[r.length,l.toolBoxBarRef.current]),e.useEffect((function(){if(l.toolBoxBarRef.current)return l.toolBoxBarRef.current.addEventListener("transitionend",A),function(){var e;null===(e=l.toolBoxBarRef.current)||void 0===e||e.removeEventListener("transitionend",A)}}),[l.toolBoxBarRef.current]);var D=e.useState({left:0,right:0,top:0,bottom:0}),B=D[0],L=D[1];function O(){var e,t=l.toolScrollRef.current,n=(null==t?void 0:t.scrollTop)||0,i=null===(e=l.toolBoxRef.current)||void 0===e?void 0:e.getBoundingClientRect();i&&L({left:i.left,top:i.top+n,right:i.left+i.width,bottom:i.top+i.height+n})}e.useEffect(O,[a.length,l.toolBoxRef.current]),e.useEffect((function(){if(l.toolBoxRef.current)return l.toolBoxRef.current.addEventListener("transitionend",O),function(){var e;null===(e=l.toolBoxRef.current)||void 0===e||e.removeEventListener("transitionend",O)}}),[l.toolBoxRef.current]);var F=e.useState({left:0,right:0,top:0,bottom:0}),z=F[0],H=F[1];function U(){var e,t=null===(e=l.toolScrollRef.current)||void 0===e?void 0:e.getBoundingClientRect();t&&H({left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height})}return e.useEffect(U,[r.length+a.length,l.toolScrollRef.current]),e.useEffect((function(){if(m){var e=0,t=function(){e&&clearTimeout(e),m&&function(){var e,t;v(null),b(null),C(),c(),null!==m&&m.id===(null===(e=S.latestUsedTool)||void 0===e?void 0:e.id)&&(null===(t=S.customToolIndex.toolBar)||void 0===t?void 0:t.includes(m.id))&&(S.latestUsedTool=null)}()},n=null,u=function(e){g({x:e.clientX,y:e.clientY})},p=function(e){g({x:e.touches[0].clientX,y:e.touches[0].clientY})},f=function(e){!n&&e.target&&((n=e.target).addEventListener("touchend",t),n.addEventListener("touchcancel",t),n.addEventListener("touchmove",p))},g=function(n){var c,u;if(e&&clearTimeout(e),y){var p=function(e){var t,n=exports.E({},_);if(0===i.length&&("vertical"===d?(n.top-=19,n.bottom+=19):(n.left-=19,n.right+=19)),Ot(e,n)){var o="vertical"===d?exports.E({},_):{left:_.top,right:_.bottom,top:_.left,bottom:_.right},a="vertical"===d?exports.E({},e):{x:e.y,y:e.x};return{index:0===i.length?0:oY(a,o,40),type:"bar"}}if(!l.toolScrollRef.current)return null;var s=(null===(t=l.toolScrollRef.current)||void 0===t?void 0:t.scrollTop)||0,c=exports.E(exports.E({},N),{bottom:N.bottom-s});if(r.length&&Ot(e,c))return{index:oY(e,exports.E(exports.E({},c),{top:N.top-s}),44)+i.length-h,type:"bar",extra:"boxBar"};var u=exports.E(exports.E({},B),{top:B.top-s,bottom:B.bottom-s});return Ot(e,u)?{index:oY(e,u,44),type:"box"}:null}({x:n.x-y.x+19,y:n.y-y.y+19});if(p){var f=function(){var e=o.findIndex((function(e){return e.id===m.id}));if(-1!==e)return{index:e,type:"bar"};var t=a.findIndex((function(e){return e.id===m.id}));return-1!==t?{index:t,type:"box"}:null}();if(f){var v=R([],o,!0),g=R([],a,!0);("bar"===f.type?v:g).splice(f.index,1),p.type===f.type&&p.index>f.index&&p.index--,("bar"===p.type?v:g).splice(p.index,0,m),S.customToolIndex.toolBar=v.map((function(e){return e.id})),S.customToolIndex.toolBox=g.map((function(e){return e.id})),s(),("box"===p.type||"boxBar"==p.extra)&&(n.y-z.top<22&&(null===(c=l.toolScrollRef.current)||void 0===c||c.scrollBy(0,-22)),z.bottom-n.y<22&&(null===(u=l.toolScrollRef.current)||void 0===u||u.scrollBy(0,22))),_e.desktop||(e=window.setTimeout((function(){t()}),500))}}}};return document.addEventListener("mouseup",t),document.addEventListener("mousemove",u),document.addEventListener("touchend",t),document.addEventListener("touchcancel",t),document.addEventListener("touchmove",f),function(){document.removeEventListener("mouseup",t),document.removeEventListener("mousemove",u),document.removeEventListener("touchend",t),document.removeEventListener("touchcancel",t),document.removeEventListener("touchmove",f),n&&(n.removeEventListener("touchend",t),n.removeEventListener("touchcancel",t),n.removeEventListener("touchmove",p))}}}),[m,y,d]),{draggingTarget:m,mousePosition:x,startDrag:function(e,t){v(e),b({x:19,y:19}),I(),A(),O(),U(),w()},offset:y}}({toolBarRef:C,displayedItems:A,collapsedItems:S,toolBarList:s,toolBoxList:l,onFresh:function(){d(),P()},boxRefs:{toolBoxBarRef:W,toolBoxRef:V,toolScrollRef:G},saveIndex:q,direction:h,extraToolBarItemCount:U}),Y=K.draggingTarget,X=K.mousePosition,Q=K.offset,Z=K.startDrag;function J(e,t){i.editable&&Z(e,t)}var $=R([],A,!0);null!==f&&-1===$.findIndex((function(e){return e.id===f.id}))&&$.push(f);var ee=$.reduce((function(e,t,n){var i;return exports.E(exports.E({},e),((i={})[t.id]=n,i))}),{}),te=R([],A,!0);te.sort((function(e,t){return e.id>t.id?1:-1}));var ne=null!==(n=null==f?void 0:f.render)&&void 0!==n?n:EY,ie=null!==f&&void 0===te.find((function(e){return e.id===f.id}));return e.createElement(hK.Provider,{value:{switchShapeType:v,switchPenType:g,customizedUploader:r}},e.createElement(fK.Provider,{value:i.customImageEvent},e.createElement(mK.Provider,{value:{toolBoxBarRef:W,toolBoxRef:V,toolScrollRef:G}},e.createElement("div",{className:j(eK.toolbar,"horiz"===h&&eK.horizMode,y?"":eK.waiting),ref:b},e.createElement(gY,{tool:E,upime:i,setHide:x,handleToolClick:w,direction:h}),e.createElement("div",{className:j(eK.toolCenter),ref:C},te.map((function(t){var n=t.render||EY;return e.createElement(yY,{draggingTarget:Y,tool:t,index:ee[t.id],key:t.id,startDrag:J,direction:h},e.createElement(n,{tool:t,curShapeType:L,curPenType:D,upime:i,refreshToolbar:P,allCustomTools:a,setDisablePopAutoHide:z,subPanelRendering:O,disablePopAutoHide:B,setHide:x,handleToolClick:w,calcRect:F,curCloseTool:H,draggingTarget:Y,direction:h}))}))),e.createElement("div",{className:j(eK.toolbarBottomWrap,"horiz"===h&&eK.toolbarBottomHorizontalMode,"vertical"===h&&eK.toolbarBottomVerticalMode)},null!==f&&!0===ie&&e.createElement(hY,{className:eK.latestUsedToolForToolbarDrag},e.createElement(yY,{draggingTarget:Y,tool:f,index:ee[f.id],startDrag:J,direction:h,isLatestUsedTool:!0},e.createElement(ne,{key:f.id,tool:f,curShapeType:L,curPenType:D,upime:i,refreshToolbar:P,allCustomTools:a,setDisablePopAutoHide:z,subPanelRendering:O,disablePopAutoHide:B,setHide:x,handleToolClick:w,calcRect:F,curCloseTool:H,direction:h}))),e.createElement("div",{className:j(eK.moreApps,"horiz"===h?eK.moreAppHorizMode:""),ref:k},e.createElement(xY,{upime:i,toggleHide:function(){i.currentCustomTool=void 0,_()},direction:h}),!T&&e.createElement(sY,{ref:I,upime:i,items:S,toolBoxList:l.filter((function(e){return null===f||e.id!==f.id})),rootRef:b,close:function(){return x(!0)},refreshSrcCB:P,disablePanelPopupAutoHide:N,enablePanelPopupAutoHide:M,curCloseTool:H,handleToolClick:w,toToolBar:function(e){var t;(null===(t=i.customToolIndex.toolBar)||void 0===t?void 0:t.includes(e.id))||(i.customToolIndex.toolBar=R(R([],s.map((function(e){return e.id})),!0),[e.id],!1),i.customToolIndex.toolBox=l.map((function(e){return e.id})).filter((function(t){return t!==e.id})),d(),P(),q())},toToolBox:function(e){var t;(null===(t=i.customToolIndex.toolBox)||void 0===t?void 0:t.includes(e.id))||(i.customToolIndex.toolBox=R([e.id],l.map((function(e){return e.id})),!0),i.customToolIndex.toolBar=s.map((function(e){return e.id})).filter((function(t){return t!==e.id})),d(),P(),q())},draggingTarget:Y,startDrag:J,direction:h})))),Y&&e.createElement(bY,{key:Y.id,tool:Y,mousePosition:X,offset:Q||void 0}))))}function gY(t){var n=t.tool,i=t.upime,r=t.setHide,o=t.handleToolClick,a=t.direction,s=void 0===a?"vertical":a;return e.createElement("div",{className:j(eK.tool,eK.selectTool,i.xmode===n.xmode?eK.active:"",n.enabled||i.editable?"":eK.disable)},e.createElement(Dl,{content:n.name,placement:"horiz"===s?"top":"right",extraDistance:3,renderData:{fun:JK,data:{content:n.name,shortcut:n.shortcut}}},e.createElement("div",{className:j(eK.iconWrap,i.xmode===n.xmode?eK.iconWrapActive:""),onClick:function(e){e.stopPropagation(),r(!0),o(n)},"data-plugin-id":n.pannelType},e.createElement(hl,{icon:n.icon,size:24}))))}var yY=function(t){var n=t.index,i=t.startDrag,r=t.tool,o=t.children,a=t.draggingTarget,s=t.direction,l=void 0===s?"vertical":s,c=t.isLatestUsedTool,u=e.useRef(null),d=e.useRef(null),p=e.useRef(null);function h(){var e,t,n,i,r,o=null===(e=p.current)||void 0===e?void 0:e.getBoundingClientRect();return{left:null!==(t=null==o?void 0:o.left)&&void 0!==t?t:0,right:null!==(n=null==o?void 0:o.right)&&void 0!==n?n:0,top:null!==(i=null==o?void 0:o.top)&&void 0!==i?i:0,bottom:null!==(r=null==o?void 0:o.bottom)&&void 0!==r?r:0}}var f=e.useRef(null);function m(){f.current&&(clearTimeout(f.current),f.current=null)}function v(){u.current=null}e.useEffect((function(){return function(){f.current&&clearTimeout(f.current)}}),[]);var g={};return!0===c?(g.top=0,g.left=0):"vertical"===l?g.top=40*(n+1)+5:g.left=40*(n+1)+8,r.dragLock?e.createElement("div",{className:j(eK.dragableWrapper,r.id!==(null==a?void 0:a.id)&&eK.ani,"horiz"===l&&eK.dragHorizMode),style:g},o):e.createElement("div",{ref:d,onMouseDown:function(e){var t={x:e.clientX,y:e.clientY};Ot(t,h())&&(u.current=t)},onMouseUp:v,onPointerMove:function(e){var t;if(u.current){f.current&&clearTimeout(f.current),f.current=null;var n=u.current,o=n.x,a=n.y;if(Math.sqrt(Math.pow(e.clientX-o,2)+Math.pow(e.clientY-a,2))>vK){var s=null===(t=d.current)||void 0===t?void 0:t.getBoundingClientRect();if(s){var l={x:u.current.x-s.left-8,y:u.current.y-s.top};i(r,l),u.current=null}}}},onPointerLeave:v,onPointerUp:v,onTouchStart:function(e){if(1===e.touches.length){var t={x:e.touches[0].clientX,y:e.touches[0].clientY};Ot(t,h())&&(f.current&&clearTimeout(f.current),f.current=window.setTimeout((function(){var e;u.current=t;var n=null===(e=d.current)||void 0===e?void 0:e.getBoundingClientRect();if(n){var o={x:u.current.x-n.left,y:u.current.y-n.top};i(r,o),u.current=null}}),500))}},onTouchCancel:m,onTouchEnd:m,onTouchMove:m,className:j(eK.dragableWrapper,r.id!==(null==a?void 0:a.id)&&eK.ani,"horiz"===l&&eK.dragHorizMode),style:g},e.createElement("div",{className:eK.fakeIcon,ref:p}),o)},bY=function(t){var n=t.tool,i=t.mousePosition,r=t.offset,o=void 0===r?{x:0,y:0}:r,a=_e.desktop?0:20,s=i.x-o.x+a,l=i.y-o.y-a;return 0===i.x?null:e.createElement("div",{className:eK.draggingIconContainer,style:{top:"".concat(l,"px"),left:"".concat(s,"px")}},e.createElement(hl,{icon:n.icon,size:24}))};function EY(t){var n,i,r,o,a=t.upime,s=t.tool,l=t.curShapeType,c=t.curPenType,u=t.refreshToolbar,d=t.allCustomTools,p=t.setDisablePopAutoHide,h=t.subPanelRendering,f=t.disablePopAutoHide,m=t.setHide,v=t.handleToolClick,g=t.calcRect,y=t.curCloseTool,b=t.draggingTarget,E=t.direction,x=void 0===E?"vertical":E,w=W().getUpimeTrans,C=s.icon;"shape"===s.xmode&&(C=(null===(i=yK.find((function(e){return e.type===l})))||void 0===i?void 0:i.icon)||s.icon);var S=s.name;"pen"===s.tool&&("eraser"===a.xmode?(C="xiangpica",S=w("toolbar.xiangpica")):c===Ya.NORMAL?(C="huabi",S=w("toolbar.pen")):c===Ya.MARK?(C="yingguangbi",S=w("toolbar.markPen")):(C="zhinengtuhang",S=w("toolbar.smartDraw")));var k,_=LK.get(s.pannelType);k="string"==typeof s.xmode?s.xmode:s.tool;var T="string"==typeof s.xmode&&a.xmode===s.xmode||Array.isArray(s.xmode)&&s.xmode.includes(a.xmode),I=null!==(o=RK[null!==(r=s.pannelType)&&void 0!==r?r:PK.NONE])&&void 0!==o?o:0;if(s.pannelType!==PK.SHAPES||a.userManager.enableGraphic||(I-=64),"customImage"===s.tool){_=(T=!!a.currentCustomTool&&a.currentCustomTool.key===s.key)?s.pannel:void 0;var P=a.currentCustomTool||d.find((function(e){return e.key===s.key}));I=P&&null!=P.height?P.height:0,k=s.key||s.tool}var N=void 0!==s.autoHide?s.autoHide:!f,M=e.useRef(null),A=HK(a,s,M.current,x),D=A.onMouseEnter,R=A.onMouseLeave;return e.createElement(Dh,{id:"toolbar_".concat(k),useEscape:!0,renderData:void 0===_?void 0:{render:_,data:{upime:a,refreshSrcCB:u,disablePanelPopupAutoHide:function(){return p(!0)},enablePanelPopupAutoHide:function(){return p(!1)},direction:x}},extraStyle:(n={},n["horiz"===x?"marginBottom":"marginLeft"]="horiz"===x?4:3,n),rendering:h,onClick:function(e){e.stopPropagation(),m(!0),v(s)},placement:"horiz"===x?"top":"right",calcRect:g.bind(null,{height:I,width:0}),className:j(eK.tool,T?eK.active:"",s.enabled||a.editable||a.pluginManager.editable?"":eK.disable),autoHide:N,onClose:function(){y.current.toolInfo=s},focusOpen:s.focusOpen},e.createElement(Dl,{key:k,content:S,renderData:{fun:JK,data:{content:S,shortcut:s.shortcut}},placement:"horiz"===x?"top":"right",extraDistance:3},e.createElement("div",{className:j(eK.iconWrap,T?eK.iconWrapActive:""),onMouseEnter:D,onMouseLeave:R,ref:M},e.createElement(hl,{icon:C,size:24,style:{opacity:(null==b?void 0:b.id)===s.id?.2:1},onClick:function(e){b&&(e.stopPropagation(),e.preventDefault())}}))))}function xY(t){var n=t.upime,i=t.toggleHide,r=t.direction,o=void 0===r?"vertical":r,a=W().getUpimeTrans;return e.createElement("div",{className:j(eK.moreAppBtnCon,!n.editable&&eK.moreAppBtnConDisable)},e.createElement(Dl,{content:a("more.apps"),placement:"horiz"===o?"top":"right",extraDistance:3},e.createElement("div",{className:j(eK.iconWrap,"horiz"===o&&eK.rotate90),onClick:function(){n.editable&&(n.switchMode("select"),i())}},e.createElement(hl,{icon:"shuangshang",size:24}))))}var wY={iconWrap:"iconWrap_1Wmaq",iconWrapActive:"iconWrapActive_2tCGy",scaleToOriginWrap:"scaleToOriginWrap_3sUg8",scaleStatusBar:"scaleStatusBar_24ULR",map:"map_3K2jO",show:"show_1XHju",btns:"btns_rRn3C",on:"on_1Gt3s",minus:"minus_2EsPR",plus:"plus_2HL1C",btn:"btn_1CBmI",zhiyin_dianji:"zhiyin_dianji_3L8mG",scale:"scale_hQdHw",centerWrapper:"centerWrapper_2kh5H",fullscreen_setting:"fullscreen_setting_2AQD-",arrow_btn:"arrow_btn_3dUCg",setting_panel:"setting_panel_onZEz",label:"label_24uaR",switch_btn:"switch_btn_2MCW1"},CY=function(t){var n=t.map,i=e.useRef(null),r=e.useState(null);r[0];var o=r[1];e.useEffect((function(){var e=i.current,t=e.clientWidth;return o({width:t,height:160}),n.bindDom(e)}),[]);var a=e.useRef(null);return e.useEffect((function(){var e=!1,t=i.current,r=a.current,o={width:t.clientWidth,height:160};r.width=1*o.width,r.height=1*o.height;var s=new SY(1*o.width,1*o.height,n);var l=0,c=function(){e||(l=fr((function(){var e;((e=t.clientWidth)!==o.width&&(o.width=e,s.viewWidth=1*o.width,s.viewHeight=1*o.height,r.width=1*o.width,r.height=1*o.height,1)||!n.updated)&&(function(){if(a.current){var e=function(e,t){var n=function(e){var t={bottom:-1/0,top:1/0,left:1/0,right:-1/0,rotate:0},n=[],i=function(e){for(var r,o,a=e.children,s=0;s<a.length;s++){var l=a[s];if(l.isRefSystem)i(l);else{var c=l;if(c.elementType===Za.CONNECTIONLINE||c.elementType===Za.MINDMAP_LINE)continue;if(c.elementType===Za.MINDMAP_NODE&&c.isMindmapNodeHideByCollapsed)continue;if(c.elementType===Za.MINDMAP_NODE&&!c.isRootNode&&!c.root)continue;if(c.elementType===Za.STICKER&&(null===(o=(r=c).hideForPrivate)||void 0===o?void 0:o.call(r)))continue;if(c.elementType===Za.CARD&&(c.isGhost||c.isHideByFilter))continue;var u=c.getGlobalBox();u=Sn(u,u.rotate||0),null==t?t=exports.E({},u):(u.left<t.left&&(t.left=u.left),u.right>t.right&&(t.right=u.right),u.top<t.top&&(t.top=u.top),u.bottom>t.bottom&&(t.bottom=u.bottom)),n.push(u)}}};return i(e.view.elementsRoot),0===n.length?{boxes:n,contentBox:{bottom:0,top:0,left:0,right:0,rotate:0}}:{boxes:n,contentBox:t}}(e),i=function(e,t){var n=e.width,i=e.height,r=t.left,o=t.top,a=t.right,s=t.bottom,l=n/(a-r),c=i/(s-o),u=Math.min(l,c),d=n/u,p=i/u;return{x:(a+r)/2-d/2,y:(s+o)/2-p/2,width:d,height:p,scale:u}}(t,n.contentBox);return exports.E(exports.E({},n),i)}(n,{width:1*o.width,height:1*o.height}),t=e.boxes,i=e.contentBox,r=e.x,l=e.y,c=e.width,u=e.height,d=e.scale,p={x:r,y:l,width:c,height:u,scale:d};n.mapview=exports.E({},p),s.boxList=t,s.contentBox=i,s.scale=d,s.mapview=exports.E({},p),s.getContext()||s.setContext(a.current.getContext("2d")||void 0),s.render()}}(),n.updated=!0),c()})))};return c(),function(){e=!0,mr(l)}}),[]),e.createElement("div",{className:"map_2KAE-",ref:i},e.createElement("canvas",{ref:a,className:"map_canvas_12Ma6"}))},SY=function(e){function t(t,n,i){var r=e.call(this)||this;return r.viewWidth=t,r.viewHeight=n,r.map=i,r.context=void 0,r.boxList=[],r.contentBox={left:0,right:0,top:0,bottom:0,rotate:0},r.mapview={x:0,y:0,width:0,height:0},r.scale=1,r.transform=sr,r.renderContext={currentPainter:{},alpha:1,transform:sr,viewWidth:r.viewWidth,viewHeight:r.viewHeight,drawImageCount:0,context:{}},r}return P(t,e),t.prototype.getContext=function(){return this.context},t.prototype.setContext=function(e){e&&(this.context=e,this.renderContext.context=e)},t.prototype.paint=function(){this._paintBg(),this._paintBoxs(),this._paintView()},t.prototype._paintBg=function(){fa({fill:"#ffffff"}),ka({x:0,y:0,width:this.viewWidth,height:this.viewHeight}),ma()},t.prototype._paintBoxs=function(){var e=this;fa({fill:"#2e73e5",alpha:.5}),this.boxList.forEach((function(t){var n=e.scale*(t.left-e.mapview.x),i=e.scale*(t.top-e.mapview.y),r=e.scale*(t.right-t.left),o=e.scale*(t.bottom-t.top);r<1&&o<1||ka({x:n,y:i,width:r,height:o})})),ma()},t.prototype._paintView=function(){fa({fill:"#ffa519",fillAlpha:.1,stroke:"#ffa519",lineWidth:1});var e=this.map.view.getViewbox(),t=this.scale*(e.left-this.mapview.x),n=this.scale*(e.top-this.mapview.y),i=this.scale*(e.right-e.left),r=this.scale*(e.bottom-e.top);if(r<4){var o=n+r/2,a=i/r;t=t+i/2-(i=(r=4)*a)/2,n=o-r/2}ka({x:t,y:n,width:i,height:r}),ma()},t.prototype.processElement=function(e){this.context&&e.paint(this.renderContext)},t}(ya);function kY(t){var n=t.upime,i=t.onclick,r=W().getUpimeTrans,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u=n.hideToolbar;return e.createElement("div",{className:wY.fullscreen_setting,ref:c},e.createElement("div",{className:j(wY.arrow_btn,!a&&wY.on),onClick:function(){null==i||i(),l()}},e.createElement("div",{className:j(wY.iconWrap,!1===a&&wY.iconWrapActive)},e.createElement(hl,{className:wY.arrow_icon,icon:"shuangshang"}))),!a&&e.createElement("div",{className:wY.setting_panel},e.createElement("div",{className:wY.label,onClick:function(){!function(){var e=!u;n.publish("toolbarVisibilityChange",e?"hidden":"visible"),n.hideToolbar=e,_c("cv_exitfullscreen",{action:e?"隐藏工具栏":"取消隐藏工具栏"})}(),s(!0)}},e.createElement("span",null,r("fullscreen.showOrHideToolbar")),e.createElement("span",null,"".concat(_e.isMac?"⌘":"Ctrl"," \\")))))}function _Y(t){var n,i=t.upime,r=t.className,o=t.hide,a=t.hideMapAndScale,s=W().getUpimeTrans,l=e.useContext(Ic),c=l.rightSideOpened,u=l.toggleRightSide,d=l.rightSubSlideOpened,p=e.useState(i.displayedViewScale),h=p[0],f=p[1],m=e.useState(!1),v=m[0],g=m[1],y=e.useState("caozuozhiyin"),b=y[0],E=y[1],x=e.useState(!0),w=x[0],C=x[1];function S(){_c("cv_zoomout"),i.zoomViewBy(-.1)}al(i,["customBottomRightTools"]),e.useEffect((function(){f(i.displayedViewScale);var e=[i.view.subscribe("viewboxChange",(function(){f(i.displayedViewScale)})),i.view.subscribe("borderBoxFocused",(function(e){g(!1),C(!e)}))];return function(){return e.forEach((function(e){return e()}))}}),[]),e.useEffect((function(){E(c?"caozuozhiyin-dianji":"caozuozhiyin")}),[c]);var k=e.useContext(Ic).extensionConfigs,_=k.fullscreen,T=k.ai,I=k.miniMap,P=k.helpCenter;return e.createElement(e.Fragment,null,T&&i.chatgptConfig&&e.createElement(MF,{config:i.chatgptConfig,upime:i,hide:o}),e.createElement("div",{className:j(wY.scaleStatusBar,r),style:d?{marginRight:"8px"}:void 0},e.createElement("div",{className:j(wY.map,v&&wY.show)},v&&!a&&e.createElement(CY,{map:i.elementMap})),e.createElement("div",{className:wY.btns},a?null:e.createElement(e.Fragment,null,I&&w&&e.createElement(Dl,{content:s(v?"scaleBar.hideMap":"scaleBar.showMap"),placement:"top",extraDistance:2},e.createElement(ul,{onClick:function(){_c("cv_map"),g(!v)},className:j(wY.btn_style,wY.btn,v&&wY.on)},e.createElement("div",{className:j(wY.iconWrap,v?wY.iconWrapActive:"")},e.createElement(hl,{icon:"ditu"})))),e.createElement(Dl,{content:s("scaleBar.scaleDown"),placement:"top",extraDistance:2},e.createElement("div",{className:j(wY.iconWrap,wY.minus),onClick:S},e.createElement(ul,{onClick:S,className:j(wY.btn,wY.minus)},e.createElement(hl,{icon:"subtract"})))),e.createElement(Dl,{content:s("scaleBar.scaleToOrigin"),placement:"top",extraDistance:2},e.createElement("div",{className:j(wY.iconWrap,wY.scale,wY.scaleToOriginWrap),onClick:function(){_c("cv_resetscale"),i.resetZoom()}},"".concat(Math.floor(100*h),"%"))),e.createElement(Dl,{content:s("scaleBar.scaleUp"),placement:"top",extraDistance:2},e.createElement("div",{className:j(wY.iconWrap,wY.plus),onClick:function(){_c("cv_zoomin"),i.zoomViewBy(.1)}},e.createElement(hl,{icon:"plus"})))),_&&e.createElement(Dl,{content:s(i.fullscreenMode?"fullscreen.exit":"fullscreen.enter"),placement:"top",extraDistance:2},e.createElement("div",{className:j(wY.iconWrap)},e.createElement("div",{className:wY.centerWrapper,onClick:i.fullscreenMode?function(){return i.endFullScreen("click")}:i.startFullscreen},e.createElement(hl,{icon:i.fullscreenMode?"tuichuquanping":"baibanquanping"})))),null===(n=i.customBottomRightTools)||void 0===n?void 0:n.map((function(t){var n=e.createElement("div",{className:j(wY.iconWrap,t.className),onClick:t.onClick,style:t.style},"string"==typeof t.icon?e.createElement(hl,{icon:t.icon}):e.createElement(t.icon,{iconClassName:dl}));return t.name?e.createElement(Dl,{content:t.name,key:t.key,placement:"top",className:wY.tip},n):n})),!1===i.hideToolbar&&!1!==P&&e.createElement(Dl,{content:s("scaleBar.help"),placement:"top",extraDistance:2},e.createElement("div",{className:j(wY.iconWrap,c?wY.iconWrapActive:""),onClick:u},e.createElement("div",{className:wY.centerWrapper},e.createElement(hl,{icon:b,className:wY.zhiyin})))),e.createElement(kY,{upime:i}))))}var TY,IY=(TY=new Map([[Za.FRAME,"huaban"],[Za.SHAPE,"xingzhuang"],[Za.TEXT,"wenben"],[Za.MINDMAP_NODE,"siweidaotu"],[Za.STICKER,"bianqian"],[Za.CARD,"kapian"],[Za.KANBAN,"kanban"],[Za.DOCUMENT,"wenjian"],[Za.BIG_DOC,"wendangyuansu"],[Za.IMAGE,"tupian"],[Za.VIDEO,"shipin"],[Za.AUDIO,"yinpin"],[Za.TABLE,"biaoge"],[Za.WEBPAGE,"neiqianwangye"],[Za.CONNECTIONLINE,"lianjiexian"]]),function(e){var t=TY.get(e.elementType);return void 0===t&&(t="wenben"),t}),PY=function(){var e=0,t=new Map([[Za.FRAME,e++],[Za.SHAPE,e++],[Za.TEXT,e++],[Za.MINDMAP_NODE,e++],[Za.STICKER,e++],[Za.CARD,e++],[Za.KANBAN,e++],[Za.DOCUMENT,e++],[Za.BIG_DOC,e++],[Za.IMAGE,e++],[Za.VIDEO,e++],[Za.AUDIO,e++],[Za.TABLE,e++],[Za.WEBPAGE,e++],[Za.CONNECTIONLINE,e++]]);return function(e){var n=t.get(e.elementType);return void 0===n&&(n=Number.MAX_VALUE),n}}(),NY=function(t){var n=t.upime,i=t.item;return e.createElement("div",{className:"resItem_3veGW",onClick:function(){var e=i.element,t=e;if(e.elementType===Za.MINDMAP_NODE&&e.isMindmapNodeHideByCollapsed&&(e=e.seekUnHideParent()),e){var r=e.size.width/i.element.size.height;n.showElement(e,exports.E(exports.E(exports.E({},r>=1&&{left:200,right:200}),r<1&&{top:200,bottom:200}),{duration:500})),(null==e?void 0:e.elementType)===Za.CARD&&e.pareantKanban&&(e=e.pareantKanban),e&&(n.selectElement(e),t!==e&&e.elementType===Za.KANBAN&&t.elementType===Za.CARD&&e.selectCard(t))}}},e.createElement(hl,{icon:i.icon}),e.createElement("span",null,i.text))},MY=function(t){var n=t.upime,i=yh(!0,{quick:!0}),r=i.hide,o=i.toggleHide,a=i.skipRef,s=i.setHide,l=W().getUpimeTrans,c=function(t){var n=e.useState(null),i=n[0],r=n[1],o=e.useState(""),a=o[0],s=o[1],l=function(e){if(e.trim()){var n=[],i=t.elementManager,o=function(i){var r,o,a=i.searchText(e);a&&n.push({element:i,lastEdit:null!==(o=null===(r=t.getElementInfo(i.id).item)||void 0===r?void 0:r.updateTime)&&void 0!==o?o:Date.now()/1e3,text:a,icon:IY(i),priority:PY(i)})};i.getAvailableFrames(o),i.getAvailableElements(o),n.sort((function(e,t){return e.priority===t.priority?t.lastEdit-e.lastEdit:e.priority-t.priority})),r(n)}else r([])};return{searchRes:i,search:e.useCallback(te(l,200),[]),searchStr:a,setSearchStr:s,setSearchRes:r,immediateSearch:l}}(n),u=c.searchStr,d=c.setSearchStr,p=c.searchRes,h=c.search,f=c.setSearchRes,m=e.useRef(null);e.useEffect((function(){return n.subscribe("onSearchElement",(function(){s(!1),setTimeout((function(){var e;null===(e=m.current)||void 0===e||e.focus()}))}))}),[]),e.useEffect((function(){var e;!r&&m.current&&(null===(e=m.current)||void 0===e||e.focus()),r&&v()}),[r,m.current]),e.useEffect((function(){if(!r){var e=new WeakSet,t=new WeakSet;p&&p.forEach((function(n){var i=n.element;if(e.add(i),i.elementType===Za.MINDMAP_NODE)if(i.isMindmapNodeHideByCollapsed){var r=i.seekUnHideParent();r&&t.add(r)}else t.add(i);else t.add(i)})),n.searchMatchedEles=e,n.searchHighlightEles=t}n.updateView()}),[r,p]),e.useEffect((function(){if(!r)return n.clearSelect(),function(){n.searchMatchedEles=void 0}}),[r]);var v=function(){d(""),f(null),n.searchMatchedEles=void 0,n.searchHighlightEles=void 0};return n.viewLocked?null:e.createElement("div",{ref:a,style:{position:"relative"}},e.createElement(Dl,{renderData:{fun:function(){return e.createElement("div",{className:"shortcutContainer_1cjp7"},e.createElement("div",null,l("search.icon.hint")),e.createElement("div",{className:"shortcutBox_WsmCb"}," ",_e.isMac?"⌘":"Ctrl"," + F"))},data:{}},extraDistance:6},e.createElement("div",{className:j("iconWrap_2ynjE",!1===r&&"iconWrapActive_2fyFy"),onClick:function(){_c("cv_search"),o(),setTimeout((function(){var e;null===(e=m.current)||void 0===e||e.focus()}))}},e.createElement(hl,{icon:"sousuo"}))),!r&&e.createElement(xh,{align:"right",selfAdjust:!0,extraStyle:{marginTop:10}},e.createElement("div",{className:"searchMenu_1d27V"},e.createElement("div",{className:"inputContainer_Ka7Zr"},e.createElement("input",{placeholder:l("search.icon.hint"),onChange:function(e){d(e.target.value),f(null),h(e.target.value)},value:u,ref:m}),u&&e.createElement("div",{className:"clearInput_3gyGp",onClick:function(){var e;v(),null===(e=m.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"}))),p&&e.createElement(e.Fragment,null,e.createElement("div",{className:"divider_1Qt9p"}),e.createElement("div",{className:"searchRes_1D7-t"},p.length?e.createElement("div",{className:"resList_3boZV"},p.map((function(t,i){return e.createElement(NY,{item:t,upime:n,key:i})}))):e.createElement("div",{className:"noRes_3Cuqe"},l("search.noRes.text")))))))},AY="titleBar_3_cD4",DY="menuContainer_2g0Pr",RY="exportDialog_18eap",BY="title_2KDGr",LY="tips_20MwE",OY="info_1jFb9",FY="label__qO75",zY="pdfDialog_BM8nl",HY="btnContainer_3SLwM",UY="checked_eevrx",WY="disabled_2uYzl",VY="exportConfirm_3g8yz",jY="exportingDiv_BCVdG",GY="exportCancel_VbKPV",qY="exportSettingItem_1tZIl",KY="exportOption_UJomG",YY="icon_1ADv4",XY="name_55qfY",QY="exportFrameOption_1HxlC",ZY="content_2W0mn",JY=function(t){var n=t.upime,i=t.boardTitle,r=t.viewPickWidget,o=W().getUpimeTrans;al(n.viewPickWidget,["size","position"]);var a=n.userManager,s=a.enableExportHQImage,l=a.userAccessHint,c=r.getBorderBox(),u=c.right-c.left,d=c.bottom-c.top,p=[{title:o("exportImage.s"),scale:1,disabled:!1},{title:o("exportImage.m"),scale:4,disabled:!s},{title:o("exportImage.l"),scale:7,disabled:!s}].map((function(e){var t=e.title,n=e.scale,i=e.disabled,r={width:0,height:0};if(u>1&&d>1){var o=u/d,a=Math.round(1e3/Math.sqrt(o)*n*(1==n?window.devicePixelRatio:1));r={width:Math.round(a*o),height:a}}return{title:t,scale:n,size:r,disabled:i}})),h=e.useState(0),f=h[0],m=h[1],v=p[f],g=e.useRef(!0),y=e.useState(!1),b=y[0],E=y[1];return e.useEffect((function(){return g.current=!0,function(){g.current=!1}}),[]),e.createElement("div",{className:j(RY)},e.createElement("span",{className:j(BY)},o("exportImage.title")),p.map((function(t,n){return e.createElement("div",{key:n,className:j(qY,t.disabled&&WY),onClick:function(){t.disabled||function(e){f!==e&&m(e)}(n)}},e.createElement("label",{className:j(FY,n===f&&UY)},t.title),e.createElement("span",{className:j("fileFormat_2dEfN")},"JPG"),e.createElement("span",{className:"dimensions_tsq-y"},"".concat(t.size.width," × ").concat(t.size.height," px")))})),!s&&l.ExportHQImageHint?e.createElement("div",{className:j(LY)},e.createElement(l.ExportHQImageHint,null)):null,e.createElement("div",{className:j(HY)},e.createElement(ul,{className:j(VY),onClick:function(){return A(this,void 0,void 0,(function(){var e,t,r,o,a,s,l,d,p,h,f;return D(this,(function(m){switch(m.label){case 0:return b?[2]:(E(!0),e=n.elementManager.getFrames(c),t=v.size,r=t.width/u,o=n.watermarkUrl,a=o?{watermarkUrl:o,position:{right:30*v.scale,bottom:20*v.scale}}:void 0,window._debug_export_svg_?[4,Yf({upime:n,frames:e,viewbox:exports.E(exports.E({},c),{scale:r}),size:t,timeout:1e4,useBgImage:!0})]:[3,2]);case 1:return s=m.sent(),l=Y(s),(d=document.createElement("a")).download="".concat(i,".svg"),d.style.display="none",d.href=URL.createObjectURL(l),document.body.appendChild(d),d.click(),URL.revokeObjectURL(d.href),document.body.removeChild(d),n.setExportView(!1),[2];case 2:return[4,Qf({upime:n,frames:e,viewbox:exports.E(exports.E({},c),{scale:r}),size:t,timeout:1e4,background:16777215,watermark:a,useBgImage:!0})];case 3:return p=m.sent(),g.current?(h=K(p),(f=document.createElement("a")).download="".concat(i,".jpg"),f.style.display="none",f.href=URL.createObjectURL(h),document.body.appendChild(f),f.click(),URL.revokeObjectURL(f.href),document.body.removeChild(f),n.setExportView(!1),[2]):[2]}}))}))},type:"primary"},b?e.createElement(hl,{className:jY,icon:"jiazai"}):o("export.board.confirm")),e.createElement("button",{className:j(GY),onClick:function(){n.setExportView(!1)}},o("common.cancel"))))},$Y=function(t){var n=t.upime,i=t.boardTitle,r=t.watermarkUrl;return 0===n.framesListManager.sequentialFrames.length?e.createElement(eX,{upime:n}):e.createElement(tX,{upime:n,boardTitle:i,watermarkUrl:r})},eX=function(t){var n=t.upime,i=W().getUpimeTrans,r=i("exportPdf.description").split("\n");return e.createElement("div",{className:j(RY,zY)},e.createElement("span",{className:j(BY)},i("exportPdf.title")),e.createElement("div",{className:j(OY)},r.map((function(t,n){return e.createElement("div",{key:n},t)}))),e.createElement("span",{className:j(OY)},i("exportPdf.mustCreateFrame")),e.createElement("div",{className:j(HY)},e.createElement(ul,{className:j(VY),onClick:function(){n.setExportPdf(!1),n.insertNewFrame()},type:"primary"},i("exportPdf.createFrame")),e.createElement("button",{className:j(GY),onClick:function(){return n.setExportPdf(!1)}},i("common.cancel"))))},tX=function(t){var n=t.upime,i=t.boardTitle,r=t.watermarkUrl,o=W().getUpimeTrans,a=e.useState("common"),s=a[0],l=a[1],c=e.useState(!1),u=c[0],d=c[1],p=e.useRef(null),h=n.userManager,f=h.enableExportHQPDF,m=h.userAccessHint;e.useEffect((function(){return function(){var e;null===(e=p.current)||void 0===e||e.destroy()}}),[]);var v=[{text:o("exportPdf.common"),type:"common",disabled:!1},{text:o("exportPdf.best"),type:"best",disabled:!f}];return e.createElement("div",{className:j(RY,zY)},e.createElement("span",{className:j(BY)},o("exportPdf.title")),v.map((function(t){var n=t.text,i=t.type,r=t.disabled;return e.createElement("div",{key:i,className:j(qY,r&&WY),onClick:function(){t.disabled||l(i)}},e.createElement("label",{className:j(FY,i===s&&UY)},n))})),!f&&m.ExportHQPdfHint?e.createElement("div",{className:j(LY)},e.createElement(m.ExportHQPdfHint,null)):null,e.createElement("div",{className:j(HY)},e.createElement(ul,{className:j(VY),onClick:function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return u?[2]:(d(!0),"common"!==s?[3,2]:(e=new cm(n),p.current=e,[4,e.exportPdf({fileName:i,watermarkUrl:r})]));case 1:return t.sent(),[3,4];case 2:return e=new cm(n),p.current=e,[4,e.exportPdfBySvg({fileName:i,watermarkUrl:r})];case 3:t.sent(),t.label=4;case 4:return n.setExportPdf(!1),[2]}}))}))},type:"primary"},u?e.createElement(hl,{className:jY,icon:"jiazai"}):o("export.board.confirm")),e.createElement("button",{className:j(GY),onClick:function(){return n.setExportPdf(!1)}},o("common.cancel"))))},nX=function(t){var n=W().getUpimeTrans;return e.createElement(xc,{icon:"jingshi",iconStyles:{color:"#FFA519"},title:n("frameList.empty"),bodyContent:n("export.frame.empty.tip"),cancelText:n("modal.cancel"),confirmText:n("exportPdf.createFrame"),onCancel:function(){t.success(!1)},onConfirm:function(){t.success(!0)}})},iX=function(t){var n,i=t.upime,r=W().getUpimeTrans,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u=yh(!0),d=u.hide,p=u.setHide,h=u.skipRef,f=function(e){!1==i.framesListManager.sequentialFrames.length>0?i.showWindow(nX).then((function(e){!0===e&&i.insertNewFrame()})):i.showWindow(Lg,{fileType:e,aplusInfo:{entry:"左上角工具栏导出"}},void 0,void 0,void 0,(function(e){}))},m=null!==(n=i.userManager.userAccessHint)&&void 0!==n?n:{},v=m.ExportFrameAsPowerPointHint,g=m.ExportFrameAsImageHint;return e.createElement("div",{ref:c,style:{position:"relative"}},e.createElement(Dl,{content:r("title.download"),placement:"bottom",extraDistance:6},e.createElement("div",{className:j("iconWrap_1CkvW",!1===a&&"iconWrapActive_1O5kX"),onClick:function(){_c("cv_download"),l()}},e.createElement(hl,{icon:"xiazai"}))),!a&&e.createElement(xh,{align:"left",className:"exportOptions_3cYnE",extraStyle:{marginTop:10}},e.createElement("div",{className:KY,onClick:function(){_c("cv_download_img"),s(!0),i.setExportView(!0),i.followManager.stopFollowCurrent()},onPointerMove:function(){p(!0)}},e.createElement(hl,{className:YY,icon:"tupian"}),e.createElement("div",{className:XY},r("title.exportAsImageBtnTip"))),i.userManager.enableExportPDF&&e.createElement("div",{className:"exportOptionWrap_1AIp4",ref:h},e.createElement("div",{className:KY,onPointerMove:function(){p(!1)}},e.createElement(hl,{className:YY,icon:"wenjian"}),e.createElement("div",{className:XY},r("title.exportFrameBtnTip")),e.createElement(hl,{className:"iconArrow_1-8IO",icon:"youjiantou"})),!1===d&&e.createElement("div",{className:"exportFrameOptions_xgP_7"},e.createElement("div",{className:QY,onClick:function(){s(!0),f(tf.Pdf)}},"PDF"),e.createElement("div",{className:QY,onClick:function(){var e;s(!0),!0===i.canExportFrameAsPowerPoint?f(tf.Pptx):null===(e=i.handleExportFrameAsPowerPoint)||void 0===e||e.call(i)}},e.createElement("span",{className:ZY},r("export.frame.as.ppt")),!0!==i.canExportFrameAsPowerPoint&&void 0!==v&&e.createElement(v,null)),e.createElement("div",{className:QY,onClick:function(){var e;s(!0),!0===i.canExportFrameAsImage?f(tf.Image):null===(e=i.handleExportFrameAsImage)||void 0===e||e.call(i)}},e.createElement("span",{className:ZY},r("export.frame.as.image")),!0!==i.canExportFrameAsImage&&void 0!==g&&e.createElement(g,null))))))},rX=function(t){var n=t.upime,i=t.className,r=t.title,o=e.useContext(Ic),a=o.extensionConfigs,s=o.leftSideOpened,l=a.search,c=a.download,u=e.useState(),d=u[0],p=u[1],h=e.useRef(null);return e.useEffect((function(){return n.subscribe("titleBarResize",(function(e){p(e-(h.current?h.current.clientWidth+26:0))}))}),[]),e.useEffect((function(){setTimeout((function(){n.publish("titleBarReady","")}),20)}),[s]),e.createElement("div",{className:j(AY,i),id:"titleBar"},r&&r(d,(function(e){var t;n.titleBarMinWidth=e+((null===(t=h.current)||void 0===t?void 0:t.clientWidth)||0)+26})),e.createElement("div",{className:DY,ref:h},c&&n.userManager.enableExportImage&&n.downloadConfig.enable&&e.createElement(iX,{upime:n}),l&&e.createElement(MY,{upime:n})))},oX=function(t){var n=this,i=t.upime,r=t.className,o=i.customTemplate,a=o.title,s=o.description,l=o.type,c=o.subjectId,u=e.useState({title:a,description:s,type:l,subjectId:c}),d=u[0],p=u[1],h=W().getUpimeTrans;return e.createElement("div",{className:j(AY,r,"titleBarTemplate_3phXE")},e.createElement("div",{className:DY},e.createElement(ul,{type:"primary",onClick:function(){return A(n,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return i.saveTemplateInTemplateMode?[4,i.saveTemplateInTemplateMode(d)]:[3,2];case 1:if((e=t.sent())&&0===e.code)return i.addToast(h("template.save.empty")),[2];t.label=2;case 2:return i.handleBackAndOpenTemplateModal&&i.handleBackAndOpenTemplateModal(),[2]}}))}))}},h("template.save.exit")),e.createElement(Dl,{content:h("template.edit.hint")},e.createElement(ul,{type:"ghost",className:"newTemplate_3gtiE",onClick:function(){return A(n,void 0,void 0,(function(){var e,t,n,r,o;return D(this,(function(a){switch(a.label){case 0:return i.handleCustomTemplateModal?[4,i.handleCustomTemplateModal(!0)]:[2];case 1:return(e=a.sent())?(t=e.title,n=e.description,r=e.type,o=e.subjectId,p({title:t,description:n,type:r,subjectId:o}),[2]):[2]}}))}))}},d.title)),e.createElement("div",{className:"divider_1wq-Y"}),e.createElement(MY,{upime:i})))},aX="user_2K78E",sX="clickAble_26AJz",lX="avatar_wrapper_1D3om",cX="avatar_3qA7l",uX="name_31K8R",dX=function(t){var n=t.color;return e.createElement("div",{className:"follow_tag_2XHdp",style:{backgroundColor:hr(n,.6)}},e.createElement(hl,{icon:"gensui"}))},pX=function(t){var n=t.color,i=t.count;return e.createElement("div",{className:"follow_count_3Lszr",style:{backgroundColor:pr(n)}},i)},hX=function(t){var n=t.followers,i=t.self,r=W().getUpimeTrans;return e.createElement("div",{className:"follow_tip_H3mDc"},e.createElement("div",{className:uX},i.userName),e.createElement("div",{className:"split_3g0SZ"}),e.createElement("div",{className:"info_veEdt"},1==n.length?r("follow.oneIsFollowing",n[0].userName):r("follow.nAreFollowing",n.length)))},fX=function(t){var n=t.user,i=t.className,r=t.onClick,o=t.following,a=t.followers,s=t.noTip,l=void 0!==s&&s;al(n);var c=pr(n.color),u=a&&a.length>0,d=u?{fun:hX,data:{followers:a,self:n}}:void 0,p=W().getUpimeTrans,h=e.useContext(xl).upime,f=n.userName;return n.userName!==h.localUserInfo.userName&&(f=o?p("follow.click.unfollow")+" "+f:p("follow.click.follow")+" "+f),l?e.createElement("div",{className:j(i,aX,void 0!==r&&sX),onClick:r,style:{borderColor:c}},e.createElement("div",{className:lX},e.createElement(ml,{className:cX,url:n.avatarUrl,shape:"circle"}),o&&e.createElement(dX,{color:n.color}),u&&e.createElement(pX,{color:n.color,count:a.length}))):e.createElement("div",{className:j(i,aX,void 0!==r&&sX),onClick:r,style:{borderColor:c}},e.createElement(Dl,{placement:"bottom",content:d?void 0:f,renderData:d,className:j("tip_2z0Da",u&&"followed_22Ojr")},e.createElement("div",{className:lX},e.createElement(ml,{className:cX,url:n.avatarUrl,shape:"circle"}),o&&e.createElement(dX,{color:n.color}),u&&e.createElement(pX,{color:n.color,count:a.length}))))},mX=function(t){var n=t.user,i=t.className,r=t.onClick,o=t.following,a=t.matchStr;al(n);var s=bh(a,n.userName).sects;return e.createElement("div",{className:j(i,"user_item_1CdQC",void 0!==r&&Ml.btn_style),onClick:r},e.createElement("div",{className:j(i,aX),style:{borderColor:pr(n.color)}},e.createElement(ml,{className:cX,url:n.avatarUrl,shape:"circle"}),o&&e.createElement(dX,{color:n.color})),e.createElement("span",{className:uX},s.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&"highlight_PjKdQ"),key:n},t.value):t.value}))))},vX="member_1lOqZ",gX="list_content_2rjFZ",yX="list_item_14ROj",bX="follow_me_btn_2KIVe",EX="disabled_1SjLO",xX="userNameSearch_13X-p",wX="noSearchRes_22FTe",CX=function(t){var n=t.upime,i=n.usersCursorsManager,r=W().getUpimeTrans,o=e.useRef(!1),a=e.useRef(null);al(i,["active"]),e.useEffect((function(){a.current&&(i.active?a.current.classList.add(Ml.on):a.current.classList.remove(Ml.on))}),[i.active]);var s=i.active?r("usersCursors.hide"):r("usersCursors.show");return e.createElement(Dl,{content:s,placement:"bottom",extraDistance:6},e.createElement("div",{className:j("cursor_btn_3ZHOT",Ml.btn_style,"iconWrap_1LwK7",i.active?"iconWrapActive_3-Sbv":""),onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,r,s;return D(this,(function(l){switch(l.label){case 0:return e=i.active,t=!i.active,a.current&&(t?(o.current=!1,a.current.classList.add(Ml.btn_style)):(o.current=!0,a.current.classList.remove(Ml.btn_style))),_c("cv_cursors",{show_cursor:t?"显示":"隐藏"}),t?[4,i.showCursors(!0)]:[3,2];case 1:return l.sent(),[3,3];case 2:i.hideCursors(!0),l.label=3;case 3:return e!==i.active&&(null===(s=(r=n.userManager).onChangeShowOtherCursor)||void 0===s||s.call(r,i.active)),[2]}}))}))},ref:a,onPointerLeave:function(){o.current&&a.current&&(a.current.classList.add(Ml.btn_style),o.current=!1)}},e.createElement(hl,{icon:"guangbiao"})))},SX=function(t){var n,i=t.upime,r=t.self,o=t.children,a=W().getUpimeTrans,s=i.followManager,l=i.standardPresentation;al(i.userManager,["onlineUsers"]),al(i,["meetingMode"]),al(s,["followingUser","followers","forcedFollowing"]);var c=i.userManager.onlineUsers,u=s.followingUser,d=s.followers,p=e.useState([]),h=p[0],f=p[1];e.useEffect((function(){if(u){var e=R([u.loginName],h.filter((function(e){return e!==u.loginName})),!0);e.length>3&&e.pop(),f(e)}}),[u]),e.useEffect((function(){var e=h.filter((function(e){return c.find((function(t){return t.loginName===e}))}));e.length!==h.length&&f(e)}),[c]);var m=e.useState(""),v=m[0],g=m[1],y=3,b=c.length>3;b&&(y=2);var E=e.useState(""),x=E[0],w=E[1],C=e.useRef("0px");function S(e,t){var n,r,o;C.current=t||"".concat(q-34,"px");var a=i.shareAssistantManager&&(null===(n=i.shareAssistantManager.sharer)||void 0===n?void 0:n.userId)===e.loginName;if(u===e){if(a)return;s.endFollowOther(e)}else{var l=void 0;a&&(l={connId:null===(o=null===(r=i.shareAssistantManager)||void 0===r?void 0:r.sharer)||void 0===o?void 0:o.connId,isStricky:!0}),s.startFollowOther(e,l),_c("cv_follow_s")}}var k=e.useRef(null),_=e.useRef(null),T=e.useRef(null),I=e.useRef(null),P=e.useRef(null),N=e.useRef(null),M="selfInfo"===x||"chooseFollow"===x,A=e.useRef(!1);e.useEffect((function(){A.current=!!s.followingUser}),[s.followingUser]),e.useEffect((function(){if(g(""),x)return gh((function(e){w(""),"moreUser"!==x&&"selfInfo"!==x||!A.current||e.stopImmediatePropagation()}),{checkSkip:function(e){for(var t=0,n=[k,T,P];t<n.length;t++){var i=n[t];if(i.current&&V(i.current,e))return!0}return!((!_.current||!V(_.current,e))&&(!N.current||!V(N.current,e))&&(!I.current||!V(I.current,e)||("chooseFollow"===x&&w("selfInfo"),0)))}})}),[x]);var D=e.useReducer((function(e){return e+1}),0),B=D[0],L=D[1],O=e.useMemo((function(){return"moreUser"===x?c.filter((function(e){return-1!==e.userName.indexOf(v)})).sort(FW):[]}),[x,v,c,y,B]);e.useEffect((function(){return i.subscribe("updatedUserInfo",L)}),[]);var F=e.useMemo((function(){return"chooseFollow"===x?c.filter((function(e){return-1!==e.userName.indexOf(v)})).sort(FW):[]}),[x,v,c]),z=e.useContext(Ic).extensionConfigs,H=function(){var e=[];h.forEach((function(t){var n=c.find((function(e){return e.loginName===t}));n&&e.length<y&&e.push({user:n,order:e.length+1})}));for(var t=function(t){if(e.length>=y)return"break";e.every((function(e){return e.user!==t}))&&e.push({user:t,order:e.length+1})},n=0,i=c;n<i.length&&"break"!==t(i[n]);n++);return e.sort((function(e,t){return e.user.loginName>t.user.loginName?1:-1})),e}(),U=H.length+(b?1:0),q=20*U+(U>0?14:0),K=G(z.cursor&&e.createElement(CX,{upime:i,key:"cursor"}),!l&&e.createElement(tV,{upime:i,key:"comment"}),!i.meetingMode&&!s.forcedFollowing&&(null===(n=z.boardMemberList)||void 0===n?void 0:n.enabled)&&e.createElement(e.Fragment,{key:"members"},(H.length>0||!0===b)&&e.createElement("div",{className:j("members_1g6ZC",c.length<=0&&"none_1qr0Z"),style:{width:"".concat(q,"px")}},H.map((function(t){var n={left:"".concat(20*(t.order-1),"px"),zIndex:t.order,"--aniRight":C.current};return e.createElement("div",{className:j(vX,h.includes(t.user.loginName)&&"animate_2EJ7i"),key:t.user.loginName,style:n},e.createElement(fX,{user:t.user,onClick:function(){return S(t.user,n.left)},following:t.user===u}))})),b&&e.createElement("div",{ref:k,className:j(vX,"more_btn_1yvE6"),onClick:function(){w("moreUser"!==x?"moreUser":"")},style:{left:"".concat(20*H.length,"px"),zIndex:H.length+1}},e.createElement(ml,{className:j("more_num_vC_Wf",c.length+1-3>99&&"withBadge_36CiX"),shape:"circle"},"+",wh(c.length+1-3)))),e.createElement("div",{ref:T,className:j(!o&&"endChild_1hz5p")},e.createElement(fX,{user:r,onClick:function(){w("selfInfo"==x||"chooseFollow"==x?"":"selfInfo")},followers:d}))),!i.meetingMode&&!!o&&e.createElement("div",{className:"customChild_3IZnJ",key:"custom"},o));return e.createElement(e.Fragment,null,K.length>0&&e.createElement("div",{className:j("optionBar_1kV5k")},K),"moreUser"===x&&e.createElement("div",{ref:_,className:j("more_list_cI0aj")},e.createElement(gl,{value:v,onChange:function(e){return g(e.target.value)},onClearClick:function(){return g("")},placeholder:["search.username.placeholder"],className:xX,icon:"sousuo"}),e.createElement("div",{className:gX},O.length?O.map((function(t){return e.createElement(mX,{key:t.loginName,user:t,className:yX,onClick:function(){S(t),w("")},following:t===u,matchStr:v})})):e.createElement("span",{className:wX},a("search.noSearchRes")))),M&&e.createElement("div",{ref:I,className:j("self_info_3HiOQ")},e.createElement("div",{className:"self_name_Hf_8W"},e.createElement("div",{className:"name_17n-P"},r.userName),"owner"===r.userType&&e.createElement("div",{className:"owner_tag_3Yox8"},a("user.boardOwner"))),e.createElement("div",{className:"split_1xS1G"}),e.createElement("div",{className:j(Ml.btn_style,bX,(0==c.length||!i.editable)&&EX),onClick:function(){i.userManager.enableCallForFollow&&(s.callForFollow(c),w(""),i.addToast(a("follow.called"),{type:"normal"}),_c("cv_bringto_s"))}},e.createElement(hl,{icon:"tuandui"}),e.createElement("span",null,a("user.call.all.follow"))),e.createElement("div",{ref:P,onClick:function(){i.userManager.enableCallForFollow&&w("chooseFollow"!==x?"chooseFollow":"selfInfo")},className:j(Ml.btn_style,bX,(0==c.length||!i.editable)&&EX)},e.createElement(hl,{icon:"geren"}),e.createElement("span",null,a("user.call.picked.follow")))),"chooseFollow"==x&&e.createElement("div",{ref:N,className:j("follow_list_3iGI8")},e.createElement(gl,{value:v,onChange:function(e){return g(e.target.value)},onClearClick:function(){return g("")},placeholder:["search.username.placeholder"],className:xX,icon:"sousuo"}),e.createElement("div",{className:gX},F.length?F.map((function(t){return e.createElement(mX,{key:t.loginName,user:t,className:yX,onClick:function(){return function(e){s.callForFollow([e]),i.addToast(a("follow.called"),{type:"normal"}),w(""),_c("cv_bringto_s")}(t)},following:t===u,matchStr:v})})):e.createElement("span",{className:wX},a("search.noSearchRes")))))},kX=function(t){var n=t.upime,i=t.followingUser,r=t.stopFollow,o=t.className,a=e.useRef(null),s=n.followManager;al(n,["xmode"]),al(s,["forcedFollowing"]);var l=e.useContext(xl).phoneMode,c=W().getUpimeTrans;e.useEffect((function(){if(!s.forcedFollowing){a.current;var e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],t=function(t){n.useKeyboard&&(n.isDesktopModal||e.includes(t.key)&&r())},i=[n.subscribe("elementSelected",r),n.userEventManager.subscribe("moveto",r),n.userEventManager.subscribe("touchscale",r),n.userEventManager.subscribe("mousewheel",r)];return document.addEventListener("keydown",t,!0),function(){document.removeEventListener("keydown",t,!0),i.forEach((function(e){return e()}))}}}),[s.forcedFollowing]);var u=pr(i.color);return e.createElement("div",{className:j(o,"follow_mask_2MXh7"),ref:a,style:{borderColor:u,cursor:n.view.cursor}},!l&&e.createElement("div",{className:"follow_target_3ii4z",style:{backgroundColor:u}},s.forcedFollowing&&e.createElement(hl,{icon:"qiangzhigensui"}),e.createElement("span",null,"".concat(c(s.forcedFollowing?"follow.force":"user.following.hint.prefix")," ").concat(i.userName))))},_X={toggleBarIcon:"toggleBarIcon_2w8m9",iconWrap:"iconWrap_2kiOx",toggleBarIconOpened:"toggleBarIconOpened_3e-nh",sideBar:"sideBar_-tPPD",frameSideBar:"frameSideBar_2bwHL",list:"list_1OMVt",title:"title_rKHD1",titleLeftSect:"titleLeftSect_2ROiM",titleIcon:"titleIcon_12xvD",titleDivider:"titleDivider_r4sfq",createFrameButton:"createFrameButton_ZKCPa",downloadFramesButton:"downloadFramesButton_1eYsV",cell:"cell_2xHN3",selected:"selected_1bkJI",symbol:"symbol_8LpcW",name:"name_2DgLN",more_box:"more_box_3TCN6",popOpened:"popOpened_3TrcF",handle:"handle_1QWPT",frameCellHandle:"frameCellHandle_2WRk2",undoredo:"undoredo_1MCtn",horizMode:"horizMode_xJ9cW",undo:"undo_2rUzu",phoneMode:"phoneMode_3yRy9",redo:"redo_2PE_j",disable:"disable_wvgDj",active:"active_1Es1e",close_box:"close_box_jw1IS",frameHideIcon:"frameHideIcon_29pAR",placeholderContainer:"placeholderContainer_2mCq8",placeholder:"placeholder_2DEO2",placeholderImg:"placeholderImg_1GkFo",snapshot:"snapshot_3oBxw",loading:"loading_3-NVw",leftContainer:"leftContainer_23B0H",frameActions:"frameActions_2WGBQ",show:"show_2Bi_L",offset:"offset_K04Cg",cellTitle:"cellTitle_1A-G5",readonly:"readonly_3hfvE",inputBorder:"inputBorder_XCZ3Z",activeFrameEle:"activeFrameEle_11Cvv",placeholderBtn:"placeholderBtn_2nMkV",itemIconBtn:"itemIconBtn_30Jrn",presentationIconBtn:"presentationIconBtn_1oYmU",addNewBelowIconBtn:"addNewBelowIconBtn_1yO2S",frameHideCon:"frameHideCon_3JuZG",divider:"divider_1WIgi"},TX=function(t){var n=t.upime,i=t.direction,r=void 0===i?"vertical":i,o=W().getUpimeTrans;return al(n,["xmode","editable"]),al(n.opManager,["canUndo","canRedo"]),e.createElement("div",{className:j(_X.undoredo,"horiz"===r&&_X.horizMode)},e.createElement("div",{className:j(_X.undo,!n.opManager.canUndo&&_X.disable)},e.createElement(Dl,{content:o("operation.undo"),placement:"horiz"===r?"top":"right",extraDistance:3},e.createElement("div",{className:j(_X.iconWrap),onClick:function(){return n.undoOperation()}},e.createElement(hl,{className:j(_X.icon),icon:"chexiao"})))),e.createElement("div",{className:j(_X.redo,!n.opManager.canRedo&&_X.disable)},e.createElement(Dl,{content:o("operation.redo"),placement:"horiz"===r?"top":"right",extraDistance:3},e.createElement("div",{className:j(_X.iconWrap),onClick:function(){return n.redoOperation()}},e.createElement(hl,{className:j(_X.icon),icon:"huifu"})))))},IX=function(t){var n=t.upime;al(n,["xmode","editable"]),al(n.opManager,["canUndo","canRedo"]);var i=W().getUpimeTrans;return e.createElement("div",{className:j(_X.undoredo,_X.phoneMode)},e.createElement("div",{className:j(_X.undo,!n.opManager.canUndo&&_X.disable,_X.phoneMode),onClick:function(){return n.undoOperation()}},e.createElement(hl,{className:j(_X.icon),icon:"chexiao"})),e.createElement("div",{className:j(_X.undo,!n.opManager.canRedo&&_X.disable,_X.phoneMode),onClick:function(){return n.redoOperation()}},e.createElement(hl,{className:j(_X.icon),icon:"huifu"})),n.editable&&e.createElement(e.Fragment,null,e.createElement("div",{className:j(_X.divider)}),e.createElement("div",{className:j(_X.undo,_X.phoneMode,_X.active),onClick:function(){return n.toggleSelectAndViewMode("view"===n.xmode?"select":"view"),void("view"===n.xmode?n.addToast(i("xmode.enter.view")):n.addToast(i("xmode.exit.view")))}},e.createElement(hl,{className:j(_X.icon),icon:"view"===n.xmode?"hand-mode":"xuanze"}))))},PX="iconBox_2HlUa",NX="bar_37y-X",MX="displayNone_1E3Ag",AX="iconContainer_nKIMh",DX="icon_1r2tg",RX={dialogContainer:"dialogContainer_2d7nO",phoneReject:"phoneReject_1kQyx",dialogItem:"dialogItem__FFpL",upgradeIcon:"upgradeIcon_2kNoO",drawerContainer:"drawerContainer_2IgUg",drawerTitle:"drawerTitle_2uK5J",mainText:"mainText_NdUMe",closeIcon:"closeIcon_2z0C-",drawerContent:"drawerContent_15WYw",actionRow:"actionRow_2VQQw",action:"action_czY8r",disabled:"disabled_2cUWo",quickMeeting:"quickMeeting_3LbFN",reserveMeeting:"reserveMeeting_1KTvc"},BX=function(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=i.meetingChannel;return e.createElement("div",{className:RX.dialogContainer},o.isHost&&e.createElement("span",{className:j(RX.phoneReject,RX.dialogItem),onClick:function(){return n(YW.END)}},r("meeting.end")),e.createElement("span",{className:j(RX.leaveBtn,RX.dialogItem),onClick:function(){return n(YW.LEAVE)}},r("meeting.leave")))},LX=function(t){var n=t.upime,i=t.closePanel,r=W().getUpimeTrans,o=n.meetingManager.meetingConfigs,a=o.couldCreateMeeting,s=o.preCheckMeetingAccessibility;return e.createElement("div",{className:j(RX.drawerContainer)},e.createElement("div",{className:RX.drawerTitle},e.createElement("span",{className:RX.mainText},r("meeting.iconBtn.tooltip")),e.createElement(hl,{icon:"guanbi",className:RX.closeIcon,onClick:i})),a&&e.createElement("div",{className:RX.actionRow},e.createElement("div",{className:j(RX.action,RX.quickMeeting,n.meetingManager.staticMeetingActFrozen&&RX.disabled),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return s?[4,s("fast")]:[3,2];case 1:if(!e.sent())return i(),[2];e.label=2;case 2:return _c("cv_meeting_quick"),n.meetingManager.fastMeeting(),i(),[2]}}))}))}},e.createElement(hl,{icon:"shandian"}),e.createElement("span",null," ",r("meeting.quick.label"))),e.createElement("div",{className:j(RX.action,RX.reserveMeeting),onClick:function(){n.addToast(r("meeting.preserve.failed.toast"))}},e.createElement(hl,{icon:"yuding"}),e.createElement("span",null," ",r("meeting.reserve.label")))),e.createElement("div",{className:RX.drawerContent},e.createElement(uj,{upime:n})))},OX="phone_1T3na",FX="avatarWrapper_30caZ",zX="avatar_1Y_BX",HX="eye_1Nusz",UX=function(t){var n=t.me,i=t.user,r=t.following,o=t.meetingChannel,a=t.matchStr,s=t.userClickSE;al(i);var l=W().getUpimeTrans,c=bh(a,i.userInfo.meetingName).sects,u=n&&i.isHost,d=n&&i.isCohost,p="";return u?p="(".concat(l("meeting.host"),", ").concat(l("common.me"),")"):d?p="(".concat(l("meeting.cohost"),", ").concat(l("common.me"),")"):n?p="(".concat(l("common.me"),")"):i.isHost?p="(".concat(l("meeting.host"),")"):i.isCohost?p="(".concat(l("meeting.cohost"),")"):i.role===Pt.VISITOR&&(p="(".concat(l("meeting.visitor"),")")),e.createElement("div",{className:j("row_30-CO",r&&"active_39WZ6"),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){return r||o.changeViewSrc(i.userId),s(),[2]}))}))}},e.createElement("div",{className:"left_2vrEW"},e.createElement("div",{className:FX},e.createElement(ml,{className:zX,shape:"circle",url:i.userInfo.avatarUrl}),r&&e.createElement("div",{className:HX},e.createElement(hl,{icon:"yanjing-kai"}))),e.createElement("div",{className:"nameWrap_Wftjc"},e.createElement("span",{className:"name_1A2Gq"},c.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&"highlight_-lfrK"),key:n},t.value):t.value}))),p&&e.createElement("span",{className:"note_33n-a"},p))),r&&e.createElement("span",{className:"followingMark_1RnBy"},l("meeting.following.it")))},WX=function(t){var n=e.useState(""),i=n[0],r=n[1],o=t.setHide,a=t.meetingChannel,s=a.isHost,l=a.localMemberState,c=a.remoteMemberStates,u=a.curViewSrc,d=a.isCohost,p=a.hostId,h=a.coHosts,f=W().getUpimeTrans;al(a,["absentJoiners","curViewSrc","localMemberState","remoteMemberStates","forceFollow"]);var m=e.useMemo((function(){var e=l,t=Object.values(c).sort((function(e,t){return FW(e.userInfo,t.userInfo)})),n=R(R(R([e,t.find((function(e){return e.userId===p}))],t.filter((function(e){return!0===h.includes(e.userId)})),!0),t.filter((function(e){return e.userId!==p&&!1===h.includes(e.userId)&&e.role!==Pt.VISITOR})),!0),t.filter((function(e){return e.role===Pt.VISITOR})),!0).filter((function(e){return void 0!==e})).filter((function(e){return-1!==e.userInfo.meetingName.indexOf(i)})).map((function(e){return{userState:e,following:e.userId===u}}));return n}),[l,c,p,h,i,u]);return e.createElement(e.Fragment,null,e.createElement("div",{className:"header_3cxWC"},(s||d)&&e.createElement(e.Fragment,null,e.createElement("div",{className:"toggle_3GByE"},e.createElement("span",{className:"title_1TT-2"},f("follow.force")),e.createElement(Hl,{config:{onChange:function(e){return a.toggleMeetingForceFollow(e)}},value:a.forceFollow})),e.createElement("span",{className:"subTitle_3aFFF"},f("meeting.force.follow.hint"))),e.createElement(gl,{value:i,onChange:function(e){return r(e.target.value)},onClearClick:function(){return r("")},className:"search_2u33z",placeholder:["search.username.placeholder"],icon:"sousuo"})),e.createElement("div",{className:"viewport_uTaEU"},e.createElement("div",{className:"list_N3pFO"},m.length>0?m.map((function(t){var n=t.userState,r=t.following;return e.createElement(UX,{key:n.userId,me:n.userId===a.localMemberState.userId,user:n,following:r,meetingChannel:a,matchStr:i,userClickSE:function(){return o(!0)}})})):e.createElement("div",{className:"noRes_3UmqX"},f("search.noSearchRes")))))},VX=function(t){var n=t.closePanel,i=W().getUpimeTrans;return e.createElement("div",{className:RX.drawerContainer},e.createElement("div",{className:RX.drawerTitle},e.createElement("span",{className:RX.mainText},i("follow.label")),e.createElement(hl,{icon:"guanbi",className:RX.closeIcon,onClick:n})),e.createElement(WX,exports.E({},t)))},jX=function(t){var n=t.upime,i=t.rootClassName,r=n.meetingManager,o=e.useContext(FF).eventCenter;al(n,["rightSlidePanelType"]),al(r,["inMeeting","meetings"]);var a=e.useState(void 0),s=a[0],l=a[1];e.useEffect((function(){var e=n.subscribe("cloudRecordState",(function(e){var t=e?e.state:void 0;l(t)}));return function(){e()}}),[]),e.useEffect((function(){if(r.meetingChannel){var e=r.meetingChannel.cloudRecord,t=e?e.state:void 0;l(t)}}),[r.meetingChannel]);var c=W().getUpimeTrans,u=e.useContext(xl).phoneMode,d=e.useContext(Ic).extensionConfigs.meeting,p=function(){o.publish("closeBottomPane",[])},h=c("meeting.present");return s===VW.STARTING?h=c("meeting.record.qidongzhong"):s===VW.RECORDING&&(h=c("meeting.record.luzhizhong")),e.createElement(e.Fragment,null,(null==d?void 0:d.enabled)?e.createElement(e.Fragment,null,u?r.inMeeting?e.createElement("div",{className:j("inMeetingIconBox_1NODt",s===VW.RECORDING&&"redDot_B-t28")},e.createElement(hl,{icon:"yinshipintonghua",className:"yinshipin_1repu",onClick:function(){n.showPhoneDrawer(LX,{upime:n,closePanel:n.closePhoneDrawer.bind(n)}),p()}}),e.createElement("div",{className:"divider_2XL3-"}),e.createElement(hl,{icon:"shoujijieshuhuiyi",className:"tingzhiIcon_1_vlb",onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return p(),r.meetingChannel?[4,n.showWindow(BX,{meetingChannel:r.meetingChannel},!1,!0,{type:"drawer"})]:[3,2];case 1:e=t.sent(),r.meetingChannel.leaveMeeting(e===YW.END),t.label=2;case 2:return[2]}}))}))}})):e.createElement("div",{className:j(AX,"large_356V-",u&&"phone_Y15oY")},e.createElement(hl,{icon:"yinshipintonghua",className:DX,onClick:function(){n.showPhoneDrawer(LX,{upime:n,closePanel:n.closePhoneDrawer.bind(n)}),p()}})):e.createElement("div",{className:j(AX,"iconWrap_Z_vke",!n.userManager.enableMeeting&&"disabled_vSCMO",(r.inMeeting||n.rightSlidePanelType===BW.meetingList)&&"iconWrapActive_r40j0",r.inMeeting&&"inMeeting_1Ev94",r.inMeeting&&s===VW.RECORDING&&"meetingRecording_2KG6D",i),onClick:function(){_c("cv_meeting"),n.switchRightSlidePanel(BW.meetingList)}},e.createElement(hl,{icon:"yinshipintonghua",className:DX}),r.inMeeting&&e.createElement("span",{className:"inMeetingTxt_1FZvx"},h),!r.inMeeting&&e.createElement(e.Fragment,null,r.meetings.length>0&&e.createElement("div",{className:"meetingsNumContainer_2T2V3"},e.createElement("div",{className:"meetingsNum_1B6vT"},r.meetings.length)),e.createElement("span",{className:"meetingTxt_jp3Ne"},c("meeting.iconBtn.tooltip"))))):null)},GX=function(t){var n=t.rootClassName,i=t.isSingle,r=void 0===i||i,o=e.useContext(xl).upime,a=W().getUpimeTrans;function s(){"laser"!==o.xmode&&_c("cv_laser",{in_meeting:o.curMeetingChannel?"是":"否"}),o.switchMode("laser"===o.xmode?"select":"laser")}return al(o,["xmode"]),r?e.createElement(Dl,{placement:"bottom",extraDistance:6,content:a("meeting.laser")},e.createElement("div",{className:j("iconWrap_rI8hN","laser"===o.xmode&&"iconWrapActive_FV5S4"),onClick:s},e.createElement(hl,{icon:"jiguangbi"}))):e.createElement("div",{className:j(n,"laser"===o.xmode&&"activeColor_bj176"),onClick:s},e.createElement(hl,{icon:"jiguangbi"}),e.createElement("span",null,a("toolbar.laser")))},qX="disabled_tEGB9",KX="phoneMode_1xK4q",YX="timer_root_weoyH",XX="timer_icon_NC8P1",QX="hide_mJY3W",ZX="btn_box_3uuZn",JX="circle_JDV8Q",$X="ha_1iYos",eQ="move_left_27M7h",tQ="grey_3pIS5",nQ="read_only_1SkpN",iQ=e.createContext(null),rQ=e.createContext(null);function oQ(t,n,i){void 0===n&&(n=[]),e.useEffect((function(){if(t){var e="function"==typeof t.addHook?t.addHook(i,n):void 0;return function(){e&&e()}}}),[t])}function aQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.setCurrentTime,r=t.setDuration,o=0===n;return e.createElement("div",{className:j(JX,o&&qX),onClick:function(){if(0!==n){var e,t=Math.floor(n/60);if(0===t)e=0;else if(t<=10)e=n-60;else{var o=t%10;e=0===o||5===o?n-300:o<5?n-60*o:n-60*(o-5)}i(e),r(e)}}},e.createElement("div",{className:j($X,o&&qX)}))}function sQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.setCurrentTime,r=t.setDuration,o=3599===n;return e.createElement("div",{className:j(JX,"plus_root_2FvxJ",o&&qX),onClick:function(){var e,t=Math.floor(n/60);if(t<10)e=n+60;else if(59===t)e=3599;else if(55===t)e=n+240;else{var o=t%10;e=o<5?n+60*(5-o):n+60*(10-o)}i(e),r(e)}},e.createElement("div",{className:j($X,o&&qX)}),e.createElement("div",{className:j("va_2OILL",o&&qX)}))}function lQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.setCurrentTime,r=t.status,o=t.setDuration,a=e.useContext(xl).upime,s=e.useState((function(){var e=Math.floor(n/60);return e<10?"0"+e:e>59?"59":String(e)})),l=s[0],c=s[1];e.useEffect((function(){var e=Math.floor(n/60);c(e<10?"0"+e:e>59?"59":String(e))}),[n]);var u="timing"===r||"pause"===r,d="pause"===r,p=!a.editable||a.phoneMode;return e.createElement("input",{type:"text",maxLength:2,className:j("minutes_Qaam2",u&&eQ,d&&tQ,p&&nQ),value:l,onChange:function(e){var t=e.target.value;t.length>2||(!t||1===t.length&&"0"<=t&&t<="9"||2===t.length&&"0"<=t[1]&&t[1]<="9"&&"0"<=t[0]&&t[0]<="9")&&c(e.target.value)},onBlur:function(){var e=n%60,t=l;0===l.length?t="00":1===l.length?t="0"+l:Number(l)>59&&(t="59"),c(t),i(60*Number(l)+e),o(60*Number(l)+e)},onBeforeInput:function(e){var t=e.data;"0"<=t&&t<="9"||e.preventDefault()}})}function cQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.setCurrentTime,r=t.status,o=t.setDuration,a=e.useContext(xl).upime,s=e.useState((function(){var e=n%60;return e<10?"0"+e:e>59?"59":String(e)})),l=s[0],c=s[1];e.useEffect((function(){var e=n%60;c(e<10?"0"+e:e>59?"59":String(e))}),[n]);var u="timing"===r||"pause"===r,d="pause"===r,p=!a.editable||a.phoneMode;return e.createElement("input",{type:"text",maxLength:2,className:j("seconds_vNDqq",u&&eQ,d&&tQ,p&&nQ),value:l,onChange:function(e){var t=e.target.value;t.length>2||(!t||1===t.length&&"0"<=t&&t<="9"||2===t.length&&"0"<=t[1]&&t[1]<="9"&&"0"<=t[0]&&t[0]<="9")&&c(e.target.value)},onBlur:function(){var e=Math.floor(n/60),t=l;0===l.length?t="00":1===l.length?t="0"+l:Number(l)>59&&(t="59"),c(t),i(60*e+Number(t)),o(60*e+Number(t))},onBeforeInput:function(e){var t=e.data;"0"<=t&&t<="9"||e.preventDefault()}})}function uQ(){var t=e.useContext(iQ).status,n=e.useContext(xl).upime,i="timing"===t||"pause"===t,r="pause"===t,o=!n.editable||n.phoneMode;return e.createElement("div",{className:j("colon_j4aqL",i&&eQ,r&&tQ,o&&nQ)},e.createElement("div",null,":"))}function dQ(){var t=e.useContext(iQ).status,n="timing"===t||"pause"===t;return e.createElement("div",{className:j("divider_3Vt-6",n&&eQ)})}function pQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.status,r=t.setStatus,o=t.meetingChannel,a=e.useContext(xl).upime,s=W().getUpimeTrans,l=0===n,c="pause"===i;return e.createElement(Dl,{content:s("timer.start"),placement:"bottom"},e.createElement("div",{className:j("start_root_2uxdT",l&&qX,c&&"goon_3DJVj"),onClick:function(){if(r("timing"),a.t_timerActive=!0,o){var e={status:"timing",currentTime:1e3*n,timestamp:a.getCurServerTime(),duration:1e3*n},t=o.meetingData.timer;"idle"===i?(o.startTimer(e),o.meetingData.timer=e):t&&t.uniqueId&&(o.updateTimer(t.uniqueId,e),t.status="timing")}}},e.createElement("div",{className:"triangle_2yRKs"})))}function hQ(){var t=e.useContext(iQ).setCover,n=W().getUpimeTrans;return e.createElement(Dl,{content:n("timer.stop"),placement:"bottom"},e.createElement("div",{className:"stop_root_2efrd",onClick:function(){t(!0)}},e.createElement("div",{className:"round_rect_y_i0G"})))}function fQ(){var t=e.useContext(iQ),n=t.setStatus,i=t.meetingChannel,r=t.currentTime,o=W().getUpimeTrans,a=e.useContext(xl).upime;return e.createElement(Dl,{content:o("timer.pause"),placement:"bottom"},e.createElement("div",{className:"pause_root_DBw4Y",onClick:function(){if(n("pause"),a.t_timerActive=!0,i){var e=i.meetingData.timer;if(null==e?void 0:e.uniqueId){var t={status:"pause",currentTime:1e3*r,timestamp:a.getCurServerTime()};i.updateTimer(e.uniqueId,t),e.status="pause"}}}},e.createElement("div",{className:"first_line_27GJm"}),e.createElement("div",{className:"second_line_2I_yc"})))}function mQ(){var t=e.useContext(rQ).setTimer,n=e.useContext(xl).upime;return e.createElement(hl,{icon:"guanbi",onClick:function(){t(!1),n.t_timerOpened=!1},className:"close_root_1aF8z"})}function vQ(){var t=e.useContext(rQ).setTip,n=e.useContext(iQ).setHide,i=e.useContext(xl).upime;return e.createElement("div",{className:"minify_root_2gske",onClick:function(){n(!0),t(!0),i.t_timerOpened=!1}},e.createElement("div",{className:"line_3MEeS"}))}function gQ(t){var n=t.type,i=e.useContext(iQ),r=i.setCurrentTime,o=i.currentTime,a=i.startTime,s=i.changeStartTime,l=i.duration,c=i.setDuration,u=i.meetingChannel,d=i.status,p=W().getUpimeTrans,h=1===n,f=5===n;return e.createElement(Dl,{content:p(h?"timer.add1":"timer.add5"),placement:"bottom"},e.createElement("div",{className:j(_e.desktop?"addtime_root_2tldj":"addtime_root_m_2Jhxz",h&&"one_Int18",f&&"five_2Vc7H"),onClick:function(){if(r(Math.min(3599,o+60*n)),c(Math.min(3599,l+60*n)),s(Math.min(3599,a+60*n)),u){if("pause"===d&&3599===o)return;var e=u.meetingData.timer;(null==e?void 0:e.uniqueId)&&u.addTimerTime(e.uniqueId,60*n*1e3)}}},e.createElement("div",{className:"content_3V4uI"},"+",n,"m")))}function yQ(){var t=e.useContext(iQ),n=t.currentTime,i=t.duration,r=t.status,o=e.useMemo((function(){return Math.floor(270*n/i)}),[n]),a="pause"===r;return e.createElement("div",{className:j("progress_36F7M",a&&tQ),style:{width:"".concat(o,"px")}})}var bQ=e.forwardRef((function(t,n){var i=t.meetingChannel,r=e.useContext(xl).upime,o=r.editable,a=r.phoneMode,s=e.useRef(0),l=e.useState((function(){if(!i)return 300;var e=i.meetingData.timer;if(!e)return 300;var t=e.currentTime,n=e.status,o=e.timestamp;if("pause"===n)return t/1e3;if("timing"===n){if("start"===i.initBy)return t/1e3;if("enter"===i.initBy)return s.current=r.getCurServerTime()-o,Math.floor((t-s.current)/1e3)}return 300})),c=l[0],u=l[1],d=e.useState((function(){if(!i)return c;var e=i.meetingData.timer;return e&&e.duration?e.duration/1e3:c})),p=d[0],h=d[1],f=e.useState((function(){if(!i)return"idle";var e=i.meetingData.timer;return e?e.status:"idle"})),m=f[0],v=f[1],g=e.useState(!1),y=g[0],b=g[1],E=e.useState(!1),x=E[0],w=E[1],C=e.useState(!1),S=C[0],k=C[1],_=e.useContext(rQ),T=_.setActive,I=_.setTimer,P=_.forceUpdate,N=_.setTip,M=e.useRef(0),A=W().getUpimeTrans,D=function(){if(i){var e=i.meetingData.timer;if(!e)return;var t=e.status;v(t),u(e.currentTime/1e3)}};oQ(i,["addTime"],(function(){if(i){h((function(e){return Math.min(3599,e+i.timerAddDuration)}));var e=i.meetingData.timer;if(!e)return;!function(e){var t=e.status,n=e.currentTime,o=e.timestamp;if("pause"===t)u(Math.min(3599,n/1e3));else if("timing"===t){var a=n-(r.getCurServerTime()-o);u(Math.min(3599,Math.ceil(a/1e3)))}i&&H(Math.min(3599,z.current+i.timerAddDuration))}(e),P()}})),oQ(i,["updateStatus"],D);var R="idle"===m||"pause"===m,B="timing"===m||"pause"===m,L="timing"===m,O="idle"===m,F=e.useRef(0),z=e.useRef(0),H=function(e){z.current=e},U=function(){F.current=performance.now(),z.current=c,clearInterval(M.current),M.current=window.setInterval((function(){var e=Math.floor((performance.now()-F.current)/1e3);u(Math.max(0,z.current-e)),P()}),1e3)};e.useEffect((function(){T("timing"===m||"pause"===m),"timing"===m?"enter"===(null==i?void 0:i.initBy)?(i.initBy="",setTimeout((function(){U()}),1e3-s.current%1e3)):U():"pause"===m&&clearInterval(M.current)}),[m]);var V=e.useRef(0);e.useEffect((function(){0===c&&"timing"===m&&(k(!0),N(!1),clearInterval(M.current),G.current&&G.current.play(),clearTimeout(V.current),V.current=window.setTimeout((function(){I(!1),T(!1),N(!1),i&&(i.meetingData.timer=null),o&&!a||(r.t_timerActive=!1)}),3e3))}),[c]);var G=e.useRef();e.useEffect((function(){G.current=new KN,G.current.attachParent(document.getElementById("upime-audio-container"));var e=r.applyTimerElement();return G.current.attachMedia(e),G.current.src=$o("timer_end.mp3"),G.current.once("canplay",(function(){G.current&&G.current.play(),G.current&&G.current.pause()})),function(){clearTimeout(V.current),clearInterval(M.current),r.releaseTimerElement(e),G.current&&G.current.detachMedia()}}),[]),e.useEffect((function(){b(!1)}),[o]),e.useImperativeHandle(n,(function(){return{hide:x,setHide:w,currentTime:c,status:m,runTimer:D,setCover:b}}));var q=e.createElement("div",{className:j(YX,x&&QX)},O&&e.createElement(aQ,null),e.createElement(lQ,null),e.createElement(uQ,null),e.createElement(cQ,null),O&&e.createElement(sQ,null),e.createElement(dQ,null),R&&e.createElement(pQ,null),B&&e.createElement(hQ,null),L&&e.createElement(fQ,null),O&&e.createElement(mQ,null),!O&&e.createElement(vQ,null),!O&&e.createElement(gQ,{type:1}),!O&&e.createElement(gQ,{type:5}),!O&&e.createElement(yQ,null));return S?q=e.createElement("div",{className:"timer_anim_3A5d-"},e.createElement("div",{className:"anim_content_box_3NtW4"},e.createElement(hl,{icon:"dingshiqi-9bp9o02e",className:XX}),e.createElement("div",{className:"text_2zc6t"},A("timer.dingshijieshu")))):!a&&o||(q=e.createElement("div",{className:j(YX,x&&QX)},e.createElement(hl,{icon:"dingshiqi-9bp9o02e",className:XX}),e.createElement(lQ,null),e.createElement(uQ,null),e.createElement(cQ,null),!O&&e.createElement(vQ,null),!O&&e.createElement(yQ,null))),e.createElement(iQ.Provider,{value:{currentTime:c,setCurrentTime:u,status:m,setStatus:v,setCover:b,setHide:w,duration:p,setDuration:h,startTime:z.current,changeStartTime:H,meetingChannel:i}},q,y&&e.createElement("div",{className:"timer_root_cover_Vi82k"},e.createElement("div",{className:j(ZX,"left_3Siut"),onClick:function(){b(!1)}},A("timer.zanbujieshu")),e.createElement("div",{className:j(ZX,"right_PNwAm"),onClick:function(){if(b(!1),I(!1),T(!1),r.t_timerOpened=!1,i){var e=i.meetingData.timer;(null==e?void 0:e.uniqueId)&&(i.stopTimer(e.uniqueId),i.meetingData.timer=null)}}},A("timer.jieshudingshi"))))})),EQ=e.forwardRef((function(t,n){var i=t.rootClassName,r=e.useContext(xl).upime,o=e.useReducer((function(e){return e+1}),0);o[0];var a=o[1],s=W().getUpimeTrans,l=e.useState((function(){return!!r.curMeetingChannel&&r.curMeetingChannel.showTimer})),c=l[0],u=l[1],d=e.useState(!1),p=d[0],h=d[1],f=e.useState(!1),m=f[0],v=f[1],g=e.useRef();e.useImperativeHandle(n,(function(){return{onClick:y,active:p,timerCmpActive:c}})),oQ(r.curMeetingChannel,["startTimerVar"],(function(){r.curMeetingChannel&&(g.current?g.current.runTimer():(u(!0),h(!0)))})),oQ(r.curMeetingChannel,["stopTimerVar"],(function(){r.curMeetingChannel&&(u(!1),h(!1),v(!1))}));var y=function(){!c||g.current&&"idle"===g.current.status?u(!c):(p&&v(!m),g.current&&g.current.setHide(!g.current.hide),g.current&&g.current.setCover(!1)),r.t_timerOpened=!r.t_timerOpened,_c("cv_countdown")},b=e.useMemo((function(){var e="";return g.current&&"0m"==(e=Math.floor(g.current.currentTime/60)+"m")&&(e=g.current.currentTime%60+"s"),e}),[g.current]);return e.createElement(rQ.Provider,{value:{setActive:h,setTimer:u,setTip:v,forceUpdate:a}},e.createElement(Dl,{placement:"bottom",extraDistance:6,content:s("timer.label")},e.createElement("div",{className:j("root_2GiVc","iconWrap_G_xA_",(p||c)&&"iconWrapActive_tqdxb",r.phoneMode&&KX,i),onClick:y},e.createElement(hl,{icon:"dingshiqi-9bp9o02e"}),m&&e.createElement("div",{className:j("tip_root_3FU89",r.phoneMode&&KX),onClick:y},b))),c&&e.createElement(bQ,{meetingChannel:r.curMeetingChannel,ref:g}))})),xQ=function(t){var n,i,r=t.upime,o=t.item,a=t.rootClassName,s=t.atTop,l=void 0===s||s;al(r,["currentCustomFoldableTool","rightSlidePanelType","customFoldableTools"]);var c=function(e){r.switchRightSlidePanel(BW.extensionList,e)},u=e.useState(o.hasStatusTip),d=u[0],p=u[1],h=e.useState(o.statusTipType),f=h[0],m=h[1],v=e.useState(o.badgeTipContent),g=v[0],y=v[1];return e.useEffect((function(){var e=o.eventManager;if(void 0!==e){var t=[e.subscribe("hasStatusTipUpdated",(function(e){p(e)})),e.subscribe("statusTipTypeUpdated",(function(e){m(e)})),e.subscribe("badgeTipContentUpdated",(function(e){y(e)}))];return function(){t.forEach((function(e){return e()}))}}}),[]),l?e.createElement(Dl,{key:o.key,content:o.name,placement:"bottom",extraDistance:6},e.createElement("div",{className:j(dj.extensionSidePanelItemBtn,dj.iconWrap,(r.rightSlidePanelType===BW.extensionList&&(null===(n=r.currentCustomFoldableTool)||void 0===n?void 0:n.key)===o.key||o.forceBoxActive)&&dj.iconWrapActive),onClick:function(){var e;null===(e=o.onClickButton)||void 0===e||e.call(o),o.toolPanel&&c(o)}},e.createElement(hl,{iconSvg:o.iconSvg,icon:o.icon,className:o.className}),!0===d&&e.createElement(e.Fragment,null,"badge"===f&&e.createElement("div",{className:dj.badgeTip},null!=g?g:""),"dot"===f&&e.createElement("div",{className:dj.dotTip})))):e.createElement("div",{className:j(dj.iconWrap,(r.rightSlidePanelType===BW.extensionList&&(null===(i=r.currentCustomFoldableTool)||void 0===i?void 0:i.key)===o.key||o.forceBoxActive)&&dj.iconWrapActive,a),onClick:function(){var e;null===(e=o.onClickButton)||void 0===e||e.call(o),o.toolPanel&&c(o)}},e.createElement(hl,{iconSvg:o.iconSvg,icon:o.icon,className:o.className}),e.createElement("span",null,o.name))},wQ=function(t){var n=t.upime,i=t.item,r=i.SubWinContent,o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef;return e.createElement("div",{ref:c,style:{position:"relative"}},e.createElement(Dl,{key:i.key,content:i.name},e.createElement("div",{className:j(dj.extensionItem,!a&&dj.active)},e.createElement(hl,{icon:i.icon,className:i.className,onClick:l}))),r&&!a&&e.createElement(xh,{className:dj.panelRoot,align:"center",selfAdjust:!0},e.createElement(r,{upime:n,closeSubWin:function(){return s(!0)}})))},CQ=function(t){var n=t.upime,i=t.className,r=t.customFoldableTools;al(n,["presentation","editable","t_timerActive","customFoldableTools","titleBarMinWidth"]);var o=n.standardPresentation,a=n.meetingMode,s=n.t_timerActive,l=e.useContext(Ic),c=l.extensionConfigs,u=l.leftSideOpened;l.rightSideOpened;var d=W().getUpimeTrans,p=e.useState(1),h=p[0],f=p[1],m=e.useState(-1),v=m[0],g=m[1],y=e.useRef(null),b=e.useRef(document.documentElement.clientWidth),E=yh(!0),x=E.hide,w=E.skipRef,C=E.toggleHide,S=e.useRef(null),k=c.laser,_=c.timer,T=function(){var t=e.createElement(EQ,{rootClassName:j(2===h&&MX),key:"timer",ref:S});return void 0!==_?_&&t:a?(n.editable||s)&&t:n.editable&&t}(),I=1===h&&(void 0!==k?k&&e.createElement(GX,{key:"laser"}):n.editable&&e.createElement(GX,{key:"laser"})),P=(!o||a)&&1===h&&e.createElement(jX,{upime:n,key:"meeting"}),N=e.createElement("div",{className:j(PX,"collapseBox_2w4-X"),onClick:function(){f(2)}},e.createElement(hl,{icon:"jiantou-you"})),M=G(P,I,T),A=n.customFoldableTools||[],D=M.length+A.length,B=D>v,L=function(e){var t=y.current;if(t){var i=t.getBoundingClientRect(),r=u?348:0,o=i.left-n.titleBarMinWidth-r;if(o<0){var a=Math.ceil(-o/30);g(Math.max(0,e-Math.max(a,2)))}else g(D)}};e.useEffect((function(){L(v),setTimeout((function(){var e=y.current;if(e){var t=e.getBoundingClientRect(),i=u?348:0;n.publish("titleBarResize",Math.max(0,t.left-i))}}),10)}),[h,u]),e.useEffect((function(){g(D)}),[D]),e.useEffect((function(){var e=function(){var e=y.current,t=document.documentElement.clientWidth;if(e){var i=e.getBoundingClientRect(),r=i.left-n.titleBarMinWidth-(u?348:0),o=t-b.current;if(Math.abs(o)<40)if(o<0)if(r<0){var a=B?1:2;1===h&&g(Math.max(0,v-a))}else v!==D&&2!==h||n.publish("titleBarResize",i.left);else 0===v?r>114&&1===h&&g(Math.min(D,1)):r>40&&(a=v===D-2?2:1,1===h&&g(Math.min(D,v+a))),v!==D&&2!==h||n.publish("titleBarResize",i.left);else L(v),n.publish("titleBarResize",i.left)}b.current=t};window.addEventListener("resize",e);var t=n.subscribe("titleBarReady",(function(){L(v)}));return function(){window.removeEventListener("resize",e),t()}}),[v,u,h]);var O=[];if(1===h){var F=(O=M.slice(0,v)).find((function(e){return"timer"===e.key}));F||(O=R(R([],O,!0),[e.createElement(EQ,{rootClassName:MX,key:"timer",ref:S})],!1))}else O=[e.createElement(EQ,{rootClassName:MX,key:"timer",ref:S})];return e.createElement(e.Fragment,null,D>0&&e.createElement("div",{className:j("root_Ba7Ia",i,2===h&&"nogap_1xJUn"),ref:y,id:"foldableToolbar"},e.createElement(e.Fragment,null,v>0&&D>1&&1===h&&e.createElement(Dl,{content:d("common.fold")},N),O.length>0&&O,r&&r.length>0&&v>M.length&&1===h&&r.slice(0,v-M.length).map((function(t){return t.SubWinContent?e.createElement(wQ,{upime:n,item:t,key:t.key}):e.createElement(xQ,{upime:n,item:t,key:t.key})})),B&&D>1&&1===h&&e.createElement(Dl,{enable:x,content:d("common.moretool")},e.createElement("div",{className:j(PX,!x&&"active_2Gcdn"),onClick:function(){C()},ref:w},e.createElement(hl,{icon:"shuangxia"}),e.createElement(xh,{align:"center",className:j("morePanel_14u6s",x&&"hide_3A2GC")},v<M.length&&M.slice(v).map((function(t){var i,r,o=t.key;return"timer"===o?e.createElement("div",{className:j(NX,"timerBar_35xxT",((null===(i=S.current)||void 0===i?void 0:i.active)||(null===(r=S.current)||void 0===r?void 0:r.timerCmpActive))&&"iconWrapActive_3QGrd"),onClick:function(){S.current&&S.current.onClick()},key:o},e.createElement(hl,{icon:"dingshiqi-9bp9o02e"}),e.createElement("span",null,d("timer.label"))):"laser"===o?e.createElement(GX,{key:o,isSingle:!1,rootClassName:NX}):"meeting"===o?e.createElement(jX,{rootClassName:NX,upime:n,key:o}):null})),A.slice(v-D).map((function(t){return t.SubWinContent?e.createElement(wQ,{upime:n,item:t,key:t.key}):e.createElement(xQ,{upime:n,item:t,key:t.key,rootClassName:NX,atTop:!1})})))))),e.createElement(Dl,{rootClass:j(1===h&&MX),content:d("common.unfold")},e.createElement("div",{className:j(PX),onClick:function(){f(1)}},e.createElement(hl,{icon:"gengduogongju"})))))},SQ=function(t){t.url;var n=t.className,i=t.content,r=W().getUpimeTrans,o=e.useContext(Ic),a=o.rightSideOpened,s=o.closeRightSide;return e.createElement("div",{className:j("learning_center_3M_0T",a&&"opened_EhrM1",n)},e.createElement("div",{className:"head_RY-xd"},e.createElement("div",{className:"title_1tsF0"},r("helpCenter.title")),e.createElement("div",{className:j(Ml.cm_item,"close_3zrl2"),onClick:s},e.createElement(hl,{icon:"guanbi"}))),a&&i)},kQ="root_-uv2T",_Q="visitorMode_DQtBp",TQ="btn_2Eh-n",IQ="mini_btn_split_-uRln",PQ="phone_g6eup",NQ="landscape_3kkUW",MQ="deviceCtrlRoot_231_v",AQ="disabled_2Y8oy",DQ="mini_f0Voz",RQ="landscape_21FMG",BQ="iconBox_23xDz",LQ="span_1UyaD",OQ="volume_25fkt",FQ="phone_3tnCI",zQ="deviceCtrl_3ts2M",HQ="triangle_1XBoC",UQ="open_LZY0L",WQ="subWin_22apU",VQ="title_1HS0a",jQ=function(t){var n=t.rtcChannel,i=t.miniMode,r=W().getUpimeTrans,o=e.useContext(xl),a=o.phoneMode,s=o.upime,l=e.useRef(null),c=e.useRef(null);al(n,["localAudioEnabled","localVideoEnabled","localAudioSuspending","localVideoSuspending","mics","cameras","localMicVolume","curMic","curCam","reachHostLimit","spaceKeyPressed","TempOpenAudioDenied","openMicWillBeDenied","openCamWillBeDenied"]),e.useEffect((function(){l.current&&(l.current.style.height="".concat(14*n.localMicVolume,"px")),c.current&&(c.current.style.height=100*n.localMicVolume+"%")}),[n.localMicVolume,l.current]);var u=yh(!0),d=u.hide,p=u.skipRef,h=u.toggleHide,f=yh(!0),m=f.hide,v=f.skipRef,g=f.toggleHide,y=yh(!0,{checkSkip:function(e){return p.current&&V(p.current,e)||v.current&&V(v.current,e)||!1}}),b=y.hide,E=y.setHide,x=e.useState(null),w=x[0],C=x[1],S=e.useState(!1),k=S[0],_=S[1],T=e.useState(!1),I=T[0],P=T[1];e.useEffect((function(){d&&_(!1),m&&P(!1)}),[d,m]);var N=e.useRef("audio");e.useEffect((function(){n.reachHostLimit&&(C("reachHostLimit"),E(!1))}),[n.reachHostLimit]),e.useEffect((function(){n.TempOpenAudioDenied?n.micPermDenied?(C("micPermDenied"),E(!1)):(N.current="audio",C("reachHostLimit"),E(!1)):E(!0)}),[n.TempOpenAudioDenied]),e.useEffect((function(){n.openMicWillBeDenied&&(a?s.showWindow(EV,null,!1,!0).then((function(){n.deviceHelpLink&&window.open(n.deviceHelpLink)})):(C("micPermDenied"),E(!1)))}),[n.openMicWillBeDenied]),e.useEffect((function(){n.openCamWillBeDenied&&(a?s.showWindow(EV,null,!1,!0).then((function(){n.deviceHelpLink&&window.open(n.deviceHelpLink)})):(C("cameraPermDenied"),E(!1)))}),[n.openCamWillBeDenied]);var M,R,B=e.useMemo((function(){return n.localAudioSuspending?"maikefeng-guan":n.localAudioEnabled?"maikefeng-kai":"maikefeng-guan-new"}),[n.localVideoEnabled,n.localAudioSuspending]),L=e.useMemo((function(){return n.localVideoSuspending?"shexiangtou-guan":n.localVideoEnabled?"shexiangtou-kai":"shexiangtou-guan-new"}),[n.localVideoEnabled,n.localVideoSuspending]);if(!b)if("cameraPermDenied"===w)R=e.createElement(GQ,{deviceHelpLink:n.deviceHelpLink});else if("micPermDenied"===w)M=e.createElement(GQ,{deviceHelpLink:n.deviceHelpLink});else if("reachHostLimit"===w){var O=r("meeting.reach.rtcHost.limit",n.rtcMaxHostNumber),F=e.createElement("div",{className:j("reachLimitRoot_1ynzP")},O," ",e.createElement("div",{className:HQ}));"audio"===N.current?M=F:R=F}var z=e.createElement(e.Fragment,null,e.createElement("div",{className:j(BQ,a&&FQ),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return n.clearReachHostLimit(),n.micPermDenied?a?[4,s.showWindow(EV,null,!1,!0)]:[3,2]:[3,4];case 1:return e.sent(),n.deviceHelpLink&&window.open(n.deviceHelpLink),[3,3];case 2:b||"micPermDenied"!==w?(C("micPermDenied"),E(!1)):E(!0),e.label=3;case 3:return[3,5];case 4:n.localAudioEnabled?n.disableLocalAudio():(N.current="audio",n.enableLocalAudio()),e.label=5;case 5:return[2]}}))}))}},e.createElement(hl,{icon:B}),e.createElement("div",{className:j(OQ,!n.localAudioEnabled&&"hide_2jds4"),ref:l}),!a&&!i&&e.createElement("span",{className:LQ},n.localAudioEnabled?r("rtc.disable.audio"):r("rtc.enable.audio"))),M),H=!_e.desktop||n.localAudioEnabled||n.localAudioSuspending||n.spaceKeyPressed?"":r("rtc.device.tempAudio.tip"),U=a&&!ye();return e.createElement(e.Fragment,null,e.createElement("div",{ref:p,className:j(MQ,n.localAudioSuspending&&AQ,i&&DQ,U&&RQ)},H?e.createElement(Dl,{content:H,placement:"top",className:"mic_tip_11fE3"},z):z,!a&&!i&&e.createElement("div",{style:{position:"relative"}},e.createElement("div",{className:zQ,onClick:function(){n.micPermDenied?b||"micPermDenied"!==w?(C("micPermDenied"),E(!1)):E(!0):(d&&!n.micPermDenied&&n.updateMicDevices(),h(),_(!k))}},e.createElement("div",{className:j(HQ,k&&UQ)})),e.createElement(qQ,{hide:d,devices:n.mics,curDevice:n.curMic,onSelectDevice:function(e){return n.switchMic(e)},isMic:!0}))),e.createElement("div",{ref:v,className:j(MQ,"camera_1ocpb",n.localVideoSuspending&&AQ,i&&DQ,U&&RQ)},e.createElement("div",{className:j(BQ,a&&FQ),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return n.clearReachHostLimit(),n.camPermDenied?a?[4,s.showWindow(EV,null,!1,!0)]:[3,2]:[3,4];case 1:return e.sent(),n.deviceHelpLink&&window.open(n.deviceHelpLink),[3,3];case 2:b||"cameraPermDenied"!==w?(C("cameraPermDenied"),E(!1)):E(!0),e.label=3;case 3:return[3,5];case 4:n.localVideoEnabled?n.disableLocalVideo():(N.current="video",n.enableLocalVideo()),e.label=5;case 5:return[2]}}))}))}},e.createElement(hl,{icon:L}),!a&&!i&&e.createElement("span",{className:LQ},n.localVideoEnabled?r("rtc.disable.video"):r("rtc.enable.video")),R),!a&&!i&&e.createElement("div",{style:{position:"relative"}},e.createElement("div",{className:zQ,onClick:function(){n.camPermDenied?b||"cameraPermDenied"!==w?(C("cameraPermDenied"),E(!1)):E(!0):(m&&!n.camPermDenied&&n.updateCamDevices(),g(),P(!I))}},e.createElement("div",{className:j(HQ,I&&UQ)})),e.createElement(qQ,{hide:m,devices:n.cameras,curDevice:n.curCam,onSelectDevice:function(e){return n.switchCam(e)},isMic:!1}))),n.localAudioEnabled&&n.audioTempEnable&&e.createElement("div",{className:"temp_audio_3MOFj"},e.createElement("div",{className:"volumeWrapper_289BF"},e.createElement("div",{className:OQ,ref:c})),e.createElement(hl,{icon:B}),e.createElement("div",{className:"temp_audio_desc_zHYvt"},r("rtc.device.tempAudio"))))},GQ=function(t){var n=t.deviceHelpLink,i=W().getUpimeTrans;return e.createElement(xh,{align:"center",className:j(WQ)},e.createElement("div",{className:"deniedRoot_-7CO-"},e.createElement("span",{className:VQ},i("rtc.device.denied.title")),e.createElement("span",{className:"content_1WPUx"},i("rtc.device.denied.content")),e.createElement("span",{className:"tipbox_kXXci"},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,i("media.audio.access.denied.tip"))),n&&e.createElement("span",{className:"link_3kAoy",onClick:function(){n&&window.open(n)}},i("rtc.device.denied.link"))))},qQ=function(t){var n=t.hide,i=t.devices,r=t.curDevice,o=t.onSelectDevice,a=t.isMic,s=W().getUpimeTrans;return n?null:e.createElement(xh,{align:"center",className:j(WQ)},e.createElement("div",{className:"listRoot_3LI7h"},e.createElement("div",{className:VQ},s(a?"rtc.select.mic":"rtc.select.cam")),i.map((function(t){return e.createElement("div",{key:t.deviceId,className:"row_3yUzr",onClick:function(){return o(t.deviceId)}},e.createElement("span",{className:j(t.deviceId===r&&"active_2_30Q")},t.label),t.deviceId===r&&e.createElement(hl,{icon:"gou"}))}))))},KQ="iconBox_2k5ro",YQ="host_11RzI",XQ="phone_3ugU4",QQ="miniMode_2vnMT",ZQ="actionBox_2VjWq",JQ="divider_1PJT5",$Q="closeIcon_2SDVT",eZ="footer_2xcF4",tZ="settingBtn_bQQyF",nZ="applyPermNoticeBox_1xavn",iZ="infoBox_2rhnk",rZ="username_shy4x",oZ="avatar_2fu0D",aZ="refuse_18U93",sZ="agree_1I3sn",lZ="closeBox_LaiNL",cZ="independent_2qWqV",uZ="tab_12BLz",dZ="active_L-TEg",pZ="listRoot_3sY6l",hZ="fullContainer_3nuhw",fZ={root:"root_dZL59",avatarWrapper:"avatarWrapper_uGxJb",avatar:"avatar_1O07L",forceFollow:"forceFollow_T5G9x",textBlock:"textBlock_2cgjN",name:"name_2qIXx",highlight:"highlight_3rZXt",note:"note_zmQpL",icon:"icon_2dM7j",disabled:"disabled_ht8zx",iconBox:"iconBox_1SE0A",active:"active_YrSYd",permActionBox:"permActionBox_2ap47",text:"text_2vSdz",en:"en_1f6jw",permTextBox:"permTextBox_o8KZm",phone:"phone_zdd5n",infoBox:"infoBox_1uqcs",absent:"absent_3rzYK",memberDetailPhoneModal:"memberDetailPhoneModal_2_88e",titleBar:"titleBar_2PeI4",closeBox:"closeBox_1Fjes",closeIcon:"closeIcon_2QGWH",mediaBar:"mediaBar_3L3rM",itemRow:"itemRow_1Y7P_",micBox:"micBox_2MMbW",permBar:"permBar_254CH",keyRow:"keyRow_2Bcc5",requestBox:"requestBox_3uYAP",valRow:"valRow_2gBlK",col:"col_2u86A",disable:"disable_1x103",moreBar:"moreBar_2aUSE",dialogItem:"dialogItem_28reK",cohostItem:"cohostItem_2sdNZ",kickoutItem:"kickoutItem_W-04o",hidden:"hidden_LNqGT",moreIcon:"moreIcon_I--ur",morePanel:"morePanel_740CJ",kickoutModalBox:"kickoutModalBox_2Lmr9",title:"title_1ADvG",tip:"tip_YkChF",forbidBox:"forbidBox_iRWDm",actionBox:"actionBox_3UMNs",cancel:"cancel_3VMQ2",confirm:"confirm_2Wtry"};function mZ(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans,a=e.useContext(xl).phoneMode,s=e.useState(!1),l=s[0],c=s[1],u=r.user,d=[e.createElement("span",{key:"ignore",onClick:function(){return i("cancel")}},o("common.cancel")),e.createElement("span",{key:"yichu",style:{color:"#fe5250"},onClick:function(){n(!1)}},o("meeting.yichuhuiyi"))];return a?e.createElement(bV,{className:fZ.phoneModal,header:o("meeting.yichuhuiyi"),footer:d},e.createElement("div",null,o("meeting.queding.yichu",'"'.concat(u.userName,'"')))):e.createElement("div",{className:fZ.kickoutModalBox},e.createElement("div",{className:fZ.title},e.createElement(hl,{icon:"qingchu"}),e.createElement("span",null,o("meeting.yichuhuiyi"))),e.createElement("div",{className:fZ.tip},o("meeting.queding.yichu",'"'.concat(u.userName,'"'))),e.createElement("div",{className:fZ.forbidBox},e.createElement("input",{type:"checkbox",id:"forbid",checked:l,onChange:function(){c(!l)}}),e.createElement("label",{htmlFor:"forbid"},o("meeting.forbid.join"))),e.createElement("div",{className:fZ.actionBox},e.createElement("div",{className:fZ.cancel,onClick:function(){i("cancel")}},o("common.cancel")),e.createElement("div",{className:fZ.confirm,onClick:function(){n(l)}},o("meeting.yichuhuiyi"))))}function vZ(t){var n=t.fail,i=t.success,r=t.content,o=r.state,a=r.person,s=r.meetingChannel,l=r.text,c=r.micIcon,u=r.camIcon,d=r.micIconDisabled,p=r.camIconDisabled,h=r.showCohostSetting,f=r.showForceFollow,m=r.upime,v=W().getUpimeTrans,g=m.userManager.userAccessHint;if(a)return e.createElement(bV,{className:fZ.memberDetailPhoneModal},e.createElement("div",{className:fZ.titleBar},e.createElement("div",{className:fZ.infoBox},e.createElement(ml,{className:fZ.avatar,url:a.avatarUrl,shape:"circle"}),e.createElement("div",{className:j(fZ.textBlock)},e.createElement("span",{className:fZ.name},a.meetingName),l&&e.createElement("span",{className:fZ.note},l))),e.createElement("div",{className:fZ.closeBox,onClick:function(){n("close")}},e.createElement(hl,{icon:"guanbi",className:fZ.closeIcon}))),(s.isHost||s.isCohost)&&e.createElement("div",{className:fZ.moreBar},h&&e.createElement("span",{className:j(fZ.dialogItem,fZ.cohostItem),onClick:function(){g.CoHostUpgradeLabel?i(6):i(7)}},v(s.coHosts.includes(a.loginName)?"meeting.cancel.cohost":"meeting.set.cohost"),g.CoHostUpgradeLabel&&e.createElement("span",{className:fZ.upgradeIcon},e.createElement(g.CoHostUpgradeLabel,null)))));if(o){var y=o.userId===s.localMemberState.userId,b=!s.isHost&&!s.isCohost&&o.perm!==WW.Edit,E=!s.isHost&&!s.isCohost&&o.perm!==WW.Comment,x=!s.isHost&&!s.isCohost&&o.perm!==WW.View;return e.createElement(bV,{className:fZ.memberDetailPhoneModal},e.createElement("div",{className:fZ.titleBar},e.createElement("div",{className:fZ.infoBox},e.createElement(ml,{className:fZ.avatar,url:o.userInfo.avatarUrl,shape:"circle"}),e.createElement("div",{className:j(fZ.textBlock)},e.createElement("span",{className:fZ.name},o.userInfo.meetingName),l&&e.createElement("span",{className:fZ.note},l))),e.createElement("div",{className:fZ.closeBox,onClick:function(){n("close")}},e.createElement(hl,{icon:"guanbi",className:fZ.closeIcon}))),e.createElement("div",{className:fZ.mediaBar},e.createElement("div",{className:j(fZ.itemRow,fZ.micBox),onClick:function(){i(1)}},e.createElement(hl,{className:j(fZ.icon,d&&fZ.disabled),icon:c}),e.createElement("span",{className:fZ.text},o.audio?v("rtc.closeMic"):v("rtc.openMic"))),e.createElement("div",{className:j(fZ.itemRow),onClick:function(){i(2)}},e.createElement(hl,{className:j(fZ.icon,p&&fZ.disabled),icon:u}),e.createElement("span",{className:fZ.text},o.video?v("rtc.closeCamera"):v("rtc.openCamera")))),e.createElement("div",{className:fZ.permBar},e.createElement("div",{className:fZ.keyRow},e.createElement("span",null,v("meeting.edit.perm.tip")),b&&e.createElement("span",{className:fZ.requestBox,onClick:function(){i(10)}},v("meeting.apply.edit.perm"))),e.createElement("div",{className:fZ.valRow},e.createElement("div",{className:fZ.col},e.createElement("input",{type:"radio",id:"edit",name:"3",value:"3",checked:o.perm===WW.Edit,disabled:b,onChange:function(){i(3)}}),e.createElement("label",{htmlFor:"edit",className:j(b&&fZ.disable)},v("meeting.perm.editable"))),e.createElement("div",{className:fZ.col},e.createElement("input",{type:"radio",id:"comment",name:"4",value:"4",checked:o.perm===WW.Comment,disabled:E,onChange:function(){i(4)}}),e.createElement("label",{htmlFor:"comment",className:j(E&&fZ.disable)},v("meeting.perm.commentable"))),e.createElement("div",{className:fZ.col},e.createElement("input",{type:"radio",id:"view",name:"5",value:"5",checked:o.perm===WW.View,disabled:x,onChange:function(){i(5)}}),e.createElement("label",{htmlFor:"view",className:j(x&&fZ.disable)},v("meeting.perm.view"))))),(s.isHost||s.isCohost)&&e.createElement("div",{className:fZ.moreBar},h&&e.createElement("span",{className:j(fZ.dialogItem,fZ.cohostItem),onClick:function(){g.CoHostUpgradeLabel?i(6):i(7)}},v(o.isCohost?"meeting.cancel.cohost":"meeting.set.cohost"),g.CoHostUpgradeLabel&&e.createElement("span",{className:fZ.upgradeIcon},e.createElement(g.CoHostUpgradeLabel,null))),f&&e.createElement("span",{className:fZ.dialogItem,onClick:function(){i(8)}},v(o.isForceFollowing?"meeting.unset.force.follow":"meeting.set.force.follow")),(s.isHost||s.isCohost)&&!1===y&&!o.isHost&&e.createElement("span",{className:j(fZ.dialogItem,fZ.kickoutItem),onClick:function(){i(9)}},v("meeting.yichuhuiyi"))))}return null}var gZ=e.memo((function(t){var n=this,i=t.state,r=t.meetingChannel,o=t.matchValue,a=t.me,s=t.isHost,l=t.isCohost,c=a&&i.isHost,u=a&&i.isCohost;al(r,["localAudioEnabled","localVideoEnabled","editEnabled","perm","hostMutatingId","locamMemberState","remoteMemberStates","coHosts","auxillaryRemoteUserMap","screenSharer"]);var d=W().getUpimeTrans,p=e.useContext(xl),h=p.phoneMode,f=p.upime,m=f.getLang(),v=i.userInfo;al(v);var g=yh(!0),y=g.hide,b=g.toggleHide,E=g.setHide,x=g.skipRef,w=yh(!0),C=w.hide,S=w.toggleHide,k=w.setHide,_=w.skipRef,T=bh(o,v.meetingName).sects,I=e.useRef(null),P=e.useState(!1),N=P[0],M=P[1],R="";c?R="(".concat(d("meeting.host"),", ").concat(d("common.me"),")"):u?R="(".concat(d("meeting.cohost"),", ").concat(d("common.me"),")"):a?R="(".concat(d("common.me"),")"):i.isHost?R="(".concat(d("meeting.host"),")"):i.isCohost?R="(".concat(d("meeting.cohost"),")"):3===i.role&&(R="(".concat(d("meeting.visitor"),")"));var B=!!Object.values(r.auxillaryRemoteUserMap||{}).find((function(e){return e.userId===v.loginName})),L=a?r.localAudioEnabled:i.audio,O=a?r.localVideoEnabled:i.video,F=e.useMemo((function(){return!a&&i.userId===r.hostMutatingId||(!s&&!l||!B)&&!((s||l)&&!a)&&(!a||r.localAudioSuspending)}),[r.localAudioSuspending,i.audio,r.hostMutatingId,l]),z=e.useMemo((function(){return!a&&i.userId===r.hostMutatingId||(!s&&!l||!B)&&!((s||l)&&!a)&&(!a||r.localVideoSuspending)}),[r.localVideoSuspending,i.video,r.hostMutatingId,l]),H=function(){a?r.localAudioEnabled?r.disableLocalAudio():r.enableLocalAudio():(s||l)&&(B?r.mutateAuxiRtcPerm(null,qW.AUDIO,!i.audio):L?r.mutateOtherPerm(i.userId,qW.AUDIO,!1):r.requestMediaPermission(i.userId,1))},U=function(){a?r.localVideoEnabled?r.disableLocalVideo():r.camPermDenied||r.enableLocalVideo():(s||l)&&(B?r.mutateAuxiRtcPerm(null,qW.VIDEO,!i.video):O?r.mutateOtherPerm(i.userId,qW.VIDEO,!1):r.requestMediaPermission(i.userId,2))},V=e.useMemo((function(){return L?"maikefeng-kai":F?"maikefeng-guan":"maikefeng-guan-new"}),[L,F]),G=e.useMemo((function(){return O?"shexiangtou-kai":z?"shexiangtou-guan":"shexiangtou-guan-new"}),[O,z]);e.useEffect((function(){setTimeout((function(){I.current&&M(I.current.scrollWidth>I.current.clientWidth)}))}),[]);var q=r.upime.meetingManager.meetingConfigs.enableCohost,K=r.isHost&&!a&&3!==i.role&&q,Y=e.useRef(null),X=e.useRef(-1);e.useEffect((function(){return function(){-1!==X.current&&h&&f.removeWindow(X.current)}}),[]),e.useEffect((function(){var e=document.getElementById("memberListRoot");if(e){var t=function(){E(!0),k(!0)};return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}}),[]);var Q,Z=f.userManager.userAccessHint;K&&!Z.CoHostUpgradeLabel?Q=e.createElement("div",{onClick:function(){i.isCohost?(r.cancelCohost(i.userId),_c("cv_ongoing_cohost",{type:"解除"})):(r.setCohost(i.userId),_c("cv_ongoing_cohost",{type:"设为"})),E(!0)}},d(i.isCohost?"meeting.cancel.cohost":"meeting.set.cohost")):K&&Z.CoHostUpgradeLabel&&(Q=e.createElement("div",{onClick:f.handleCoHostUpgradeModalOpen},e.createElement("span",null,d(i.isCohost?"meeting.cancel.cohost":"meeting.set.cohost")),e.createElement(Z.CoHostUpgradeLabel,null)));var J=i.perm===WW.Edit?d("meeting.perm.editable"):i.perm===WW.Comment?d("meeting.perm.commentable"):i.perm===WW.View?d("meeting.perm.view"):"",$=function(){i.perm!==WW.Edit&&(a?r.enableSelfEdit():r.mutateOtherPerm(i.userId,qW.EDIT,!0))},ee=function(){i.perm!==WW.Comment&&(a?r.enableSelfComment():r.mutateOtherPerm(i.userId,qW.COMMENT,!0))},te=function(){i.perm!==WW.View&&(a?r.enableSelfView():r.mutateOtherPerm(i.userId,qW.VIEW,!0))};if(h)return e.createElement("div",{className:j(fZ.root,fZ.phone),onClick:function(){return A(n,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return!s&&!l&&!a||B?[2]:[4,f.showWindow(vZ,{state:i,meetingChannel:r,text:R,micIcon:V,micIconDisabled:F,camIcon:G,camIconDisabled:z,showCohostSetting:K,showForceFollow:!0,upime:f},!1,!0)];case 1:return 1!==(e=n.sent())?[3,2]:(H(),[3,13]);case 2:return 2!==e?[3,3]:(U(),[3,13]);case 3:return 3!==e?[3,4]:($(),[3,13]);case 4:return 4!==e?[3,5]:(ee(),[3,13]);case 5:return 5!==e?[3,6]:(te(),[3,13]);case 6:return 6!==e?[3,7]:(f.addToast(d("meeting.cohost.upgrade")),[3,13]);case 7:return 7!==e?[3,8]:(i.isCohost?(r.cancelCohost(i.userId),_c("cv_ongoing_cohost",{type:"解除"})):(r.setCohost(i.userId),_c("cv_ongoing_cohost",{type:"设为"})),[3,13]);case 8:return 8!==e?[3,9]:(r.toggleUserForceFollow(v.loginName,!i.isForceFollowing),[3,13]);case 9:return 9!==e?[3,12]:[4,f.showWindow(mZ,{user:v,meetingChannel:r})];case 10:return t=n.sent(),[4,r.kickoutMeeting(v.loginName,t)];case 11:return n.sent(),[3,13];case 12:10===e&&(r.permApply(qW.EDIT),r.upime.addToast(d("meeting.apply.edit.perm.sent"))),n.label=13;case 13:return[2]}}))}))}},e.createElement("div",{className:fZ.avatarWrapper},e.createElement(ml,{className:fZ.avatar,url:v.avatarUrl,shape:"circle"}),i.isForceFollowing&&e.createElement("div",{className:fZ.forceFollow},e.createElement(hl,{icon:"qiangzhigensui"}))),e.createElement("div",{className:j(fZ.textBlock,r.isHost&&fZ.host)},e.createElement("span",{className:fZ.name,ref:I},r.screenSharer&&r.screenSharer===v.loginName&&e.createElement(hl,{icon:"gongxiangpingmu"}),T.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&fZ.highlight),key:n},t.value):t.value}))),R&&e.createElement("span",{className:fZ.note},R)),e.createElement("div",{className:j(fZ.iconBox,F&&fZ.disabled)},e.createElement(hl,{className:j(fZ.icon,F&&fZ.disabled),icon:V})),e.createElement("div",{className:j(fZ.iconBox,z&&fZ.disabled)},e.createElement(hl,{className:j(fZ.icon,z&&fZ.disabled),icon:G})),e.createElement("div",{className:j(fZ.permTextBox,!s&&!l&&!a&&fZ.disabled,"en"===m&&fZ.en)},e.createElement("span",null,J)));var ne=function(e,t){var n,i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=null===(n=document.getElementById("memberManagePanelRoot"))||void 0===n?void 0:n.getBoundingClientRect(),a={position:"fixed",left:"unset"};return i&&r&&o?i.bottom+r.height<o.bottom?Object.assign(a,{right:"".concat(o.right-i.right,"px"),top:"".concat(i.bottom-o.top+1,"px")}):Object.assign(a,{right:"".concat(o.right-i.right,"px"),top:"".concat(i.top-o.top-r.height-1,"px")}):{}};return e.createElement("div",{className:fZ.root,ref:Y},e.createElement("div",{className:fZ.avatarWrapper},e.createElement(ml,{className:fZ.avatar,url:v.avatarUrl,shape:"circle"}),i.isForceFollowing&&e.createElement("div",{className:fZ.forceFollow},e.createElement(hl,{icon:"qiangzhigensui"}))),e.createElement("div",{className:j(fZ.textBlock,r.isHost&&fZ.host)},e.createElement(Dl,{placement:"bottom",content:v.meetingName,className:j(!N&&fZ.hidden)},e.createElement("span",{className:fZ.name,ref:I},r.screenSharer&&r.screenSharer===v.loginName&&e.createElement(hl,{icon:"gongxiangpingmu"}),T.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&fZ.highlight),key:n},t.value):t.value})))),R&&e.createElement("span",{className:fZ.note},R)),e.createElement(Dl,{placement:"top",content:d("meeting.request.mic.tip"),enable:!a&&(s||l)&&!L,rootClass:j(fZ.iconBox,F&&fZ.disabled),onClick:H},e.createElement(hl,{className:j(fZ.icon,F&&fZ.disabled),icon:V})),e.createElement(Dl,{placement:"top",content:d("meeting.request.cam.tip"),enable:!a&&(s||l)&&!O,rootClass:j(fZ.iconBox,z&&fZ.disabled),onClick:U},e.createElement(hl,{className:j(fZ.icon,z&&fZ.disabled),icon:G})),(s||l)&&e.createElement("div",{className:j(fZ.iconBox,B&&fZ.disabled,!y&&fZ.active),ref:x,onClick:function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){return B||b(),[2]}))}))}},e.createElement(hl,{icon:"gengduo",className:fZ.moreIcon}),!y&&e.createElement(xh,{align:"right",selfAdjust:!0,className:fZ.morePanel,adjustInfo:{adjustType:"adjustByOutside",calcStyle:function(e){return ne(e,x.current)}}},Q,e.createElement("div",{onClick:function(){r.toggleUserForceFollow(v.loginName,!i.isForceFollowing),E(!0)}},d(i.isForceFollowing?"follow.cancel.force":"follow.force")),(l||s)&&!a&&!i.isHost&&e.createElement("div",{onClick:function(){return A(n,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return E(!0),[4,f.showWindow(mZ,{user:v,meetingChannel:r})];case 1:return e=t.sent(),[4,r.kickoutMeeting(v.loginName,e)];case 2:return t.sent(),r.changeViewSrc(r.hostId),[2]}}))}))}},d("meeting.yichuhuiyi")))),B?null:s||l?e.createElement("span",{className:j(fZ.permActionBox,"en"===m&&fZ.en,!C&&fZ.active),ref:_,onClick:function(){S()}},e.createElement("span",{className:fZ.text},J),e.createElement(hl,{icon:"wenjianjiazhankai",className:fZ.icon}),!C&&e.createElement(xh,{align:"right",selfAdjust:!0,className:fZ.morePanel,adjustInfo:{adjustType:"adjustByOutside",calcStyle:function(e){return ne(e,_.current)}}},e.createElement("div",{onClick:function(){k(!0),$()}},d("meeting.perm.editable")),e.createElement("div",{onClick:function(){k(!0),ee()}},d("meeting.perm.commentable")),e.createElement("div",{onClick:function(){k(!0),te()}},d("meeting.perm.view")))):e.createElement("span",{className:j(fZ.permTextBox,!a&&fZ.disabled)},J))})),yZ=e.memo((function(t){var n,i,r=this,o=t.person,a=t.matchValue,s=t.hostId,l=t.meetingChannel;al(o),al(l,["coHosts","auxillaryRemoteUserMap"]),l.deviceHelpLink;var c=W().getUpimeTrans,u=e.useRef(null),d=bh(a,o.meetingName).sects,p=e.useState(!1),h=p[0],f=p[1],m=yh(!0),v=m.hide,g=m.toggleHide,y=m.setHide,b=m.skipRef,E=e.useContext(xl),x=E.phoneMode,w=E.upime,C=e.useRef(null);e.useEffect((function(){setTimeout((function(){u.current&&f(u.current.scrollWidth>u.current.clientWidth)}))}),[]);var S=l.coHosts.includes(o.loginName),k=w.userManager.userAccessHint,_=!!Object.values(l.auxillaryRemoteUserMap||{}).find((function(e){return e.userId===o.loginName})),T="";o.loginName===s?T="(".concat(c("meeting.host"),")"):S?T="(".concat(c("meeting.cohost"),")"):3===o.role&&(T="(".concat(c("meeting.visitor"),")"));var I=l.upime.meetingManager.meetingConfigs.enableCohost;return x?e.createElement("div",{className:j(fZ.root,fZ.phone,fZ.absent),onClick:function(){return A(r,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return I&&l.isHost&&o.role!==Pt.VISITOR&&!_?[4,w.showWindow(vZ,{person:o,meetingChannel:l,text:T,upime:w,showCohostSetting:!0,showForceFollow:!1},!1,!0)]:[2];case 1:return 6===(e=t.sent())?w.addToast(c("meeting.cohost.upgrade")):7===e&&(S?(l.cancelCohost(o.loginName),_c("cv_ongoing_cohost",{type:"解除"})):(l.setCohost(o.loginName),_c("cv_ongoing_cohost",{type:"设为"}))),[2]}}))}))}},e.createElement("div",{className:fZ.infoBox},e.createElement("div",{className:fZ.avatarWrapper},e.createElement(ml,{className:fZ.avatar,url:o.avatarUrl,shape:"circle"})),e.createElement("div",{className:j(fZ.textBlock,l.isHost&&fZ.host)},e.createElement("span",{className:fZ.name,ref:u},d.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&fZ.highlight),key:n},t.value):t.value}))),T&&e.createElement("span",{className:fZ.note},T))),l.isHost&&o.role!==Pt.VISITOR&&I&&e.createElement("div",{className:j(fZ.icon,_&&fZ.disabled)},e.createElement(hl,{icon:"gengduo",className:fZ.moreIcon}))):e.createElement("div",{className:fZ.root,ref:C},e.createElement("div",{className:fZ.avatarWrapper},e.createElement(ml,{className:fZ.avatar,url:o.avatarUrl,shape:"circle"})),e.createElement("div",{className:j(fZ.textBlock,l.isHost&&fZ.host)},e.createElement(Dl,{placement:"bottom",content:o.meetingName,className:j(!h&&fZ.hidden)},e.createElement("span",{className:j(fZ.name),ref:u},d.map((function(t,n){return t.highlight?e.createElement("em",{className:j(t.highlight&&fZ.highlight),key:n},t.value):t.value})))),T&&e.createElement("span",{className:fZ.note},T)),l.isHost&&o.role!==Pt.VISITOR&&I&&e.createElement("div",{className:j(fZ.iconBox,_&&fZ.disabled,!v&&fZ.active),ref:b,onClick:function(){return A(r,void 0,void 0,(function(){return D(this,(function(e){return _||g(),[2]}))}))}},e.createElement(hl,{icon:"gengduo",className:fZ.moreIcon}),!v&&e.createElement(xh,{align:"right",selfAdjust:!0,className:fZ.morePanel,adjustInfo:{adjustType:"adjustCustomContainer",container:null===(i=null===(n=C.current)||void 0===n?void 0:n.parentElement)||void 0===i?void 0:i.parentElement}},e.createElement("div",{onClick:function(){k.CoHostUpgradeLabel?w.handleCoHostUpgradeModalOpen&&w.handleCoHostUpgradeModalOpen():S?l.cancelCohost(o.loginName):l.setCohost(o.loginName),y(!0)}},c(S?"meeting.cancel.cohost":"meeting.set.cohost"),k.CoHostUpgradeLabel&&e.createElement(k.CoHostUpgradeLabel,null)))))})),bZ="root_z5Dfc",EZ="inMemberCtrl_3a1W7",xZ="iconBox_mLq0s",wZ="inMoreCtrl_27xyv",CZ="row_53E7n",SZ=e.createContext({}),kZ=e.memo((function(t){var n=t.isInMemberCtrl,i=void 0!==n&&n,r=t.isInMoreCtrl,o=void 0!==r&&r,a=t.onClick,s=e.useContext(SZ),l=s.meetingChannel,c=s.meetingManager;al(l,["remoteMemberStates"]),al(c,["meetings"]);var u=W().getUpimeTrans,d=yh((function(){var e=l.autoShowInvite;return l.autoShowInvite=!1,!e})),p=d.hide,h=d.setHide,f=d.toggleHide,m=d.skipRef,v=e.useState(!1),g=v[0],y=v[1],b=e.useRef(c.meetingConfigs.AddMemberCmp||function(){return null}),E=e.useContext(xl).phoneMode,x=function(){a&&a(),c.onCopyMeetingLink(l.meetingData.id),h(!0)};e.useEffect((function(){!p||g?setTimeout((function(){l.shouldHideMeetingCtrl=!1})):l.shouldHideMeetingCtrl=!0}),[p,g]);var w=e.useMemo((function(){var e,t;return null!==(t=null===(e=c.meetings.find((function(e){return e.id===l.meetingData.id})))||void 0===e?void 0:e.planJoiners)&&void 0!==t?t:[]}),[c.meetings]);if(E){var C=!ye();return e.createElement("div",{ref:m,className:j(bZ,C&&"landscape_1PKH-",i&&EZ)},e.createElement("div",{className:j(xZ,"phone_1N_tw"),onClick:x},e.createElement(hl,{icon:"lianjie"})))}return e.createElement("div",{ref:m,className:j(bZ,i&&EZ,o&&wZ)},e.createElement(Dl,{placement:"top",content:u("meeting.invite.hovertip"),enable:i},e.createElement("div",{className:j(xZ,!p&&"active_bZKLF"),onClick:function(){g?y(!1):f()}},e.createElement(hl,{icon:"tianjiachengyuan"}),!i&&e.createElement("span",null," ",u("meeting.invite")," "))),!p&&e.createElement(xh,{className:"panelRoot_3SIhM",align:"center"},c.meetingConfigs.couldCheckMemberList&&c.localUserInfo.role===Pt.TEAMMEMBER&&e.createElement("div",{className:CZ,onClick:function(){h(!0),y(!0)}},e.createElement(hl,{icon:"tianjiachengyuan"}),e.createElement("span",null,u("meeting.add.joiners"))),e.createElement("div",{className:CZ,onClick:x},e.createElement(hl,{icon:"lianjie"}),e.createElement("span",null,u("meeting.copyLink.link"))),c.meetingConfigs.showMeetingQrcode&&e.createElement("div",{className:CZ,onClick:function(){a&&a(),c.onOpenMeetingQrcode(l.meetingData.id),h(!0),_c("cv_qrshare_meeting")}},e.createElement(hl,{icon:"erweima"}),e.createElement("span",null,u("meeting.gen.qrcode")))),g&&e.createElement(xh,{className:j("addMemberRoot_NZRq9",i&&EZ,o&&wZ),align:"center",selfAdjust:!0,adjustInfo:{adjustType:"adjustHeight",config:{minHeight:332,maxHeight:520}}},e.createElement(b.current,{onCancel:function(){a&&a(),y(!1)},onSubmit:function(e){a&&a(),function(e){c.updateMeetingJoiners(l.meetingData.id,e),y(!1)}(e)},curJoiners:w,listAll:!1,getMeetingLink:function(){c.onCopyMeetingLink(l.meetingData.id),y(!1)}})))}));function _Z(t){var n=this,i=t.fail,r=t.content,o=W().getUpimeTrans,a=e.useReducer((function(e){return e+1}),0);a[0];var s=a[1],l=r,c=l.meetingChannel,u=l.setReddot,d=c.userPermApplyList;return e.useEffect((function(){null==u||u(!1)}),[]),e.createElement("div",{className:"permApplyListModalBox_J73ps"},e.createElement("div",{className:"titleBar_LV92x"},e.createElement("span",{className:"text_2ui0v"},o("meeting.member.perm.apply")),e.createElement("span",{className:KQ,onClick:function(){i("close")}},e.createElement(hl,{icon:"guanbi",className:$Q}))),e.createElement("div",{className:"listBox_31cRG"},d.length>0?d.map((function(t,i){var r=c.upime.getUserInfo(t.userId);return e.createElement("div",{className:"listitem_2Qwhx",key:t.userId},e.createElement("div",{className:iZ},e.createElement(ml,{className:oZ,url:r.avatarUrl,shape:"circle"}),e.createElement("span",null,r.userName)),e.createElement("div",{className:ZQ},e.createElement("span",{className:"tip_2HpEF"},o("meeting.apply.edit.perm")),e.createElement("span",{className:aZ,onClick:function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,c.handlePermApply(exports.E(exports.E({},t),{status:2}))];case 1:return 0===e.sent()&&(d.splice(i,1),s()),[2]}}))}))}},o("common.refuse")),e.createElement("span",{className:sZ,onClick:function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,c.handlePermApply(exports.E(exports.E({},t),{status:1}))];case 1:return 0===e.sent()&&(d.splice(i,1),c.remoteMemberStates[t.userId]&&(c.remoteMemberStates[t.userId].perm=WW.Edit,c.remoteMemberStates=exports.E({},c.remoteMemberStates)),s()),[2]}}))}))}},o("common.agree"))))})):e.createElement("div",{className:"noneBox_8vfqp"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,o("meeting.perm.apply.none")))))}var TZ=e.forwardRef((function(t,n){var i=this,r=t.isIndependent,o=t.meetingChannel,a=W().getUpimeTrans,s=e.useState(!1),l=s[0],c=s[1],u=e.useContext(SZ),d=u.miniMode,p=u.setReddot,h=e.useState(!1),f=h[0],m=h[1];al(o,["userPermApplyList"]);var v=o.userPermApplyList,g=o.upime;if(e.useEffect((function(){o.userPermApplyList.length>0&&c(!1)}),[o.userPermApplyList]),e.useEffect((function(){r||1!==v.length||p(!1)}),[]),e.useImperativeHandle(n,(function(){return{setForceHide:function(e){m(e),e||c(!0)}}})),o.upime.phoneMode||f)return null;if(0===v.length)return null;if(r&&!o.isHost&&!o.isCohost)return null;if(l)return null;if(1===v.length){var y=v[0],b=g.getUserInfo(y.userId);return e.createElement("div",{className:j(nZ,r&&cZ,d&&QQ)},e.createElement("div",{className:iZ},e.createElement(ml,{className:oZ,url:b.avatarUrl,shape:"circle"}),e.createElement("span",{className:rZ},a("meeting.apply.edit.perm.going",b.userName))),e.createElement("div",{className:ZQ},e.createElement("span",{className:aZ,onClick:function(){return A(i,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,o.handlePermApply(exports.E(exports.E({},y),{status:2}))];case 1:return 0===e.sent()&&(o.userPermApplyList=[]),[2]}}))}))}},a("common.refuse")),e.createElement("span",{className:sZ,onClick:function(){return A(i,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,o.handlePermApply(exports.E(exports.E({},y),{status:1}))];case 1:return 0===e.sent()&&(o.remoteMemberStates[y.userId]&&(o.remoteMemberStates[y.userId].perm=WW.Edit,o.remoteMemberStates=exports.E({},o.remoteMemberStates)),o.userPermApplyList=[]),[2]}}))}))}},a("common.agree")),r&&e.createElement("span",{className:lZ,onClick:function(){c(!0)}},e.createElement(hl,{icon:"guanbi",className:$Q}))))}return e.createElement("div",{className:j(nZ,r&&cZ)},e.createElement("div",{className:iZ},!r&&e.createElement(hl,{icon:"jiesuo",className:"jiesuo_1eML0"}),e.createElement("span",{className:rZ},a("meeting.apply.edit.perm.goings",v.length))),e.createElement("div",{className:ZQ},e.createElement("span",{className:sZ,onClick:function(){g.showWindow(_Z,{meetingChannel:o,setReddot:p})}},a("common.chakan")),r&&e.createElement("span",{className:lZ,onClick:function(){c(!0)}},e.createElement(hl,{icon:"guanbi",className:$Q}))))}));function IZ(t){var n=t.success,i=t.fail,r=t.content;W().getUpimeTrans;var o=r,a=o.meetingManager,s=o.initSettings,l=o.meetingId,c=o.upime,u=e.useState(s),d=u[0],p=u[1],h=a.meetingConfigs.AdvancedSettingsCmp;return e.useEffect((function(){c.meetingMode||i("close")}),[c.meetingMode]),h?e.createElement("div",{className:gV.advanceSettingModal},e.createElement("span",{className:gV.closeBox,onClick:function(){n(d)}},e.createElement(hl,{icon:"guanbi",className:gV.closeIcon})),e.createElement(h,{onDataChange:function(e){p(e),a.updateAdvanceSettings(l,e)},data:d})):null}var PZ=function(t){var n=t.meetingChannel,i=t.closePanel,r=t.className,o=W().getUpimeTrans,a=e.useState(""),s=a[0],l=a[1],c=n.isHost,u=n.isCohost,d=n.upime;al(n,["localMemberState","remoteMemberStates"]);var p=Object.keys(n.remoteMemberStates).length+(n.auxillaryRemoteUserMap?1:0)+1,h=c||u?e.createElement("div",{className:eZ},e.createElement("div",{className:tZ,onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t;return D(this,(function(i){switch(i.label){case 0:return d.meetingManager.meetingConfigs.AdvancedSettingsCmp&&(e=d.meetingManager.meetings.find((function(e){return e.id===n.meetingData.id})))?[4,d.showWindow(IZ,{meetingManager:d.meetingManager,initSettings:{defaultForceFollow:e.defaultForceFollow,defaultPerm:e.defaultPerm},meetingId:e.id,upime:n.upime})]:[3,2];case 1:t=i.sent(),n.toggleMeetingForceFollow(!!t.defaultForceFollow),i.label=2;case 2:return[2]}}))}))}},o("common.advance.setting"))):n.perm!==WW.Edit?e.createElement("div",{className:j(eZ,"center_1Wa8z")},e.createElement("div",{className:"applyBtn_2qLpC",onClick:function(){n.permApply(qW.EDIT),n.upime.addToast(o("meeting.apply.edit.perm.sent"))}},o("meeting.apply.edit.perm"))):null;return d.phoneMode&&(h=e.createElement("div",{className:j(eZ,d.phoneMode&&XQ)},e.createElement("div",{className:tZ,onClick:function(){d.meetingManager.onCopyMeetingLink(n.meetingData.id)}},o("meeting.copy.link")),n.perm===WW.Edit||c||u?null:e.createElement("div",{className:j(tZ,XQ),onClick:function(){n.permApply(qW.EDIT),n.upime.addToast(o("meeting.apply.edit.perm.sent"))}},o("meeting.apply.edit.perm")))),e.createElement("div",{className:j("panelRoot_2exv-",r),id:"memberManagePanelRoot"},e.createElement("div",{className:"title_2vaXD"},e.createElement("span",null,e.createElement("span",{className:"mainText_DKMJ-"},o(c||u?"meeting.member.management.label.popup":"meeting.member.label.popup")),e.createElement("span",{className:"count_3A8rq"},"(",p,")")),e.createElement("span",{className:ZQ},!d.phoneMode&&e.createElement(e.Fragment,null,e.createElement(kZ,{isInMemberCtrl:!0}),e.createElement("span",{className:JQ})),e.createElement("span",{onClick:i,className:"closeBtnBox_xB3WR"},e.createElement(hl,{icon:"guanbi",className:$Q})))),e.createElement(TZ,{isIndependent:!1,meetingChannel:n}),e.createElement(gl,{value:s,onChange:function(e){l(e.target.value)},placeholder:["meeting.search.member"],onClearClick:function(){l("")},icon:"sousuo",className:"mb12_Ct2bh"}),s?e.createElement(MZ,{value:s,meetingChannel:n}):e.createElement(NZ,{meetingChannel:n}),h)},NZ=e.memo((function(t){var n=t.meetingChannel;al(n,["localMemberState","remoteMemberStates","absentJoiners","forceFollow","coHosts","auxillaryRemoteUserMap","screenSharer"]);var i=W().getUpimeTrans,r=e.useContext(xl).upime,o=e.useState(0),a=o[0],s=o[1],l=e.useMemo((function(){var e=n.absentJoiners,t=n.coHosts,i=n.hostId,r=n.localMemberState,o=n.remoteMemberStates,s=n.auxillaryRemoteUserMap,l=n.screenSharer;if(0===a){var c=r,u=Object.values(s||{})[0],d=Object.values(o).sort((function(e,t){return FW(e.userInfo,t.userInfo)})),p=d.find((function(e){return e.userId===l})),h=d.find((function(e){return e.userId===i&&e.userId!==l})),f=d.filter((function(e){return t.includes(e.userId)&&e.userId!==l})),m=d.filter((function(e){return e.userId!==l&&e.userId!==i&&!1===t.includes(e.userId)&&e.role!==Pt.VISITOR})),v=d.filter((function(e){return e.role===Pt.VISITOR&&e.userId!==l}));return R(R(R([c,u,p,h],f,!0),m,!0),v,!0).filter((function(e){return void 0!==e}))}var g=R([],e,!0).sort(FW);return h=g.find((function(e){return e.loginName===i})),f=g.filter((function(e){return t.includes(e.loginName)})),m=g.filter((function(e){return e.loginName!==i&&!1===t.includes(e.loginName)&&e.role!==Pt.VISITOR})),v=g.filter((function(e){return e.role===Pt.VISITOR})),R(R(R([h],f,!0),m,!0),v,!0).filter((function(e){return void 0!==e}))}),[a,n.absentJoiners,n.remoteMemberStates,n.localMemberState,n.coHosts,n.hostId,n.auxillaryRemoteUserMap,n.screenSharer]),c=Object.keys(n.remoteMemberStates).length+(n.auxillaryRemoteUserMap?1:0)+1,u=r.localUserInfo.role===Pt.GUEST||r.localUserInfo.role===Pt.VISITOR;return e.createElement("div",{className:"memberManageRoot_1were"},!u&&e.createElement("div",{className:"header_dp6rJ"},e.createElement("div",{className:j(uZ,!a&&dZ),onClick:function(){return s(0)}},e.createElement("span",null,i("meeting.present"),"·",c)),e.createElement("div",{className:j(uZ,a&&dZ),onClick:function(){return s(1)}},e.createElement("span",null,i("meeting.absent"),"·",Object.keys(n.absentJoiners).length))),(n.isHost||n.isCohost)&&e.createElement("div",{className:"toggle_39O0w"},e.createElement("span",null," ",i("follow.force")),e.createElement(Hl,{value:n.forceFollow,config:{onChange:function(){return n.toggleMeetingForceFollow(!n.forceFollow)}}})),e.createElement("div",{className:pZ,id:"memberListRoot"},e.createElement("div",null,0===a?l.map((function(t){return e.createElement(gZ,{key:t.userId,meetingChannel:n,state:t,me:t.userId===n.localMemberState.userId,isHost:n.isHost,isCohost:n.isCohost})})):l.map((function(t){return e.createElement(yZ,{key:t.loginName,person:t,hostId:n.hostId,meetingChannel:n})})))))})),MZ=e.memo((function(t){var n=t.meetingChannel,i=t.value,r=W().getUpimeTrans;al(n,["remoteMemberStates","auxillaryRemoteUserMap","absentJoiners","hostId","coHosts","screenSharer"]);var o=e.useState({present:[],absent:[]}),a=o[0],s=o[1],l=e.useState(!1),c=l[0],u=l[1],d=e.useContext(xl).upime,p=e.useCallback((function(e){var t=n.absentJoiners,i=n.coHosts,r=n.hostId,o=n.localMemberState,a=n.remoteMemberStates,s=n.auxillaryRemoteUserMap,l=n.screenSharer,c={present:[],absent:[]},u=o,d=Object.values(s||{})[0],p=Object.values(a).sort((function(e,t){return FW(e.userInfo,t.userInfo)})),h=p.find((function(e){return e.userId===l})),f=p.find((function(e){return e.userId===r&&e.userId!==l})),m=p.filter((function(e){return i.includes(e.userId)&&e.userId!==l})),v=p.filter((function(e){return e.userId!==l&&e.userId!==r&&!1===i.includes(e.userId)&&e.role!==Pt.VISITOR})),g=p.filter((function(e){return e.role===Pt.VISITOR&&e.userId!==l})),y=R(R(R([u,d,h,f],m,!0),v,!0),g,!0);c.present=y.filter((function(e){return void 0!==e})).filter((function(t){return-1!==t.userInfo.meetingName.search(e)}));var b=R([],t,!0).sort(FW);return f=b.find((function(e){return e.loginName===r})),m=b.filter((function(e){return i.includes(e.loginName)})),v=b.filter((function(e){return e.loginName!==r&&!1===i.includes(e.loginName)&&e.role!==Pt.VISITOR})),g=b.filter((function(e){return e.role===Pt.VISITOR})),y=R(R(R([f],m,!0),v,!0),g,!0),c.absent=y.filter((function(e){return void 0!==e})).filter((function(t){return-1!==t.meetingName.search(e)})),c}),[]),h=e.useCallback(te((function(e){s(p(e)),u(!1)}),200),[]);e.useEffect((function(){u(!0),h(i)}),[i]),e.useEffect((function(){h(i)}),[n.remoteMemberStates,n.localMemberState]);var f=d.localUserInfo.role===Pt.GUEST||d.localUserInfo.role===Pt.VISITOR;return e.createElement("div",{className:j(pZ,"search_1Th-2")},c?e.createElement("div",{className:hZ},e.createElement(hl,{icon:"jiazai",className:"loading_2mJnn"})):a.absent.length+a.present.length===0?e.createElement("div",{className:hZ},e.createElement("span",null,r("search.noSearchRes"))):e.createElement("div",null,a.present.length?e.createElement(e.Fragment,null,!f&&e.createElement("div",{className:JQ}," ",r("meeting.present")," "),e.createElement("div",{style:{padding:"0 16px"}},a.present.map((function(t){return e.createElement(gZ,{key:t.userId,meetingChannel:n,state:t,me:t.userId===n.localMemberState.userId,isHost:n.isHost,isCohost:n.isCohost,matchValue:i})})))):null,a.absent.length>0&&!f?e.createElement(e.Fragment,null,e.createElement("div",{className:JQ},r("meeting.absent")," "),e.createElement("div",{style:{padding:"0 16px"}},a.absent.map((function(t){return e.createElement(yZ,{key:t.loginName,person:t,hostId:n.hostId,matchValue:i,meetingChannel:n})})))):null))})),AZ=function(t){var n=t.isInMoreCtrl,i=void 0!==n&&n,r=t.onClick,o=e.useContext(SZ),a=o.meetingChannel,s=o.meetingManager,l=o.applyPermNoticeInstance,c=o.miniMode,u=o.reddot,d=o.setReddot,p=W().getUpimeTrans;al(a,["remoteMemberStates","coHosts","auxillaryRemoteUserMap","userPermApplyList"]);var h=e.useState(!0),f=h[0],m=h[1],v=e.useContext(xl),g=v.phoneMode,y=v.upime;e.useEffect((function(){f?(a.checkingMemberList=!1,l&&l.setForceHide(!1)):(setTimeout((function(){a.checkingMemberList=!0})),l&&l.setForceHide(!0))}),[f]),e.useEffect((function(){f&&a.userPermApplyList.length>0?d(!0):d(!1)}),[a.userPermApplyList]),e.useEffect((function(){a.isCohost||f||m(!0)}),[a.isCohost]);var b=Object.keys(a.remoteMemberStates).length+(a.auxillaryRemoteUserMap?1:0)+1;if(!(s.meetingConfigs.couldCheckMemberList||a.isCohost&&y.localUserInfo.role===Pt.GUEST))return null;if(g){var E=!ye();return e.createElement("div",{style:{position:"relative",zIndex:-1},className:j(E&&"landscape_4m7UE")},e.createElement("div",{className:j(KQ,a.isHost&&YQ,g&&XQ),onClick:function(){y.showPhoneDrawer(PZ,{meetingChannel:a,className:"phonePannelRoot_NHT9M",closePanel:y.closePhoneDrawer.bind(y)},{classNames:"heighttop98_1H6yD"})}},e.createElement(hl,{icon:"tuandui"})))}return e.createElement("div",{style:{position:"relative",zIndex:-1},className:j(i&&"inMoreCtrl_2ObEO",u&&"reddot_3GgLe")},e.createElement("div",{className:j(KQ,a.isHost&&YQ),onClick:function(){m(!f)}},e.createElement(hl,{icon:"tuandui"}),e.createElement("span",null,a.isHost||a.isCohost?p("meeting.member.management",b):p("meeting.member",b))),!f&&e.createElement(xh,{className:j("subWin_TjjfP",!a.isHost&&!a.isCohost&&"memberonly_34qeQ",c&&QQ),align:"center",selfAdjust:!0,adjustInfo:{adjustType:"adjustHeight",config:{minHeight:332,maxHeight:520}}},e.createElement(PZ,{meetingChannel:a,closePanel:function(){r&&r(),m(!0)}})))},DZ=function(t){var n=t.user,i=t.absents,r=t.following,o=t.me,a=t.upime,s=t.miniMode,l=t.onClick,c=t.meetingChannel,u=a.followManager,d=c.scene;al(n),al(u,["followingUser","forceFollowing"]);var p=e.useContext(xl).phoneMode,h=W().getUpimeTrans,f=e.useMemo((function(){return!o&&!!(null==i?void 0:i.some((function(e){return e.loginName===n.loginName})))}),[i]),m=u.followingUser===n;if(!u.followingUser&&c.curViewSrc!==a.localUserInfo.loginName)return e.createElement(ul,{className:j("resumeFollow_3uw0k",p&&OX),type:"primary",onClick:function(e){e.stopPropagation(),d.setFollowingUser(n)}},e.createElement(hl,{icon:"chexiao"}),h("follow.resume"));var v=r&&(m||o)?e.createElement("div",{className:HX},e.createElement(hl,{icon:"yanjing-kai"})):null;return e.createElement("div",{className:j("mainAvatar_2eNp1",f&&"absent_2k3I7"),onClick:l},s?v:e.createElement("div",{className:j(FX,"big_3D_eC",p&&OX)},e.createElement(ml,{className:zX,shape:"circle",url:n.avatarUrl}),v),e.createElement("div",{className:"text_2XPfr"},e.createElement("span",{className:"top_6nwNo"},h(u.forcedFollowing?"follow.force":"user.following.hint.prefix")),e.createElement("span",{className:"bottom_7Prqn"},n.meetingName)))},RZ=function(){var t=e.useContext(SZ),n=t.meetingChannel,i=t.miniMode,r=n.isHost,o=n.localMemberState,a=n.curViewSrc,s=n.absentJoiners,l=n.upime,c=n.isCohost;al(n,["absentJoiners","curViewSrc","localMemberState","remoteMemberStates","forceFollow"]);var u=yh(!0),d=u.hide,p=u.toggleHide,h=u.skipRef,f=u.setHide,m=e.useContext(xl).phoneMode;e.useEffect((function(){d?n.shouldHideMeetingCtrl=!0:setTimeout((function(){return n.shouldHideMeetingCtrl=!1}))}),[d]),e.useEffect((function(){c||d||f(!0)}),[c]);var v=function(){(r||o.userId===a||c)&&(m?l.showPhoneDrawer(VX,{setHide:f,meetingChannel:n,closePanel:l.closePhoneDrawer.bind(l)}):p())},g=m&&!ye();return e.createElement("div",{className:j("root_KxpWP",i&&"mini_3LG51",m&&OX,g&&"landscape_1mAIT"),ref:h},e.createElement(e.Fragment,{key:a},e.createElement(DZ,{meetingChannel:n,user:l.getUserInfo(a),absents:s,following:!0,me:a===o.userId,upime:l,miniMode:i,onClick:v})),(r||o.userId===a||c)&&e.createElement("div",{className:"toggleBtn_1omof"},e.createElement("div",{className:"btnCon_ArADi",onClick:v},e.createElement("div",{className:j("triangle_1e8tC",!d&&"open_1yVXu")})),!d&&e.createElement(xh,{className:"memberListCon_1zEDN",align:"left"},e.createElement(WX,{setHide:f,meetingChannel:n}))))};function BZ(t){var n=t.customMeetingTools,i=t.miniMode,r=t.landscape,o=e.useContext(xl).phoneMode;return n&&n.length>0?e.createElement(e.Fragment,null,(!i||o)&&e.createElement("div",{className:j(IQ,o&&PQ)}),n.map((function(t){return e.createElement("div",{key:t.key,className:j("iconBox_2U1MR",i&&"mini_3ert9",o&&"phoneItem_3j52G",r&&"landscape_3CRk1",t.className),style:i||o?void 0:t.style,onClick:t.onClick},e.createElement(hl,{icon:t.icon}),!i&&!o&&e.createElement("span",null,t.name))}))):null}var LZ="recordBox_1w_T6",OZ="wording_3gEM0",FZ="recordConfirmModal_1bduL",zZ="openAudioModal_1lZHw",HZ="endRecordConfirmModal_3cpua",UZ="headerRow_AuASu",WZ="bodyRow_3KPZ0",VZ="footerRow_2-U7l",jZ="cancel_30AJx",GZ="confirm_2sdOo";function qZ(t){var n=t.success,i=t.fail,r=W().getUpimeTrans;return e.createElement("div",{className:FZ},e.createElement("div",{className:UZ,style:{display:"flex"}},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,r("meeting.record.modal.header"))),e.createElement("div",{className:WZ},r("meeting.record.modal.body")),e.createElement("div",{className:VZ},e.createElement("div",{className:jZ,onClick:function(){i("close")}},r("common.cancel")),e.createElement("div",{className:GZ,onClick:function(){n(1)}},r("meeting.record.modal.confirm"))))}function KZ(t){var n=t.success,i=W().getUpimeTrans;return e.createElement("div",{className:zZ},e.createElement("div",{className:UZ},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,i("meeting.open.audio.modal.header"))),e.createElement("div",{className:WZ},i("meeting.open.audio.modal.body")),e.createElement("div",{className:VZ},e.createElement("div",{className:jZ,onClick:function(){n(1)}},i("meeting.open.audio.modal.cancel")),e.createElement("div",{className:GZ,onClick:function(){n(2)}},i("meeting.open.audio.modal.confirm"))))}function YZ(t){var n=t.success,i=t.fail,r=W().getUpimeTrans;return e.createElement("div",{className:HZ},e.createElement("div",{className:UZ},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,r("meeting.record.end.modal.header"))),e.createElement("div",{className:WZ},r("meeting.record.end.modal.body")),e.createElement("div",{className:VZ},e.createElement("div",{className:jZ,onClick:function(){i("close")}},r("common.cancel")),e.createElement("div",{className:GZ,onClick:function(){n(1)}},r("meeting.record.end.modal.confirm"))))}function XZ(t){var n=this,i=t.onClick,r=W().getUpimeTrans,o=e.useContext(SZ),a=o.meetingChannel,s=o.meetingManager,l=e.useContext(xl).upime;al(a,["cloudRecord"]);var c=a.cloudRecord,u=r("meeting.record.icon"),d="kaishiluzhi",p=!1;c&&(c.state===VW.STARTING?u=r("meeting.record.qidongzhong"):c.state===VW.RECORDING&&(u=r("meeting.record.end"),d="jieshuluzhi",p=!0));var h=l.userManager.userAccessHint;return e.createElement("div",{className:j(LZ),onClick:function(){return A(n,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return i&&i(),s.meetingConfigs.showUpgradeModal?(s.meetingConfigs.showUpgradeModal(),[2]):c?[3,6]:[4,l.showWindow(qZ)];case 1:return 1!==t.sent()?[3,5]:s.meetingConfigs.getMeetingRecordUrl?[4,s.meetingConfigs.getMeetingRecordUrl(a.id)]:[3,5];case 2:return e=t.sent(),[4,a.startCloudRecord(e)];case 3:return t.sent(),a.localAudioEnabled?[3,5]:[4,l.showWindow(KZ)];case 4:1===t.sent()&&(a.micPermDenied?a.openMicWillBeDenied=!0:a.enableLocalAudio()),t.label=5;case 5:return[3,8];case 6:return c.state!==VW.RECORDING?[3,8]:[4,l.showWindow(YZ)];case 7:1===t.sent()&&a.endCloudRecord(),t.label=8;case 8:return[2]}}))}))}},e.createElement(hl,{icon:d,style:p?{color:"rgba(254, 82, 80, 1)"}:{}}),e.createElement("span",{className:OZ,style:p?{color:"rgba(254, 82, 80, 1)"}:{}},u),h&&h.MeetingRecordingUpgradeLabel&&e.createElement(h.MeetingRecordingUpgradeLabel,null))}function QZ(t){var n=t.success,i=W().getUpimeTrans;return e.createElement("div",{className:yG},e.createElement("div",{className:bG},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,i("meeting.screen.share.warning"))),e.createElement("div",{className:EG,onClick:function(){n(1)}},i("meeting.end.confirm")))}function ZZ(t){var n=t.success,i=t.content,r=W().getUpimeTrans,o=e.useContext(xl).upime,a=i.meetingChannel;return e.createElement("div",{className:xG},e.createElement("div",{className:bG},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",null,o.getUserInfo(a.screenSharer).userName+" "+r("meeting.screen.share.going"))),e.createElement("div",{className:wG},r("meeting.screen.share.change.subtitle")),e.createElement("div",{className:CG},e.createElement("div",{className:SG,onClick:function(){n(0)}},r("common.cancel")),e.createElement("div",{className:kG,onClick:function(){n(1)}},r("meeting.screen.share.change.continue"))))}var JZ=!0;function $Z(t){var n=this,i=t.onClick,r=W().getUpimeTrans,o=e.useContext(xl).upime,a=e.useContext(SZ).meetingChannel;al(a,["localScreenVideoEnabled","curViewSrc"]);var s=!a.localScreenVideoEnabled&&a.curViewSrc!==o.localUserInfo.loginName;return e.createElement(Dl,{content:r("meeting.screen.share.jinzhujiangshare"),placement:"top",enable:s},e.createElement("div",{className:j(mG,s&&gG),onClick:function(e){return A(n,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return i&&i(),s?(e.stopPropagation(),[2]):a.localScreenVideoEnabled?(a.disableLocalScreenVideoAndAudio(),[3,9]):[3,1];case 1:return a.screenSharer?[4,o.showWindow(ZZ,{meetingChannel:a})]:[3,6];case 2:return 1!==t.sent()?[3,5]:[4,a.enableLocalScreenVideoAndAudio()];case 3:return t.sent(),JZ&&a.localScreenVideoEnabled?[4,o.showWindow(QZ)]:[3,5];case 4:t.sent(),JZ=!1,t.label=5;case 5:return[3,9];case 6:return[4,a.enableLocalScreenVideoAndAudio()];case 7:return t.sent(),JZ&&a.localScreenVideoEnabled?[4,o.showWindow(QZ)]:[3,9];case 8:t.sent(),JZ=!1,t.label=9;case 9:return[2]}}))}))}},e.createElement(hl,{icon:"gongxiangpingmu",className:j(a.localScreenVideoEnabled&&vG)}),e.createElement("span",{className:j(a.localScreenVideoEnabled&&vG)},a.localScreenVideoEnabled?r("meeting.screen.share.icon.stop"):r("meeting.screen.share.icon"))))}function eJ(){var t=this,n=W().getUpimeTrans,i=e.useContext(SZ),r=i.miniMode,o=i.meetingChannel,a=e.useContext(xl).phoneMode,s=yh(!0),l=s.hide,c=s.setHide,u=s.toggleHide,d=s.skipRef,p=o.isHost,h=o.isCohost,f=o.upime,m=p||h,v=p||h;return _e.desktop||m?e.createElement("div",{ref:d,style:{position:"relative"}},e.createElement("div",{className:j("moreCtrlBox_3H5ND",r&&fG),onClick:function(){u()}},e.createElement(hl,{icon:"shuangshang"}),!a&&!r&&e.createElement("span",null," ",n("common.more")," ")),!l&&e.createElement(xh,{className:j("panelRoot_2VoAv",r&&fG),selfAdjust:!0},e.createElement("div",{className:"row_zfvlt"},r&&e.createElement(e.Fragment,null,e.createElement(kZ,{isInMoreCtrl:!0,onClick:function(){c(!0)}}),e.createElement(AZ,{isInMoreCtrl:!0,onClick:function(){c(!0)}})),_e.desktop&&e.createElement($Z,{onClick:function(){c(!0)}}),m&&e.createElement(XZ,{onClick:function(){c(!0)}}),v&&e.createElement("div",{className:"advanceSettingBox_14I4H",onClick:function(){return A(t,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return c(!0),f.meetingManager.meetingConfigs.AdvancedSettingsCmp&&(e=f.meetingManager.meetings.find((function(e){return e.id===o.meetingData.id})))?[4,f.showWindow(IZ,{meetingManager:f.meetingManager,initSettings:{defaultForceFollow:e.defaultForceFollow,defaultPerm:e.defaultPerm},meetingId:e.id,upime:f})]:[3,2];case 1:t=n.sent(),o.toggleMeetingForceFollow(!!t.defaultForceFollow),n.label=2;case 2:return[2]}}))}))}},e.createElement(hl,{icon:"settings",className:"settingIcon_3kaB_"}),e.createElement("span",{className:"text_2uRRu"},n("meeting.advance.setting.btn")))))):null}function tJ(){var t=W().getUpimeTrans,n=e.useContext(xl),i=n.upime,r=n.phoneMode,o=e.useContext(SZ),a=o.meetingChannel,s=o.miniMode;return al(a,["localScreenVideoEnabled","screenSharer"]),a.screenSharer?e.createElement("div",{className:j("screenShareWidgetBox_3DBJ5",s&&fG,r&&"phoneMode_3fKSg"),onClick:function(){r&&a.publish("onOpenSharePage","")}},e.createElement(hl,{icon:"gongxiangpingmu"}),e.createElement("span",null,a.localScreenVideoEnabled?t("common.you"):i.getUserInfo(a.screenSharer).userName," ",t("meeting.screen.share.going")),r&&e.createElement(hl,{icon:"jiantou-you",className:"rightArrow_14hwk"}),a.localScreenVideoEnabled&&e.createElement("span",{className:"stopBox_1mTkG",onClick:function(){a.disableLocalScreenVideoAndAudio()}},t("meeting.screen.share.icon.stop"))):null}var nJ,iJ,rJ=function(t){var n=t.upime,i=t.className,r=t.customMeetingTools,o=n.meetingManager,a=n.hideControls,s=o.meetingChannel;return s&&!a?e.createElement(oJ,{meetingChannel:s,className:i,meetingManager:o,customMeetingTools:r}):null},oJ=function(t){var n=t.meetingChannel,i=t.className,r=t.meetingManager,o=t.customMeetingTools,a=W().getUpimeTrans,s=yh(!0),l=s.hide,c=s.skipRef,u=s.toggleHide;al(n,["meetingCtrlHided","proMeetingActFrozen","isCohost"]);var d=e.useContext(xl),p=d.phoneMode,h=d.upime,f=e.useState(!1),m=f[0],v=f[1],g=e.useRef(null),y=e.useState(n.userPermApplyList.length>0),b=y[0],E=y[1];e.useEffect((function(){var e=[h.subscribe("fullscreenModeChange",(function(e){e&&v(!0)})),h.subscribe("toolbarVisibilityChange",(function(e){"hidden"===e&&v(!0)}))];return function(){e.forEach((function(e){return e()}))}}),[]),e.useEffect((function(){l?setTimeout((function(){n.shouldHideMeetingCtrl=!0})):n.shouldHideMeetingCtrl=!1}),[l]);var x=p&&!ye(),w=_e.isPwa,C=h.localUserInfo.role===Pt.VISITOR;return p?e.createElement(SZ.Provider,{value:{meetingChannel:n,meetingManager:r,miniMode:m,applyPermNoticeInstance:g.current,reddot:b,setReddot:E}},e.createElement(tJ,null),e.createElement("div",{className:j(kQ,i,p&&w&&"pwa_mPHjF",C&&p&&_Q)},e.createElement(RZ,null),e.createElement("div",{className:j(IQ,PQ,x&&NQ,C&&p&&_Q)}),e.createElement(jQ,{miniMode:m,rtcChannel:n}),r.meetingConfigs.enableInviteInMeeting&&e.createElement(kZ,null),e.createElement(AZ,null),e.createElement(BZ,{customMeetingTools:o,miniMode:m,landscape:x}))):e.createElement(SZ.Provider,{value:{meetingChannel:n,meetingManager:r,miniMode:m,applyPermNoticeInstance:g.current,reddot:b,setReddot:E}},e.createElement(tJ,null),e.createElement(TZ,{ref:g,isIndependent:!0,meetingChannel:n}),e.createElement("div",{className:j(kQ,i,m&&"mini_1pZ00")},e.createElement("div",{className:"mini_btn_RiTBO",onClick:function(){v(!m)}},e.createElement(hl,{className:j("mini_icon_3Qa4-"),icon:"jiantou-xia"})),e.createElement("div",{className:IQ}),e.createElement(RZ,null),m&&e.createElement("div",{className:j(IQ,PQ,x&&NQ,C&&p&&_Q)}),e.createElement(jQ,{miniMode:m,rtcChannel:n}),!m&&r.meetingConfigs.enableInviteInMeeting&&e.createElement(kZ,null),!m&&e.createElement(AZ,null),e.createElement(eJ,null),m&&e.createElement("div",{className:IQ}),e.createElement(BZ,{customMeetingTools:o,miniMode:m,landscape:x}),e.createElement("div",{className:"meetingActionContainer_2L3AP",ref:c},e.createElement("div",{className:j("meetingAction_1KUPf",l?"endMeeting_ZyMGY":"cancelBtn_2PbBR"),onClick:function(){n.isHost?u():n.leaveMeeting()}},l?n.isHost?a("meeting.end"):a("meeting.leave"):a("common.cancel")),!l&&e.createElement(xh,{className:j("endMeetingPanel_3zrYR"),align:"center"},n.isHost&&e.createElement("div",{className:j("endBtn_2AHMd",TQ),onClick:function(){return n.leaveMeeting(!0)}},a("meeting.end")),e.createElement("div",{className:j("leaveBtn_1I2sy",TQ),onClick:function(){n.leaveMeeting()}},a("meeting.leave"))))))},aJ=function(t){var n=t.url,i=t.placeholder,r=t.insertNewFrame,o=t.editable,a=W().getUpimeTrans;return e.createElement("div",{className:j(_X.placeholderContainer)},e.createElement("img",{className:j(_X.placeholderImg),src:n}),e.createElement("span",{className:j(_X.placeholder)},i),o&&e.createElement(ul,{onClick:r,type:"primary",size:"large",className:_X.placeholderBtn},e.createElement(hl,{icon:"xinjianzhenkuang2"}),a("frameList.createFrame")))},sJ=function(t){var n=t.upime,i=W().getUpimeTrans;return e.createElement("div",{className:j("drawerContainer_pkx_K")},e.createElement("div",{className:"drawerTitle_30Z7j"},e.createElement("span",{className:"mainText_3jamk"},i("frameList.title")),e.createElement(hl,{icon:"guanbi",className:"closeIcon_1Nn94",onClick:function(){_c("cv_sidebar_closeframe"),n.closePhoneDrawer()}})),e.createElement(lJ,{upime:n}))},lJ=function(t){var n=t.upime,i=W().getUpimeTrans,r=e.useState(R([],n.framesListManager.sequentialFrames,!0)),o=r[0],a=r[1];return e.useEffect((function(){var e=n.subscribe("framesUpdated",(function(e){var t=R([],e,!0);a(t)}));return function(){e()}}),[]),e.createElement("div",{className:"drawerContent_FOlsV"},0===o.length?e.createElement(aJ,{url:$o("no_frames.png"),placeholder:i("frameList.empty"),editable:!1}):o.map((function(t,i){return e.createElement(cJ,{key:t.id,upime:n,index:i+1,frame:t})})))},cJ=function(t){var n=t.index,i=t.upime,r=t.frame;return al(r,["name"]),e.createElement("div",{className:"frameItem_2h_yH",onClick:function(){_c("cv_sidebar_clickframe"),i.followManager.stopFollowCurrent(),i.displayFrame(r,!0),i.clearSelect(),i.closePhoneDrawer()}},e.createElement("span",{className:j("symbol_FQ9QY")},n),e.createElement("div",{className:j("name_3Qnxy")},r.name))},uJ=function(t){var n=t.className,i=t.upime,r=W().getUpimeTrans,o=e.useContext(xl).phoneMode,a=e.useContext(Ic).leftSideOpened;al(i,["leftSideBarType"]);var s=!0===a&&i.leftSideBarType===Et.FrameList;return e.createElement(Dl,{content:r(s?"ui.closeFrameList":"ui.openFrameList"),placement:"top"},e.createElement("div",{className:j(_X.toggleBarIcon,n)},e.createElement("div",{className:j(_X.iconWrap,s?_X.active:""),onClick:function(){o?i.showPhoneDrawer(sJ,{upime:i}):i.toggleLeftPanel("frame")}},e.createElement(hl,{className:j(_X.icon),icon:"zhenkuangmulu"}))))},dJ=function(t){var n=t.className,i=t.upime,r="pdficon",o=i.view.playingElement;return 2===(null==o?void 0:o.fileType)?r="ppticon":4===(null==o?void 0:o.fileType)?r="wordicon":3===(null==o?void 0:o.fileType)?r="excelicon":5===(null==o?void 0:o.fileType)?r="ppticon":1===(null==o?void 0:o.fileType)&&(r="pdficon"),e.createElement("div",{className:j(_X.toggleBarIcon,n)},e.createElement("div",{className:j(_X.iconWrap),onClick:function(){var e;null===(e=i.currentPresentation)||void 0===e||e.currentPlayer.replayCurrent()}},e.createElement(hl,{className:j(_X.icon),icon:r})))},pJ=function(t){var n=t.className,i=t.upime,r=i.view.playingElement,o="audioicon";return(null==r?void 0:r.elementType)===Za.VIDEO&&(o="videoicon"),e.createElement("div",{className:j(_X.toggleBarIcon,n)},e.createElement("div",{className:j(_X.iconWrap),onClick:function(){var e;null===(e=i.currentPresentation)||void 0===e||e.currentPlayer.replayCurrent()}},e.createElement(hl,{className:j(_X.icon),icon:o})))},hJ=function(t){var n=t.upime,i=t.className,r=e.useReducer((function(e){return e+1}),0)[1];al(n,["meetingPresentation","standardPresentation"]),e.useEffect((function(){return n.subscribe("standardPresentationChangeElement",r)}),[]);var o=e.useContext(Ic).extensionConfigs.frameListBar,a=n.standardPresentation,s=n.meetingPresentation,l=(null==a?void 0:a.currentPlayer)instanceof aW,c=(null==a?void 0:a.currentPlayer)instanceof sW,u=!1!==o&&!1===l&&!1===c,d=l,p=c,h=void 0!==a||void 0!==s;return e.createElement("div",{className:j(_X.sideBar,i)},u&&e.createElement(uJ,{upime:n}),d&&e.createElement(dJ,{upime:n}),p&&e.createElement(pJ,{upime:n}),h&&e.createElement(gW,{upime:n}))},fJ={block:"block_1L_0t",itemRoot:"itemRoot_2O3KW",header:"header_1D6fs",avatar:"avatar_R8h3Q",content:"content_3EiBH",title:"title_FiHJ8",text:"text_1hHQ5",rightPart:"rightPart_t0aYx",revert:"revert_14yxW",reverted:"reverted_1frm9",forbidden:"forbidden_MmvDR",reverting:"reverting_1-yu4",loading:"loading_qQ0lm",time:"time_l-dn6",subContent:"subContent_1UGIp",deleteType:"deleteType_e07Ak",defaultSpan:"defaultSpan_k-hqh",expanded:"expanded_1JvuG",expand:"expand_1e63q",showMore:"showMore_3iSAP"},mJ=function(t){var n=t.block,i=W().getUpimeTrans,r=n.items,o=e.useMemo((function(){var e=new Date(n.dateStr),t=e.getTime();return HI(t)?i("datetime.today"):function(e){var t=new Date;t.setHours(0,0,0,0);var n=t.getTime();return e>=n-864e5&&e<n}(t)?i("datetime.yesterday"):+n.dateStr.slice(0,4)===(new Date).getFullYear()?"".concat(e.getMonth()+1,"-").concat(e.getDate()):n.dateStr}),[]);return e.createElement("div",{className:fJ.block},e.createElement("span",null,o),r.map((function(t,n){var i=n>0&&t.userId===r[n-1].userId;return e.createElement(gJ,{item:t,adjacent:i,reverted:!!t.reverted,key:"".concat(t.uniqueId,"_").concat(t.elmIds.length)})})))},vJ=((nJ={})[us.ADD]="common.new",nJ[us.EDIT]="common.modify",nJ[us.DELETE]="common.delete",nJ),gJ=e.memo((function(t){var n=this,i=t.item,r=t.adjacent,o=t.reverted,a=e.useContext(xl).upime,s=a.getUserInfo(i.userId),l=a.historyManager;al(s);var c=W().getUpimeTrans,u=vJ[i.eventType],d=e.useState(!1),p=d[0],h=d[1],f=e.useRef(new Date(i.time)).current;return e.createElement("div",{className:fJ.itemRoot},!r&&e.createElement("div",{className:fJ.header},e.createElement(ml,{shape:"circle",className:fJ.avatar,url:s.avatarUrl}),e.createElement("span",null," ",s.userName)),e.createElement("div",{className:fJ.content,onClick:function(){return l.showActEles(i)}},e.createElement("div",{className:fJ.title},e.createElement("span",{className:fJ.text},"".concat(c(u)," ").concat(i.eventType===us.DELETE&&i.elmIds.length>1?c("element.count",i.elmIds.length):yp(i.elmType,c))),e.createElement("div",{className:fJ.rightPart},i.eventType===us.DELETE&&e.createElement(Dl,{placement:"top",content:c(i.unRevertable?"history.activity.restore.forbidden":"operation.redo"),rootClass:fJ.revert},e.createElement(hl,{icon:"huifujilu",className:j(o&&fJ.reverted,i.unRevertable&&fJ.forbidden,p&&fJ.reverting),onClick:function(e){return A(n,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return h(!0),e.stopPropagation(),i.unRevertable?[3,2]:[4,l.revertAct(i)];case 1:t.sent(),t.label=2;case 2:return h(!1),[2]}}))}))}})),e.createElement("span",{className:fJ.time},"".concat("0".concat(f.getHours()).slice(-2),":").concat("0".concat(f.getMinutes()).slice(-2))))),i.eventType===us.DELETE?e.createElement(bJ,{item:i}):e.createElement(yJ,{item:i})))})),yJ=e.memo((function(t){var n=t.item,i=e.useState(!1),r=i[0],o=i[1],a=e.useState(!1),s=a[0],l=a[1],c=e.useRef(null);return e.useEffect((function(){var e=c.current;e&&e.offsetWidth<e.scrollWidth&&o(!0)}),[]),1!==n.elmIds.length||n.text?e.createElement("div",{className:fJ.subContent},e.createElement("span",{className:j(fJ.text,s?fJ.expanded:fJ.defaultSpan),ref:c,"data-native-evt-handle":!0},n.text),r&&e.createElement(hl,{icon:"jiantou-xia",className:j(fJ.expand,s&&fJ.expanded),onClick:function(e){e.stopPropagation(),l(!s)}})):null})),bJ=function(t){var n=t.item,i=W().getUpimeTrans,r=e.useContext(xl).upime,o=e.useState([]),a=o[0],s=o[1],l=e.useState(!1),c=l[0],u=l[1],d=e.useRef(!1),p=function(e){return A(void 0,void 0,void 0,(function(){var t,n,o,a;return D(this,(function(s){switch(s.label){case 0:return(t=r.elementManager.getElementById(e))?[2,"".concat(yp(t.elementType,i)," ").concat(bp(t))]:[3,1];case 1:return[4,r.getAllElementInfoById(e)];case 2:return n=s.sent(),o=n.data,a=n.elementType,[2,"".concat(yp(a,i)," ").concat(Ep(a,o))]}}))}))};e.useEffect((function(){A(void 0,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,p(n.elmIds[0])];case 1:return e=t.sent(),s([{id:n.elmIds[0],text:e}]),[2]}}))}))}),[]),e.useEffect((function(){c&&!d.current&&A(void 0,void 0,void 0,(function(){var e,t,i,r,o;return D(this,(function(l){switch(l.label){case 0:e=[],t=0,i=n.elmIds.slice(1),l.label=1;case 1:return t<i.length?(r=i[t],[4,p(r)]):[3,4];case 2:o=l.sent(),e.push({id:r,text:o}),l.label=3;case 3:return t++,[3,1];case 4:return s(R([a[0]],e,!0)),d.current=!0,[2]}}))}))}),[c]);var h=c?a:a.slice(0,1);return e.createElement(e.Fragment,null,h.map((function(t,r){var o=t.id,a=t.text;return e.createElement("div",{className:j(fJ.subContent,fJ.deleteType),key:o},e.createElement("span",{className:j(fJ.text,c?fJ.expanded:fJ.defaultSpan),"data-native-evt-handle":!0},a),0===r&&n.elmIds.length>1&&e.createElement("div",{className:fJ.showMore,onClick:function(e){e.stopPropagation(),u(!c)}},e.createElement("span",null,i(c?"common.fold":"element.more")),e.createElement(hl,{icon:c?"jiantou-shang":"jiantou-xia"})))})))},EJ="tab_3HBZ1",xJ="active_35EIl",wJ="listViewRoot_B9a-s",CJ="loadingCon_ePPwx",SJ="emptyPlaceholder_1Vd5q",kJ=function(){var t=e.useContext(xl).upime.historyManager,n=t.config,i=n.activityDuration,r=n.UpgradeHintCmp,o=e.useState(!0),a=o[0],s=o[1],l=e.useState([]),c=l[0],u=l[1],d=e.useState(!1),p=d[0],h=d[1],f=e.useRef(null);al(t,["activities"]);var m=W().getUpimeTrans,v=e.useCallback((function(){var e=t.activities,n={};e.forEach((function(e){var t=new Date(e.time),i="".concat(t.getFullYear(),"-").concat("0".concat(t.getMonth()+1).slice(-2),"-").concat("0".concat(t.getDate()).slice(-2));n[i]?n[i].items.push(e):n[i]={dateStr:i,items:[e]}}));var i=Object.values(n).sort((function(e,t){return t.dateStr.localeCompare(e.dateStr)}));u(i)}),[]);return e.useEffect((function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,t.initActivity()];case 1:return e.sent(),[4,t.fetchMoreRecord()];case 2:return e.sent(),v(),s(!1),[2]}}))})),function(){t.resetActivity()}}),[]),e.useEffect((function(){t.activities.length&&v()}),[t.activities]),e.useEffect((function(){var e=null;if(p){var t=f.current;e=setTimeout((function(){t.scrollIntoView(!1),e=null}))}return function(){e&&clearTimeout(e)}}),[p]),i?e.createElement("div",{className:j(wJ,"scrollable_3EHWl"),onScroll:function(){return A(void 0,void 0,void 0,(function(){var e,n,i;return D(this,(function(r){switch(r.label){case 0:return t.hasFetchedAllAct||t.fetchingActivities||!t.activities.length?[2]:(e=f.current,(n=null===(i=e.firstChild)||void 0===i?void 0:i.clientHeight)&&n-(e.scrollTop+e.clientHeight)<5?(h(!0),[4,t.fetchMoreRecord()]):[3,2]);case 1:r.sent(),h(!1),r.label=2;case 2:return[2]}}))}))},ref:f},a?e.createElement("div",{className:CJ},e.createElement(hl,{icon:"jiazai",className:Ml.loadingIcon})):c.length?e.createElement("div",{className:fJ.list,style:{justifyContent:c.length?"unset":"center"}},c.map((function(t){return e.createElement(mJ,{block:t,key:t.dateStr})}))):e.createElement("div",{className:SJ},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,m("history.activity.empty.list"))),p&&e.createElement("div",{className:fJ.fetchingMore},e.createElement(hl,{icon:"jiazai",className:Ml.loadingIcon}))):e.createElement(r,{isActivity:!0})},_J="iconBtn_1thQq",TJ=function(){var t=e.useContext(xl).upime.historyManager,n=t.config,i=n.versionDuration,r=n.UpgradeHintCmp,o=e.useState(),a=o[0],s=o[1],l=yh(!0),c=l.hide,u=l.setHide,d=l.skipRef;al(t,["versions"]);var p=e.useState(!0),h=p[0],f=p[1],m=W().getUpimeTrans;if(e.useEffect((function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,t.initVersion()];case 1:return e.sent(),f(!1),[2]}}))})),function(){t.resetVersion()}}),[]),e.useEffect((function(){c&&s(void 0)}),[c]),!i)return e.createElement(r,{isActivity:!1});var v=function(e,t){"click"===e&&(s(t),u(!t))};return e.createElement("div",{className:wJ},h?e.createElement("div",{className:CJ},e.createElement(hl,{icon:"jiazai",className:Ml.loadingIcon})):t.versions.length?e.createElement(e.Fragment,null,e.createElement(ul,{type:"primary",className:"addNew_1CTmg",onClick:function(){return t.addNewVersion()}},m("version.new")),e.createElement("div",{className:"viewport_YOyoU",ref:d},t.versions.map((function(t){return e.createElement(IJ,{item:t,key:"".concat(t.id,"_").concat(t.description),selected:void 0!==a&&a.id===t.id,callback:v})}))),e.createElement("div",{className:"durationHint_2F5Ss"},m("version.duration.hint",i))):e.createElement("div",{className:SJ},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,m("version.list.empty")),e.createElement(ul,{type:"primary",className:"button_18yV5",onClick:function(){return t.addNewVersion()}},m("version.new"))))},IJ=e.memo((function(t){var n=t.item,i=t.selected,r=t.callback,o=e.useContext(xl).upime,a=o.historyManager,s=e.useMemo((function(){return o.getUserInfo(n.userId)}),[]);al(s);var l=W().getUpimeTrans,c=e.useState(!1),u=c[0],d=c[1],p=zI(n.time),h=e.useMemo((function(){return!n.bySys||n.bySys&&n.description?n.description:jI(n.time)}),[]);return e.createElement("div",{className:j("itemRoot_3bcFP",i&&"selected_1oDvM"),onPointerEnter:function(){_e.isHoverSupported&&(i&&r("click",void 0),d(!0))},onPointerLeave:function(){return _e.isHoverSupported&&d(!1)},onClick:function(){return!_e.isHoverSupported&&r("click",n)}},e.createElement("span",null,h),e.createElement("div",{className:"row_1pMcI"},e.createElement("span",null," ",n.bySys?l("version.auto.save"):s.userName),u||i?e.createElement("div",{className:"actions_3Ru8M"},e.createElement(Dl,{placement:"top",content:l("common.edit")},e.createElement(hl,{icon:"bianji",className:_J,onClick:function(){return a.updateVersion(n,h)}})),e.createElement(Dl,{placement:"top",content:l("common.delete")},e.createElement(hl,{icon:"shanchu",className:j(_J,"deleteBtn_1nraW"),onClick:function(){return a.deleteVersion(n)}})),e.createElement(Dl,{placement:"top",content:l("version.restore.to.new")},e.createElement(hl,{icon:"chexiao",className:_J,onClick:function(){a.config.onRestoreToVersion(h,(function(){return a.restoreToVersion(n.id)}))}}))):e.createElement("span",null,p)))})),PJ=e.memo((function(){var t=W().getUpimeTrans,n=e.useState("activity"),i=n[0],r=n[1];return e.createElement("div",{className:"root_30QpJ"},e.createElement("span",{className:"title_eFqz3"},t("history.title")),e.createElement("div",{className:"tabs_19mCr"},e.createElement("div",{className:"bg_2DTxe",style:exports.E({},"version"===i&&{left:"50%"})}),e.createElement("span",{className:j(EJ,"activity"===i&&xJ),onClick:function(){return r("activity")}},t("history.op.record")),e.createElement("span",{className:j(EJ,"version"===i&&xJ),onClick:function(){return r("version")}},t("history.version"))),"activity"===i?e.createElement(kJ,null):e.createElement(TJ,null))}));!function(e){e[e.click=0]="click",e[e.delete=1]="delete",e[e.rename=2]="rename",e[e.active=3]="active",e[e.addNewFrameBelow=4]="addNewFrameBelow"}(iJ||(iJ={}));var NJ,MJ,AJ,DJ,RJ,BJ,LJ=function(t){var n=t.upime,i=t.index,r=t.frame,o=t.callback,a=t.selected,s=t.toggleItemDraggable,l=r.name,c=e.useRef(),u=e.useState(!0),d=u[0],p=u[1],h=e.useState(l),f=h[0],m=h[1],v=e.useRef(!1),g=e.useState(void 0),y=g[0],b=g[1],E=e.useState("bottomLeft"),x=E[0],w=E[1],C=e.useRef(null),S=e.useRef(0),k=e.useState(!1),_=k[0],T=k[1],I=e.useState(!1),P=I[0],N=I[1],M=e.useState(!1),A=M[0],D=M[1],R=n.userManager,B=R.enableHideFrame,L=R.userAccessHint,O=W().getUpimeTrans;function F(e){e&&b(e)}e.useEffect((function(){S.current=i-1}),[i]),al(n,["presentation"]),al(r,["hide"]),e.useEffect((function(){var e,t;function i(e){var t;e.id===r.id&&o(r,iJ.active,{index:S.current,itemHeight:null===(t=C.current)||void 0===t?void 0:t.clientHeight})}(null===(e=n.lastFrame)||void 0===e?void 0:e.id)===r.id&&o(r,iJ.active,{index:S.current,itemHeight:null===(t=C.current)||void 0===t?void 0:t.clientHeight});var a=[n.subscribe("frameSelected",i),n.subscribe("SelectedFrameChanged",i)];return function(){a.forEach((function(e){return e()}))}}),[]),e.useEffect((function(){var e;return r.hide||(e=n.registerFrameCover(r.id,F,300)),function(){null==e||e()}}),[r.hide]);var z=e.useCallback((function(e){e.stopPropagation(),n.onFrameSelected(r),n.startPresentation(),_c("cv_sidebar_play",{in_meeting:n.curMeetingChannel?"是":"否"})}),[r]),H=e.useCallback((function(){o(r,iJ.addNewFrameBelow)}),[r,o]),U=e.useCallback((function(e){v.current&&n.updateElement(r,{name:e}),s(!0),p(!0),v.current=!1}),[]),V=e.useCallback((function(e){n.updateElement(r,{hide:e})}),[]),G=!(B||r.hide)&&L.HideFrameHint,q=r.hide||_e.isHoverSupported&&_||!_e.isHoverSupported&&a||A,K=e.createElement(Dl,{content:O(r.hide?"frame.unhide":"frame.hide"),placement:"top"},e.createElement(hl,{icon:r.hide?"yanjing-guan2":"yanjing-kai",className:j(_X.frameHideIcon,q&&_X.show,A&&_X.popOpened),onClick:function(){return!G&&V(!r.hide)}})),Y=!r.hide&&(_e.isHoverSupported&&_||!_e.isHoverSupported&&a);return e.createElement("div",{className:j(_X.cell,a&&_X.selected),onClick:function(){n.followManager.forcedFollowing?n.addToast(O("meeting.view.locked.view.hint")):(n.followManager.stopFollowCurrent(),n.displayFrame(r),n.clearSelect(),_c("cv_sidebar_clickframe"),o(r,iJ.click))},onPointerEnter:function(){return _e.isHoverSupported&&T(!0)},onPointerMove:function(){return _e.isHoverSupported&&T(!0)},onPointerLeave:function(){return _e.isHoverSupported&&T(!1)},ref:C},e.createElement("div",{className:_X.snapshot},r.hide?e.createElement("div",{className:_X.frameHideCon},e.createElement(hl,{icon:"yanjing-guan2"}),e.createElement("span",null,O("frame.hided"))):e.createElement(e.Fragment,null,e.createElement("img",{src:y}),void 0===y&&e.createElement("div",{className:j(_X.loading)},e.createElement("svg",{width:32,height:32,viewBox:"0 0 32 32"},e.createElement("path",{d:"M 16 1 A 15 15 0 1 1 1 16",stroke:"rgba(46, 115, 229)",strokeWidth:"2",fill:"transparent"})))),!n.standardPresentation&&!n.meetingMode&&(!_e.isHoverSupported&&a||_e.isHoverSupported&&_)&&e.createElement(e.Fragment,null,e.createElement("div",{className:j(_X.itemIconBtn,_X.presentationIconBtn,!n.editable&&_X.readonly),onClickCapture:z},e.createElement(hl,{icon:"bofangqi"})),n.editable&&e.createElement("div",{className:j(_X.itemIconBtn,_X.addNewBelowIconBtn),onClick:function(e){e.stopPropagation(),H()}},e.createElement(hl,{icon:"plus"})))),e.createElement("div",{className:j(_X.leftContainer)},e.createElement("div",{className:j(_X.cellTitle),onDoubleClick:function(){!r.hide&&n.editable&&(s(!1),p(!1),v.current=!0)}},e.createElement("span",{className:j(_X.symbol,r.hide&&_X.readonly)},i,"."),d&&e.createElement("div",{className:j(_X.name,r.hide&&_X.readonly)},l),!d&&e.createElement(e.Fragment,null,e.createElement("input",{className:j(_X.name),type:"text",autoFocus:!0,value:d?l:f,onChange:function(e){m(e.target.value),v.current=!0},onBlur:function(){return U(f)},onKeyDown:function(e){"Enter"!==e.key&&13!==e.keyCode||(e.preventDefault(),U(f))}}),e.createElement("div",{className:_X.inputBorder}))),n.editable&&e.createElement("div",{className:_X.frameActions},G?e.createElement(Nh,{Content:L.HideFrameHint,noPortal:!1,className:_X.offset,offset:{x:150,y:0},autoAdjustOverflow:!1,onStatusChange:function(e){D(!e)}},K):K,Y&&e.createElement(Dh,{onClick:function(e){e.stopPropagation();var t=window.innerHeight,n=c.current.getBoundingClientRect().bottom+16;w(n+130>=t?"topLeft":"bottomLeft")},placement:x,renderData:{render:OJ,data:{frame:r,callback:function(e,t){e===iJ.rename?(m(t.name),p(!1),N(!1),T(!1)):e===iJ.delete?(n.deleteElement(t),o(t,iJ.delete)):e===iJ.addNewFrameBelow&&(N(!1),T(!1),o(t,iJ.addNewFrameBelow))}}},popToggleCB:function(e){return N(e)}},e.createElement("div",{className:j(_X.more_box,(_||P||!_e.isHoverSupported&&a)&&_X.selected,P&&_X.popOpened),ref:c},e.createElement(hl,{icon:"gengduo"}))))))},OJ=function(t){var n=t.frame,i=t.callback,r=t.close,o=W().getUpimeTrans;return e.createElement("div",{className:j(_X.handle,_X.frameCellHandle),onClick:function(e){r(),e.stopPropagation()}},e.createElement("span",{onClick:function(){return i(iJ.rename,n)}},o("frameList.rename")),e.createElement("span",{onClick:function(){return i(iJ.addNewFrameBelow,n)}},o("frameList.addNewFrameBelow")),e.createElement("span",{onClick:function(){return i(iJ.delete,n)}},o("common.delete")))},FJ=function(t){var n=t.upime,i=t.selectedFrame,r=t.className,o=W().getUpimeTrans,a=e.useState(R([],n.framesListManager.sequentialFrames,!0)),s=a[0],l=a[1],c=e.useState(i),u=c[0],d=c[1],p=e.useRef({frames:R([],n.framesListManager.sequentialFrames,!0)}),h=e.useRef({isDragging:!1}),f=e.useRef(null),m=e.useState(!0),v=m[0],g=m[1],y=e.useContext(Ic).openLeftSide;e.useEffect((function(){var e=n.subscribe("framesUpdated",(function(e){if(!h.current.isDragging){var t=R([],e,!0);p.current.frames=t,l(t)}}));return function(){e()}}),[]);var b=function(e){g(e)};function E(e,t,i){var r;switch(t){case iJ.delete:var o=s.filter((function(t){return t.id!==e.id}));l(o),void 0!==u&&u.id===e.id&&d(void 0);break;case iJ.click:d(e),n.standardPresentation&&y(!1);break;case iJ.active:d(e),Number.isNaN(null==i?void 0:i.index)||Number.isNaN(null==i?void 0:i.itemHeight)||null===(r=f.current)||void 0===r||r.scrollToItem(null==i?void 0:i.index,null==i?void 0:i.itemHeight);break;case iJ.addNewFrameBelow:x(!1,e)}}var x=function(e,t){void 0===e&&(e=!1);var i=p.current.frames;if(t)n.insertNewFrame(t.type,t);else if(i.length)if(!u||e){var r=i[i.length-1];n.insertNewFrame(r.type,r)}else n.insertNewFrame(u.type,u);else n.insertNewFrame()};return e.createElement("div",{className:j(_X.frameSideBar,r)},e.createElement(zJ,{insertNewFrame:x,upime:n,frameCount:s.length}),0===s.length&&e.createElement(aJ,{url:$o("no_frames.png"),placeholder:o(n.editable?"frameList.noFrameTip":"frameList.empty"),insertNewFrame:x,editable:n.editable}),s.length>0&&e.createElement(e.Fragment,null,null===n.meetingMode&&e.createElement(yW,{upime:n}),e.createElement(Ol,{onFinishDrop:function(e,t){h.current.isDragging=!1;var i=p.current.frames;if(e!==(t=Math.min(t,i.length-1))){var r=i[e].id,o=i[t].id;e>t&&(o=0===t?null:i[t-1].id),n.framesListManager.changeSequence(r,o)}else{var a=R([],n.framesListManager.sequentialFrames,!0);p.current.frames=a,l(a)}},onStartDragging:function(){h.current.isDragging=!0},className:_X.list,activeItemClassName:_X.activeFrameEle,ref:f,itemWidth:"336px",readonly:!n.editable||!v},s.map((function(t,i){return e.createElement(Fl,{key:t.id,index:i},e.createElement(LJ,{upime:n,index:i+1,frame:t,callback:E,selected:void 0!==u&&u.id===t.id,toggleItemDraggable:b}))})))))},zJ=function(t){var n=this,i=t.insertNewFrame,r=t.upime,o=t.frameCount,a=W().getUpimeTrans;return e.createElement("div",{className:_X.title},e.createElement("div",{className:_X.titleLeftSect},e.createElement("span",null,a("frameList.title")),r.editable&&e.createElement(e.Fragment,null,e.createElement("div",{className:_X.titleDivider}),e.createElement(Dl,{placement:"bottom",content:a("frameList.newFrame")},e.createElement("div",{className:j(_X.iconWrap,_X.createFrameButton)},e.createElement(hl,{onClick:function(){return i(!0)},className:_X.titleIcon,icon:"xinjianzhenkuang2"}))))),r.editable&&!0===r.downloadConfig.enable&&e.createElement(Dl,{placement:"bottom",content:a("export.frame")},e.createElement(hl,{icon:"xiazai",className:j(_X.downloadFramesButton,_X.iconWrap),onClick:function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return 0!==o?[3,2]:[4,r.showWindow(nX)];case 1:return!0===e.sent()&&i(),[3,3];case 2:r.toggleLeftPanel(),r.showWindow(Lg,{aplusInfo:{entry:"帧框列表导出"}},void 0,void 0,void 0,(function(e){})),e.label=3;case 3:return[2]}}))}))}})))},HJ=function(t){var n=t.upime,i=t.className,r=W().getUpimeTrans,o=e.useContext(Ic),a=o.openLeftSide,s=o.leftSideOpened;al(n,["leftSideBarType","meetingMode"]),e.useEffect((function(){n.meetingMode&&"editor"!==n.meetingMode&&s&&n.leftSideBarType===Et.Graphic&&l()}),[n.meetingMode]);var l=function(){n.currentCustomTool=void 0,n.leftSideBarType===Et.FrameList&&_c("cv_sidebar_closeframe"),a(!1)};return e.createElement("div",{className:j("root_1whM-",s&&"opened_WIvR_",i)},n.leftSideBarType===Et.FrameList&&s&&e.createElement(FJ,{upime:n}),n.leftSideBarType===Et.History&&s&&e.createElement(PJ,null),n.leftSideBarType===Et.Graphic&&s&&e.createElement(WE,null),e.createElement(Dl,{placement:"bottom",content:r("frameList.close")},e.createElement("div",{className:j("iconWrap_1HSGL","closeIcon_2ZiEy"),onClick:l},e.createElement(hl,{icon:"guanbi"}))))},UJ={ui_layout:"ui_layout_1VT6S",ui_layout_wrap:"ui_layout_wrap_1FgJ-",ui_top:"ui_top_2fWeh",ui_bottom:"ui_bottom_3zyck",bottom_meeting_ui:"bottom_meeting_ui_xBdM8",row:"row_239jz",fitIOS:"fitIOS_1YfdQ",hideToBottom:"hideToBottom_19YMz",col:"col_1PDb7",followingUser:"followingUser_kgs6H",landscape:"landscape_3d7sq",left:"left_10Bj8",redoundoContainer:"redoundoContainer_2KSlw"},WJ="iconContainer_1L3bW",VJ="mr16_1etgb",jJ="active_1rP8S",GJ="phonePaneContainer_5x22o",qJ="phonePaneContainerHide_2dqnA",KJ="actionItem_3lJBp",YJ="actionItemIcon_2TqXK",XJ="fiveColumn_3PtAn",QJ="phoneIconContainer_1zM-j",ZJ="phoneActionPaneContainer_HeG-S",JJ="phoneMainActionPaneContainer_1k63j",$J="MainActionPaneIconContainer_3vDvq",e$="icon_9-2Ti",t$="phoneSubActionPaneContainer_1CzLl",n$="tick2_1Xl2E",i$="tick1_1SWtb",r$="text_3mIyu",o$="penWrapper_2Mt5Q",a$="pen_2zstZ",s$="colorBorder_3CtnT",l$="colorPaletteContainer_2qqH-",c$="colorPalette_33fX_",u$="selected_1fs-n",d$="minimapContainer_7ZoL-",p$="minimapInner_AXOv-",h$="aiCenterContainer_ggtD9",f$="aiHide_1VmmN",m$="split-line_3lSp-",v$=[Za.STICKER,Za.TEXT,Za.SHAPE,Za.GRAPHIC,Za.FRAME,Za.IMAGE,Za.CARD],g$=v$.reduce((function(e,t,n){return e[t]=n,e}),{});!function(e){e[e.Created=0]="Created",e[e.Ended=1]="Ended"}(NJ||(NJ={})),function(e){e[e.RequestFailed=-1]="RequestFailed",e[e.RequestSuccess=0]="RequestSuccess",e[e.AlreadyExist=1]="AlreadyExist",e[e.NotExist=2]="NotExist",e[e.AlreadyEnded=3]="AlreadyEnded",e[e.AlreadySubmitted=4]="AlreadySubmitted",e[e.NotEnded=5]="NotEnded",e[e.NotCreator=6]="NotCreator"}(MJ||(MJ={})),function(e){e[e.CreateVoting=1]="CreateVoting",e[e.GetVotingDetailData=2]="GetVotingDetailData",e[e.EndVoting=3]="EndVoting",e[e.SetElementSnapshot=4]="SetElementSnapshot",e[e.JoinVoting=5]="JoinVoting",e[e.ExtendDuration=10]="ExtendDuration",e[e.GetHistoryVotingList=11]="GetHistoryVotingList",e[e.DeleteVoting=12]="DeleteVoting"}(AJ||(AJ={})),function(e){e[e.KeyFrame=0]="KeyFrame",e[e.CreateVoting=1]="CreateVoting",e[e.EndVoting=3]="EndVoting",e[e.SetElementSnapshot=4]="SetElementSnapshot",e[e.VoteResultForUsersInBoard=9]="VoteResultForUsersInBoard",e[e.ExtendDuration=10]="ExtendDuration"}(DJ||(DJ={})),function(e){e[e.LeaveVoting=6]="LeaveVoting",e[e.SubmitVoteResult=7]="SubmitVoteResult"}(RJ||(RJ={})),function(e){e[e.VoteResultForUsersInVoting=7]="VoteResultForUsersInVoting",e[e.VoteResultForUserOtherLink=8]="VoteResultForUserOtherLink"}(BJ||(BJ={}));var y$=function(e){function t(t,n){var i=e.call(this,t)||this;return i.code=n,i}return P(t,e),t}(Error),b$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){switch(e[0]){case DJ.KeyFrame:return{type:e[0],votingDetailDatas:e[1]};case DJ.CreateVoting:return{type:e[0],votingDetailData:e[1]};case DJ.EndVoting:return{type:e[0],votingId:e[1]};case DJ.SetElementSnapshot:return{type:e[0],votingId:e[1],elementId:e[2],snapshot:e[3]};case DJ.ExtendDuration:return{type:e[0],votingId:e[1],duration:e[2]};case DJ.VoteResultForUsersInBoard:return{type:e[0],votingId:e[1],numberOfVoted:e[2]}}},t.prototype.createVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(AJ.CreateVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new y$("create voting failed: ".concat(t[0]),t[0]);return[2,t[1]]}}))}))},t.prototype.endVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(AJ.EndVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("end voting failed: ".concat(t[0]));return[2]}}))}))},t.prototype.deleteVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(AJ.DeleteVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("delete voting failed: ".concat(t[0]));return[2]}}))}))},t.prototype.extendDuration=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return[4,this.sendRCmd(AJ.ExtendDuration,e,t)];case 1:if((n=i.sent())[0]!==MJ.RequestSuccess)throw new Error("extend duration failed: ".concat(n[0]));return[2]}}))}))},t.prototype.getVotingDetailData=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(AJ.GetVotingDetailData,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("get voting detail data failed: ".concat(t[0]));return[2,t[1]]}}))}))},t.prototype.getHistoryVotingList=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRCmd(AJ.GetHistoryVotingList)];case 1:return(e=t.sent())[0]!==MJ.RequestSuccess?[2,[]]:[2,e[1]]}}))}))},t.prototype.joinVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(AJ.JoinVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("join voting failed: ".concat(t[0]));return[2,t[1]]}}))}))},t.prototype.setElementSnapshot=function(e,t,n){return A(this,void 0,void 0,(function(){return D(this,(function(i){return this.sendSCmd(AJ.SetElementSnapshot,e,t,n),[2]}))}))},t.prototype.destroy=function(){this.close()},t}(Sp),E$=[{label:function(){return O("voting.create.duration.option.minutes",5)},labelForAplus:"5分钟",value:3e5},{label:function(){return O("voting.create.duration.option.minutes",10)},labelForAplus:"10分钟",value:6e5},{label:function(){return O("voting.create.duration.option.minutes",30)},labelForAplus:"30分钟",value:18e5},{label:function(){return O("voting.create.duration.option.hours",1)},labelForAplus:"1小时",value:36e5},{label:function(){return O("voting.create.duration.option.hours",6)},labelForAplus:"6小时",value:216e5},{label:function(){return O("voting.create.duration.option.unlimited")},labelForAplus:"不限时",value:null}],x$=new Map([[Za.STICKER,{type:Za.STICKER,name:function(){return O("voting.element.sticker")},nameForAplus:"便签",icon:"bianqian"}],[Za.TEXT,{type:Za.TEXT,name:function(){return O("voting.element.text")},nameForAplus:"文本",icon:"wenben"}],[Za.SHAPE,{type:Za.SHAPE,name:function(){return O("voting.element.shape")},nameForAplus:"图形",icon:"xingzhuang"}],[Za.FRAME,{type:Za.FRAME,name:function(){return O("voting.element.frame")},nameForAplus:"帧框",icon:"huaban"}],[Za.IMAGE,{type:Za.IMAGE,name:function(){return O("voting.element.image")},nameForAplus:"图片",icon:"tupian"}],[Za.CARD,{type:Za.CARD,name:function(){return O("voting.element.card")},nameForAplus:"卡片",icon:"kapian"}]]),w$="content_1aRpU",C$="dot_8DG3X",S$=function(t){var n=W().getUpimeTrans;return e.createElement(xc,{icon:"qingchu",iconStyles:{color:"#FE5250"},title:n("voting.delete.confirm.title"),bodyContent:null,cancelText:n("voting.delete.confirm.cancel"),confirmText:n("voting.delete.confirm.confirm"),confirmStyles:{backgroundColor:"#FE5250"},onCancel:function(){t.success(!1)},onConfirm:function(){t.success(!0)}})};function k$(e,t){return e.then((function(e){return[null,e]})).catch((function(e){return t?[Object.assign({},e,t),void 0]:[e,void 0]}))}var _$=function(t){var n=t.activeId,i=t.onActive,r=t.onDelete,o=t.onViewDetail,a=t.votingStaticInfo,s=W().getUpimeTrans,l=Sl("votingPlugin"),c=e.useRef(!1),u=_e.isTouchSupported,d=e.useState(u),p=d[0],h=d[1],f=yh(!0),m=f.hide,v=f.toggleHide,g=f.onChange,y=f.skipRef,b=n===a.id,E=rm();e.useEffect((function(){var e=g((function(e,t){if(!1===e&&!0===t){if(u)return;!1===c.current&&h(!1),i(null)}else!0===e&&!1===t&&i(a.id)}));return function(){e()}}),[]);var x=new Date(a.startTime),w=x.getFullYear(),C=x.getMonth(),S=x.getDate(),k=x.getDay(),_=x.getHours(),T=x.getMinutes(),I=e.useMemo((function(){return l.upime.getUserInfo(a.creator)}),[]);al(I,["userName","avatarUrl"]);var P=l.upime.localUserInfo;return e.createElement("div",{className:j("container_gBZ0Q",!0===_e.isHoverSupported&&(p||b)&&"hovering_Bwv7S"),onPointerMove:function(){u||(null===n&&h(!0),c.current=!0)},onPointerLeave:function(){u||(null===n&&h(!1),c.current=!1)}},e.createElement("div",{className:"leftContainer_1qNKF"},e.createElement("div",{className:"votingStartTime_R2IoK"},e.createElement("span",{className:"votingStartDate_3hsu9"},w!==(new Date).getFullYear()&&s("datetime.year",w),s(WI[C]),s("datetime.day",S)),e.createElement("span",{className:"votingStartDay_3gWng"},s(UI[k])),e.createElement("span",{className:"votingStartHour_1nIeo"},"".concat(Ch(_),":").concat(Ch(T)))),e.createElement("div",{className:"votingTitle_15Br3"},a.name),e.createElement("div",{className:"votingCreator_37Ccu"},e.createElement("span",{className:"creatorTip_1v2oO"},"".concat(s("meeting.creator"),": ")),e.createElement(ml,{className:"creatorAvatar_t0KA7",url:I.avatarUrl,shape:"circle"}),e.createElement("span",{className:"creatorUsername_20m9x"},I.userName))),e.createElement("div",{className:"rightContainer_xNS6K"},!1===p&&e.createElement(hl,{icon:"jiantou-you",className:"arrowBtn_E4RK8"}),!0===p&&e.createElement("div",{className:j("operationsWrap_3n0QL",P.loginName!==a.creator&&"noMoreBtn_2zo1_")},e.createElement("div",{className:j("viewDetailBtn_1IBXp"),onClick:function(){o(a.id)}},s("common.check.detail")),P.loginName===a.creator&&e.createElement("div",{className:"moreBtnWrap_3X96I",ref:y},e.createElement("div",{className:j("moreBtn_1_ed_",!1===m&&"moreBtnActive_2IJWH"),onClick:function(){v()}},e.createElement(hl,{icon:"shaixuan-shang",className:"moreIcon_1Goc5"})),!1===m&&e.createElement(xh,{align:"right",selfAdjust:!0,extraStyle:{top:"calc(100% + 4px)"}},e.createElement("div",{className:"submenuWrap_R2yKV"},e.createElement("div",{className:j("submenuRow_2F8_B","deleteBtn_15wlp"),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return E.isLocking?[2]:(E.start(),[4,l.upime.showWindow(S$)]);case 1:return!1===e.sent()?(E.stop(),[2]):[4,k$(l.deleteVoting(a.id))];case 2:return e.sent()[0],r(a.id),l.upime.addToast(s("common.delete.success")),_c("cv_delete_voting"),E.stop(),[2]}}))}))}},s("common.delete"))))))))},T$=function(t){var n=t.onViewDetail,i=t.votingList,r=e.useState(null),o=r[0],a=r[1],s=function(e){a(e)},l=function(e){o===e&&a(null)};return e.createElement("div",{className:"votingsWrap_1ER-G"},i.map((function(t){return e.createElement(_$,{key:t.id,votingStaticInfo:t,activeId:o,onActive:s,onDelete:l,onViewDetail:n})})))},I$="rowContainer_107Ds",P$="submenuRow_33dHP",N$="statusTag_3dIUX",M$="count_2OfvW",A$="tip_3jiYX",D$="leftDuration_1z6Oo",R$="operationBtn_3bgZj",B$=function(t){var n,i,r=Sl("votingPlugin"),o=W().getUpimeTrans,a="".concat(o("voting.end.confirm.content",null!==(i=null===(n=r.currentVotingDetailData)||void 0===n?void 0:n.numberOfVoted)&&void 0!==i?i:0));return e.createElement(xc,{icon:"jingshi",iconStyles:{color:"#FFA519"},title:o("voting.end.confirm.title"),bodyContent:a,cancelText:o("voting.end.cancel"),confirmText:o("voting.end.confirm"),onCancel:function(){t.success(!1)},onConfirm:function(){t.success(!0)}})},L$=function(t){var n=t.creatorUserInfo,i=t.localUserInfo,r=t.votingDetailData,o=t.lineLimit,a=t.useHoverTip,s=t.style,l=W().getUpimeTrans;al(n,["userName"]);var c=r.creator,u=i.loginName===c?l("voting.title.self",r.name):l("voting.title.others",n.userName,r.name),d=e.createElement("div",{className:"container_3SS-S",style:exports.E({WebkitLineClamp:o,maxHeight:22*o},s)},u);return a?e.createElement(Dl,{placement:"bottom",content:u,large:!0,extraDistance:-8},d):d},O$=function(t){var n=t.stytle,i=t.onViewDetail,r=Sl("votingPlugin"),o=W().getUpimeTrans,a=r.currentVotingDetailData;al(r,["currentVotingDetailData"]);var s=e.useRef(null),l=yh(!0),c=l.hide,u=l.setHide,d=l.toggleHide,p=l.skipRef,h=e.useState("00 : 00 : 00"),f=h[0],m=h[1];e.useEffect((function(){var e=setInterval((function(){if(null!==a)if(null!==a.duration){var t=(a.duration-(Date.now()-a.startTime))/1e3;if(0===(t=Math.max(t,0)))return clearInterval(e),void m("00 : 00 : 00");var n=Math.min(Math.floor(t/3600),99),i=Math.floor(t%3600/60),r=Math.floor(t%60);m("".concat(Ch(n)," : ").concat(Ch(i)," : ").concat(Ch(r)))}else clearInterval(e)}),200);return function(){clearInterval(e)}}),[a]);var v=function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return null===a?[2]:[4,k$(r.extendDuration(a.id,e))];case 1:return t.sent()[0],[2]}}))}))},g=rm(),y=rm();if(null===a)return null;var b=r.upime.localUserInfo,E=r.upime.getUserInfo(a.creator),x=_t.reduce(a.mine,(function(e,t){return e+t}),0);return e.createElement("div",{className:"rootContainer_2GBVJ",style:n},e.createElement("div",{className:"firstRowGroup_dd9Ws"},e.createElement("div",{className:j(I$,"firstRow_8_jBm")},e.createElement("div",{className:"titleContainer_XX4fA",ref:s},e.createElement(L$,{creatorUserInfo:E,localUserInfo:b,votingDetailData:a,lineLimit:2,useHoverTip:!0})),e.createElement("div",{className:"menuButtonWrap_2RRyc",ref:p},e.createElement("div",{className:j("menuButton_-D7Go",_e.isHoverSupported&&!1===c&&"active_243Kh"),onClick:function(){d()}},e.createElement(hl,{icon:"fenxiang",className:"menuIcon_2hng0"})),!1===c&&e.createElement(xh,{align:"right",selfAdjust:!0,extraStyle:{top:"calc(100% + 4px)"}},e.createElement("div",{className:"submenuWrap_18kWo"},e.createElement("div",{className:j(P$),onClick:function(){if(u(!0),null!==a){var e=r.upime.getUserInfo(a.creator);r.getInviteVotingUrl(a.id,e.userName,a.name)}}},o("voting.invitation.copy")),e.createElement("div",{className:j(P$),onClick:function(){u(!0),null!==a&&r.showVotingQrCode(a.id)}},o("voting.qrcode.generate")))))),e.createElement("div",{className:j(I$,"secondRow_2Y9jS")},a.status===NJ.Created&&e.createElement("div",{className:j(N$,"votingStatus_3o_uh")},o("voting.ongoing")),e.createElement("div",{className:j(N$)},!0===a.anonymous?o("voting.anonymous"):o("voting.realname")),e.createElement("div",{className:j(N$)},o("voting.voted.users",a.numberOfVoted)))),e.createElement("div",{className:j(I$,"thirdRow_3skSI")},null===a.mine&&e.createElement("div",{className:"leftTicketsWrap_2kLF6"},e.createElement("div",{className:M$},a.tickets),e.createElement("div",{className:A$},o("voting.votes.total"))),null!==a.mine&&e.createElement("div",{className:"votedTicketsWrap_1FwLS"},e.createElement("div",{className:M$},"".concat(x,"/").concat(a.tickets)),e.createElement("div",{className:A$},o("voting.votes.voted"))),e.createElement("div",{className:"divider_1Sq_W"}),e.createElement("div",{className:"leftDurationWrap_3M9wu"},null!==a.duration&&e.createElement(e.Fragment,null,e.createElement("div",{className:D$},f),null!==a.duration&&e.createElement("div",{className:"leftDurationTipWrap_vM2W_"},e.createElement("div",{className:"leftDurationTip_2BKfe"},o("voting.duration.left")),b.loginName===a.creator&&a.status===NJ.Created&&e.createElement("div",{className:"durationOperationWrap_2fplA"},e.createElement("div",{className:R$,onClick:function(){v(6e4)}},"+1m"),e.createElement("div",{className:R$,onClick:function(){v(3e5)}},"+5m")))),null===a.duration&&e.createElement("div",{className:D$},o("voting.create.duration.option.unlimited")))),e.createElement("div",{className:j(I$,"fourthRow_3swrF")},a.status===NJ.Created&&(a.creator===b.loginName||!0===r.config.canEndVoting)&&e.createElement(ul,{className:"endVotingBtn_exS6u",type:"secondary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===a||g.isLocking?[2]:(g.start(),[4,r.upime.showWindow(B$)]);case 1:return!1===e.sent()?(g.stop(),[2]):[4,k$(r.endVoting(a.id))];case 2:return e.sent()[0],g.stop(),[2]}}))}))}},o("voting.end")),a.status===NJ.Created&&null===a.mine&&e.createElement(ul,{className:"joinVotingBtn_38_41",type:"primary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===a||y.isLocking?[2]:(y.start(),r.hideNewVotingNotification(),[4,k$(r.startVoting(a.id))]);case 1:return e.sent()[0],y.stop(),[2]}}))}))}},o("voting.joinnow")),(a.status===NJ.Ended||null!==a.mine)&&e.createElement(ul,{className:"viewResultBtn_344PV",type:"primary",onClick:function(){null!==a&&(r.hideVotingEndedNotification(),i(a.id))}},o("voting.result.view"))))},F$=function(t){var n=W().getUpimeTrans;return e.createElement("div",{className:"container_3B7cH"},e.createElement("div",{className:"leftPart_3NhQd"},e.createElement("span",{className:"title_1hDQa"},t.title),e.createElement(Dl,{placement:"bottomLeft",rootClass:"tipContainer_1J4tt",useClick:_e.isTouchSupported,renderData:{data:{},fun:function(){return e.createElement("div",{className:"hoverTipContent_3FJyU"},n("voting.instructions.hovertip.1"),e.createElement("br",null),n("voting.instructions.hovertip.2"))}},extraDistance:-2},e.createElement(hl,{icon:"xinxi",className:"tipIcon_2ycF8"}))),e.createElement(hl,{icon:"guanbi",onClick:t.onClose,className:"closeButton_pNpOp"}))},z$=function(t){var n=t.onClose,i=t.onViewDetail,r=W().getUpimeTrans,o=Sl("votingPlugin"),a=o.currentVotingDetailData,s=o.historyVotingList;return al(o,["currentVotingDetailData","historyVotingList"]),e.useEffect((function(){o.getHistoryVotingList().catch((function(){}))}),[]),e.createElement("div",{className:"container_2phT-"},e.createElement(F$,{title:r("voting.name"),onClose:n}),e.createElement("div",{className:"bodyWrap_12-JH"},e.createElement("div",{className:"contentWrap_1EB91"},null!==a&&e.createElement(O$,{onViewDetail:i,stytle:{margin:"12px 0 24px 0"}}),!0===o.config.canCreateVoting&&null===a&&e.createElement(e.Fragment,null,e.createElement("div",{className:"createVotingTip_3uk89"},e.createElement("div",{className:"firstRow_2pqCT"},e.createElement(hl,{className:"icon_1nEoC",icon:"toupiao"}),e.createElement("span",{className:w$},r("voting.instructions.title"))),e.createElement("div",{className:"secondRow__53b8"},e.createElement(hl,{icon:"shuomingdian",className:C$}),e.createElement("span",{className:w$},r("voting.instructions.content.1"))),e.createElement("div",{className:"thirdRow_3HitC"},e.createElement(hl,{icon:"shuomingdian",className:C$}),e.createElement("div",{className:w$},e.createElement("span",null,r("voting.instructions.content.2.1")),e.createElement("span",{className:"bold_64ukO"},r("voting.instructions.content.2.2")),e.createElement("span",null,r("voting.instructions.content.2.3"))))),e.createElement(ul,{className:"createVotingButton_8U0GS",type:"primary",onClick:function(){n(),o.startPrepareVoting()}},e.createElement(hl,{icon:"plus"}),e.createElement("span",null,r("voting.create")))),e.createElement("div",{className:"searchWrap_ZeSOb"},e.createElement("div",{className:"searchEnter_1V7Dp"},e.createElement("span",{className:"searchTip_1rq45"},r("voting.history")),!1)),e.createElement("div",{className:"votingListWrap_kL8Mf"},s.length>0&&e.createElement(T$,{votingList:s,onViewDetail:i}),0===s.length&&e.createElement("div",{className:"emptyPlaceholder_1ObiF"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,r("voting.history.empty.tip")))))))},H$={container:"container_BsCc7",header:"header_21m1B",titleWrap:"titleWrap_62Mws",backBtn:"backBtn_1G93V",title:"title_1Zqr6",closeBtn:"closeBtn_3e_Fc",votingInfoWrap:"votingInfoWrap_3dlJz",firstRow:"firstRow_1zi6L",votingNameWrap:"votingNameWrap_yoUwU",votingName:"votingName_3etGt",menuButtonWrap:"menuButtonWrap_1oJSs",menuButton:"menuButton_cWzbx",active:"active_18mHs",menuIcon:"menuIcon_1cB33",submenuWrap:"submenuWrap_a7Wa6",submenuRow:"submenuRow_2dCn_",deleteBtn:"deleteBtn_3wXMT",secondRow:"secondRow_1x-xG",thirdRow:"thirdRow_3takv",statusTag:"statusTag_3leFV",votingStatus:"votingStatus_fRriY",moreBtn:"moreBtn_1xp9N",body:"body_1EmX6",resultList:"resultList_1PfiC",footer:"footer_njkG0",exportToExcelBtn:"exportToExcelBtn_uNJ8f",exportToBoardBtn:"exportToBoardBtn_3uw5-"},U$="avatar_3zoqx",W$=function(t){var n=t.userId,i=t.upime.getUserInfo(n);return al(i,["userName","avatarUrl"]),e.createElement(Dl,{content:i.userName,extraDistance:-4,rootClass:"avatarContainer_zftaP"},e.createElement(ml,{className:U$,url:i.avatarUrl,shape:"circle"}))},V$=function(t){var n=t.userId,i=t.upime.getUserInfo(n);return al(i,["userName","avatarUrl"]),e.createElement("div",{className:"userInfoWrap_2mp-Y"},e.createElement(ml,{className:U$,url:i.avatarUrl,shape:"circle"}),e.createElement("span",{className:"userName_1_bol"},i.userName))},j$=function(t){var n=t.elementId,i=t.votingDetailData,r=t.upime,o=Sl("votingPlugin"),a=W().getUpimeTrans,s=$o("no-history-vote.svg"),l=e.useRef(null),c=e.useState(!1),u=c[0],d=c[1],p=e.useRef(null),h=e.useState(null),f=h[0],m=h[1],v=e.useState(null),g=v[0],y=v[1],b=e.useState(""),E=b[0],x=b[1],w=i.elements.find((function(e){return e.elementId===n}));return e.useEffect((function(){var e,t=!1;return null!==l.current&&(e=new IntersectionObserver((function(e){var n=e[0];!1===t&&d(n.isIntersecting)}),{threshold:0}),e.observe(l.current)),function(){t=!0,null!==l.current&&void 0!==e&&e.unobserve(l.current)}}),[l.current]),e.useEffect((function(){void 0!==w&&null!==w.snapshot&&(null!==w.snapshot.svgFileId&&null===f&&r.getFileInfo(w.snapshot.svgFileId).then((function(e){p.current=e,m(e.url)})).catch((function(){})),null!==w.snapshot.pngFileId&&null===g&&r.getFileInfo(w.snapshot.pngFileId).then((function(e){y(e.url)})).catch((function(){})))}),[u]),e.useEffect((function(){!0===u&&void 0!==w&&(null===w.snapshot||null===w.snapshot.svgFileId&&null===w.snapshot.pngFileId)&&$f(w.elementId,o.upime,{png:!0,contentType:Gf.Base64}).then((function(e){null!==e.png&&x(e.png)})).catch((function(){}))}),[u]),e.createElement("div",{ref:l,className:"elementSnapshotCointainer_152oD"},!0===u&&e.createElement(e.Fragment,null,e.createElement("img",{className:"elementSnapshot_2dGLT",src:g||E||s,alt:""}),null!==f&&e.createElement("span",{className:"zoomInBtn_2xO28",onClick:function(e){e.stopPropagation();var t=p.current;null!==t&&void 0!==w&&null!==w.snapshot&&Q(t.url,"text").then((function(e){var n,i,o,s,l;null===(n=r.previewExternalFile)||void 0===n||n.call(r,{ext:"svgText",fileId:t.id,name:a("common.preview"),size:t.fileSize,width:null!==(o=null===(i=w.snapshot)||void 0===i?void 0:i.width)&&void 0!==o?o:1024,height:null!==(l=null===(s=w.snapshot)||void 0===s?void 0:s.height)&&void 0!==l?l:1024},e)})).catch((function(){var e,n,i,o,s;null===(e=r.previewExternalFile)||void 0===e||e.call(r,{ext:"svg",fileId:t.id,name:a("common.preview"),size:t.fileSize,width:null!==(i=null===(n=w.snapshot)||void 0===n?void 0:n.width)&&void 0!==i?i:1024,height:null!==(s=null===(o=w.snapshot)||void 0===o?void 0:o.height)&&void 0!==s?s:1024},t.url)}))}},e.createElement(hl,{icon:"fangda",className:"zoomInIcon_288ut"}))))},G$=function(t){var n,i,r=t.elementResult,o=t.activeElementId,a=t.votingDetailData,s=t.rank,l=t.submittedVotesCount,c=t.votingPlugin,u=t.onClick,d=r.elementId,p=r.total,h=r.detail,f=yh(!0),m=f.hide,v=f.toggleHide,g=f.skipRef,y=W().getUpimeTrans;return e.createElement("div",{className:j("resultItem_AGw2i",o===d&&"selected_C3i0S"),onClick:function(){u(d)}},void 0!==(null===(n=a.mine)||void 0===n?void 0:n[d])&&e.createElement("span",{className:"myVoteTip_3A1Kw"},y("voting.tickets.self.voted",null===(i=a.mine)||void 0===i?void 0:i[d])),e.createElement("div",{className:j("rank_3vChI",1===s&&"no1_oyneR",2===s&&"no2_j0fSL",3===s&&"no3_3R_ON")},"No.".concat(s)),e.createElement("div",{className:"elementWrap_2yUXJ"},e.createElement(j$,{elementId:d,votingDetailData:a,upime:c.upime})),e.createElement("div",{className:"resultDetail_28sy2"},e.createElement("div",{className:"voteCount_34olO"},"".concat(y("voting.tickets.users.voted",p)," (").concat(0===l?0:_t.round(p/l*100,1),"%)")),e.createElement("div",{className:"voters_3XqZX"},!1===a.anonymous&&e.createElement(e.Fragment,null,h.slice(0,3).map((function(t){var n=t[0];return null===n?null:e.createElement(W$,{key:n,userId:n,upime:c.upime})})),h.length>3&&e.createElement("div",{className:"moreVotersContainer_K3Pcw",ref:g},e.createElement("div",{className:"moreVotersButton_1disv",onClick:function(e){e.stopPropagation(),v()}},"+".concat(h.length-3)),!1===m&&e.createElement(xh,{align:"right",selfAdjust:!0,extraStyle:{top:"calc(100% + 4px)",zIndex:2}},e.createElement("div",{className:"moreVoterList_2S6Xd"},h.map((function(t){var n=t[0];return null===n?null:e.createElement(V$,{key:n,userId:n,upime:c.upime})})))))),a.anonymous&&e.createElement("span",{className:"anonymousVotersCount_3oPjd"},y("voting.voted.users",h.length)))))},q$=e.memo((function(t){var n=t.onBack,i=t.onClose,r=t.onClosed,o=W().getUpimeTrans,a=e.useRef(null);a.current=r;var s=Sl("votingPlugin"),l=s.currentVotingDetailDataForViewResult;al(s,["currentVotingDetailDataForViewResult"]);var c=e.useState(""),u=c[0],d=c[1],p=yh(!0),h=p.hide,f=p.toggleHide,m=p.skipRef;e.useEffect((function(){var e;null!==l&&(null===(e=s.displayResultWidget)||void 0===e||e.updateResults(l.results))}),[l]);var v=rm();if(e.useEffect((function(){return function(){var e;null===(e=a.current)||void 0===e||e.call(a)}}),[]),e.useEffect((function(){var e=[s.eventManager.subscribe("getVotingDetailDataFailed",(function(){n()}))];return function(){e.forEach((function(e){return e()}))}}),[]),null===l)return null;var g=new Date(l.startTime),y=g.getFullYear(),b=g.getMonth(),E=g.getDate(),x=g.getDay(),w=g.getHours(),C=g.getMinutes(),S=l.results.reduce((function(e,t){return e+t.total}),0),k=R([],l.results,!0);l.elements.forEach((function(e){void 0===k.find((function(t){return t.elementId===e.elementId}))&&k.push({elementId:e.elementId,total:0,detail:[]})}));var _=Array.from(k.reduce((function(e,t){return e.add(t.total)}),new Set)).sort((function(e,t){return t-e})),T=function(e){var t=s.upime,n=t.elementManager.getElementById(e);d(e),void 0!==n&&!0!==n.deleted&&t.showElement(n,{top:200,right:200,bottom:200,left:200,duration:500})},I=s.upime.localUserInfo;return e.createElement("div",{className:H$.container},e.createElement("div",{className:H$.header,style:{backgroundImage:"url(".concat($o("meeting_his_bg.png"),")"),backgroundPosition:"top center",backgroundSize:"cover"}},e.createElement("div",{className:H$.titleWrap},e.createElement(hl,{className:H$.backBtn,icon:"fanhui",onClick:function(){n()}}),e.createElement("span",{className:H$.title},o("voting.results")),e.createElement(hl,{className:H$.closeBtn,icon:"guanbi",onClick:function(){i()}})),e.createElement("div",{className:H$.votingInfoWrap},e.createElement("div",{className:H$.firstRow},e.createElement(Dl,{placement:"top",content:l.name,large:!0,rootClass:H$.votingNameWrap},e.createElement("div",{className:H$.votingName},l.name)),l.status===NJ.Ended&&l.creator===I.loginName&&e.createElement("div",{className:H$.menuButtonWrap,ref:m},e.createElement("div",{className:j(H$.menuButton,!1===h&&H$.active),onClick:function(){f()}},e.createElement(hl,{icon:"gengduo",className:H$.menuIcon})),!1===h&&e.createElement(xh,{align:"right",selfAdjust:!0,extraStyle:{top:"calc(100% + 4px)",zIndex:2}},e.createElement("div",{className:H$.submenuWrap},e.createElement("div",{className:j(H$.submenuRow,H$.deleteBtn),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return v.isLocking||null===l?[2]:(v.start(),[4,s.upime.showWindow(S$)]);case 1:return!1===e.sent()?(v.stop(),[2]):[4,k$(s.deleteVoting(l.id))];case 2:return e.sent()[0],n(),v.stop(),[2]}}))}))}},o("common.delete")))))),e.createElement("div",{className:H$.secondRow},e.createElement("span",{className:H$.votingStartDate},y!==(new Date).getFullYear()&&o("datetime.year",y),o(WI[b]),o("datetime.day",E)),e.createElement("span",{className:H$.votingStartDay},o(UI[x])),e.createElement("span",{className:H$.votingStartHour},"".concat(Ch(w),":").concat(Ch(C)))),e.createElement("div",{className:H$.thirdRow},l.status===NJ.Created&&e.createElement("span",{className:j(H$.statusTag,H$.votingStatus)},o("voting.ongoing")),e.createElement("span",{className:H$.statusTag},!0===l.anonymous?o("voting.anonymous"):o("voting.realname")),e.createElement("span",{className:H$.statusTag},o("voting.voted.users",l.numberOfVoted))))),e.createElement("div",{className:H$.body},void 0!==(null==l?void 0:l.results)&&e.createElement("div",{className:H$.resultList},k.map((function(t){return e.createElement(G$,{key:t.elementId,rank:_.findIndex((function(e){return e===t.total}))+1,votingDetailData:l,elementResult:t,activeElementId:u,votingPlugin:s,submittedVotesCount:S,onClick:T})})))),l.creator===I.loginName&&l.status===NJ.Ended&&e.createElement("div",{className:H$.footer},s.upime.downloadConfig.enable&&e.createElement("div",{className:H$.exportToExcelBtn,onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,n,i,r,a,c,u,d,p,h,f,m,v,g;return D(this,(function(y){switch(y.label){case 0:_c("cv_exportvoting_e"),e=s.upime,t=[o("voting.export.title.ranking"),o("voting.export.title.content"),o("voting.export.title.tickets"),o("voting.export.title.percent"),o("voting.export.title.voters")],n=l.elements.length+1,i=[],r=function(t){var n,r,a,s,c,u,d,p;return D(this,(function(h){switch(h.label){case 0:return n=k[t-1],r=n.elementId,a=n.total,s=n.detail,void 0===(c=l.elements.find((function(e){return e.elementId===r})))?[2,"continue"]:(u="",!0!==l.anonymous?[3,1]:(u=o("voting.voted.users",a),[3,4]));case 1:return 0!==l.numberOfVoted?[3,2]:(u="-",[3,4]);case 2:return d=[],s.forEach((function(e){var t=e[0];null!==t&&d.push(t)})),[4,e.userManager.getUsers(d)];case 3:p=h.sent(),u=p.reduce((function(e,t){return e.push(t.userName),e}),[]).join("、"),h.label=4;case 4:return i.push({rank:"No.".concat(_.findIndex((function(e){return e===n.total}))+1),text:null!==(v=c.text)&&void 0!==v?v:"",count:"".concat(null!==(g=n.total)&&void 0!==g?g:0),percent:"".concat(0===S?0:_t.round(a/S*100,1),"%"),votePeople:u}),[2]}}))},a=1,y.label=1;case 1:return a<n?[5,r(a)]:[3,4];case 2:y.sent(),y.label=3;case 3:return a+=1,[3,1];case 4:return c={fileName:"".concat(o("voting.export.table.name",l.name)),titles:t,results:i},[4,Promise.all([e.getFileToken(),e.getDownloadSign("exportVote")])];case 5:return u=y.sent(),d=u[0],p=u[1],h=d.host,f=d.query,[4,Q("".concat(h,"/fs/exportVote?").concat(f),"blob","application/json","POST",JSON.stringify(exports.E(exports.E({},c),p)))];case 6:return(m=y.sent()).text().then((function(e){try{JSON.parse(e)}catch(e){var t=document.createElement("a");t.href=window.URL.createObjectURL(m),t.download=c.fileName+".xlsx",t.click()}})),[2]}}))}))}},o("voting.export.to.excel")),e.createElement("div",{className:H$.exportToBoardBtn,onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,n,i,r,a,c,u,d,p,h,f,m,v,g,y,b,E,x,w,C,T,I;return D(this,(function(P){switch(P.label){case 0:if(_c("cv_exportvoting_c"),!1===(e=s.upime).editable)return e.addToast(o("voting.export.notAllow.toast")),[2];for(t=l.elements.length+1,n=Array(5*t).fill(null).map((function(e,t){var n=t/5|0,i=t%5,r=exports.E(exports.E({},AE()),{rId:"".concat(n),cId:"".concat(i)});return 0===n&&(r.bgColor=14408670),r})),i=R([85],Array(4).fill(160),!0),r=Array(t).fill(72),a=i.reduce((function(e,t){return e+t}),0),c=r.reduce((function(e,t){return e+t}),0),u=e.view,d=u.getViewbox(),p=d.left+(d.right-d.left)/2,h=d.top+(d.bottom-d.top)/2,f=Jg({left:p,right:p+a,top:h,bottom:h+c},e),m=f[1],v={position:{x:m.left,y:m.top},zIndex:e.newMaxZindex(),name:"".concat(o("voting.export.table.name",l.name)),rows:t,cols:5,cells:n,fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,size:{width:a,height:c},rotate:0,scale:1,rowHeights:r,rowWidths:i,meshColor:9540508,color:1710618,hasBg:!0,bgColor:16777215,bgOpacity:1,va:"middle",ha:"center",focusedCellsIdx:null},g=e.createOperation(),y=g.create(Za.TABLE,v),b=[o("voting.export.title.ranking"),o("voting.export.title.content"),o("voting.export.title.tickets"),o("voting.export.title.percent"),o("voting.export.title.voters")],E=[],x=function(t,n,i,r,o){return{hasBg:!1,bgColor:0,bgOpacity:1,ha:"center",va:"middle",fontSize:14,lineHeight:Ue,lineHeightRate:We,fontFamily:He,position:{x:0,y:0,rowId:"".concat(t),columnId:"".concat(n),parentId:i,parentType:Za.TABLE},size:{width:0,height:0},autoWidth:!1,zIndex:e.newMaxZindex(),richContent:{version:e.genOtVersion(0),content:[[yi(r),{color:1710618,bolder:o}]]}}},w=[],C=0;C<5;C+=1)E.push(x(0,C,y.id,b[C],!0));for(T=function(t){var n=k[t-1],i=n.elementId,r=n.total,a=n.detail,s=l.elements.find((function(e){return e.elementId===i}));if(void 0===s)return"continue";for(var c=function(i){if(0===i)E.push(x(t,i,y.id,"No.".concat(_.findIndex((function(e){return e===n.total}))+1),!1));else{var c=s.text;if(1===i)E.push(x(t,i,y.id,null!=c?c:"-",!1));else if(2===i)E.push(x(t,i,y.id,"".concat(r),!1));else if(3===i){var u=0===S?0:_t.round(r/S*100,1);E.push(x(t,i,y.id,"".concat(u,"%"),!1))}else if(4===i){var d=x(t,i,y.id,"",!1);E.push(d),!0===l.anonymous?d.richContent.content[0][0]=yi(o("voting.voted.users",r)):0===a.length?d.richContent.content[0][0]=yi("-"):w.push(new Promise((function(t){return A(void 0,void 0,void 0,(function(){var n,i,r;return D(this,(function(o){switch(o.label){case 0:return n=[],a.forEach((function(e){var t=e[0];null!==t&&n.push(t)})),[4,e.userManager.getUsers(n)];case 1:return i=o.sent(),r=i.reduce((function(e,t){return e.push(t.userName),e}),[]).join("、"),t(r),[2]}}))}))})).then((function(e){d.richContent.content[0][0]=yi(e)})))}}},u=0;u<5;u+=1)c(u)},I=1;I<t;I+=1)T(I);return[4,Promise.all(w)];case 1:return P.sent(),E.forEach((function(e){g.create(Za.GRID_TEXT,e)})),g.sync(),e.selectElement(y),e.showElement(y,{top:200,bottom:200,left:200,right:200,duration:500}),e.switchMode("select"),[2]}}))}))}},o("voting.export.to.board"))))})),K$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),Object.defineProperty(t.prototype,"onlyActive",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(IG),Y$=function(){function e(e){this.voteCtrl=e,this.renderer=X$,this.renderKey="prepare-vote-widget",this.size={width:0,height:0},this.position={x:0,y:0},this.inBoxElements=[],this.selectedSet=new Set,this.inBoxSet=new Set,this.hoveringElement=null,this.selectCircles=[];var t=e.upime;this.scene=new K$(t,"prepareVote"),t.sceneManager.addScene(this.scene);var n=t.view,i=n.x,r=n.y,o=n.width,a=.6*o,s=n.height,l=16/9,c=Math.min(a,s*l),u=c/l,d=i+.05*o+(a-c)/2,p=r+(s-u)/2;this.position={x:d,y:p},this.size={width:c,height:u},this.supportTypes=new Set([Za.FRAME,Za.TEXT,Za.SHAPE,Za.IMAGE,Za.STICKER,Za.CARD,Za.GRAPHIC]),this.doCheck(),this.startAutoCheck(),t.view.setWidgetCvsAutoRender(!0),this.unSubUserEvents=this.subscribeUserEvents()}return Object.defineProperty(e.prototype,"upime",{get:function(){return this.voteCtrl.upime},enumerable:!1,configurable:!0}),e.prototype.calcRelatedParents=function(){var e=new Set,t=[];return this.selectedSet.forEach((function(n){var i=n.position;if(i.parentType&&i.parentId&&!e.has(i.parentId))if(i.parentType===Za.DOCUMENT){var r=i.parentId,o=i.parentType,a=i.pageId;e.add(r),t.push({parentId:r,parentType:o,pageId:a})}else if(i.parentType===Za.VIDEO||i.parentType===Za.AUDIO){r=i.parentId,o=i.parentType;var s=i.mediaTime;e.add(r),t.push({parentId:r,parentType:o,mediaTime:s})}})),t},e.prototype.getBorderBox=function(){return{left:this.position.x,top:this.position.y,right:this.position.x+this.size.width,bottom:this.position.y+this.size.height}},e.prototype.checkMoveResizeRelation=function(e){var t=8/this.upime.view.scale,n=this.getBorderBox();if(Ot(e,n,t)){var i=Wt(e,n,t),r={transparent:!1,metric:-1};return i&&(r.metaData={resizeData:{direction:i,originBorder:n}}),r}return null},e.prototype.subscribeUserEvents=function(){var e=this,t=null,n={left:0,top:0,right:0,bottom:0},i=function(t){var n="";switch(t){case"ne":case"sw":n="nesw-resize";break;case"nw":case"se":n="nwse-resize"}e.upime.view.setCursor(n,e)},r=function(t){for(var n=e.selectCircles,i=e.upime.view.scale,r=n.length-1;r>=0;r--){var o=n[r],a=o.element,s=o.cPoint;if(fn(t.position,s)<14/i)return a}var l=e.upime.selectController.selectElement(t.position,{type:"hover",forceNormalCheck:!0,evt:t,canSelectUnavailable:!0}).element;return l&&(l.elementType===Za.KANBAN?l=function(t,n){for(var i=null,r=0,o=t.grids;r<o.length;r++){for(var a=0,s=o[r].cards;a<s.length;a++){var l=s[a];if(e.inBoxSet.has(l)&&Ot(n,l.getGlobalBox())){i=l;break}}if(i)break}return i}(l,t.position):e.inBoxSet.has(l)||(l=null)),l};return this.scene.onMoveToEvt=function(r){var o,a,s,l,c=r.isStart;r.isEnd;var u=r.position,d=r.startPosition;if(c){if(t="right"!==r.connectType?e.checkMoveResizeRelation(d):null,n=e.getBorderBox(),t){var p=null===(a=null===(o=t.metaData)||void 0===o?void 0:o.resizeData)||void 0===a?void 0:a.direction;i(p)}else e.upime.view.setCursor(Vd(),e);e.hoveringElement=null}if(t){var h=null===(l=null===(s=t.metaData)||void 0===s?void 0:s.resizeData)||void 0===l?void 0:l.direction;if(!h){if("right"===r.connectType)return;var f=e.position,m=r.globalPosition,v=r.preGlobalPosition,g=e.upime.view,y=(m.x-v.x)/g.scale,b=(m.y-v.y)/g.scale;return e.position={x:f.x+y,y:f.y+b},e.quickCheck(),void e.upime.view.updateWidgetCvs()}if("left"===r.connectType||"touch"===r.connectType){var E=Gt(n,d,u,h,{keepRatio:!1,minSize:20,noExtend:!0});e.size={width:E.right-E.left,height:E.bottom-E.top},e.position={x:E.left,y:E.top},e.quickCheck(),e.upime.view.updateWidgetCvs()}}else!function(t){var n=t.globalPosition,i=t.preGlobalPosition,r=e.upime.view,o=r.x-(n.x-i.x)/r.scale,a=r.y-(n.y-i.y)/r.scale;e.upime.setViewPosScale(o,a)}(r)},this.scene.onMoveEvt=function(t){var n,o;if(!t.connected){var a=e.checkMoveResizeRelation(t.position);if(a){var s=null===(o=null===(n=a.metaData)||void 0===n?void 0:n.resizeData)||void 0===o?void 0:o.direction;if(s)i(s);else{var l=r(t);e.hoveringElement=l,e.upime.view.setCursor(l?"pointer":"",e)}}else e.upime.view.setCursor(Vd(),e)}},this.scene.onClickEvt=function(t){var n,i,o=e.checkMoveResizeRelation(t.position);if(!(null===(i=null===(n=null==o?void 0:o.metaData)||void 0===n?void 0:n.resizeData)||void 0===i?void 0:i.direction)){var a=r(t);a&&(e.selectedSet.has(a)?e.selectedSet.delete(a):e.selectedSet.add(a),e.inBoxElements=e.inBoxElements.map((function(e){return e.element===a?{element:e.element,selected:!e.selected}:e})),e.upime.view.updateWidgetCvs())}},function(){e.upime.view.setCursor("",e)}},e.prototype.startAutoCheck=function(){var e=this,t=function(){e.checkTimer=window.setTimeout((function(){e.doCheck(),t()}),40)};t()},e.prototype.resetAutoCheck=function(){this.stopAutoCheck(),this.startAutoCheck()},e.prototype.stopAutoCheck=function(){this.checkTimer&&(window.clearTimeout(this.checkTimer),this.checkTimer=void 0)},e.prototype.quickCheck=function(){this.doCheck(),this.resetAutoCheck()},e.prototype.doCheck=function(){var e=this,t=e.selectedSet,n=e.supportTypes,i=e.upime,r=[],o=new Set,a=new Set,s=new Set,l=this.getBorderBox(),c=function(e){var n=t.has(e);n&&o.add(e),a.add(e),r.push({element:e,selected:n})};i.elementManager.getFrames().forEach((function(e){qt(e.getBorderBox(),l)&&c(e)}));var u=function(e){for(var t=e.children,i=0;i<t.length;i++){var r=t[i];if(r.isRefSystem)u(r);else{var o=r;if(o.hideByFrame)continue;if(o.elementType===Za.KANBAN){var a=o;Kt(l,a.getBorderBox())&&a.grids.forEach((function(e,t){e.cards.forEach((function(e){qt(e.getGlobalBox(),l)&&(s.has(e)||(c(e),s.add(e)))}))}));continue}if(o.elementType===Za.CARD){if(o.pareantKanban)continue}else if(o.elementType===Za.STICKER){if(o.hideForPrivate())continue}else if(!n.has(o.elementType))continue;var d=o.getGlobalBox();qt(Sn(d,d.rotate),l)&&c(o)}}};u(i.view.elementsRoot),this.selectedSet=o,this.inBoxSet=a,this.inBoxElements=r,i.updateWidgetCvs()},e.prototype._selectElementsByType=function(e,t){var n=this;this.inBoxElements=this.inBoxElements.map((function(i){return null!==e&&i.element.elementType!==e||t===i.selected?i:(t?n.selectedSet.add(i.element):n.selectedSet.delete(i.element),{element:i.element,selected:t})})),this.upime.view.updateWidgetCvs()},e.prototype.selectAllElements=function(){this._selectElementsByType(null,!0)},e.prototype.unSelectAllElements=function(){this._selectElementsByType(null,!1)},e.prototype.selectElementsByType=function(e){this._selectElementsByType(e,!0)},e.prototype.unSelectElementsByType=function(e){this._selectElementsByType(e,!1)},e.prototype.destroy=function(){this.stopAutoCheck(),this.unSubUserEvents(),this.upime.view.setWidgetCvsAutoRender(!1),this.scene.onRemove=void 0,this.scene.remove()},M([rl],e.prototype,"position",void 0),M([rl],e.prototype,"inBoxElements",void 0),M([il],e)}(),X$=function(e){var t=e.element,n=e.viewbox,i=js.value.addLoadingSource,r=t.inBoxElements,o=t.selectCircles,a=t.hoveringElement;o.length=0;var s=_D("gouxuan","white");s.loaded||null==i||i(s);for(var l=function(e){var t=e.element,i=e.selected,r=t.getGlobalBox();r.rotate&&(r=Sn(r,r.rotate));var l=t.elementType===Za.STICKER?.1*(r.top-r.bottom):0,c=r.right,u=r.bottom+l;o.push({element:t,cPoint:{x:c,y:u}});var d=(r.right-n.left)*n.scale,p=(r.bottom+l-n.top)*n.scale;if(t===a){var h=(r.left-n.left)*n.scale,f=(r.top-n.top)*n.scale,m=(r.right-r.left)*n.scale,v=(r.bottom-r.top)*n.scale;Na((function(e){e.lineStyle(1,6134012),e.drawRect(h,f,m,v)}))}i?(Na((function(e){e.beginFill(3044325),e.drawCircle(d,p,14)})),s.loaded&&Oa({src:s,x:d-14,y:p-14,width:28,height:28})):Na((function(e){e.beginFill(16777215),e.lineStyle(2,3044325),e.drawCircle(d,p,13)}))},c=0,u=r;c<u.length;c++)l(u[c]);KG({element:t})},Q$=function(){function e(e,t){var n=this;this.voteCtrl=e,this.config=t,this.tickets=0,this.renderKey="prepare-vote-widget",this.elements=[],this.resultMap=new Map,this.hoveringElement=null,this.visibleCtrlBtns=[],this.renderer=function(e){var t=e.viewbox,i=n.config.area;n.visibleCtrlBtns=[];var r=Ln(t,Bt(i));if(r){var o=js.value.addLoadingSource,a=_D("jia","white"),s=_D("jia","#5798F2"),l=_D("jian","white");o&&(a.loaded||o(a),s.loaded||o(s),l.loaded||o(l));for(var c=n.tickets>=n.config.tickets,u=function(e,t,n){void 0===n&&(n=!1);var i=e.x,r=e.y;Na((function(e){0!==t||n?(e.beginFill(3044325),e.lineStyle(1,16777215),e.drawCircle(i,r,14.5)):(e.beginFill(0,.25),e.drawCircle(i,r,14))})),0===t?Oa({src:n&&c?s:a,x:i-8.75,y:r-8.75,width:17.5,height:17.5}):Ra({text:t+"",fontFamily:Ae.SOURCE_HAN_SANS_CN,fontSize:16,lineHeight:20,textWidth:0},{x:i,y:r-10,ha:"center",fill:"#fff"})},d=function(e){if(!e.mounted)return"continue";var i=e.getGlobalBox();if(i.rotate&&(i=Sn(i,i.rotate)),!Kt(i,r))return"continue";var o={x:(i.right-t.left)*t.scale,y:(i.bottom-t.top)*t.scale};e.elementType===Za.STICKER&&(o.y+=.1*(i.top-i.bottom)*t.scale);var d=n.resultMap.get(e.id)||0,p=n.hoveringElement===e;if(n.visibleCtrlBtns.push({element:e,globalPosition:o,tickets:d}),p){var h=(i.left-t.left)*t.scale,f=(i.top-t.top)*t.scale,m=(i.right-i.left)*t.scale,v=(i.bottom-i.top)*t.scale;Na((function(e){e.lineStyle(1,6134012),e.drawRect(h,f,m,v)}))}p||!n.pcMode?0===d?u(o,d,p):function(e,t){var n=e.x,i=e.y;Na((function(e){e.beginFill(3044325),e.lineStyle(1,16777215),e.drawRoundedRect(n-58-.5,i-14-.5,73,29,14.5)})),Oa({src:l,x:n-54,y:i-10,width:20,height:20}),Ra({text:t+"",fontFamily:Ae.SOURCE_HAN_SANS_CN,fontSize:16,lineHeight:20,textWidth:0},{x:n-22,y:i-10,ha:"center",fill:"#fff"}),Oa({src:c?s:a,x:n-10,y:i-10,width:20,height:20})}(o,d):u(o,d)},p=0,h=n.elements;p<h.length;p++)d(h[p])}};var i=e.upime;this.scene=new K$(i),i.sceneManager.addScene(this.scene),i.view.setWidgetCvsAutoRender(!0),this.unSubUserEvents=this.subscribeUserEvents(),this.pcMode=_e.isHoverSupported,this.elements=[],t.elements.forEach((function(e){var t=e.elementId,r=i.elementManager.getElementById(t);r&&n.elements.push(r)})),this.originViewRect={x:i.view.x,y:i.view.y,width:i.view.width,height:i.view.height},this.onVoteBegin()}return Object.defineProperty(e.prototype,"upime",{get:function(){return this.voteCtrl.upime},enumerable:!1,configurable:!0}),e.prototype.subscribeUserEvents=function(){var e=this,t=!1,n=function(n){var i=n.x,r=n.y;e.upime.view.setTip(O("voting.tip.no.left.tickets"),{x:i,y:r-14},e),t=!0},i=function(){e.upime.view.clearTip(e),t=!1},r=function(t){for(var n=t.globalPosition,i=e.visibleCtrlBtns.length-1;i>=0;i--){var r=e.visibleCtrlBtns[i],o=r.element,a=r.globalPosition,s=r.tickets,l=a.x,c=a.y;if(s>0&&(e.hoveringElement===o||!e.pcMode)){if(n.y>=c-15&&n.y<c+15&&n.x>=l-59&&n.x<=l+15){var u="";return n.x<=l-29?u="minus":n.x>=l-15&&(u="plus"),{element:o,type:u,globalPosition:a}}}else if(fn(n,{x:l,y:c})<=15)return{element:o,type:0===s?"plus":"",globalPosition:a}}return null};return this.scene.onMoveToEvt=function(n){n.isStart&&(e.upime.view.setCursor(Vd(),e),e.hoveringElement=null,t&&i()),function(t){var n=t.globalPosition,i=t.preGlobalPosition,r=e.upime.view,o=r.x-(n.x-i.x)/r.scale,a=r.y-(n.y-i.y)/r.scale;e.upime.setViewPosScale(o,a)}(n)},this.scene.onMoveEvt=function(o){if(e.pcMode&&!o.connected){var a=r(o),s=(null==a?void 0:a.element)||null;s!==e.hoveringElement&&(e.hoveringElement=s),a?e.upime.view.setCursor(a.type?"pointer":"",e):e.upime.view.setCursor(Vd(),e),e.tickets>=e.config.tickets&&"plus"===(null==a?void 0:a.type)?n(a.globalPosition):t&&i()}},this.scene.onClickEvt=function(t){var i,o,a=r(t);if(a&&a.type){var s=a.element,l=a.type;if("plus"===l&&e.tickets>=e.config.tickets)return void(null===(i=e.onNoTickets)||void 0===i||i.call(e));var c="plus"===l?1:-1,u=(e.resultMap.get(s.id)||0)+c;"plus"!==l||e.resultMap.get(s.id)||null===(o=e.onPlusTicket)||void 0===o||o.call(e,s.id),u>0?e.resultMap.set(s.id,u):e.resultMap.delete(s.id);var d=e.visibleCtrlBtns.find((function(e){return e.element===s}));d&&(d.tickets=u),e.tickets+=c,e.hoveringElement===s&&(e.tickets>=e.config.tickets&&n(a.globalPosition),0===u&&(e.hoveringElement=null)),e.upime.view.updateWidgetCvs()}},function(){t&&e.upime.view.clearTip(e),e.upime.view.setCursor("",e)}},e.prototype.onVoteBegin=function(){var e=this.config,t=e.area,n=e.refPositions,i=new Yc(t.x,t.y,t.width,t.height);this.scene.setViewClip(i),this.moveToVoteArea(),this.voteCtrl.setRefPositions(n)},e.prototype.onVoteFinish=function(){this.scene.onRemove=void 0,this.scene.remove(),this.upime.setViewRect(this.originViewRect)},e.prototype.getVoteResult=function(){return Array.from(this.resultMap)},e.prototype.getVotedElement=function(){var e=this;return this.elements.filter((function(t){return e.resultMap.has(t.id)}))},e.prototype.moveToVoteArea=function(){this.voteCtrl.moveToVoteArea(this.config.area)},e.prototype.destroy=function(){this.onVoteFinish(),this.unSubUserEvents(),this.upime.view.setWidgetCvsAutoRender(!1)},M([rl],e.prototype,"tickets",void 0),M([il],e)}(),Z$=function(){function e(e,t){var n=this;this.voteCtrl=e,this.results=[],this.renderKey="display-vote-result-widget",this.renderer=function(e){for(var t=e.viewbox,i=function(e){e.element||(e.element=n.upime.elementManager.getElementById(e.elementId));var i=e.element,r=e.total;if(!i||!i.mounted)return"continue";var o=i.getGlobalBox();if(o.rotate&&(o=Sn(o,o.rotate)),!Kt(o,t))return"continue";var a=(o.right-t.left)*t.scale,s=(o.bottom-t.top)*t.scale;i.elementType===Za.STICKER&&(s+=.1*(o.top-o.bottom)*t.scale),Na((function(e){e.beginFill(3044325),e.lineStyle(1,16777215),r>99?e.drawRoundedRect(a-23.5,s-14.5,38,29,14.5):e.drawCircle(a,s,14.5)})),Ra({text:"".concat(r>99?"99+":r),fontFamily:Ae.SOURCE_HAN_SANS_CN,fontSize:16,lineHeight:20,textWidth:0},{x:r>99?a-4.5:a,y:s-10,ha:"center",fill:"#fff"})},r=0,o=n.results;r<o.length;r++)i(o[r])};var i=e.upime;i.view.setWidgetCvsAutoRender(!0),e.moveToVoteArea(t.area),e.setRefPositions(t.refPositions),this.updateResults(t.results),i.view.addCanvasWidget(this)}return Object.defineProperty(e.prototype,"upime",{get:function(){return this.voteCtrl.upime},enumerable:!1,configurable:!0}),e.prototype.updateResults=function(e){var t=this.upime.elementManager;this.results=e.map((function(e){var n=t.getElementById(e.elementId);return exports.E(exports.E({},e),{element:n})})),this.upime.view.updateWidgetCvs()},e.prototype.destroy=function(){this.upime.view.removeCanvasWidget(this),this.upime.view.setWidgetCvsAutoRender(!1)},e}(),J$=function(){function e(e){this.upime=e}return e.prototype.onWorkStart=function(){var e=this.upime;e.switchMode("none"),e.lockXMode(!0),e.hideAllControls(!0)},e.prototype.onWorkStop=function(){var e=this.upime;e.hideAllControls(!1),e.lockXMode(!1),e.switchMode("select")},e.prototype.startPrepare=function(e){var t=this;this.clearWrok();var n=this.upime;this.onWorkStart();var i=new Y$(this);return n.view.addCanvasWidget(i),i.scene.onRemove=this.stopWork=function(){null==e||e(),n.view.removeCanvasWidget(i),i.destroy(),t.onWorkStop()},i},e.prototype.startVote=function(e,t){var n=this;this.clearWrok();var i=this.upime;this.onWorkStart();var r=new Q$(this,e);return i.view.addCanvasWidget(r),r.scene.onRemove=this.stopWork=function(){null==t||t(),i.view.removeCanvasWidget(r),r.destroy(),n.onWorkStop()},r},e.prototype.displayVoteResult=function(e,t){this.clearWrok();var n=new Z$(this,e);return this.stopWork=function(){null==t||t(),n.destroy()},n},e.prototype.moveToVoteArea=function(e){var t=Bt(e);this.upime.makeBorderCenter(t,{left:20,right:20,top:60,bottom:60})},e.prototype.setRefPositions=function(e){var t=this;e.forEach((function(e){if(e.parentType===Za.DOCUMENT){var n=e.parentId,i=e.pageId,r=t.upime.elementManager.getElementById(n);r&&r.turnPageTo(i,(function(){}))}else if(e.parentType===Za.VIDEO||e.parentType===Za.AUDIO){n=e.parentId;var o=e.mediaTime,a=t.upime.elementManager.getElementById(n);a&&a.setCurrentTime(o/1e3)}}))},e.prototype.clearWrok=function(){this.stopWork&&(this.stopWork(),this.stopWork=void 0)},e.prototype.destroy=function(){this.clearWrok()},e}(),$$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case BJ.VoteResultForUsersInVoting:return{type:t[0],userId:t[1],votingResult:t[2]};case BJ.VoteResultForUserOtherLink:return{type:t[0],votingResult:t[1]}}},t.prototype.leaveVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(RJ.LeaveVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("leave voting failed: ".concat(t[0]));return[2]}}))}))},t.prototype.submitVoteResult=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(RJ.SubmitVoteResult,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("submit vote result failed: ".concat(t[0]));return[2]}}))}))},t.prototype.destroy=function(){this.close()},t}(Sp),e0=function(){function e(e,t,n){var i=this;this.upime=e,this.votingPlugin=t,this.updateVotingDynamicData=function(e){i.votingDynamicData=exports.E(exports.E({},i.votingDynamicData),e)},this._votingSessionActionHandler=function(e){switch(e.type){case BJ.VoteResultForUsersInVoting:var t=e.userId,n=e.votingResult,r=R([],i.votingDynamicData.results,!0),o=i.votingPlugin.addUserVoteResultsToElementVoteResults(t,n,r);i.updateVotingDynamicData({results:o}),i.votingPlugin.updateCurrentVotingDetailData({results:o}),i.votingPlugin.updateCurrentVotingDetailDataForViewResult({results:o});break;case BJ.VoteResultForUserOtherLink:t=i.upime.localUserInfo.loginName,n=e.votingResult,r=R([],i.votingDynamicData.results,!0),o=i.votingPlugin.addUserVoteResultsToElementVoteResults(t,n,r),i.updateVotingDynamicData({results:o})}},this.votingSessionSubService=null,this.votingDynamicData=n}return e.prototype.leaveVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:if(null===this.votingSessionSubService)throw new Error("votingSessionSubService not inited");return[4,this.votingSessionSubService.sendRCmd(RJ.LeaveVoting,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("leave voting failed: ".concat(t[0]));return[2]}}))}))},e.prototype.submitVoteResult=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:if(null===this.votingSessionSubService)throw new Error("votingSessionSubService not inited");return[4,this.votingSessionSubService.sendRCmd(RJ.SubmitVoteResult,e)];case 1:if((t=n.sent())[0]!==MJ.RequestSuccess)throw new Error("submit voting result failed: ".concat(t[0]));return[2]}}))}))},e.prototype.start=function(){this.votingSessionSubService=this.upime.createSubService($$,this.votingDynamicData.servicePort,this._votingSessionActionHandler),this.votingSessionSubService.open()},e.prototype.destroy=function(){var e;null===(e=this.votingSessionSubService)||void 0===e||e.destroy()},M([il],e)}(),t0="itemLabel_KxQDL",n0="disabled_lnuU0",i0="content_3B0a_",r0=function(){var t,n,i,r=W().getUpimeTrans,o=Sl("votingPlugin"),a=o.prepareVotingWidget;al(a,["inBoxElements"]);var s=e.useRef(null),l=e.useState("".concat(r("voting.name")).concat(o.historyVotingList.length+1)),c=l[0],u=l[1],d=e.useState(1),p=d[0],h=d[1],f=yh(!0),m=f.hide,v=f.setHide,g=f.toggleHide,y=f.skipRef,b=e.useState(E$[0].value),E=b[0],x=b[1],w=e.useState(!1),C=w[0],S=w[1],k=function(e){var t,n,i,r,o;return Ou(e)||Fu(e)||zu(e)?null!==(t=e.name)&&void 0!==t?t:"":Iu(e)?null!==(i=null===(n=e.textNodes[0])||void 0===n?void 0:n.rawText.trim())&&void 0!==i?i:"":null!==(o=null===(r=e.richTextClient)||void 0===r?void 0:r.chars.join("").trim())&&void 0!==o?o:""},_=new Map,T=new Map,I=[];null==a||a.inBoxElements.forEach((function(e){var t,n,i=e.element,r=e.selected;if(function(e){return v$.some((function(t){return t===e.elementType}))}(i)){var o=i.elementType;o===Za.GRAPHIC&&(o=Za.SHAPE),_.set(o,(null!==(t=_.get(o))&&void 0!==t?t:0)+1),r&&(T.set(o,(null!==(n=T.get(o))&&void 0!==n?n:0)+1),I.push(i))}}));var P=Array.from(_.entries()).sort((function(e,t){var n=t[1]-e[1];return 0!==n?n:g$[e[0]]-g$[t[0]]})),N=null!==(t=null==a?void 0:a.inBoxElements.length)&&void 0!==t?t:0,M=I.length===N,R=e.useRef(!1);return e.createElement("div",{className:"container_2i-5H"},e.createElement("div",{className:"headWrap_2X2kE"},e.createElement("span",{className:"title_1ydwz"},r("voting.create")),e.createElement(hl,{icon:"guanbi",className:"closeButton_gpnOB",onClick:function(){o.stopPrepareVoting()}})),e.createElement("div",{className:"bodyWrap_KTV_E"},e.createElement("div",{className:"bodyContentWrap_2ogG1"},e.createElement("div",{className:j("nameWrap_2nMbu")},e.createElement("div",{className:t0},r("voting.create.name")),e.createElement("div",{className:"inputNameWrap_190yM"},e.createElement("input",{className:"inputName_1CXsS",type:"text",ref:s,value:c,onInput:function(e){u(e.target.value)},onBlur:function(){""===c.trim()&&u("".concat(r("voting.name")).concat(o.historyVotingList.length+1))}}),c.length>0&&e.createElement("div",{className:"clearInput_3uQUK",onClick:function(){var e;u(""),null===(e=s.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"qingchu",className:"clearIcon_2H8Ve"})))),e.createElement("div",{className:"votesCountWrap_2CP5r"},e.createElement("span",{className:t0},r("voting.create.tickets")),e.createElement("div",{className:"votesCount_1b5Ds"},e.createElement("span",{className:j("decreaseIcon_26IXi",1===p&&n0),onClick:function(){p>1&&h(p-1)}},e.createElement(hl,{icon:"jian",className:"jianIcon_2WGyI"})),e.createElement("input",{className:"inputCount_1xgeV",type:"text",value:p,onInput:function(e){var t=e.target.value;if(""===t)h(1);else if(!0===/^\d+$/.test(t)){var n=parseInt(t,10);h(Math.max(1,Math.min(n,99)))}},onFocus:function(e){e.target.select()},onBlur:function(e){""===e.target.value&&h(1)}}),e.createElement("span",{className:j("increaseIcon_2yP-N",99===p&&n0),onClick:function(){p<99&&h(p+1)}},e.createElement(hl,{icon:"jia",className:"jiaIcon_3g9qQ"})))),e.createElement("div",{className:"durationWrap_2thY6"},e.createElement("span",{className:t0},r("voting.create.duration")),e.createElement("div",{className:j("select_1sL22",!1===m&&"active_28Rq1"),ref:y},e.createElement("div",{className:"currentSelected_3mw0T",onClick:function(){g()}},e.createElement("span",{className:i0},null!==(i=null===(n=E$.find((function(e){return e.value===E})))||void 0===n?void 0:n.label())&&void 0!==i?i:""),e.createElement("span",{className:"iconWrap_3mgif"},e.createElement(hl,{className:"arrowIcon_1N2Oq",icon:"shaixuan-xia"}))),!1===m&&e.createElement("div",{className:"options_3nsI4"},E$.map((function(t){return e.createElement("div",{key:t.label(),className:j("option_3MFsd",E===t.value&&"selected_VIBK6"),onClick:function(){var e;e=t.value,x(e),v(!0)}},e.createElement("span",{className:i0},t.label()))}))))),e.createElement("div",{className:"anonymousWrap_Vd3kv"},e.createElement("span",{className:t0},r("voting.create.anonymous")),e.createElement("div",{className:j("switchBtn_25DPw",C&&"on_2FN4B"),onClick:function(){S(!C)}})),e.createElement("div",{className:"elementsWrap_3HsW9"},e.createElement("div",{className:"firstRow_jjRh-"},e.createElement("span",{className:t0},r("voting.create.objects")),N>0&&e.createElement("span",{className:"selectAllBtn_3Jk51",onClick:function(){null!==a&&(M?a.unSelectAllElements():a.selectAllElements())}},r(!0===M?"voting.create.select.none":"voting.create.select.all"))),e.createElement("span",{className:"secondRow_jYKqV"},r("voting.create.select.object.tip")),P.length>0&&e.createElement("div",{className:"elementsList_N1i3O"},P.map((function(t){var n,i=t[0],r=t[1],o=x$.get(i);if(void 0!==o){var s=null!==(n=T.get(i))&&void 0!==n?n:0;return e.createElement("div",{key:o.type,className:"elementItem_2Egvm"},e.createElement("div",{className:"elementInfo_CpXgL"},e.createElement(hl,{className:"elementIcon_qBLCQ",icon:o.icon}),e.createElement("span",{className:"elementName_2JoUA"},o.name()),e.createElement("span",{className:"elementCount_2lG9C"},"(",r,")")),e.createElement("div",{className:j("checkbox_2EbLw",s>0&&s!==r&&"selectPart_2Np_h",s===r&&"selectAll_3EdPS"),onClick:function(){s<r?(null==a||a.selectElementsByType(i),i===Za.SHAPE&&(null==a||a.selectElementsByType(Za.GRAPHIC))):(null==a||a.unSelectElementsByType(i),i===Za.SHAPE&&(null==a||a.unSelectElementsByType(Za.GRAPHIC)))}}))}}))),0===_.size&&e.createElement("div",{className:"elementsEmptyTip__Y5Ox"},e.createElement(hl,{icon:"file-jinggao",className:"warningIcon_eqqPd"}),e.createElement("span",{className:"warningContent_C3JaV"},r("voting.create.object.empty.tip"))))),e.createElement("div",{className:"bottomButtonWrap_2mrWP"},(null==a?void 0:a.inBoxElements.some((function(e){return e.selected})))?e.createElement(ul,{type:"primary",size:"large",onClick:function(){return A(void 0,void 0,void 0,(function(){var e,t,n,i,a,s;return D(this,(function(l){switch(l.label){case 0:return!0===R.current||null===o.prepareVotingWidget?[2]:(R.current=!0,e=new Map,t=I.map((function(t){var n;return exports.E(exports.E({},function(e){return{elementId:e.id,snapshot:null,text:k(e)}}(t)),{snapshot:null!==(n=e.get(t.id))&&void 0!==n?n:null})})),n=Array.from(T.keys()),_c("cv_newvoting",{duration:null!==(s=null===(a=E$.find((function(e){return e.value===E})))||void 0===a?void 0:a.labelForAplus)&&void 0!==s?s:"",anonymous:C?"匿名":"不匿名",elementTypes:n.map((function(e){var t;return null===(t=x$.get(e))||void 0===t?void 0:t.nameForAplus})).filter((function(e){return void 0!==e})).join(",")}),[4,k$(o.createVoting({name:c,area:exports.E(exports.E({},o.prepareVotingWidget.position),o.prepareVotingWidget.size),elementTypes:n,elements:t,relatedParents:o.prepareVotingWidget.calcRelatedParents(),startTime:Date.now(),duration:E,tickets:p,anonymous:C}))]);case 1:return null!==(i=l.sent()[0])?(R.current=!1,i.code===MJ.AlreadyExist?o.upime.addToast(r("voting.create.failed.only.one")):o.upime.addToast(r("voting.create.failed.common")),[2]):(o.stopPrepareVoting(),o.upime.switchRightSlideExtension(z0,!0),[2])}}))}))}},r("voting.create.confirm")):e.createElement(Dl,{placement:"top",content:r("voting.create.confirm.object.empty.tip")},e.createElement(ul,{type:"primary",size:"large",disabled:!0},r("voting.create.confirm"))))))},o0=function(){var t=W().getUpimeTrans,n=Sl("votingPlugin"),i=function(){var e=n.prepareVotingWidget;if(null!==e){var t=n.upime.view.getViewbox(),i=e.position;return{left:(i.x-t.left)*t.scale,top:(i.y-t.top)*t.scale-45}}},r=e.useState((function(){return i()})),o=r[0],a=r[1];return sl(n.prepareVotingWidget,(function(){a(i())}),["position"]),e.useEffect((function(){var e=[n.upime.view.subscribe("viewboxChange",(function(){a(i())}))];return function(){e.forEach((function(e){return e()}))}}),[]),e.createElement("div",{className:"tipWrap_13MF7",style:exports.E({position:"absolute"},o)},e.createElement("span",{className:"tipContent_1NOQR"},t("voting.voting.area.tip")),e.createElement(Dl,{placement:"bottomLeft",useClick:_e.isTouchSupported,renderData:{data:{},fun:function(){return e.createElement("div",{className:"hoverTipContent_lzIkX"},t("voting.create.area.tip.1"),e.createElement("br",null),t("voting.create.area.tip.2"))}}},e.createElement("div",{className:"iconWrap_35q8h"},e.createElement(hl,{icon:"xinxi2",className:"icon_oE6Yv"}))))},a0=function(){return e.createElement("div",{className:"container_1rnx1"},e.createElement(r0,null),e.createElement(o0,null))},s0="leftDuration_3VhxE",l0="operationBtn_8eWAI",c0=function(){var t=Sl("votingPlugin"),n=W().getUpimeTrans,i=t.upime.localUserInfo,r=t.currentVotingDetailData,o=t.votingWidget;al(o,["tickets"]);var a=e.useState("00 : 00 : 00"),s=a[0],l=a[1];e.useEffect((function(){var e=setInterval((function(){if(null!==r)if(null!==r.duration){var t=(r.duration-(Date.now()-r.startTime))/1e3;if(0===(t=Math.max(t,0)))return l("00 : 00 : 00"),void clearInterval(e);var n=Math.min(Math.floor(t/3600),99),i=Math.floor(t%3600/60),o=Math.floor(t%60);l("".concat(Ch(n)," : ").concat(Ch(i)," : ").concat(Ch(o)))}else clearInterval(e)}),200);return function(){clearInterval(e)}}),[r]);var c=function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return null===r?[2]:[4,k$(t.extendDuration(r.id,e))];case 1:return n.sent()[0],[2]}}))}))};return null===r||null===o?null:e.createElement("div",{className:"container_YniLh"},e.createElement("div",{className:"leftVotesWrap_2iETO"},e.createElement("div",{className:"leftVotesCount_Ir7lX"},"".concat(o.tickets,"/").concat(r.tickets)),e.createElement("div",{className:"leftVotesTip_25jOt"},n("voting.votes.voted"))),e.createElement("div",{className:"divider_2WwKJ"}),e.createElement("div",{className:"leftDurationWrap_1jk8S"},null!==r.duration&&e.createElement(e.Fragment,null,e.createElement("div",{className:s0},s),e.createElement("div",{className:"leftDurationTipWrap_8-gz5"},e.createElement("div",{className:"leftDurationTip_2LP1m"},n("voting.duration.left")),r.creator===i.loginName&&e.createElement("div",{className:"durationOperationWrap_1Sxlr"},e.createElement("div",{className:l0,onClick:function(){c(6e4)}},"+1m"),e.createElement("div",{className:l0,onClick:function(){c(3e5)}},"+5m")))),null===r.duration&&e.createElement("div",{className:s0},n("voting.create.duration.option.unlimited"))))},u0="statusTag_1Wv_W",d0="icon_KPApk",p0="content_EgdeK",h0="btnItem_kA-Sc",f0="btnIcon_QZRmV",m0="btnContent_3PBB6",v0=function(t){var n=Sl("votingPlugin"),i=W().getUpimeTrans,r=n.currentVotingDetailData,o=n.votingWidget;if(null===r||null===o)return null;var a=r.tickets-o.tickets,s=a>0?i("voting.submit.confirm.body.tickets.left",a):i("voting.submit.confirm.body.tickets.empty");return e.createElement(xc,{icon:"jingshi",iconStyles:{color:"#FFA519"},title:i("voting.submit.confirm.title"),bodyContent:s,cancelText:i("voting.submit.cancel"),confirmText:i("voting.submit.confirm"),onCancel:function(){t.success(!1)},onConfirm:function(){t.success(!0)}})},g0=function(){var t=W().getUpimeTrans,n=Sl("votingPlugin"),i=n.currentVotingDetailData,r=n.votingWidget;al(n,["currentVotingDetailData"]);var o=yh(!0),a=o.hide,s=o.setHide,l=o.toggleHide,c=o.skipRef,u=e.useRef(-1),d=e.useRef(-1),p=e.useCallback(_t.throttle((function(){n.upime.addToast(t("voting.tip.no.left.tickets"))}),500),[]),h=rm(),f=rm(),m=rm();if(e.useEffect((function(){var e=[n.eventManager.subscribe("votingEnded",(function(e){n.upime.removeWindow(u.current),n.upime.removeWindow(d.current),n.stopVoting(e)}))];return function(){e.forEach((function(e){return e()}))}}),[]),null===i||null===r)return null;!1===_e.isHoverSupported&&void 0===r.onNoTickets&&(r.onNoTickets=function(){p()}),void 0===r.onPlusTicket&&(r.onPlusTicket=function(e){var t=i.elements.find((function(t){return t.elementId===e}));void 0!==t&&null===t.snapshot&&em(e,n.upime,{svg:!0,png:!0}).then((function(t){n.setElementSnapshot(i.id,e,t)})).catch((function(){}))});var v=n.upime.localUserInfo;return n.upime.getUserInfo(i.creator),e.createElement("div",{className:"container_3sLRc"},e.createElement("div",{className:"firstColumn_3CFHV"},e.createElement("div",{className:"votingName_3Fizx"},i.name),e.createElement("div",{className:"statusTags_2OAt8"},e.createElement("div",{className:u0},!0===i.anonymous?t("voting.anonymous"):t("voting.realname")),e.createElement("div",{className:u0},t("voting.voted.users",i.numberOfVoted)))),e.createElement(ul,{className:"backToVotingAreaBtn_omzCv",onClick:function(){null!==r&&r.moveToVoteArea()}},e.createElement(hl,{className:d0,icon:"huidaozhushitu"}),e.createElement("span",{className:p0},t("voting.back.to.area"))),e.createElement("div",{className:"moreBtnWrap_HuBMx",ref:c},e.createElement(ul,{className:"moreBtn_338cF",onClick:function(){l()}},e.createElement(hl,{className:d0,icon:"shuangshang"}),e.createElement("span",{className:p0},t("voting.more"))),!1===a&&e.createElement(xh,{align:"center",extraStyle:{top:"unset",bottom:"calc(100% + 8px)"}},e.createElement("div",{className:"moreBtnList_2lTxS"},e.createElement(ul,{className:h0,onClick:function(){if(s(!0),null!==i){var e=n.upime.getUserInfo(i.creator);n.getInviteVotingUrl(i.id,e.userName,i.name)}}},e.createElement(hl,{className:f0,icon:"lianjie"}),e.createElement("span",{className:m0},t("voting.invitation.copy"))),e.createElement(ul,{className:h0,onClick:function(){s(!0),null!==i&&n.showVotingQrCode(i.id)}},e.createElement(hl,{className:f0,icon:"erweima"}),e.createElement("span",{className:m0},t("voting.qrcode.generate"))),i.status===NJ.Created&&(i.creator===v.loginName||!0===n.config.canEndVoting)&&e.createElement(ul,{className:j(h0,"endBtn_3oKMP"),onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return s(!0),null===i||m.isLocking?[2]:(m.start(),[4,n.upime.showWindow(B$,void 0,void 0,void 0,void 0,(function(e){d.current=e}))]);case 1:return!1===e.sent()?(m.stop(),[2]):[4,k$(n.stopVoting(i.id))];case 2:return e.sent()[0],[4,k$(n.endVoting(i.id))];case 3:return e.sent()[0],n.startViewVotingResult(i.id).catch((function(){})),m.stop(),[2]}}))}))}},e.createElement(hl,{className:f0,icon:"icontingzhi"}),e.createElement("span",{className:m0},t("voting.end")))))),e.createElement(ul,{className:"leaveBtn_29WjU",type:"secondary",disabled:h.isLocking,onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===i||h.isLocking?[2]:(h.start(),[4,k$(n.stopVoting(i.id))]);case 1:return e.sent()[0],h.stop(),[2]}}))}))}},t("voting.leave")),e.createElement(ul,{className:"submitBtn_3ondH",type:"primary",disabled:f.isLocking,onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===i||null===r||f.isLocking?[2]:(f.start(),[4,n.upime.showWindow(v0,void 0,void 0,void 0,void 0,(function(e){u.current=e}))]);case 1:return!1===e.sent()?(f.stop(),[2]):[4,k$(n.submitVoteResult(i.id,r.getVoteResult()))];case 2:return e.sent()[0],n.upime.addToast(t("voting.voted.tip")),[4,k$(n.stopVoting(i.id))];case 3:return e.sent()[0],n.startViewVotingResult(i.id).catch((function(){})),i.elements.filter((function(e){return null===e.snapshot})).sort((function(){return Math.random()-.5})).slice(0,5).forEach((function(e){var t=e.elementId;em(t,n.upime,{svg:!0,png:!0}).then((function(e){n.setElementSnapshot(i.id,t,e)})).catch((function(){}))})),f.stop(),[2]}}))}))}},t("voting.done")))},y0=function(){return e.createElement("div",{className:"container_2PsCp"},e.createElement(g0,null),e.createElement(c0,null))},b0="icon_-z8Si",E0="content_1J1xz",x0=function(t){var n=Sl("votingPlugin"),i=W().getUpimeTrans,r=n.currentVotingDetailData,o=n.votingWidget;if(null===r||null===o)return null;var a=r.tickets-o.tickets,s=a>0?i("voting.submit.confirm.body.tickets.left",a):i("voting.submit.confirm.body.tickets.empty");return e.createElement(bV,{header:i("voting.submit.confirm.title"),footer:[e.createElement("span",{key:"cancel",style:{color:"#0C1024"},onClick:function(){t.success(!1)}},i("voting.submit.cancel")),e.createElement("span",{key:"confirm",style:{color:"#2E73E5"},onClick:function(){t.success(!0)}},i("voting.submit.confirm"))]},e.createElement("div",{style:{textAlign:"center"}},s))},w0=function(){var t=Sl("votingPlugin"),n=t.currentVotingDetailData,i=t.votingWidget;al(t,["currentVotingDetailData"]);var r=e.useState("00:00:00"),o=r[0],a=r[1],s=W().getUpimeTrans,l=e.useCallback(_t.throttle((function(){t.upime.addToast(s("voting.tip.no.left.tickets"))}),500),[]);e.useEffect((function(){var e=setInterval((function(){if(null!==n)if(null!==n.duration){var t=(n.duration-(Date.now()-n.startTime))/1e3;if(0===(t=Math.max(t,0)))return a("00:00:00"),void clearInterval(e);var i=Math.min(Math.floor(t/3600),99),r=Math.floor(t%3600/60),o=Math.floor(t%60);a("".concat(Ch(i),":").concat(Ch(r),":").concat(Ch(o)))}else clearInterval(e)}),200);return function(){clearInterval(e)}}),[n]);var c=rm(),u=rm();return e.useEffect((function(){var e=[t.eventManager.subscribe("votingEnded",(function(e){t.stopVoting(e).catch((function(){}))}))];return function(){e.forEach((function(e){return e()}))}}),[]),null===n||null===i?null:(void 0===i.onNoTickets&&(i.onNoTickets=function(){l()}),void 0===i.onPlusTicket&&(i.onPlusTicket=function(e){var i=n.elements.find((function(t){return t.elementId===e}));void 0!==i&&null===i.snapshot&&em(e,t.upime,{svg:!0,png:!0}).then((function(i){t.setElementSnapshot(n.id,e,i)})).catch((function(){}))}),e.createElement("div",{className:"container_2cP2R"},e.createElement("div",{className:"firstColumn__6eYB"},e.createElement("div",{className:"firstRow_1o8eo"},n.name),e.createElement("div",{className:"secondRow_2vRmz"},e.createElement("div",{className:"statusTag_202kE"},!0===n.anonymous?s("voting.anonymous"):s("voting.realname")),e.createElement("div",{className:"leftDuration_1gFid"},e.createElement(hl,{icon:"jishiqi",className:b0}),e.createElement("span",{className:E0},o)),e.createElement("div",{className:"ticketsTip_WqAk3"},e.createElement(hl,{icon:"piaoshu",className:b0}),e.createElement("span",{className:E0},"".concat(i.tickets,"/").concat(n.tickets))))),e.createElement("div",{className:"secondColumn_1mTg5"},e.createElement(ul,{className:"leaveBtn_EV2OS",type:"secondary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===n||c.isLocking?[2]:(c.start(),[4,k$(t.stopVoting(n.id))]);case 1:return e.sent()[0],c.stop(),[2]}}))}))}},s("voting.toolbar.leave")),e.createElement(ul,{className:"submitBtn_1blg3",type:"primary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===n||null===i||u.isLocking?[2]:(u.start(),[4,t.upime.showWindow(x0)]);case 1:return!1===e.sent()?(u.stop(),[2]):[4,k$(t.submitVoteResult(n.id,i.getVoteResult()))];case 2:return e.sent()[0],[4,k$(t.stopVoting(n.id))];case 3:return e.sent()[0],t.upime.addToast(s("voting.voted.tip")),[4,k$(t.startViewVotingResult(n.id))];case 4:return e.sent(),u.stop(),[2]}}))}))}},s("voting.toolbar.submit")))))},C0=function(){return e.createElement("div",{className:"container_35hb1"},e.createElement(w0,null))},S0=function(n){var i=n.votingDetailData,r=e.useContext(Ic),o=r.toastContainer,a=r.rootContainer,s=e.useContext(xl).phoneMode,l=W().getUpimeTrans,c=Sl("votingPlugin"),u=rm();if(null===i||null===o.current||null===a.current)return null;var d=c.upime.localUserInfo,p=c.upime.getUserInfo(i.creator);return t.createPortal(e.createElement(Hc,{className:j("container_3WIqZ"),initOffset:function(){var e=c.upime.view.viewWidth,t=s?{width:344,y:68}:{width:376,y:9};return{x:(e-t.width)/2,y:t.y}}()},e.createElement(e.Fragment,null,e.createElement("div",{className:"leftPart_2KfZt"},e.createElement(L$,{creatorUserInfo:p,localUserInfo:d,votingDetailData:i,lineLimit:1,useHoverTip:!1,style:{color:"#fff"}})),e.createElement("div",{className:"rightPart_2X9hM"},e.createElement(ul,{type:"primary",className:"action_21JvV",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){return null===i||u.isLocking||(u.start(),c.hideNewVotingNotification(),!0===c.upime.phoneMode&&c.upime.closePhoneDrawer().catch((function(){})),c.isPreparingVoting&&c.stopPrepareVoting(),c.isVoting&&null!==c.currentVotingDetailData&&c.stopVoting(c.currentVotingDetailData.id).catch((function(){})),c.startVoting(i.id).catch((function(){})),u.stop()),[2]}))}))}},l("voting.joinnow")),e.createElement("div",{className:"closeButton_1DXCC"},e.createElement(hl,{icon:"guanbi",className:"closeIcon_1Q3pS",onClick:function(){c.hideNewVotingNotification()}}))))),o.current,"new-voting-".concat(i.id))},k0=function(n){var i=n.votingDetailData,r=e.useContext(Ic).toastContainer,o=e.useContext(xl).phoneMode,a=W().getUpimeTrans,s=Sl("votingPlugin"),l=rm();return null===i?null:t.createPortal(e.createElement(Hc,{className:"container_3a6IR",initOffset:function(){var e=s.upime.view.viewWidth,t=o?{width:344,y:68}:{width:376,y:9};return{x:(e-t.width)/2,y:t.y}}()},e.createElement(e.Fragment,null,e.createElement("div",{className:"leftPart_3c_Ke"},e.createElement("div",{className:"text_sblXA"},a("voting.notification.ended"))),e.createElement("div",{className:"rightPart_1fSWm"},e.createElement(ul,{type:"primary",className:"action_z0xsz",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){return null===i||l.isLocking||(l.start(),s.hideVotingEndedNotification(),!0===s.upime.phoneMode&&s.upime.closePhoneDrawer().catch((function(){})),s.isPreparingVoting&&s.stopPrepareVoting(),s.isVoting&&null!==s.currentVotingDetailData&&s.stopVoting(s.currentVotingDetailData.id).catch((function(){})),s.isViewingVotingResult&&null!==s.currentVotingDetailDataForViewResult&&s.stopViewVotingResult(s.currentVotingDetailDataForViewResult.id,s.currentViewVotingResultProcessId),s.startViewVotingResult(i.id).catch((function(){})),l.stop()),[2]}))}))}},a("voting.result.view")),e.createElement("div",{className:"closeButton_DXyWX"},e.createElement(hl,{icon:"guanbi",className:"closeIcon_3ian5",onClick:function(){s.hideVotingEndedNotification()}}))))),r.current,"voting-end-".concat(i.id))},_0=function(t){var n=t.votingStaticInfo,i=t.onViewDetail,r=W().getUpimeTrans,o=Sl("votingPlugin"),a=new Date(n.startTime),s=a.getFullYear(),l=a.getMonth(),c=a.getDate(),u=a.getDay(),d=a.getHours(),p=a.getMinutes(),h=e.useMemo((function(){return o.upime.getUserInfo(n.creator)}),[]);return al(h,["userName","avatarUrl"]),e.createElement("div",{className:j("container_3I9R6"),onClick:function(){i(n.id)}},e.createElement("div",{className:"leftContainer_2oqlV"},e.createElement("div",{className:"votingStartTime_2SlGu"},e.createElement("span",{className:"votingStartDate_3Dd3j"},s!==(new Date).getFullYear()&&r("datetime.year",s),r(WI[l]),r("datetime.day",c)),e.createElement("span",{className:"votingStartDay_3WOuA"},r(UI[u])),e.createElement("span",{className:"votingStartHour_2DVgk"},"".concat(Ch(d),":").concat(Ch(p)))),e.createElement("div",{className:"votingTitle_2oj1x"},n.name),e.createElement("div",{className:"votingCreator_3n4ol"},e.createElement("span",{className:"creatorTip_2vjq1"},"".concat(r("meeting.creator"),": ")),e.createElement(ml,{className:"creatorAvatar_3m-SQ",url:h.avatarUrl,shape:"circle"}),e.createElement("span",{className:"creatorUsername_2AJWm"},h.userName))),e.createElement("div",{className:"rightContainer_MrfIv"},e.createElement("div",{className:j("viewDetailBtn_2BF5p")},e.createElement("span",{className:"content_30msb"},r("common.check.detail")),e.createElement(hl,{icon:"jiantou-you",className:"arrowIcon_1oynv"}))))},T0=function(t){var n=t.onViewDetail,i=W().getUpimeTrans,r=Sl("votingPlugin"),o=r.historyVotingList;return al(r,["historyVotingList"]),e.useEffect((function(){r.getHistoryVotingList().catch((function(){}))}),[]),e.createElement("div",{className:"container_LOtJO"},e.createElement("div",{className:"listTitle_2zx_s"},i("voting.history")),0===o.length&&e.createElement("div",{className:"emptyPlaceholder_6jTn-"},e.createElement("img",{src:$o("no_content.png")}),e.createElement("span",null,i("voting.history.empty.tip"))),o.length>0&&e.createElement(e.Fragment,null,o.map((function(t){return e.createElement(_0,{key:t.id,votingStaticInfo:t,onViewDetail:n})}))))},I0={rootContainer:"rootContainer_1LkM6",rowContainer:"rowContainer_1e-nD",firstRowGroup:"firstRowGroup_f0TzX",secondRow:"secondRow_3ig3z",statusTag:"statusTag_2_w0E",votingStatus:"votingStatus_2c-Q6",thirdRow:"thirdRow_2u9uh",leftTicketsWrap:"leftTicketsWrap_1lQmX",count:"count_IitlA",tip:"tip_IU0Zu",votedTicketsWrap:"votedTicketsWrap_2mJQL",divider:"divider_2OKSn",leftDurationWrap:"leftDurationWrap_3EqKA",leftDuration:"leftDuration_3yIPt",leftDurationTipWrap:"leftDurationTipWrap_2_bw3",leftDurationTip:"leftDurationTip_14X4R",durationOperationWrap:"durationOperationWrap_2xf5M",operationBtnContainer:"operationBtnContainer_18wm_",operationBtn:"operationBtn_3UlOL",fourthRow:"fourthRow_35kIH",endVotingBtn:"endVotingBtn_3ohwE",joinVotingBtn:"joinVotingBtn_538JT",viewResultBtn:"viewResultBtn_hKm0I",disabled:"disabled_myYFx"},P0=function(t){var n,i,r=Sl("votingPlugin"),o=W().getUpimeTrans,a="".concat(o("voting.end.confirm.content",null!==(i=null===(n=r.currentVotingDetailData)||void 0===n?void 0:n.numberOfVoted)&&void 0!==i?i:0));return e.createElement(bV,{header:o("voting.end.confirm.title"),footer:[e.createElement("span",{key:"cancel",style:{color:"#0C1024"},onClick:function(){t.success(!1)}},o("voting.end.cancel")),e.createElement("span",{key:"confirm",style:{color:"#2E73E5"},onClick:function(){t.success(!0)}},o("voting.end.confirm"))]},e.createElement("div",{style:{textAlign:"center"}},a))},N0=function(t){var n=t.onClose,i=t.onViewDetail,r=Sl("votingPlugin"),o=W().getUpimeTrans,a=r.currentVotingDetailData;al(r,["currentVotingDetailData"]);var s=e.useRef(null),l=e.useState("00 : 00 : 00"),c=l[0],u=l[1];e.useEffect((function(){var e=setInterval((function(){if(null!==a)if(null!==a.duration){var t=(a.duration-(Date.now()-a.startTime))/1e3;if(0===(t=Math.max(t,0)))return clearInterval(e),void u("00 : 00 : 00");var n=Math.min(Math.floor(t/3600),99),i=Math.floor(t%3600/60),r=Math.floor(t%60);u("".concat(Ch(n)," : ").concat(Ch(i)," : ").concat(Ch(r)))}else clearInterval(e)}),200);return function(){clearInterval(e)}}),[a]);var d=function(e){return A(void 0,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return null===a?[2]:[4,k$(r.extendDuration(a.id,e))];case 1:return t.sent()[0],[2]}}))}))},p=rm(),h=rm();if(null===a)return null;var f=r.upime.localUserInfo,m=r.upime.getUserInfo(a.creator),v=_t.reduce(a.mine,(function(e,t){return e+t}),0);return e.createElement("div",{className:I0.rootContainer},e.createElement("div",{className:I0.firstRowGroup},e.createElement("div",{className:j(I0.rowContainer,I0.firstRow),ref:s},e.createElement(L$,{creatorUserInfo:m,localUserInfo:f,votingDetailData:a,lineLimit:2,useHoverTip:!1})),e.createElement("div",{className:j(I0.rowContainer,I0.secondRow)},a.status===NJ.Created&&e.createElement("div",{className:j(I0.statusTag,I0.votingStatus)},o("voting.ongoing")),e.createElement("div",{className:j(I0.statusTag)},!0===a.anonymous?o("voting.anonymous"):o("voting.realname")),e.createElement("div",{className:j(I0.statusTag)},o("voting.voted.users",a.numberOfVoted)))),e.createElement("div",{className:j(I0.rowContainer,I0.thirdRow)},null===a.mine&&e.createElement("div",{className:I0.leftTicketsWrap},e.createElement("div",{className:I0.count},a.tickets),e.createElement("div",{className:I0.tip},o("voting.votes.total"))),null!==a.mine&&e.createElement("div",{className:I0.votedTicketsWrap},e.createElement("div",{className:I0.count},"".concat(v,"/").concat(a.tickets)),e.createElement("div",{className:I0.tip},o("voting.votes.voted"))),e.createElement("div",{className:I0.divider}),e.createElement("div",{className:I0.leftDurationWrap},null!==a.duration&&e.createElement(e.Fragment,null,e.createElement("div",{className:I0.leftDuration},c),null!==a.duration&&e.createElement("div",{className:I0.leftDurationTipWrap},e.createElement("div",{className:I0.leftDurationTip},o("voting.duration.left")),f.loginName===a.creator&&a.status===NJ.Created&&e.createElement("div",{className:I0.durationOperationWrap},e.createElement("div",{className:I0.operationBtnContainer,onClick:function(){d(6e4)}},e.createElement("div",{className:I0.operationBtn},"+1m")),e.createElement("div",{className:I0.operationBtnContainer,onClick:function(){d(3e5)}},e.createElement("div",{className:I0.operationBtn},"+5m"))))),null===a.duration&&e.createElement("div",{className:I0.leftDuration},o("voting.create.duration.option.unlimited")))),e.createElement("div",{className:j(I0.rowContainer,I0.fourthRow)},a.status===NJ.Created&&(a.creator===f.loginName||!0===r.config.canEndVoting)&&e.createElement(ul,{className:I0.endVotingBtn,type:"secondary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===a||p.isLocking?[2]:(p.start(),[4,r.upime.showWindow(P0)]);case 1:return!1===e.sent()?(p.stop(),[2]):[4,k$(r.endVoting(a.id))];case 2:return e.sent()[0],p.stop(),[2]}}))}))}},o("voting.end")),a.status===NJ.Created&&null===a.mine&&e.createElement(ul,{className:I0.joinVotingBtn,type:"primary",onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return null===a||h.isLocking?[2]:(h.start(),r.hideNewVotingNotification(),[4,k$(r.startVoting(a.id))]);case 1:return e.sent()[0],n(),h.stop(),[2]}}))}))}},o("voting.joinnow")),(a.status===NJ.Ended||null!==a.mine)&&e.createElement(ul,{className:I0.viewResultBtn,type:"primary",onClick:function(){null!==a&&(r.hideVotingEndedNotification(),i(a.id))}},o("voting.result.view"))))},M0=function(t){var n=t.onClose,i=t.onViewDetail,r=Sl("votingPlugin"),o=W().getUpimeTrans,a=r.currentVotingDetailData;return al(r,["currentVotingDetailData","historyVotingList"]),e.createElement("div",{className:"container_P44JS"},e.createElement("div",{className:"headContainer_S1Fqi"},e.createElement("span",{className:"title_2KSrM"},o("voting.name")),e.createElement(hl,{icon:"guanbi",className:"closeIcon_dZRw9",onClick:n})),e.createElement("div",{className:"bodyContainer_2u7JR"},null!==a&&e.createElement(N0,{onClose:n,onViewDetail:i}),null===a&&e.createElement("div",{className:"unsupportTip_1kOPW"},e.createElement(hl,{className:"icon_3V8K1",icon:"jingshi"}),e.createElement("span",{className:"content_1OV5a"},o("voting.mobile.create.tip"))),e.createElement(T0,{onViewDetail:i})))},A0={container:"container_250Lp",header:"header_oawKP",titleWrap:"titleWrap_3eARc",title:"title_3Kndg",closeBtn:"closeBtn_1w_e8",votingInfoWrap:"votingInfoWrap_1szsL",firstRow:"firstRow_1ZqeF",votingName:"votingName_Hg_MF",secondRow:"secondRow_2zI5h",thirdRow:"thirdRow_2NQ8I",statusTag:"statusTag_us7yj",votingStatus:"votingStatus_1fZGx",body:"body_1JqiQ",resultList:"resultList_12hmI"},D0=function(t){var n=t.elementResult,i=t.votingPlugin;return e.createElement("div",{className:"container_39ZRH"},e.createElement("div",{className:"content_1KFGB"},n.detail.map((function(t){var n=t[0];if(null===n)return null;var r=i.upime.getUserInfo(n);return e.createElement("div",{key:n,className:"userInfoWrap_2Jxg6"},e.createElement(ml,{className:"avatar_3cV7n",url:r.avatarUrl,shape:"circle"}),e.createElement("span",{className:"userName_ydoXS"},r.userName))}))))},R0=function(t){var n=t.elementResult,i=t.onClose,r=Sl("votingPlugin"),o=e.useRef(null),a=_e.isPwa;return e.createElement("div",{className:"container_2RwC6",onClick:function(e){if(null!==o.current){var t=e.target;t instanceof Node&&o.current.contains(t)||i()}}},e.createElement("div",{className:"contentContainer_1eZOk"},e.createElement("div",{className:"content_Rf0rg",ref:o},e.createElement(D0,{elementResult:n,votingPlugin:r})),!0===a&&e.createElement("div",{className:"placeholderForPWA_3YdW8"})))},B0=function(t){var n=t.elementId,i=t.votingDetailData,r=t.upime,o=Sl("votingPlugin"),a=$o("no-history-vote.svg"),s=e.useRef(null),l=e.useState(!1),c=l[0],u=l[1],d=e.useRef(null),p=e.useState(null),h=p[0],f=p[1],m=e.useState(null),v=m[0],g=m[1],y=e.useState(""),b=y[0],E=y[1],x=i.elements.find((function(e){return e.elementId===n}));return e.useEffect((function(){var e,t=!1;return null!==s.current&&(e=new IntersectionObserver((function(e){var n=e[0];!1===t&&u(n.isIntersecting)}),{threshold:0}),e.observe(s.current)),function(){t=!0,null!==s.current&&void 0!==e&&e.unobserve(s.current)}}),[s.current]),e.useEffect((function(){void 0!==x&&null!==x.snapshot&&(null!==x.snapshot.svgFileId&&null===h&&r.getFileInfo(x.snapshot.svgFileId).then((function(e){d.current=e,f(e.url)})).catch((function(){})),null!==x.snapshot.pngFileId&&null===v&&r.getFileInfo(x.snapshot.pngFileId).then((function(e){g(e.url)})).catch((function(){})))}),[c]),e.useEffect((function(){!0===c&&void 0!==x&&(null===x.snapshot||null===x.snapshot.svgFileId&&null===x.snapshot.pngFileId)&&$f(x.elementId,o.upime,{png:!0,contentType:Gf.Base64}).then((function(e){null!==e.png&&E(e.png)})).catch((function(){}))}),[c]),e.createElement("div",{ref:s,className:"elementSnapshotCointainer_NxeT4",onClick:function(e){var t=d.current;null!==t&&void 0!==x&&null!==x.snapshot&&Q(t.url,"text").then((function(e){var n,i,o,a,s;null===(n=r.previewExternalFile)||void 0===n||n.call(r,{ext:"svgText",fileId:t.id,name:t.fileName,size:t.fileSize,width:null!==(o=null===(i=x.snapshot)||void 0===i?void 0:i.width)&&void 0!==o?o:1024,height:null!==(s=null===(a=x.snapshot)||void 0===a?void 0:a.height)&&void 0!==s?s:1024},e)})).catch((function(){var e,n,i,o,a;null===(e=r.previewExternalFile)||void 0===e||e.call(r,{ext:"svg",fileId:t.id,name:t.fileName,size:t.fileSize,width:null!==(i=null===(n=x.snapshot)||void 0===n?void 0:n.width)&&void 0!==i?i:1024,height:null!==(a=null===(o=x.snapshot)||void 0===o?void 0:o.height)&&void 0!==a?a:1024},t.url)}))}},!0===c&&e.createElement(e.Fragment,null,e.createElement("img",{className:"elementSnapshot_o2e94",src:v||b||a,alt:""}),null!==h&&e.createElement("span",{className:"zoomInBtn_pB651"},e.createElement(hl,{icon:"fangda",className:"zoomInIcon_2oSf7"}))))},L0=function(n){var i,r,o=n.elementResult,a=n.votingDetailData,s=n.rank,l=n.submittedVotesCount,c=n.votingPlugin,u=o.elementId,d=o.total,p=o.detail,h=e.useContext(Ic).rootContainer,f=e.useState(!1),m=f[0],v=f[1],g=W().getUpimeTrans;return e.createElement(e.Fragment,null,e.createElement("div",{key:u,className:"resultItem_h741d"},void 0!==(null===(i=a.mine)||void 0===i?void 0:i[u])&&e.createElement("span",{className:"myVoteTip_2UCNb"},g("voting.tickets.self.voted",null===(r=a.mine)||void 0===r?void 0:r[u])),e.createElement("div",{className:j("rank_1BqRv",1===s&&"no1_3xDHs",2===s&&"no2_3kv8m",3===s&&"no3_2vwTy")},"No.".concat(s)),e.createElement("div",{className:"elementWrap_2FWGf"},e.createElement(B0,{elementId:u,votingDetailData:a,upime:c.upime})),e.createElement("div",{className:"resultDetail_1MqAO"},e.createElement("div",{className:"voteCount_1uPoK"},"".concat(g("voting.tickets.users.voted",d)," (").concat(0===l?0:_t.round(d/l*100,1),"%)")),e.createElement("div",{className:"voters_1bNVd",onClick:function(){v(!0)}},!1===a.anonymous&&e.createElement(e.Fragment,null,p.slice(0,3).map((function(t){var n=t[0];if(null===n)return null;var i=c.upime.getUserInfo(n);return e.createElement(ml,{key:t[0],className:"avatar_34i2r",url:i.avatarUrl,shape:"circle"})})),p.length>3&&e.createElement("div",{className:"moreVoters_1B7Rv"},"+".concat(p.length-3))),a.anonymous&&e.createElement("span",{className:"anonymousVotersCount_1BbzC"},g("voting.voted.users",p.length))))),m&&null!==h.current&&t.createPortal(e.createElement(R0,{elementResult:o,onClose:function(){v(!1)}}),h.current))},O0=e.memo((function(t){var n=t.onClose,i=W().getUpimeTrans,r=Sl("votingPlugin"),o=r.currentVotingDetailDataForViewResult;if(al(r,["currentVotingDetailDataForViewResult"]),e.useEffect((function(){var e;null!==o&&(null===(e=r.displayResultWidget)||void 0===e||e.updateResults(o.results))}),[o]),null===o)return null;var a=new Date(o.startTime),s=a.getFullYear(),l=a.getMonth(),c=a.getDate(),u=a.getDay(),d=a.getHours(),p=a.getMinutes(),h=o.results.reduce((function(e,t){return e+t.total}),0),f=R([],o.results,!0);o.elements.forEach((function(e){void 0===f.find((function(t){return t.elementId===e.elementId}))&&f.push({elementId:e.elementId,total:0,detail:[]})}));var m=Array.from(f.reduce((function(e,t){return e.add(t.total)}),new Set)).sort((function(e,t){return t-e}));return e.createElement("div",{className:A0.container},e.createElement("div",{className:A0.header,style:{backgroundImage:"url(".concat($o("meeting_his_bg.png"),")"),backgroundPosition:"top center",backgroundSize:"cover"}},e.createElement("div",{className:A0.titleWrap},e.createElement("span",{className:A0.title},i("voting.results")),e.createElement(hl,{className:A0.closeBtn,icon:"guanbi",onClick:n})),e.createElement("div",{className:A0.votingInfoWrap},e.createElement("div",{className:A0.firstRow},e.createElement("div",{className:A0.votingName},o.name)),e.createElement("div",{className:A0.secondRow},e.createElement("span",{className:A0.votingStartDate},s!==(new Date).getFullYear()&&i("datetime.year",s),i(WI[l]),i("datetime.day",c)),e.createElement("span",{className:A0.votingStartDay},i(UI[u])),e.createElement("span",{className:A0.votingStartHour},"".concat(Ch(d),":").concat(Ch(p)))),e.createElement("div",{className:A0.thirdRow},o.status===NJ.Created&&e.createElement("span",{className:j(A0.statusTag,A0.votingStatus)},"进行中"),e.createElement("span",{className:A0.statusTag},!0===o.anonymous?i("voting.anonymous"):i("voting.realname")),e.createElement("span",{className:A0.statusTag},i("voting.voted.users",o.numberOfVoted))))),e.createElement("div",{className:A0.body},void 0!==(null==o?void 0:o.results)&&e.createElement("div",{className:A0.resultList},f.map((function(t){return e.createElement(L0,{key:t.elementId,votingDetailData:o,elementResult:t,rank:m.findIndex((function(e){return e===t.total}))+1,votingPlugin:r,submittedVotesCount:h})})))))})),F0=function(t){t.upime;var n=t.panelType,i=t.onClose,r=Sl("votingPlugin"),o=null!=n?n:"list",a=e.useCallback((function(){i()}),[]),s=e.useCallback((function(e){r.startViewVotingResult(e)}),[]),l=_e.isPwa;return e.createElement(e.Fragment,null,"list"===o&&e.createElement(M0,{onClose:a,onViewDetail:s}),"detail"===o&&e.createElement(O0,{onClose:a}),!0===l&&e.createElement("div",{className:"placeholderForPWA_1GRPM"}))},z0={icon:"toupiao",name:O("voting.name"),key:"voting",className:"votingIcon",usePublicHead:!1,toolPanel:function(t){var n=t.upime,i=t.panelType,r=t.onDetailPanelClosed,o=Sl("votingPlugin"),a=e.useState(null!=i?i:"list"),s=a[0],l=a[1],c=e.useRef(s);e.useEffect((function(){void 0!==i&&i!==c.current&&(l(i),c.current=i)}),[i]);var u=e.useCallback((function(){n.switchRightSlideExtension(z0,!1)}),[]),d=e.useCallback((function(){null==r||r()}),[r]),p=e.useCallback((function(e){l("detail"),c.current="detail",o.startViewVotingResult(e)}),[]),h=e.useCallback((function(){l("list"),c.current="list"}),[]);return e.createElement("div",{className:"votingToolPanelContainer_m9odm"},"list"===s&&e.createElement(z$,{onClose:u,onViewDetail:p}),"detail"===s&&e.createElement(q$,{onBack:h,onClose:u,onClosed:d}))},toolPanelProps:void 0,hasStatusTip:!1,statusTipType:"badge",badgeTipContent:"",eventManager:new ro,onClickButton:function(){_c("cv_voting")}};!function(){function e(e){var t=this;this.upime=e,this.pluginId="votingPlugin",this.config={},this.currentVotingSession=null,this.prepareVotingWidget=null,this.votingWidget=null,this.displayResultWidget=null,this.currentVotingDetailData=null,this.historyVotingList=[],this.currentVotingDetailDataForViewResult=null,this.isPreparingVoting=!1,this.isVoting=!1,this.isViewingVotingResult=!1,this.isShowingDrawer=!1,this.newVotingNotificationComponentId=null,this.votingEndedNotificationComponentId=null,this._votingManagementActionHandler=function(e){switch(e.type){case DJ.KeyFrame:t.handleKeyFrameAction(e);break;case DJ.CreateVoting:t.handleCreateVotingAction(e);break;case DJ.EndVoting:t.handleEndVotingAction(e);break;case DJ.SetElementSnapshot:t.handleSetElementSnapshotAction(e);break;case DJ.ExtendDuration:t.handleExtendDurationAction(e);break;case DJ.VoteResultForUsersInBoard:t.handleVoteResultForUsersInBoardAction(e)}},this.reset=function(){var e;t.stopUpdatePluginButtonStatusTip(),t.hideAllNotification(),null===(e=t.currentVotingSession)||void 0===e||e.destroy(),t.currentVotingSession=null,t.voteCtrl.clearWrok(),!0===t.isPreparingVoting&&(t.hidePrepareVotingLayoutComponent(),t.prepareVotingWidget=null,t.isPreparingVoting=!1),!0===t.isVoting&&(t.hideVotingLayoutComponent(),t.votingWidget=null,t.isVoting=!1),!0===t.isViewingVotingResult&&(t.displayResultWidget=null,t.isViewingVotingResult=!1),t.currentVotingDetailData=null,t.currentVotingDetailDataForViewResult=null,t.historyVotingList=[],t.upime.switchRightSlideExtension(z0,!1)},this.updateCurrentVotingDetailData=function(e){null!==t.currentVotingDetailData&&(t.currentVotingDetailData=exports.E(exports.E({},t.currentVotingDetailData),e))},this.updateCurrentVotingDetailDataForViewResult=function(e){null!==t.currentVotingDetailDataForViewResult&&(t.currentVotingDetailDataForViewResult=exports.E(exports.E({},t.currentVotingDetailDataForViewResult),e))},this.prepareVotingLayoutComponentId=null,this.votingLayoutComponentId=null,this.alreadyCallbackLeaveForAutoJoinVoting=!1,this.currentViewVotingResultProcessId=-1,this.eventManager=new ro,this.votingManagementSubService=this.upime.createSubService(b$,15,this._votingManagementActionHandler),this.votingManagementSubService.open(),this.voteCtrl=new J$(e),"production"!==process.env.NODE_ENV&&(window._votingPlugin=this)}e.prototype.getFormattedDurationForBadgeTip=function(e){return e<60?"".concat(Math.floor(e),"s"):e<3600?"".concat(Math.floor(e/60),"m"):"".concat(Math.min(Math.floor(e/3600),99),"h")},e.prototype.startUpdatePluginButtonStatusTip=function(){var e=this;this.stopUpdatePluginButtonStatusTip(),this.updatePluginButtonStatusTipTimer=setInterval((function(){var t,n=e.currentVotingDetailData,i=z0.eventManager;if(null===n||n.status!==NJ.Created||void 0===i)return void 0!==i&&i.publish("hasStatusTipUpdated",!1),void e.stopUpdatePluginButtonStatusTip();var r=!1===e.upime.phoneMode&&e.upime.rightSlidePanelType===BW.extensionList&&(null===(t=e.upime.currentCustomFoldableTool)||void 0===t?void 0:t.key)===z0.key,o=e.isShowingDrawer;if(!0!==r&&!0!==o)if(i.publish("hasStatusTipUpdated",!0),null!==n.duration){var a=Math.floor((n.duration-(Date.now()-n.startTime))/1e3);if(0===(a=Math.max(a,0)))return i.publish("hasStatusTipUpdated",!1),void e.stopUpdatePluginButtonStatusTip();var s=e.getFormattedDurationForBadgeTip(a);i.publish("statusTipTypeUpdated","badge"),i.publish("badgeTipContentUpdated",s)}else i.publish("statusTipTypeUpdated","dot");else i.publish("hasStatusTipUpdated",!1)}),300)},e.prototype.stopUpdatePluginButtonStatusTip=function(){clearInterval(this.updatePluginButtonStatusTipTimer)},e.prototype.showNewVotingNotification=function(e){this.hideAllNotification(),this.newVotingNotificationComponentId=this.upime.addSdkPluginCmp(S0,"votingPlugin",{votingDetailData:e})},e.prototype.hideNewVotingNotification=function(){null!==this.newVotingNotificationComponentId&&(this.upime.removeSdkPluginCmp(this.newVotingNotificationComponentId),this.newVotingNotificationComponentId=null)},e.prototype.showVotingEndedNotification=function(e){this.hideAllNotification(),this.votingEndedNotificationComponentId=this.upime.addSdkPluginCmp(k0,"votingPlugin",{votingDetailData:e})},e.prototype.hideVotingEndedNotification=function(){null!==this.votingEndedNotificationComponentId&&(this.upime.removeSdkPluginCmp(this.votingEndedNotificationComponentId),this.votingEndedNotificationComponentId=null)},e.prototype.hideAllNotification=function(){this.hideNewVotingNotification(),this.hideVotingEndedNotification()},e.prototype.handleKeyFrameAction=function(e){var t,n,i;return A(this,void 0,void 0,(function(){var r,o,a,s,l,c,u,d,p,h,f,m,v,g=this;return D(this,(function(y){switch(y.label){case 0:return r=e.votingDetailDatas,o=this.config.autoJoinId,a=this.upime.localUserInfo.loginName,s=r[0],l=this.currentVotingDetailData,u=null!==l,d=((c=void 0!==s)||u)&&(null==s?void 0:s.id)===(null==l?void 0:l.id),!0!==u?[3,6]:!0!==this.isVoting?[3,4]:!1!==c&&!1!==d?[3,1]:(null===(t=this.currentVotingSession)||void 0===t||t.destroy(),this.currentVotingSession=null,this.voteCtrl.clearWrok(),this.isVoting=!1,this.currentVotingDetailData=null!=s?s:null,this.hideVotingLayoutComponent(),null!==l&&this.callbackLeaveForAutoJoinVoting(l.id),!0===c&&!1===d&&(s.creator!==a?this.showNewVotingNotification(s):this.upime.switchRightSlideExtension(z0,!0)),[3,3]);case 1:return p=s.id,this.currentVotingDetailData=s,null===(n=this.currentVotingSession)||void 0===n||n.destroy(),[4,this.joinVoting(p)];case 2:h=y.sent(),(f=new e0(this.upime,this,h)).start(),this.currentVotingSession=f,y.label=3;case 3:return[3,5];case 4:!0===this.isViewingVotingResult?(this.currentVotingDetailData=null!=s?s:null,!0===c&&s.id===(null===(i=this.currentVotingDetailDataForViewResult)||void 0===i?void 0:i.id)&&(this.currentVotingDetailDataForViewResult=s)):!0===this.isPreparingVoting&&(this.currentVotingDetailData=null!=s?s:null),y.label=5;case 5:return[3,7];case 6:void 0!==o?void 0!==(m=r.find((function(e){return e.id===o})))?(this.currentVotingDetailData=m,v=o,null===m.mine?this.startVoting(v).then((function(){g.callbackAutoJoinVotingResult(v,!0)})).catch((function(){g.callbackAutoJoinVotingResult(v,!1)})):this.upime.addToast(O("voting.voted.tip"))):this.upime.addToast(O("voting.invite.ended.tip")):!0===c&&(this.currentVotingDetailData=s,null===s.mine&&(s.creator!==a?this.showNewVotingNotification(s):this.upime.switchRightSlideExtension(z0,!0))),y.label=7;case 7:return this.startUpdatePluginButtonStatusTip(),[2]}}))}))},e.prototype.handleCreateVotingAction=function(e){var t=e.votingDetailData;void 0!==t&&(this.currentVotingDetailData=t,this.showNewVotingNotification(t),this.startUpdatePluginButtonStatusTip())},e.prototype.handleEndVotingAction=function(e){var t=e.votingId;null!==this.currentVotingDetailData&&t===this.currentVotingDetailData.id&&(this.hideAllNotification(),this.updateCurrentVotingDetailData({status:NJ.Ended}),this.updateCurrentVotingDetailDataForViewResult({status:NJ.Ended}),null===this.currentVotingDetailData.mine&&this.currentVotingDetailData.creator!==this.upime.localUserInfo.loginName||(this.showVotingEndedNotification(this.currentVotingDetailData),this.addCurrentVotingDetailDataToHistoryVotingList()),this.currentVotingDetailData=null,this.eventManager.publish("votingEnded",t))},e.prototype.handleSetElementSnapshotAction=function(e){this.updateVotingElementSnapshot(e.votingId,e.elementId,e.snapshot)},e.prototype.handleExtendDurationAction=function(e){var t=e.votingId,n=e.duration;null!==this.currentVotingDetailData&&null!==this.currentVotingDetailData.duration&&t===this.currentVotingDetailData.id&&this.updateCurrentVotingDetailData({duration:this.currentVotingDetailData.duration+n})},e.prototype.handleVoteResultForUsersInBoardAction=function(e){var t=e.votingId,n=e.numberOfVoted;null!==this.currentVotingDetailData&&t===this.currentVotingDetailData.id&&(this.updateCurrentVotingDetailData({numberOfVoted:n}),this.updateCurrentVotingDetailDataForViewResult({numberOfVoted:n}))},e.prototype.updateVotingElementSnapshot=function(e,t,n){if(null!==this.currentVotingDetailData&&e===this.currentVotingDetailData.id)void 0!==(r=(i=this.currentVotingDetailData.elements).find((function(e){return e.elementId===t})))&&(r.snapshot=n,this.updateCurrentVotingDetailData({elements:R([],i,!0)}));else if(null!==this.currentVotingDetailDataForViewResult&&e===this.currentVotingDetailDataForViewResult.id)void 0!==(r=(i=this.currentVotingDetailDataForViewResult.elements).find((function(e){return e.elementId===t})))&&(r.snapshot=n,this.updateCurrentVotingDetailDataForViewResult({elements:R([],i,!0)}));else{var i,r,o=this.historyVotingList.find((function(e){return e.id===t}));void 0!==o&&void 0!==(r=(i=o.elements).find((function(e){return e.elementId===t})))&&(r.snapshot=n,this.historyVotingList=R([],this.historyVotingList,!0))}},e.prototype.addCurrentVotingDetailDataToHistoryVotingList=function(){var e=this.currentVotingDetailData;null!==e&&-1===this.historyVotingList.findIndex((function(t){return t.id===e.id}))&&(this.historyVotingList=R([e],this.historyVotingList,!0))},e.prototype.removeFromHistoryVotingList=function(e){this.historyVotingList=this.historyVotingList.filter((function(t){return t.id!==e}))},e.prototype.updateSelfVoteResultForCurrentVotingDetailData=function(e){this.updateCurrentVotingDetailData({mine:e.reduce((function(e,t){var n=t[0],i=t[1];return e[n]=i,e}),{})})},e.prototype.addUserVoteResultsToElementVoteResults=function(e,t,n){return t.forEach((function(t){var i=t[0],r=t[1],o=n.find((function(e){return e.elementId===i}));void 0!==o?(o.total+=r,o.detail.push([e,r])):n.push({elementId:i,total:r,detail:[[e,r]]})})),n.sort((function(e,t){return t.total-e.total})),n},e.prototype.updateVoteResultForCurrentVotingDetailData=function(e){var t;if(null!==this.currentVotingDetailData){var n=this.addUserVoteResultsToElementVoteResults(this.upime.localUserInfo.loginName,e,null!==(t=this.currentVotingDetailData.results)&&void 0!==t?t:[]);this.updateCurrentVotingDetailData({results:n})}},e.prototype.init=function(e){var t,n=this.upime;e&&Object.assign(this.config,e),z0.name=O("voting.name"),null===(t=n.customFoldableTools)||void 0===t||t.push(z0)},e.prototype.showPrepareVotingLayoutComponent=function(){this.hidePrepareVotingLayoutComponent(),this.prepareVotingLayoutComponentId=this.upime.addSdkPluginCmp(a0,"votingPlugin")},e.prototype.hidePrepareVotingLayoutComponent=function(){null!==this.prepareVotingLayoutComponentId&&(this.upime.removeSdkPluginCmp(this.prepareVotingLayoutComponentId),this.prepareVotingLayoutComponentId=null)},e.prototype.startPrepareVoting=function(){if(!0===this.isPreparingVoting)throw new Error("isPreparingVoting is true");var e=this.voteCtrl.startPrepare();this.prepareVotingWidget=e,this.isPreparingVoting=!0,this.showPrepareVotingLayoutComponent()},e.prototype.stopPrepareVoting=function(){if(!1===this.isPreparingVoting)throw new Error("isPreparingVoting is false");this.voteCtrl.clearWrok(),this.prepareVotingWidget=null,this.isPreparingVoting=!1,this.hidePrepareVotingLayoutComponent()},e.prototype.createVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,k$(this.votingManagementSubService.createVoting(e))];case 1:if(null!==(t=n.sent())[0])throw t[0];return this.currentVotingDetailData=t[1],this.startUpdatePluginButtonStatusTip(),[2]}}))}))},e.prototype.extendDuration=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:if(null===this.currentVotingDetailData)throw new Error("currentVotingDetailData is null");return null===this.currentVotingDetailData.duration?[2]:(this.updateCurrentVotingDetailData({duration:this.currentVotingDetailData.duration+t}),[4,k$(this.votingManagementSubService.extendDuration(e,t))]);case 1:if(null!==(n=i.sent()[0]))throw this.updateCurrentVotingDetailData({duration:this.currentVotingDetailData.duration-t}),n;return[2]}}))}))},e.prototype.deleteVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,k$(this.votingManagementSubService.deleteVoting(e))];case 1:if(null!==(t=n.sent()[0]))throw t;return this.removeFromHistoryVotingList(e),[2]}}))}))},e.prototype.getVotingDetailData=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,k$(this.votingManagementSubService.getVotingDetailData(e))];case 1:if(null!==(t=n.sent())[0])throw t[0];return[2,t[1]]}}))}))},e.prototype.getHistoryVotingList=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,k$(this.votingManagementSubService.getHistoryVotingList())];case 1:if(null!==(e=t.sent())[0])throw e[0];return this.historyVotingList=e[1],[2]}}))}))},e.prototype.joinVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return[4,k$(this.votingManagementSubService.joinVoting(e))];case 1:if(null!==(t=n.sent())[0])throw t[0];return[2,t[1]]}}))}))},e.prototype.leaveVoting=function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:if(null===this.currentVotingSession)throw new Error("currentVotingSession is null");return[4,k$(this.currentVotingSession.leaveVoting(e))];case 1:if(null!==(t=n.sent())[0])throw t[0];return[2]}}))}))},e.prototype.setElementSnapshot=function(e,t,n){return A(this,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return[4,k$(this.votingManagementSubService.setElementSnapshot(e,t,n))];case 1:if(null!==(i=r.sent())[0])throw i[0];return this.updateVotingElementSnapshot(e,t,n),[2]}}))}))},e.prototype.submitVoteResult=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:if(null===this.currentVotingDetailData)throw new Error("currentVotingDetailData is null");if(this.currentVotingDetailData.id!==e)throw new Error("invalid voting id");if(null===this.currentVotingSession)throw new Error("currentVotingSession is null");if(null===this.currentVotingSession)throw new Error("currentVotingSession is null");return[4,k$(this.currentVotingSession.submitVoteResult(t))];case 1:if(null!==(n=i.sent())[0])throw n[0];return this.updateSelfVoteResultForCurrentVotingDetailData(t),this.updateVoteResultForCurrentVotingDetailData(t),[2]}}))}))},e.prototype.endVoting=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,k$(this.votingManagementSubService.endVoting(e))];case 1:return t.sent()[0],this.updateCurrentVotingDetailData({status:NJ.Ended}),this.addCurrentVotingDetailDataToHistoryVotingList(),null!==this.currentVotingDetailData&&(this.showVotingEndedNotification(this.currentVotingDetailData),this.currentVotingDetailData=null),[2]}}))}))},e.prototype.showVotingLayoutComponent=function(){this.hideVotingLayoutComponent();var e=this.upime.phoneMode?C0:y0;this.votingLayoutComponentId=this.upime.addSdkPluginCmp(e,"votingPlugin")},e.prototype.hideVotingLayoutComponent=function(){null!==this.votingLayoutComponentId&&(this.upime.removeSdkPluginCmp(this.votingLayoutComponentId),this.votingLayoutComponentId=null)},e.prototype.callbackAutoJoinVotingResult=function(e,t){var n,i;try{this.config.autoJoinId===e&&(null===(i=(n=this.config).onJoinVoting)||void 0===i||i.call(n,{voteId:e,success:t}))}catch(e){}},e.prototype.callbackLeaveForAutoJoinVoting=function(e){var t,n;if(!1===this.alreadyCallbackLeaveForAutoJoinVoting){this.alreadyCallbackLeaveForAutoJoinVoting=!0;try{e===this.config.autoJoinId&&(null===(n=(t=this.config).didLeaveVoting)||void 0===n||n.call(t,{voteId:e}))}catch(e){}}},e.prototype.startVoting=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r;return D(this,(function(o){switch(o.label){case 0:if(!0===this.isVoting)throw new Error("isVoting is true");if(null===this.currentVotingDetailData)throw new Error("currentVotingDetailData is null");if(this.currentVotingDetailData.id!==e)throw new Error("invalid voting id");return[4,k$(this.joinVoting(e))];case 1:if(null!==(t=o.sent())[0])throw t[0];return(n=new e0(this.upime,this,t[1])).start(),this.currentVotingSession=n,i=this.currentVotingDetailData,r=this.voteCtrl.startVote({area:i.area,elements:i.elements.map((function(e){return{elementId:e.elementId}})),tickets:i.tickets,refPositions:i.relatedParents}),this.votingWidget=r,this.isVoting=!0,this.showVotingLayoutComponent(),[2]}}))}))},e.prototype.stopVoting=function(e){var t;return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:if(!1===this.isVoting)throw new Error("isVoting is false");if(null===this.currentVotingSession)throw new Error("currentVotingSession is null");return[4,k$(this.leaveVoting(e))];case 1:return n.sent(),null===(t=this.currentVotingSession)||void 0===t||t.destroy(),this.currentVotingSession=null,this.voteCtrl.clearWrok(),this.isVoting=!1,this.hideVotingLayoutComponent(),this.callbackLeaveForAutoJoinVoting(e),[2]}}))}))},e.prototype.startViewVotingResult=function(e){return A(this,void 0,void 0,(function(){var t,n=this;return D(this,(function(i){if(!0===this.isViewingVotingResult)throw new Error("isViewingVotingResult is true");return t=this.currentViewVotingResultProcessId+1,this.currentViewVotingResultProcessId=t,this.getVotingDetailData(e).then((function(e){if(n.currentViewVotingResultProcessId===t&&!1!==n.isViewingVotingResult){n.currentVotingDetailDataForViewResult=e;var i=n.voteCtrl.displayVoteResult({area:e.area,refPositions:e.relatedParents,results:e.results});n.displayResultWidget=i,e.status===NJ.Created&&n.joinVoting(e.id).then((function(e){if(n.currentViewVotingResultProcessId===t&&!1!==n.isViewingVotingResult){var i=new e0(n.upime,n,e);i.start(),n.currentVotingSession=i}})).catch((function(){}))}})).catch((function(e){n.currentViewVotingResultProcessId===t&&!1!==n.isViewingVotingResult&&n.eventManager.publish("getVotingDetailDataFailed",void 0)})),!0===this.upime.phoneMode?(this.isShowingDrawer=!0,this.upime.showPhoneDrawer(F0,{upime:this.upime,panelType:"detail",onClose:function(){n.upime.closePhoneDrawer()}},{closedCB:function(){if(n.currentViewVotingResultProcessId===t){n.isShowingDrawer=!1;var e=n.currentVotingDetailDataForViewResult;null!==e&&n.stopViewVotingResult(e.id,t)}}})):this.upime.switchRightSlideExtension(z0,!0,{panelType:"detail",onDetailPanelClosed:function(){if(z0.toolPanelProps=void 0,n.currentViewVotingResultProcessId===t){var e=n.currentVotingDetailDataForViewResult;null!==e?n.stopViewVotingResult(e.id,t):n.isViewingVotingResult=!1}}}),this.isViewingVotingResult=!0,[2]}))}))},e.prototype.stopViewVotingResult=function(e,t){var n;return A(this,void 0,void 0,(function(){return D(this,(function(i){if(!1===this.isViewingVotingResult)throw new Error("isViewingVotingResult is false");return this.leaveVoting(e).catch((function(){})),this.currentViewVotingResultProcessId===t&&(this.voteCtrl.clearWrok(),null===(n=this.currentVotingSession)||void 0===n||n.destroy(),this.currentVotingSession=null,this.currentVotingDetailDataForViewResult=null,this.isViewingVotingResult=!1),[2]}))}))},e.prototype.getInviteVotingUrl=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o=this;return D(this,(function(a){switch(a.label){case 0:return[4,k$(new Promise((function(i,r){var a,s;try{null===(s=(a=o.config).getInviteVotingUrl)||void 0===s||s.call(a,{voteId:e,creator:t,voteName:n}).then(i).catch(r)}catch(e){r(e)}})))];case 1:return null!==(i=a.sent())[0]||Xd(r=i[1],{onCopy:function(e){o.upime.addToast(O("voting.invitation.copy.success"),{type:"normal"}),e.setData("text/plain",r)}}),[2]}}))}))},e.prototype.showVotingQrCode=function(e){var t,n;null===(n=(t=this.config).showVotingQrCode)||void 0===n||n.call(t,{voteId:e})},e.prototype.destroy=function(){this.reset()},M([rl],e.prototype,"currentVotingDetailData",void 0),M([rl],e.prototype,"historyVotingList",void 0),M([rl],e.prototype,"currentVotingDetailDataForViewResult",void 0),M([il],e)}();var H0=function(){var t=e.useContext(FF).eventCenter,n=Sl("votingPlugin"),i=n.upime,r=e.useState(z0.hasStatusTip),o=r[0],a=r[1],s=e.useState(z0.statusTipType),l=s[0],c=s[1],u=e.useState(z0.badgeTipContent),d=u[0],p=u[1];return e.useEffect((function(){var e=z0.eventManager;if(void 0!==e){var t=[e.subscribe("hasStatusTipUpdated",(function(e){a(e)})),e.subscribe("statusTipTypeUpdated",(function(e){c(e)})),e.subscribe("badgeTipContentUpdated",(function(e){p(e)}))];return function(){t.forEach((function(e){return e()}))}}}),[]),e.createElement("div",{className:"container_3i2xm",onClick:function(){n.isShowingDrawer=!0,i.showPhoneDrawer(F0,{upime:i,panelType:"list",onClose:function(){i.closePhoneDrawer()}},{closedCB:function(){n.isShowingDrawer=!1}}),t.publish("closeBottomPane",[])}},e.createElement(hl,{icon:"toupiao",className:"icon_NtjPv"}),!0===o&&e.createElement(e.Fragment,null,"badge"===l&&e.createElement("div",{className:"badgeTip_3Mns2"},null!=d?d:""),"dot"===l&&e.createElement("div",{className:"dotTip_1oiDz"})))};function U0(t){var n,i=t.upime,r=t.children;e.useContext(Ic).extensionConfigs.meeting,al(i,["t_timerActive"]);var o=i.meetingMode,a=i.t_timerActive,s=!0===(null===(n=i.customFoldableTools)||void 0===n?void 0:n.some((function(e){return e.key===z0.key})));return e.createElement("div",{className:j("row_2R3Cj","largeTop_2mPo5")},e.createElement("div",{className:"titleBar_1XgM3"},r),s&&e.createElement(H0,null),o&&a&&e.createElement("div",{className:"timerIconContainer_2H_dH"},e.createElement(EQ,null)),e.createElement(jX,{upime:i}))}function W0(t){var n=t.upime;return e.createElement("div",{className:j(WJ,"mb4_13Hl3",VJ)},e.createElement(uJ,{upime:n}))}function V0(e){var t=e.getViewbox();return _e.isIphoneLike?{x:(t.left+t.right)/2,y:Rn(t.top,t.bottom,.75)}:{x:(t.left+t.right)/2,y:Rn(t.top,t.bottom,.25)}}function j0(e,t){var n=e.view,i=n.x,r=n.y,o=n.viewHeight,a=n.scale,s=n.getViewbox();t.getGlobalBox().top>s.bottom&&e.setViewPosScale(i,r+.5*o/a)}function G0(e,t,n,i,r){return A(this,void 0,void 0,(function(){var o,a,s,l,c;return D(this,(function(u){return r(!0),e.switchMode("shape"),o=n||V0(e.view),a=e.insertShapeAt(o,t.type,!0,!1),j0(e,a),s=a.getGlobalBox(),l=s.bottom+10,c=s.bottom-s.top+l,i({x:(s.left+s.right)/2,y:(l+c)/2}),r(!1),[2]}))}))}function q0(t){var n=t.upime;return al(n,["xmode","editable","meetingMode"]),e.createElement("div",{className:j(WJ,"comment"===n.xmode&&jJ),onClick:function(){n.switchMode("comment"===n.xmode?"select":"comment")}},e.createElement(hl,{icon:"chuangjianpizhu"}))}function K0(t){var n=t.upime,i=t.showIcon;al(n,["xmode","editable","meetingMode"]);var r=e.useContext(Ic).setShowToolbarSubwindow,o=e.useState(1),a=o[0],s=o[1];function l(e){s(e),r(1!==e)}var c=e.useState(null),u=c[0],d=c[1],p=e.useRef(null);function h(e){p.current=e}var f=e.useRef(!1);function m(e){f.current=e}return e.useEffect((function(){var e=!1,t=0;function i(){e=!0,clearTimeout(t),t=window.setTimeout((function(){e=!1}),500)}window.addEventListener("resize",i);var r=n.view.subscribe("viewboxChange",(function(){e||f.current||h(null)})),o=n.subscribe("xmodechange",(function(){h(null)}));return function(){r(),o(),clearTimeout(t),window.removeEventListener("resize",i)}}),[]),e.useEffect((function(){"view"===n.xmode&&1!==a&&l(1)}),[n.xmode]),!n.meetingMode&&n.userManager.commentOnlyMode?i?e.createElement(q0,{upime:n}):null:"commentor"===n.meetingMode?e.createElement(q0,{upime:n}):n.editable?3===a&&u?e.createElement(u,{upime:n,onClose:function(){return l(1)},insertBasePoint:p.current,setBasePoint:h,setViewboxChangePaused:m}):e.createElement(e.Fragment,null,i&&e.createElement("div",{className:j(WJ,"large_1Hh64","activeBgContainer_QhU9l"),onClick:function(){return l(2)}},e.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"svgIconJia_2rVUt"},e.createElement("g",{fill:"none",fillRule:"evenodd"},e.createElement("path",{d:"M0 0h24v24H0z"}),e.createElement("path",{"data-follow-fill":"#ffffff",d:"M12 5a1 1 0 0 1 1 1v5h5a1 1 0 0 1 0 2h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5V6a1 1 0 0 1 1-1Z",fill:"#ffffff"})))),e.createElement(Y0,{upime:n,hide:2!==a,onClose:function(){return l(1)},setBasePoint:h,insertBasePoint:p.current,setViewboxChangePaused:m,setSubPane:function(e){d((function(){return e})),l(3)}})):null}function Y0(t){var n=t.upime,i=t.onClose,r=t.hide,o=t.insertBasePoint,a=t.setBasePoint,s=t.setViewboxChangePaused,l=t.setSubPane;e.useEffect((function(){return n.userEventManager.subscribe("click",i)}),[]);var c=e.useContext(FF).eventCenter;e.useEffect((function(){return null==c?void 0:c.subscribe("closeBottomPane",i)}),[]);var u=e.useState(r),d=u[0],p=u[1];e.useEffect((function(){r||p(!1)}),[r]);var h=W().getUpimeTrans,f=e.useMemo((function(){var e={name:h("toolbar.pen"),icon:"huabi",umengEvtId:"cv_pen",action:function(){return m(J0)}},t={name:h("toolbar.sticker"),icon:"bianqian",umengEvtId:"cv_stickynote",action:function(){return i(),function(e,t,n,i){return A(this,void 0,void 0,(function(){var r,o,a,s,l;return D(this,(function(c){return i(!0),e.switchMode("sticker"),r=t||V0(e.view),o=e.insertStickerAt(r,!0,!1),j0(e,o),a=o.getGlobalBox(),s=a.bottom+10,l=a.bottom-a.top+s,n({x:(a.left+a.right)/2,y:(s+l)/2}),i(!1),[2]}))}))}(n,o,a,s)}},r={name:h("toolbar.text"),icon:"wenben",umengEvtId:"cv_text",action:function(){return i(),function(e,t,n,i){return A(this,void 0,void 0,(function(){var r,o,a,s,l;return D(this,(function(c){return i(!0),e.switchMode("text"),r=t||V0(e.view),o=e.insertTextAt(r),j0(e,o),a=o.getGlobalBox(),s=a.bottom+10,l=a.bottom-a.top+s,n({x:a.left,y:(s+l)/2}),i(!1),[2]}))}))}(n,o,a,s)}},l={name:h("toolbar.shape"),icon:"xingzhuang",umengEvtId:"cv_shape",notScaleDependent:!0,action:function(){return m(Z0)}},c={name:h("toolbar.connectLine"),icon:"lianjiexian-8khgj6jg",umengEvtId:"cv_line",action:function(){return m(Q0)}},u={name:h("toolbar.frame"),icon:"huaban",umengEvtId:"cv_frame",action:function(){return i(),function(e,t,n,i){i(!0);var r=t||V0(e.view),o=0,a=0;if(0===e.elementManager.getFrames().length)o=e.view.width/2,a=e.view.height/2;else{var s=e.elementManager.sequentialFrames,l=Rt(s[s.length-1].getGlobalBox());o=l.width,a=l.height}var c=e.createOperation(),u={x:r.x-o/2,y:r.y-a/2},d=c.create(Za.FRAME,{position:u,type:"custom",name:O("frame.title"),size:{width:o,height:a},hasBg:!0,bgColor:je[0],showDB:!1,hide:!1}),p=e.createLock([d.id]);c.sync(),e.clearLock(p),e.selectElement(d);var h=d.getGlobalBox(),f=h.bottom+10,m=h.bottom-h.top+f;return n({x:(h.left+h.right)/2,y:(f+m)/2}),new Promise((function(t){fr((function(){e.makeBorderCenter(h,{left:80,right:80,bottom:12,top:12}).finally((function(){i(!1),t(void 0)}))}))}))}(n,o,a,s)}},d={name:h("toolbar.comment"),icon:"chuangjianpizhu",umengEvtId:"cv_comment",action:function(){return n.switchMode("comment"),i(),Promise.resolve()}},p={name:h("toolbar.upload"),icon:"shangchuan",umengEvtId:"cv_upload",action:function(){return i(),function(e){A(this,void 0,void 0,(function(){return D(this,(function(t){return iU(MK.file,!0,(function(t){e.insertFiles(t)})),[2]}))}))}(n),Promise.resolve()}};return[e,t,r,l,c,u,d,p]}),[o]);function m(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return l(e),[2]}))}))}return d?null:e.createElement("div",{onClick:function(e){return e.stopPropagation()},onTransitionEnd:function(){r&&p(!0)},className:j(GJ,r&&qJ)},f.map((function(t,i){return e.createElement(X0,{key:i,upime:n,item:t})})))}function X0(t){var n=t.item,i=t.upime,r=zF().setIsShowScaleShow;return e.createElement("div",{className:KJ,onClick:function(){var e;return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return _c(n.umengEvtId),"comment"===i.xmode&&i.switchMode("select"),n.notScaleDependent?(null===(e=n.action)||void 0===e||e.call(n),[2]):n.action?(r(!1),[4,n.action()]):[3,2];case 1:t.sent(),r(!0),t.label=2;case 2:return[2]}}))}))}},e.createElement(hl,{className:YJ,icon:n.icon}),e.createElement("div",null,n.name))}function Q0(t){var n=t.upime,i=t.onClose;e.useEffect((function(){return n.userEventManager.subscribe("click",i)}),[]);var r=e.useContext(FF).eventCenter;function o(e,t,r){_c("cv_line_use",{type:r}),function(e,t,n){A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c;return D(this,(function(u){return i={lineType:t,startArrow:0,endArrow:n},r=e.view.getViewbox(),o={x:Rn(r.left,r.right,.1),y:Rn(r.top,r.bottom,.5)},a={x:Rn(r.left,r.right,.9),y:Rn(r.top,r.bottom,.5)},s=exports.E(exports.E(exports.E(exports.E({},gx.getDefaultLineConfig()),{position:{x:0,y:0},startPosition:o,endPosition:a}),i),{zIndex:e.newMaxZindex()}),l=e.createOperation(),c=l.create(Za.CONNECTIONLINE,s),l.sync(),e.selectElement(c),[2]}))}))}(n,e,t),i()}return e.useEffect((function(){return null==r?void 0:r.subscribe("closeBottomPane",i)}),[]),e.createElement("div",{onClick:function(e){return e.stopPropagation()},className:j(GJ,XJ)},e.createElement("div",{className:QJ,onClick:function(){return o(1,0,"zhixian-new")}},e.createElement(hl,{icon:"zhixian-new"})),e.createElement("div",{className:QJ,onClick:function(){return o(1,1,"lianjiexian")}},e.createElement(hl,{icon:"lianjiexian"})),e.createElement("div",{className:QJ,onClick:function(){return o(2,1,"zhexian-new")}},e.createElement(hl,{icon:"zhexian-new"})),e.createElement("div",{className:QJ,onClick:function(){return o(3,1,"quxianjiantou")}},e.createElement(hl,{icon:"quxianjiantou"})),e.createElement("div",{className:QJ,onClick:function(){return o(4,0,"quxianjiantou")}},e.createElement(hl,{icon:"fat-arrow"})))}function Z0(t){var n=t.upime,i=t.onClose,r=t.insertBasePoint,o=t.setBasePoint,a=t.setViewboxChangePaused;e.useEffect((function(){return n.userEventManager.subscribe("click",i)}),[]);var s=e.useContext(FF).eventCenter;e.useEffect((function(){return null==s?void 0:s.subscribe("closeBottomPane",i)}),[]);var l=zF().setIsShowScaleShow;return e.createElement("div",{onClick:function(e){return e.stopPropagation()},className:j(GJ,XJ)},yK.map((function(t,s){return e.createElement("div",{onClick:function(){return function(e){return A(this,void 0,void 0,(function(){var t;return D(this,(function(s){switch(s.label){case 0:return t=yK[e],_c("cv_shape_use",{shapeName:t.name}),l(!1),[4,G0(n,t,r,o,a)];case 1:return s.sent(),l(!0),i(),[2]}}))}))}(s)},className:QJ,key:s},e.createElement(hl,{icon:t.icon}))})))}function J0(t){var n=t.upime,i=t.onClose,r=e.useContext(FF).eventCenter;e.useEffect((function(){return null==r?void 0:r.subscribe("closeBottomPane",i)}),[]);var o=W().getUpimeTrans,a=e.useReducer((function(e){return e+1}),0)[1],s=e.useState(!1),l=s[0],c=s[1],u=e.useRef(0),d=n.getCurrentPenType();e.useEffect((function(){return f(0),function(){var e="view"===n.xmode?"view":"select";n.switchMode(e)}}),[]);var p=[{icon:"huabi",type:Ya.NORMAL,umengEvtType:"pen"},{icon:"yingguangbi",type:Ya.MARK,umengEvtType:"markPen"},{icon:"zhinengtuhang",type:Ya.SMART,umengEvtType:"smartdraw"}];function h(){return n.getDrawPens()[p[u.current].type][0]}function f(e){u.current=e;var t=p[e];_c("cv_pen_use",{type:t.umengEvtType});var i=n.getDrawPens()[t.type][0];n.setDrawLingStyle(i),n.setCurPenType(t.type),n.switchMode("draw"),a()}var m=h();return e.createElement("div",{onClick:function(e){return e.stopPropagation()},className:j(ZJ)},e.createElement("div",{className:j(JJ)},p.map((function(t,i){return e.createElement("div",{onClick:function(){return f(i)},key:i,className:$J},e.createElement(hl,{className:j(e$,"eraser"!==n.xmode&&"laser"!==n.xmode&&d===t.type&&jJ),icon:t.icon}))})),e.createElement("div",{className:$J,onClick:function(){n.switchMode("eraser"),_c("cv_pen_use",{type:"xiangpica"}),c(!1)}},e.createElement(hl,{className:j(e$,"eraser"===n.xmode&&jJ),icon:"xiangpica"})),"eraser"!==n.xmode&&"laser"!==n.xmode&&m?e.createElement(e.Fragment,null,e.createElement("div",{className:m$}),e.createElement("div",{className:o$,onClick:function(){c(!l)}},e.createElement("div",{className:a$,style:{backgroundColor:hr(m.lineColor,m.lineOpacity),width:"".concat(Math.max(1,m.lineWidth*(26/30)),"px"),height:"".concat(Math.max(1,m.lineWidth*(26/30)),"px")}},e.createElement("div",{className:s$})))):null,e.createElement("div",{className:$J,style:{marginLeft:"8px"},onClick:function(){return i()}},e.createElement(hl,{className:j(e$),icon:"guanbi"}))),l&&e.createElement("div",{className:t$},e.createElement("div",{className:n$},e.createElement(nE,{defaultValue:m.lineWidth/28,onChanged:function(e){var t=30*e;n.setPenStyles(n.getCurrentPenType(),0,{lineWidth:t}),n.setDrawLingStyle(exports.E(exports.E({},h()),{lineWidth:t})),a()}}),e.createElement("div",{className:r$},o("toolbar.lineWidth"))),e.createElement("div",{className:j(l$,i$)},n.userManager.userPalette.map((function(t,i){return e.createElement("div",{onClick:function(){return e=t,n.setPenStyles(n.getCurrentPenType(),0,{lineColor:e}),n.setDrawLingStyle(exports.E(exports.E({},h()),{lineColor:e})),a(),void c(!1);var e},key:i,className:j(c$,m.lineColor===t&&u$),style:{background:$0(t)}})})))))}function $0(e){return null===e?"#ffffff":pr(e)}function e1(){e.useEffect((function(){var e=function(e){_e.isTouchSupported="mouse"!==e.pointerType,_e.isHoverSupported="mouse"===e.pointerType};return document.addEventListener("pointerover",e,{capture:!0}),function(){document.removeEventListener("pointerover",e,{capture:!0})}}),[])}function t1(t){var n=t.upime,i=zF().isShowScaleShow,r=e.useRef();return e.useEffect((function(){if(i){var e=n.view.scale;return n.view.subscribe("viewboxChange",(function(t){var i=t.scale;if(e!==i){e=i;var o="".concat((100*i).toFixed(0),"%");r.current=n.updateOrAddToastContent(o,r.current,{top:64,style:{padding:"2px 10px",zIndex:20}})}}))}r.current&&n.removeToast(r.current)}),[i]),null}function n1(t){var n=t.upime,i=e.useState(!1),r=i[0],o=i[1];return e.createElement(e.Fragment,null,e.createElement("div",{className:j(WJ,VJ),onClick:function(){return o(!0)}},e.createElement(hl,{icon:"ditu"})),r&&e.createElement(i1,{upime:n,onClose:function(){return o(!1)}}))}function i1(t){var n=t.upime,i=t.onClose;e.useEffect((function(){return n.userEventManager.subscribe("click",i)}),[]);var r=e.useContext(FF).eventCenter;return e.useEffect((function(){return null==r?void 0:r.subscribe("closeBottomPane",i)}),[]),e.createElement("div",{className:d$},e.createElement("div",{className:p$},e.createElement(CY,{map:n.elementMap})))}function r1(t){var n=t.upime,i=e.useState(!1),r=i[0],o=i[1],a=e.useState(!1),s=a[0],l=a[1],c=e.useContext(Ic),u=c.showElementBar,d=c.showToolbarSubwindow;return e.useEffect((function(){r&&!s&&l(!0)}),[r]),d?null:e.createElement(e.Fragment,null,!u&&e.createElement("div",{className:WJ,onClick:function(){return o((function(e){return!e}))}},e.createElement("div",{className:"aIButtonImage_1OYpy",style:{background:"url(".concat($o("ai_button.png"),")"),backgroundSize:"100% 100%"}})),s&&e.createElement(o1,{upime:n,hide:!r,onClose:function(){return o(!1)}}))}function o1(t){var n=t.upime,i=t.onClose,r=t.hide;e.useEffect((function(){return n.userEventManager.subscribe("click",i)}),[]);var o=e.useContext(FF).eventCenter;e.useEffect((function(){return null==o?void 0:o.subscribe("closeBottomPane",i)}),[]);var a=n.chatgptConfig;return a?e.createElement("div",{className:j(h$,r&&f$)},e.createElement(HF,{config:a,hide:r,onClose:i,upime:n})):null}function a1(t){var i=t.rtcChannel,r=t.rtcSource,o=t.detached,a=t.onClick,s=t.landscape;al(i,["remoteMicVolumes"]);var l=r.userInfo,c=W().getUpimeTrans,u=i.topRtcUser===r.userInfo.loginName,d=e.useRef(null),p=e.useRef(null),h=e.useRef(null);e.useEffect((function(){d.current&&function(){if(s){var e=(document.documentElement.clientHeight-76)/4;d.current.style.height=e+"px",d.current.style.width=1.5*e+"px"}else{var t=(document.documentElement.clientWidth-80)/3;d.current.style.width=t+"px",d.current.style.height=t/1.5+"px"}}()}),[s]),e.useEffect((function(){if((r.video||r.screenShare)&&!o)return-1===r.mediaId?i.startLocalPreview(p.current):i.subscribeRemote(r.mediaId,"video",p.current,n.RemoteStreamType.LOW_STREAM),function(){(r.video||r.screenShare)&&(-1!==r.mediaId?i.unsubscribeRemote(r.mediaId,"video"):i.stopLocalPreview())}}),[r.video,r.screenShare,o,s]),e.useEffect((function(){var e,t=-1===r.mediaId?null===(e=i.rtcIns)||void 0===e?void 0:e.geRtcEngine().uid:r.mediaId,n=i.remoteMicVolumes.find((function(e){return e.uid===t}));n&&h.current&&(h.current.style.height=.1*n.level+"px")}),[i.remoteMicVolumes]);var f=o||!r.video&&!r.screenShare;return e.createElement("div",{ref:d,className:j(Gj,o&&Kj),onClick:a},f?e.createElement(ml,{shape:"circle",url:l.avatarUrl,className:Rj}):e.createElement("div",{ref:p,className:Aj}),e.createElement("div",{className:Yj},i.screenSharer&&i.screenSharer===l.loginName?e.createElement(e.Fragment,null,e.createElement("div",{className:Uj},e.createElement(hl,{icon:"gongxiangpingmu"})),e.createElement("span",null,-1===r.mediaId?"".concat(c("common.you")):l.meetingName+" ",c("meeting.screen.share.going"))):e.createElement(e.Fragment,null,e.createElement(u1,{rtcChannel:i,rtcSource:r}),e.createElement("div",{className:j(Qj)},r.audio?e.createElement(e.Fragment,null,e.createElement(hl,{icon:"maikefeng-kai"}),e.createElement("div",{className:Oj,ref:h})):e.createElement(hl,{icon:"maikefeng-guan-new"})),e.createElement("span",null,l.meetingName,-1===r.mediaId?"(".concat(c("common.me"),")"):""))),u&&e.createElement("div",{className:qj},e.createElement(hl,{icon:"zhiding"})))}function s1(t){var n=t.rtcChannel,i=t.rtcSource;return e.useEffect((function(){return i.audio&&-1!==i.mediaId&&n.subscribeRemote(i.mediaId,"audio"),function(){-1!==i.mediaId&&n.unsubscribeRemote(i.mediaId,"audio")}}),[i.audio]),null}function l1(t){var n=this,i=t.rtcChannel,r=t.onBack,o=t.landscape,a=e.useRef(null),s=e.useRef(null),l=W().getUpimeTrans;al(i,["localMemberState","remoteMemberStates","topRtcUser","screenSharer","hostId","localVideoEnabled","localAudioSuspending","localMicVolume"]);var c=e.useContext(xl).upime,u=e.useMemo((function(){var e,t,n=i.localMemberState,r=i.remoteMemberStates,o=i.topRtcUser,a=i.screenSharer,s=i.hostId,l=[exports.E({},n)],c=[];if(Object.values(r).forEach((function(n){if(n.userInfo.loginName!==o){var i=exports.E(exports.E({},n),{video:n.video,audio:n.audio,screenShare:n.screenShare});n.userInfo.loginName===a?e=i:n.userInfo.loginName===s?t=i:c.push(i)}})),e&&l.push(e),t&&l.push(t),l.push.apply(l,c),o&&o!==n.userInfo.loginName){var u=r[o];u&&l.unshift(exports.E({},u))}return l}),[i.localMemberState,i.remoteMemberStates,i.topRtcUser,i.screenSharer,i.hostId]),d=o?4:3,p=e.useState(i.screenSharer||i.defaultSelectedUserOnPhone),h=p[0],f=p[1],m=u.length>d,v=e.useState(0),g=v[0],y=v[1],b=u.slice(g,g+d),E=u.find((function(e){return e.userInfo.loginName===h}))||u[0],x=g>0,w=u.length-g>d;e.useEffect((function(){if(E.video||E.screenShare)return-1===E.mediaId?i.startLocalPreview(s.current):i.subscribeRemote(E.mediaId,"video",s.current),function(){if(-1!==E.mediaId?i.unsubscribeRemote(E.mediaId,"video"):i.stopLocalPreview(),s.current)for(var e=s.current;e.lastChild;)e.removeChild(e.lastChild)}}),[h,E.video,E.screenShare,o]);var C=i.localAudioEnabled?"maikefeng-kai":"maikefeng-guan-new",S=i.localVideoEnabled?"shexiangtou-kai":"shexiangtou-guan-new",k=e.useRef(null),_=function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return i.clearReachHostLimit(),i.micPermDenied?[4,c.showWindow(EV,null,!1,!0)]:[3,2];case 1:return e.sent(),i.deviceHelpLink&&window.open(i.deviceHelpLink),[3,3];case 2:i.localAudioEnabled?i.disableLocalAudio():i.enableLocalAudio(),e.label=3;case 3:return[2]}}))}))},T=function(){return A(n,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return i.clearReachHostLimit(),i.camPermDenied?[4,c.showWindow(EV,null,!1,!0)]:[3,2];case 1:return e.sent(),i.deviceHelpLink&&window.open(i.deviceHelpLink),[3,3];case 2:i.localVideoEnabled?i.disableLocalVideo():i.enableLocalVideo(),e.label=3;case 3:return[2]}}))}))};return e.useEffect((function(){k.current&&(k.current.style.height="".concat(14*i.localMicVolume,"px"))}),[i.localMicVolume]),o?e.createElement("div",{className:"detachedBoxLandscape_2kfdO"},e.createElement("div",{className:Mj},e.createElement("div",{className:Dj},e.createElement(ml,{shape:"circle",url:E.userInfo.avatarUrl,className:Rj})),e.createElement("div",{ref:s,className:Aj}),e.createElement("div",{className:Bj},e.createElement("div",{className:j(Lj),onClick:_},e.createElement(hl,{icon:C}),e.createElement("div",{className:j(Oj),ref:k})),e.createElement("div",{className:Fj}),e.createElement("div",{className:j(zj),onClick:T},e.createElement(hl,{icon:S}))),e.createElement("div",{className:Hj},e.createElement("span",null,e.createElement(hl,{icon:"fanhui",onClick:r}),e.createElement("span",null,l("common.backtocvs"))))),e.createElement("div",{className:Wj},m&&e.createElement("div",{className:Vj,onClick:function(){x&&y(g-1)}},e.createElement("div",{className:j(_j,Ij,x?"":Nj)},e.createElement(hl,{icon:"shuangshang"}))),e.createElement("div",{ref:a,className:jj},b.map((function(t){return e.createElement(a1,{rtcChannel:i,key:t.mediaId,rtcSource:t,detached:t.userInfo.loginName===h,onClick:function(){f(t.userInfo.loginName)},landscape:o})}))),m&&e.createElement("div",{className:Vj,onClick:function(){w&&y(g+1)}},e.createElement("div",{className:j(_j,Pj,w?"":Nj)},e.createElement(hl,{icon:"shuangshang",style:{transform:"rotate(180deg)"}}))))):e.createElement("div",{className:"detachedBoxPortrait_3RTFQ"},e.createElement("div",{className:Hj},e.createElement("span",null,e.createElement(hl,{icon:"fanhui",onClick:r}),e.createElement("span",null,l("common.backtocvs")))),e.createElement("div",{className:Wj},m&&e.createElement("div",{className:Vj,onClick:function(){x&&y(g-1)}},e.createElement("div",{className:j(_j,Ij,x?"":Nj)},e.createElement(hl,{icon:"shuangshang",style:{transform:"rotate(-90deg)"}}))),e.createElement("div",{ref:a,className:jj},b.map((function(t){return e.createElement(a1,{rtcChannel:i,key:t.mediaId,rtcSource:t,detached:t.userInfo.loginName===h,onClick:function(){f(t.userInfo.loginName)},landscape:o})}))),m&&e.createElement("div",{className:Vj,onClick:function(){w&&y(g+1)}},e.createElement("div",{className:j(_j,Pj,w?"":Nj)},e.createElement(hl,{icon:"shuangshang",style:{transform:"rotate(90deg)"}})))),e.createElement("div",{className:Mj},e.createElement("div",{className:Dj},e.createElement(ml,{shape:"circle",url:E.userInfo.avatarUrl,className:Rj})),e.createElement("div",{ref:s,className:Aj})),e.createElement("div",{className:Bj},e.createElement("div",{className:j(Lj),onClick:_},e.createElement(hl,{icon:C}),e.createElement("div",{className:j(Oj),ref:k})),e.createElement("div",{className:Fj}),e.createElement("div",{className:j(zj),onClick:T},e.createElement(hl,{icon:S}))))}var c1=function(t){t.upime;var n=t.rtcChannel;al(n,["rtcJoined","localMemberState","remoteMemberStates"]);var i=e.useState((function(){return n.screenSharer?3:2})),r=i[0],o=i[1],a=e.useState(be()),s=a[0],l=a[1];return e.useEffect((function(){var e=function(e){l(be())};return Ee()?window.addEventListener("orientationchange",e):window.addEventListener("resize",e),function(){Ee()?window.removeEventListener("orientationchange",e):window.removeEventListener("resize",e)}}),[]),e.useEffect((function(){n.screenSharer&&o(3)}),[n.screenSharer]),e.useEffect((function(){return n.subscribe("onOpenSharePage",(function(){o(3)}))}),[]),n.rtcJoined?e.createElement(e.Fragment,null,1===r&&e.createElement("div",{className:j("sideTogglePhone_3h6ss"),onClick:function(){o(2)}},e.createElement(hl,{icon:"jiantou-zuo"})),2===r&&e.createElement(d1,{landscape:s,rtcChannel:n,setMode:o}),3===r&&e.createElement("div",{className:j("enlargedVideoConPhone_1-pCU")},e.createElement(l1,{rtcChannel:n,onBack:function(){o(2)},landscape:s})),R([n.localMemberState],Object.values(n.remoteMemberStates),!0).map((function(t){return e.createElement(s1,{key:t.mediaId,rtcChannel:n,rtcSource:t})}))):null};function u1(t){var n=t.rtcChannel,i=t.rtcSource,r=W().getUpimeTrans,o="";if("meetingData"in n){var a=n;a.hostId===i.userInfo.loginName?o=r("meeting.identity.host"):a.curViewSrc===i.userInfo.loginName&&(o=r("meeting.identity.presenter"))}return o?e.createElement("div",{className:Xj},o):null}function d1(t){var i=t.rtcChannel,r=t.setMode,o=t.landscape;al(i,["remoteMicVolumes"]);var a=W().getUpimeTrans,s=e.useRef(null),l=e.useRef(null),c=e.useRef(null),u=e.useRef(),d=e.useRef(0),p=e.useMemo((function(){var e=i.localMemberState;if(i.remoteMicVolumes.length>0){var t=i.remoteMicVolumes[0],n=Object.values(i.remoteMemberStates).find((function(e){return e.mediaId===t.uid}));e=null!=n?n:i.localMemberState}else i.topRtcUser?i.remoteMemberStates[i.topRtcUser]&&(e=i.remoteMemberStates[i.topRtcUser]):e=i.localMemberState;return e}),[i.remoteMicVolumes]),h=function(e){-1===e.mediaId?i.stopLocalPreview():i.unsubscribeRemote(e.mediaId,"video")},f=function(e){var t;t=l.current,1===d.current?t.style.transform="translateY(-90px)":t.style.transform="translateY(0px)",e&&h(e),d.current=1-d.current};return e.useEffect((function(){var e;if(p.video||p.screenShare){var t=document.getElementById("v".concat(d.current));if(t){for(;t.lastChild;)t.removeChild(t.lastChild);-1===p.mediaId?(i.startLocalPreview(t),f(u.current),u.current=p):(i.subscribeRemote(p.mediaId,"video",t,n.RemoteStreamType.LOW_STREAM),null===(e=i.rtcIns)||void 0===e||e.onRemoteFirstFrameDecoded(p.mediaId,(function(){f(u.current),u.current=p})))}}else u.current&&h(u.current),d.current=0,u.current=void 0}),[p,p.video,p.screenShare]),e.useEffect((function(){var e;if(p){var t=-1===p.mediaId?null===(e=i.rtcIns)||void 0===e?void 0:e.geRtcEngine().uid:p.mediaId,n=i.remoteMicVolumes.find((function(e){return e.uid===t}));n&&s.current&&(s.current.style.height=.1*n.level+"px")}}),[i.remoteMicVolumes]),e.useEffect((function(){c.current&&c.current.resetDrag()}),[o]),e.createElement(Hc,{ref:c,className:"singboxContainer_3-fKD"},e.createElement("div",{className:"singleBox_23-03"},p.video||p.screenShare?e.createElement("div",{ref:l,className:Aj},e.createElement("div",{id:"v0"}),e.createElement("div",{id:"v1"})):e.createElement(ml,{shape:"circle",url:p.userInfo.avatarUrl,className:Rj}),e.createElement("div",{className:"actionBox_1iW_7"},e.createElement("div",{className:"minBox_3miMt",onClick:function(){r(1)}},e.createElement(hl,{icon:"zuixiaohua"})),e.createElement("div",{className:"maxBox_FIjO3",onClick:function(){r(3)}},e.createElement(hl,{icon:"zuidahua"}))),e.createElement("div",{className:Yj},i.screenSharer&&i.screenSharer===p.userInfo.loginName?e.createElement(e.Fragment,null,e.createElement("div",{className:Uj},e.createElement(hl,{icon:"gongxiangpingmu"})),e.createElement("span",null,-1===p.mediaId?"".concat(a("common.you")):p.userInfo.meetingName+" "),e.createElement("span",null,a("meeting.screen.share.going"))):e.createElement(e.Fragment,null,e.createElement(u1,{rtcChannel:i,rtcSource:p}),e.createElement("div",{className:j(Qj)},p.audio?e.createElement(e.Fragment,null,e.createElement(hl,{icon:"maikefeng-kai"}),e.createElement("div",{className:Oj,ref:s})):e.createElement(hl,{icon:"maikefeng-guan-new"})),e.createElement("span",null,p.userInfo.meetingName),e.createElement("span",null,-1===p.mediaId?"(".concat(a("common.me"),")"):""))),i.topRtcUser===p.userInfo.loginName&&e.createElement("div",{className:qj},e.createElement(hl,{icon:"zhiding"}))))}var p1="iconBox_Qa-eJ",h1="modalBox_2ixhQ",f1="header_v54Qo",m1="name_1rsrF",v1="body_3ohia";function g1(t){var n=t.fail,i=t.content,r=e.useRef(null);return e.useEffect((function(){var e=ne((function(){if(r.current){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;e<880?r.current.style.width="".concat(e-80,"px"):t<619&&(r.current.style.width="".concat(1.48*(t-80),"px"))}}),200);window.addEventListener("resize",e);var t=null==i?void 0:i.upime.subscribe("openToolbar",(function(e){var t=e.xmode;zK.includes(t)&&n("close")}));return function(){window.removeEventListener("resize",e),t&&t()}}),[]),e.createElement("div",{className:h1,ref:r},e.createElement("div",{className:f1},e.createElement("span",{className:m1},null==i?void 0:i.name),e.createElement("span",{className:p1,onClick:function(){n("close")}},e.createElement(hl,{icon:"guanbi"}))),e.createElement("div",{className:v1},e.createElement("video",{src:null==i?void 0:i.src,autoPlay:!0,controls:!0})))}function y1(t){var n=t.upime,i=n.videoGuide,r=i.desc,o=i.position,a=i.src,s=i.coverSrc;return e.useEffect((function(){function e(){n.videoGuide=null}return window.addEventListener("mousedown",e),function(){window.removeEventListener("mousedown",e)}}),[]),e.createElement("div",{className:"rootBox_36lvd",style:{left:o.x,top:o.y},onMouseDown:function(e){e.stopPropagation()}},e.createElement("div",{className:"coverBox_3PKEF",onMouseDown:function(){n.videoGuide=null,n.showWindow(g1,{src:a,name:r,upime:n},void 0,void 0,void 0)},style:{backgroundImage:"url(".concat(s,")")}},e.createElement("div",{className:"bofangBox_106rb"},e.createElement(hl,{icon:"bofang"})),e.createElement("div",{className:p1,onMouseDown:function(e){e.stopPropagation(),n.videoGuide=null}},e.createElement(hl,{icon:"guanbi"}))),e.createElement("div",{className:"descBox_11j-u"},e.createElement("span",null,r)))}var b1,E1=e.forwardRef((function(t,n){var i,r=this,o=e.useState((function(){return new $q(t)}))[0],a=e.useRef(null!==(i=t.userPreference)&&void 0!==i?i:{});al(o),e1(),e.useEffect((function(){return t.onReady&&t.onReady(),pl(),function(){o.destroy(),Yh=[]}}),[]),e.useEffect((function(){var e,n,i=t.userPreference;i&&(i.accessSetting&&i.accessSetting!==(null===(e=a.current)||void 0===e?void 0:e.accessSetting)&&o.userManager.updateUserAccess(i.accessSetting),void 0!==i.gridType&&i.gridType!==(null===(n=a.current)||void 0===n?void 0:n.gridType)&&o.updateViewGridType(i.gridType),a.current=i,o.publish("userPreferenceChange",t.userPreference))}),[t,t.userPreference]),e.useEffect((function(){void 0!==t.historyConfigs&&o.historyManager.updateConfig(t.historyConfigs)}),[t.historyConfigs]),e.useImperativeHandle(n,(function(){return{onPickingInitViewbox:function(){return o.onPickingBoardView()},toggleHistoryPanel:function(){o.toggleLeftPanel("history")},triggerResize:function(){!function(e){try{Ld.forEach((function(t){return t.caller===e&&t.cb()}))}catch(e){}}(o)},startUserGuide:function(){o.startUserGuide()},closeHelpCenterPanel:function(){o.uiController.rightSideOpened&&o.uiController.toggleRightSide()},getCurViewBox:function(){return exports.E({},o.view.getViewbox())},onClickCustomTemplate:function(){o.handleClickCustomTemplate()},onInsertTemplate:function(){o.onInsertTemplate()},subscribeSdkAction:function(e){return o.subscribe("sdkAction",e)},setViewRect:function(e,t){return A(r,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return o.followManager.forcedFollowing?[2,!1]:[4,o.makeBorderCenter({left:e.x,right:e.x+e.width,top:e.y,bottom:e.y+e.height},t)];case 1:return n.sent(),o.followManager.stopFollowCurrent(),[2,!0]}}))}))},updateUseKeyboard:function(e){o.useKeyboard=e},loadSdkPlugin:function(e,t,n){return o.loadSdkPlugin(e,t,n)},getElementsMetaData:function(){return o.getElementsMetaData()},setViewClip:function(e,t,n,i){var r=new Yc(e,t,n,i);o.currentScene.setViewClip(r)},exportPdfFromDocumentElement:function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,o.exportPdfFromDocumentElement(e,t)];case 1:return n.sent(),[2]}}))}))},focusBorderBox:function(e){return o.focusBorderBox(e)},stopFocusViewBox:function(){o.clearFocusedBorderBox()},startShare:function(e,t){o.addShare(e,t)},stopShare:function(){o.stopShare()},insertImage:function(e,t){o.insertImageByUrl(e,t)},insertAudio:function(e,t){o.insertAudioByUrl(e,t)},insertDocument:function(e,t,n){o.insertDocumentByUrl(e,t,n)},insertVideo:function(e,t){o.insertVideoByUrl(e,t)},insertImageFile:function(e){return A(r,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,o.customImageEvent.insertImage(e)];case 1:return[2,t.sent()]}}))}))},enableLaser:function(e){void 0===e&&(e=!0),e?o.switchMode("laser"):o.switchMode("select")},enablePresentation:function(e){void 0===e&&(e=!0),e?o.startPresentation():o.endPresentation()},toggleFramePanel:function(){o.toggleLeftPanel("frame")},forceFollowUser:function(e){o.forceFollowUser(e)},stopCurForceFollowing:function(){o.stopCurForceFollowing()},useElementsInfo:function(e,t,n){return A(r,void 0,void 0,(function(){return D(this,(function(i){return[2,o.useElementsInfo(e,t,n)]}))}))},requestShadowUserViewData:function(e){return o.requestShadowUserViewData(e)},insertTemplate:function(e){return o.insertTemplate(e)},getConnectId:function(){return o.getConnectId()},requestElesDataByRecordId:function(e){return o.requestElesDataByRecordId(e)},useRawElesData:function(e,t,n){return o.useRawElesData(e,t,n)}}}));var s=t.locale,l=t.anchorElement,c=t.extensionConfigs,u=void 0===c?ll:c;return e.useEffect((function(){void 0!==l&&o.setAnchorElement(l)}),[l]),e.createElement(xl.Provider,{value:{upime:o,phoneMode:o.phoneMode}},e.createElement(Cl.Provider,{value:{getSdkPlugin:o.getSdkPlugin.bind(o)}},e.createElement(U,{locale:s},e.createElement(qc,{uiController:o.uiController,extensionConfigs:Object.assign(ll,u)},e.createElement("div",{id:"upime-audio-container",className:$U.audio_con}),e.createElement(_u,{upime:o}),o.phoneMode?e.createElement(x1,{config:t,upime:o}):e.createElement(w1,{config:t,upime:o})))))})),x1=function(t){var n,i=t.config,r=t.upime,o=e.useState(!0),a=o[0],s=o[1],l=e.useContext(Ic),c=l.showElementBar,u=l.showToolbarSubwindow,d=i.title,p=r.meetingMode,h=r.followManager,f=r.curMeetingChannel,m=r.hideControls,v=e.useContext(FF).eventCenter;al(h,["followingUser"]);var g=e.useState(ye()),y=g[0],b=g[1];e.useEffect((function(){var e=function(){b(ye())};return window.addEventListener("orientationchange",e),function(){window.removeEventListener("orientationchange",e)}}),[]);var E=h.followingUser,x=!c&&!u&&!1===m;return e.createElement(FF.Provider,{value:{isShowScaleShow:a,setIsShowScaleShow:s,eventCenter:v}},e.createElement(t1,{upime:r}),p&&f&&e.createElement(c1,{upime:r,rtcChannel:f}),x&&e.createElement("div",{className:j(UJ.ui_layout,UJ.ui_top,UJ.ui_layout_wrap)},e.createElement(U0,{upime:r},d&&d()),e.createElement("div",{className:UJ.redoundoContainer},e.createElement(IX,{upime:r}))),e.createElement("div",{className:j(UJ.ui_layout,UJ.ui_bottom,UJ.col)},y&&e.createElement(e.Fragment,null,e.createElement("div",{className:j(UJ.row)},r.chatgptConfig&&x&&e.createElement(r1,{upime:r})),e.createElement("div",{className:j(UJ.row)},x&&e.createElement(n1,{upime:r})),e.createElement("div",{className:j(UJ.row,!r.meetingMode&&UJ.fitIOS)},x?e.createElement(W0,{upime:r}):e.createElement("div",null),e.createElement(K0,{upime:r,showIcon:x}))),!y&&e.createElement("div",{className:UJ.landscape},e.createElement("div",{className:UJ.left},x?e.createElement(W0,{upime:r}):e.createElement("div",null),x&&e.createElement(n1,{upime:r}),r.chatgptConfig&&e.createElement(r1,{upime:r})),e.createElement("div",{className:UJ.right},e.createElement(K0,{upime:r,showIcon:x}))),r.meetingMode&&e.createElement(rJ,{className:UJ.bottom_meeting_ui,upime:r,customMeetingTools:null===(n=i.meetingConfigs)||void 0===n?void 0:n.customMeetingTools})),E&&e.createElement(kX,{upime:r,followingUser:E,key:E.loginName,className:UJ.followingUser,stopFollow:function(){r.followManager.stopFollowCurrent()}}))},w1=function(t){var n=t.config,i=t.upime,r=n.titleName,o=n.title,a=n.customOptionBar,s=n.customTitleBar,l=n.learningCenterUrl,c=n.learningCenter,u=n.watermarkUrl,d=n.customTools,p=n.customizedUploader,h=i.screenPlayMode,f=i.hideToolbar,m=i.hideControls,v=i.exportingPdf,g=i.exportImageDrawer,y=i.standardPresentation,b=i.meetingMode,E=i.viewLocked;i.xmode;var x=i.followManager,w=i.customTemplate,C=i.curMeetingChannel;al(x,["followingUser"]);var S=e.useContext(Ic).extensionConfigs||{},k=S.titleBarVisible,_=S.optionBarVisible,T=S.floatBarVisible,I=S.toolBarVisible,P=S.bottomLeftBarVisible,N=S.bottomRightBarVisible,M=x.followingUser,A=v||m,D=!1===k||f||void 0!==y&&!b&&!k,R=!1===I||f||"viewer"===b&&!I,B=!1===T||f,L=!0===_||void 0===_&&!1===f&&(void 0===y||b),O=!1===N||h&&!N,F=!1===P,z=A?Ml.hidden_all:"";e.useEffect((function(){(A||R)&&(i.currentCustomTool=void 0)}),[A,R]);var H,U=(n.meetingConfigs||{}).customMeetingTools;H=w?e.createElement(oX,{upime:i,className:j($U.title_bar,D&&Ml.hidden_all)}):s||e.createElement(rX,{upime:i,className:j($U.title_bar,D&&Ml.hidden_all),title:o});var W=i.bigScreenMode?"horiz":"vertical";return e.createElement(e.Fragment,null,M&&e.createElement(kX,{upime:i,className:z,followingUser:M,key:M.loginName,stopFollow:function(){i.followManager.stopFollowCurrent()}}),b&&C&&e.createElement(aG,{upime:i,rtcChannel:C,className:z}),e.createElement("div",{className:j($U.ui_layout,$U.ui_left,z)},e.createElement(HJ,{upime:i,className:$U.leftSideBar}),e.createElement("div",{className:j($U.regular_content,$U.left_side_content)},H,e.createElement("div",{className:j($U.controls)},"viewer"!==b&&"vertical"===W&&e.createElement("div",{className:j($U.toolbar_wrap,R&&Ml.hidden_all)},e.createElement(fY,{upime:i,customTools:d,customizedUploader:p,hidden:R||A,direction:"vertical"}),e.createElement(TX,{upime:i})),e.createElement(hJ,{upime:i,className:j($U.sideBarIcon,Pc.bottom_ui,F&&Ml.hidden_all)})))),"viewer"!==b&&"horiz"===W&&e.createElement("div",{className:j($U.bottomSideBar,z)},e.createElement("div",{className:j($U.bottomSideBarContainer,R&&Ml.hidden_all)},e.createElement(fY,{upime:i,customTools:d,customizedUploader:p,hidden:R||A,direction:"horiz"}),e.createElement(TX,{upime:i,direction:"horiz"}))),e.createElement("div",{className:j($U.ui_layout,$U.ui_right)},e.createElement("div",{className:j($U.right_side_content)},!w&&e.createElement("div",{className:j($U.NEFloatMenu,z,B&&!L&&Ml.hidden_all),id:"NEFloatMenu"},e.createElement(CQ,{upime:i,className:j($U.foldable_tool_bar,B&&Ml.hidden_all),customFoldableTools:i.customFoldableTools}),L&&e.createElement(SX,{upime:i,self:i.localUserInfo},a)),e.createElement("div",{className:j(Pc.bottom_ui,$U.rightSidePanelRoot,z),id:"BottomUI"},e.createElement(_Y,{upime:i,className:j(O&&Ml.hidden_all),hide:O,hideMapAndScale:E}),e.createElement(hj,{className:$U.rightSlidePanel,upime:i}))),e.createElement(SQ,{url:l,content:c,className:j($U.learning_center)})),g&&i.viewPickWidget&&e.createElement(JY,{upime:i,viewPickWidget:i.viewPickWidget,boardTitle:null!=r?r:"picture"}),v&&e.createElement($Y,{upime:i,boardTitle:null!=r?r:"default",watermarkUrl:u}),i.meetingMode&&e.createElement(rJ,{className:Pc.bottom_meeting_ui,upime:i,customMeetingTools:U}),i.videoGuide&&e.createElement(y1,{upime:i}))},C1=function(){function e(e){this.upime=e}return e.prototype.insertSticker=function(e,t,n,i,r,o){return A(this,void 0,void 0,(function(){var a,s,l,c,u,d,p,h;return D(this,(function(f){switch(f.label){case 0:return[4,df.loadAll()];case 1:return f.sent(),a=this.upime.genID(Za.STICKER),s=He,l=Ze,c=Le(He),u=yi(t),d=uA({fontFamily:s,textSize:l,lineHeightRate:c},u),[4,this.upime.asyncUpdateMaxZindex()];case 2:return f.sent(),p={bgColor:e,scale:tb.S/i,ha:"left",va:"top",autoFontSize:!0,fontSize:d,lineHeightRate:c,lineHeight:ib(d,c),fontFamily:s,isPrivate:!1,zIndex:this.upime.newMaxZindex(),size:Ke,shape:eb.SQUARE,textSize:l,position:{x:n.x-Ke.width/i/2,y:n.y-Ke.height/i/2},showAuthor:!0,richContent:{version:this.upime.genOtVersion(0),content:[[u,{color:1710618}]]}},[4,this._createAndSync(a,Za.STICKER,p)];case 3:return h=f.sent(),this.reportElem(r,{elemId:a,key:o}),[2,h]}}))}))},e.prototype.insertFiles=function(e,t,n,i,r,o,a){return A(this,void 0,void 0,(function(){var s,l,c,u,d,p,h,f,m,v,g,y,b;return D(this,(function(E){switch(E.label){case 0:return s=Bp(e,{fileSizeLimit:i}),l=s.validFiles,c=s.exceedLimitFiles,u=s.notSupportedFiles,d=[],c.forEach((function(e){d[e.index]=!1,null==a||a(e.index,!1)})),u.forEach((function(e){d[e.index]=!1,null==a||a(e.index,!1)})),h={x:(p=t).x-$p.width/2/n,y:p.y-$p.height/2/n},[4,Hp(l,h,n)];case 1:return f=E.sent().files,[4,this.upime.asyncUpdateMaxZindex()];case 2:for(E.sent(),m=[],v=[],g=0;g<f.length;g++)switch((y=f[g]).extFile.type){case"document":m.push(this._insertDocument(y.extFile,y.position,n,r,o)),v.push(y.extFile.index);break;case"mp4":m.push(this._insertMp4(y.extFile,y.position,n,r,o)),v.push(y.extFile.index);break;case"mp3":m.push(this._insertMp3(y.extFile,y.position,n,r,o)),v.push(y.extFile.index);break;case"image":b=y,m.push(this._insertImage(b.extFile,b.image,b.position,n,{autoSize:!1},r,o)),v.push(y.extFile.index)}return[4,this._resolveResult(m,v,d,a)];case 3:return[2,d=E.sent()]}}))}))},e.prototype._resolveResult=function(e,t,n,i){return A(this,void 0,void 0,(function(){return D(this,(function(r){return[2,new Promise((function(r){var o=0;function a(t,a){n[t]=a,null==i||i(t,a),++o===e.length&&r(n)}for(var s=function(n){var i=t[n];e[n].then((function(e){return a(i,e)})).catch((function(e){a(i,!1)}))},l=0;l<e.length;l++)s(l)}))]}))}))},e.prototype._insertImage=function(e,t,n,i,r,o,a){return void 0===r&&(r={autoSize:!0}),A(this,void 0,void 0,(function(){var s,l;return D(this,(function(c){switch(c.label){case 0:return s=this.upime.genID(Za.IMAGE),[4,Up(e,t,n,this.upime,{id:s},r,i)];case 1:return null==(l=c.sent())?[3,3]:[4,this._createAndSync(s,Za.IMAGE,l)];case 2:return c.sent(),this.reportElem(o,{elemId:s,key:a}),[2,!0];case 3:return[2,!1]}}))}))},e.prototype._insertDocument=function(e,t,n,i,r){return A(this,void 0,void 0,(function(){var o,a;return D(this,(function(s){switch(s.label){case 0:return o=this.upime.genID(Za.DOCUMENT),[4,Vp(e,t,this.upime,{id:o},n)];case 1:return null==(a=s.sent())?[3,3]:[4,this._createAndSync(o,Za.DOCUMENT,a)];case 2:return s.sent(),this.reportElem(i,{elemId:o,key:r}),[2,!0];case 3:return[2,!1]}}))}))},e.prototype._insertMp4=function(e,t,n,i,r){return A(this,void 0,void 0,(function(){var o,a;return D(this,(function(s){switch(s.label){case 0:return o=this.upime.genID(Za.VIDEO),[4,jp(e,t,this.upime,{id:o},n)];case 1:return null==(a=s.sent())?[3,3]:[4,this._createAndSync(o,Za.VIDEO,a)];case 2:return s.sent(),this.reportElem(i,{elemId:o,key:r}),[2,!0];case 3:return[2,!1]}}))}))},e.prototype._insertMp3=function(e,t,n,i,r){return A(this,void 0,void 0,(function(){var o,a;return D(this,(function(s){switch(s.label){case 0:return o=this.upime.genID(Za.AUDIO),[4,Gp(e,t,this.upime,{id:o},n)];case 1:return null==(a=s.sent())?[3,3]:[4,this._createAndSync(o,Za.AUDIO,a)];case 2:return s.sent(),this.reportElem(i,{elemId:o,key:r}),[2,!0];case 3:return[2,!1]}}))}))},e.prototype._createAndSync=function(e,t,n){var i=this;return new Promise((function(r){var o=i.upime.genLocalSeq(),a={type:"create",seq:o,id:e,elementType:t,data:exports.E(exports.E({},n),{deleted:!1})};i.upime.recordAction(a),i.upime.waitAck(o,(function(){return r(!0)}))}))},e.prototype.reportElem=function(e,t){this.upime.sendSCmd(16,1,e,t)},e}(),S1=function(){function e(e){var t=this;this.onReady=!1,this._recordId="",this._reconnectToastId=null,this.boardQueryObj={},this.maxZindex=0,this.uploadControl=new C1(this),this.websocketHelper=new Lq(this),this.fileHelper=new Rq(this.websocketHelper),this.subServiceManager=this.websocketHelper.subServiceManager,this.getServerUrl=function(){return A(t,void 0,void 0,(function(){var e,t,n,i,r,o,a,s,l,c,u,d,p,h,f=this;return D(this,(function(m){switch(m.label){case 0:return e=this.config,t=e.query,n=e.getUploadQuery,i=e.serverAddr,t?(r=t,[3,4]):[3,1];case 1:return n?[4,n()]:[3,3];case 2:return r=m.sent(),[3,4];case 3:throw new Error("Query is necessary bu no privided");case 4:return o=r.split("&"),r||null===(h=this.socketClient)||void 0===h||h.forceDisconnect(),o.forEach((function(e){var t=e.split("="),n=t[0],i=t[1];f.boardQueryObj[n]=i})),[4,Nd("",{query:r}).result];case 5:if((a=m.sent()).code===vd.OK)return s=a.obj,l=s.host,c=s.port,u=s.query,d=s.protocol,p=void 0===d?"wss":d,[2,"".concat(i||p+"://"+l+":"+c,"?").concat(u)];throw new Error("Code error:"+a.code)}}))}))},this.insertFiles=function(e,n,i,r,o,a,s){return t.uploadControl.insertFiles(e,n,i,r,o,a,s)},this.config=e,e.offline||this.connectServer()}return Object.defineProperty(e.prototype,"curRecordId",{get:function(){return this._recordId},enumerable:!1,configurable:!0}),e.prototype.genLocalSeq=function(){return this.websocketHelper.genLocalSeq()},e.prototype.recordAction=function(e){var t;null===(t=this.socketClient)||void 0===t||t.sendDataCmd(Bs(e))},e.prototype.genID=function(e){return this.websocketHelper.genID(e)},e.prototype.sendSCmd=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];null===(t=this.socketClient)||void 0===t||t.sendServiceCmd(R([e],n,!0))},e.prototype.sendRCmd=function(e,t){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return(n=this.websocketHelper).sendRCmd.apply(n,R([e,t],i,!1))},e.prototype.sendRequest=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.websocketHelper).sendRequest.apply(t,R([e],n,!1))},e.prototype.dealSubServiceCmd=function(e){this.websocketHelper.dealSubServiceCmd(e)},e.prototype.dealControlCmd=function(e){var t,n,i,r;return A(this,void 0,void 0,(function(){return D(this,(function(o){return this.websocketHelper.dealControlCmd(e),1===e[0]&&(null===(n=(t=this.config).onConnectStatusChange)||void 0===n||n.call(t,!0),null===(r=(i=this.config).onReady)||void 0===r||r.call(i),this.onReady=!0),[2]}))}))},e.prototype.dealDataCmd=function(e){this.websocketHelper.dealDataCmd(e)},e.prototype.dealResponseCmd=function(e){this.websocketHelper.dealResponseCmd(e)},e.prototype.waitAck=function(e,t){this.websocketHelper.waitAck(e,t)},e.prototype.clearSubserviceRequest=function(e){this.websocketHelper.clearSubserviceRequest(e)},e.prototype.asyncUpdateMaxZindex=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.sendRequest(9)];case 1:return e=t.sent()[0],this.maxZindex=e,[2]}}))}))},e.prototype.newMaxZindex=function(){return++this.maxZindex},e.prototype.genOtVersion=function(e){return this.websocketHelper.genOtVersion(e)},e.prototype.connectServer=function(){var e,t;return A(this,void 0,void 0,(function(){var n,i,r,o,a,s,l,c,u=this;return D(this,(function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,this.getServerUrl()];case 1:return n=d.sent(),i=function(){return A(u,void 0,void 0,(function(){return D(this,(function(e){return this.websocketHelper.sendControlCmd([1,this.boardQueryObj.userName||"","4.6.26",""]),this.websocketHelper.sendControlCmd([4,Date.now()]),[2]}))}))},r=this.boardQueryObj,o=r.crypto,a=r.appId,s=r.recordId,this._recordId=null!=s?s:"",l="1"===o?AU("".concat(a,"_").concat(s)):void 0,this.socketClient=new Bd(this,{url:n,crypto:l,refreshUrl:this.getServerUrl,onconnected:i,onstartreconnect:function(){clearTimeout(c),u._reconnectToastId,u.onReady=!1},onreconnected:function(){u.resetData(),c=window.setTimeout(i,2e3)},onClosed:function(){var e,t;null===(t=(e=u.config).onConnectStatusChange)||void 0===t||t.call(e,!1),u.onReady=!1}}),this.socketClient.autoReconnect="visible"===document.visibilityState,[3,3];case 2:return d.sent(),null===(t=(e=this.config).onConnectStatusChange)||void 0===t||t.call(e,!1),this.onReady=!1,[3,3];case 3:return[2]}}))}))},e.prototype.insertSticker=function(e,t,n,i,r,o){return this.uploadControl.insertSticker(e,t,n,i,r,o)},e.prototype.saveFile=function(e,t,n,i){return this.fileHelper.saveFile(this.boardQueryObj.appId||"",e,t,n,i)},e.prototype.parseIspringPpt=function(e){return this.fileHelper.parsePpt(e)},e.prototype.transcodeMedia=function(e){return this.fileHelper.transcodeMedia(e)},e.prototype.genFileName=function(e){return"".concat(this.boardQueryObj.loginName||"","_").concat(e,"_").concat(Date.now())},e.prototype.resetData=function(){this.maxZindex=0,this.websocketHelper.reset()},e.prototype.destroy=function(){var e;null===(e=this.socketClient)||void 0===e||e.destroy()},M([rl],e.prototype,"onReady",void 0),M([il],e)}();!function(e){e[e.EXCEED_FILE_LIMIT=0]="EXCEED_FILE_LIMIT",e[e.NOT_SUPPORT=1]="NOT_SUPPORT",e[e.EXCEED_MOBILE_FILE_LIMIT=2]="EXCEED_MOBILE_FILE_LIMIT",e[e.EXCEED_MAX_LENGTH=3]="EXCEED_MAX_LENGTH"}(b1||(b1={}));var k1={upload:"upload_3d4rn",previewBox:"previewBox_1p9GD",box_item:"box_item_L9uIm",preview:"preview_25NPL",status:"status_3jvyc",success:"success_1yKB_",fail:"fail_1SM-B",loading:"loading_12WUi",close:"close_BVWaP",closeIcon:"closeIcon_3Qcur",name:"name_1AVEM",insertItem:"insertItem_12ZPp",uploadBtn:"uploadBtn_1-Fzc"},_1=Math.max(3,window.devicePixelRatio),T1=-Math.PI/2,I1=function(t){var n=t.progressRef,i=e.useState(null),r=i[0],o=i[1],a=e.useRef(null),s=e.useRef(null);return e.useEffect((function(){var e,t=function(){if(a.current){var e=a.current.getBoundingClientRect(),t=e.width,n=e.height;o({width:t/4,height:n/4})}},n=function(){e&&clearTimeout(e),e=setTimeout((function(){t()}),300)};return t(),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[]),e.useEffect((function(){var e=null;if(r){var t=Date.now(),i=function(){e=requestAnimationFrame((function(){var e=Date.now();e-t>1e3/60&&(function(){if(r){var e=r.width,t=r.height,i=s.current;if(i){var o=e/6,a=.7*o;i.save(),i.scale(_1,_1),i.clearRect(0,0,e,t),i.beginPath(),i.lineWidth=o,i.strokeStyle="rgba(255,255,255, 0.6)",i.arc(e/2,t/2,e/2-o/2-1,0,2*Math.PI),i.stroke(),i.beginPath(),i.lineCap="round",i.lineWidth=a,i.strokeStyle="#2E73E5";var l=n.current||0;i.arc(e/2,t/2,e/2-o/2-1,T1,T1+2*Math.PI*l/100),i.stroke(),i.restore()}}}(),t=e),i()}))};i()}return function(){e&&cancelAnimationFrame(e)}}),[r]),e.createElement("div",{className:"progressCon_1ksJv",ref:a},r&&e.createElement("canvas",{style:{height:r.width,width:r.height},ref:function(e){var t=null==e?void 0:e.getContext("2d");t&&(s.current=t)},width:r.width*_1,height:r.height*_1}))};function P1(e){return new Promise((function(t){var n=new FileReader;return n.onload=function(e){var n;t(null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}function N1(t){var n,i=this,r=t.className,o=t.fileInfo,a=t.onClose,s=t.index,l=t.renderInfo,c=W().getUpimeTrans,u=e.useState({}),d=u[0],p=u[1],h=e.useState(""),f=h[0],m=h[1],v=o.status,g=o.type,y=o.file;return e.useEffect((function(){A(i,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return"image"!==g?[3,2]:[4,P1(y)];case 1:e=t.sent(),m(e),t.label=2;case 2:return[2]}}))}))}),[o]),e.useEffect((function(){var e={width:l.width,height:l.width+24};(s+1)%l.colNum==0&&(e=exports.E(exports.E({},e),{marginRight:0})),p(e)}),[l,s]),e.createElement("div",{className:j(r),style:d},e.createElement("div",{className:k1.preview,style:f?{backgroundImage:"url(".concat(f,")")}:{}},function(){switch(v){case"success":return e.createElement("span",{className:j(k1.status,k1.success)},c("uploadModule.status.success"));case"fail":return e.createElement("span",{className:j(k1.status,k1.fail)},c("uploadModule.status.fail"));case"loading":return null;case"prepare":return e.createElement("div",{className:k1.close},e.createElement(hl,{icon:"guanbi",className:k1.closeIcon,onClick:a}))}}(),"image"===o.type?null:e.createElement(hl,{icon:(n=o.ext,Pp(n)?"file-tupian":Ip(n)?"file-yinpin":Tp(n)?"file-shipin":Ap(n)?"file-pdf":Mp(n)?"file-ppt":Rp(n)?"file-excel":Dp(n)?"file-word":"file-jinggao"),style:{fontSize:.4*l.width},className:k1.fileIcon}),e.createElement(M1,{status:v})),e.createElement("span",{className:k1.name},function(e,t,n){var i=document.createElement("canvas").getContext("2d");if(i.font="14px PingFangSC-Regular, sans-serif",i.measureText(e).width>t){for(var r=e.lastIndexOf(".")-2,o="..."+e.slice(r),a=i.measureText(o).width,s=-1,l=e.slice(0,r),c=r-1;c>=0;c--)if(i.measureText(l.slice(0,c)).width+a<=t){s=c;break}return l.slice(0,s)+o}return e}(y.name,l.width)))}var M1=e.forwardRef((function(t,n){var i=t.status,r=e.useRef(0),o=e.useState(!1),a=o[0],s=o[1],l=e.useRef(),c=function(){a||(s(!0),r.current=0,l.current=setInterval((function(){r.current++,95===r.current&&l.current&&clearInterval(l.current)}),500))},u=function(){return l.current&&clearInterval(l.current),r.current=100,new Promise((function(e){setTimeout((function(){s(!1),e(!0)}),300)}))};return e.useEffect((function(){return function(){l.current&&clearInterval(l.current)}}),[]),e.useEffect((function(){"loading"===i?c():"fail"!==i&&"success"!==i||u()}),[i]),e.useImperativeHandle(n,(function(){return{start:c,finish:u}})),a?e.createElement("div",{style:{position:"absolute",top:0,bottom:0,left:0,right:0}},e.createElement(I1,{progressRef:r})):null}));function A1(t){var n,i=this,r=t.location,o=t.viewScale,a=t.uploadSizeLimit,s=t.maxLength,l=void 0===s?9:s,c=t.uploadUpime,u=t.watchFileStatus;al(c,["onReady"]);var d,p=W().getUpimeTrans,h=e.useRef(null),f=e.useState({})[1],m=e.useRef("preUpload"),v=function(){return f({})},g=(d=e.useRef(0),{id:d.current,getId:function(){return++d.current}}).getId,y=e.useRef([]),b=e.useState({width:0,colNum:0}),E=b[0],x=b[1],w=function(e,t){y.current&&(y.current[e].status=t?"success":"fail",v())};e.useEffect((function(){var e=function(){if(h.current){var e=h.current.getBoundingClientRect().width,t=(e-20)/3,n=3;t>234&&(t=(e-10*((n=Math.ceil((e-10)/244))-1))/n),x({width:t,colNum:n})}};return c.onReady&&"uploading"===m.current&&(m.current="uploaded",y.current=y.current.map((function(e){return exports.E(exports.E({},e),{status:"loading"===e.status?"fail":e.status})})),v()),e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[c.onReady]);var C,S=y.current.length<l&&"preUpload"===m.current;return e.createElement("div",{className:k1.upload,ref:h},e.createElement("div",{className:k1.previewBox},null===(n=y.current)||void 0===n?void 0:n.map((function(t,n){return e.createElement(N1,{key:t.id,className:k1.box_item,renderInfo:E,fileInfo:t,onClose:function(){return function(e){var t=y.current.findIndex((function(t){return t.id===e}));y.current.splice(t,1),y.current=R([],y.current,!0),v()}(t.id)},index:n})})),S&&e.createElement("div",{style:exports.E({width:E.width,height:E.width},(y.current.length+1)%E.colNum==0?{marginRight:0}:{}),onClick:function(){if("preUpload"===m.current){var e=document.getElementById("tmp-infi-input-file");e&&document.body.removeChild(e);var t=document.createElement("input");t.setAttribute("id","tmp-infi-input-file"),t.setAttribute("type","file"),t.setAttribute("multiple","multiple"),t.setAttribute("accept",_p.join(", ")),t.style.display="none",t.addEventListener("change",(function(e){!function(e){var t=e.target.files,n=!1,i=Bp(Array().slice.call(t).filter((function(e){var t=e.size>62914560;return t&&(n=!0),!t})),{fileSizeLimit:a}),r=i.validFiles,o=i.exceedLimitFiles,s=i.notSupportedFiles,c={exceedMobileFileLimit:62914560,exceedFileLimit:a,notSupportFiles:s.map((function(e){return e.file.name})),fileLength:l},d=[];n&&d.push(b1.EXCEED_MOBILE_FILE_LIMIT),o.length>0&&d.push(b1.EXCEED_FILE_LIMIT),s.length>0&&d.push(b1.NOT_SUPPORT);var p=r.map((function(e){return{file:e.file,type:e.type,status:"prepare",ext:e.ext,id:g()}})),h=R(R([],y.current,!0),p,!0);h.length>l&&d.push(b1.EXCEED_MAX_LENGTH),d.length>0&&(null==u||u(d,c)),y.current=h.slice(0,l),v()}(e),document.body.removeChild(t)})),document.body.appendChild(t),t.click()}},className:j(k1.box_item,k1.insertItem)})),(C="preUpload"!==m.current||!c.onReady||0===y.current.length,e.createElement(ul,{type:"primary",onClick:function(){return A(i,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return e=y.current.map((function(e){return exports.E(exports.E({},e),{status:"loading"})})),y.current=e,m.current="uploading",v(),[4,c.insertFiles(y.current.map((function(e){return e.file})),r,o,a,"","",w)];case 1:return t.sent(),m.current="uploaded",c.destroy(),v(),[2]}}))}))},disabled:C,className:k1.uploadBtn},"preUpload"===m.current&&p("uploadModule.btn.upload"),"uploading"===m.current&&p("uploadModule.btn.uploading"),"uploaded"===m.current&&p("uploadModule.btn.uploaded"))),e.createElement("button",{onClick:function(){c.insertSticker(16751944,"我是测试便签",r,o,"","")},style:{margin:"10px auto",width:"200px"}},"上传便签"))}e.forwardRef((function(t){var n=e.useState((function(){return new S1(t)}))[0];al(n),e1(),e.useEffect((function(){return pl(),function(){n.destroy()}}),[]);var i=t.locale;return e.createElement(wl.Provider,{value:{uploadUpime:n}},e.createElement(U,{locale:i},e.createElement(A1,exports.E({},t,{uploadUpime:n}))))}));var D1={width:464,height:261},R1={x:740,y:12},B1={width:180,height:24},L1=function(e){function t(t,n,i){var r=e.call(this)||this;return r.parent=t,r.col=i,r.deleted=!1,r.textId=0,r.id=n.id,r.title=n.title,r.imgs=n.imgs.map((function(e){return exports.E(exports.E({},e),{sourceRect:e.rect})})),r.content=n.content,r.imgSources=r.imgs.map((function(e){return r.createImgSource(e)})),r}return P(t,e),t.prototype.update=function(e){var t=this,n=this,i=n.imgs,r=n.imgSources,o=n.content;this.title=e.title;var a=e.content;a.text===o.text&&a.fontSize===o.fontSize&&a.lineHeight===o.lineHeight&&a.rect.width===o.rect.width||this.textId++,this.content=e.content,this.imgs=[],this.imgSources=[],e.imgs.forEach((function(e){var n=i.findIndex((function(t){return t.src===e.src}));if(n>=0){var o=i[n],a=r[n],s=e.rect.x+e.rect.width/2-(o.rect.x+o.rect.width/2);o.rect.x+=s,o.sourceRect.x+=s,t.imgs.push(o),t.imgSources.push(a)}else{var l=exports.E(exports.E({},e),{sourceRect:e.rect});t.imgs.push(l),t.imgSources.push(t.createImgSource(l))}}))},t.prototype.createImgSource=function(e){var t=this,n=tr(e.src);return er(n,(function(){if(!t.deleted&&t.imgSources.includes(n)){var i=e.rect,r=i.x,o=i.y,a=i.width,s=i.height;(s=a*n.originHeight/n.originWidth)<e.rect.height?o+=(e.rect.height-s)/2:(a=(s=e.rect.height)*n.originWidth/n.originHeight,r+=(e.rect.width-a)/2),e.sourceRect={x:r,y:o,width:a,height:s},t.parent.onImageLoaded(t.col)}})),n},t.prototype.destroy=function(){this.deleted=!0},t}(el),O1=function(){function e(e,t,n){var i=this;this.parent=e,this.width=0,this.userName=t.userName,this.userId=t.userId,this.row=n;var r=t.comments.map((function(e,t){return new L1(i,e,t)}));this.comments=r,this.width=31+176*r.length-8}return e.prototype.onImageLoaded=function(e){this.parent.onImageLoaded(this.row,e)},e}(),F1=function(e){function t(t){var n=e.call(this)||this;return n.id=t+"_custom",n}return P(t,e),Object.defineProperty(t.prototype,"level",{get:function(){return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.addElement=function(t){var n;t.parentRefSystem!==this&&(e.prototype.addElement.call(this,t),null===(n=this.onAddElement)||void 0===n||n.call(this,t))},t.prototype.removeElement=function(t){var n;e.prototype.removeElement.call(this,t),null===(n=this.onRemoveElement)||void 0===n||n.call(this,t)},t}(Us);function z1(e){var t=tr(e="data:image/svg+xml,"+encodeURIComponent(e));return er(t),t}var H1=['<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h32v32H0z"/><g fill-rule="nonzero"><path data-follow-fill="#FFFFFF" d="M19.844 12.477 17.06 9.372a.267.267 0 0 0-.39 0c-.112.113-.112.17-.112.282v1.637c-2.284 0-4.457 1.92-4.457 4.234 0 .62.279 1.41.557 1.693.334-1.75 2.062-3.104 3.9-3.104v1.693c0 .056 0 .113.056.226.111.113.334.056.39 0l2.786-3.048c.111-.113.111-.226.111-.283 0-.056 0-.169-.056-.225Z" fill="#FFFFFF"/><path data-follow-stroke="#FFFFFF" d="M26 4H6C4.343 4 3 5.332 3 6.974v13.88c0 1.642 1.343 2.973 3 2.973h20c1.657 0 3-1.331 3-2.974V6.974C29 5.332 27.657 4 26 4Z" stroke="#FFFFFF" stroke-width="2.36"/><path data-follow-fill="#FFFFFF" d="M23.426 27.977c0 .652-.623 1.18-1.392 1.18H10.893c-.77 0-1.393-.528-1.393-1.18 0-.652.624-1.18 1.393-1.18h11.14c.77 0 1.393.528 1.393 1.18Z" fill="#FFFFFF"/></g></g></svg>','<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h32v32H0z"/><g data-follow-stroke="#FFFFFF" transform="translate(3 4)" stroke="#FFFFFF" stroke-linejoin="round" stroke-width="2.364"><ellipse cx="13" cy="5.333" rx="5.318" ry="5.333"/><path d="M1.773 23.704c0-5 3.649-9.667 6.736-10.667 0 0 2.807 3 4.491 5l4.49-5c2.527.333 6.737 5.667 6.737 10.667"/><path d="M0 23.704h26" stroke-linecap="round"/></g></g></svg>'].map((function(e){return z1(e)})),U1=H1[0],W1=H1[1],V1=function(e){var t=js.value.viewbox,n=e.contentBox,i=e.customBox,r=e.commentListBox;if(vf(e),Na((function(e){var t=Rt(n),i=t.x,r=t.y,o=t.width,a=t.height;e.beginFill(14606563),e.drawRect(i,r,o,a),e.endFill(),e.lineStyle(1,14277081),e.drawRect(i-.5,r-.5,o+1,a+1)})),Na((function(e){var t=Rt(i),n=t.x,r=t.y,o=t.width,a=t.height;e.beginFill(16777215),e.drawRect(n,r,o,a),e.endFill(),e.beginFill(16119542),e.drawRect(n,r,o,40),e.endFill(),e.lineStyle(1,14277081),e.drawRect(n-.5,r-.5,o+1,a+1)})),fa({x:i.left+16,y:i.top+10}),e.otherResourceTitle.render(),ma(),Na((function(e){var t=Rt(r),n=t.x,i=t.y,o=t.width,a=t.height;e.beginFill(16777215),e.drawRect(n,i,o,a),e.endFill(),e.beginFill(16119542),e.drawRect(n,i,o,40),e.endFill(),e.lineStyle(1,14277081),e.drawRect(n-.5,i-.5,o+1,a+1)})),Kt(r,t)){var o=r.left,a=r.top,s=r.right,l=r.bottom,c=t.left,u=t.top,d=t.bottom,p=t.right,h=Math.max(o,c)-o,f=Math.min(s,p)-o,m=Math.max(a,u)-a,v=Math.min(l,d)-a;m<40&&(fa({x:o+15,y:a+10}),e.commlistTitle.render(),ma());var g=e.commentList;fa({x:o,y:a});var y=0,b=58;m>b&&(y=Math.floor((m-b+21)/168),b+=168*y);for(var E=function(){var t=15,n=g[y],i=n.userName,r=n.comments;Ra(e.useMemo("userName_"+y,(function(){return{text:i,lineHeight:22,fontSize:14,fontFamily:He}}),[i]),{x:t,y:b,fill:"#0C1024",fontWeight:"bold"}),b+=35;var o=0;h>t&&(o=Math.floor((h-t+8)/176),t+=176*o);for(var a=function(){var e=r[o],n=e.title,i=e.imgs,a=e.content,s=e.imgSources;if(fa({x:t,y:b}),Na((function(e){e.beginFill(947173),e.drawRect(0,0,168,16),e.endFill(),e.beginFill(16119542),e.drawRect(0,16,168,96),e.endFill()})),Ra({text:n,lineHeight:8,fontSize:8},{x:4,y:4,fill:"#fff"}),i.forEach((function(e,t){var n=s[t],i=e.rect,r=e.sourceRect;n.loaded&&(Na((function(e){e.beginFill(3159109),e.drawRect(i.x,i.y,i.width,i.height)})),Oa(exports.E({src:n},r)))})),Ra(e.useMemo("content",(function(){return{text:a.text,textWidth:a.rect.width,textHeight:a.rect.height,fontFamily:He,fontSize:a.fontSize,lineHeight:a.lineHeight}}),[e.textId]),{x:a.rect.x,y:a.rect.y,fill:"#0C1024"}),ma(),(t+=176)>f)return"break"};o<r.length&&"break"!==a();o++);if((b+=133)>v)return"break"};y<g.length&&"break"!==E();y++);ma()}ma()},j1=function(e){var t,n,i=e.position,r=i.x,o=i.y,a=e.size,s=a.width,l=a.height,c=e.scale,u={x:r,y:o,width:s*c,height:l*c};e.coverSource&&e.liveElement&&((null===(t=e.liveElement)||void 0===t?void 0:t.finished)||!(null===(n=e.liveElement)||void 0===n?void 0:n.online))?(Oa(exports.E({src:e.coverSource},u)),Ma((function(e){var t=e.context;t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(u.x,u.y,u.width,u.height)}))):Na((function(e){e.beginFill(6055028),e.drawRect(u.x,u.y,u.width,u.height),e.endFill()}))},G1=function(e){var t=e.hostWindow,n=e.showBtns,i=e.commentBtn,r=e.mirrorBtn,o=e.maxBtn,a=e.singleWinMode,s=e.liveWinNum,l=t.liveElement,c=e.position,u=c.x,d=c.y,p=e.size,h=p.width;if(p.height,fa({x:u,y:d}),l&&!l.finished&&s>1){var f="screen"===l.playerType?"主讲屏幕":"主讲摄像头";Ra(e.useMemo("text",(function(){return{text:f,lineHeight:18,fontSize:12,fontFamily:He}}),[f]),{x:8,y:16,fill:"#fff"})}if(n){var m=h-8-20;o.disabled=a,a||(o.x=m,o.on=t.isMaxed,o.render(),m-=28),l&&l.cameraOn?(r.x=m,r.disabled=!1,r.on=l.mirror,r.render(),m-=28):r.disabled=!0,i.x=m,i.disabled=!1,i.render()}else i.disabled=!0,r.disabled=!0,o.disabled=!0;ma()},q1=function(e){var t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.scale,l=o*s,c=a*s;fa({x:n,y:i}),e.finished?Ra({text:"主讲".concat("screen"===e.playerType?"屏幕":"摄像头","视频回放正在生成中，请稍等…"),fontFamily:He,fontSize:14,lineHeight:22,textWidth:0},{x:l/2,y:(c-22)/2,ha:"center",fill:"rgba(255, 255, 255, 0.88)"}):e.online?e.cameraOn?Ua({x:0,y:0,width:l,height:c}):(Na((function(e){e.beginFill(10140398),e.drawCircle(l/2,c/2,46)})),Oa({src:"screen"===e.playerType?U1:W1,x:l/2-25,y:c/2-25,width:50,height:50})):Ra({text:"当前暂无画面",fontFamily:He,fontSize:14,lineHeight:22,textWidth:0},{x:l/2,y:(c-22)/2,ha:"center",fill:"rgba(255, 255, 255, 0.88)"}),ma()},K1=function(e){var t=e.position,n=t.x,i=t.y,r=e.size,o=r.width,a=r.height,s=e.hideBtn,l=e.openning;Na((function(e){e.lineStyle(2,12764104),e.drawRect(n,i,o,a),e.lineStyle(),e.beginFill(16777215),e.drawRect(n,i,o,a),e.endFill()})),fa({x:n,y:i}),s.on=!l,s.render(),ma()};z1('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.723 1.708a1 1 0 0 1 0 1.414l-5.724 5.723.001 3.656a4 4 0 0 1-6.651 2.995l-1.416 1.417a6 6 0 0 0 10.062-4.187L18 12.5v-3l.007-.117a1 1 0 0 1 1.986 0l.007.117v3a8.001 8.001 0 0 1-6.999 7.938L13 21.5a1 1 0 1 1-2 0v-1.062a7.973 7.973 0 0 1-4.481-2.111L3.69 21.153a1 1 0 1 1-1.414-1.414L20.308 1.708a1 1 0 0 1 1.415 0ZM5 8.5a1 1 0 0 1 .993.883L6 9.501v3c0 .465.053.917.153 1.351l-1.594 1.593A7.979 7.979 0 0 1 4 12.501v-3l.007-.117A1 1 0 0 1 5 8.501Zm9 2.344-3.231 3.232a2 2 0 0 0 3.226-1.427L14 12.5v-1.655Zm-2-9.344c1.763 0 3.26 1.14 3.792 2.724L14 6.014V5.5a2 2 0 0 0-3.995-.15l-.005.15v4.508l-2 1.998V5.5a4 4 0 0 1 4-4Z" fill="#fff" fill-rule="evenodd" data-follow-fill="#fff"/></svg>');var Y1=['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path data-follow-fill="#FFF" d="m11.342 5.38-.026.01 4.312-1.375a.723.723 0 0 1 .606.152c.169.14.266.348.265.569l.001 10.527a.734.734 0 0 1-.265.57.723.723 0 0 1-.606.152l-4.42-1.407a.922.922 0 0 1-.49-.819V6.258c0-.397.25-.75.623-.876V5.38Zm.932 8.039 2.672.728V6.042l-2.673.726v6.651ZM4.37 4.015l4.26 1.359c-.007-.001-.011-.001-.014-.003a.92.92 0 0 1 .663.887v7.5a.922.922 0 0 1-.489.819l-4.417 1.408a.723.723 0 0 1-.608-.152.734.734 0 0 1-.265-.571V4.737a.73.73 0 0 1 .263-.57.719.719 0 0 1 .607-.151v-.001Z" fill="#FFF"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path data-follow-fill="#FFF" d="m6.658 3.38.026.01-4.312-1.375a.723.723 0 0 0-.606.152.734.734 0 0 0-.265.569L1.5 13.263c-.001.22.096.43.265.57.169.14.391.196.606.152l4.42-1.407a.922.922 0 0 0 .49-.819V4.258c0-.397-.25-.75-.623-.876V3.38Zm-.932 8.039-2.672.728V4.042l2.673.726v6.651Zm7.904-9.404L9.37 3.374c.007-.001.011-.001.014-.003a.92.92 0 0 0-.663.887v7.5c0 .357.199.666.489.819l4.417 1.408a.723.723 0 0 0 .608-.152.73.73 0 0 0 .265-.571V2.737a.73.73 0 0 0-.263-.57.719.719 0 0 0-.607-.151v-.001Z" fill="#FFF"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path data-follow-fill="#FFF" fill="#FFF" d="M13.967 15.573H6.033c-.324 0-.6-.288-.6-.657v-.823h9.133v.823c0 .37-.275.657-.599.657Zm-.472-8.395a.711.711 0 0 0 .713-.71V5.333h1.057a.713.713 0 0 0 0-1.427h-1.057V2.71a.711.711 0 0 0-.713-.71.713.713 0 0 0-.72.71v1.196h-1.057a.713.713 0 0 0 0 1.427h1.056v1.135c0 .36.27.656.617.703l.104.007ZM13.967 17c1.13 0 2.033-.94 2.033-2.084V7.958h-1.433v4.708H5.432V6.007c0-.37.276-.657.6-.657h4.278V3.923H6.033C4.903 3.923 4 4.863 4 6.007v8.909C4 16.06 4.903 17 6.033 17h7.934ZM9.374 8.977a.685.685 0 0 0 .686-.684v-.06a.685.685 0 0 0-.686-.684h-1.93a.685.685 0 0 0-.686.684v.06c0 .378.307.684.686.684h1.93Zm1.981 2.132a.685.685 0 0 0 .686-.684v-.06a.685.685 0 0 0-.686-.684h-3.91a.685.685 0 0 0-.687.684v.06c0 .378.307.684.686.684h3.911Z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path data-follow-fill="#FFF" fill="#FFF" d="M15.335 4h-4a.666.666 0 0 0 0 1.33h2.391l-2.865 2.863a.668.668 0 0 0 .944.945l2.862-2.863v2.392a.666.666 0 0 0 1.33 0V4.665A.661.661 0 0 0 15.335 4ZM4 15.335c0 .368.3.665.665.665h4a.666.666 0 0 0 0-1.33H6.273l2.862-2.863a.668.668 0 0 0-.944-.945l-2.858 2.863v-2.392a.666.666 0 0 0-1.33 0v4.002H4Z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path data-follow-fill="#FFF" fill="#FFF" d="M10.666 8.668c0 .369.3.665.665.665h4a.666.666 0 0 0 0-1.33H12.94l2.865-2.863a.668.668 0 0 0-.944-.945l-2.862 2.863V4.667a.666.666 0 0 0-1.33 0v4.002h-.002l-.001-.001Zm-1.335 2.664a.666.666 0 0 0-.665-.665h-4a.666.666 0 0 0 0 1.33h2.39l-2.86 2.863a.668.668 0 0 0 .943.945l2.859-2.863v2.391a.666.666 0 0 0 1.33 0v-4.002h.003v.001Z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path data-follow-stroke="#303445" stroke-width="1.5" stroke-linejoin="round" stroke-linecap="round" stroke="#303445" fill="none" d="M3 4.131h10M3 6.754h10M3 12.805l5-3.672 5 3.672"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path data-follow-stroke="#303445" stroke-width="1.5" stroke-linejoin="round" stroke-linecap="round" stroke="#303445" fill="none" d="M3 11.869h10M3 9.246h10M3 3.195l5 3.672 5-3.672"/></svg>'].map(z1),X1=Y1[0],Q1=Y1[1],Z1=Y1[2],J1=Y1[3],$1=Y1[4],e2=Y1[5],t2=Y1[6],n2=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.element=t,i.x=0,i.y=14,i.width=20,i.height=20,i.iconSize=20,i.bgColor=0,i.bgOpacity=.5,i.bgBorderRadius=2,i}return P(t,e),Object.defineProperty(t.prototype,"extraSensitiveDistance",{get:function(){return 4},enumerable:!1,configurable:!0}),t.prototype.dealHoverStart=function(t){e.prototype.dealHoverStart.call(this,t),this.tip&&this.element.showWidgetTip(this,this.tip,this.getHoverPoint())},t.prototype.dealHoverEnd=function(){e.prototype.dealHoverEnd.call(this),this.tip&&this.element.clearWidgetTip(this)},t}(UN),i2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconSource=X1,t.iconSource2=Q1,t}return P(t,e),Object.defineProperty(t.prototype,"tip",{get:function(){return"画面镜像"},enumerable:!1,configurable:!0}),t}(n2),r2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconSource=J1,t.iconSource2=$1,t}return P(t,e),Object.defineProperty(t.prototype,"tip",{get:function(){return this.on?"恢复":"最大化"},enumerable:!1,configurable:!0}),t.prototype.dealClick=function(t){e.prototype.dealClick.call(this,t),this.element.clearWidgetTip(this)},t}(n2),o2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconSource=Z1,t}return P(t,e),Object.defineProperty(t.prototype,"tip",{get:function(){return"添加点评"},enumerable:!1,configurable:!0}),t}(n2),a2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.x=156,t.y=2,t.iconSize=16,t.iconSource=e2,t.iconSource2=t2,t.bgColor=void 0,t}return P(t,e),Object.defineProperty(t.prototype,"tip",{get:function(){return this.on?"展开":"收起"},enumerable:!1,configurable:!0}),t.prototype.dealClick=function(t){e.prototype.dealClick.call(this,t),this.element.showWidgetTip(this,this.tip,this.getHoverPoint())},t}(n2),s2=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stable=!0,t}return P(t,e),t.prototype.bindRefSystem=function(e){},Object.defineProperty(t.prototype,"isSupportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._checkSelectRelation=function(e){return null},t.prototype.dealUpdate=function(t){var n;e.prototype.dealUpdate.call(this,t),void 0===t.position&&void 0===t.size&&void 0===t.scale||(this.updateBorderBox(),null===(n=this.selfRefSystem)||void 0===n||n.updateTransform())},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y;return{left:t,top:n,right:t+this.size.width*this.scale,bottom:n+this.size.height*this.scale,rotate:0}},t}(ry),l2=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.parent=i,r.elementType=Za.RK_INNER_WINDOW,r.size=exports.E({},D1),r.renderer=j1,r.selfRefSystem=new F1(n),r.selfRefSystem.bindBaseElement(r),r.selfRefSystem.onAddElement=function(e){return r.onAddElement(e)},r.selfRefSystem.onRemoveElement=function(e){r.childElement===e&&(r.childElement=void 0,r.liveElement=void 0),r.parent.updateInnerWindows()},r}return P(t,e),Object.defineProperty(t.prototype,"coverSource",{get:function(){return this.parent.coverSource},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unavailable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMaxed",{get:function(){return this.parent.maxedWindow===this},enumerable:!1,configurable:!0}),t.prototype.onAddElement=function(e){if(e.elementType===Za.RK_LIVE_PLAYER)this.childElement=this.liveElement=e;else if(e.elementType===Za.VIDEO||e.elementType===Za.DOCUMENT){var t=e,n=t.size,i=t.position,r=function(e,t){var n=e.width,i=e.height+t,r=D1.width,o=r*i/n;return o>D1.height&&(r=(o=D1.height)*n/i),{x:(D1.width-r)/2,y:(D1.height-o)/2,scale:r/n}}(n,t.titleHeight),o=r.x,a=r.y,s=r.scale;t.dealUpdate({position:exports.E(exports.E({},i),{x:o,y:a}),scale:s}),this.childElement=t}this.parent.updateInnerWindows()},t.prototype.toggleMaximize=function(){this.parent.toggleMaxWindow(this)},t.prototype.addComment=function(){var e,t;return A(this,void 0,void 0,(function(){var n,i;return D(this,(function(r){switch(r.label){case 0:return(n=this.childElement)&&this.parent.addRongKeComment?(i="",n.elementType!==Za.RK_LIVE_PLAYER?[3,2]:[4,n.getScreenShot()]):[2];case 1:return i=r.sent(),[3,4];case 2:return n.elementType!==Za.DOCUMENT?[3,4]:[4,n.getScreenShot()];case 3:i=r.sent(),r.label=4;case 4:return null===(t=(e=this.parent).addRongKeComment)||void 0===t||t.call(e,i),[2]}}))}))},t.prototype.toggleMirror=function(){var e=this.liveElement;e&&(e.mirror=!e.mirror,this.upime.updateView(),this.parent.reportMirrorState(this,e.mirror))},t}(s2),c2=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;r.hostWindow=i,r.elementType=Za.RK_WINDOW_CTRL_BAR,r.size={width:D1.width,height:42},r.renderer=G1;var o=r.commentBtn=new o2(r,"commentBtn"),a=r.mirrorBtn=new i2(r,"mirrorBtn"),s=r.maxBtn=new r2(r,"maxBtn");return s.onclick=function(){return r.hostWindow.toggleMaximize()},r.addInnerWidget(o),o.onclick=function(){return r.hostWindow.addComment()},r.addInnerWidget(a),a.onclick=function(){r.hostWindow.toggleMirror()},r.addInnerWidget(s),r}return P(t,e),Object.defineProperty(t.prototype,"showBtns",{get:function(){var e=null!==this.upime.curMeetingChannel&&this.hostWindow.parent.supportMaxWindow,t=this.hostWindow.liveElement;return t&&(t.online&&!t.finished||(e=!1)),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"singleWinMode",{get:function(){return this.hostWindow.parent.singleWinMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"liveWinNum",{get:function(){return this.hostWindow.parent.liveWinNum},enumerable:!1,configurable:!0}),t}(s2),u2=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;r.parent=i,r.elementType=Za.RK_RIGHT_TOP_WINDOW,r._openning=!1,r.size={width:180,height:24},r.renderer=K1;var o=r.hideBtn=new a2(r,"hideBtn");return o.onclick=function(){return r.toggleHide()},r.addInnerWidget(o),r}return P(t,e),Object.defineProperty(t.prototype,"openning",{get:function(){return this._openning},set:function(e){this._openning=e,this.hideBtn.on=!this.openning},enumerable:!1,configurable:!0}),t.prototype.toggleHide=function(){this.openning=!this.openning,this.parent.toggleHideMinWindows()},t}(s2);!function(e){function t(t,n){var i=e.call(this,t,n)||this;i.elementType=Za.RK_TEACHING_RESEARCH,i.maxedWindowIndex=null,i.innerWindows=[],i.innerWindowCtrlBars=[],i.contentBox={left:0,top:0,right:932,bottom:526},i.commentListBox={left:933,top:0,right:1484,bottom:1061},i.customBox={left:0,top:527,right:932,bottom:1061},i.supportMaxWindow=!0,i.commentList=[],i.size={width:1483,height:1061},i.renderer=V1,i.onImageLoaded=function(e,t){var n=i.commentListBox.left+15+176*t,r=n+168,o=i.commentListBox.top+40+18+168*e;qt({left:n,top:o,right:r,bottom:o+147},i.upime.view.getViewbox())&&i.upime.updateView()},i.selfRefSystem=new F1(n),i.selfRefSystem.bindBaseElement(i);var r=1,o=new l2(t,"win1",i);o.dealUpdate({position:{x:0,y:133},zIndex:r++});var a=new c2(t,"winCtrl1",o),s=new l2(t,"win2",i),l=new c2(t,"winCtrl2",s),c=new l2(t,"win3",i),u=new c2(t,"winCtrl3",c);i.innerWindows=[o,s,c],i.innerWindowCtrlBars=[a,l,u],i.rightTopWindow=new u2(t,"rightTop",i),i.otherResourceTitle=new d2,i.commlistTitle=new p2,t.elementManager.addCustomRefSystemHost(i),i.unsubs.push(i.upime.subscribe("meetingStateChange",(function(e){e&&i.innerWindows.forEach((function(e){var t,n;e.liveElement&&(null===(n=null===(t=i.upime.curMeetingChannel)||void 0===t?void 0:t.externalMediaManager)||void 0===n||n.addLivePlayer(e.liveElement))})),e||i.innerWindows.forEach((function(e){var t=e.liveElement;t&&(t.stopPlay(),t.mirror=!1)})),i.updateInnerWindows()})),i.upime.subscribe("userPreferenceChange",(function(e){var t=(e||{}).addRongKeComment;t?(i.addRongKeComment=t,Xh({name:"添加点评",onClick:function(){return t()},id:"addComment"})):(i.addRongKeComment=void 0,Qh("addComment"))}))),i.loadCover();var d=t.userManager.addRongKeComment;return d&&(i.addRongKeComment=d,Xh({name:"添加点评",onClick:function(){return d()},id:"addComment"})),t.followManager.addCustomStateGroup(i,"teachingResearch"),i}P(t,e),Object.defineProperty(t.prototype,"maxedWindow",{get:function(){return null===this.maxedWindowIndex?null:this.innerWindows[this.maxedWindowIndex]||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSupportComment",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"singleWinMode",{get:function(){var e=this.innerWindows;e[0];var t=e[1],n=e[2];return!t.childElement&&!n.childElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"liveWinNum",{get:function(){var e=0;return this.innerWindows.forEach((function(t){return e+=+!!t.liveElement})),e},enumerable:!1,configurable:!0}),t.prototype.calcBorderBox=function(){return{left:0,top:0,right:this.commentListBox.right,bottom:this.commentListBox.bottom}},t.prototype.loadCover=function(){var e=this;if(f2.cover){var t=tr(f2.cover);er(t,(function(){e.coverSource=t,e.upime.updateView()}))}},t.prototype.getFullState=function(){var e,t;return{maxedWindowIndex:this.maxedWindowIndex,hideMinWindows:!this.rightTopWindow.openning,mirror1:(null===(e=this.innerWindows[0].liveElement)||void 0===e?void 0:e.mirror)||!1,mirror2:(null===(t=this.innerWindows[1].liveElement)||void 0===t?void 0:t.mirror)||!1}},t.prototype.dealStateChange=function(e,t){var n,i=!1;void 0!==e.maxedWindowIndex&&e.maxedWindowIndex!==this.maxedWindowIndex&&(this.maxedWindowIndex=e.maxedWindowIndex,i=!0),void 0!==e.hideMinWindows&&e.hideMinWindows==this.rightTopWindow.openning&&(this.rightTopWindow.openning=!e.hideMinWindows,i=!0),void 0!==e.mirror1&&(n=this.innerWindows[0].liveElement)&&e.mirror1!==n.mirror&&(n.mirror=e.mirror1,this.upime.updateView()),void 0!==e.mirror2&&(n=this.innerWindows[1].liveElement)&&e.mirror2!==n.mirror&&(n.mirror=e.mirror1,this.upime.updateView()),i&&this.updateInnerWindows()},t.prototype.reportFollowData=function(e){this.upime.followManager.syncCustomState("teachingResearch",e)},t.prototype.reportMirrorState=function(e,t){"win1"===e.id?this.reportFollowData({mirror1:t}):"win2"===e.id&&this.reportFollowData({mirror2:t})},t.prototype.onAdd=function(){var t;e.prototype.onAdd.call(this),null===(t=this.parentRefSystem)||void 0===t||t.addChildRS(this.selfRefSystem),this.updateBorderBox(),this.selfRefSystem.updateTransform()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.innerWindows.forEach((function(e){return e.destroy()})),this.innerWindowCtrlBars.forEach((function(e){return e.destroy()})),this.rightTopWindow.destroy()},t.prototype.getRefSystem=function(e){if(e.parentType===Za.RK_TEACHING_RESEARCH){var t=e.windowId,n=this.innerWindows[t-1];if(n)return n.selfRefSystem}return null},t.prototype.dealUpdate=function(t){var n=t,i=n.commentList,r=n.supportMaxWindow;n.size;var o=n.updateComment,a=N(n,["commentList","supportMaxWindow","size","updateComment"]);void 0!==i&&(this.initCommentList(i),this.updateCommentListBox()),void 0!==r&&(this.supportMaxWindow=r,this.updateInnerWindows()),void 0!==o&&(this.updateCommentList(o),this.updateCommentListBox()),e.prototype.dealUpdate.call(this,a)},t.prototype.updateCommentList=function(e){var t=e.userName,n=e.userId,i=e.id,r=e.update,o=this.commentList.findIndex((function(e){return e.userId==n}));if(null===r){if(o<0)return;var a=(l=this.commentList[o]).comments.findIndex((function(e){return e.id===i}));if(a<0)return;if(l.comments[a].destroy(),1===l.comments.length){for(var s=o+1;s<this.commentList.length;s++)this.commentList[s].row-=1;this.commentList.splice(o,1)}else{for(s=a+1;s<l.comments.length;s++)l.comments[s].col-=1;l.comments.splice(a,1),l.width-=176}}else if(o<0){var l=new O1(this,{userName:t,userId:n,comments:[r]},this.commentList.length);this.commentList.push(l)}else if(a=(l=this.commentList[o]).comments.findIndex((function(e){return e.id===i})),a<0){var c=new L1(l,r,l.comments.length);l.comments.push(c),l.width+=176}else(c=l.comments[a]).update(r)},t.prototype.initCommentList=function(e){var t=this;this.commentList=e.map((function(e,n){return new O1(t,e,n)}))},t.prototype.updateCommentListBox=function(){for(var e=this.commentList,t=this.commentListBox,n=t.left,i=t.top,r=Math.max(73+168*e.length-21,1061),o=551,a=0,s=this.commentList;a<s.length;a++){var l=s[a];o=Math.max(l.width,o)}this.commentListBox={left:n,top:i,right:n+o,bottom:i+r},this.customBox=exports.E(exports.E({},this.customBox),{bottom:this.commentListBox.bottom}),this.size={width:this.commentListBox.right,height:this.commentListBox.bottom},this.updateBorderBox(),this.upime.updateView()},t.prototype.updateInnerWindows=function(){var e=this,t=e.contentBox,n=e.maxedWindowIndex,i=e.selfRefSystem,r=e.rightTopWindow,o=e.innerWindows,a=e.innerWindowCtrlBars,s=e.supportMaxWindow,l=1,c=o[0],u=o[1],d=o[2],p=a[0],h=a[1],f=a[2];if(this.singleWinMode){i.removeElement(r),i.addElement(c),i.addChildRS(c.selfRefSystem),i.addElement(p),i.removeElement(u),i.removeChildRS(u.selfRefSystem),i.removeElement(h),i.removeElement(d),i.removeChildRS(d.selfRefSystem),i.removeElement(f);var m=t.right-t.left,v=t.bottom-t.top;c.dealUpdate({position:{x:0,y:0},scale:m/c.size.width,zIndex:l}),a[0].dealUpdate({position:{x:0,y:v-42},size:{width:m,height:42},zIndex:l++})}else if(null!==n&&s){var g=o[n],y=a[n];m=t.right-t.left,v=t.bottom-t.top,i.addElement(g),i.addChildRS(g.selfRefSystem),i.addElement(y),g.dealUpdate({position:{x:0,y:0},scale:m/g.size.width,zIndex:l++}),y.dealUpdate({position:{x:0,y:v-42},size:{width:m,height:42},zIndex:l++});var b=r.openning;if(i.addElement(r),r.dealUpdate({position:exports.E({},R1),zIndex:l++}),b){for(var E=R1,x=B1,w=E.x,C=E.y+x.height,S=0;S<this.innerWindows.length;S++)if(S!==n){var k=o[S];if(k.childElement){var _=a[S];i.addElement(k),i.addChildRS(k.selfRefSystem),i.addElement(_);var T=x.width/k.size.width;k.dealUpdate({position:{x:w,y:C},scale:T,zIndex:l++}),_.dealUpdate({position:{x:w,y:C+k.size.height*T-42},size:{width:x.width,height:42},zIndex:l++}),C+=k.size.height*T+2}}r.dealUpdate({size:{width:x.width,height:C-E.y-2}})}else{for(S=0;S<this.innerWindows.length;S++)if(S!==n){var I=o[S],P=a[S];i.removeElement(I),i.removeChildRS(I.selfRefSystem),i.removeElement(P)}r.dealUpdate({size:exports.E({},B1)})}}else{for(i.removeElement(r),w=0,C=o[2].childElement?0:133,S=0;S<2;S++)g=o[S],i.addElement(g),i.addChildRS(g.selfRefSystem),g.dealUpdate({position:{x:w,y:C},scale:1,zIndex:l++}),y=a[S],i.addElement(y),y.dealUpdate({position:{x:w,y:C+g.size.height-42},size:{width:g.size.width,height:42},zIndex:l++}),w+=g.size.width+4;o[2].childElement?(w=234,C=265,g=o[2],i.addElement(g),i.addChildRS(g.selfRefSystem),g.dealUpdate({position:{x:w,y:C},scale:1,zIndex:l++}),y=a[2],i.addElement(y),y.dealUpdate({position:{x:w,y:C+g.size.height-42},size:{width:g.size.width,height:42},zIndex:l++})):(i.removeElement(d),i.removeChildRS(d.selfRefSystem),i.removeElement(f))}this.selfRefSystem.sortChildren(),this.upime.updateView()},t.prototype.toggleMaxWindow=function(e){var t=this.innerWindows.indexOf(e);t===this.maxedWindowIndex?this.maxedWindowIndex=null:this.maxedWindowIndex=t,this.rightTopWindow.openning=null!==this.maxedWindowIndex,this.updateInnerWindows(),this.reportFollowData({maxedWindowIndex:this.maxedWindowIndex,hideMinWindows:!this.rightTopWindow.openning})},t.prototype.maximizeWindowByIndex=function(e){e!==this.maxedWindowIndex&&(this.maxedWindowIndex=e,this.rightTopWindow.openning=!0,this.updateInnerWindows())},t.prototype.restoreWindows=function(){this.maxedWindowIndex=null,this.rightTopWindow.openning=!0,this.updateInnerWindows(),this.reportFollowData({maxedWindowIndex:this.maxedWindowIndex,hideMinWindows:!this.rightTopWindow.openning})},t.prototype.toggleHideMinWindows=function(){this.updateInnerWindows(),this.reportFollowData({hideMinWindows:!this.rightTopWindow.openning})},t.prototype.checkInteractRelation=function(e,t){if(!t)return null;if("click"==t.type&&2===t.evt.Hits){var n=e.y-this.commentListBox.top-40-18,i=e.x-this.commentListBox.left-15;if(i<0||n<0)return null;var r=Math.floor(n/168),o=this.commentList[r];if(!o)return null;var a=o.comments,s=Math.floor(i/176),l=a[s];if(!l||!l.imgs.length)return null;i-=176*s,n-=168*r+35;for(var c=0;c<l.imgs.length;c++){var u=l.imgs[c],d=u.rect,p=u.src,h=l.imgSources[c];if(h.loaded&&i>d.x&&i<d.x+d.width&&n>d.y&&n<d.y+d.height)return{transparent:!1,metric:-1,metaData:{clickData:{customData:{type:"clickImg",src:p,width:h.originWidth,height:h.originHeight}}}}}}return null},t.prototype.dealClickStart=function(e){var t,n,i,r,o=null===(n=null===(t=e.metaData)||void 0===t?void 0:t.clickData)||void 0===n?void 0:n.customData;o&&(null===(r=(i=this.upime).previewExternalFile)||void 0===r||r.call(i,{width:o.width,height:o.height},o.src))}}(ry);var d2=function(){function e(){this.textData={text:"其它教研资源",fontFamily:He,fontSize:14,lineHeight:20}}return e.prototype.render=function(){Ra(this.textData,{x:0,y:0,fill:"#0C1024"})},e}(),p2=function(){function e(){this.textData1={text:"点评列表",fontFamily:He,fontSize:14,lineHeight:20},this.textData1.metrics=Da(this.textData1),this.text2x=this.textData1.metrics.width,this.textData2={text:"（评课阶段会展示所有老师的点评内容）",fontFamily:He,fontSize:14,lineHeight:20}}return e.prototype.render=function(){Ra(this.textData1,{x:0,y:0,fill:"#0C1024"}),Ra(this.textData2,{x:this.text2x,y:0,fill:"#91939C"})},e}(),h2=function(t){var n=t.viewbox,i=t.element,r=t.zIndex,o=e.useRef(null);e.useEffect((function(){var e=o.current;return i.bindDom(e)}),[]);var a=i.globalTransform,s=i.size,l=s.width,c=s.height,u=i.position,d=i.scale;u=a.apply(u),d*=a.currentScale*n.scale;var p={position:"absolute",zIndex:r,left:(u.x-n.left)*n.scale,top:(u.y-n.top)*n.scale,width:l,height:c,transform:"scale(".concat(d,")"),transformOrigin:"0 0"};return i.mounted&&i.cameraOn||(p.visibility="hidden"),e.createElement("div",{ref:o,className:j("border_2YHFX",i.mirror?"mirror_1uKai":""),style:p})};!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementType=Za.RK_LIVE_PLAYER,t.mirror=!1,t.micOn=!1,t.online=!1,t.cameraOn=!1,t.playing=!1,t.playerId="",t.playerType="camera",t.finished=!1,t.size=exports.E({},D1),t.renderer=q1,t.embeddedRenderer=h2,t.embedRenderKey="",t}P(t,e),t.prototype.dealUpdate=function(t){t.size;var n=N(t,["size"]);e.prototype.dealUpdate.call(this,n),(t.position||t.size||t.scale)&&this.updateBorderBox()},t.prototype.calcBorderBox=function(){var e=this.position,t=e.x,n=e.y;return{left:t,top:n,right:t+this.size.width*this.scale,bottom:n+this.size.height*this.scale,rotate:0}},t.prototype.updateOnline=function(e){this.online=e,this.upime.updateView()},t.prototype.updateMicState=function(e){this.micOn=e,this.upime.updateView()},t.prototype.updateCameraState=function(e){this.cameraOn=e,this.upime.updateView()},t.prototype.bindDom=function(e){var t=this;return this.playerDom=e,this.playCb&&this.playCb(e),function(){t.playerDom=void 0}},t.prototype.playRtcStream=function(e){this.playCb=e,this.playing?this.playerDom?e(this.playerDom):this.playCb=e:(this.playCb=e,this.playing=!0,this.embedRenderKey=this.renderKey+Date.now(),this.upime.view.addEmbeddedElement(this))},t.prototype.stopPlay=function(){this.cameraOn=!1,this.micOn=!1,this.online=!1,this.playing&&(this.playing=!1,this.upime.view.removeEmbeddedElement(this)),this.upime.updateView()},t.prototype.getScreenShot=function(){return A(this,void 0,void 0,(function(){var e,t;return D(this,(function(n){return this.playerDom&&this.cameraOn?(e=this.playerDom.getElementsByTagName("video")[0])?((t=document.createElement("canvas")).width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0),[2,t.toDataURL("jpeg")]):(e||(e=this.playerDom.getElementsByTagName("canvas")[0]),e?[2,e.toDataURL("jpeg")]:[2,""]):[2,""]}))}))},t.prototype.destroy=function(){this.playing&&this.stopPlay()}}(ry);var f2={},m2={root:"root_3Aofq",active:"active_3Pn19",phoneMode:"phoneMode_5StJY",gdIcon:"gdIcon_39p2c",createContainer:"createContainer_24LUP",head:"head_1vkan",iconBtn:"iconBtn_2IhHu",body:"body_2o5F4",geshuContainer:"geshuContainer_2nY_L",contentContainer:"contentContainer_3pWR4",choose:"choose_2sEUS",lianjie:"lianjie_2MLOQ",iconBox:"iconBox_Pyr4-",guanbi:"guanbi_23AL6",nameTip:"nameTip_3tcPN",memberContainer:"memberContainer_2LlbH",row:"row_MhIw9",modedesc:"modedesc_2G4DT",createBtnBox:"createBtnBox_1PMxo",createBtn:"createBtn_3_ZU6",diabled:"diabled_4MDGe",scrollBar:"scrollBar_hgJ4z",listContainer:"listContainer_XvAoi",bukelikai:"bukelikai_1H2QE",shuomin:"shuomin_1G0Kt",opBar:"opBar_2sGoB",countBox:"countBox_20uCY",rechooseBox:"rechooseBox_2NzSv",disable:"disable_Be9Ik",groupArea:"groupArea_IMHOO",notManager:"notManager_2IjiF",plusRow:"plusRow_g9so3",actionRow:"actionRow_XoOaK",btn:"btn_3SQhy",jiesan:"jiesan_3dNFl",kaishi:"kaishi_CukL6",disabled:"disabled_SuNKR",groupContainer:"groupContainer_19veS",noSelected:"noSelected_32nGB",selected:"selected_MdleE",name:"name_2qTTu",text:"text_1ZDXk",buttonBlock:"buttonBlock_1e0zf",deletePop:"deletePop_1_iVu",action:"action_3HgI1",clearInput:"clearInput_SwQ0p",freeAction:"freeAction_o0O5q",leave:"leave_5qHUU",join:"join_3nPsU",lianmai:"lianmai_3vgop",oncalltip:"oncalltip_2QmQE",content:"content_zbWsK",frameName:"frameName_C001Q",noContent:"noContent_2spGY",users:"users_2qAOk",members:"members_3SGpi",member:"member_13iLs",moreCircle:"moreCircle_3ChH9",userList:"userList_2BrnT",addUser:"addUser_1HcYw",addUserContainer:"addUserContainer_2RFCB",tabBar:"tabBar_1Bfsl",searchRow:"searchRow_YsuYg",list:"list_3HcRv",benzuRow:"benzuRow_hlVN5",avatar:"avatar_2MKFb",userName:"userName_3qeQy",subtitle:"subtitle_1u7DJ",otherRow:"otherRow_1kMnh",noResult:"noResult_3mknx",whiteBorder:"whiteBorder_1sKzD",chooseTipContainer:"chooseTipContainer_1A3dT",divider:"divider_2NIeK",tuichu:"tuichu_ouDWv",infoBar:"infoBar_3oU6W",creatorBox:"creatorBox_2Db2c",nameBox:"nameBox_1cQzn",timerContainer:"timerContainer_2kw-F",daikaishi:"daikaishi_2GtOK",talkReminderToastContainer:"talkReminderToastContainer_3jeQi",msgBox:"msgBox_2TjUe",actionBox:"actionBox_1gEGA",ruhecaozuo:"ruhecaozuo_2sLB1",endTalk:"endTalk_24JQA",modalBox:"modalBox_2GVnc",contentRow:"contentRow_2GmiB",actionsRow:"actionsRow_fle3w",noPermisionContainer:"noPermisionContainer_3eWyp",imgBox:"imgBox_2uAmS",textBox:"textBox_3mhj8",toolbarBox:"toolbarBox_30Xq3",miniCtrlBox:"miniCtrlBox_3TxQJ",mini_btn_split:"mini_btn_split_26RaN",infoBox:"infoBox_17i9X",timing:"timing_1XYpy",backtoframe:"backtoframe_3L8Lh",leaveBtn:"leaveBtn_9Y5lk",memberCtrlBox:"memberCtrlBox_17_gn",subWin:"subWin_3zjkU",panelRoot:"panelRoot_tJwct",title:"title_3rFjx",mainText:"mainText_2fa9X",closeBtnBox:"closeBtnBox_28tNw",closeIcon:"closeIcon_WCz7d",memberManageRoot:"memberManageRoot_1oYDf",header:"header_3bsuU",tab:"tab_15ipq",listRoot:"listRoot_2021L",entityRow:"entityRow_16P56",textBlock:"textBlock_1jjeI",note:"note_3Bqwv",mediaBox:"mediaBox_2P_bg",icon:"icon_3_mxE",onCall:"onCall_2eAiz",fullContainer:"fullContainer_1ctB7",ml12:"ml12_3nubw",onCallBox:"onCallBox_3BiQC",miniMode:"miniMode_eAHps",rtclistRoot:"rtclistRoot_1hpzf",hide:"hide_2hDgh",callModal:"callModal_GmNzb",titleRow:"titleRow_28PMV",subtitleRow:"subtitleRow_1cHc3",later:"later_2qmuT",enable:"enable_9TQOL",enterModalBox:"enterModalBox_oykxk",titlebar:"titlebar_Ik7tc",subtitlebar:"subtitlebar_tN7A7",actionbar:"actionbar_1aObq",okbtn:"okbtn_34mlI"};e.createContext({});var v2=e.createContext({}),g2=e.createContext({});function y2(t){var n=t.group,i=t.skipRef,r=t.defaultTab,o=t.onClickOther,a=t.onClickSelf,s=n.users,l=n.id,c=e.useState(1),u=c[0],d=c[1],p=W().getUpimeTrans,h=e.useState(""),f=h[0],m=h[1],v=e.useRef(null),g=Sl(M2),y=g.groupTalk,b=g.users.filter((function(e){return!s.find((function(t){return t.loginName===e.loginName}))})),E=y.groups.filter((function(e){return e.id!==l})),x=((null==E?void 0:E.reduce((function(e,t){return e.concat(t.users)}),[]))||[]).sort(FW),w=b.filter((function(e){return!(null==x?void 0:x.find((function(t){return t.loginName===e.loginName})))}));return e.useEffect((function(){void 0!==r?d(r):0===x.length&&0===w.length?d(0):d(1)}),[]),e.createElement("div",{className:m2.addUserContainer,ref:i,onClick:function(e){e.stopPropagation()}},e.createElement("div",{className:m2.tabBar},e.createElement("div",{onClick:function(){d(0)},style:0===u?{backgroundColor:"#fff",color:"#0c1024"}:{}},p("grouptalk.benzuchengyuan")," ",s.length),e.createElement("div",{onClick:function(){d(1)},style:1===u?{backgroundColor:"#fff",color:"#0c1024"}:{}},p("grouptalk.qita")," ",b.length)),e.createElement("div",{className:m2.searchRow},e.createElement(hl,{icon:"sousuo"}),e.createElement("input",{type:"text",placeholder:p("grouptalk.user.search.placeholder"),value:f,ref:v,onChange:function(e){m(e.target.value)}}),f&&e.createElement("div",{className:m2.clearInput,onClick:function(){var e;m(""),null===(e=v.current)||void 0===e||e.focus()}},e.createElement(hl,{icon:"guanbi"}))),0===u&&e.createElement("div",{className:j(m2.list)},s.filter((function(e){return e.userName.includes(f)})).length>0&&s.filter((function(e){return e.userName.includes(f)})).map((function(t){return e.createElement("div",{key:t.loginName,className:m2.benzuRow,onClick:function(){_e.desktop||a(t)}},e.createElement(ml,{url:t.avatarUrl,className:m2.avatar}),e.createElement("span",{className:m2.userName},t.userName),e.createElement("div",{className:m2.iconBox,onClick:function(e){_e.desktop&&(a(t),e.stopPropagation())}},e.createElement(hl,{icon:"guanbi",size:14})))})),0===s.filter((function(e){return e.userName.includes(f)})).length?""===f?e.createElement("div",{className:m2.noResult},p("grouptalk.zanwuchengyuan")):e.createElement("div",{className:m2.noResult},p("search.noSearchRes")):null),1===u&&e.createElement("div",{className:j(m2.list)},w.filter((function(e){return e.userName.includes(f)})).length>0&&e.createElement(e.Fragment,null,e.createElement("div",{className:m2.subtitle},p("grouptalk.weijiaruzu")," （",w.length,"）"),w.filter((function(e){return e.userName.includes(f)})).map((function(t){return e.createElement("div",{key:t.loginName,className:m2.otherRow,onClick:function(){return o(t)}},e.createElement(ml,{url:t.avatarUrl,className:m2.avatar}),e.createElement("span",{className:m2.userName},t.userName))}))),x.filter((function(e){return e.userName.includes(f)})).length>0&&e.createElement(e.Fragment,null,e.createElement("div",{className:m2.subtitle},p("grouptalk.yijiaruzu"),"（",x.length,"）"),x.filter((function(e){return e.userName.includes(f)})).map((function(t){return e.createElement("div",{key:t.loginName,className:m2.otherRow,onClick:function(){return o(t)}},e.createElement(ml,{url:t.avatarUrl,className:m2.avatar}),e.createElement("span",{className:m2.userName},t.userName))}))),0===b.filter((function(e){return e.userName.includes(f)})).length?""===f?e.createElement("div",{className:m2.noResult},p("grouptalk.zanwuchengyuan")):e.createElement("div",{className:m2.noResult},p("search.noSearchRes")):null))}function b2(t,n){var i=this,r=e.useState(!1),o=r[0],a=r[1];return{calling:o,handleCalling:function(){return A(i,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return a(!0),n.mediaPlayController.fakePlay(),[4,t.requestRtc()];case 1:return e.sent(),n.rightSlidePanelType&&n.switchRightSlideExtension(A2),a(!1),[2]}}))}))}}}var E2=function(t){var n=t.group,i=t.selected,r=t.onClickOther,o=t.onClickSelf,a=t.onDeleteGroup,s=t.onClickJoin,l=t.onClickLeave;al(n,["groupChannel"]);var c=n.groupName,u=n.frame,d=n.users;n.id;var p=n.groupChannel,h=d.length>3,f=d.length>3?3:d.length,m=e.useRef(null),v=e.useState(!1),g=v[0],y=v[1],b=e.useState(c),E=b[0],x=b[1],w=e.useRef(!1),C=e.useReducer((function(e){return e+1}),0)[1],S=e.useState(u),k=S[0],_=S[1],T=e.useRef(null),I=e.useRef(null),P=yh(!0,{checkSkip:function(e){return!!T.current&&V(T.current,e)&&T.current!==e}}),N=P.hide,M=P.skipRef,A=P.toggleHide,D=yh(!0,{checkSkip:function(e){return!!I.current&&V(I.current,e)}}),R=D.hide,B=D.skipRef,L=D.toggleHide,O=yh(!0),F=O.hide,z=O.skipRef,H=O.setHide,U=O.toggleHide,G=Sl(M2),q=G.groupTalk,K=W().getUpimeTrans,Y=e.useContext(v2).refresh,X=e.useRef(null),Q=q.isManager,Z=q.isObserver,J=q.freeJoin,$=q.stage===S2.started,ee=d.find((function(e){return e.loginName===G.upime.localUserInfo.loginName})),te=G.upime.getLang();e.useEffect((function(){if(!1===i){w.current=!1;var e=ie.current;e.style.backgroundColor="unset",e.style.pointerEvents="none",e.readOnly=!0,C()}}),[i]),e.useEffect((function(){_(u)}),[u]),e.useEffect((function(){x(c)}),[c]),e.useEffect((function(){C()}),[d]),e.useEffect((function(){var e=m.current,t=function(){w.current||y(!0)},n=function(){F&&y(!1)};return e.addEventListener("mouseover",t),e.addEventListener("mouseleave",n),function(){e.removeEventListener("mouseover",t),e.removeEventListener("mouseleave",n)}}),[F]),e.useEffect((function(){var e=G.upime.subscribe("updatedUserInfo",_t.debounce((function(){C()}),1e3));return function(){e()}}),[]);var ne=e.useRef(""),ie=e.useRef(null),re=function(){var e,t=ie.current;w.current=!1,t.readOnly=!0,null===(e=window.getSelection())||void 0===e||e.empty(),t.style.pointerEvents="none",t.style.backgroundColor="unset",""===E.trim()?x(ne.current):q.setGroupName(n,E),C()};e.useEffect((function(){se(R?"fenzutaoluntianjiachengyuan":"fenzutaoluntianjiachengyuan-xuanzhong")}),[R]);var oe=e.useState("fenzutaoluntianjiachengyuan"),ae=oe[0],se=oe[1];e.useEffect((function(){if(I.current){var e=I.current,t=function(){R&&se("fenzutaoluntianjiachengyuan-hover")},n=function(){R&&se("fenzutaoluntianjiachengyuan")};return e.addEventListener("mouseenter",t),e.addEventListener("mouseout",n),function(){e.removeEventListener("mouseenter",t),e.removeEventListener("mouseout",n)}}}),[R]);var le=b2(n,G.upime),ce=le.calling,ue=le.handleCalling;return e.createElement("div",{className:j(m2.groupContainer,ee&&$&&m2.selected,!ee&&m2.noSelected),ref:m},e.createElement("div",{className:m2.name},e.createElement("input",{className:m2.text,value:E,ref:ie,onChange:function(e){x(e.target.value)},onBlur:re,onClick:function(e){w.current&&e.stopPropagation()},onKeyDown:function(e){"Enter"===e.key&&re()},readOnly:!0}),w.current&&e.createElement("div",{className:m2.clearInput,onMouseDown:function(e){e.preventDefault(),x("")},onClick:function(e){e.stopPropagation()}},e.createElement(hl,{icon:"guanbi"})),g&&Q&&!$&&e.createElement("span",{className:m2.buttonBlock,ref:X},e.createElement(Dl,{placement:"top",content:K("common.rename")},e.createElement("div",{className:m2.iconBox,onClick:function(e){e.stopPropagation();var t=ie.current;t.readOnly=!1,t.style.pointerEvents="auto",t.style.backgroundColor="#ececee",t.focus(),t.select(),y(!1),w.current=!0,ne.current=E}},e.createElement(hl,{size:18,icon:"bianji"}))),e.createElement(Dl,{placement:"top",content:K("common.delete")},e.createElement("div",{className:m2.iconBox,onClick:function(e){e.stopPropagation(),U()}},e.createElement(hl,{size:18,icon:"shanchu"}))),!F&&e.createElement("div",{className:m2.deletePop,ref:z},e.createElement("div",null,e.createElement(hl,{icon:"qingchu"}),e.createElement("span",null,K("grouptalk.sure.delete.zu"))),e.createElement("div",{className:m2.action},e.createElement("div",{onClick:function(e){e.stopPropagation(),H(!0)}},K("common.cancel")),e.createElement("div",{onClick:function(e){e.stopPropagation(),a()}},K("common.delete"))))),!Q&&J&&!$&&(ee?e.createElement("div",{className:j(m2.freeAction,m2.leave),onClick:function(e){e.stopPropagation(),l()}},K("grouptalk.leave")):e.createElement("div",{className:j(m2.freeAction,m2.join),onClick:function(e){e.stopPropagation(),s()}},K("grouptalk.join"))),(Q||Z)&&$&&(ee?e.createElement(e.Fragment,null,!p&&G.config.enableCall&&e.createElement("div",{className:j(m2.freeAction,m2.lianmai,ce&&m2.disable),style:{right:"cn"===te?"60px":"65px"},onClick:function(e){e.stopPropagation(),ue()}},ce?e.createElement(hl,{icon:"jiazai"}):e.createElement("span",null,K("grouptalk.lianmai"))),e.createElement("div",{className:j(m2.freeAction,m2.leave),onClick:function(e){e.stopPropagation(),l()}},K("grouptalk.leave"))):e.createElement("div",{className:j(m2.freeAction,m2.join),onClick:function(e){e.stopPropagation(),s()}},K("grouptalk.join"))),!Q&&!Z&&$&&ee&&G.config.enableCall&&(p?e.createElement("div",{className:m2.oncalltip},K("grouptalk.present")):e.createElement("div",{className:j(m2.freeAction,m2.lianmai,ce&&m2.disable),onClick:function(e){e.stopPropagation(),ue()}},ce?e.createElement(hl,{icon:"jiazai"}):e.createElement("span",null,K("grouptalk.lianmai"))))),e.createElement("div",{className:m2.content},!k||k.deleted?Q&&e.createElement("div",{className:j(m2.noContent,!Q&&m2.notManager),onClick:function(){Q&&(document.getElementById("rightSidePanel").style.display="none",G.chooseContent((function(e){_(e),q.setGroupFrame(n,e),G.closePick=null,G.clearChooseEffect()})))}},K("grouptalk.choose.content.benzu")):e.createElement(e.Fragment,null,e.createElement(hl,{icon:"iconlianjie",className:m2.lianjie}),e.createElement("span",{className:m2.frameName},k.name),Q&&!$&&e.createElement("div",{className:m2.iconBox,onClick:function(e){e.stopPropagation(),_(void 0),q.setGroupFrame(n,void 0),Y()}},e.createElement(hl,{icon:"guanbi",size:14,className:m2.guanbi})))),e.createElement("div",{className:m2.users},e.createElement("div",{className:m2.members,ref:T},d.slice(0,f).map((function(t,n){var i=6*n;return e.createElement(Dl,{placement:"bottom",content:t.userName,rootClass:m2.member,key:t.loginName,rootStyle:{right:i+"px",cursor:"auto"},onClick:function(e){e.stopPropagation()}},e.createElement(fX,{user:t,noTip:!0,className:m2.whiteBorder}))})),h&&e.createElement(Dl,{placement:"bottom",content:d[3].userName,enable:4===d.length,rootStyle:{right:6*f+"px",cursor:4===d.length?"auto":"pointer"},rootClass:j(m2.member),onClick:function(e){e.stopPropagation()}},4===d.length?e.createElement(fX,{user:d[3],noTip:!0,className:m2.whiteBorder}):e.createElement("div",{onClick:function(){A()},className:m2.moreCircle},"+",d.length-3))),!N&&d.length>0&&(Q?e.createElement(y2,{group:n,onClickOther:r,onClickSelf:o,skipRef:M,defaultTab:0}):e.createElement("div",{className:m2.userList,ref:M,onClick:function(e){e.stopPropagation()}},d.map((function(t){return e.createElement("div",{className:m2.row,key:t.loginName},e.createElement(ml,{className:m2.avatar,url:t.avatarUrl,shape:"circle"}),e.createElement("span",null,t.userName))})))),Q&&e.createElement("div",{ref:I},e.createElement(hl,{icon:ae,className:m2.addUser,onClick:function(e){e.stopPropagation(),L()}})),!R&&e.createElement(y2,{group:n,onClickOther:r,onClickSelf:o,skipRef:B,defaultTab:1})))};function x2(t){var n=t.success,i=Sl(M2),r=W().getUpimeTrans;return i.closeTip=n,e.useEffect((function(){return function(){i.closeTip=null}}),[]),e.createElement("div",{className:m2.chooseTipContainer},e.createElement("div",{className:m2.text},r("grouptalk.pick.tip")),e.createElement("div",{className:m2.divider}),e.createElement("div",{className:m2.tuichu,onClick:function(){var e;n(""),null===(e=i.closePick)||void 0===e||e.call(i),i.clearChooseEffect()}},r("grouptalk.pick.exit")))}var w2=0;function C2(t){var n=t.upime,i=t.userName,r=W().getUpimeTrans;return e.createElement("div",{className:m2.talkReminderToastContainer},e.createElement("div",{className:m2.msgBox},r("grouptalk.jijiangkaishi",i)),e.createElement("div",{className:m2.actionBox},e.createElement(ul,{type:"primary",className:m2.ruhecaozuo,onClick:function(){n.switchRightSlideExtension(A2,!0),n.removeToast(w2)}},r("grouptalk.lijichakan")),e.createElement(hl,{icon:"guanbi",onClick:function(){n.removeToast(w2)}})))}var S2,k2,_2,T2=function(t){var n=t.success,i=t.fail,r=W().getUpimeTrans,o=r("grouptalk.sure.stop"),a=r("grouptalk.jieshu");return e.createElement("div",{className:m2.modalBox},e.createElement("div",{className:m2.contentRow},e.createElement(hl,{icon:"jingshi",className:m2.iconContaienr}),e.createElement("span",{className:m2.modalContent},o)),e.createElement("div",{className:m2.actionsRow},e.createElement("button",{onClick:function(){return i("cancel")},className:m2.actionBt},r("modal.cancel")),e.createElement("button",{onClick:function(){return n(1)}},a)))},I2=function(){var t,n,i,r=Sl(M2),o=W().getUpimeTrans;al(r);var a=r.groupTalk,s=e.useState(0),l=s[0],c=s[1],u=(null==a?void 0:a.stage)===S2.started;return e.useEffect((function(){if(u){var e=Math.floor((Date.now()-a.startTime)/1e3/60);c(e);var t=window.setInterval((function(){c((function(e){return e+1}))}),6e4);return function(){window.clearInterval(t)}}}),[u]),r.talkExist?e.createElement("div",{className:m2.infoBar},e.createElement("div",{className:m2.creatorBox},e.createElement("div",null,o("common.faqiren"),"："),e.createElement(ml,{url:null===(t=null==a?void 0:a.creator)||void 0===t?void 0:t.avatarUrl,className:m2.avatar}),e.createElement(Dl,{placement:"top",content:null===(n=null==a?void 0:a.creator)||void 0===n?void 0:n.userName},e.createElement("div",{className:m2.nameBox},e.createElement("span",null,null===(i=null==a?void 0:a.creator)||void 0===i?void 0:i.userName)))),e.createElement("div",{className:m2.timerContainer},e.createElement(hl,{icon:"dingshiqi-9bp9o02e"}),u?e.createElement("span",null,l," mins"):e.createElement("span",{className:m2.daikaishi},o("grouptalk.daikaishi.tip")))):null},P2=function(t){var n=t.success,i=t.fail,r=W().getUpimeTrans;return e.createElement("div",{className:m2.modalBox},e.createElement("div",{className:m2.contentRow},e.createElement(hl,{icon:"jingshi",className:m2.iconContaienr}),e.createElement("span",{className:m2.modalContent},r("grouptalk.sure.dismiss.talk"))),e.createElement("div",{className:m2.actionsRow},e.createElement("button",{onClick:function(){return i("cancel")},className:m2.actionBt},r("modal.cancel")),e.createElement("button",{onClick:function(){return n(1)}},r("grouptalk.dismiss.btn"))))},N2=function(){var t=Sl(M2),n=t.groupTalk,i=e.useState(D2.get(t.upime.localUserInfo.loginName)),r=i[0],o=i[1],a=e.useReducer((function(e){return e+1}),0);a[0];var s=a[1],l=W().getUpimeTrans,c=e.useRef(null);al(n,["groups","stage"]),e.useEffect((function(){var e=D2.get(t.upime.localUserInfo.loginName);e!==r&&o(e)}),[n.groups]);var u=function(e){if(e.frame&&!1===e.frame.deleted){var n=.2*t.upime.view.viewWidth,i=.2*t.upime.view.viewHeight;t.upime.selectElement(e.frame),t.upime.makeBorderCenter(e.frame.getBorderBox(),{left:n,right:n,top:i,bottom:i})}},d=n.validGroups,p=d.some((function(e){return!e.frame||e.frame.deleted})),h=n.stage===S2.started,f=D2.get(t.upime.localUserInfo.loginName);return e.createElement(v2.Provider,{value:{refresh:s}},e.createElement("div",{className:m2.listContainer},e.createElement(I2,null),!h&&n.isManager&&e.createElement("div",{className:m2.opBar},e.createElement("div",{className:m2.countBox},l("grouptalk.group.count"),"（",n.validGroups.length,"）"),e.createElement("div",{className:j(m2.rechooseBox,0===n.validGroups.length&&m2.disable),onClick:function(){t.chooseContent((function(e){return A(void 0,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return[4,t.createFrameContentBatch(e,n,t.upime.getFrameContent(e))];case 1:return i=r.sent(),t.layoutFramesViewCenter(i),t.subService.updateGroups(n,n.groups),t.closePick=null,t.clearChooseEffect(),[2]}}))}))}))}},l("grouptalk.rechoose.btn"))),h&&(n.isManager?e.createElement("div",{className:m2.shuomin},l("grouptalk.zijineirong")):f?e.createElement("div",{className:m2.shuomin},l("grouptalk.zijineirong.zuyuan")):e.createElement("div",{className:m2.shuomin},l("grouptalk.zijineirong.pangguan"))),(null==n?void 0:n.freeJoin)&&!h&&!n.isManager&&e.createElement("div",{className:m2.bukelikai},e.createElement("span",null,l("grouptalk.bukelikai"))),e.createElement("div",{className:j(m2.groupArea,!n.isManager&&m2.notManager),ref:c},d&&d.map((function(i){return e.createElement("div",{key:i.id,onClick:function(e){!function(e,n){if(h){var i=D2.get(t.upime.localUserInfo.loginName);i?i===n.id&&u(n):u(n)}else u(n)}(0,i)}},e.createElement(E2,{group:i,selected:r===i.id,onClickOther:function(e){return function(e,t){n.setUserGroup(e,t),s()}(e,i)},onClickSelf:function(e){return function(e){n.setUserGroup(e,null),s()}(e)},onDeleteGroup:function(){return e=i,n.deleteGroup(e),e.users.forEach((function(e){D2.delete(e.loginName)})),e.users=[],void s();var e},onClickJoin:function(){return e=i,n.setUserGroup(t.upime.localUserInfo,e),void s();var e},onClickLeave:function(){return n.setUserGroup(t.upime.localUserInfo,null),void s()}}))})),!h&&n.isManager&&d&&d.length<t.config.maxGroupsNumber&&e.createElement("div",{className:m2.plusRow},e.createElement(hl,{icon:"tianjiafenzu",onClick:function(){return A(void 0,void 0,void 0,(function(){var e,i,r,o,a,u,d,p,h,f,m,v,g,y,b,E,x,w,C,S,k,_;return D(this,(function(T){switch(T.label){case 0:if(e=n.contentData,i=e.info,r=e.size,o=e.frameId,a=t.upime,u=a.elementManager.getElementById(o),d=n.groups.filter((function(e){return!e.deleted})),p="".concat(l("grouptalk.taolunzu")).concat(d.length+1),h=void 0,f=void 0,!u)return[3,2];for(m=a.calcEmptyFrameArea({size:r,refFrame:u}),v=m.x,g=m.y,y=JSON.stringify(i),b=JSON.parse(y),E=0;E<b.length;E++)if((x=b[E]).elementType===Za.FRAME){x.data.name=p+l("grouptalk.dezhenkuang");break}return w=[],[4,a.insertFrameContent(b,{x:v,y:g})];case 1:_=T.sent(),h=_[0],w=_[1],(f=new Yc(v,g,r.width,r.height)).name=p,f.users=[],C=Yt(w.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)}))),a.selectElements(w),S=.2*a.view.viewWidth,k=.2*a.view.viewHeight,a.makeBorderCenter(C,{left:S,right:S,top:k,bottom:k}),T.label=2;case 2:return n.createGroup({groupName:p,frame:h,viewRect:f,users:[]}),setTimeout((function(){var e=c.current;e&&e.scrollHeight>e.clientHeight&&(e.scrollTop+=130)})),s(),[2]}}))}))}}))),n.isManager&&(h?e.createElement("div",{className:m2.endTalk,onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,t.upime.showWindow(T2)];case 1:return 1!==e.sent()?[3,3]:[4,n.setTalkStage(S2.ended)];case 2:e.sent(),n.updateFramePropertyBatch({stable:!1}),s(),t.upime.addToast(l("grouptalk.end")),e.label=3;case 3:return[2]}}))}))}},l("grouptalk.stop")):e.createElement("div",{className:m2.actionRow},e.createElement("div",{onClick:function(){return A(void 0,void 0,void 0,(function(){var e;return D(this,(function(n){switch(n.label){case 0:return[4,t.upime.showWindow(P2)];case 1:return 1===n.sent()&&(null===(e=t.groupTalk)||void 0===e||e.dismissGroupTalk(),t.clearCurrentTalk(),t.talkExist=!1,t.upime.clearViewSection(),D2.clear()),[2]}}))}))},className:j(m2.btn,m2.jiesan)},l("grouptalk.dismiss")),!d||0===d.length||p?e.createElement(Dl,{placement:"top",content:l("grouptalk.kaishi.tip")},e.createElement("div",{className:j(m2.btn,m2.kaishi,m2.disabled)},l("grouptalk.kaishitaolun"))):e.createElement("div",{onClick:function(){return A(void 0,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,n.setRelatedMeeting()];case 1:return e.sent(),[4,n.setGroupViewRectBatch()];case 2:return e.sent(),[4,n.setTalkStage(S2.started)];case 3:return e.sent(),n.updateFramePropertyBatch({stable:!0}),t.upime.clearSelect(),o(D2.get(t.upime.localUserInfo.loginName)),s(),[2]}}))}))},className:j(m2.btn,m2.kaishi)},l("grouptalk.kaishitaolun"))))))},M2="groupTalk",A2={icon:"fenzutaolunqietu",key:"groupTalk",name:O("grouptalk.name"),className:"groupTalkIcon",toolPanel:function(){var t=Sl(M2);al(t);var n=W().getUpimeTrans;return t.talkExist?e.createElement(N2,null):t.upime.editable&&t.canCreateTalk?e.createElement(L2,null):e.createElement("div",{className:m2.noPermisionContainer},e.createElement("div",{className:m2.imgBox},e.createElement("img",{src:$o("no_content.png")})),e.createElement("div",{className:m2.textBox},n("grouptalk.nopermision.tip")))}},D2=new Map;!function(e){e[e.idle=0]="idle",e[e.started=1]="started",e[e.ended=2]="ended"}(S2||(S2={})),function(e){e[e.View=1]="View",e[e.Comment=2]="Comment",e[e.Edit=3]="Edit"}(k2||(k2={})),function(e){e[e.autoMode=1]="autoMode",e[e.manualMode=2]="manualMode",e[e.freeMode=3]="freeMode"}(_2||(_2={}));var R2,B2,L2=function(){var t=Sl(M2),n=e.useState(_2.autoMode),i=n[0],r=n[1],o=e.useState(t.config.defaultGroupsNumber),a=o[0],s=o[1],l=W().getUpimeTrans,c=t.selectedFrame,u=t.config;function d(e){t.selectedFrame=e}e.useEffect((function(){return function(){d(null)}}),[]);var p=t.users,h=Math.ceil(p.length/(a||u.defaultGroupsNumber));return e.createElement("div",{className:m2.createContainer},e.createElement("div",{className:m2.body},e.createElement("div",{className:m2.geshuContainer},e.createElement("div",null,l("grouptalk.group.count")),e.createElement(hl,{icon:"lansejian",style:1!==a&&a?{}:{pointerEvents:"none",opacity:"0.5"},onClick:function(){s(a-1)}}),e.createElement("input",{type:"text",value:a,onBeforeInput:function(e){var t=e.data;"0"<=t&&t<="9"||e.preventDefault()},onChange:function(e){var t=e.target.value;if(""!==t){if("0"!==t[0]){var n=parseInt(t);n>u.maxGroupsNumber||s(n)}}else s(t)},onBlur:function(){a||s(1)}}),e.createElement(hl,{icon:"lansejia",style:a===u.maxGroupsNumber?{pointerEvents:"none",opacity:"0.5"}:{},onClick:function(){s(a?a+1:1)}})),e.createElement("div",{className:m2.contentContainer},e.createElement("div",null,l("grouptalk.content")),e.createElement("div",null,l("grouptalk.desc")),e.createElement("div",{className:m2.choose,onClick:function(){c||(document.getElementById("rightSidePanel").style.display="none",t.chooseContent((function(e){d(e),t.closePick=null,t.clearChooseEffect()})))},style:c?{textDecoration:"none"}:{textAlign:"center"}},c&&e.createElement(hl,{icon:"iconlianjie",className:m2.lianjie}),c?e.createElement("span",null,c.name):e.createElement("span",{className:m2.nameTip},l("grouptalk.choose.content")),c&&e.createElement("div",{className:m2.iconBox,onClick:function(){d(null)}},e.createElement(hl,{icon:"guanbi",className:m2.guanbi})))),e.createElement("div",{className:m2.memberContainer},e.createElement("div",null,l("grouptalk.zuyuan")),e.createElement("div",{className:m2.row},e.createElement("input",{type:"radio",id:"zidong",name:"1",value:_2.autoMode,checked:i===_2.autoMode,onChange:function(){return r(_2.autoMode)}}),e.createElement("label",{htmlFor:"zidong"},l("grouptalk.automode")),e.createElement("span",{style:{color:"#91939c",marginLeft:"12px"}},l("grouptalk.pingjunmeizu",h-1,h))),e.createElement("div",{className:m2.modedesc},l("grouptalk.automode.desc")),e.createElement("div",{className:m2.row},e.createElement("input",{type:"radio",id:"shoudong",name:"2",value:_2.manualMode,checked:i===_2.manualMode,onChange:function(){return r(_2.manualMode)}}),e.createElement("label",{htmlFor:"shoudong"},l("grouptalk.manuelmode"))),e.createElement("div",{className:m2.modedesc},l("grouptalk.manualmode.desc")),e.createElement("div",{className:m2.row},e.createElement("input",{type:"radio",id:"ziyou",name:"3",value:"3",checked:i===_2.freeMode,onChange:function(){return r(_2.freeMode)}}),e.createElement("label",{htmlFor:"ziyou"},l("grouptalk.freemode"))),e.createElement("div",{className:m2.modedesc},l("grouptalk.freemode.desc"))),e.createElement(Dl,{enable:null===c,content:l("grouptalk.choose.content"),rootClass:m2.createBtnBox,placement:"top"},e.createElement("div",{className:j(m2.createBtn,(null===c||!a)&&m2.diabled),onClick:function(){null!==c&&a&&t.createGroupTalk({count:a,content:c,memberType:i})}},l("grouptalk.create")))))};!function(e){e[e.TALK_DATA=0]="TALK_DATA",e[e.GROUP_UPDATE=1]="GROUP_UPDATE",e[e.USER_GROUP_UPDATE=2]="USER_GROUP_UPDATE",e[e.TALK_STAGE_UPDATE=3]="TALK_STAGE_UPDATE",e[e.CLOSE_TALK=4]="CLOSE_TALK",e[e.RELATED_MEETING=5]="RELATED_MEETING",e[e.JOIN_RTC=6]="JOIN_RTC",e[e.KICK_OUT=7]="KICK_OUT",e[e.LEAVE_RTC=8]="LEAVE_RTC",e[e.APPLY_HOST=9]="APPLY_HOST",e[e.PERM_CHANGED=10]="PERM_CHANGED",e[e.RTC_USERS=11]="RTC_USERS",e[e.RTC_USER_JOIN=12]="RTC_USER_JOIN",e[e.RTC_USER_LEAVE=13]="RTC_USER_LEAVE"}(R2||(R2={})),function(e){e[e.server_error=-1]="server_error",e[e.group_no_exist=1]="group_no_exist",e[e.talk_no_start=2]="talk_no_start",e[e.reach_host_limit=3]="reach_host_limit",e[e.no_in_rtc=4]="no_in_rtc"}(B2||(B2={}));var O2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){var t=e;switch(t[0]){case R2.TALK_DATA:return{type:t[0],data:t[1]};case R2.GROUP_UPDATE:return{type:t[0],talkId:t[1],groupChanges:t[2]};case R2.USER_GROUP_UPDATE:return{type:t[0],talkId:t[1],userId:t[2],groupId:t[3]};case R2.TALK_STAGE_UPDATE:return{type:t[0],talkId:t[1],stage:t[2]};case R2.RELATED_MEETING:return{type:t[0],talkId:t[1],meetingId:t[2]};case R2.RTC_USERS:return{type:t[0],talkId:t[1],groupId:t[2],userIds:t[3]};case R2.RTC_USER_JOIN:case R2.RTC_USER_LEAVE:return{type:t[0],talkId:t[1],groupId:t[2],userId:t[3]}}},t.prototype.getGroupData=function(e){var t=e.id,n=e.groupName,i=e.deleted,r=e.users,o=e.frame,a=e.viewClipRect,s={id:t,groupName:n,deleted:i,userIds:r.map((function(e){return e.loginName}))};return o&&(s.bindingFrame=o.id),a&&(s.viewRect=a.rect),s},t.prototype.createTalk=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p=this;return D(this,(function(h){switch(h.label){case 0:return t=e.talkId,n=e.freeJoin,i=e.stage,r=e.groups,o=e.creator,a=e.managers,s=e.contentData,l=e.observers,c=e.relatedMeeting,u={id:t,contentData:s,freeJoin:n,managers:a.map((function(e){return e.loginName})),stage:i,observers:l,relatedMeeting:c,groups:r.map((function(e){return p.getGroupData(e)}))},o&&(u.creator=o.loginName),[4,this.sendRCmd(R2.TALK_DATA,u)];case 1:return 0===(d=h.sent())[0]?[2,d[1]]:[2,null]}}))}))},t.prototype.createGroup=function(e,t){var n=this,i=t.map((function(e){return{groupId:e.id,dataChange:n.getGroupData(e)}}));return this.sendRCmd(R2.GROUP_UPDATE,e.talkId,i)},t.prototype.updateGroups=function(e,t){var n=t.map((function(e){var t,n;return{groupId:e.id,dataChange:{deleted:e.deleted,userIds:e.users.map((function(e){return e.loginName})),bindingFrame:(null===(t=e.frame)||void 0===t?void 0:t.id)||null,viewRect:(null===(n=e.viewClipRect)||void 0===n?void 0:n.rect)||null,groupName:e.groupName}}}));return this.sendRCmd(R2.GROUP_UPDATE,e.talkId,n)},t.prototype.updateUserGroup=function(e,t,n){return this.sendRCmd(R2.USER_GROUP_UPDATE,e.talkId,t.loginName,(null==n?void 0:n.id)||null)},t.prototype.updateTalkStage=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.sendRCmd(R2.TALK_STAGE_UPDATE,e.talkId,t)];case 1:return[2,n.sent()[0]]}}))}))},t.prototype.closeTalk=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return[2,this.sendRCmd(R2.CLOSE_TALK,e.talkId)]}))}))},t.prototype.reqJoinGroupRtc=function(e,t,n){return void 0===n&&(n=1),A(this,void 0,void 0,(function(){var i;return D(this,(function(r){switch(r.label){case 0:return[4,this.sendRCmd(R2.JOIN_RTC,e.talkId,t.id,n)];case 1:return 0===(i=r.sent())[0]?[2,i[1]]:[2,null]}}))}))},t.prototype.setRelatedMeeting=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){return[2,this.sendRCmd(R2.RELATED_MEETING,e.talkId,t)]}))}))},t}(Sp),F2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return P(t,e),t.prototype._open=function(){return Promise.resolve()},t.prototype._parseServiceCmd=function(e){switch(e[0]){case R2.JOIN_RTC:return{type:e[0],data:e[1]};case R2.KICK_OUT:return{type:e[0],reason:e[1]};case R2.LEAVE_RTC:return{type:e[0],userId:e[1]};case R2.PERM_CHANGED:return{type:e[0],data:e[1]}}},t.prototype.leaveGroupRtc=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.sendRCmd(R2.LEAVE_RTC)]}))}))},t.prototype.applyHostPermission=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.sendRCmd(R2.APPLY_HOST)]}))}))},t.prototype.reportStatusChange=function(e,t,n){this.sendSCmd(R2.PERM_CHANGED,{userId:e,perm:t,en:n})},t}(Sp),z2=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;o.group=i,o.rtcLocalStreamConfigs=r,o.subSvcMsgHandler=function(e){var t,n;switch(e.type){case R2.JOIN_RTC:var i=e.data,r=o.upime.getUserInfo(i.userId);o.remoteMemberStates&&(o.remoteMemberStates[i.userId]={userInfo:r,audio:!!(1&i.perm),video:!!(2&i.perm),screenShare:!1,mediaId:i.mediaId},o.remoteMemberStates=exports.E({},o.remoteMemberStates));break;case R2.LEAVE_RTC:var a=e.userId;o.remoteMemberStates[a]&&(delete o.remoteMemberStates[a],o.remoteMemberStates=exports.E({},o.remoteMemberStates));break;case R2.KICK_OUT:o.group.releaseGroupChannel(),null===(n=o.onLeaveChannelCB)||void 0===n||n.call(o);break;case R2.PERM_CHANGED:var s=e.data,l=(a=s.userId,s.perm),c=s.en;if(a===o.upime.localUserInfo.loginName)switch(l){case 1:c||o.disableLocalAudio(!1);break;case 2:c||o.disableLocalVideo(!1)}else o.remoteMemberStates[a]&&(o.remoteMemberStates=exports.E(exports.E({},o.remoteMemberStates),((t={})[a]=exports.E(exports.E(exports.E({},o.remoteMemberStates[a]),1===l&&{audio:c}),2===l&&{video:c}),t)))}};var a=n.rtcToken,s=n.initPerm,l=n.curJoiners,c=n.servicePort;return o.startRtc(a,s),o.initRemoteMemberData(l),o.subService=t.createSubService(F2,c,o.subSvcMsgHandler.bind(o)),o.subService.open(),o}return P(t,e),Object.defineProperty(t.prototype,"localUserId",{get:function(){return this.upime.localUserInfo.loginName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"absentJoiners",{get:function(){var e=R([this.localMemberState],Object.values(this.remoteMemberStates),!0);return this.group.users.filter((function(t){return!e.map((function(e){return e.userInfo.loginName})).includes(t.loginName)}))},enumerable:!1,configurable:!0}),t.prototype.initRemoteMemberData=function(e){var t=this,n=this.upime.localUserInfo;e.forEach((function(e){if(e.userId!==n.loginName){var i=t.upime.getUserInfo(e.userId);t.remoteMemberStates[e.userId]={userInfo:i,audio:!!(1&e.perm),video:!!(2&e.perm),screenShare:!1,mediaId:e.mediaId}}})),this.remoteMemberStates=exports.E({},this.remoteMemberStates)},t.prototype.startRtc=function(e,t){return A(this,void 0,void 0,(function(){return D(this,(function(n){switch(n.label){case 0:return[4,this.initRtcEngine(e,this.rtcLocalStreamConfigs)];case 1:return n.sent()?[3,5]:1&t?[4,this.enableLocalAudio()]:[3,3];case 2:n.sent(),n.label=3;case 3:return 2&t?[4,this.enableLocalVideo()]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.doApplyForHostRole=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return[4,this.subService.applyHostPermission()];case 1:return 0===(e=t.sent()[0])?[2,e]:e===B2.reach_host_limit?[2,1]:[2,"error "+e]}}))}))},t.prototype.onLocalAudioOpenSuccess=function(){this.subService.reportStatusChange(this.localUserId,1,!0)},t.prototype.onLocalAudioOpenFail=function(){this.subService.reportStatusChange(this.localUserId,1,!1)},t.prototype.onLocalAudioCloseSuccess=function(e){void 0===e&&(e=!0),e&&this.subService.reportStatusChange(this.localUserId,1,!1)},t.prototype.onLocalVideoOpenSuccess=function(){this.subService.reportStatusChange(this.localUserId,2,!0)},t.prototype.onLocalVideoOpenFail=function(){this.subService.reportStatusChange(this.localUserId,2,!1)},t.prototype.onLocalVideoCloseSuccess=function(e){e&&this.subService.reportStatusChange(this.localUserId,2,!1)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.subService.close()},t}(TG),H2=function(){function e(e,t,n,i,r,o,a){this.talk=e,this.id=t,this.groupName=n,this.deleted=i,this._users=r,this.frame=o,this.viewClipRect=a,this.rtcUsers=[]}return Object.defineProperty(e.prototype,"upime",{get:function(){return this.talk.plugin.upime},enumerable:!1,configurable:!0}),e.prototype.requestRtc=function(e){var t;return A(this,void 0,void 0,(function(){var n,i,r,o=this;return D(this,(function(a){switch(a.label){case 0:return[4,(n=this.talk).plugin.subService.reqJoinGroupRtc(n,this,e)];case 1:return(i=a.sent())&&(r=this.groupChannel=new z2(n.plugin.upime,i,this,null===(t=n.plugin.config)||void 0===t?void 0:t.rtcLocalStreamConfigs),this.rtcUsers=R(R([],this.rtcUsers,!0),[this.upime.localUserInfo.loginName],!1),this.groupChannel.onLeaveChannelCB=function(){o.groupChannel===r&&(o.groupChannel=void 0)}),[2]}}))}))},e.prototype.releaseGroupChannel=function(){var e=this;this.groupChannel&&(this.rtcUsers=this.rtcUsers.filter((function(t){return t!==e.upime.localUserInfo.loginName})),this.groupChannel.subService.leaveGroupRtc(),this.groupChannel.leaveRtc(),this.groupChannel.destroy(),this.groupChannel=void 0)},e.prototype.clearRtcUsers=function(){this.rtcUsers=[]},Object.defineProperty(e.prototype,"users",{get:function(){return this._users},set:function(e){this._users=e.sort(FW)},enumerable:!1,configurable:!0}),M([rl],e.prototype,"rtcUsers",void 0),M([rl],e.prototype,"groupChannel",void 0),M([il],e)}();function U2(t){var n=t.user,i=t.matchValue,r=t.me,o=t.group,a=W().getUpimeTrans,s=bh(i,n.userName).sects,l=e.useRef(null),c=e.useState(!1),u=c[0],d=c[1],p="";r?p="(".concat(a("common.me"),")"):n.role===Pt.VISITOR&&(p="(".concat(a("meeting.visitor"),")")),e.useEffect((function(){setTimeout((function(){l.current&&d(l.current.scrollWidth>l.current.clientWidth)}))}),[]);var h=o.rtcUsers.includes(n.loginName);return e.createElement("div",{className:m2.entityRow},e.createElement("div",{className:m2.infoBox},e.createElement(ml,{className:m2.avatar,url:n.avatarUrl,shape:"circle"}),e.createElement("div",{className:j(m2.textBlock)},e.createElement(Dl,{placement:"bottom",content:n.userName,enable:u,rootClass:m2.nameBox},e.createElement("span",{className:m2.name,ref:l},s.map((function(e){return e.value})))),p&&e.createElement("span",{className:m2.note},p))),h&&e.createElement("div",{className:m2.onCall},a("grouptalk.present")))}function W2(t){var n=t.group,i=t.value,r=W().getUpimeTrans;al(n);var o=e.useState(n.users),a=o[0],s=o[1],l=e.useState(!1),c=l[0],u=l[1],d=e.useContext(xl).upime,p=e.useCallback(te((function(e){var t;s((t=e,n.users.filter((function(e){return-1!==e.userName.search(t)})))),u(!1)}),200),[]);return e.useEffect((function(){u(!0),p(i)}),[i]),e.createElement("div",{className:j(m2.listRoot,m2.search)},c?e.createElement("div",{className:m2.fullContainer},e.createElement(hl,{icon:"jiazai",className:m2.loading})):0===a.length?e.createElement("div",{className:m2.fullContainer},e.createElement("span",null,r("search.noSearchRes"))):e.createElement("div",null,a.map((function(t){return e.createElement(U2,{key:t.loginName,user:t,me:t.loginName===d.localUserInfo.loginName,matchValue:i,group:n})}))))}function V2(t){var n=t.group;al(n);var i=e.useContext(xl).upime;return e.createElement("div",{className:m2.memberManageRoot},e.createElement("div",{className:m2.listRoot,id:"memberListRoot"},e.createElement("div",null,[i.localUserInfo].concat(n.users.filter((function(e){return e.loginName!==i.localUserInfo.loginName}))).map((function(t){return e.createElement(U2,{key:t.loginName,user:t,me:t.loginName===i.localUserInfo.loginName,group:n})})))))}var j2=function(t){var n=t.closePanel,i=t.group,r=W().getUpimeTrans,o=e.useState(""),a=o[0],s=o[1];return e.createElement("div",{className:j(m2.panelRoot),id:"memberManagePanelRoot"},e.createElement("div",{className:m2.title},e.createElement("span",{className:m2.mainText},r("grouptalk.group.members")+"(".concat(i.users.length,")")),e.createElement("span",{className:m2.actionBox},e.createElement("span",{onClick:n,className:m2.closeBtnBox},e.createElement(hl,{icon:"guanbi",className:m2.closeIcon})))),e.createElement(gl,{value:a,onChange:function(e){s(e.target.value)},placeholder:["meeting.search.member"],onClearClick:function(){s("")},icon:"sousuo",className:m2.mb12}),a?e.createElement(W2,{value:a,group:i}):e.createElement(V2,{group:i}))};function G2(t){var n=t.group,i=W().getUpimeTrans,r=e.useState(!0),o=r[0],a=r[1],s=e.useContext(g2);al(n);var l=s.miniMode;return e.createElement("div",{className:j(m2.memberCtrlBox,!n.groupChannel&&m2.ml12)},e.createElement("div",{className:j(m2.iconBox),onClick:function(){a(!o)}},e.createElement(hl,{icon:"tuandui"}),!l&&e.createElement("span",null,i("grouptalk.group.members")+"(".concat(n.users.length,")"))),!o&&e.createElement(xh,{className:j(m2.subWin,l&&m2.miniMode),align:"center",selfAdjust:!0,adjustInfo:{adjustType:"adjustHeight",config:{minHeight:332,maxHeight:520}}},e.createElement(j2,{group:n,closePanel:function(){a(!0)}})))}function q2(){var t=Sl(M2),n=t.groupTalk,i=n.groups.find((function(e){return e.id===D2.get(t.upime.localUserInfo.loginName)}));al(i),al(t.upime,["hideControls"]);var r=e.useState(!i.groupChannel),o=r[0],a=r[1],s=W().getUpimeTrans,l=e.useState(0),c=l[0],u=l[1],d=b2(i,t.upime),p=d.calling,h=d.handleCalling,f=n.observers.includes(t.upime.localUserInfo.loginName);e.useEffect((function(){var e=Math.floor((Date.now()-n.startTime)/1e3/60);u(e);var t=window.setInterval((function(){u((function(e){return e+1}))}),6e4);return function(){window.clearInterval(t)}}),[]),e.useEffect((function(){return t.upime.subscribe("toolbarVisibilityChange",(function(e){"hidden"===e&&a(!0)}))}),[]);var m=t.upime.phoneMode||t.upime.hideControls;return e.createElement(g2.Provider,{value:{groupChannel:i.groupChannel,miniMode:o}},e.createElement("div",{className:j(m2.toolbarBox,o&&m2.miniMode,m&&m2.hide)},i.groupChannel&&e.createElement(e.Fragment,null,e.createElement("div",{className:m2.miniCtrlBox,onClick:function(){a(!o)}},e.createElement(hl,{className:j(m2.mini_icon),icon:"jiantou-xia"})),e.createElement("div",{className:m2.mini_btn_split})),e.createElement("div",{className:m2.infoBox},e.createElement("span",{className:m2.text},s("grouptalk.going")),e.createElement("span",{className:m2.timing},c,"mins")),i.groupChannel&&e.createElement(jQ,{miniMode:o,rtcChannel:i.groupChannel}),e.createElement(G2,{group:i}),e.createElement("div",{className:m2.backtoframe,onClick:function(){var e=D2.get(t.upime.localUserInfo.loginName);if(e){var i=n.groups.find((function(t){return t.id===e}));if(i&&i.frame){var r=Yt([i.frame].map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)})));t.upime.makeBorderCenter(r,{left:90,right:20,top:60,bottom:60})}}}},e.createElement(hl,{icon:"huidaozhushitu"}),!o&&e.createElement("span",null,s("grouptalk.backtoframe"))),!i.groupChannel&&t.config.enableCall&&e.createElement("div",{className:m2.onCallBox,onClick:h},p?e.createElement(hl,{icon:"jiazai"}):e.createElement("span",null,s("grouptalk.lianmai"))),f&&e.createElement("div",{className:m2.leaveBtn,onClick:function(){n.setUserGroup(t.upime.localUserInfo,null)}},s("grouptalk.leave"))),i.groupChannel&&e.createElement(aG,{upime:t.upime,rtcChannel:i.groupChannel,className:j(m2.rtclistRoot,m&&m2.hide)}))}var K2=function(t){var n=t.success,i=t.fail,r=t.content,o=W().getUpimeTrans;return e.createElement("div",{className:m2.callModal},e.createElement("div",{className:m2.titleRow},e.createElement(hl,{icon:"jingshi"}),e.createElement("span",{className:m2.title},o("grouptalk.call.modal.title"))),e.createElement("div",{className:m2.subtitleRow},e.createElement("span",null,o("grouptalk.call.modal.subtitle"))),e.createElement("div",{className:m2.actionRow},e.createElement("div",{className:m2.later,onClick:function(){i("close")}},o("grouptalk.call.modal.action.later")),e.createElement("div",{className:m2.enable,onClick:function(){n(!0),r&&r.onConfirm()}},o("grouptalk.call.modal.action.enable"))))},Y2=function(){function e(e,t){var n=this;this.plugin=e,this.talkId=t,this.freeJoin=!1,this.managers=[],this.observers=[],this.stage=S2.idle,this.toolbarId=null,this.wasOnCall=!1,this.perm=Hq.Edit,this.groups=[],this.createTime=0,this.startTime=0,this.checkJoinMeeting=function(e,t){return void 0===t&&(t=!1),A(n,void 0,void 0,(function(){var n=this;return D(this,(function(i){return t?e===this.relatedMeeting&&this.plugin.config.enableCall&&this.plugin.upime.showWindow(K2,{onConfirm:function(){var e;n.plugin.upime.mediaPlayController.fakePlay(),null===(e=n.joinedGroup)||void 0===e||e.requestRtc()}}):this.plugin.upime.addToast(O("grouptalk.preventMeetingToast")),[2,!1]}))}))}}return Object.defineProperty(e.prototype,"validGroups",{get:function(){return this.groups.filter((function(e){return!1===e.deleted}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isManager",{get:function(){return this.managers.map((function(e){return e.loginName})).includes(this.plugin.upime.localUserInfo.loginName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isObserver",{get:function(){return this.observers.includes(this.plugin.upime.localUserInfo.loginName)},enumerable:!1,configurable:!0}),e.prototype.setViewSections=function(){var e=this.plugin.upime;e.clearViewSection(),this.stage===S2.started&&this.validGroups.forEach((function(t){t.viewClipRect&&e.addViewSection(t.viewClipRect)}))},e.prototype.setViewClipToGroupFrame=function(e,t){var n=this.plugin.upime;n.clearViewSection(),t.clearViewClip(),n.clearSelect();var i=e.viewClipRect;if(i&&(t.setViewClip(i),e.frame)){var r={left:i.x,right:i.x+i.width,top:i.y,bottom:i.y+i.height};n.makeBorderCenter(r,{left:90,right:20,top:60,bottom:60})}},e.prototype.insertTalkingCtrlCmp=function(){var e=this.plugin.upime;this.removeTalkingCtrlCmp(),this.toolbarId=e.addSdkPluginCmp(q2,M2)},e.prototype.removeTalkingCtrlCmp=function(){this.toolbarId&&(this.plugin.upime.removeSdkPluginCmp(this.toolbarId),this.toolbarId=null)},e.prototype.dismissGroupTalk=function(){this.plugin.subService.closeTalk(this)},e.prototype.createLocalGroup=function(e){var t=e.groupName,n=e.frame,i=e.users,r=new H2(this,this.plugin.genNewId(),t,!1,i,n);this.groups.push(r)},e.prototype.createGroup=function(e){var t=e.groupName,n=e.frame,i=e.users,r=e.viewRect;return A(this,void 0,void 0,(function(){var e;return D(this,(function(o){return e=new H2(this,this.plugin.genNewId(),t,!1,i,n,r),this.groups.push(e),this.plugin.subService.createGroup(this,[e]),[2]}))}))},e.prototype.deleteGroup=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){return e.deleted=!0,this.plugin.subService.updateGroups(this,[e]),[2]}))}))},e.prototype.setGroupFrame=function(e,t){return A(this,void 0,void 0,(function(){var n;return D(this,(function(i){switch(i.label){case 0:return e.frame=t,t?((n=new Yc(t.position.x,t.position.y,t.size.width,t.size.height)).name=e.groupName,n.users=e.users,e.viewClipRect=n):e.viewClipRect=void 0,[4,this.plugin.subService.updateGroups(this,[e])];case 1:return[2,i.sent()]}}))}))},e.prototype.setGroupViewRectBatch=function(){return A(this,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return this.validGroups.forEach((function(e){var t=e.frame;if(t){var n=new Yc(t.position.x,t.position.y,t.size.width,t.size.height);n.name=e.groupName,n.users=e.users,e.viewClipRect=n}})),[4,this.plugin.subService.updateGroups(this,this.groups)];case 1:return[2,e.sent()]}}))}))},e.prototype.updateFramePropertyBatch=function(e){var t=this.validGroups.map((function(e){return e.frame}));if(t){var n=this.plugin.upime,i=n.createOperation();t.forEach((function(t){t&&i.update(t,e)})),i.sync(),n.deleteOperation(i)}},e.prototype.setGroupName=function(e,t){e.groupName=t,e.viewClipRect&&(e.viewClipRect.name=t),this.plugin.subService.updateGroups(this,[e])},e.prototype.setUserGroup=function(e,t){if(!t||D2.get(e.loginName)!==t.id){this.plugin.subService.updateUserGroup(this,e,t);var n=e.loginName===this.plugin.upime.localUserInfo.loginName,i=this.validGroups.find((function(t){return t.id===D2.get(e.loginName)}));i&&(i.users=i.users.filter((function(t){return t.loginName!==e.loginName})),i.viewClipRect&&(i.viewClipRect.users=i.users)),t?(D2.set(e.loginName,t.id),t.users=R(R([],t.users,!0),[e],!1),t.viewClipRect&&(t.viewClipRect.users=t.users,t.viewClipRect.name=t.groupName)):D2.delete(e.loginName),n&&this.setJoinedGroup(t)}},e.prototype.setTalkStage=function(e){return A(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:return[4,this.plugin.subService.updateTalkStage(this,e)];case 1:return 0===t.sent()&&(this.stage=e,e===S2.started?this.onStartTalk():e===S2.ended&&this.onEndTalk()),[2]}}))}))},e.prototype.setRelatedMeeting=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return(e=this.plugin.upime.curMeetingChannel)?[4,this.plugin.subService.setRelatedMeeting(this,e.id)]:[3,2];case 1:0===t.sent()[0]&&(this.relatedMeeting=e.id),t.label=2;case 2:return[2]}}))}))},e.prototype.preventJoinMeeting=function(){this.plugin.upime.meetingManager.addJoinMeetingChecker(this.checkJoinMeeting)},e.prototype.cancelPreventJoinMeeting=function(){this.plugin.upime.meetingManager.removeJoinMeetingChecker(this.checkJoinMeeting)},e.prototype.onJoinTalking=function(e){var t,n=this;this.preventJoinMeeting();var i=this.plugin,r=i.upime,o=i.config;null===(t=o.onJoinTalking)||void 0===t||t.call(o);var a=!1,s=0;if(r.curMeetingChannel){r.curMeetingChannel.localAudioEnabled&&(s=1);var l=r.curMeetingChannel.id;r.endMeetingMode(l,XW.LEAVE),l===this.relatedMeeting&&(a=!0)}var c=new IG(r);this.talkingScene=c,this.talkingScene.name="talk",this.talkingScene.onActive=function(){r.clearViewSection()},this.talkingScene.onInactive=function(){n.setViewSections()},r.sceneManager.addScene(c),a&&e.requestRtc(s),this.setViewClipToGroupFrame(e,c),this.insertTalkingCtrlCmp(),r.mutateCustomFoldableTool("groupTalk",{forceBoxActive:!0}),r.addPluginPerm({pluginId:M2,perm:this.perm}),r.addToast(O("grouptalk.yijinru")+e.groupName)},e.prototype.onLeaveTalking=function(e){var t,n,i;void 0===e&&(e=!0),this.cancelPreventJoinMeeting(),this.setViewSections(),this.removeTalkingCtrlCmp(),this.plugin.upime.mutateCustomFoldableTool("groupTalk",{forceBoxActive:!1}),this.plugin.upime.removePluginPerm(M2),e&&(null===(n=(t=this.plugin.config).onLeaveTalking)||void 0===n||n.call(t)),(null===(i=this.joinedGroup)||void 0===i?void 0:i.groupChannel)&&(this.wasOnCall=!0,this.joinedGroup.releaseGroupChannel(),e&&this.backToMeeting()),this.talkingScene&&(this.talkingScene.onActive=void 0,this.talkingScene.onInactive=void 0,this.talkingScene.remove(),this.talkingScene=void 0)},e.prototype.onStartTalk=function(){var e=this.plugin.upime;this.startTime=Date.now(),this.joinedGroup?this.onJoinTalking(this.joinedGroup):this.setViewSections(),e.mutateCustomFoldableTool("groupTalk",{icon:"fenzutaolunjinhangzhongweicanyu"})},e.prototype.onEndTalk=function(){var e,t=this.plugin.upime;this.joinedGroup&&(this.onLeaveTalking(),this.joinedGroup.clearRtcUsers()),t.mutateCustomFoldableTool("groupTalk",{icon:"fenzutaolunqietu"}),null===(e=this.talkingScene)||void 0===e||e.clearViewClip(),t.clearViewSection()},e.prototype.setJoinedGroup=function(e){var t=this.joinedGroup;this.stage===S2.started&&(t&&this.onLeaveTalking(!e),e&&this.onJoinTalking(e)),this.joinedGroup=e||void 0},e.prototype.backToMeeting=function(){return A(this,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return this.relatedMeeting?[4,this.plugin.upime.meetingManager.queryMeeting(this.relatedMeeting)]:[3,2];case 1:(e=t.sent())&&e.status!==zW.CANCELED&&e.status!==zW.ENDED&&this.plugin.upime.meetingManager.joinMeeting(this.relatedMeeting),t.label=2;case 2:return[2]}}))}))},e.prototype.destroy=function(){this.joinedGroup&&this.onLeaveTalking(),this.cancelPreventJoinMeeting(),this.wasOnCall=!1,this.plugin.upime.clearViewSection(),this.removeTalkingCtrlCmp()},M([rl],e.prototype,"groups",void 0),M([il],e)}();function X2(t){var n=t.fail,i=W().getUpimeTrans;return e.createElement("div",{className:m2.enterModalBox},e.createElement("div",{className:m2.titlebar},i("grouptalk.enter.modal.title")),e.createElement("div",{className:m2.subtitlebar},i("grouptalk.enter.modal.subtitle")),e.createElement("div",{className:m2.actionbar},e.createElement("div",{className:m2.okbtn,onClick:function(){n("close")}},i("common.iknow"))))}var Q2=function(){function t(e){var t=this;this.upime=e,this.pluginId=M2,this.groupTalk=null,this.selectedFrame=null,this.talkExist=!1,this.users=[],this.unsubs=[],this.closeTip=null,this.closePick=null,this.config={defaultGroupsNumber:2,maxGroupsNumber:100,enableCall:!0},this.canCreateTalk=!0,this.enterModalId=-1,this.onKeyDown=function(e){var n;"Escape"===e.key&&(null===(n=t.closePick)||void 0===n||n.call(t),t.clearChooseEffect())},this.subService=e.createSubService(O2,12,this),this.subService.open()}return t.prototype.genNewId=function(){return this.upime.genID("talkgroup_")},t.prototype.handleCmd=function(t){var n,i,r,o,a,s,l,c=this;if(t.type===R2.TALK_DATA){var u=t.data;if(this.clearCurrentTalk(),!u)return this.talkExist=!1,void D2.clear();var d=u.id,p=u.contentData,h=u.freeJoin,f=u.managers,m=u.observers,v=u.relatedMeeting,g=u.stage,y=u.groups,b=u.createTime,E=u.startTime,x=u.creator,w=this.groupTalk=new Y2(this,d);w.contentData=p,w.freeJoin=h,w.managers=f.map((function(e){return c.upime.getUserInfo(e)})),x&&(w.creator=this.upime.getUserInfo(x)),w.observers=m||[],w.relatedMeeting=v,w.stage=g,w.groups=y.filter((function(e){return!1===e.deleted})).map((function(e){e.userIds&&e.userIds.forEach((function(t){D2.set(t,e.id)}));var t,n=e.bindingFrame?c.upime.elementManager.getElementById(e.bindingFrame):void 0;return e.viewRect&&((t=new Yc(e.viewRect.x,e.viewRect.y,e.viewRect.width,e.viewRect.height)).name=e.groupName,t.users=e.userIds?e.userIds.map((function(e){return c.upime.getUserInfo(e)})):[]),new H2(w,e.id,e.groupName,e.deleted,e.userIds.length>0?e.userIds.map((function(e){return c.upime.getUserInfo(e)})):[],n,t)}));var C=D2.get(this.upime.localUserInfo.loginName);return w.joinedGroup=w.groups.find((function(e){return e.id===C})),g===S2.started&&(w.onStartTalk(),w.joinedGroup&&this.upime.switchRightSlideExtension(A2)),b&&(w.createTime=b),E&&(w.startTime=E),h&&!C&&(s=this.upime,l=this.upime.getUserInfo(x).userName,w2&&s.removeToast(w2),w2=s.addToast(e.createElement(C2,{upime:s,userName:l}),{autoHide:!1})),void(this.talkExist=!0)}var S=this.groupTalk;if(S&&t.talkId===S.talkId)switch(t.type){case R2.GROUP_UPDATE:for(var k=t.groupChanges,_=function(e){var t=k[e],n=S.groups.find((function(e){return e.id===t.groupId})),i=t.dataChange,r=i.bindingFrame,o=i.userIds,a=i.deleted,s=i.groupName;if(!n){var l=r?T.upime.elementManager.getElementById(r):void 0,u=void 0;if(l){var d=l.position,p=l.size;u=new Yc(d.x,d.y,p.width,p.height),s&&(u.name=s),o&&(u.users=o.map((function(e){return c.upime.getUserInfo(e)})))}return S.groups.push(new H2(T.groupTalk,t.groupId,s,a,void 0!==o&&o.length>0?o.map((function(e){return c.upime.getUserInfo(e)})):[],l,u)),"continue"}if(void 0!==r&&(n.frame=r?T.upime.elementManager.getElementById(r):void 0,n.frame)){var h=n.frame;d=h.position,p=h.size,n.viewClipRect=new Yc(d.x,d.y,p.width,p.height),n.viewClipRect.name=n.groupName,n.viewClipRect.users=n.users}void 0!==a&&(n.deleted=a,!0===a&&(null==o||o.forEach((function(e){D2.delete(e)})),n.users=[],S.joinedGroup===n&&S.setJoinedGroup(void 0))),void 0!==s&&(n.groupName=s,n.viewClipRect&&(n.viewClipRect.name=s))},T=this,I=0;I<k.length;I++)_(I);S&&(S.groups=R([],S.groups,!0));break;case R2.TALK_STAGE_UPDATE:g=t.stage,S&&(S.stage=g,g===S2.started?(S.onStartTalk(),null===(n=this.closePick)||void 0===n||n.call(this),null===(i=this.closeTip)||void 0===i||i.call(this,""),this.upime.clearSelect(),D2.get(this.upime.localUserInfo.loginName)&&this.upime.showWindow(X2,null,void 0,void 0,void 0,(function(e){c.enterModalId=e}))):g===S2.ended&&(S.onEndTalk(),this.upime.addToast(O("grouptalk.end")),this.upime.removeWindow(this.enterModalId))),S&&(S.groups=R([],S.groups,!0));break;case R2.USER_GROUP_UPDATE:var P=t.userId,N=t.groupId,M=D2.get(P);if(M===N)return;var A=P===this.upime.localUserInfo.loginName,D=S.validGroups.find((function(e){return e.id===M}));if(D&&(D.users=D.users.filter((function(e){return e.loginName!==P})),D.viewClipRect&&(D.viewClipRect.users=D.users,this.upime.updateView()),D.users.find((function(e){return e.loginName===c.upime.localUserInfo.loginName}))&&S.stage===S2.started&&this.upime.addToast(this.upime.getUserInfo(P).userName+" "+O("grouptalk.leave.zu"))),N){var B=S.validGroups.find((function(e){return e.id===N}));B&&(D2.set(P,N),B.users=R(R([],B.users,!0),[this.upime.getUserInfo(P)],!1),B.viewClipRect&&(B.viewClipRect.users=B.users,this.upime.updateView()),B.users.find((function(e){return e.loginName===c.upime.localUserInfo.loginName}))&&S.stage===S2.started&&(A||this.upime.addToast(this.upime.getUserInfo(P).userName+" "+O("grouptalk.join.zu")))),A&&S.setJoinedGroup(B)}else D2.delete(P),A&&S.setJoinedGroup(void 0);S&&(S.groups=R([],S.groups,!0));break;case R2.RELATED_MEETING:var L=t.meetingId;S.relatedMeeting=L;break;case R2.RTC_USERS:var F=t.talkId,z=t.groupId,H=t.userIds;F===S.talkId&&(null===(r=S.joinedGroup)||void 0===r?void 0:r.id)===z&&(S.joinedGroup.rtcUsers=H);break;case R2.RTC_USER_JOIN:F=t.talkId,z=t.groupId;var U=t.userId;F===S.talkId&&(null===(o=S.joinedGroup)||void 0===o?void 0:o.id)===z&&(S.joinedGroup.rtcUsers=R(R([],S.joinedGroup.rtcUsers,!0),[U],!1));break;case R2.RTC_USER_LEAVE:F=t.talkId,z=t.groupId;var W=t.userId;F===S.talkId&&(null===(a=S.joinedGroup)||void 0===a?void 0:a.id)===z&&(S.joinedGroup.rtcUsers=S.joinedGroup.rtcUsers.filter((function(e){return e!==W})))}},t.prototype.init=function(e){var t=this,n=this.upime;e&&Object.assign(this.config,e),A2.name=O("grouptalk.name"),n.addCustomFoldableTool(A2),Xh({name:O("grouptalk.createTalk"),onClick:function(e){if(void 0===e&&(e=[]),t.upime.switchRightSlideExtension(A2,!0),null===t.groupTalk||""===t.groupTalk.talkId){var n=e[0];t.selectedFrame=n||null}else t.createGroupTalkFailed()},id:"createGroupTalk",global:!1,editableOnly:!0,supportElements:[Za.FRAME]}),this.unsubs.push((function(){Qh("createGroupTalk")}));var i=n.subscribe("sdkAction",(function(e){var i=e.type;if("usersEvent"===i){var r=e.payload;t.users=R(R([],r.otherUsers,!0),[n.localUserInfo],!1).sort(FW)}else"frameEvent"===i&&t.groupTalk&&(t.groupTalk.groups=R([],t.groupTalk.groups,!0))}));this.unsubs.push(i)},t.prototype.destroy=function(){this.unsubs.forEach((function(e){e()}))},t.prototype.createGroupTalk=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,c,u,d,p,h;return D(this,(function(f){switch(f.label){case 0:for(t=this.upime,this.clearCurrentTalk(),n=new Y2(this,""),i=e.count,r=e.content,o=e.memberType,a=t.getFrameContent(r),n.contentData=a,n.creator=t.localUserInfo,n.managers=[t.localUserInfo],s=this.users.find((function(e){return"owner"===e.userType})),s&&n.managers.push(s),l=[],u=0;u<i;u++)c="".concat(O("grouptalk.taolunzu")).concat(u+1),l.push({groupName:c,users:[]});for(u=0;u<l.length;u++)n.createLocalGroup(l[u]);return o===_2.autoMode?(n.observers.push(t.localUserInfo.loginName),t.curMeetingChannel&&(h=n.observers).push.apply(h,R(R([],t.curMeetingChannel.coHosts,!1),[t.curMeetingChannel.hostId],!1)),this.users.filter((function(e){return!n.observers.includes(e.loginName)})).forEach((function(e,t){var r=n.groups[t%i];r&&(r.users.push(e),D2.set(e.loginName,r.id))}))):o===_2.freeMode&&(n.freeJoin=!0),n.groups.forEach((function(e){var t=e.users.map((function(e){return e.userName}));t.length>0&&(t.length>3?e.groupName=t.slice(0,3).join(",")+"...":e.groupName=t.join(","))})),[4,this.subService.createTalk(n)];case 1:return(d=f.sent())?(n.talkId=d,[4,this.createFrameContentBatch(r,n,a)]):[3,3];case 2:return p=f.sent(),this.groupTalk=n,this.talkExist=!0,this.layoutFramesViewCenter(p),this.subService.updateGroups(n,n.groups),[3,4];case 3:this.createGroupTalkFailed(),f.label=4;case 4:return[2]}}))}))},t.prototype.layoutFramesViewCenter=function(e){var t=Yt(e.map((function(e){var t=e.getGlobalBox();return Sn(t,t.rotate||0)})));this.upime.selectElements(e);var n=.2*this.upime.view.viewWidth,i=.2*this.upime.view.viewHeight;this.upime.makeBorderCenter(t,{left:n,right:n,top:i,bottom:i})},t.prototype.createFrameContentBatch=function(e,t,n){return A(this,void 0,void 0,(function(){var i,r,o,a,s,l,c,u,d,p,h,f,m,v,g,y,b,E,x,w;return D(this,(function(C){switch(C.label){case 0:i=n.info,r=n.size,o=t.validGroups.length,a=(r.width+40)*Math.floor(o/10)-40,s=(r.height+40)*(o%10)-40,l=this.upime.calcEmptyFrameArea({size:{width:a,height:s},refFrame:e}),c=l.x,u=l.y,d=JSON.stringify(i),p=[],h=0,C.label=1;case 1:if(!(h<t.validGroups.length))return[3,4];for(f=JSON.parse(d),m=0;m<f.length;m++)if((v=f[m]).elementType===Za.FRAME){v.data.name=t.validGroups[h].groupName+O("grouptalk.dezhenkuang");break}return g=c+Math.floor(h/10)*(r.width+40),y=u+h%10*(r.height+40),[4,this.upime.insertFrameContent(f,{x:g,y:y})];case 2:b=C.sent(),E=b[0],x=b[1],p.push.apply(p,x),t.validGroups[h].frame=E,(w=new Yc(g,y,r.width,r.height)).name=t.validGroups[h].groupName,w.users=t.validGroups[h].users,t.validGroups[h].viewClipRect=w,C.label=3;case 3:return h++,[3,1];case 4:return[2,p]}}))}))},t.prototype.createGroupTalkFailed=function(){this.upime.addToast(O("grouptalk.create.fail"))},t.prototype.chooseContent=function(e){var t=this.upime;t.clearSelect(),t.showWindow(x2,void 0,!0),t.isDesktopModal=!0,this.closePick=t.startPickElement((function(t){if(!t)return!0;e(t)}),(function(e){return e.elementType===Za.FRAME})),window.addEventListener("keydown",this.onKeyDown)},t.prototype.clearChooseEffect=function(){var e;null===(e=this.closeTip)||void 0===e||e.call(this,""),this.upime.isDesktopModal=!1,document.getElementById("rightSidePanel").style.display="block",window.removeEventListener("keydown",this.onKeyDown)},t.prototype.clearCurrentTalk=function(){this.groupTalk&&(this.groupTalk.destroy(),this.groupTalk=null)},M([rl],t.prototype,"groupTalk",void 0),M([rl],t.prototype,"selectedFrame",void 0),M([rl],t.prototype,"talkExist",void 0),M([il],t)}();var Z2,J2="json",$2="application/"+J2,e3="Content-Type";function t3(e){var t,n,i,r="",o=e.query,s=void 0===o?"":o,l=e.host,c=void 0===l?"":l,u=e.method,d=void 0===u?Z2.POST:u,p=e.url,h=e.headers,f=e.params,m=e.baseUrl,v=void 0===m?"":m,g=p;if(g="function"==typeof c?c()+v+p:c+v+p,f instanceof FormData)r=f;else if("object"==typeof f){var y=!1;for(var b in f)if(f[b]instanceof File||f[b]instanceof Blob){y=!0;break}if(y)for(var b in r=new FormData,f){var E=f[b];if(E instanceof File||E instanceof Blob){var x=E instanceof File?E.name:void 0;r.append(b,E,x)}else r.append(b,JSON.stringify(E))}else d!=Z2.POST||e.type||(n=$2),n==$2?r=JSON.stringify(f):(r=function(e){var t=[];for(var n in e)if(e[n]){var i=e[n];"object"==typeof i&&(i=JSON.stringify(i)),t.push("".concat(n,"=").concat(encodeURIComponent(i)))}return t.join("&")}(f),d!=Z2.GET||s||(s=r,r=""))}return!h&&n&&(i={}),i=a(a({},h),((t={})[e3]=n,t)),g=s?g+"?"+s:g,a(a({},e),{url:g,headers:i,query:s,data:r})}!function(e){e.POST="POST",e.GET="GET",e.PUT="PUT"}(Z2||(Z2={}));var n3=function(e){function t(t){var n=e.call(this)||this;return n.requestConfig=t,n.xhr=new XMLHttpRequest,n}return o(t,e),t.prototype.getXhr=function(){return this.xhr},t.prototype.send=function(){var e=this,t=this.xhr,n=t3(this.requestConfig),i=n.method,r=void 0===i?Z2.POST:i,o=n.url,a=void 0===o?"":o,s=n.timeout,l=n.headers,c=n.onprogress,u=void 0===c?null:c,d=n.onerror,p=void 0===d?null:d,h=n.onabort,f=void 0===h?null:h,m=n.data;if(s&&(t.timeout=s),t.onprogress=u,t.onerror=p,t.onabort=f,t.open(r,a),l)for(var v in l)t.setRequestHeader(v,l[v]);t.onloadend=function(){if(t.readyState,t.status,t.statusText,200==t.status){var n=t.getResponseHeader(e3)||"";if(n.indexOf(J2)>=0){var i=t.responseText;try{var r=JSON.parse(i);e.done(r)}catch(t){e.fail(t)}}else if(n.indexOf("octet")>0){i=t.responseText;e.done(i)}else e.fail("content-type is not json")}else e.fail("XMLHttpRequest status error: "+t.status)},t.send(m)},t.prototype.cancel=function(){this.xhr.abort(),this.fail("XMLHttpRequest canceled")},t}(y),i3=function(e){function t(t){var n=e.call(this)||this;return n.requestConfig=t,n.controller=new AbortController,n}return o(t,e),t.prototype.send=function(){var e=this,t=t3(this.requestConfig),n=t.method,i=void 0===n?Z2.POST:n,r=t.url,o=void 0===r?"":r,a=t.headers,s=t.data,l=t.keepalive;fetch(o,{method:i,headers:a,body:i===Z2.GET?void 0:s,keepalive:l,signal:this.controller.signal}).then((function(e){if(200===e.status)return e.json();throw new Error("Fetch request status error: "+e.status)})).then((function(t){e.done(t)})).catch((function(t){e.fail(t)}))},t.prototype.cancel=function(){this.controller.abort(),this.fail("Fetch request canceled")},t}(y),r3=function(){function e(e){void 0===e&&(e={}),this.defaultOptions=e,this.requestBeforeFunc=function(e){return e}}return e.prototype.dealConfig=function(e,t){void 0===t&&(t={});var n="string"==typeof e?a({url:e},t):e,i=this.requestBeforeFunc(n);return a(a({},this.defaultOptions),i)},e.prototype.request=function(e,t){void 0===t&&(t={});var n=new n3(this.dealConfig(e,t));return n.send(),n},e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new i3(this.dealConfig(e,t));return n.send(),n},e.prototype.beforeRequest=function(e){this.requestBeforeFunc=e},e}();var o3=function e(t){void 0===t&&(t={});var n=new r3(t),i=n.request.bind(n);return i.create=function(n){return void 0===n&&(n={}),e(a(a({},t),n))},Object.getOwnPropertyNames(r3.prototype).forEach((function(e){"function"==typeof n[e]?i[e]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n[e].apply(n,t)}:i[e]=n[e]})),i}(),a3="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var l3={exports:{}};
/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */!function(e,t){!function(n){var i=t,r=e&&e.exports==i&&e,o="object"==typeof a3&&a3;o.global!==o&&o.window!==o||(n=o);var a=function(e){this.message=e};(a.prototype=new Error).name="InvalidCharacterError";var s=function(e){throw new a(e)},l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,u={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,i,r,o=e.length%3,a="",c=-1,u=e.length-o;++c<u;)t=e.charCodeAt(c)<<16,n=e.charCodeAt(++c)<<8,i=e.charCodeAt(++c),a+=l.charAt((r=t+n+i)>>18&63)+l.charAt(r>>12&63)+l.charAt(r>>6&63)+l.charAt(63&r);return 2==o?(t=e.charCodeAt(c)<<8,n=e.charCodeAt(++c),a+=l.charAt((r=t+n)>>10)+l.charAt(r>>4&63)+l.charAt(r<<2&63)+"="):1==o&&(r=e.charCodeAt(c),a+=l.charAt(r>>2)+l.charAt(r<<4&63)+"=="),a},decode:function(e){var t=(e=String(e).replace(c,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,r=0,o="",a=-1;++a<t;)i=l.indexOf(e.charAt(a)),n=r%4?64*n+i:i,r++%4&&(o+=String.fromCharCode(255&n>>(-2*r&6)));return o},version:"1.0.0"};if(i&&!i.nodeType)if(r)r.exports=u;else for(var d in u)u.hasOwnProperty(d)&&(i[d]=u[d]);else n.base64=u}(a3)}(l3,l3.exports);var c3=s3(l3.exports);function u3(e,t,n,i){void 0===i&&(i="browser");var r=t+"=([^&]*)",o=t+"="+n;if(e.match(r)){var a=e,s=new RegExp("(&"+t+"=)([^&#]*)","gi");s.test(a)&&(a=a.replace(s,"&"+o));var l=new RegExp("([?])("+t+"=)([^&#]*)","gi");return l.test(a)&&(a=a.replace(l,"?"+o)),a}try{var c=new URL(e);return"hash"===i?e+(c.hash||"#")+(c.hash.indexOf("?")>=0?"&":"?")+o:c.origin+c.pathname+(c.search.indexOf("?")>=0?c.search+"&":"?")+o+c.hash}catch(t){return e.indexOf("?")>=0?e+"&"+o:e+"?"+o}}var d3=function(e,t){void 0===t&&(t="browser");var n=new URL(null!=e?e:window.location.href);if("hash"===t){var i=n.hash.indexOf("?");return{pathName:n.pathname+"#"+n.hash.slice(1,i),search:n.hash.slice(i),origin:n.origin}}return{pathName:n.pathname,search:n.search,origin:n.origin}};function p3(e){try{return e?c3.decode(decodeURIComponent(e)):void 0}catch(t){return e}}function h3(e){return encodeURIComponent(c3.encode(e))}var f3="prod",m3="";function v3(e){switch(void 0===e&&(e="prod"),e){case"dev":ke(de.DEV);break;case"test":ke(de.TEST);break;default:ke(de.WWW)}f3=null!=e?e:"prod"}function g3(e){m3=e}var y3={host:function(){return"prod"==f3?"https://developer.infi.cn":"test"===f3?"https://test-s1.plaso.cn":"https://dev-s1.plaso.cn"},baseUrl:"/infi/iss/tk",method:Z2.POST},b3=o3.create(y3);b3.beforeRequest((function(e){var t=m3;return t&&(e.headers=a(a({},e.headers),{token:t})),e}));var E3=function(e){return c(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,b3({url:"/login/board",query:e,baseUrl:"/infi/iss/nc",method:Z2.GET}).result];case 1:return[2,t.sent()]}}))}))},x3=function(e){return b3.fetch({url:"/board/setBoardConfig",params:{setting:e},keepalive:!0}).result},w3={exports:{}};!function(e,t){(function(){var n,i="Expected a function",r="__lodash_hash_undefined__",o="__lodash_placeholder__",a=16,s=32,l=64,c=128,u=256,d=1/0,p=9007199254740991,h=NaN,f=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",a],["flip",512],["partial",s],["partialRight",l],["rearg",u]],v="[object Arguments]",g="[object Array]",y="[object Boolean]",b="[object Date]",E="[object Error]",x="[object Function]",w="[object GeneratorFunction]",C="[object Map]",S="[object Number]",k="[object Object]",_="[object Promise]",T="[object RegExp]",I="[object Set]",P="[object String]",N="[object Symbol]",M="[object WeakMap]",A="[object ArrayBuffer]",D="[object DataView]",R="[object Float32Array]",B="[object Float64Array]",L="[object Int8Array]",O="[object Int16Array]",F="[object Int32Array]",z="[object Uint8Array]",H="[object Uint8ClampedArray]",U="[object Uint16Array]",W="[object Uint32Array]",V=/\b__p \+= '';/g,j=/\b(__p \+=) '' \+/g,G=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,K=/[&<>"']/g,Y=RegExp(q.source),X=RegExp(K.source),Q=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ee=/^\w*$/,te=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ne=/[\\^$.*+?()[\]{}|]/g,ie=RegExp(ne.source),re=/^\s+/,oe=/\s/,ae=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,de=/\\(\\)?/g,pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,he=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ve=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,ye=/^(?:0|[1-9]\d*)$/,be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ee=/($^)/,xe=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",Ce="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="\\u2700-\\u27bf",ke="a-z\\xdf-\\xf6\\xf8-\\xff",_e="A-Z\\xc0-\\xd6\\xd8-\\xde",Te="\\ufe0e\\ufe0f",Ie="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pe="['’]",Ne="["+we+"]",Me="["+Ie+"]",Ae="["+Ce+"]",De="\\d+",Re="["+Se+"]",Be="["+ke+"]",Le="[^"+we+Ie+De+Se+ke+_e+"]",Oe="\\ud83c[\\udffb-\\udfff]",Fe="[^"+we+"]",ze="(?:\\ud83c[\\udde6-\\uddff]){2}",He="[\\ud800-\\udbff][\\udc00-\\udfff]",Ue="["+_e+"]",We="\\u200d",Ve="(?:"+Be+"|"+Le+")",je="(?:"+Ue+"|"+Le+")",Ge="(?:['’](?:d|ll|m|re|s|t|ve))?",qe="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ke="(?:"+Ae+"|"+Oe+")"+"?",Ye="["+Te+"]?",Xe=Ye+Ke+("(?:"+We+"(?:"+[Fe,ze,He].join("|")+")"+Ye+Ke+")*"),Qe="(?:"+[Re,ze,He].join("|")+")"+Xe,Ze="(?:"+[Fe+Ae+"?",Ae,ze,He,Ne].join("|")+")",Je=RegExp(Pe,"g"),$e=RegExp(Ae,"g"),et=RegExp(Oe+"(?="+Oe+")|"+Ze+Xe,"g"),tt=RegExp([Ue+"?"+Be+"+"+Ge+"(?="+[Me,Ue,"$"].join("|")+")",je+"+"+qe+"(?="+[Me,Ue+Ve,"$"].join("|")+")",Ue+"?"+Ve+"+"+Ge,Ue+"+"+qe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",De,Qe].join("|"),"g"),nt=RegExp("["+We+we+Ce+Te+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ot=-1,at={};at[R]=at[B]=at[L]=at[O]=at[F]=at[z]=at[H]=at[U]=at[W]=!0,at[v]=at[g]=at[A]=at[y]=at[D]=at[b]=at[E]=at[x]=at[C]=at[S]=at[k]=at[T]=at[I]=at[P]=at[M]=!1;var st={};st[v]=st[g]=st[A]=st[D]=st[y]=st[b]=st[R]=st[B]=st[L]=st[O]=st[F]=st[C]=st[S]=st[k]=st[T]=st[I]=st[P]=st[N]=st[z]=st[H]=st[U]=st[W]=!0,st[E]=st[x]=st[M]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,ut=parseInt,dt="object"==typeof a3&&a3&&a3.Object===Object&&a3,pt="object"==typeof self&&self&&self.Object===Object&&self,ht=dt||pt||Function("return this")(),ft=t&&!t.nodeType&&t,mt=ft&&e&&!e.nodeType&&e,vt=mt&&mt.exports===ft,gt=vt&&dt.process,yt=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||gt&&gt.binding&&gt.binding("util")}catch(e){}}(),bt=yt&&yt.isArrayBuffer,Et=yt&&yt.isDate,xt=yt&&yt.isMap,wt=yt&&yt.isRegExp,Ct=yt&&yt.isSet,St=yt&&yt.isTypedArray;function kt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function _t(e,t,n,i){for(var r=-1,o=null==e?0:e.length;++r<o;){var a=e[r];t(i,a,n(a),e)}return i}function Tt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function It(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Pt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Nt(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}function Mt(e,t){return!!(null==e?0:e.length)&&Ut(e,t,0)>-1}function At(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function Dt(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function Rt(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}function Bt(e,t,n,i){var r=-1,o=null==e?0:e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function Lt(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}function Ot(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Ft=Gt("length");function zt(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}function Ht(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function Ut(e,t,n){return t==t?function(e,t,n){var i=n-1,r=e.length;for(;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):Ht(e,Vt,n)}function Wt(e,t,n,i){for(var r=n-1,o=e.length;++r<o;)if(i(e[r],t))return r;return-1}function Vt(e){return e!=e}function jt(e,t){var n=null==e?0:e.length;return n?Yt(e,t)/n:h}function Gt(e){return function(t){return null==t?n:t[e]}}function qt(e){return function(t){return null==e?n:e[t]}}function Kt(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}function Yt(e,t){for(var i,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==n&&(i=i===n?a:i+a)}return i}function Xt(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Qt(e){return e?e.slice(0,fn(e)+1).replace(re,""):e}function Zt(e){return function(t){return e(t)}}function Jt(e,t){return Dt(t,(function(t){return e[t]}))}function $t(e,t){return e.has(t)}function en(e,t){for(var n=-1,i=e.length;++n<i&&Ut(t,e[n],0)>-1;);return n}function tn(e,t){for(var n=e.length;n--&&Ut(t,e[n],0)>-1;);return n}var nn=qt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),rn=qt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function on(e){return"\\"+lt[e]}function an(e){return nt.test(e)}function sn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function cn(e,t){for(var n=-1,i=e.length,r=0,a=[];++n<i;){var s=e[n];s!==t&&s!==o||(e[n]=o,a[r++]=n)}return a}function un(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function dn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function pn(e){return an(e)?function(e){var t=et.lastIndex=0;for(;et.test(e);)++t;return t}(e):Ft(e)}function hn(e){return an(e)?function(e){return e.match(et)||[]}(e):function(e){return e.split("")}(e)}function fn(e){for(var t=e.length;t--&&oe.test(e.charAt(t)););return t}var mn=qt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var vn=function e(t){var oe,we=(t=null==t?ht:vn.defaults(ht.Object(),t,vn.pick(ht,rt))).Array,Ce=t.Date,Se=t.Error,ke=t.Function,_e=t.Math,Te=t.Object,Ie=t.RegExp,Pe=t.String,Ne=t.TypeError,Me=we.prototype,Ae=ke.prototype,De=Te.prototype,Re=t["__core-js_shared__"],Be=Ae.toString,Le=De.hasOwnProperty,Oe=0,Fe=(oe=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||""))?"Symbol(src)_1."+oe:"",ze=De.toString,He=Be.call(Te),Ue=ht._,We=Ie("^"+Be.call(Le).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ve=vt?t.Buffer:n,je=t.Symbol,Ge=t.Uint8Array,qe=Ve?Ve.allocUnsafe:n,Ke=ln(Te.getPrototypeOf,Te),Ye=Te.create,Xe=De.propertyIsEnumerable,Qe=Me.splice,Ze=je?je.isConcatSpreadable:n,et=je?je.iterator:n,nt=je?je.toStringTag:n,lt=function(){try{var e=ho(Te,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=t.clearTimeout!==ht.clearTimeout&&t.clearTimeout,pt=Ce&&Ce.now!==ht.Date.now&&Ce.now,ft=t.setTimeout!==ht.setTimeout&&t.setTimeout,mt=_e.ceil,gt=_e.floor,yt=Te.getOwnPropertySymbols,Ft=Ve?Ve.isBuffer:n,qt=t.isFinite,gn=Me.join,yn=ln(Te.keys,Te),bn=_e.max,En=_e.min,xn=Ce.now,wn=t.parseInt,Cn=_e.random,Sn=Me.reverse,kn=ho(t,"DataView"),_n=ho(t,"Map"),Tn=ho(t,"Promise"),In=ho(t,"Set"),Pn=ho(t,"WeakMap"),Nn=ho(Te,"create"),Mn=Pn&&new Pn,An={},Dn=zo(kn),Rn=zo(_n),Bn=zo(Tn),Ln=zo(In),On=zo(Pn),Fn=je?je.prototype:n,zn=Fn?Fn.valueOf:n,Hn=Fn?Fn.toString:n;function Un(e){if(ns(e)&&!Ga(e)&&!(e instanceof Gn)){if(e instanceof jn)return e;if(Le.call(e,"__wrapped__"))return Ho(e)}return new jn(e)}var Wn=function(){function e(){}return function(t){if(!ts(t))return{};if(Ye)return Ye(t);e.prototype=t;var i=new e;return e.prototype=n,i}}();function Vn(){}function jn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=n}function Gn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Xn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Yn;++t<n;)this.add(e[t])}function Qn(e){var t=this.__data__=new Kn(e);this.size=t.size}function Zn(e,t){var n=Ga(e),i=!n&&ja(e),r=!n&&!i&&Xa(e),o=!n&&!i&&!r&&us(e),a=n||i||r||o,s=a?Xt(e.length,Pe):[],l=s.length;for(var c in e)!t&&!Le.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Eo(c,l))||s.push(c);return s}function Jn(e){var t=e.length;return t?e[Xi(0,t-1)]:n}function $n(e,t){return Lo(Nr(e),li(t,0,e.length))}function ei(e){return Lo(Nr(e))}function ti(e,t,i){(i!==n&&!Ua(e[t],i)||i===n&&!(t in e))&&ai(e,t,i)}function ni(e,t,i){var r=e[t];Le.call(e,t)&&Ua(r,i)&&(i!==n||t in e)||ai(e,t,i)}function ii(e,t){for(var n=e.length;n--;)if(Ua(e[n][0],t))return n;return-1}function ri(e,t,n,i){return hi(e,(function(e,r,o){t(i,e,n(e),o)})),i}function oi(e,t){return e&&Mr(t,As(t),e)}function ai(e,t,n){"__proto__"==t&&lt?lt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function si(e,t){for(var i=-1,r=t.length,o=we(r),a=null==e;++i<r;)o[i]=a?n:Ts(e,t[i]);return o}function li(e,t,i){return e==e&&(i!==n&&(e=e<=i?e:i),t!==n&&(e=e>=t?e:t)),e}function ci(e,t,i,r,o,a){var s,l=1&t,c=2&t,u=4&t;if(i&&(s=o?i(e,r,o,a):i(e)),s!==n)return s;if(!ts(e))return e;var d=Ga(e);if(d){if(s=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Le.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!l)return Nr(e,s)}else{var p=vo(e),h=p==x||p==w;if(Xa(e))return Sr(e,l);if(p==k||p==v||h&&!o){if(s=c||h?{}:yo(e),!l)return c?function(e,t){return Mr(e,mo(e),t)}(e,function(e,t){return e&&Mr(t,Ds(t),e)}(s,e)):function(e,t){return Mr(e,fo(e),t)}(e,oi(s,e))}else{if(!st[p])return o?e:{};s=function(e,t,n){var i=e.constructor;switch(t){case A:return kr(e);case y:case b:return new i(+e);case D:return function(e,t){var n=t?kr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case R:case B:case L:case O:case F:case z:case H:case U:case W:return _r(e,n);case C:return new i;case S:case P:return new i(e);case T:return function(e){var t=new e.constructor(e.source,he.exec(e));return t.lastIndex=e.lastIndex,t}(e);case I:return new i;case N:return r=e,zn?Te(zn.call(r)):{}}var r}(e,p,l)}}a||(a=new Qn);var f=a.get(e);if(f)return f;a.set(e,s),ss(e)?e.forEach((function(n){s.add(ci(n,t,i,n,e,a))})):is(e)&&e.forEach((function(n,r){s.set(r,ci(n,t,i,r,e,a))}));var m=d?n:(u?c?oo:ro:c?Ds:As)(e);return Tt(m||e,(function(n,r){m&&(n=e[r=n]),ni(s,r,ci(n,t,i,r,e,a))})),s}function ui(e,t,i){var r=i.length;if(null==e)return!r;for(e=Te(e);r--;){var o=i[r],a=t[o],s=e[o];if(s===n&&!(o in e)||!a(s))return!1}return!0}function di(e,t,r){if("function"!=typeof e)throw new Ne(i);return Ao((function(){e.apply(n,r)}),t)}function pi(e,t,n,i){var r=-1,o=Mt,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=Dt(t,Zt(n))),i?(o=At,a=!1):t.length>=200&&(o=$t,a=!1,t=new Xn(t));e:for(;++r<s;){var u=e[r],d=null==n?u:n(u);if(u=i||0!==u?u:0,a&&d==d){for(var p=c;p--;)if(t[p]===d)continue e;l.push(u)}else o(t,d,i)||l.push(u)}return l}Un.templateSettings={escape:Q,evaluate:Z,interpolate:J,variable:"",imports:{_:Un}},Un.prototype=Vn.prototype,Un.prototype.constructor=Un,jn.prototype=Wn(Vn.prototype),jn.prototype.constructor=jn,Gn.prototype=Wn(Vn.prototype),Gn.prototype.constructor=Gn,qn.prototype.clear=function(){this.__data__=Nn?Nn(null):{},this.size=0},qn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qn.prototype.get=function(e){var t=this.__data__;if(Nn){var i=t[e];return i===r?n:i}return Le.call(t,e)?t[e]:n},qn.prototype.has=function(e){var t=this.__data__;return Nn?t[e]!==n:Le.call(t,e)},qn.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Nn&&t===n?r:t,this},Kn.prototype.clear=function(){this.__data__=[],this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=ii(t,e);return!(n<0)&&(n==t.length-1?t.pop():Qe.call(t,n,1),--this.size,!0)},Kn.prototype.get=function(e){var t=this.__data__,i=ii(t,e);return i<0?n:t[i][1]},Kn.prototype.has=function(e){return ii(this.__data__,e)>-1},Kn.prototype.set=function(e,t){var n=this.__data__,i=ii(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},Yn.prototype.clear=function(){this.size=0,this.__data__={hash:new qn,map:new(_n||Kn),string:new qn}},Yn.prototype.delete=function(e){var t=uo(this,e).delete(e);return this.size-=t?1:0,t},Yn.prototype.get=function(e){return uo(this,e).get(e)},Yn.prototype.has=function(e){return uo(this,e).has(e)},Yn.prototype.set=function(e,t){var n=uo(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},Xn.prototype.add=Xn.prototype.push=function(e){return this.__data__.set(e,r),this},Xn.prototype.has=function(e){return this.__data__.has(e)},Qn.prototype.clear=function(){this.__data__=new Kn,this.size=0},Qn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Qn.prototype.get=function(e){return this.__data__.get(e)},Qn.prototype.has=function(e){return this.__data__.has(e)},Qn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Kn){var i=n.__data__;if(!_n||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Yn(i)}return n.set(e,t),this.size=n.size,this};var hi=Rr(xi),fi=Rr(wi,!0);function mi(e,t){var n=!0;return hi(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function vi(e,t,i){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(l===n?s==s&&!cs(s):i(s,l)))var l=s,c=a}return c}function gi(e,t){var n=[];return hi(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function yi(e,t,n,i,r){var o=-1,a=e.length;for(n||(n=bo),r||(r=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?yi(s,t-1,n,i,r):Rt(r,s):i||(r[r.length]=s)}return r}var bi=Br(),Ei=Br(!0);function xi(e,t){return e&&bi(e,t,As)}function wi(e,t){return e&&Ei(e,t,As)}function Ci(e,t){return Nt(t,(function(t){return Ja(e[t])}))}function Si(e,t){for(var i=0,r=(t=Er(t,e)).length;null!=e&&i<r;)e=e[Fo(t[i++])];return i&&i==r?e:n}function ki(e,t,n){var i=t(e);return Ga(e)?i:Rt(i,n(e))}function _i(e){return null==e?e===n?"[object Undefined]":"[object Null]":nt&&nt in Te(e)?function(e){var t=Le.call(e,nt),i=e[nt];try{e[nt]=n;var r=!0}catch(e){}var o=ze.call(e);r&&(t?e[nt]=i:delete e[nt]);return o}(e):function(e){return ze.call(e)}(e)}function Ti(e,t){return e>t}function Ii(e,t){return null!=e&&Le.call(e,t)}function Pi(e,t){return null!=e&&t in Te(e)}function Ni(e,t,i){for(var r=i?At:Mt,o=e[0].length,a=e.length,s=a,l=we(a),c=1/0,u=[];s--;){var d=e[s];s&&t&&(d=Dt(d,Zt(t))),c=En(d.length,c),l[s]=!i&&(t||o>=120&&d.length>=120)?new Xn(s&&d):n}d=e[0];var p=-1,h=l[0];e:for(;++p<o&&u.length<c;){var f=d[p],m=t?t(f):f;if(f=i||0!==f?f:0,!(h?$t(h,m):r(u,m,i))){for(s=a;--s;){var v=l[s];if(!(v?$t(v,m):r(e[s],m,i)))continue e}h&&h.push(m),u.push(f)}}return u}function Mi(e,t,i){var r=null==(e=Po(e,t=Er(t,e)))?e:e[Fo(Zo(t))];return null==r?n:kt(r,e,i)}function Ai(e){return ns(e)&&_i(e)==v}function Di(e,t,i,r,o){return e===t||(null==e||null==t||!ns(e)&&!ns(t)?e!=e&&t!=t:function(e,t,i,r,o,a){var s=Ga(e),l=Ga(t),c=s?g:vo(e),u=l?g:vo(t),d=(c=c==v?k:c)==k,p=(u=u==v?k:u)==k,h=c==u;if(h&&Xa(e)){if(!Xa(t))return!1;s=!0,d=!1}if(h&&!d)return a||(a=new Qn),s||us(e)?no(e,t,i,r,o,a):function(e,t,n,i,r,o,a){switch(n){case D:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case A:return!(e.byteLength!=t.byteLength||!o(new Ge(e),new Ge(t)));case y:case b:case S:return Ua(+e,+t);case E:return e.name==t.name&&e.message==t.message;case T:case P:return e==t+"";case C:var s=sn;case I:var l=1&i;if(s||(s=un),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=2,a.set(e,t);var u=no(s(e),s(t),i,r,o,a);return a.delete(e),u;case N:if(zn)return zn.call(e)==zn.call(t)}return!1}(e,t,c,i,r,o,a);if(!(1&i)){var f=d&&Le.call(e,"__wrapped__"),m=p&&Le.call(t,"__wrapped__");if(f||m){var x=f?e.value():e,w=m?t.value():t;return a||(a=new Qn),o(x,w,i,r,a)}}if(!h)return!1;return a||(a=new Qn),function(e,t,i,r,o,a){var s=1&i,l=ro(e),c=l.length,u=ro(t),d=u.length;if(c!=d&&!s)return!1;var p=c;for(;p--;){var h=l[p];if(!(s?h in t:Le.call(t,h)))return!1}var f=a.get(e),m=a.get(t);if(f&&m)return f==t&&m==e;var v=!0;a.set(e,t),a.set(t,e);var g=s;for(;++p<c;){var y=e[h=l[p]],b=t[h];if(r)var E=s?r(b,y,h,t,e,a):r(y,b,h,e,t,a);if(!(E===n?y===b||o(y,b,i,r,a):E)){v=!1;break}g||(g="constructor"==h)}if(v&&!g){var x=e.constructor,w=t.constructor;x==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w||(v=!1)}return a.delete(e),a.delete(t),v}(e,t,i,r,o,a)}(e,t,i,r,Di,o))}function Ri(e,t,i,r){var o=i.length,a=o,s=!r;if(null==e)return!a;for(e=Te(e);o--;){var l=i[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var c=(l=i[o])[0],u=e[c],d=l[1];if(s&&l[2]){if(u===n&&!(c in e))return!1}else{var p=new Qn;if(r)var h=r(u,d,c,e,t,p);if(!(h===n?Di(d,u,3,r,p):h))return!1}}return!0}function Bi(e){return!(!ts(e)||(t=e,Fe&&Fe in t))&&(Ja(e)?We:ve).test(zo(e));var t}function Li(e){return"function"==typeof e?e:null==e?rl:"object"==typeof e?Ga(e)?Wi(e[0],e[1]):Ui(e):hl(e)}function Oi(e){if(!ko(e))return yn(e);var t=[];for(var n in Te(e))Le.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fi(e){if(!ts(e))return function(e){var t=[];if(null!=e)for(var n in Te(e))t.push(n);return t}(e);var t=ko(e),n=[];for(var i in e)("constructor"!=i||!t&&Le.call(e,i))&&n.push(i);return n}function zi(e,t){return e<t}function Hi(e,t){var n=-1,i=Ka(e)?we(e.length):[];return hi(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Ui(e){var t=po(e);return 1==t.length&&t[0][2]?To(t[0][0],t[0][1]):function(n){return n===e||Ri(n,e,t)}}function Wi(e,t){return wo(e)&&_o(t)?To(Fo(e),t):function(i){var r=Ts(i,e);return r===n&&r===t?Is(i,e):Di(t,r,3)}}function Vi(e,t,i,r,o){e!==t&&bi(t,(function(a,s){if(o||(o=new Qn),ts(a))!function(e,t,i,r,o,a,s){var l=No(e,i),c=No(t,i),u=s.get(c);if(u)return void ti(e,i,u);var d=a?a(l,c,i+"",e,t,s):n,p=d===n;if(p){var h=Ga(c),f=!h&&Xa(c),m=!h&&!f&&us(c);d=c,h||f||m?Ga(l)?d=l:Ya(l)?d=Nr(l):f?(p=!1,d=Sr(c,!0)):m?(p=!1,d=_r(c,!0)):d=[]:os(c)||ja(c)?(d=l,ja(l)?d=ys(l):ts(l)&&!Ja(l)||(d=yo(c))):p=!1}p&&(s.set(c,d),o(d,c,r,a,s),s.delete(c));ti(e,i,d)}(e,t,s,i,Vi,r,o);else{var l=r?r(No(e,s),a,s+"",e,t,o):n;l===n&&(l=a),ti(e,s,l)}}),Ds)}function ji(e,t){var i=e.length;if(i)return Eo(t+=t<0?i:0,i)?e[t]:n}function Gi(e,t,n){t=t.length?Dt(t,(function(e){return Ga(e)?function(t){return Si(t,1===e.length?e[0]:e)}:e})):[rl];var i=-1;t=Dt(t,Zt(co()));var r=Hi(e,(function(e,n,r){var o=Dt(t,(function(t){return t(e)}));return{criteria:o,index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(r,(function(e,t){return function(e,t,n){var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;for(;++i<a;){var l=Tr(r[i],o[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function qi(e,t,n){for(var i=-1,r=t.length,o={};++i<r;){var a=t[i],s=Si(e,a);n(s,a)&&er(o,Er(a,e),s)}return o}function Ki(e,t,n,i){var r=i?Wt:Ut,o=-1,a=t.length,s=e;for(e===t&&(t=Nr(t)),n&&(s=Dt(e,Zt(n)));++o<a;)for(var l=0,c=t[o],u=n?n(c):c;(l=r(s,u,l,i))>-1;)s!==e&&Qe.call(s,l,1),Qe.call(e,l,1);return e}function Yi(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==o){var o=r;Eo(r)?Qe.call(e,r,1):pr(e,r)}}return e}function Xi(e,t){return e+gt(Cn()*(t-e+1))}function Qi(e,t){var n="";if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=gt(t/2))&&(e+=e)}while(t);return n}function Zi(e,t){return Do(Io(e,t,rl),e+"")}function Ji(e){return Jn(Us(e))}function $i(e,t){var n=Us(e);return Lo(n,li(t,0,n.length))}function er(e,t,i,r){if(!ts(e))return e;for(var o=-1,a=(t=Er(t,e)).length,s=a-1,l=e;null!=l&&++o<a;){var c=Fo(t[o]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=s){var d=l[c];(u=r?r(d,c,l):n)===n&&(u=ts(d)?d:Eo(t[o+1])?[]:{})}ni(l,c,u),l=l[c]}return e}var tr=Mn?function(e,t){return Mn.set(e,t),e}:rl,nr=lt?function(e,t){return lt(e,"toString",{configurable:!0,enumerable:!1,value:tl(t),writable:!0})}:rl;function ir(e){return Lo(Us(e))}function rr(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=we(r);++i<r;)o[i]=e[i+t];return o}function or(e,t){var n;return hi(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}function ar(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t==t&&r<=2147483647){for(;i<r;){var o=i+r>>>1,a=e[o];null!==a&&!cs(a)&&(n?a<=t:a<t)?i=o+1:r=o}return r}return sr(e,t,rl,n)}function sr(e,t,i,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=i(t))!=t,l=null===t,c=cs(t),u=t===n;o<a;){var d=gt((o+a)/2),p=i(e[d]),h=p!==n,f=null===p,m=p==p,v=cs(p);if(s)var g=r||m;else g=u?m&&(r||h):l?m&&h&&(r||!f):c?m&&h&&!f&&(r||!v):!f&&!v&&(r?p<=t:p<t);g?o=d+1:a=d}return En(a,4294967294)}function lr(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n],s=t?t(a):a;if(!n||!Ua(s,l)){var l=s;o[r++]=0===a?0:a}}return o}function cr(e){return"number"==typeof e?e:cs(e)?h:+e}function ur(e){if("string"==typeof e)return e;if(Ga(e))return Dt(e,ur)+"";if(cs(e))return Hn?Hn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function dr(e,t,n){var i=-1,r=Mt,o=e.length,a=!0,s=[],l=s;if(n)a=!1,r=At;else if(o>=200){var c=t?null:Qr(e);if(c)return un(c);a=!1,r=$t,l=new Xn}else l=t?[]:s;e:for(;++i<o;){var u=e[i],d=t?t(u):u;if(u=n||0!==u?u:0,a&&d==d){for(var p=l.length;p--;)if(l[p]===d)continue e;t&&l.push(d),s.push(u)}else r(l,d,n)||(l!==s&&l.push(d),s.push(u))}return s}function pr(e,t){return null==(e=Po(e,t=Er(t,e)))||delete e[Fo(Zo(t))]}function hr(e,t,n,i){return er(e,t,n(Si(e,t)),i)}function fr(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?rr(e,i?0:o,i?o+1:r):rr(e,i?o+1:0,i?r:o)}function mr(e,t){var n=e;return n instanceof Gn&&(n=n.value()),Bt(t,(function(e,t){return t.func.apply(t.thisArg,Rt([e],t.args))}),n)}function vr(e,t,n){var i=e.length;if(i<2)return i?dr(e[0]):[];for(var r=-1,o=we(i);++r<i;)for(var a=e[r],s=-1;++s<i;)s!=r&&(o[r]=pi(o[r]||a,e[s],t,n));return dr(yi(o,1),t,n)}function gr(e,t,i){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var l=r<a?t[r]:n;i(s,e[r],l)}return s}function yr(e){return Ya(e)?e:[]}function br(e){return"function"==typeof e?e:rl}function Er(e,t){return Ga(e)?e:wo(e,t)?[e]:Oo(bs(e))}var xr=Zi;function wr(e,t,i){var r=e.length;return i=i===n?r:i,!t&&i>=r?e:rr(e,t,i)}var Cr=dt||function(e){return ht.clearTimeout(e)};function Sr(e,t){if(t)return e.slice();var n=e.length,i=qe?qe(n):new e.constructor(n);return e.copy(i),i}function kr(e){var t=new e.constructor(e.byteLength);return new Ge(t).set(new Ge(e)),t}function _r(e,t){var n=t?kr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Tr(e,t){if(e!==t){var i=e!==n,r=null===e,o=e==e,a=cs(e),s=t!==n,l=null===t,c=t==t,u=cs(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||r&&s&&c||!i&&c||!o)return 1;if(!r&&!a&&!u&&e<t||u&&i&&o&&!r&&!a||l&&i&&o||!s&&o||!c)return-1}return 0}function Ir(e,t,n,i){for(var r=-1,o=e.length,a=n.length,s=-1,l=t.length,c=bn(o-a,0),u=we(l+c),d=!i;++s<l;)u[s]=t[s];for(;++r<a;)(d||r<o)&&(u[n[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}function Pr(e,t,n,i){for(var r=-1,o=e.length,a=-1,s=n.length,l=-1,c=t.length,u=bn(o-s,0),d=we(u+c),p=!i;++r<u;)d[r]=e[r];for(var h=r;++l<c;)d[h+l]=t[l];for(;++a<s;)(p||r<o)&&(d[h+n[a]]=e[r++]);return d}function Nr(e,t){var n=-1,i=e.length;for(t||(t=we(i));++n<i;)t[n]=e[n];return t}function Mr(e,t,i,r){var o=!i;i||(i={});for(var a=-1,s=t.length;++a<s;){var l=t[a],c=r?r(i[l],e[l],l,i,e):n;c===n&&(c=e[l]),o?ai(i,l,c):ni(i,l,c)}return i}function Ar(e,t){return function(n,i){var r=Ga(n)?_t:ri,o=t?t():{};return r(n,e,co(i,2),o)}}function Dr(e){return Zi((function(t,i){var r=-1,o=i.length,a=o>1?i[o-1]:n,s=o>2?i[2]:n;for(a=e.length>3&&"function"==typeof a?(o--,a):n,s&&xo(i[0],i[1],s)&&(a=o<3?n:a,o=1),t=Te(t);++r<o;){var l=i[r];l&&e(t,l,r,a)}return t}))}function Rr(e,t){return function(n,i){if(null==n)return n;if(!Ka(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Te(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function Br(e){return function(t,n,i){for(var r=-1,o=Te(t),a=i(t),s=a.length;s--;){var l=a[e?s:++r];if(!1===n(o[l],l,o))break}return t}}function Lr(e){return function(t){var i=an(t=bs(t))?hn(t):n,r=i?i[0]:t.charAt(0),o=i?wr(i,1).join(""):t.slice(1);return r[e]()+o}}function Or(e){return function(t){return Bt(Js(js(t).replace(Je,"")),e,"")}}function Fr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Wn(e.prototype),i=e.apply(n,t);return ts(i)?i:n}}function zr(e){return function(t,i,r){var o=Te(t);if(!Ka(t)){var a=co(i,3);t=As(t),i=function(e){return a(o[e],e,o)}}var s=e(t,i,r);return s>-1?o[a?t[s]:s]:n}}function Hr(e){return io((function(t){var r=t.length,o=r,a=jn.prototype.thru;for(e&&t.reverse();o--;){var s=t[o];if("function"!=typeof s)throw new Ne(i);if(a&&!l&&"wrapper"==so(s))var l=new jn([],!0)}for(o=l?o:r;++o<r;){var c=so(s=t[o]),u="wrapper"==c?ao(s):n;l=u&&Co(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[so(u[0])].apply(l,u[3]):1==s.length&&Co(s)?l[c]():l.thru(s)}return function(){var e=arguments,n=e[0];if(l&&1==e.length&&Ga(n))return l.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}}))}function Ur(e,t,i,r,o,a,s,l,u,d){var p=t&c,h=1&t,f=2&t,m=24&t,v=512&t,g=f?n:Fr(e);return function c(){for(var y=arguments.length,b=we(y),E=y;E--;)b[E]=arguments[E];if(m)var x=lo(c),w=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(b,x);if(r&&(b=Ir(b,r,o,m)),a&&(b=Pr(b,a,s,m)),y-=w,m&&y<d){var C=cn(b,x);return Yr(e,t,Ur,c.placeholder,i,b,C,l,u,d-y)}var S=h?i:this,k=f?S[e]:e;return y=b.length,l?b=function(e,t){var i=e.length,r=En(t.length,i),o=Nr(e);for(;r--;){var a=t[r];e[r]=Eo(a,i)?o[a]:n}return e}(b,l):v&&y>1&&b.reverse(),p&&u<y&&(b.length=u),this&&this!==ht&&this instanceof c&&(k=g||Fr(k)),k.apply(S,b)}}function Wr(e,t){return function(n,i){return function(e,t,n,i){return xi(e,(function(e,r,o){t(i,n(e),r,o)})),i}(n,e,t(i),{})}}function Vr(e,t){return function(i,r){var o;if(i===n&&r===n)return t;if(i!==n&&(o=i),r!==n){if(o===n)return r;"string"==typeof i||"string"==typeof r?(i=ur(i),r=ur(r)):(i=cr(i),r=cr(r)),o=e(i,r)}return o}}function jr(e){return io((function(t){return t=Dt(t,Zt(co())),Zi((function(n){var i=this;return e(t,(function(e){return kt(e,i,n)}))}))}))}function Gr(e,t){var i=(t=t===n?" ":ur(t)).length;if(i<2)return i?Qi(t,e):t;var r=Qi(t,mt(e/pn(t)));return an(t)?wr(hn(r),0,e).join(""):r.slice(0,e)}function qr(e){return function(t,i,r){return r&&"number"!=typeof r&&xo(t,i,r)&&(i=r=n),t=fs(t),i===n?(i=t,t=0):i=fs(i),function(e,t,n,i){for(var r=-1,o=bn(mt((t-e)/(n||1)),0),a=we(o);o--;)a[i?o:++r]=e,e+=n;return a}(t,i,r=r===n?t<i?1:-1:fs(r),e)}}function Kr(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=gs(t),n=gs(n)),e(t,n)}}function Yr(e,t,i,r,o,a,c,u,d,p){var h=8&t;t|=h?s:l,4&(t&=~(h?l:s))||(t&=-4);var f=[e,t,o,h?a:n,h?c:n,h?n:a,h?n:c,u,d,p],m=i.apply(n,f);return Co(e)&&Mo(m,f),m.placeholder=r,Ro(m,e,t)}function Xr(e){var t=_e[e];return function(e,n){if(e=gs(e),(n=null==n?0:En(ms(n),292))&&qt(e)){var i=(bs(e)+"e").split("e");return+((i=(bs(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var Qr=In&&1/un(new In([,-0]))[1]==d?function(e){return new In(e)}:cl;function Zr(e){return function(t){var n=vo(t);return n==C?sn(t):n==I?dn(t):function(e,t){return Dt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Jr(e,t,r,d,p,h,f,m){var v=2&t;if(!v&&"function"!=typeof e)throw new Ne(i);var g=d?d.length:0;if(g||(t&=-97,d=p=n),f=f===n?f:bn(ms(f),0),m=m===n?m:ms(m),g-=p?p.length:0,t&l){var y=d,b=p;d=p=n}var E=v?n:ao(e),x=[e,t,r,d,p,y,b,h,f,m];if(E&&function(e,t){var n=e[1],i=t[1],r=n|i,a=r<131,s=i==c&&8==n||i==c&&n==u&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!a&&!s)return e;1&i&&(e[2]=t[2],r|=1&n?0:4);var l=t[3];if(l){var d=e[3];e[3]=d?Ir(d,l,t[4]):l,e[4]=d?cn(e[3],o):t[4]}(l=t[5])&&(d=e[5],e[5]=d?Pr(d,l,t[6]):l,e[6]=d?cn(e[5],o):t[6]);(l=t[7])&&(e[7]=l);i&c&&(e[8]=null==e[8]?t[8]:En(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=r}(x,E),e=x[0],t=x[1],r=x[2],d=x[3],p=x[4],!(m=x[9]=x[9]===n?v?0:e.length:bn(x[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)w=8==t||t==a?function(e,t,i){var r=Fr(e);return function o(){for(var a=arguments.length,s=we(a),l=a,c=lo(o);l--;)s[l]=arguments[l];var u=a<3&&s[0]!==c&&s[a-1]!==c?[]:cn(s,c);return(a-=u.length)<i?Yr(e,t,Ur,o.placeholder,n,s,u,n,n,i-a):kt(this&&this!==ht&&this instanceof o?r:e,this,s)}}(e,t,m):t!=s&&33!=t||p.length?Ur.apply(n,x):function(e,t,n,i){var r=1&t,o=Fr(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=i.length,u=we(c+s),d=this&&this!==ht&&this instanceof t?o:e;++l<c;)u[l]=i[l];for(;s--;)u[l++]=arguments[++a];return kt(d,r?n:this,u)}}(e,t,r,d);else var w=function(e,t,n){var i=1&t,r=Fr(e);return function t(){return(this&&this!==ht&&this instanceof t?r:e).apply(i?n:this,arguments)}}(e,t,r);return Ro((E?tr:Mo)(w,x),e,t)}function $r(e,t,i,r){return e===n||Ua(e,De[i])&&!Le.call(r,i)?t:e}function eo(e,t,i,r,o,a){return ts(e)&&ts(t)&&(a.set(t,e),Vi(e,t,n,eo,a),a.delete(t)),e}function to(e){return os(e)?n:e}function no(e,t,i,r,o,a){var s=1&i,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var u=a.get(e),d=a.get(t);if(u&&d)return u==t&&d==e;var p=-1,h=!0,f=2&i?new Xn:n;for(a.set(e,t),a.set(t,e);++p<l;){var m=e[p],v=t[p];if(r)var g=s?r(v,m,p,t,e,a):r(m,v,p,e,t,a);if(g!==n){if(g)continue;h=!1;break}if(f){if(!Ot(t,(function(e,t){if(!$t(f,t)&&(m===e||o(m,e,i,r,a)))return f.push(t)}))){h=!1;break}}else if(m!==v&&!o(m,v,i,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function io(e){return Do(Io(e,n,qo),e+"")}function ro(e){return ki(e,As,fo)}function oo(e){return ki(e,Ds,mo)}var ao=Mn?function(e){return Mn.get(e)}:cl;function so(e){for(var t=e.name+"",n=An[t],i=Le.call(An,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function lo(e){return(Le.call(Un,"placeholder")?Un:e).placeholder}function co(){var e=Un.iteratee||ol;return e=e===ol?Li:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function po(e){for(var t=As(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,_o(r)]}return t}function ho(e,t){var i=function(e,t){return null==e?n:e[t]}(e,t);return Bi(i)?i:n}var fo=yt?function(e){return null==e?[]:(e=Te(e),Nt(yt(e),(function(t){return Xe.call(e,t)})))}:vl,mo=yt?function(e){for(var t=[];e;)Rt(t,fo(e)),e=Ke(e);return t}:vl,vo=_i;function go(e,t,n){for(var i=-1,r=(t=Er(t,e)).length,o=!1;++i<r;){var a=Fo(t[i]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++i!=r?o:!!(r=null==e?0:e.length)&&es(r)&&Eo(a,r)&&(Ga(e)||ja(e))}function yo(e){return"function"!=typeof e.constructor||ko(e)?{}:Wn(Ke(e))}function bo(e){return Ga(e)||ja(e)||!!(Ze&&e&&e[Ze])}function Eo(e,t){var n=typeof e;return!!(t=null==t?p:t)&&("number"==n||"symbol"!=n&&ye.test(e))&&e>-1&&e%1==0&&e<t}function xo(e,t,n){if(!ts(n))return!1;var i=typeof t;return!!("number"==i?Ka(n)&&Eo(t,n.length):"string"==i&&t in n)&&Ua(n[t],e)}function wo(e,t){if(Ga(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!cs(e))||(ee.test(e)||!$.test(e)||null!=t&&e in Te(t))}function Co(e){var t=so(e),n=Un[t];if("function"!=typeof n||!(t in Gn.prototype))return!1;if(e===n)return!0;var i=ao(n);return!!i&&e===i[0]}(kn&&vo(new kn(new ArrayBuffer(1)))!=D||_n&&vo(new _n)!=C||Tn&&vo(Tn.resolve())!=_||In&&vo(new In)!=I||Pn&&vo(new Pn)!=M)&&(vo=function(e){var t=_i(e),i=t==k?e.constructor:n,r=i?zo(i):"";if(r)switch(r){case Dn:return D;case Rn:return C;case Bn:return _;case Ln:return I;case On:return M}return t});var So=Re?Ja:gl;function ko(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||De)}function _o(e){return e==e&&!ts(e)}function To(e,t){return function(i){return null!=i&&(i[e]===t&&(t!==n||e in Te(i)))}}function Io(e,t,i){return t=bn(t===n?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=bn(n.length-t,0),a=we(o);++r<o;)a[r]=n[t+r];r=-1;for(var s=we(t+1);++r<t;)s[r]=n[r];return s[t]=i(a),kt(e,this,s)}}function Po(e,t){return t.length<2?e:Si(e,rr(t,0,-1))}function No(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Mo=Bo(tr),Ao=ft||function(e,t){return ht.setTimeout(e,t)},Do=Bo(nr);function Ro(e,t,n){var i=t+"";return Do(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(ae,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return Tt(m,(function(n){var i="_."+n[0];t&n[1]&&!Mt(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(le):[]}(i),n)))}function Bo(e){var t=0,i=0;return function(){var r=xn(),o=16-(r-i);if(i=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(n,arguments)}}function Lo(e,t){var i=-1,r=e.length,o=r-1;for(t=t===n?r:t;++i<t;){var a=Xi(i,o),s=e[a];e[a]=e[i],e[i]=s}return e.length=t,e}var Oo=function(e){var t=Ba(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(te,(function(e,n,i,r){t.push(i?r.replace(de,"$1"):n||e)})),t}));function Fo(e){if("string"==typeof e||cs(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function zo(e){if(null!=e){try{return Be.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ho(e){if(e instanceof Gn)return e.clone();var t=new jn(e.__wrapped__,e.__chain__);return t.__actions__=Nr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Uo=Zi((function(e,t){return Ya(e)?pi(e,yi(t,1,Ya,!0)):[]})),Wo=Zi((function(e,t){var i=Zo(t);return Ya(i)&&(i=n),Ya(e)?pi(e,yi(t,1,Ya,!0),co(i,2)):[]})),Vo=Zi((function(e,t){var i=Zo(t);return Ya(i)&&(i=n),Ya(e)?pi(e,yi(t,1,Ya,!0),n,i):[]}));function jo(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:ms(n);return r<0&&(r=bn(i+r,0)),Ht(e,co(t,3),r)}function Go(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return i!==n&&(o=ms(i),o=i<0?bn(r+o,0):En(o,r-1)),Ht(e,co(t,3),o,!0)}function qo(e){return(null==e?0:e.length)?yi(e,1):[]}function Ko(e){return e&&e.length?e[0]:n}var Yo=Zi((function(e){var t=Dt(e,yr);return t.length&&t[0]===e[0]?Ni(t):[]})),Xo=Zi((function(e){var t=Zo(e),i=Dt(e,yr);return t===Zo(i)?t=n:i.pop(),i.length&&i[0]===e[0]?Ni(i,co(t,2)):[]})),Qo=Zi((function(e){var t=Zo(e),i=Dt(e,yr);return(t="function"==typeof t?t:n)&&i.pop(),i.length&&i[0]===e[0]?Ni(i,n,t):[]}));function Zo(e){var t=null==e?0:e.length;return t?e[t-1]:n}var Jo=Zi($o);function $o(e,t){return e&&e.length&&t&&t.length?Ki(e,t):e}var ea=io((function(e,t){var n=null==e?0:e.length,i=si(e,t);return Yi(e,Dt(t,(function(e){return Eo(e,n)?+e:e})).sort(Tr)),i}));function ta(e){return null==e?e:Sn.call(e)}var na=Zi((function(e){return dr(yi(e,1,Ya,!0))})),ia=Zi((function(e){var t=Zo(e);return Ya(t)&&(t=n),dr(yi(e,1,Ya,!0),co(t,2))})),ra=Zi((function(e){var t=Zo(e);return t="function"==typeof t?t:n,dr(yi(e,1,Ya,!0),n,t)}));function oa(e){if(!e||!e.length)return[];var t=0;return e=Nt(e,(function(e){if(Ya(e))return t=bn(e.length,t),!0})),Xt(t,(function(t){return Dt(e,Gt(t))}))}function aa(e,t){if(!e||!e.length)return[];var i=oa(e);return null==t?i:Dt(i,(function(e){return kt(t,n,e)}))}var sa=Zi((function(e,t){return Ya(e)?pi(e,t):[]})),la=Zi((function(e){return vr(Nt(e,Ya))})),ca=Zi((function(e){var t=Zo(e);return Ya(t)&&(t=n),vr(Nt(e,Ya),co(t,2))})),ua=Zi((function(e){var t=Zo(e);return t="function"==typeof t?t:n,vr(Nt(e,Ya),n,t)})),da=Zi(oa);var pa=Zi((function(e){var t=e.length,i=t>1?e[t-1]:n;return i="function"==typeof i?(e.pop(),i):n,aa(e,i)}));function ha(e){var t=Un(e);return t.__chain__=!0,t}function fa(e,t){return t(e)}var ma=io((function(e){var t=e.length,i=t?e[0]:0,r=this.__wrapped__,o=function(t){return si(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Gn&&Eo(i)?((r=r.slice(i,+i+(t?1:0))).__actions__.push({func:fa,args:[o],thisArg:n}),new jn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(n),e}))):this.thru(o)}));var va=Ar((function(e,t,n){Le.call(e,n)?++e[n]:ai(e,n,1)}));var ga=zr(jo),ya=zr(Go);function ba(e,t){return(Ga(e)?Tt:hi)(e,co(t,3))}function Ea(e,t){return(Ga(e)?It:fi)(e,co(t,3))}var xa=Ar((function(e,t,n){Le.call(e,n)?e[n].push(t):ai(e,n,[t])}));var wa=Zi((function(e,t,n){var i=-1,r="function"==typeof t,o=Ka(e)?we(e.length):[];return hi(e,(function(e){o[++i]=r?kt(t,e,n):Mi(e,t,n)})),o})),Ca=Ar((function(e,t,n){ai(e,n,t)}));function Sa(e,t){return(Ga(e)?Dt:Hi)(e,co(t,3))}var ka=Ar((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var _a=Zi((function(e,t){if(null==e)return[];var n=t.length;return n>1&&xo(e,t[0],t[1])?t=[]:n>2&&xo(t[0],t[1],t[2])&&(t=[t[0]]),Gi(e,yi(t,1),[])})),Ta=pt||function(){return ht.Date.now()};function Ia(e,t,i){return t=i?n:t,t=e&&null==t?e.length:t,Jr(e,c,n,n,n,n,t)}function Pa(e,t){var r;if("function"!=typeof t)throw new Ne(i);return e=ms(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=n),r}}var Na=Zi((function(e,t,n){var i=1;if(n.length){var r=cn(n,lo(Na));i|=s}return Jr(e,i,t,n,r)})),Ma=Zi((function(e,t,n){var i=3;if(n.length){var r=cn(n,lo(Ma));i|=s}return Jr(t,i,e,n,r)}));function Aa(e,t,r){var o,a,s,l,c,u,d=0,p=!1,h=!1,f=!0;if("function"!=typeof e)throw new Ne(i);function m(t){var i=o,r=a;return o=a=n,d=t,l=e.apply(r,i)}function v(e){var i=e-u;return u===n||i>=t||i<0||h&&e-d>=s}function g(){var e=Ta();if(v(e))return y(e);c=Ao(g,function(e){var n=t-(e-u);return h?En(n,s-(e-d)):n}(e))}function y(e){return c=n,f&&o?m(e):(o=a=n,l)}function b(){var e=Ta(),i=v(e);if(o=arguments,a=this,u=e,i){if(c===n)return function(e){return d=e,c=Ao(g,t),p?m(e):l}(u);if(h)return Cr(c),c=Ao(g,t),m(u)}return c===n&&(c=Ao(g,t)),l}return t=gs(t)||0,ts(r)&&(p=!!r.leading,s=(h="maxWait"in r)?bn(gs(r.maxWait)||0,t):s,f="trailing"in r?!!r.trailing:f),b.cancel=function(){c!==n&&Cr(c),d=0,o=u=a=c=n},b.flush=function(){return c===n?l:y(Ta())},b}var Da=Zi((function(e,t){return di(e,1,t)})),Ra=Zi((function(e,t,n){return di(e,gs(t)||0,n)}));function Ba(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Ne(i);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=e.apply(this,i);return n.cache=o.set(r,a)||o,a};return n.cache=new(Ba.Cache||Yn),n}function La(e){if("function"!=typeof e)throw new Ne(i);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ba.Cache=Yn;var Oa=xr((function(e,t){var n=(t=1==t.length&&Ga(t[0])?Dt(t[0],Zt(co())):Dt(yi(t,1),Zt(co()))).length;return Zi((function(i){for(var r=-1,o=En(i.length,n);++r<o;)i[r]=t[r].call(this,i[r]);return kt(e,this,i)}))})),Fa=Zi((function(e,t){var i=cn(t,lo(Fa));return Jr(e,s,n,t,i)})),za=Zi((function(e,t){var i=cn(t,lo(za));return Jr(e,l,n,t,i)})),Ha=io((function(e,t){return Jr(e,u,n,n,n,t)}));function Ua(e,t){return e===t||e!=e&&t!=t}var Wa=Kr(Ti),Va=Kr((function(e,t){return e>=t})),ja=Ai(function(){return arguments}())?Ai:function(e){return ns(e)&&Le.call(e,"callee")&&!Xe.call(e,"callee")},Ga=we.isArray,qa=bt?Zt(bt):function(e){return ns(e)&&_i(e)==A};function Ka(e){return null!=e&&es(e.length)&&!Ja(e)}function Ya(e){return ns(e)&&Ka(e)}var Xa=Ft||gl,Qa=Et?Zt(Et):function(e){return ns(e)&&_i(e)==b};function Za(e){if(!ns(e))return!1;var t=_i(e);return t==E||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!os(e)}function Ja(e){if(!ts(e))return!1;var t=_i(e);return t==x||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function $a(e){return"number"==typeof e&&e==ms(e)}function es(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=p}function ts(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ns(e){return null!=e&&"object"==typeof e}var is=xt?Zt(xt):function(e){return ns(e)&&vo(e)==C};function rs(e){return"number"==typeof e||ns(e)&&_i(e)==S}function os(e){if(!ns(e)||_i(e)!=k)return!1;var t=Ke(e);if(null===t)return!0;var n=Le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Be.call(n)==He}var as=wt?Zt(wt):function(e){return ns(e)&&_i(e)==T};var ss=Ct?Zt(Ct):function(e){return ns(e)&&vo(e)==I};function ls(e){return"string"==typeof e||!Ga(e)&&ns(e)&&_i(e)==P}function cs(e){return"symbol"==typeof e||ns(e)&&_i(e)==N}var us=St?Zt(St):function(e){return ns(e)&&es(e.length)&&!!at[_i(e)]};var ds=Kr(zi),ps=Kr((function(e,t){return e<=t}));function hs(e){if(!e)return[];if(Ka(e))return ls(e)?hn(e):Nr(e);if(et&&e[et])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[et]());var t=vo(e);return(t==C?sn:t==I?un:Us)(e)}function fs(e){return e?(e=gs(e))===d||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ms(e){var t=fs(e),n=t%1;return t==t?n?t-n:t:0}function vs(e){return e?li(ms(e),0,f):0}function gs(e){if("number"==typeof e)return e;if(cs(e))return h;if(ts(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ts(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Qt(e);var n=me.test(e);return n||ge.test(e)?ut(e.slice(2),n?2:8):fe.test(e)?h:+e}function ys(e){return Mr(e,Ds(e))}function bs(e){return null==e?"":ur(e)}var Es=Dr((function(e,t){if(ko(t)||Ka(t))Mr(t,As(t),e);else for(var n in t)Le.call(t,n)&&ni(e,n,t[n])})),xs=Dr((function(e,t){Mr(t,Ds(t),e)})),ws=Dr((function(e,t,n,i){Mr(t,Ds(t),e,i)})),Cs=Dr((function(e,t,n,i){Mr(t,As(t),e,i)})),Ss=io(si);var ks=Zi((function(e,t){e=Te(e);var i=-1,r=t.length,o=r>2?t[2]:n;for(o&&xo(t[0],t[1],o)&&(r=1);++i<r;)for(var a=t[i],s=Ds(a),l=-1,c=s.length;++l<c;){var u=s[l],d=e[u];(d===n||Ua(d,De[u])&&!Le.call(e,u))&&(e[u]=a[u])}return e})),_s=Zi((function(e){return e.push(n,eo),kt(Bs,n,e)}));function Ts(e,t,i){var r=null==e?n:Si(e,t);return r===n?i:r}function Is(e,t){return null!=e&&go(e,t,Pi)}var Ps=Wr((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ze.call(t)),e[t]=n}),tl(rl)),Ns=Wr((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ze.call(t)),Le.call(e,t)?e[t].push(n):e[t]=[n]}),co),Ms=Zi(Mi);function As(e){return Ka(e)?Zn(e):Oi(e)}function Ds(e){return Ka(e)?Zn(e,!0):Fi(e)}var Rs=Dr((function(e,t,n){Vi(e,t,n)})),Bs=Dr((function(e,t,n,i){Vi(e,t,n,i)})),Ls=io((function(e,t){var n={};if(null==e)return n;var i=!1;t=Dt(t,(function(t){return t=Er(t,e),i||(i=t.length>1),t})),Mr(e,oo(e),n),i&&(n=ci(n,7,to));for(var r=t.length;r--;)pr(n,t[r]);return n}));var Os=io((function(e,t){return null==e?{}:function(e,t){return qi(e,t,(function(t,n){return Is(e,n)}))}(e,t)}));function Fs(e,t){if(null==e)return{};var n=Dt(oo(e),(function(e){return[e]}));return t=co(t),qi(e,n,(function(e,n){return t(e,n[0])}))}var zs=Zr(As),Hs=Zr(Ds);function Us(e){return null==e?[]:Jt(e,As(e))}var Ws=Or((function(e,t,n){return t=t.toLowerCase(),e+(n?Vs(t):t)}));function Vs(e){return Zs(bs(e).toLowerCase())}function js(e){return(e=bs(e))&&e.replace(be,nn).replace($e,"")}var Gs=Or((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),qs=Or((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ks=Lr("toLowerCase");var Ys=Or((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Xs=Or((function(e,t,n){return e+(n?" ":"")+Zs(t)}));var Qs=Or((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Zs=Lr("toUpperCase");function Js(e,t,i){return e=bs(e),(t=i?n:t)===n?function(e){return it.test(e)}(e)?function(e){return e.match(tt)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var $s=Zi((function(e,t){try{return kt(e,n,t)}catch(e){return Za(e)?e:new Se(e)}})),el=io((function(e,t){return Tt(t,(function(t){t=Fo(t),ai(e,t,Na(e[t],e))})),e}));function tl(e){return function(){return e}}var nl=Hr(),il=Hr(!0);function rl(e){return e}function ol(e){return Li("function"==typeof e?e:ci(e,1))}var al=Zi((function(e,t){return function(n){return Mi(n,e,t)}})),sl=Zi((function(e,t){return function(n){return Mi(e,n,t)}}));function ll(e,t,n){var i=As(t),r=Ci(t,i);null!=n||ts(t)&&(r.length||!i.length)||(n=t,t=e,e=this,r=Ci(t,As(t)));var o=!(ts(n)&&"chain"in n&&!n.chain),a=Ja(e);return Tt(r,(function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Nr(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,Rt([this.value()],arguments))})})),e}function cl(){}var ul=jr(Dt),dl=jr(Pt),pl=jr(Ot);function hl(e){return wo(e)?Gt(Fo(e)):function(e){return function(t){return Si(t,e)}}(e)}var fl=qr(),ml=qr(!0);function vl(){return[]}function gl(){return!1}var yl=Vr((function(e,t){return e+t}),0),bl=Xr("ceil"),El=Vr((function(e,t){return e/t}),1),xl=Xr("floor");var wl,Cl=Vr((function(e,t){return e*t}),1),Sl=Xr("round"),kl=Vr((function(e,t){return e-t}),0);return Un.after=function(e,t){if("function"!=typeof t)throw new Ne(i);return e=ms(e),function(){if(--e<1)return t.apply(this,arguments)}},Un.ary=Ia,Un.assign=Es,Un.assignIn=xs,Un.assignInWith=ws,Un.assignWith=Cs,Un.at=Ss,Un.before=Pa,Un.bind=Na,Un.bindAll=el,Un.bindKey=Ma,Un.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ga(e)?e:[e]},Un.chain=ha,Un.chunk=function(e,t,i){t=(i?xo(e,t,i):t===n)?1:bn(ms(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,a=0,s=we(mt(r/t));o<r;)s[a++]=rr(e,o,o+=t);return s},Un.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var o=e[t];o&&(r[i++]=o)}return r},Un.concat=function(){var e=arguments.length;if(!e)return[];for(var t=we(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Rt(Ga(n)?Nr(n):[n],yi(t,1))},Un.cond=function(e){var t=null==e?0:e.length,n=co();return e=t?Dt(e,(function(e){if("function"!=typeof e[1])throw new Ne(i);return[n(e[0]),e[1]]})):[],Zi((function(n){for(var i=-1;++i<t;){var r=e[i];if(kt(r[0],this,n))return kt(r[1],this,n)}}))},Un.conforms=function(e){return function(e){var t=As(e);return function(n){return ui(n,e,t)}}(ci(e,1))},Un.constant=tl,Un.countBy=va,Un.create=function(e,t){var n=Wn(e);return null==t?n:oi(n,t)},Un.curry=function e(t,i,r){var o=Jr(t,8,n,n,n,n,n,i=r?n:i);return o.placeholder=e.placeholder,o},Un.curryRight=function e(t,i,r){var o=Jr(t,a,n,n,n,n,n,i=r?n:i);return o.placeholder=e.placeholder,o},Un.debounce=Aa,Un.defaults=ks,Un.defaultsDeep=_s,Un.defer=Da,Un.delay=Ra,Un.difference=Uo,Un.differenceBy=Wo,Un.differenceWith=Vo,Un.drop=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,(t=i||t===n?1:ms(t))<0?0:t,r):[]},Un.dropRight=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,0,(t=r-(t=i||t===n?1:ms(t)))<0?0:t):[]},Un.dropRightWhile=function(e,t){return e&&e.length?fr(e,co(t,3),!0,!0):[]},Un.dropWhile=function(e,t){return e&&e.length?fr(e,co(t,3),!0):[]},Un.fill=function(e,t,i,r){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&xo(e,t,i)&&(i=0,r=o),function(e,t,i,r){var o=e.length;for((i=ms(i))<0&&(i=-i>o?0:o+i),(r=r===n||r>o?o:ms(r))<0&&(r+=o),r=i>r?0:vs(r);i<r;)e[i++]=t;return e}(e,t,i,r)):[]},Un.filter=function(e,t){return(Ga(e)?Nt:gi)(e,co(t,3))},Un.flatMap=function(e,t){return yi(Sa(e,t),1)},Un.flatMapDeep=function(e,t){return yi(Sa(e,t),d)},Un.flatMapDepth=function(e,t,i){return i=i===n?1:ms(i),yi(Sa(e,t),i)},Un.flatten=qo,Un.flattenDeep=function(e){return(null==e?0:e.length)?yi(e,d):[]},Un.flattenDepth=function(e,t){return(null==e?0:e.length)?yi(e,t=t===n?1:ms(t)):[]},Un.flip=function(e){return Jr(e,512)},Un.flow=nl,Un.flowRight=il,Un.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var r=e[t];i[r[0]]=r[1]}return i},Un.functions=function(e){return null==e?[]:Ci(e,As(e))},Un.functionsIn=function(e){return null==e?[]:Ci(e,Ds(e))},Un.groupBy=xa,Un.initial=function(e){return(null==e?0:e.length)?rr(e,0,-1):[]},Un.intersection=Yo,Un.intersectionBy=Xo,Un.intersectionWith=Qo,Un.invert=Ps,Un.invertBy=Ns,Un.invokeMap=wa,Un.iteratee=ol,Un.keyBy=Ca,Un.keys=As,Un.keysIn=Ds,Un.map=Sa,Un.mapKeys=function(e,t){var n={};return t=co(t,3),xi(e,(function(e,i,r){ai(n,t(e,i,r),e)})),n},Un.mapValues=function(e,t){var n={};return t=co(t,3),xi(e,(function(e,i,r){ai(n,i,t(e,i,r))})),n},Un.matches=function(e){return Ui(ci(e,1))},Un.matchesProperty=function(e,t){return Wi(e,ci(t,1))},Un.memoize=Ba,Un.merge=Rs,Un.mergeWith=Bs,Un.method=al,Un.methodOf=sl,Un.mixin=ll,Un.negate=La,Un.nthArg=function(e){return e=ms(e),Zi((function(t){return ji(t,e)}))},Un.omit=Ls,Un.omitBy=function(e,t){return Fs(e,La(co(t)))},Un.once=function(e){return Pa(2,e)},Un.orderBy=function(e,t,i,r){return null==e?[]:(Ga(t)||(t=null==t?[]:[t]),Ga(i=r?n:i)||(i=null==i?[]:[i]),Gi(e,t,i))},Un.over=ul,Un.overArgs=Oa,Un.overEvery=dl,Un.overSome=pl,Un.partial=Fa,Un.partialRight=za,Un.partition=ka,Un.pick=Os,Un.pickBy=Fs,Un.property=hl,Un.propertyOf=function(e){return function(t){return null==e?n:Si(e,t)}},Un.pull=Jo,Un.pullAll=$o,Un.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Ki(e,t,co(n,2)):e},Un.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?Ki(e,t,n,i):e},Un.pullAt=ea,Un.range=fl,Un.rangeRight=ml,Un.rearg=Ha,Un.reject=function(e,t){return(Ga(e)?Nt:gi)(e,La(co(t,3)))},Un.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=co(t,3);++i<o;){var a=e[i];t(a,i,e)&&(n.push(a),r.push(i))}return Yi(e,r),n},Un.rest=function(e,t){if("function"!=typeof e)throw new Ne(i);return Zi(e,t=t===n?t:ms(t))},Un.reverse=ta,Un.sampleSize=function(e,t,i){return t=(i?xo(e,t,i):t===n)?1:ms(t),(Ga(e)?$n:$i)(e,t)},Un.set=function(e,t,n){return null==e?e:er(e,t,n)},Un.setWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:er(e,t,i,r)},Un.shuffle=function(e){return(Ga(e)?ei:ir)(e)},Un.slice=function(e,t,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&xo(e,t,i)?(t=0,i=r):(t=null==t?0:ms(t),i=i===n?r:ms(i)),rr(e,t,i)):[]},Un.sortBy=_a,Un.sortedUniq=function(e){return e&&e.length?lr(e):[]},Un.sortedUniqBy=function(e,t){return e&&e.length?lr(e,co(t,2)):[]},Un.split=function(e,t,i){return i&&"number"!=typeof i&&xo(e,t,i)&&(t=i=n),(i=i===n?f:i>>>0)?(e=bs(e))&&("string"==typeof t||null!=t&&!as(t))&&!(t=ur(t))&&an(e)?wr(hn(e),0,i):e.split(t,i):[]},Un.spread=function(e,t){if("function"!=typeof e)throw new Ne(i);return t=null==t?0:bn(ms(t),0),Zi((function(n){var i=n[t],r=wr(n,0,t);return i&&Rt(r,i),kt(e,this,r)}))},Un.tail=function(e){var t=null==e?0:e.length;return t?rr(e,1,t):[]},Un.take=function(e,t,i){return e&&e.length?rr(e,0,(t=i||t===n?1:ms(t))<0?0:t):[]},Un.takeRight=function(e,t,i){var r=null==e?0:e.length;return r?rr(e,(t=r-(t=i||t===n?1:ms(t)))<0?0:t,r):[]},Un.takeRightWhile=function(e,t){return e&&e.length?fr(e,co(t,3),!1,!0):[]},Un.takeWhile=function(e,t){return e&&e.length?fr(e,co(t,3)):[]},Un.tap=function(e,t){return t(e),e},Un.throttle=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new Ne(i);return ts(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Aa(e,t,{leading:r,maxWait:t,trailing:o})},Un.thru=fa,Un.toArray=hs,Un.toPairs=zs,Un.toPairsIn=Hs,Un.toPath=function(e){return Ga(e)?Dt(e,Fo):cs(e)?[e]:Nr(Oo(bs(e)))},Un.toPlainObject=ys,Un.transform=function(e,t,n){var i=Ga(e),r=i||Xa(e)||us(e);if(t=co(t,4),null==n){var o=e&&e.constructor;n=r?i?new o:[]:ts(e)&&Ja(o)?Wn(Ke(e)):{}}return(r?Tt:xi)(e,(function(e,i,r){return t(n,e,i,r)})),n},Un.unary=function(e){return Ia(e,1)},Un.union=na,Un.unionBy=ia,Un.unionWith=ra,Un.uniq=function(e){return e&&e.length?dr(e):[]},Un.uniqBy=function(e,t){return e&&e.length?dr(e,co(t,2)):[]},Un.uniqWith=function(e,t){return t="function"==typeof t?t:n,e&&e.length?dr(e,n,t):[]},Un.unset=function(e,t){return null==e||pr(e,t)},Un.unzip=oa,Un.unzipWith=aa,Un.update=function(e,t,n){return null==e?e:hr(e,t,br(n))},Un.updateWith=function(e,t,i,r){return r="function"==typeof r?r:n,null==e?e:hr(e,t,br(i),r)},Un.values=Us,Un.valuesIn=function(e){return null==e?[]:Jt(e,Ds(e))},Un.without=sa,Un.words=Js,Un.wrap=function(e,t){return Fa(br(t),e)},Un.xor=la,Un.xorBy=ca,Un.xorWith=ua,Un.zip=da,Un.zipObject=function(e,t){return gr(e||[],t||[],ni)},Un.zipObjectDeep=function(e,t){return gr(e||[],t||[],er)},Un.zipWith=pa,Un.entries=zs,Un.entriesIn=Hs,Un.extend=xs,Un.extendWith=ws,ll(Un,Un),Un.add=yl,Un.attempt=$s,Un.camelCase=Ws,Un.capitalize=Vs,Un.ceil=bl,Un.clamp=function(e,t,i){return i===n&&(i=t,t=n),i!==n&&(i=(i=gs(i))==i?i:0),t!==n&&(t=(t=gs(t))==t?t:0),li(gs(e),t,i)},Un.clone=function(e){return ci(e,4)},Un.cloneDeep=function(e){return ci(e,5)},Un.cloneDeepWith=function(e,t){return ci(e,5,t="function"==typeof t?t:n)},Un.cloneWith=function(e,t){return ci(e,4,t="function"==typeof t?t:n)},Un.conformsTo=function(e,t){return null==t||ui(e,t,As(t))},Un.deburr=js,Un.defaultTo=function(e,t){return null==e||e!=e?t:e},Un.divide=El,Un.endsWith=function(e,t,i){e=bs(e),t=ur(t);var r=e.length,o=i=i===n?r:li(ms(i),0,r);return(i-=t.length)>=0&&e.slice(i,o)==t},Un.eq=Ua,Un.escape=function(e){return(e=bs(e))&&X.test(e)?e.replace(K,rn):e},Un.escapeRegExp=function(e){return(e=bs(e))&&ie.test(e)?e.replace(ne,"\\$&"):e},Un.every=function(e,t,i){var r=Ga(e)?Pt:mi;return i&&xo(e,t,i)&&(t=n),r(e,co(t,3))},Un.find=ga,Un.findIndex=jo,Un.findKey=function(e,t){return zt(e,co(t,3),xi)},Un.findLast=ya,Un.findLastIndex=Go,Un.findLastKey=function(e,t){return zt(e,co(t,3),wi)},Un.floor=xl,Un.forEach=ba,Un.forEachRight=Ea,Un.forIn=function(e,t){return null==e?e:bi(e,co(t,3),Ds)},Un.forInRight=function(e,t){return null==e?e:Ei(e,co(t,3),Ds)},Un.forOwn=function(e,t){return e&&xi(e,co(t,3))},Un.forOwnRight=function(e,t){return e&&wi(e,co(t,3))},Un.get=Ts,Un.gt=Wa,Un.gte=Va,Un.has=function(e,t){return null!=e&&go(e,t,Ii)},Un.hasIn=Is,Un.head=Ko,Un.identity=rl,Un.includes=function(e,t,n,i){e=Ka(e)?e:Us(e),n=n&&!i?ms(n):0;var r=e.length;return n<0&&(n=bn(r+n,0)),ls(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&Ut(e,t,n)>-1},Un.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:ms(n);return r<0&&(r=bn(i+r,0)),Ut(e,t,r)},Un.inRange=function(e,t,i){return t=fs(t),i===n?(i=t,t=0):i=fs(i),function(e,t,n){return e>=En(t,n)&&e<bn(t,n)}(e=gs(e),t,i)},Un.invoke=Ms,Un.isArguments=ja,Un.isArray=Ga,Un.isArrayBuffer=qa,Un.isArrayLike=Ka,Un.isArrayLikeObject=Ya,Un.isBoolean=function(e){return!0===e||!1===e||ns(e)&&_i(e)==y},Un.isBuffer=Xa,Un.isDate=Qa,Un.isElement=function(e){return ns(e)&&1===e.nodeType&&!os(e)},Un.isEmpty=function(e){if(null==e)return!0;if(Ka(e)&&(Ga(e)||"string"==typeof e||"function"==typeof e.splice||Xa(e)||us(e)||ja(e)))return!e.length;var t=vo(e);if(t==C||t==I)return!e.size;if(ko(e))return!Oi(e).length;for(var n in e)if(Le.call(e,n))return!1;return!0},Un.isEqual=function(e,t){return Di(e,t)},Un.isEqualWith=function(e,t,i){var r=(i="function"==typeof i?i:n)?i(e,t):n;return r===n?Di(e,t,n,i):!!r},Un.isError=Za,Un.isFinite=function(e){return"number"==typeof e&&qt(e)},Un.isFunction=Ja,Un.isInteger=$a,Un.isLength=es,Un.isMap=is,Un.isMatch=function(e,t){return e===t||Ri(e,t,po(t))},Un.isMatchWith=function(e,t,i){return i="function"==typeof i?i:n,Ri(e,t,po(t),i)},Un.isNaN=function(e){return rs(e)&&e!=+e},Un.isNative=function(e){if(So(e))throw new Se("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Bi(e)},Un.isNil=function(e){return null==e},Un.isNull=function(e){return null===e},Un.isNumber=rs,Un.isObject=ts,Un.isObjectLike=ns,Un.isPlainObject=os,Un.isRegExp=as,Un.isSafeInteger=function(e){return $a(e)&&e>=-9007199254740991&&e<=p},Un.isSet=ss,Un.isString=ls,Un.isSymbol=cs,Un.isTypedArray=us,Un.isUndefined=function(e){return e===n},Un.isWeakMap=function(e){return ns(e)&&vo(e)==M},Un.isWeakSet=function(e){return ns(e)&&"[object WeakSet]"==_i(e)},Un.join=function(e,t){return null==e?"":gn.call(e,t)},Un.kebabCase=Gs,Un.last=Zo,Un.lastIndexOf=function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=r;return i!==n&&(o=(o=ms(i))<0?bn(r+o,0):En(o,r-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,o):Ht(e,Vt,o,!0)},Un.lowerCase=qs,Un.lowerFirst=Ks,Un.lt=ds,Un.lte=ps,Un.max=function(e){return e&&e.length?vi(e,rl,Ti):n},Un.maxBy=function(e,t){return e&&e.length?vi(e,co(t,2),Ti):n},Un.mean=function(e){return jt(e,rl)},Un.meanBy=function(e,t){return jt(e,co(t,2))},Un.min=function(e){return e&&e.length?vi(e,rl,zi):n},Un.minBy=function(e,t){return e&&e.length?vi(e,co(t,2),zi):n},Un.stubArray=vl,Un.stubFalse=gl,Un.stubObject=function(){return{}},Un.stubString=function(){return""},Un.stubTrue=function(){return!0},Un.multiply=Cl,Un.nth=function(e,t){return e&&e.length?ji(e,ms(t)):n},Un.noConflict=function(){return ht._===this&&(ht._=Ue),this},Un.noop=cl,Un.now=Ta,Un.pad=function(e,t,n){e=bs(e);var i=(t=ms(t))?pn(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Gr(gt(r),n)+e+Gr(mt(r),n)},Un.padEnd=function(e,t,n){e=bs(e);var i=(t=ms(t))?pn(e):0;return t&&i<t?e+Gr(t-i,n):e},Un.padStart=function(e,t,n){e=bs(e);var i=(t=ms(t))?pn(e):0;return t&&i<t?Gr(t-i,n)+e:e},Un.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(bs(e).replace(re,""),t||0)},Un.random=function(e,t,i){if(i&&"boolean"!=typeof i&&xo(e,t,i)&&(t=i=n),i===n&&("boolean"==typeof t?(i=t,t=n):"boolean"==typeof e&&(i=e,e=n)),e===n&&t===n?(e=0,t=1):(e=fs(e),t===n?(t=e,e=0):t=fs(t)),e>t){var r=e;e=t,t=r}if(i||e%1||t%1){var o=Cn();return En(e+o*(t-e+ct("1e-"+((o+"").length-1))),t)}return Xi(e,t)},Un.reduce=function(e,t,n){var i=Ga(e)?Bt:Kt,r=arguments.length<3;return i(e,co(t,4),n,r,hi)},Un.reduceRight=function(e,t,n){var i=Ga(e)?Lt:Kt,r=arguments.length<3;return i(e,co(t,4),n,r,fi)},Un.repeat=function(e,t,i){return t=(i?xo(e,t,i):t===n)?1:ms(t),Qi(bs(e),t)},Un.replace=function(){var e=arguments,t=bs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Un.result=function(e,t,i){var r=-1,o=(t=Er(t,e)).length;for(o||(o=1,e=n);++r<o;){var a=null==e?n:e[Fo(t[r])];a===n&&(r=o,a=i),e=Ja(a)?a.call(e):a}return e},Un.round=Sl,Un.runInContext=e,Un.sample=function(e){return(Ga(e)?Jn:Ji)(e)},Un.size=function(e){if(null==e)return 0;if(Ka(e))return ls(e)?pn(e):e.length;var t=vo(e);return t==C||t==I?e.size:Oi(e).length},Un.snakeCase=Ys,Un.some=function(e,t,i){var r=Ga(e)?Ot:or;return i&&xo(e,t,i)&&(t=n),r(e,co(t,3))},Un.sortedIndex=function(e,t){return ar(e,t)},Un.sortedIndexBy=function(e,t,n){return sr(e,t,co(n,2))},Un.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=ar(e,t);if(i<n&&Ua(e[i],t))return i}return-1},Un.sortedLastIndex=function(e,t){return ar(e,t,!0)},Un.sortedLastIndexBy=function(e,t,n){return sr(e,t,co(n,2),!0)},Un.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=ar(e,t,!0)-1;if(Ua(e[n],t))return n}return-1},Un.startCase=Xs,Un.startsWith=function(e,t,n){return e=bs(e),n=null==n?0:li(ms(n),0,e.length),t=ur(t),e.slice(n,n+t.length)==t},Un.subtract=kl,Un.sum=function(e){return e&&e.length?Yt(e,rl):0},Un.sumBy=function(e,t){return e&&e.length?Yt(e,co(t,2)):0},Un.template=function(e,t,i){var r=Un.templateSettings;i&&xo(e,t,i)&&(t=n),e=bs(e),t=ws({},t,r,$r);var o,a,s=ws({},t.imports,r.imports,$r),l=As(s),c=Jt(s,l),u=0,d=t.interpolate||Ee,p="__p += '",h=Ie((t.escape||Ee).source+"|"+d.source+"|"+(d===J?pe:Ee).source+"|"+(t.evaluate||Ee).source+"|$","g"),f="//# sourceURL="+(Le.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ot+"]")+"\n";e.replace(h,(function(t,n,i,r,s,l){return i||(i=r),p+=e.slice(u,l).replace(xe,on),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),i&&(p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),p+="';\n";var m=Le.call(t,"variable")&&t.variable;if(m){if(ue.test(m))throw new Se("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(a?p.replace(V,""):p).replace(j,"$1").replace(G,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=$s((function(){return ke(l,f+"return "+p).apply(n,c)}));if(v.source=p,Za(v))throw v;return v},Un.times=function(e,t){if((e=ms(e))<1||e>p)return[];var n=f,i=En(e,f);t=co(t),e-=f;for(var r=Xt(i,t);++n<e;)t(n);return r},Un.toFinite=fs,Un.toInteger=ms,Un.toLength=vs,Un.toLower=function(e){return bs(e).toLowerCase()},Un.toNumber=gs,Un.toSafeInteger=function(e){return e?li(ms(e),-9007199254740991,p):0===e?e:0},Un.toString=bs,Un.toUpper=function(e){return bs(e).toUpperCase()},Un.trim=function(e,t,i){if((e=bs(e))&&(i||t===n))return Qt(e);if(!e||!(t=ur(t)))return e;var r=hn(e),o=hn(t);return wr(r,en(r,o),tn(r,o)+1).join("")},Un.trimEnd=function(e,t,i){if((e=bs(e))&&(i||t===n))return e.slice(0,fn(e)+1);if(!e||!(t=ur(t)))return e;var r=hn(e);return wr(r,0,tn(r,hn(t))+1).join("")},Un.trimStart=function(e,t,i){if((e=bs(e))&&(i||t===n))return e.replace(re,"");if(!e||!(t=ur(t)))return e;var r=hn(e);return wr(r,en(r,hn(t))).join("")},Un.truncate=function(e,t){var i=30,r="...";if(ts(t)){var o="separator"in t?t.separator:o;i="length"in t?ms(t.length):i,r="omission"in t?ur(t.omission):r}var a=(e=bs(e)).length;if(an(e)){var s=hn(e);a=s.length}if(i>=a)return e;var l=i-pn(r);if(l<1)return r;var c=s?wr(s,0,l).join(""):e.slice(0,l);if(o===n)return c+r;if(s&&(l+=c.length-l),as(o)){if(e.slice(l).search(o)){var u,d=c;for(o.global||(o=Ie(o.source,bs(he.exec(o))+"g")),o.lastIndex=0;u=o.exec(d);)var p=u.index;c=c.slice(0,p===n?l:p)}}else if(e.indexOf(ur(o),l)!=l){var h=c.lastIndexOf(o);h>-1&&(c=c.slice(0,h))}return c+r},Un.unescape=function(e){return(e=bs(e))&&Y.test(e)?e.replace(q,mn):e},Un.uniqueId=function(e){var t=++Oe;return bs(e)+t},Un.upperCase=Qs,Un.upperFirst=Zs,Un.each=ba,Un.eachRight=Ea,Un.first=Ko,ll(Un,(wl={},xi(Un,(function(e,t){Le.call(Un.prototype,t)||(wl[t]=e)})),wl),{chain:!1}),Un.VERSION="4.17.21",Tt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Un[e].placeholder=Un})),Tt(["drop","take"],(function(e,t){Gn.prototype[e]=function(i){i=i===n?1:bn(ms(i),0);var r=this.__filtered__&&!t?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=En(i,r.__takeCount__):r.__views__.push({size:En(i,f),type:e+(r.__dir__<0?"Right":"")}),r},Gn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Tt(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;Gn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:co(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}})),Tt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Gn.prototype[e]=function(){return this[n](1).value()[0]}})),Tt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Gn.prototype[e]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(rl)},Gn.prototype.find=function(e){return this.filter(e).head()},Gn.prototype.findLast=function(e){return this.reverse().find(e)},Gn.prototype.invokeMap=Zi((function(e,t){return"function"==typeof e?new Gn(this):this.map((function(n){return Mi(n,e,t)}))})),Gn.prototype.reject=function(e){return this.filter(La(co(e)))},Gn.prototype.slice=function(e,t){e=ms(e);var i=this;return i.__filtered__&&(e>0||t<0)?new Gn(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==n&&(i=(t=ms(t))<0?i.dropRight(-t):i.take(t-e)),i)},Gn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gn.prototype.toArray=function(){return this.take(f)},xi(Gn.prototype,(function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Un[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(Un.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof Gn,c=s[0],u=l||Ga(t),d=function(e){var t=o.apply(Un,Rt([e],s));return r&&p?t[0]:t};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var p=this.__chain__,h=!!this.__actions__.length,f=a&&!p,m=l&&!h;if(!a&&u){t=m?t:new Gn(this);var v=e.apply(t,s);return v.__actions__.push({func:fa,args:[d],thisArg:n}),new jn(v,p)}return f&&m?e.apply(this,s):(v=this.thru(d),f?r?v.value()[0]:v.value():v)})})),Tt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Me[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);Un.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Ga(r)?r:[],e)}return this[n]((function(n){return t.apply(Ga(n)?n:[],e)}))}})),xi(Gn.prototype,(function(e,t){var n=Un[t];if(n){var i=n.name+"";Le.call(An,i)||(An[i]=[]),An[i].push({name:t,func:n})}})),An[Ur(n,2).name]=[{name:"wrapper",func:n}],Gn.prototype.clone=function(){var e=new Gn(this.__wrapped__);return e.__actions__=Nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Nr(this.__views__),e},Gn.prototype.reverse=function(){if(this.__filtered__){var e=new Gn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Gn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ga(e),i=t<0,r=n?e.length:0,o=function(e,t,n){var i=-1,r=n.length;for(;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=En(t,e+a);break;case"takeRight":e=bn(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,c=i?s:a-1,u=this.__iteratees__,d=u.length,p=0,h=En(l,this.__takeCount__);if(!n||!i&&r==l&&h==l)return mr(e,this.__actions__);var f=[];e:for(;l--&&p<h;){for(var m=-1,v=e[c+=t];++m<d;){var g=u[m],y=g.iteratee,b=g.type,E=y(v);if(2==b)v=E;else if(!E){if(1==b)continue e;break e}}f[p++]=v}return f},Un.prototype.at=ma,Un.prototype.chain=function(){return ha(this)},Un.prototype.commit=function(){return new jn(this.value(),this.__chain__)},Un.prototype.next=function(){this.__values__===n&&(this.__values__=hs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?n:this.__values__[this.__index__++]}},Un.prototype.plant=function(e){for(var t,i=this;i instanceof Vn;){var r=Ho(i);r.__index__=0,r.__values__=n,t?o.__wrapped__=r:t=r;var o=r;i=i.__wrapped__}return o.__wrapped__=e,t},Un.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Gn){var t=e;return this.__actions__.length&&(t=new Gn(this)),(t=t.reverse()).__actions__.push({func:fa,args:[ta],thisArg:n}),new jn(t,this.__chain__)}return this.thru(ta)},Un.prototype.toJSON=Un.prototype.valueOf=Un.prototype.value=function(){return mr(this.__wrapped__,this.__actions__)},Un.prototype.first=Un.prototype.head,et&&(Un.prototype[et]=function(){return this}),Un}();mt?((mt.exports=vn)._=vn,ft._=vn):ht._=vn}).call(a3)}(w3,w3.exports);var C3,S3=s3(w3.exports),k3=function(){function e(e){var t,n;this.websdkIns=e,this.userPreference={},this.userLevel=["gridType","palette","toolBar","toolBox"],this.boardLevel=["view"],this.userPreference.gridType=null!==(n=null===(t=e.configs.defaultBehaviors)||void 0===t?void 0:t.defaultGrid)&&void 0!==n?n:exports.GridType.LINE}return e.prototype.initUserPreferences=function(e){return c(this,void 0,void 0,(function(){var t,n;return u(this,(function(i){switch(i.label){case 0:if(this.preferenceConfigs=e,!this.preferenceConfigs)return[3,6];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,b3({url:"/board/getUserBoardConfig"}).result];case 2:return(t=i.sent()).code||(this.userPreference=t.obj),[4,b3({url:"/board/getBoardConfig"}).result];case 3:return n=i.sent(),t.code||(this.userPreference=a(a({},this.userPreference),n.obj)),this.setUserPreferences(this.userPreference),[3,5];case 4:return i.sent(),console.error("Error to get userPreference"),[3,5];case 5:return[3,7];case 6:this.syncData({},{},!0,!1),i.label=7;case 7:return[2]}}))}))},e.prototype.setUserPreferences=function(e,t){return void 0===t&&(t=!0),c(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=a(a({},this.userPreference),e),this.syncData(this.userPreference,n),this.userPreference=n,t&&this.websdkIns.update(),[2]}))}))},e.prototype.isEqualPreference=function(e,t,n){return n.every((function(n){return S3.isEqual(e[n],t[n])}))},e.prototype.syncData=function(e,t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!0),c(this,void 0,void 0,(function(){var r,o;return u(this,(function(a){switch(a.label){case 0:return this.preferenceConfigs||n?(t=t||this.userPreference,e=e||this.userPreference,i&&(r=this.websdkIns.getCurrentViewData())&&(o={x:r.left,y:r.top,height:r.bottom-r.top,width:r.right-r.left},t.view=o),!this.isEqualPreference(e,t,this.userLevel)||n?[4,(s=S3.pick(t,this.userLevel),b3.fetch({url:"/board/setUserBoardConfig",params:{setting:s},keepalive:!0}).result)]:[3,2]):[2];case 1:a.sent(),a.label=2;case 2:return!this.isEqualPreference(e,t,this.boardLevel)||n?[4,x3(S3.pick(t,this.boardLevel))]:[3,4];case 3:a.sent(),a.label=4;case 4:return[2]}var s}))}))},e}();!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.NOT_CONNECTED=2]="NOT_CONNECTED"}(C3||(C3={}));var _3=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={hasError:!1},e}return o(n,t),n.prototype.componentDidCatch=function(){this.setState({hasError:!0}),this.props.evtBus.publish("internal_error",void 0)},n.prototype.render=function(){return this.state.hasError?e.createElement("div",null," WebSDK 内部发送错误，请尝试刷新浏览器再使用，如果仍出现问题，请联系我们 "):this.props.children},n}(e.Component),T3={}.hasOwnProperty;function I3(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0;i<e.length;i++){var r=e[i];if(r){var o=typeof r;if("string"===o||"number"===o)n.push(r);else if(Array.isArray(r)){if(r.length){var a=I3.apply(void 0,r);a&&n.push(a)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){n.push(r.toString());continue}for(var s in r)T3.call(r,s)&&r[s]&&n.push(s)}}}return n.join(" ")}var P3="infi-websdk-svg-container",N3=function(){function e(){}return e.load=function(e){this.add(e)},e.add=function(e,t){var n=this.createSymbolMap(e);t||(t=document.getElementById(P3))||(t=this._createSvgContainer());for(var i="",r=0,o=Object.keys(n);r<o.length;r++){var a=o[r],s=t.querySelector("#".concat(a));s&&t.removeChild(s),i+=n[a]}t.innerHTML+=i},e.replace=function(e,t){for(var n=this.createSymbolMap(e),i=0,r=t?[t]:this._findBodySvgContainer();i<r.length;i++){for(var o=r[i],a="",s=0,l=Object.keys(n);s<l.length;s++){var c=l[s],u=o.querySelector("#".concat(c));u&&(o.removeChild(u),a+=n[c])}o.innerHTML+=a}},e.createSymbolMap=function(e){if(t=e,"[object Object]"!==Object.prototype.toString.call(t))return{};for(var t,n={},i=0,r=Object.keys(e);i<r.length;i++){var o=r[i];n[o]=this.createSgvSymbol(o,e[o])}return n},e.createSgvSymbol=function(e,t){if(t=t.trim(),this._isSymbol(t)){return t.replace(/(id=['"])([^'"]+)(['"])/,"$1".concat(e,"$3"))}return"<symbol id='".concat(e,'\' viewBox="0 0 24 24" fill="currentColor">').concat(t,"</symbol>")},e._createSvgContainer=function(e){var t=this._createDomByHtmlString("<svg id='".concat(P3,"'>").concat(e||"","</svg>"));t.setAttribute("aria-hidden","true");t.setAttribute("style","position: absolute; width: 0; height: 0; overflow: hidden;");var n=document.body.firstChild;return n?document.body.insertBefore(t,n):document.body.appendChild(t),t},e._createDomByHtmlString=function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild},e._findBodySvgContainer=function(){return Array.from(document.body.children).filter((function(e){return"svg"===e.tagName.toLowerCase()&&e.firstElementChild&&"symbol"===e.firstElementChild.tagName.toLowerCase()}))},e._isSymbol=function(e){return e.startsWith("<symbol")},e}();var M3,A3=e.createContext({}),D3="default-",R3=((M3={})["".concat(D3,"setting")]='<g fill-rule="evenodd" fill="none"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" fill="currentColor" d="M4 4h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2Zm0 7h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2Zm0 7h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2Z"/></g>',M3["".concat(D3,"no-background")]='<g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" d="M20.868 7.374A9.957 9.957 0 0 1 22 12c0 5.523-4.477 10-10 10a9.957 9.957 0 0 1-4.626-1.132l1.502-1.5c.96.407 2.016.632 3.124.632a8 8 0 0 0 7.367-11.124l1.501-1.502Zm-1.09-3.152a1 1 0 0 1 0 1.414L5.636 19.778a1 1 0 1 1-1.414-1.414L18.364 4.222a1 1 0 0 1 1.414 0ZM12 2a9.96 9.96 0 0 1 4.626 1.132l-1.502 1.5A8 8 0 0 0 4.633 15.124l-1.501 1.503A9.957 9.957 0 0 1 2 12C2 6.477 6.477 2 12 2Z" fill="currentColor" fill-rule="nonzero"/></g>',M3["".concat(D3,"dot-matrix-background")]='<g fill-rule="evenodd" fill="none"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" fill="currentColor" d="M4 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm8-16a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm8-16a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/></g>',M3["".concat(D3,"checked")]='<g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" d="M19.062 5.9a1 1 0 1 1 1.533 1.284l-9.481 11.163a1 1 0 0 1-1.39.14l-5.872-4.924A1 1 0 1 1 5.101 12l5.106 4.313 8.855-10.414Z" fill="currentColor" fill-rule="nonzero"/></g>',M3["".concat(D3,"grid")]='<g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" d="M18 2a1 1 0 0 1 .993.883L19 3v2h2a1 1 0 0 1 .993.883L22 6a1 1 0 0 1-1 1h-2v4h2a1 1 0 0 1 .993.883L22 12a1 1 0 0 1-1 1h-2v4h2a1 1 0 0 1 .993.883L22 18a1 1 0 0 1-1 1h-2v2a1 1 0 0 1-1.993.117L17 21v-2h-4v2a1 1 0 0 1-1.993.117L11 21v-2H7v2a1 1 0 0 1-.883.993L6 22a1 1 0 0 1-.993-.883L5 21v-2H3l-.117-.007A1 1 0 0 1 3 17h2v-4H3l-.117-.007A1 1 0 0 1 3 11h2V7H3l-.117-.007A1 1 0 0 1 3 5h2V3l.007-.117a1 1 0 0 1 1.986 0L7 3v2h4V3l.007-.117a1 1 0 0 1 1.986 0L13 3v2h4V3l.007-.117A1 1 0 0 1 18 2Zm-1 11h-4v4h4v-4Zm-6 0H7v4h4v-4Zm6-6h-4v4h4V7Zm-6 0H7v4h4V7Z" fill="currentColor"/></g>',M3["".concat(D3,"right-arrow")]='<g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" d="m10.643 7.377 4.596 3.857.02.016.044.043-.064-.059a.957.957 0 0 1 .107.104l.016.02.02.024a.993.993 0 0 1 .048.066l-.068-.09a1.008 1.008 0 0 1 .233.694.97.97 0 0 1-.113.412.957.957 0 0 1-.105.161l-.015.018-.01.012-.055.059.065-.071a1.008 1.008 0 0 1-.123.123l-4.596 3.857a1 1 0 0 1-1.286-1.532l3.683-3.092-3.683-3.09a1 1 0 0 1 1.286-1.532Z" fill="currentColor"/></g>',M3["".concat(D3,"history")]='<g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" d="M13.41 2.5a9.5 9.5 0 0 1 0 19 1 1 0 1 1-.002-2 7.5 7.5 0 1 0-7.477-6.938l1.099-1.098a1 1 0 1 1 1.414 1.415l-2.828 2.828a.995.995 0 0 1-.531.277l-.118.014H4.85a.996.996 0 0 1-.648-.29l-2.828-2.83a1 1 0 0 1 1.414-1.414L3.93 12.61A9.5 9.5 0 0 1 13.41 2.5Zm3.534 5.964a1 1 0 0 1 0 1.415l-1.603 1.604A2.003 2.003 0 0 1 13.408 14a2 2 0 1 1 .517-3.933l1.605-1.603a1 1 0 0 1 1.414 0Z" fill="currentColor" fill-rule="nonzero"/></g>',M3["".concat(D3,"icon-refresh")]='<symbol id="icon-iconshuaxin" viewBox="0 0 40 34"><g fill="none" fill-rule="evenodd"><path d="M-1-4h42v42H-1z"/><path data-follow-fill="#FFF" d="M22.468.375c9.18 0 16.625 7.443 16.625 16.625s-7.444 16.625-16.626 16.625a1.75 1.75 0 1 1-.002-3.5c7.251 0 13.128-5.876 13.128-13.125S29.716 3.875 22.467 3.875C15.22 3.875 9.344 9.751 9.344 17c0 .331.012.66.036.985l1.923-1.922a1.75 1.75 0 0 1 2.475 2.475l-4.95 4.95a1.742 1.742 0 0 1-1 .496l-.158.014h-.16a1.744 1.744 0 0 1-1.159-.51l-4.95-4.95a1.75 1.75 0 1 1 2.475-2.475l1.999 1.999A16.878 16.878 0 0 1 5.842 17C5.843 7.818 13.287.375 22.469.375Z" fill="#FFF" fill-rule="nonzero"/></g></symbol>',M3["".concat(D3,"close")]='<symbol id="icon-guanbi" viewBox="0 0 1024 1024"><path d="M240.512 180.181333l271.530667 271.488 271.530666-271.488a42.666667 42.666667 0 0 1 60.330667 60.330667l-271.530667 271.530667 271.530667 271.530666a42.666667 42.666667 0 0 1-60.330667 60.330667l-271.530666-271.530667-271.530667 271.530667a42.666667 42.666667 0 1 1-60.330667-60.330667l271.488-271.530666-271.488-271.530667a42.666667 42.666667 0 0 1 60.330667-60.330667z"  ></path></symbol>',M3["".concat(D3,"file-excel")]='<symbol viewBox="0 0 24 24" id="file-excel"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="M5 .5h10.34a3 3 0 0 1 2.018.78l3.66 3.327A3 3 0 0 1 22 6.827V20.5a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#25BF79"/><path d="M5 .5h10.2v4.3a2 2 0 0 0 2 2H22v13.7a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#53D39C"/><path d="M4.7 11.134v4.284h3.18v-.558H5.354v-1.362h2.28v-.558h-2.28v-1.248h2.424v-.558zm3.594 1.182 1.074 1.452-1.212 1.65h.75l.816-1.182.81 1.182h.744l-1.206-1.65 1.074-1.452H10.4l-.678.984-.684-.984zm4.752-.084c-.48 0-.852.162-1.122.486-.252.3-.378.684-.378 1.152 0 .48.126.864.384 1.164.264.312.63.468 1.104.468.396 0 .72-.102.96-.3.24-.204.402-.516.474-.93h-.63c-.06.468-.324.708-.798.708-.276 0-.48-.102-.618-.294-.15-.198-.222-.474-.222-.822s.072-.624.228-.816a.728.728 0 0 1 .618-.294c.216 0 .39.048.522.15.132.096.216.252.258.462h.63c-.06-.384-.216-.672-.456-.864-.24-.18-.558-.27-.954-.27Zm3.282 0c-.456 0-.822.156-1.086.474-.276.312-.408.696-.408 1.158 0 .51.144.912.432 1.212.264.282.63.426 1.086.426.414 0 .756-.12 1.026-.354a1.4 1.4 0 0 0 .426-.726h-.636c-.084.18-.174.318-.282.402a.887.887 0 0 1-.54.156c-.252 0-.45-.084-.594-.24-.144-.162-.222-.396-.246-.696h2.352c-.006-.552-.132-.984-.372-1.296-.264-.348-.654-.516-1.158-.516Zm.018.522c.504 0 .786.27.846.81h-1.674c.036-.264.126-.462.258-.6.144-.144.33-.21.57-.21Zm2.124-1.704v4.368h.636V11.05z" fill="#FFF" fill-rule="nonzero"/></g></symbol>',M3["".concat(D3,"file-jinggao")]='<symbol viewBox="0 0 24 24" fill="currentColor" id="file-jinggao"><g fill-rule="evenodd" fill="none"><path d="M0 0h24v24H0z"/><path data-follow-fill="currentColor" fill-rule="nonzero" fill="currentColor" d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1Z"/><path fill="#FFF" d="M12 6.25a1 1 0 0 1 1 1v6a1 1 0 0 1-2 0v-6l.007-.117A1 1 0 0 1 12 6.25Zm0 11.5a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z"/></g></symbol>',M3["".concat(D3,"file-pdf")]='<symbol viewBox="0 0 24 24" id="file-pdf"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="M5 .5h10.34a3 3 0 0 1 2.018.78l3.66 3.327A3 3 0 0 1 22 6.827V20.5a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#F25555"/><path d="M5 .5h10.2v4.3a2 2 0 0 0 2 2H22v13.7a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#FF7878"/><path d="M6.44 11.22v4.284h.654v-1.668h1.11c1.026 0 1.542-.438 1.542-1.314 0-.87-.51-1.302-1.53-1.302H6.44Zm.654.558h1.068c.318 0 .552.06.702.18.15.108.228.3.228.564 0 .264-.078.456-.222.576-.15.12-.384.18-.708.18H7.094v-1.5Zm3.258-.558v4.284H11.9c.69 0 1.212-.192 1.572-.576.342-.372.516-.894.516-1.566 0-.678-.168-1.2-.504-1.56-.36-.39-.882-.582-1.572-.582h-1.56Zm.654.558h.786c.54 0 .936.126 1.188.384.24.252.366.648.366 1.2 0 .54-.126.936-.372 1.194-.252.258-.654.39-1.194.39h-.774v-3.168Zm3.648-.558v4.284h.654v-1.92h2.13v-.558h-2.13v-1.248h2.256v-.558z" fill="#FFF" fill-rule="nonzero"/></g></symbol>',M3["".concat(D3,"file-ppt")]='<symbol viewBox="0 0 24 24" id="file-ppt"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="M5 .5h10.34a3 3 0 0 1 2.018.78l3.66 3.327A3 3 0 0 1 22 6.827V20.5a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#F26C38"/><path d="M5 .5h10.2v4.3a2 2 0 0 0 2 2H22v13.7a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#F98950"/><path d="M6.5 11.22v4.284h.654v-1.668h1.11c1.026 0 1.542-.438 1.542-1.314 0-.87-.51-1.302-1.53-1.302H6.5Zm.654.558h1.068c.318 0 .552.06.702.18.15.108.228.3.228.564 0 .264-.078.456-.222.576-.15.12-.384.18-.708.18H7.154v-1.5Zm3.258-.558v4.284h.654v-1.668h1.11c1.026 0 1.542-.438 1.542-1.314 0-.87-.51-1.302-1.53-1.302h-1.776Zm.654.558h1.068c.318 0 .552.06.702.18.15.108.228.3.228.564 0 .264-.078.456-.222.576-.15.12-.384.18-.708.18h-1.068v-1.5Zm2.928-.558v.558h1.434v3.726h.648v-3.726h1.428v-.558z" fill="#FFF" fill-rule="nonzero"/></g></symbol>',M3["".concat(D3,"file-shipin")]='<symbol viewBox="0 0 34 40" id="file-shipin"><g fill="none" fill-rule="evenodd"><path d="M-3 0h40v40H-3z"/><path d="M4.333.833h18.62a4 4 0 0 1 2.691 1.04l6.713 6.103a4 4 0 0 1 1.31 2.96v24.23a4 4 0 0 1-4 4H4.333a4 4 0 0 1-4-4V4.834a4 4 0 0 1 4-4Z" fill="#7860E0"/><path d="M4.333.833h18v7.834A2.667 2.667 0 0 0 25 11.333h8.667v23.834a4 4 0 0 1-4 4H4.333a4 4 0 0 1-4-4V4.833a4 4 0 0 1 4-4Z" fill="#8B72F7"/><path d="M5.333 10h23.333v23.333H5.333z"/><path d="m14.179 15.65 7.817 4.886a1.333 1.333 0 0 1 0 2.261l-7.817 4.886a1.333 1.333 0 0 1-2.04-1.13V16.78a1.333 1.333 0 0 1 2.04-1.131Z" fill="#FFF"/></g></symbol>',M3["".concat(D3,"file-tupian")]='<symbol viewBox="0 0 24 24" id="file-tupian"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="M5 .5h10.34a3 3 0 0 1 2.018.78l3.66 3.327A3 3 0 0 1 22 6.827V20.5a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#2BB594"/><path d="M5 .5h10.2v4.3a2 2 0 0 0 2 2H22v13.7a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#36D2AD"/><path d="m18.996 23.5-11.47-.003 7.944-8.257a1.6 1.6 0 0 1 2.3 0l4.226 4.367v.893a3 3 0 0 1-3 3Z" fill="#9CF8E2" fill-rule="nonzero"/><path d="M4.9 23.497c-1.083-.015-1.975-.664-2.428-1.38l4.288-4.432a1.6 1.6 0 0 1 2.3 0l5.624 5.812H4.9Z" fill="#70E3C7" fill-rule="nonzero"/><path d="M5.867 10.83c0 1.105.866 2 1.935 2 1.07 0 1.936-.895 1.936-2s-.867-2-1.936-2-1.935.895-1.935 2Z" fill="#E9FFF9" fill-rule="nonzero"/></g></symbol>',M3["".concat(D3,"file-word")]='<symbol viewBox="0 0 24 24" id="file-word"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"/><path d="M5 .5h10.34a3 3 0 0 1 2.018.78l3.66 3.327A3 3 0 0 1 22 6.827V20.5a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#469ED3"/><path d="M5 .5h10.2v4.3a2 2 0 0 0 2 2H22v13.7a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-17a3 3 0 0 1 3-3Z" fill="#53B7F4"/><path d="m4.65 11.134 1.23 4.284h.702l.87-3.306h.024l.87 3.306h.696l1.236-4.284H9.54l-.834 3.336h-.024l-.876-3.336h-.684l-.876 3.336h-.024l-.834-3.336zm7.446 1.098c-.468 0-.846.156-1.128.468-.282.306-.42.696-.42 1.17 0 .468.138.858.414 1.158.288.312.666.474 1.134.474.468 0 .846-.162 1.134-.474.276-.3.414-.69.414-1.158 0-.474-.144-.864-.42-1.17-.282-.312-.66-.468-1.128-.468Zm0 .522a.8.8 0 0 1 .69.348c.144.198.216.456.216.768 0 .306-.072.558-.216.762a.813.813 0 0 1-.69.348.795.795 0 0 1-.684-.348c-.144-.198-.21-.45-.21-.762s.066-.57.21-.768a.782.782 0 0 1 .684-.348Zm3.594-.522a.758.758 0 0 0-.504.174.925.925 0 0 0-.3.378v-.468h-.636v3.102h.636v-1.644c0-.27.078-.492.24-.66a.7.7 0 0 1 .516-.234c.144 0 .294.018.45.066v-.636a.907.907 0 0 0-.402-.078Zm3.024-1.182v1.728c-.252-.366-.57-.546-.948-.546-.444 0-.798.162-1.05.486-.24.3-.354.678-.354 1.134 0 .474.12.864.36 1.164.258.324.618.486 1.074.486.42 0 .744-.156.96-.456v.372h.594V11.05h-.636Zm-.804 1.698c.234 0 .426.09.582.282.156.204.24.474.24.81v.054c0 .312-.066.564-.198.762a.75.75 0 0 1-.642.33c-.312 0-.546-.114-.69-.336-.126-.192-.186-.456-.186-.798s.066-.606.198-.786c.15-.216.384-.318.696-.318Z" fill="#FFF" fill-rule="nonzero"/></g></symbol>',M3),B3="moveToElementId";function L3(t){var n=e.useState(void 0),i=n[0],r=n[1],o=e.useState(""),a=o[0],s=o[1],l=p3(a),c=t.routeConfig||{},u=c.historyType,d=c.boardCompositeKey,p=e.useMemo((function(){if(t.anchorElement){var e=t.anchorElement;return t.setAnchorElement(void 0),e}return i&&l?l+"?"+i:void 0}),[t.anchorElement,i,l]);var h=e.useCallback((function(e){if(t.configs.gotoLink){var n=t.configs.gotoLink(e);n&&t.setAnchorElement(n)}else{var i=d3(e,u).search,o=new URLSearchParams(i).get(B3),a=d3(location.href,u).search,l=new URLSearchParams(a).get(B3),c=o?u3(location.href,B3,o,u):location.href,p=function(e,t,n,i,r){void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r="browser");var o=d3(e,r),a=d3(t,r),s=o.origin===a.origin,l=o.pathName===a.pathName,c=new URLSearchParams(o.search),u=new URLSearchParams(a.search),d=!0;if(i.length)for(var p=0,h=i;p<h.length;p++){var f=h[p];if(!n.includes(f)){if(!c.get(f)||!u.get(f)){d=!1;break}if(c.get(f)!==u.get(f)){d=!1;break}}}else c.forEach((function(e){return function(){n.includes(e)||u.get(e)!==c.get(e)&&(d=!1)}}));return s&&l&&d}(e,location.href,[B3],null!=d?d:[],u);p&&o?(r(Date.now()),s(o),l!==o&&history.replaceState("","",c)):window.open(e)}}),[]);return{getElementLink:function(e){if(t.configs.getElementLink)return t.configs.getElementLink(h3(e),e);var n=h3(e);if(d){var i=d3(location.href,u),r=i.search,o=i.origin,a=i.pathName,s=new URLSearchParams(r),l=d.map((function(e){return"".concat(e,"=").concat(s.get(e)||"")}));return l.push("".concat(B3,"=").concat(n)),o+a+"?"+l.join("&")}return u3(location.href,B3,n,u)},anchorElement:p,gotoLink:h,initElementId:function(){if(!t.anchorElement){var e=d3(location.href,u),n=new URLSearchParams(e.search).get(B3);n&&(r(Date.now()),s(n))}}}}var O3,F3=function(t){var n,i,r,o,s,l,d,p,h=t.asyncW,f=t.websdkIns,m=e.useRef(null),v=e.useReducer((function(e){return e+1}),0)[1],g=f.configs,y=g.getUsersInfo,b=g.getShadowBoardQuery,E=g.userInfo,x=g.uiSlots,w=g.defaultBehaviors,C=g.initTemplate,k=g.customizeUploaders,_=g.toolbarWidgetsConfigs,T=g.plugins,I=g.downloadConfig,P=g.uploadConfig,N=g.editable,M=void 0===N||N,A=g.displayMode,D=g.meetingConfigs,R=f.userPreference,B=null!=x?x:{},L=B.titleSlot,O=B.topRightSlot,F=e.useState(function(e){var t,n,i,r;return a(a({},e),{meeting:(null==e?void 0:e.meeting)?{enabled:null==e?void 0:e.meeting}:void 0,sticker:(null===(t=null==e?void 0:e.toolbarConfig)||void 0===t?void 0:t.sticker)?{enabled:null===(n=null==e?void 0:e.toolbarConfig)||void 0===n?void 0:n.sticker}:void 0,template:(null===(i=null==e?void 0:e.toolbarConfig)||void 0===i?void 0:i.template)?{enabled:null===(r=null==e?void 0:e.toolbarConfig)||void 0===r?void 0:r.template}:void 0,boardMemberList:(null==e?void 0:e.boardMemberList)?{enabled:null==e?void 0:e.boardMemberList}:void 0,toolbarConfig:(null==e?void 0:e.toolbarConfig)?a(a({},e.toolbarConfig),{customized_sticker:e.toolbarConfig.sticker,sticker:e.toolbarConfig.stickyNote,connect_line:e.toolbarConfig.connectLine,mind_map:e.toolbarConfig.mindMap,pen:e.toolbarConfig.draw}):void 0})}(_||{})),z=F[0];F[1];var H=L3(f),U=H.initElementId,W=H.gotoLink,V=H.getElementLink,j=H.anchorElement;e.useEffect((function(){m.current?(U(),h.done(m.current),null==T||T.forEach((function(e){var t,n=e.pluginConstructor,i=e.beforeInit,r=e.config;null===(t=m.current)||void 0===t||t.loadSdkPlugin(n,i,r)}))):h.fail("sdk init Failed")}),[]),e.useEffect((function(){if(w&&m.current){var e=w.showFrameList,t=w.laserMode,n=w.presentationMode;m.current.subscribeSdkAction((function(i){var r,o,a;if("resourceReady"===i.type)e&&(null===(r=m.current)||void 0===r||r.toggleFramePanel()),n&&(null===(o=m.current)||void 0===o||o.enablePresentation()),t&&(null===(a=m.current)||void 0===a||a.enableLaser())}))}}),[]),e.useEffect((function(){return f.evtBus.subscribe("update_state",v)}),[]);var G=function(e,t){return void 0===t&&(t=!0),c(void 0,void 0,void 0,(function(){return u(this,(function(n){return f.setUserPreferences(e,t),[2,!0]}))}))};return e.useMemo((function(){N3.load(R3)}),[]),e.createElement(A3.Provider,{value:{websdkIns:f}},e.createElement(_3,{evtBus:f.evtBus},e.createElement(E1,{learningCenter:null,getElementLink:V,gotoLink:W,anchorElement:j,customizedUploader:k,loginName:E.loginName,userName:E.userName,avatarUrl:E.avatarUrl,userType:M?"editor":"visitor",viewRect:R.view,recordView:function(e){return G({view:e},!1)},role:1,autoResize:!0,getBoardQuery:f.getQueryString.bind(f),getShadowBoardQuery:b,getUserInfo:function(e){return c(void 0,void 0,void 0,(function(){var t,n,i,r,o,a,s;return u(this,(function(l){switch(l.label){case 0:return t=Array.isArray(e),[4,y(t?e:[e])];case 1:if(n=l.sent(),!t)return[3,6];i={},r=0,o=n,l.label=2;case 2:return r<o.length?[4,S({userId:(a=o[r]).loginName,text:a.userName,imgUrl:a.avatarUrl})]:[3,5];case 3:s=l.sent(),i[a.loginName]={userName:a.userName,avatarUrl:s},l.label=4;case 4:return r++,[3,2];case 5:return[2,i];case 6:return n.length?[4,S({userId:(a=n[0]).loginName,text:a.userName,imgUrl:a.avatarUrl})]:[3,8];case 7:return s=l.sent(),[2,{userName:a.userName,avatarUrl:s}];case 8:return[2,{userName:"未知用户",avatarUrl:""}]}}))}))},ref:m,title:L,customOptionBar:O,displayMode:A,userPreference:{enableTimer:null===(n=null==_?void 0:_.toolbarConfig)||void 0===n?void 0:n.timer,enableWebpage:null===(i=null==_?void 0:_.toolbarConfig)||void 0===i?void 0:i.webpage,enableKanban:null===(r=null==_?void 0:_.toolbarConfig)||void 0===r?void 0:r.kanban,gridType:R.gridType,palette:R.palette,onChangePalette:function(e){return G({palette:e})},dynamicPPT:null==P?void 0:P.enableDynamicPPT,defaultDrawStyles:null==w?void 0:w.defaultDrawStyles},tools:{toolBar:R.toolBar,toolBox:R.toolBox,saveCustomToolIndex:function(e){return G(e)}},extensionConfigs:z,beforeUpload:null===(o=f.beforeUpload)||void 0===o?void 0:o.bind(f),initTemplateId:C,chatgptConfig:{isShowRemainTip:!1,preCheckCredits:f.preCreditCheck},downloadConfig:{enable:null===(l=null!==(s=null==I?void 0:I.fileEnable)&&void 0!==s?s:null==I?void 0:I.enable)||void 0===l||l,imageEnable:null===(p=null!==(d=null==I?void 0:I.imageEnable)&&void 0!==d?d:null==I?void 0:I.enable)||void 0===p||p,preCheck:null==I?void 0:I.preCheck},meetingConfigs:D})))};!function(e){e[e.OK=0]="OK"}(O3||(O3={})),function(e){e[e.APP_DISABLED=30002]="APP_DISABLED"}(O3||(O3={}));function z3(e,t,n){var i=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;return n.sdkRef?i.apply(n,e):(n.status,C3.CONNECTED,void n.evtBus.publish("not_initialized",void 0))},n}var H3,U3=function(){function n(e){this.configs=e,this.status=C3.NOT_CONNECTED,this.sdkRef=null,this.unsub=[],this.routeConfig={historyType:"browser"},this.initUpimeSdkQuery=!1,this.userPreferenceManager=new k3(this),this._authPassed=!1,this.queryString="",this.evtBus=new b,v3(e.env),this.routeConfig=a({historyType:"browser"},e.routeConfig)}return Object.defineProperty(n.prototype,"userPreference",{get:function(){return this.userPreferenceManager.userPreference},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"authPassed",{get:function(){return this._authPassed},enumerable:!1,configurable:!0}),n.prototype.setAnchorElement=function(e){var t=e&&p3(e);t?(this.anchorElement=t+"?"+Date.now(),this.update()):this.anchorElement=void 0},n.prototype.getQueryString=function(e){return void 0===e&&(e=!1),c(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return e?(t=this,[4,this.configs.getQueryString()]):[3,2];case 1:return t.queryString=n.sent(),this.initUpimeSdkQuery=!0,[2,this.queryString];case 2:return this.initUpimeSdkQuery?(this.initUpimeSdkQuery=!1,[2,this.queryString]):[3,3];case 3:return[4,this.configs.getQueryString()];case 4:return[2,n.sent()]}}))}))},n.prototype.enablePresentation=function(e){var t;null===(t=this.sdkRef)||void 0===t||t.enablePresentation(e)},n.prototype.enableLaser=function(e){var t;null===(t=this.sdkRef)||void 0===t||t.enableLaser(e)},n.prototype.toggleFrameListPanel=function(){var e;null===(e=this.sdkRef)||void 0===e||e.toggleFramePanel()},n.prototype.toggleHistoryPanel=function(){var e;null===(e=this.sdkRef)||void 0===e||e.toggleHistoryPanel()},n.prototype.changeGridType=function(e){this.setUserPreferences({gridType:e})},n.prototype.getElementsMetaData=function(){var e;return null===(e=this.sdkRef)||void 0===e?void 0:e.getElementsMetaData()},n.prototype.getConnectId=function(){var e,t;return null!==(t=null===(e=this.sdkRef)||void 0===e?void 0:e.getConnectId())&&void 0!==t?t:""},n.prototype.init=function(){return c(this,void 0,void 0,(function(){var n,i,r,o,a,s,l=this;return u(this,(function(d){switch(d.label){case 0:return[4,this.authCheck()];case 1:return(n=d.sent()).code?[2,n]:(i=this.configs.userInfo,r=i.loginName,o=i.userName,a=i.avatarUrl,[4,this.userPreferenceManager.initUserPreferences(this.configs.preferenceConfigs)]);case 2:return d.sent(),a?[3,4]:(s=this.configs.userInfo,[4,S({userId:r,text:o})]);case 3:s.avatarUrl=d.sent(),d.label=4;case 4:return(p=this,c(void 0,void 0,void 0,(function(){var n;return u(this,(function(i){return n=new y,t.render(e.createElement(F3,{asyncW:n,websdkIns:p}),p.configs.containerDom),[2,n.result]}))}))).then((function(e){l.sdkRef=e,l._subscribeSdk()})),[2,{code:0}]}var p}))}))},n.prototype.update=function(){this.evtBus.publish("update_state",void 0)},n.prototype.setUserPreferences=function(e,t){return void 0===t&&(t=!0),c(this,void 0,void 0,(function(){return u(this,(function(n){return this.userPreferenceManager.setUserPreferences(e,t),[2]}))}))},n.prototype._subscribeSdk=function(){var e,t=this;this.sdkRef&&this.unsub.push(null===(e=this.sdkRef)||void 0===e?void 0:e.subscribeSdkAction((function(e){switch(e.type){case"resourceReady":t.evtBus.publish("resource_ready",void 0);break;case"presentationStateChange":t.evtBus.publish("presentation_change",e.payload.state);break;case"connectInfoUpdated":t.evtBus.publish("connectInfoUpdated",e.payload)}})))},Object.defineProperty(n.prototype,"preCreditCheck",{get:function(){return this.configs?this.handlePreCheckCredits.bind(this):function(){return c(this,void 0,void 0,(function(){return u(this,(function(e){return[2,Promise.resolve({inPackageRemain:0,outPackageRemain:0,extraInfo:{}})]}))}))}},enumerable:!1,configurable:!0}),n.prototype.handlePreCheckCredits=function(){return c(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.configs.getAiCheckInfo?[4,this.configs.getAiCheckInfo()]:[3,2];case 1:return[2,n.sent()];case 2:return[4,b3({url:"/board/getAiSign"}).result];case 3:if(0===(e=n.sent()).code)return[2,e.obj];n.label=4;case 4:return[3,6];case 5:return t=n.sent(),console.warn("websdk/instance","获取AI鉴权数据失败",t),[3,6];case 6:return[2,{inPackageRemain:0,outPackageRemain:0,extraInfo:{}}]}}))}))},n.prototype.authCheck=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,this.getQueryString(!0)];case 1:return t.sent()?[4,E3(this.queryString)]:[2,{code:1,message:"Invalid queryString"}];case 2:if((e=t.sent()).code===O3.OK)g3(e.obj.tokenInfo.accessToken);else if(e.code===O3.APP_DISABLED)return[2,{code:e.code,message:"应用 ".concat(e.errMsg," 被禁用")}];return[2,{code:e.code}]}}))}))},n.prototype.enableEdit=function(e){},n.prototype.slideToView=function(e,t){var n,i;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,null===(n=this.sdkRef)||void 0===n?void 0:n.setViewRect(e,t||{left:0,top:0,right:0,bottom:0,duration:0})];case 1:return[2,null!==(i=r.sent())&&void 0!==i&&i]}}))}))},n.prototype.getCurrentViewData=function(){var e;return null===(e=this.sdkRef)||void 0===e?void 0:e.getCurViewBox()},n.prototype.showToast=function(e,t){return c(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},n.prototype.insertImage=function(e,t){var n,i;return c(this,void 0,void 0,(function(){var r,o;return u(this,(function(l){switch(l.label){case 0:return"string"==typeof e&&t?(null===(n=this.sdkRef)||void 0===n||n.insertImage(e,t),[3,3]):[3,1];case 1:return"object"==typeof e&&e.file?(r=e.screenPosition,o=s(e,["screenPosition"]),[4,null===(i=this.sdkRef)||void 0===i?void 0:i.insertImageFile(a({position:r},o))]):[3,3];case 2:return[2,l.sent()];case 3:return[2]}}))}))},n.prototype.insertDocument=function(e,t,n){var i;return c(this,void 0,void 0,(function(){return u(this,(function(r){return null===(i=this.sdkRef)||void 0===i||i.insertDocument(e,t,k[n]),[2]}))}))},n.prototype.insertVideo=function(e,t){var n;return c(this,void 0,void 0,(function(){return u(this,(function(i){return null===(n=this.sdkRef)||void 0===n||n.insertVideo(e,t),[2]}))}))},n.prototype.insertAudio=function(e,t){var n;return c(this,void 0,void 0,(function(){return u(this,(function(i){return null===(n=this.sdkRef)||void 0===n||n.insertAudio(e,t),[2]}))}))},n.prototype.requestShadowUserViewData=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(t){return this.sdkRef?[2,this.sdkRef.requestShadowUserViewData(e)]:[2,null]}))}))},n.prototype.setViewClip=function(e){var t;null===(t=this.sdkRef)||void 0===t||t.setViewClip(e.x,e.y,e.width,e.height)},n.prototype.stopFocusBorderBox=function(){var e;null===(e=this.sdkRef)||void 0===e||e.stopFocusViewBox()},n.prototype.focusBorderBox=function(e){var t;null===(t=this.sdkRef)||void 0===t||t.focusBorderBox(e)},n.prototype.exportPdfFromDocElement=function(e,t){var n;return c(this,void 0,void 0,(function(){return u(this,(function(i){return[2,null===(n=this.sdkRef)||void 0===n?void 0:n.exportPdfFromDocumentElement(e,t)]}))}))},n.prototype.forceFollowUser=function(e){var t;null===(t=this.sdkRef)||void 0===t||t.forceFollowUser(e)},n.prototype.stopCurForceFollowing=function(){var e;null===(e=this.sdkRef)||void 0===e||e.stopCurForceFollowing()},n.prototype.requestElesDataByRecordId=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this.sdkRef?[4,this.sdkRef.requestElesDataByRecordId(e)]:[2,null];case 1:return[2,t.sent()]}}))}))},n.prototype.useRawElesData=function(e,t,n){var i;return!!(null===(i=this.sdkRef)||void 0===i?void 0:i.useRawElesData(e,t,n))},n.prototype.useElementsInfo=function(e,t){var n;return c(this,void 0,void 0,(function(){return u(this,(function(i){switch(i.label){case 0:return[4,null===(n=this.sdkRef)||void 0===n?void 0:n.useElementsInfo(e,t,{autoSelect:!0,scaleView:!0})];case 1:return i.sent(),[2]}}))}))},n.prototype.beforeUpload=function(){var e;return c(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,b3({url:"/board/preUpload"}).result];case 1:return 0===(t=n.sent()).code?[2,t.obj.canUpload]:((null===(e=this.configs)||void 0===e?void 0:e.onUploadFailed)&&this.configs.onUploadFailed({code:v.EXCEEDS_STORAGE_LIMIT,message:"exceeds storage limit"}),[2,!1]);case 2:throw n.sent();case 3:return[2]}}))}))},n.prototype.enableShortCut=function(){var e;null===(e=this.sdkRef)||void 0===e||e.updateUseKeyboard(!0)},n.prototype.disableShortCut=function(){var e;null===(e=this.sdkRef)||void 0===e||e.updateUseKeyboard(!1)},n.prototype.on=function(e,t){var n=this;return this.evtBus.subscribe(e,t),function(){return n.off(e,t)}},n.prototype.off=function(e,t){this.evtBus.unsubscribe(e,t)},n.prototype.destroy=function(){return c(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this.unsub.forEach((function(e){return e()})),[4,this.userPreferenceManager.syncData({},void 0)];case 1:return e.sent(),g3(""),v3("prod"),[2]}}))}))},l([z3],n.prototype,"enablePresentation",null),l([z3],n.prototype,"enableLaser",null),l([z3],n.prototype,"toggleFrameListPanel",null),l([z3],n.prototype,"toggleHistoryPanel",null),l([z3],n.prototype,"changeGridType",null),l([z3],n.prototype,"getElementsMetaData",null),l([z3],n.prototype,"getConnectId",null),l([z3],n.prototype,"_subscribeSdk",null),l([z3],n.prototype,"slideToView",null),l([z3],n.prototype,"getCurrentViewData",null),l([z3],n.prototype,"showToast",null),l([z3],n.prototype,"insertImage",null),l([z3],n.prototype,"insertDocument",null),l([z3],n.prototype,"insertVideo",null),l([z3],n.prototype,"insertAudio",null),l([z3],n.prototype,"requestShadowUserViewData",null),l([z3],n.prototype,"setViewClip",null),l([z3],n.prototype,"stopFocusBorderBox",null),l([z3],n.prototype,"focusBorderBox",null),l([z3],n.prototype,"exportPdfFromDocElement",null),l([z3],n.prototype,"forceFollowUser",null),l([z3],n.prototype,"stopCurForceFollowing",null),l([z3],n.prototype,"requestElesDataByRecordId",null),l([z3],n.prototype,"useRawElesData",null),l([z3],n.prototype,"useElementsInfo",null),l([z3],n.prototype,"enableShortCut",null),l([z3],n.prototype,"disableShortCut",null),n}(),W3={getSdkInstance:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c(void 0,void 0,void 0,(function(){var t,n,i;return u(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=new(U3.bind.apply(U3,function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}([void 0],e,!1))),[4,t.init()];case 1:return(n=r.sent()).code?[2,{code:1,payload:null!==(i=n.message)&&void 0!==i?i:"auth check failed"}]:[2,{code:0,payload:t}];case 2:return r.sent(),[2,{code:1,payload:"初始化错误"}];case 3:return[2]}}))}))},version:g},V3=function(e){function t(t){var n=e.call(this,t)||this;return n.upime=t,n}return o(t,e),t.prototype.init=function(t){var n=this.processConfig(t);e.prototype.init.call(this,n)},t.prototype.processConfig=function(e){var t;this.canCreateTalk=!!e.canCreateTalk;var n=e.defaultGroupsNumber,i=void 0===n?2:n,r=e.maxGroupsNumber,o=void 0===r?100:r,a=e.enableCall,s=void 0!==a&&a,l=e.rtcAgoraVideoStreamConfig,c=((t={})[m.AGORA]={videoConfig:{encoderConfig:{width:640,height:360,frameRate:15,bitrateMax:800,bitrateMin:400}}},t);return s&&l&&(c[m.AGORA].videoConfig.encoderConfig=l),{defaultGroupsNumber:i,maxGroupsNumber:o,enableCall:!1,rtcLocalStreamConfigs:c}},t}(Q2),j3="icon_fR41U",G3=function(t){var n=t.className,i=t.style,r=t.title,o=t.icon,l=t.onClick,c=s(t,["className","style","title","icon","onClick"]);return e.createElement("svg",a({style:i,className:I3(n,j3),"aria-hidden":"true",onClick:l},c),e.createElement("use",{xlinkHref:"#".concat(o)},e.createElement("title",null,r||"")))},q3={tipRoot:"tipRoot_fR41U",content:"content_fR41U",top:"top_fR41U",left:"left_fR41U",right:"right_fR41U",bottom:"bottom_fR41U",leftBottom:"leftBottom_fR41U"},K3=e.forwardRef((function(n,i){var r=n.content,o=n.placement,a=n.children,s=n.className,l=n.rootClass,c=n.tipContainerStyle,u=n.customStyle;n.allowShow;var d=e.useState(!1),p=d[0],h=d[1],f=e.useRef(null),m=e.useRef(null),v=e.useState({}),g=v[0],y=v[1];return e.useImperativeHandle(i,(function(){return{rootRef:f.current}})),e.useEffect((function(){var e=f.current,t=function(e){if("touch"!==e.pointerType){var t=e.target.getBoundingClientRect(),n=t.left,i=t.top,r=t.width,o=t.height;y({left:n,top:i,width:r,height:o}),h(!0)}},n=function(){h(!1)},i=function(){h(!1)};return e&&(e.addEventListener("pointerenter",t),e.addEventListener("pointerleave",n),e.addEventListener("pointerdown",i)),function(){e&&(e.removeEventListener("pointerenter",t),e.removeEventListener("pointerleave",n),e.removeEventListener("pointerdown",i))}}),[]),e.createElement("div",{ref:f,className:l,style:u},a,p&&t.createPortal(e.createElement("div",{className:I3(q3.tipRoot),style:g,ref:m},e.createElement("span",{style:c,className:I3(q3.content,q3[null!=o?o:"bottom"],s)},r)),document.body))}));(H3=document.createElement("div")).style.position="fixed",H3.style.top="20px",H3.style.left="50%",H3.style.transform="translateX(-50%)",H3.style.zIndex="1000",document.body.appendChild(H3);var Y3="titleBar_fR41U",X3="wrapper_fR41U",Q3="icon_fR41U",Z3="menuPart_fR41U",J3="menuItem_fR41U",$3="item_fR41U",e4="iconContainer_fR41U",t4="textPart_fR41U",n4="arrowIcon_fR41U",i4="subMenuPart_fR41U",r4="activeIcon_fR41U",o4="default-",a4=[{_index:0,image:"no-background",title:"无背景",value:qa.NONE},{_index:1,image:"grid",title:"网格背景",value:qa.LINE},{_index:2,image:"dot-matrix-background",title:"点阵背景",value:qa.DOT}],s4=V3;exports.FULL_TOOLBAR_CONFIG={sticker:!0,template:!0,shapes:!0,upload:!0,stickyNote:!0,draw:!0,frame:!0,connectLine:!0,table:!0,timer:!0,mindMap:!0,text:!0,comment:!0,webpage:!0,kanban:!0},exports.GroupTalkPlugin=s4,exports.HoverTip=K3,exports.InfiWebsdk=W3,exports.SDKContext=A3,exports.Setting=function(t){var n=t.showHistory,i=void 0===n||n,r=e.useContext(A3).websdkIns,o=e.useState(!0),s=o[0],l=o[1],c=e.useState(!0),u=c[0],d=c[1],p=e.useState({}),h=p[0],f=p[1],m=e.useRef(null),v=e.useRef(null),g=function(){var e=m.current.getBoundingClientRect().width;f({top:52,left:e-5}),d(!1)},y=function(){l(!0),d(!0)};return e.useEffect((function(){var e=function(e){var t=e.target,n=v.current;(null==n?void 0:n.contains(t))||y()};return document.body.addEventListener("click",e),function(){document.body.removeEventListener("click",e)}}),[]),e.useEffect((function(){N3.load(R3)}),[]),e.createElement("div",{ref:v,style:{position:"relative"},className:Y3},e.createElement(K3,{content:"设置"},e.createElement("div",{className:X3},e.createElement(G3,{icon:"".concat(o4,"setting"),className:Q3,onClick:function(){s?l(!1):(l(!0),d(!0))}}))),e.createElement("div",{className:Z3,style:{display:s?"none":"flex"},ref:m},e.createElement("div",{className:I3(J3,$3),onPointerEnter:g},e.createElement("div",{className:e4},e.createElement(G3,{icon:"".concat(o4,"grid"),className:Q3}),e.createElement("div",{className:t4},"背景设置")),e.createElement(G3,{icon:"".concat(o4,"right-arrow"),className:n4})),i&&e.createElement("div",{className:J3,onPointerEnter:function(){return!u&&d(!0)},onClick:function(){r.toggleHistoryPanel(),y()}},e.createElement(G3,{icon:"".concat(o4,"history"),className:Q3}),e.createElement("div",{className:t4},"历史和版本"))),e.createElement("div",{className:i4,style:a({display:u?"none":"flex"},h)},a4.map((function(t,n){return e.createElement("div",{className:J3,onPointerEnter:g,onClick:function(){return t._index,e=t.value,void r.changeGridType(e);var e},key:n},e.createElement(G3,{icon:"".concat(o4).concat(t.image),className:Q3}),e.createElement("div",{className:t4},t.title),r.userPreference.gridType===t._index&&e.createElement(G3,{icon:"".concat(o4,"checked"),className:r4}))}))))},exports.SvgIcon=G3,exports.SvgManager=N3,exports.commonjsGlobal=a3,exports.getDefaultExportFromCjs=s3,exports.getDocumentType=function(e){var t=function(e){return Dp(e)?4:Rp(e)?3:Ap(e)?1:Mp(e)?2:void 0}(e);return t&&_[t]},exports.getFileType=function(e){var t=function(e){return Np(e)?"document":Pp(e)?"image":Ip(e)?"mp3":Tp(e)?"mp4":void 0}(e);return t&&T[t]},exports.mt=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e};
